{
    "abstractText": "Breakage-fusion-bridge (BFB) is a complex rearrangement that leads to tumor malignancy. Existing models for detecting BFBs rely on the ideal BFB hypothesis, ruling out the possibility of BFBs entangled with other structural variations, that is, complex BFBs. We propose an algorithm Ambigram to identify complex BFB and reconstruct the rearranged structure of the local genome during the cancer subclone evolution process. Ambigram handles data from short, linked, long, and single-cell sequences, and optical mapping technologies. Ambigram successfully deciphers the goldor silver-standard complex BFBs against the state-of-the-art in multiple cancers. Ambigram dissects the intratumor heterogeneity of complex BFB events with single-cell reads frommelanoma and gastric cancer. Furthermore, applying Ambigram to liver and cervical cancer data suggests that the BFB mechanism may mediate oncovirus integrations. BFB also exists in noncancer genomics. Investigating the complete human genome reference with Ambigram suggests that the BFB mechanism may be involved in two genome reorganizations of Homo Sapiens during evolution. Moreover, Ambigram discovers the signals of recurrent foldback inversions and complex BFBs in whole genome data from the 1000 genome project, and congenital heart diseases, respectively.",
    "authors": [
        {
            "affiliations": [],
            "name": "Chaohui Li"
        },
        {
            "affiliations": [],
            "name": "Lingxi Chen"
        },
        {
            "affiliations": [],
            "name": "Guangze Pan"
        },
        {
            "affiliations": [],
            "name": "Wenqian Zhang"
        },
        {
            "affiliations": [],
            "name": "Shuai Cheng Li"
        }
    ],
    "id": "SP:6fff303fd0a0df08340ade2b08a4f788764f5ce0",
    "references": [
        {
            "authors": [
                "H.M. Robinson",
                "C.J. Harrison",
                "A.V. Moorman",
                "I. Chudoba",
                "J.C. Strefford"
            ],
            "title": "Intrachromosomal amplification of chromosome 21 (iamp21) may arise from a breakage\u2013fusion\u2013bridge cycle",
            "venue": "Genes, Chromosomes Cancer 46,",
            "year": 2007
        },
        {
            "authors": [
                "Y Li"
            ],
            "title": "Constitutional and somatic rearrangement of chromosome 21 in acute lymphoblastic leukaemia",
            "venue": "Nature 508,",
            "year": 2014
        },
        {
            "authors": [
                "J Hicks"
            ],
            "title": "Novel patterns of genome rearrangement and their association with survival in breast cancer",
            "venue": "Genome Res",
            "year": 2006
        },
        {
            "authors": [
                "Hillmer",
                "A. M"
            ],
            "title": "Comprehensive long-span paired-end-tag mapping reveals characteristic patterns of structural variations in epithelial cancer",
            "venue": "genomes. Genome Res",
            "year": 2011
        },
        {
            "authors": [
                "R Xing"
            ],
            "title": "Whole-genome sequencing reveals novel tandemduplication hotspots and a prognostic mutational signature in gastric cancer",
            "venue": "Nat. Commun",
            "year": 2019
        },
        {
            "authors": [
                "Bignell",
                "G. R"
            ],
            "title": "Architectures of somatic genomic rearrangement in human cancer amplicons at sequence-level resolution",
            "venue": "Genome Res",
            "year": 2007
        },
        {
            "authors": [
                "K. Kitada",
                "T. Yamasaki"
            ],
            "title": "The complicated copy number alterations in chromosome 7 of a lung cancer cell line is explained by a model based on repeated breakage-fusion-bridgecycles.Cancer Genetics Cytogenet",
            "year": 2008
        },
        {
            "authors": [
                "G Lim"
            ],
            "title": "An integrated mband and submegabase resolution tiling set (smrt) cgh array analysis of focal amplification, microdeletions, and ladder structures consistent with breakage\u2013fusion\u2013bridge cycle events in osteosarcoma",
            "venue": "Genes Chromosomes Cancer",
            "year": 2005
        },
        {
            "authors": [
                "S Selvarajah"
            ],
            "title": "The breakage\u2013fusion\u2013bridge (bfb) cycle as a mechanism for generating genetic heterogeneity in osteosarcoma",
            "venue": "Chromosoma 115,",
            "year": 2006
        },
        {
            "authors": [
                "S Selvarajah"
            ],
            "title": "Genomic signatures of chromosomal instability and osteosarcoma progression detected by high resolution array cgh and interphase fish. Cytogenet",
            "venue": "Genome Res. 122,",
            "year": 2008
        },
        {
            "authors": [
                "Campbell",
                "P. J"
            ],
            "title": "The patterns and dynamics of genomic instability in metastatic pancreatic cancer",
            "venue": "Nature 467,",
            "year": 2010
        },
        {
            "authors": [
                "Valle-Inclan",
                "J. E"
            ],
            "title": "A multi-platform reference for somatic structural variation detection",
            "venue": "Cell Genomics",
            "year": 2022
        },
        {
            "authors": [
                "B. McClintock"
            ],
            "title": "The behavior in successive nuclear divisions of a chromosome broken at meiosis",
            "venue": "Proc. Natl. Acad. Sci. USA 25,",
            "year": 1939
        },
        {
            "authors": [
                "K. Yi",
                "Y.S. Ju"
            ],
            "title": "Patterns andmechanisms of structural variations in human cancer",
            "venue": "Exp. Mol. Med. 50,",
            "year": 2018
        },
        {
            "authors": [
                "Y Li"
            ],
            "title": "Patterns of somatic structural variation in human cancer",
            "venue": "genomes. Nature 578,",
            "year": 2020
        },
        {
            "authors": [
                "R.A. DePinho",
                "K. Polyak"
            ],
            "title": "Cancer chromosomes in crisis",
            "venue": "Nat. Genet. 36,",
            "year": 2004
        },
        {
            "authors": [
                "J. Maciejowski",
                "de Lange",
                "T. Telomeres in cancer"
            ],
            "title": "tumour suppression and genome instability",
            "venue": "Nat. Rev. Mol. Cell Biol. 18, 175\u2013186",
            "year": 2017
        },
        {
            "authors": [
                "V Deshpande"
            ],
            "title": "Exploring the landscape of focal amplifications in cancer using ampliconarchitect",
            "venue": "Nat. Commun. 10,",
            "year": 2019
        },
        {
            "authors": [
                "J Luebeck"
            ],
            "title": "Ampliconreconstructor integrates ngs and optical mapping to resolve the complex structures of focal amplifications",
            "venue": "Nat. Commun",
            "year": 2020
        },
        {
            "authors": [
                "C Shale"
            ],
            "title": "Unscrambling cancer genomes via integrated analysis of structural variation and copy number",
            "venue": "Cell Genomics",
            "year": 2022
        },
        {
            "authors": [
                "M. Kinsella",
                "V. Bafna"
            ],
            "title": "Combinatorics of the breakage-fusionbridge mechanism",
            "venue": "J. Comput. Biol",
            "year": 2012
        },
        {
            "authors": [
                "S. Zakov",
                "M. Kinsella",
                "V. Bafna"
            ],
            "title": "An algorithmic approach for breakage-fusion-bridge detection in tumor",
            "venue": "genomes. Proc. Natl. Acad. Sci. 110,",
            "year": 2013
        },
        {
            "authors": [
                "S. Zakov",
                "V. Bafna"
            ],
            "title": "Reconstructing breakage fusion bridge architectures using noisy copy numbers",
            "venue": "J. Comput. Biol",
            "year": 2015
        },
        {
            "authors": [
                "C. Greenman",
                "S. Cooke",
                "J. Marshall",
                "M. Stratton",
                "P. Campbell"
            ],
            "title": "Modeling the evolution space of breakage fusion bridge cycleswith a stochastic folding process",
            "venue": "J. Math. Biol",
            "year": 2016
        },
        {
            "authors": [
                "C.D. Greenman",
                "L. Penso-Dolfin",
                "T. Wu"
            ],
            "title": "The complexity of genome rearrangement combinatorics under the infinite sitesmodel",
            "venue": "J. Theor. Biol",
            "year": 2020
        },
        {
            "authors": [
                "Zheng",
                "G. X"
            ],
            "title": "Haplotyping germline and cancer genomes with high-throughput linked-read sequencing",
            "venue": "Nat. Biotechnol",
            "year": 2016
        },
        {
            "authors": [
                "L. Zhang",
                "X. Zhou",
                "Z. Weng",
                "A. Sidow"
            ],
            "title": "Assessment of human diploid genome assembly with 10x linked-reads data",
            "venue": "GigaScience 8,",
            "year": 2019
        },
        {
            "authors": [
                "M.O. Pollard",
                "D. Gurdasani",
                "A.J. Mentzer",
                "T. Porter",
                "Sandhu",
                "M.S. Long reads"
            ],
            "title": "their purpose and place",
            "venue": "Hum. Mol. Genet. 27, R234\u2013R241",
            "year": 2018
        },
        {
            "authors": [
                "Amarasinghe",
                "S. L"
            ],
            "title": "Opportunities and challenges in long-read sequencing data analysis",
            "venue": "Genome Biol. 21,",
            "year": 2020
        },
        {
            "authors": [
                "M Pendleton"
            ],
            "title": "Assembly and diploid architecture of an individual human genome via single-molecule technologies",
            "venue": "Nat. Methods 12,",
            "year": 2015
        },
        {
            "authors": [
                "N Andor"
            ],
            "title": "Joint single cell dna-seq and rna-seq of gastric cancer cell lines reveals rules of in vitro evolution",
            "venue": "NAR Genom Bioinform",
            "year": 2020
        },
        {
            "authors": [
                "Velazquez-Villarreal",
                "E. I"
            ],
            "title": "Single-cell sequencing of genomic dna resolves sub-clonal heterogeneity in a melanoma cell line",
            "venue": "Commun. Biol",
            "year": 2020
        },
        {
            "authors": [
                "Minussi",
                "D. C"
            ],
            "title": "Breast tumoursmaintain a reservoir of subclonal diversity during expansion",
            "venue": "Nature 592,",
            "year": 2021
        },
        {
            "authors": [
                "Chen",
                "L. et al. Somatic variant analysis suite"
            ],
            "title": "copy number variation clonal visualization online platform for large-scale single-cell genomics",
            "venue": "Brief. Bioinform. 23, bbab452",
            "year": 2022
        },
        {
            "authors": [
                "W. Jia",
                "C. Xu",
                "S.C. Li"
            ],
            "title": "Resolving complex structures at oncovirus integration loci with conjugate graph",
            "venue": "Brief. Bioinform. 22,",
            "year": 2021
        },
        {
            "authors": [
                "Sung",
                "W.-K"
            ],
            "title": "Genome-wide survey of recurrent hbv integration in hepatocellular carcinoma",
            "venue": "Nat. Genet",
            "year": 2012
        },
        {
            "authors": [
                "H Zou"
            ],
            "title": "Hbv-integrated local genomic alterations reveal multicentric independent occurrences of multifocal hcc",
            "venue": "Clin. Transl. Med. 13,",
            "year": 2023
        },
        {
            "authors": [
                "Z Hu"
            ],
            "title": "Genome-wide profiling of hpv integration in cervical cancer identifies clustered genomic hot spots and a potential microhomology-mediated integration mechanism",
            "venue": "Nat. Genet",
            "year": 2015
        },
        {
            "authors": [
                "C.E. Waters",
                "J.C. Saldivar",
                "S.A. Hosseini",
                "Huebner",
                "K. The fhit gene product"
            ],
            "title": "tumor suppressor and genome \u201ccaretaker",
            "venue": "Cell. Mol. Life Sci. 71, 4577\u20134587",
            "year": 2014
        },
        {
            "authors": [
                "A Parrilla"
            ],
            "title": "Aurora borealis (bora), which promotes plk1 activationbyaurora a, has an oncogenic role in ovarian",
            "venue": "cancer.Cancers 12,",
            "year": 2020
        },
        {
            "authors": [
                "S Wei\u00dfbach"
            ],
            "title": "The molecular spectrum and clinical impact of dis 3 mutations in multiple myeloma",
            "venue": "Br. J. Haematol. 169,",
            "year": 2015
        },
        {
            "authors": [
                "M Lachmann"
            ],
            "title": "Pibf (progesterone induced blocking factor) is overexpressed in highly proliferating cells and associated with the centrosome",
            "venue": "Int. J. Cancer 112,",
            "year": 2004
        },
        {
            "authors": [
                "C Cao"
            ],
            "title": "Hpv-ccdc106 integration alters local chromosome architecture and hijacks an enhancer by three-dimensional genome structure remodeling in cervical cancer",
            "venue": "J. Genet. Genomics",
            "year": 2020
        },
        {
            "authors": [
                "J. Jen",
                "Wang",
                "Y.-C"
            ],
            "title": "Zinc finger proteins in cancer progression",
            "venue": "J. Biomed. Sci. 23,",
            "year": 2016
        },
        {
            "authors": [
                "S Nurk"
            ],
            "title": "The complete sequence of a human genome",
            "venue": "Science 376,",
            "year": 2022
        },
        {
            "authors": [
                "M Byrska-Bishop"
            ],
            "title": "High coverage whole genome sequencing of the expanded 1000 genomes project cohort including 602 trios",
            "venue": "BioRxiv 185,",
            "year": 2022
        },
        {
            "authors": [
                "R Soemedi"
            ],
            "title": "Phenotype-specific effect of chromosome 1q21. 1 rearrangements and gja5 duplications in 2436 congenital heart disease patients and 6760 controls",
            "venue": "Hum. Mol. Genet",
            "year": 2012
        },
        {
            "authors": [
                "Miller",
                "D.T. et al. Consensus statement"
            ],
            "title": "chromosomalmicroarray is afirst-tier clinical diagnostic test for individualswithdevelopmental disabilities or congenital anomalies",
            "venue": "Am. J. Hum. Genet. 86, 749\u2013764",
            "year": 2010
        },
        {
            "authors": [
                "Cooper",
                "G. M"
            ],
            "title": "A copy number variation morbidity map of developmental delay",
            "venue": "Nat. Genet",
            "year": 2011
        },
        {
            "authors": [
                "F Richter"
            ],
            "title": "Genomic analyses implicate noncoding de novo variants in congenital heart disease.Nat.Genet.52",
            "year": 2020
        },
        {
            "authors": [
                "S.S. Ho",
                "A.E. Urban",
                "R.E. Mills"
            ],
            "title": "Structural variation in the sequencing era",
            "venue": "Nat. Rev. Genet",
            "year": 2020
        },
        {
            "authors": [
                "H. Li"
            ],
            "title": "wgsim-read simulator for next generation sequencing.Github Repository",
            "year": 2011
        },
        {
            "authors": [
                "Y. Ono",
                "K. Asai",
                "Hamada",
                "M. Pbsim"
            ],
            "title": "Pacbio reads simulator\u2013toward accurate genome assembly",
            "venue": "Bioinformatics 29, 119\u2013121",
            "year": 2013
        },
        {
            "authors": [
                "R. Luo",
                "F.J. Sedlazeck",
                "C.A. Darby",
                "S.M. Kelly",
                "M.C. Schatz"
            ],
            "title": "Lrsim: a linked-reads simulator generating insights for better genome partitioning.Comput",
            "venue": "Struct. Biotechnol. J. 15,",
            "year": 2017
        },
        {
            "authors": [
                "H. Li"
            ],
            "title": "Aligning sequence reads, clone sequences and assembly contigs with bwa-mem",
            "venue": "arXiv https://arxiv.org/abs/1303.3997",
            "year": 2013
        },
        {
            "authors": [
                "Sedlazeck",
                "F. J"
            ],
            "title": "Accurate detection of complex structural variations using single-molecule sequencing",
            "venue": "Nat. Methods 15,",
            "year": 2018
        },
        {
            "authors": [
                "P Marks"
            ],
            "title": "Resolving the full spectrum of human genome variation using linked-reads",
            "venue": "Genome Res",
            "year": 2019
        },
        {
            "authors": [
                "Wala",
                "J. A"
            ],
            "title": "Svaba: genome-wide detection of structural variants and indels by local assembly.GenomeRes.28",
            "venue": "Article https://doi.org/10.1038/s41467-023-41259-w Nature Communications",
            "year": 2018
        },
        {
            "authors": [
                "M. Mayrhofer",
                "S. DiLorenzo",
                "Isaksson",
                "A. Patchwork"
            ],
            "title": "allelespecific copy number analysis of whole-genome sequenced tumor tissue",
            "venue": "Genome Biol. 14, 1\u201310",
            "year": 2013
        },
        {
            "authors": [
                "Van Doorslaer",
                "K. et al. The papillomavirus episteme"
            ],
            "title": "a central resource for papillomavirus sequence data and analysis",
            "venue": "Nucleic Acids Res. 41, D571\u2013D578",
            "year": 2012
        },
        {
            "authors": [
                "Chen",
                "X. et al. Manta"
            ],
            "title": "rapid detection of structural variants and indels for germline and cancer sequencing applications",
            "venue": "Bioinformatics 32, 1220\u20131222",
            "year": 2016
        },
        {
            "authors": [
                "Mar\u00e7ais",
                "G. et al. Mummer4"
            ],
            "title": "a fast and versatile genome alignment system",
            "venue": "PLoS Comput. Biol. 14, e1005944",
            "year": 2018
        },
        {
            "authors": [
                "Rouillard",
                "A.D. et al. The harmonizome"
            ],
            "title": "a collection of processed datasets gathered to serve and mine knowledge about genes and proteins",
            "venue": "Database 2016, baw100",
            "year": 2016
        }
    ],
    "sections": [
        {
            "heading": "Deciphering complex breakage-fusion-",
            "text": "bridge genome rearrangements with Ambigram\nChaohui Li 1,2, Lingxi Chen 1,2, Guangze Pan1, Wenqian Zhang1 & Shuai Cheng Li 1\nBreakage-fusion-bridge (BFB) is a complex rearrangement that leads to tumor malignancy. Existing models for detecting BFBs rely on the ideal BFB hypothesis, ruling out the possibility of BFBs entangled with other structural variations, that is, complex BFBs. We propose an algorithm Ambigram to identify complex BFB and reconstruct the rearranged structure of the local genome during the cancer subclone evolution process. Ambigram handles data from short, linked, long, and single-cell sequences, and optical mapping technologies. Ambigram successfully deciphers the gold- or silver-standard complex BFBs against the state-of-the-art in multiple cancers. Ambigram dissects the intratumor heterogeneity of complex BFB events with single-cell reads frommelanoma and gastric cancer. Furthermore, applying Ambigram to liver and cervical cancer data suggests that the BFB mechanism may mediate oncovirus integrations. BFB also exists in noncancer genomics. Investigating the complete human genome reference with Ambigram suggests that the BFB mechanism may be involved in two genome reorganizations of Homo Sapiens during evolution. Moreover, Ambigram discovers the signals of recurrent foldback inversions and complex BFBs in whole genome data from the 1000 genome project, and congenital heart diseases, respectively.\nBreakage-fusion-bridge (BFB) is a mechanism that leads to complex genome rearrangements in multiple cancers1\u201313. The rearrangement of BFB is mediated by the recursive cycles of BFB14\u201316 (Fig. 1a). A BFB cycle begins with the fold-back inversion (FBI) of two sister chromatids due to the lack of telomeres during DNA replication, resulting in twocentromeres in the fused bridge.When two centromeres are stretched to opposite poles in the anaphase, the two sister chromatids are split with a double-strand break on the bridge between two centromeres, unnecessarily the same as theprevious fusion site. Since eachdaughter cell contains chromatids without telomeres, another BFB cycle may start again. Repetition of BFB cycles contributes to a surge in stair-like copy number (CN) amplifications and FBIs15\u201318. The above depicts a perfect BFB event that is solely driven by reverse complementary FBI, where the genomic positions of two breakpoints of a reverse complementary FBI are the same. However, some BFB events involve imperfect FBIwhose breakpoint positions are different, resulting in the loss of DNA segments near the breakpoints4. Furthermore, studies reported that structure variations (SVs) such as deletion, duplication, insertion, and translocation could be involved during BFB cycles outside the FBI breakpoints13,19\u201321. In this study, we coin the BFB rearrangement beyond perfect BFB as complex BFB rearrangement. As the BFB process delivers anaphase bridges and dicentric chromosomes, investigators detected it using classical cytogenetic techniques in the early time10. However, these BFB cytogenetic signatures are not directly discernible from high-throughput DNA sequencing reads. Most studies inferred the consistency of a specific observation with BFB events from sequencing reads by two distinct hallmarks3\u20139,11,12,16: (i) oscillating CN with exponential or stair-like gains;\nReceived: 13 October 2022\nAccepted: 28 August 2023\nCheck for updates\n1Department of Computer Science, City University of Hong Kong, Hong Kong, China. 2These authors contributed equally: Chaohui Li and Lingxi Chen. e-mail: shuaicli@cityu.edu.hk\nNature Communications | (2023) 14:5528 1\n12 34\n56 78\n9 0 () :,;\n12 34\n56 78\n9 0 () :,;\nand ii) enrichment of FBIs with the fold-back direction of head-to-head (FBI-hh) or tail-to-tail (FBI-tt) (Fig. 1b). However, a pattern consistent with the two hallmarks does not imply that BFB yields the pattern.\nLeveraging the \u201cpalindrome\u201d or \u201cambigram\u201d nature of the BFBinduced local genomic map, i.e., the rearranged structure of the local genome, researchers started to utilize well-established algorithms to mathematically expand CNs or FBIs into possible BFB paths for array comparative genomic hybridization (aCGH) or pair-end sequencing (PE) data (Kinsella et al.22, BFBFinder23,24, and Greenman et al.25,26, Table 1). However, these mathematical models have limitations in interpreting real-world data for the following reasons. (i) These models solely focus on perfect BFB, ruling out the possibility of other deletion, duplication, insertion, or translocation in complex BFB rearrangements13,19\u201321. (ii) These models lag behind recent advances in linked read sequencing27,28, long-read sequencing29,30, and optical mapping alignment31. Linked read, long read, and optical mapping data offer larger than 100kb linkage of the DNA fragment that could accelerate thedetectionof the accurate and longcomplexBFB local genomic map. (iii) Single-cell sequencing32\u201335 could facilitate investigation of the intratumor heterogeneity of complex BFB at single-cell resolutionwhile existing methods are incompatible. Recently, the community has developed computational pipelines to detect and resolve complex somatic genome rearrangements, including complex BFB (AmpliconArchitect + AmpliconClassifier19, AmpliconReconstructor20, and LINX21, Table 1). However, these pipelines merely support short sequencing reads or optical mapping data. In this work, to overcome the limitations above, we propose Ambigram, a graph algorithm to detect the complex BFB and reconstruct the underlying local genomicmapduring the evolution process. Ambigram deciphers the complex BFB event that involves deletion, duplication, insertion, and translocation. Ambigram resolves gold- or silver-standard complex BFB events from various data protocols, encompassing short, linked, long, or optical mapping data from multiple cancers, includingmelanoma, lung, breast, andpancreatic cancer. Incorporating linkages from linked read, long read, or opticalmapping data boosts the efficacy of BFB reconstruction in melanoma and lung cancer. Ambigram is robustwith various sequencing depths and tumor purities as well. Furthermore, applying the tool to single-cell reads suggests that melanoma and gastric cancers may have intratumor heterogeneity of complex BFBs. Ambigram demonstrates that the BFB mechanism can mediate oncovirus integrations, including seven HBV integrations in four liver cancer samples and three HPV integrations in three cervical cancer samples, leading to truncation of the tumor suppressor FHIT or amplification of oncogenes MUC12, BORA, DIS3, PIBF, or ZNFs. Although BFB is proposed as a mechanism that leads to complex genome rearrangements in cancers.We find BFB signals from non-cancer data. We suggest that two genome reorganizations of Homo Sapiens during evolution may be carried out by the BFB mechanism after investigating the complete human genome reference. Ambigram discovers 85 recurrent FBIs or complex BFB polymorphisms (occurring inmore than 5% of the samples in the cohort) in 923whole genomes from the 1000Genome Project (1000GP), directly\nNature Communications | (2023) 14:5528 2\ntruncating 32 genes, including APP, C4BPA, and SUGCT. We apply Ambigram to 330 congenital heart disease (CHD) probands and 612 of their parents, with 923 1000GP samples as unaffected controls. We observe the recurrent FBIs or complex BFB polymorphisms across the cohorts. The three genes that are more frequently (>50%) involving FBIs are APP, C4BPA, and BORCS5. We find that PTPRQ, PUS7, ITPRID1, PLEKHB2, IL1RAPL1, and EXT1 that carry FBI or complex BFB polymorphisms are significantly (p value <1e-5) related to CHD."
        },
        {
            "heading": "Results",
            "text": ""
        },
        {
            "heading": "Overview of Ambigram",
            "text": "Given the collection of SVs derived from genome sequencing data, we first identify the set of BFB candidate SVs that contain FBIs (Fig. 1a\u2013c). Then, we locate a local genome region that includes all the SV breakpoints of a candidate BFB event. This region of the genome forms the reference path of that candidate BFB event, and we partition it into continuous segments by breakpoints. Based on the mathematical model that we designed to represent BFB, Ambigram finds all possible BFB mono-chains and loops (Methods). Then, Ambigram employs integer linear programming (ILP) to estimate the CN configuration of BFBmono-chains and loops that best match the BFB CN pattern. Next, we utilize the CN configuration to construct a BFB directed acyclic graph (DAG). The DAG has the mono-chains and loops as vertices. We connect the vertices u and v by a directed edge if v is a child entity of u (Methods). Finally, the BFB path, i.e., the local genomic map of BFB is constructed by a walk guided by the DAG. Ambigram owns several merits (Fig. 1d). Ambigramdeals with complex BFB events that involve other types of SV, such as deletion, duplication, insertion, and translocation, which are common in practice. Furthermore, Ambigram is compatible with multiple data protocols, including Illumina pair-end (PE) short reads, 10x Genomics linked reads, Pacific Biosciences (PB) long reads, Oxford Nanopore (ONT) long reads, Bionano optical mapping (OM) alignment, and single-cell reads. Additionally, Ambigram can also resolve potential BFB paths mediated by oncovirus integration. This study demonstrates thatAmibgram resolves complex BFB events in multiple cancers and complex diseases (Fig. 1e).\nBenchmarking Ambigram with in silico data We designed six in silico BFB instances covering one perfect BFB and five complex BFBs. The first instance simulates a perfect BFB event on chr7 with four BFB cycles that reverse complementary FBI fused DNA segments H6 H6,H2 H2,H4 H4, and H3 H3 orderly (Fig. 2a). The second instance simulates a complex BFB that involves imperfect FBIswith loss of DNA segments at breakpoints; it is formedby four BFB cycleswith two reverse complementaryFBIs and two imperfect FBIson chr3 (Fig. 2b). The third and fourth instances simulate BFB events\ninvolving insertion and translocation (Fig. 2c\u2013d). Then, we designed a complex BFB event that covered duplication and insertion outside the FBI breakpoints as the fifth instance (Fig. 2e). The sixth instance event simulates the virus integration scenario (Fig. 2f). The detailed descriptions of these BFB events are in Supplementary Fig. 1\u20136.\nWe simulated the local genome sequencing reads according to the six BFB paths to verify the compatibility of different protocols (PE, 10x, PB, and ONT). The tumor purity is profoundly shifting in clinical samples. Thus, we evaluated the impact of tumor purity on BFB path reconstruction. We randomly mixed BFB path reads and reference path reads with a depth of 30\u00d7 and tumor purities of 100%, 75%, 50%, 25%, 20%, and 10% for the PE, 10x, PB, and ONT data, respectively. Sequencing depth is also a significant factor, as it is a trade-off between the sensitivity of BFBdetection and the costof sequencing. Toevaluate the effect of sequencing depth on deciphering the BFB path, we sampled 100% pure tumor reads at depths of 30\u00d7, 20\u00d7, 10\u00d7, and 5\u00d7.\nWe ran Ambigram to reconstruct the six in silico BFB instances using the ground truth CN profiles of segments, and the SVs called from PE, 10x, PB, and ONT reads independently. We regard the BFB event as fully resolved if all CNs and SVs from the inferred BFB path are matched with those of ground truths; that is CN accuracy = 1, SV precision=1, SV recall = 1, and SV F1-score = 1, otherwise, unresolved. Ambigram successfully resolved the BFB paths with purity 100% and sequencing depth ranging from 5\u00d7 to 30\u00d7 for all protocol data of six events (Fig. 2g\u2013l and Supplementary Fig. 7); exception happens on the third instance (10\u00d7 data) and the fifth instance (10\u00d7, PB, andONTdata). Due to the complexity of the designed instances and sequencing noise from low coverage, the SV callers (Methods) were unable to call enough ground truth SVs to allow Ambigram to infer the exact BFB path (Supplementary Fig. 8). Furthermore, Ambigram loses sensitivity while tumor purity decreases when sequencing depth is set to 30\u00d7 because ground truth SV supporting reads are reduced in low purity, especially in BFB scenario 5 (Fig. 2k and Supplementary Fig. 8). Notably, Ambigramcan infer virtual FBIs andSVs that areundetecteddue to low depth and purity to form BFB paths, instances resolved by inferring virtual FBI are colored with orange in Fig. 2g\u2013l. Furthermore, in addition to SV and CN information, Ambigram can incorporate read linkage evidence from single- or multiple-sequencing protocols to infer the BFB paths. Figure 2g\u2013l shows that by adding linked or longread linkage information (coloredwith crimson), five BFB instances are resolved in purity 0.1 scenarios.\nBFBFinder, AmpliconArchitect + AmpliconClassifier, AmpliconReconstructor, and LINX are cutting-edge BFBdetection tools with executables (Table 2). However, AmpliconArchitect + AmpliconClassifier and LINX failed the trials of 100% purity and 30\u00d7 PE BAM files following the GitHub guides. AmpliconReconstructor requires the\nTable 1 | Summary of BFB detection tools\nTool LGM-resolved Feature Experiment data protocol\nCN BP FBI DEL/DUP INS/TRX\nVirus aCGH PE 10x PB ONT OM SC\nKinsella et al.22 \u2713 \u2713 \u2013 \u2013 \u2013 \u2013 \u2713 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013\nBFBFinder23,24 \u2713 \u2713 \u2013 + \u2013 \u2013 \u2713 \u2713 \u2013 \u2013 \u2013 \u2013 \u2013\nGreenman et al.25,26 \u2713 \u2713 \u2713 \u2013 \u2013 \u2013 \u2013 \u2713 \u2013 \u2013 \u2013 \u2013 \u2013\nAA + AC19 \u2013 \u2713 \u2713 \u2713 \u2713 + \u2013 \u2713 \u2013 \u2013 \u2013 \u2013 \u2013\nAR20 \u2713 \u2713 \u2713 \u2713 \u2713 + \u2013 \u2013 \u2013 \u2013 \u2013 \u2713 \u2013\nLINX21 \u2713 \u2713 \u2713 \u2713 \u2713 + \u2013 \u2713 \u2013 \u2013 \u2013 \u2013 \u2013\nAmbigram \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2013 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713\n\"\u2713\u201d for available and \u201c\u2013\u201d for not applicable. The FBI feature of Zakov et al. is marked by \u201c+\u201d since Zakov et al. solves the BFB using the CN count vector first, then uses the FBI fraction to verify the confidence of the BFB. Greenman et al. solely use FBI breakpoints, neglecting the head-to-head or tail-to-tail direction of the FBI. The virus feature of the complex rearrangement detection pipelines AA + AC, AR, and LINX are indicated by \u201c+\u201d because they resolve BFB and virus integration individually rather than correlating BFB and viral integration into one evolution process. BFB breakagefusion-bridge, LGM local genomic map,CN copy number, BP breakpoint, FBI fold-back inversion,DEL deletion, DUP duplication, INS insertion, TRX translocation, aCGH array comparative genomic hybridization, PEpaired-end, 10x 10x linked-reads, PB PacBio,ONTOxfordNanopore,OMopticalmapping,SC single cell,AAAmpliconArchitect,ACAmpliconClassifier,ARAmpliconReconstructor.\nNature Communications | (2023) 14:5528 3\nbreakpoint graph from AmpliconArchitect as input, which makes it inapplicable. Therefore, we can only benchmark Ambigram with BFBFinder.We fit the ground truthCNprofiles of the BFBpaths of each chromosome independently since BFBFinder only takes segment CN profiles from single chromosomes (Method). In Supplementary Fig. 9, BFBFinder successfully resolves the perfect BFB event (the first instance). Even though BFBFinder resolves the BFB path of the third and fourth instances at the single chromosome level, it cannot assemble the BFB path after translocation. As for the second and fifth instances, the inferred BFB paths fromBFBFinder are inconsistent with ground truths, as BFBFinder neglects the possibility of imperfect FBI, duplication, and deletion. The sixth simulated instance is inapplicable for BFBFinder as it involves virus integration. Last, we simulated 410 BFB paths without generating the sequencing reads. The BFB paths own varying numbers of segments (ranging from 6 to 15), FBIs (ranging from 2 to 7), total segment CN (ranging from13 to 105), and largest segmentCN (ranging from3 to 11). After fitting the CN profile and SV profile of BFB paths, Ambigram demonstrates higher CN accuracy, SV Precision, SV Recall, and SV F1score compared to BFBFinder (Supplementary Fig. 10).\n1 1\nSV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 1 SV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 2 SV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 3\nSV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 4 SV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 5 SV=PE SV=10x SV=PB SV=ONT\n\u2212 10 x PB ON T\n10 x,P\nB,O NT \u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X Linkage\nSimulated BFB instance 6\nUnresolved Resolved Resolved by inferring virtual FBI Resolved by utilizing read linkage\nH1 H2 H3 H4 H5 H6\nH2 H3 H4 H5 H6\nH2 H3 H4\nH3 H4\nH1 H2 H3 H4 H5 H6\nH2 H3 H4 H5 H6\nH3 H4\nH2 H3 H4\na b c\ng h i\nd e f\nj k l\nAmbigram resolved BFB path Real SV Virutual SV Negative strand\nH1 H2 H3 H4 H5 H6\nH1 H2 H3 H4 H5 H6\nH2 H3 H4\nH1 H2 H3 H4 H5 H6\nH2 H3 H4 H5\nH3 H4 H5 H6\nH2_1 H2_2 H2_3\nH2_2 H2_3 H2_4\nH2_2 H2_3 H2_4\nH6_1 H6_2 H6_3\nH13_1 H13_2\nH2_3 H2_4\nH6_2 H6_3\nH2_1 H2_2 H2_3 H2_4\nH2_2 H2_3\nH6_2 H6_3\nH6_2 H6_3\nH2_2 H2_3 H2_4\nH6_2H6_1 H6_3\nH6_2 H6_3\nH1 H1H2 H3 H4 H6\nH3 H4 H5\nH3 H4 H5H3 H4 H5 H6\nH3 H4 H5\nH1 H2 H3 H4V2\nH2 H3 H4V2\nH2 H3 H4V2\nH2 H3 H4V2\nSimulated BFB instance 1\nSimulated BFB instance 4\nSimulated BFB instance 2\nSimulated BFB instance 5 Simulated BFB instance 6\nSimulated BFB instance 3 chr7\nchr2 chr6 chr6\nchr8 virus\nchr3 chr2\nchr6\nchr13\nFBI-hh FBI-tt DEL-ht DUP-th TRX-hh TRX-tt TRX-ht TRX-th\n1\n1\n3\n1 1 2\n1 1\n2 3\n3 2\n22\n1\n2\n2\n2\n2\n2\n3\n3\n3\n3\n1\n3\n3 4\n4 4\n4\n4\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1 1 1\n0.83 1\n0 0 0 0 0 0\n1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0\n1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.75 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.83 0.75 1 0.5 1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1 0 0\n1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.75 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.83 0.75 1 1 1 1 1 1 1 1 1 1 0.83 0.75 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 0.83 0.75 1 1 1 1 1 0.5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.75 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.75\n0.67 0.5\n1 0.67 1 1 1 1 1 1\n0.44 0.33 0.11 0 0.11 0 0.11 0\n0.67 0.5\n1 0.67 1 1 1 1 1 1\n0.78 0.5 0.78 0.5 0.78 0.5 0.78 0.5\n0.67 0.67\n1 1 1 1 1 1\n0.11 0 0.11 0 0.11 0 0.11 0 0.11 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.11 0 0.11 0 0.11 0 0.11 0 0.11 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.11 0 0.11 0 0.11 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1 1 1 1 1\n0.14 0 0.14 0 0.14 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 0.8 1 0.8 1 0.8 1 1 1 1 1 1 1 1 0.14 0.2 0.14 0.2 0.14 0.2 0.14 0.2 0.14 0.2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.14 0.2 0.14 0.2 0.14 0.2 0.14 0.2 0.14 0.2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.14 0.2 0.14 0.2 0.14 0.2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0\n0.17 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n0.83 0.57\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0\n0.83 0.57\n1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0\n0.17 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n0.83 0.57\n0.67 0.57 0.67 0.86\n1 1 1 1\n0.83 0.71 0.83 0.71\n0 0 0 0 0 0\n0.67 0.57 0.67 0.86\n1 1 1 1\n0.83 0.71 0.83 0.71 0.5 0.43 0.5 0.43 0.83 0.43\n0 0 1 0.29\n0.83 1\n1 0.57 0 0 0 0 0 0 0 0 0 0\n0 0 1 0.29\n0.83 1\n1 0.57 1 0.57 1 0.71 1 1 0 0\n0.83 0.71\n0.67 0.29 0.17 0\n1 0.29 1 1\n0.67 0.71\n0 0 0 0 0 0 0 0\n0.67 0.29 0.5 0.57\n1 0.29 1 1\n0.67 0.71\n1 0.43 0 0 0 0 0 0\n1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.2 0 0.2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0.17 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.8 0.5 0.17 0\nCN accuracy SV recall11\nFig. 2 | In silico experiments. a\u2013f The BFB paths of simulated instances 1\u20136. Detailed captions are in Supplementary Figs. 1\u20136. The number n in a circle denotes that the SV comes from chromosome duplication in the n-th BFB cycle. g\u2013l Results derived by Ambigram for simulated BFB instances 1\u20136 with various sequencing protocols, depths, and purities. \u201c-\u201d means that the inputs of Ambigram are SVs called from one sequencing protocol (SV=PE, SV=10x, SV=PB, or SV=ONT) and ground truth CNs. \u201cResolved\u201dmeans all SVs andCNs from the inferredBFB path are matched with those of ground truths, otherwise \u201cUnresolved''. \u201cResolved by inferring the virtual FBI\u201d signifies Ambigram resolves the BFB path by recovering the undetected FBIs in low sequencing depth and tumor purity scenarios. \u201cResolved by utilizing read linkage\u201d means that Ambigram cannot resolve the BFB\npath with CNs and detected SVs, while it can resolve the path after incorporating the linked or long-read linkage from 10x, PB, or ONT data. The CN accuracy is measured by the number of segments with correctly inferred CNs divided by the total segment number. The SV recall measures the portion of the SVs inferred correctly, that is, the numberof ground truth SVs inferredcorrectly by the tool over the total numberof ground truth SVs; Note that \u201cResolved\u201d implies CN accuracy = 1, SV precision = 1, SV recall = 1, and SV F1-score= 1. BFB breakage-fusion-bridge, FBIhh fold-back inversion with head-to-head direction, FBI-tt fold-back inversion with tail-to-tail direction, DEL deletion, DUP duplication, INS insertion. TRX translocation. SV structure variation. PE paired-end. 10x 10x linked-reads. PB PacBio. ONT Oxford Nanopore.\nNature Communications | (2023) 14:5528 4\nEvaluation of short, linked, or long-read data on cancers Valle-Inclan et al. have manually verified two groups of ground truth somatic SVs that complex BFBs may cause in the COLO829 melanoma cell line13,21. The underlying complex BFBs are not only supported by FBIs andoscillationofCNbut are also involvedwithdeletion, insertion, and translocation. Here, we assessed Ambigram against the state-ofthe-art in deciphering the two gold-standard complex BFB events using PE reads with 100% purity and 98\u00d7 depth. The first complex BFB event has three FBIs and four translocation SVs, integrating segments fromchr3, chr6, chr10, and chr12 (Fig. 3a\u2013c).\nTable 2 | Summary of gold-standard datasets to benchmark Ambigram with the state-of-the-art\nDataset Standard Cancer type Protocol Data format AA + AC AR LINX Ambigram\nIn silico instances 1\u20136 Gold \u2013 PE LGS x \u2013 x \u2713\nIn silico instances 1\u20136 Gold \u2013 10x/PB/ONT LGS \u2013 \u2013 \u2013 \u2713\nIn silico instances 1\u20136 Gold \u2013 PE+10x/PB/ONT LGS \u2013 \u2013 \u2013 \u2713\nCOLO829 instance 1 Gold Melanoma PE WGS + \u2013 \u2713 \u2713\nCOLO829 instance 2 Gold Melanoma PE WGS x \u2013 + \u2713\nCOLO829 instances 1\u20132 Gold Melanoma 10x/PB/ONT WGS \u2013 \u2013 \u2013 \u2713\nCOLO829 instances 1\u20132 Gold Melanoma PE+10x/PB/ONT WGS \u2013 \u2013 \u2013 \u2713\nCOLO829 instances 1\u20132 Gold Melanoma PE+OM WGS \u2013 \u2713 \u2013 \u2713\nInput In silico instances COLO829 instances\nGround Truth CN 1 2 3 4 5 6 1 2\nBFBFinder \u2713 x + + x \u2013 + +\n\"\u2713\u201d means the BFB events are detected and resolved. \u201cx\u201d means the BFB events are unresolved after running the program. \u201c\u2013\u201dmeans not applicable. The COLO829 instance 1 on AA + AC and COLO829 instance 2 on LINX are marked with \u201c+\u201d as the tool only detects the event but does not provide the BFB path. Even though BFBFinder resolves the BFB path of BFB instances 3\u20134 and COLO829 instances 1\u20132 at single chromosome, it cannot assemble the BFB path after translocation, sowemarked these instances as \u201c+\u201d. PEpaired-end, 10x 10x linked-reads, PB PacBio,ONTOxford Nanopore, OMoptical mapping, LGS local genome sequencing.WGS whole genome sequencing. AA AmpliconArchitect. AC AmpliconClassifier. AR AmpliconReconstructor.\nchr3 24465000 2672000024900000 26100000 26664000\nH3_6H3_1 H3_8H3_3 H3_4 H3_5 H3_7H3_2\nnc = number of segments with correctly inferred CNs\nn1 = number of all segments\nn3 = number of all SVs inferred by Ambigram ns = number of ground truth SVs inferred correctly by Ambigram\nn2 = number of ground truth SVs\nBFBFinder\nGround truth LINXcopy number\n0 2 4 6 8\n10 12 14\nAmbigram\n24565108 25400602 266639222643191824566182 25401059 26664499\nchr6\nchr12 26193700 26194100 26194400 26294406\n72666800 72667000 72667150H6_1 H6_4H6_2\nH12_1 H12_3H12_2\nchr10 60477100 60477300 60477500\nH10_1 H10_3H10_2\nH6_3\ncopy number\n0 2 4 6\n26194041\n60477224\n72666892\n2619440626194117\n60477422\n72667075\na e\nb\ninter-chromosome SVs intra-chromosome SVs H6_2H3_6- H6_2+\nComplementary reverse segmentsTRX-ht FBI-hh FBI-ttTRX-ttTRX-hh\nH10_2H3_4+ H10_2+ H3_4\nH12_2H3_3+ H12_2+ H3_3\nH12_2H12_2+ H10_2-\nBFB SV\nH3_3H3_2- H3_3+\nH3_6H3_6+ H3_7-\nH6_2H6_2+ H6_3-\nSV=PE SV=10x SV=PB SV=ONT SV=PE SV=10x SV=PB SV=ONT\nf\n\u2212 10 x PB ON T\n10 x,P\nB,O NT\n10 x,P\nB,O NT\u2212 10 x \u2212 PB \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X\nLinkage\nUnresolved Resolved Resolved by inferring virtual FBI Resolved by utilizing read linkage\n\u2212 10 x PB ON T \u2212 10 x \u2212 \u2212 ON T\np=1 5X p=1 10X p=1 20X p=1 30X p=0.75 30X\np=0.5 30X\np=0.25 30X\np=0.2 30X p=0.1 30X\nLinkage\nCOLO829 BFB instance 1 COLO829 BFB instance 2\nH6_1 H6_4H6_2 H6_3H3_6H3_1 H3_8H3_3 H3_4 H3_5 H3_7H3_2\ndc Ambigram resolved BFB path\nReal SV\nVirutual SV\nNegative strand\n(First stage)\nFragment substitued in the second stage\nH3-7H3_6 H3_8H3_3 H3_4 H3_5 H3_7\nH3-7H3_6 H3_8H3_3 H3_4 H3_5 H3_7\nH3-7H3_6H3_3 H3_4 H3_5 H3_7\nH3_6 H3_8H3_3 H3_4 H3_5 H3_7H3_2\nH3_6H3_3 H3_4 H3_5H3_2 H3_2 H3-7H3_6H3_3 H3_4 H3_5 H3_7\nH3_2 H3_3 H3_4\nH3_6H3_3 H3_4 H3_5\nH3_3 H3_4H3_2\nH3_6H3_3 H3_4 H3_5 H3_7\nH3-7H3_6\nH3-7H3_6\nH6_1 H6_4H6_2 H6_3\nH6_2\nH6_4H6_2 H6_3\nH6_1 H6_4H6_2 H6_3\nH6_2\nH3_1 H3_3H3_2 (Second stage) H12_2 H10_2\nMiddle part (same as the first stage)\n24 48\n0K B\n26 00\n0K B\n26 08\n0K B\n26 16\n0K B\n26 24\n0K B\n26 32\n0K B\n264 00K\nB 264\n80K B\n2656 0KB\n26640KB\n24 56\n0K B\n24 64\n0K B\n24 72\n0K B\n24 80\n0K B\n24 88\n0K B\n249 60K\nB\n2504 0KB\n25120K B\n25200KB25280KB\n25360KB\n25440KB\n25520KB\n25600KB\n25680KB\n25760KB\n25840KB 25920KB\n26720KB\nchr3\n26160KB 26240KB\nchr6\n72640KB\n72720KB chr12 60400KB\n60480KB 60560KB\nchr10\n2 4 6 8 10 12\n2 4 6 8\n10 12\n2 4\n6 8 10 12\n2 4 6 8\n10 12\nH3_6\nH10_2\nH3_6\nH3_7\nH6_3\nH3_3 H3_4\nH6_1 H6_4H6_2 H6_3\nH6_2 H6_3\nH6_4H6_3\nH6_1 H6_4H6_2 H6_3\nH6_2 H6_3\nH6_4H6_3\n0.33 0.67 0.58 1 0.58 1 0.5 1 0.58 1 0.58 1 0.58 1 0.5 1\n0.58 1 0.5 1 0.5 1 0.5 1 0.33 0.33\n0.58 1\n0.58 1\n0.58 1 0.5 1 0.58 1 0.5 1 0.67 1 0.67 1 0.58 1\n0.58 1\n0.58 1\n0.58 1 0.5 1 0.58 1 0.5 1 0.67 1 0.67 1 0.58 1\n0.58 1\n0.58 1\n0.58 1 0.5 1 0.58 1 0.5 1 0.67 1 0.5 1 0.58 1 0.58 1 0.5 1 0.25 0.67 0.25 0.67 0.08 0\n0.58 1\n0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1\n0.86 1 0.86 1 0.71 1\n0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.86 1 0.86 1 0.71 1 0 0 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.86 1 0.86 1 0.71 1 0 0 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.14 0 0.86 1 0 0\n0.71 1 0.71 1 0.71 1\n0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1\n0.71 1\n0.71 1\n0.71 1 0.71 1\n0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0.71 1 0 0 0 0 0 0 0 0 0 0 0.25 0.33 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.14 0 0.14 0 0 0\n0 0\n0 0\n0 0\n0 0\n0 0 0 0\n0 0\n0 0\n0 0\n0 0\n0 0\n0 0\n0 0 0 0\n0.71 1 0.71 1 0.71 1\n0 0\n0.71 1\n0 0\n0 0\n0.71 1 0 0\n0.33 0.67 0.33 0.67 0.33 0.67 0.33 0.67 0.33 0.67 0.33 0.67 0.33 0.67 0.33 0.67\n0.25 0.67\n0.58 1 0.58 1 0.42 1 0.58 1 0.17 0.67 0 0 0.08 0 0.17 0\n0.58 1 0.58 1 0.58 1\n0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.5 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.58 1 0.42 1 0.58 1 0.58 1 0.25 0.33 0.33 0.33 0.42 0.33\nCN accuracy1\nFBI recall = nf / n41\n0 0\nAmbigramtool metric BFBFinderLINX\nCN accuracy (nc / n1)\nCN error 7 29 3*\n0.58 0.08 0.75\n1 1 0.43\n0.5 1 0.36\n0.67 1 0.53\nSV recall (R = ns / n2) SV precision (P = nc / n3) SV F1-score = 2(PR)/(P+R)\nnf = number of ground truth FBIs inferred correctly by Ambigramn4 = number of ground truth FBIs\nFig. 3 | COLO829 instance 1 - complexBFBonchr3, chr6, chr10, and chr12. aThe SVbreakpoints split the local genome regions of chr3, chr6, chr10, and chr20 into 8, 4, 3, and 3 segments, respectively. b List of SVs and the segments they connect. cCIRCOSdiagramof the complexBFB.dAmbigramresolved the BFBpathwith 98x depth and 100% purity PE sequencing data. In the first stage, six BFB cycles happen on chr3 with details shown in Supplementary Fig. 11. At the same time, chr6 undergoes four BFB cycles. In the second stage, an inter-chromosomal rearrangement inserts fragments of chr10 and chr12 into the BFB path on chr3. Another translocation connects two BFB paths on chr3 and chr6, constructing the result of the complex BFB event. e The total CN error, CN accuracy, SV recall, SV precision, and SV F1-score derived by Ambigram, LINX, and BFBFinder compared to ground truth. The total CN error is the sum of all segment copy number differences between the output and ground truth. BFBFinder is marked with \u201c*\u201d as BFBFinder merely accepts segment CN profiles from a single chromosome, so we fit the\nground truth CNprofiles of BFB paths of chr3 and chr6 separately. fResults derived by Ambigram with various sequencing protocols, depths, and purities. \u201c-\u201d means that the inputs of Ambigram are SVs called from one sequencing protocol (SV=PE, SV=10x, SV=PB, or SV=ONT) and ground truth CNs. \u201cResolved\u201dmeans that inferred BFB path includes all ground truth FBIs, otherwise \u201cUnresolved''. \u201cResolved by inferring the virtual FBI\u201d signifies Ambigram resolves the BFB path by recovering the undetected FBIs in low sequencing depth and tumor purity scenarios. \u201cResolved by utilizing read linkage\u201d means that Ambigram cannot resolve the BFB path with CNs and detected SVs, while it can resolve the path after incorporating the linked or long-read linkage from 10x, PB, or ONT data. BFB breakage-fusionbridge. FBI-hh fold-back inversion with head-to-head direction. FBI-tt fold-back inversion with tail-to-tail direction. DEL deletion, DUP duplication, INS insertion, TRX translocation, SV structure variation, PE paired-end, 10x 10x linked-reads, PB PacBio, ONT Oxford Nanopore.\nNature Communications | (2023) 14:5528 5\nAmbigram inferred that this complex BFB event had undergone two stages (Fig. 3d). In summary, chr3 and chr6 encounter six and four BFB cycles in the first stage separately. We depicted the detailed evolution process of the chr3 BFB cycles in Supplementary Fig. 11. In the second stage, segments of chr10 and chr12 are inserted into the BFB path on chr3 through inter-chromosomal rearrangements, and another translocation links the BFB paths of chr3 and chr6 together, contributing to thefinal BFBpath. LINX suggested thewhole BFB event consists of four BFB cycles, followedby a genomedoubling (Supplementary Fig. 12)13,21. Ambigram resolved the BFB path superior to LINX in terms of CN, as Ambigram yields a copy number difference of seven from ground truth, while LINX produced 29; Ambigram has CN accuracy of 0.58 while LINX has CN accuracy of 0.08 (Fig. 3e). As AmpliconArchitect + AmpliconClassifier neglect the translocation between chr3 and chr6, it interprets the event with two independent CN amplicons (Supplementary Fig. 13a). Amplicon 1 covers complex CN gains in the local regions of chr3, chr10, and chr12. Amplicon 2 represents the CN gains on the local region of chr6. Even though amplicon 1 is detected as the BFB event, the BFB path is unresolved. BFBFinder merely accepts segment CN profiles from a single chromosome, so we fit the ground truth CN profiles of BFB paths of chr3 and chr6, separately (Supplementary Fig. 14a). Although BFBFinder had a smaller CN difference to ground truth and larger CN accuracy, it failed to assemble the complex BFB event with translocation and produced the lowest SV precision, SV recall, and SV F1-score compared to Ambigram and LINX (Fig. 3e).\nThe second complex BFB event occurs in chr15 and consists of one FBI and four translocations, leading to templated insertion from chr6 and chr20 (Supplementary Fig. 15a\u2013c). Ambigram successfully resolved itwith two stages, chr15 undergoes four BFB cycles in the first stage, and then translocation occurs in chr6, chr15, and chr20 (Supplementary Fig. 15d). LINX detected the event but provided no resolved BFB path. AmpliconArchitect + AmpliconClassifier detected the complex CN gains in the local regions of chr6, chr13, chr15, and chr20. However, it was not classified as a BFB event (Supplementary\nFig. 13b). BFBFinder, like the first instance, obtained a lower CN error from single chromosomes but was unable to assemble the final BFB paths with the translocations (Supplementary Fig. 14b and Supplementary Fig. 15e).\nWe additionally evaluated Ambigram using a range of sequencing depths and purities (Table 2). We gathered COLO829 and COLO829BL PE short reads, 10x linked reads, PB long reads, and ONT long reads. We arbitrarilymixed COLO829 and COLO829BL reads with tumor purities of 100%, 75%, 50%, 25%, 20%, and 10%. Further, we sampled 100%pure tumor reads at depths of 30\u00d7, 20\u00d7, 10\u00d7, and 5\u00d7.We ranAmbigram to reconstruct the two complex BFB instances using the segment CN profiles curated by Valle-Inclan et al., and the SVs called from PE, 10\u00d7, PB, and ONT reads independently. We consider the BFB event as resolved in Fig. 3f and Supplementary Fig. 16 if the inferred BFB path includes all ground truth FBIs (FBI recall = 1), otherwise unresolved; the scenarios resolved by inferring virtual FBI and utilizing read linkage are colored with orange and crimson, respectively. Ambigram successfully resolved complex BFB path with purity 100% and sequencing depth higher than 20\u00d7 fromall data protocols for both events (Fig. 3f). Ambigram becomes less sensitive as depth or purity\ndecreases, as the supporting reads of ground truth SVs are diminished in low depth or purity (Fig. 3f and Supplementary Fig. 17a\u2013c). Ambigram inferred virtual FBIs that were undetected due to low depth and purity to form BFB paths in the second BFB instance (Fig. 3f and Supplementary Fig. 17a). Furthermore, by adding linked or long-read linkage information, Both BFB instances are resolved in depth 5\u00d7 or purity 0.1 scenarios (Fig. 3f).\nWe further recruited three datasets, lung cancer cell line HCC827, breast cancer sample PD4875, and pancreatic cancer sample PD3641. The local genomic map of the BFB event in HCC827, PD4875, and PD3641 has been separately inferred by AmpliconReconstructor20, Greenman et al.25, and BFBFinder23. We consider the three BFB events inferred by state-of-the-art tools as silver-standard and check if Ambigram can resolve them (Table 3). With configuration on SVs and CNs, we successfully resolved the local BFB paths on all samples. The existence of a BFB event with four FBIs in HCC827 has been detected by AmpliconArchitect + AmpliconClassifier with PE short read data19 (Supplementary Fig. 18a\u2013c). AmpliconReconstructor further inferred the underlying BFB path is derived from four BFB cycles by incorporating linkage information from optical mapping (OM) data19. Ambigram resolved the extract BFB path as AmpliconReconstructor with PE or PE plus OM data (Supplementary Fig. 18d). Moreover, when CN configuration andonly one FBI arefitted intoAmbigram, it successfully inferred the three virtual FBIs and resolved the BFB path (Supplementary Fig. 18e\u2013f). For PD4875, Ambigram efficiently reconstructed the complex BFB path with translocation based on the information from SV and CN (Supplementary Fig. 19a), the same as Greenman et al. For PD3641, Ambigram resolved a BFB path that underwent five BFB cycles while BFBFinder interpreted it with seven BFB cycles (Supplementary Fig. 19b). We argue that according to the theory of Occam\u2019s razor36, Ambigram is better than BFBFinder as it uses less information to interpret this BFB event.\nIntratumor heterogeneity of complex BFBs in single-cell data Velazquez et al. performed single-cell DNA sequencing of 1,475 COLO829 cells. Although the CN profiles of single cells in COLO829 remain largely homogeneous (Supplementary Fig. 20a), Velazquez et al. demonstrated the heterogeneity of SVs in COLO829, leading to the evolution of its subclones33. Here, we check whether the two complex BFB instances discussed before exhibit heterogeneity in the subclone resolution. With hierarchical clustering, we labeled single cells with six major subclones (A-F) (Supplementary Fig. 20a). For the first complex BFB instance, no subclone agrees with bulk sequencing data due to the loss of FBIs and translocation. For the second complex BFB instance, there is an agreement of the local genomic map of BFB detected by subclones A, D, E, and F with the bulk sequencing data (Supplementary Fig. 15 and Supplementary Fig. 21). However, subclones B and C exhibit heterogeneity in the evolution stage two with loss of translocations, leading to different local genomic maps of BFB (Supplementary Fig. 21).\nWe further applied Ambigram to single-cell DNA data of gastric cancer mkn4532, which showed ten major subclones with distinct CN profiles (Supplementary Fig. 20b), to check for the presence of complex BFB events and the absence of intratumor heterogeneity in\nTable 3 | Summary of silver-standard datasets to benchmark Ambigram with the state-of-the-art\nDataset Standard Cancer type Protocol Data format Originally inferred by Ambigram\nHCC827 Silver Lung PE SV+CN AA + AC \u2713\nHCC827 Silver Lung PE+OM SV+CN AA + AC + AR \u2713\nPD4875 Silver Breast PE SV+CN Greenman et al. \u2713\nPD3641 Silver Pancreatic PE SV+CN BFBFinder \u2713\n\"\u2713\u201dmeans theBFB events aredetected and resolved.BFBbreakage-fusion-bridge,PEpaired-end,OMopticalmapping,SV+CNcalled structure variationandcopynumber,AAAmpliconArchitect,AC AmpliconClassifier, AR AmpliconReconstructor.\nNature Communications | (2023) 14:5528 6\ndetected BFB. We independently detected five BFB events that demonstrated varying subclonal heterogeneity on five chromosomes (chr1, chr3, chr11, chr12, and chr15). The BFB events in chr1 have three and one FBIs, yielding eight and six BFB cycles in subclones A andM8, respectively (Supplementary Fig. 22). Genes WDR47, TAF13, and TMEM167B demonstrate two more CNs in subclone A than in M8. The BFB event in chr3 consists of four FBIs that split the local region of chr3 in subclone M9 into nine segments. Ambigram resolved the local genomicmap that includes seven BFB cycles, which amplified the gene CNOT10 (H5-H9) four times (Supplementary Fig. 23a). However, the local region of chr3 in subcloneM4 is partitioned into five segments by two FBIs. Compared to the BFB event in M9, the M4 BFB path only contains three BFB cycles, with gene CNOT10 (H5-H9) being diploid (Supplementary Fig. 23b). In subclone M8, the local genome of chr11 involves eight BFB cycles with four FBIs (Supplementary Fig. 24). Besides, the local region in subclone A shows eight BFB cycles with three FBIs. Finally, the genome region in subcloneM6undergoes three BFB cycles with two FBIs (Supplementary Fig. 25). The occurrence times of BFB cycles in subclonesM8, A, andM6progressively decrease, resulting in the CNs of the carrying genes KIAA1549L, CD59, FBXO3, LMO2, CAPRIN1, and NAT10 also decreasing progressively. Regarding the BFB event in chr12, subclone M8 undergoes nine BFB cycles with four FBIs, leading to high amplification (CN \u2265 14) of genesRASSF3,GNS, TBC1D30, and WIF1 (Supplementary Fig. 26). Compared to subclone M8, the local regions of both subclonesM7 andM6undergo seven BFB cycles missing one different FBI. (Supplementary Fig. 27). With fewer BFB cycles, the genes have less than 10CNs. In the local regionof chr15, subclones A and M7 contain five and three FBIs, and both of them undergo eight BFB cycles (Supplementary Fig. 28). Segments H2-H3 covering genes SEMA4B, CIB1, GDPGP1, TTLL13, and NGRN have nine and seven CNs in A and M7, respectively. CRTC3 has five CNs in subclones A and M7. Segments H5-H8 covering genes GABARAPL3, ZNF774, and IQGAP1 have thirteen and eight CNs in subclones A and M7, respectively.\nAmbigram resolves oncovirus integration by complex BFB path Jia et al. have developed a conjugate graph-based algorithm FuseSV37 to decipher the local genomic map of oncovirus integrations for hepatocellular carcinomas (HCC)38. Here, we investigated the nine integration events in three HCC samples and identified seven events that had FBIs. We illustrated five instances of HBV interaction thatmay be interpreted by complex BFB events.\nHBV integrations in chr1 of the HCC sample 101T occur on oncogene CGN. The VITs and SVs partition the local genome region and the virus genome into five segments (H1-H5 and V1-V5), respectively (Supplementary Fig. 29a\u2013c). FuseSV inferred that the local genomicmap includes one copy of alleles of normal order (H1-H5) and one copy of an allele with a human inversion and short HBV segments (Supplementary Fig. 29e). Ambigram revealed that the BFB event occurred in two stages (Supplementary Fig. 29d). In the first stage, chr1 undergoes two BFB cycles. The first BFB cycle occurs when a sister chromatid is replicated, and the H5 segment is fused with its reverse complement. Then the second BFB cycle starts when the doublestrand breaks off at reverse segment H4. A duplication is reproduced, and reverse segmentH4 is fusedwith segmentH2. In the second stage, the HBV segments V3 and V4 are inserted into the area between the reverse segment H4 and segment H2 through the integration of HBV, leading to the final local genomic map of this complex BFB event.\nFor the other four integration events (260T_chr1, 260T_chr10, 261T_chr5, and 261T_chr16), FuseSV came to the same conclusion that the local genomic map of virus integration is the deletion of human segments by inserting short linear or reversed HBV segments (Supplementary Fig. 30\u201333). FuseSV explained the high amplification of HBV fragments, such as possible ecDNAs or linear DNA outside the local genome37. With Ambigram, we showed the possibility of virus-\ninduced complex BFB events. In summary, the human genome may integrate with the virus genome, and then the virtual contig formed undergoes several round BFB cycles on virus segments. In the next stage, another virus integration occurs to replace some segments on the BFB local genomic map (Supplementary Fig. 30\u201333).\nNext, we investigated an HCC sample S0007T139 that contained four VITs and stair-like CN profiles on chr7 (Fig. 4a). We found two possible complex BFB instances. In the first BFB instance, the SV and VIT breakpoints split the local human genome and the virus genome region into four and two segments, respectively (Fig. 4b-d). Ambigram inferred that segment V1 of HBV is first connected to segment H2 on chr7, leading to a truncation of the gene CALCR. Then three BFB cycles occur in the HBV-integrated local genomicmap (Fig. 4f). In the second BFB instance, the SV andVITbreakpoints split the local humangenome and the region of the viral genome into nine and three segments (Fig. 4g-i). We inferred that this complex BFB event consists of two stages. In the first stage, the HBV segment H8 on chr7 is connected to the reverse segment V1. Then the HBV-integrated local genomic map undergoes six BFB cycles, leading to the gain of CN of genes SPDYE3, AGFG2, MUC12, etc. In the second stage, another HBV integration connects segment H7 to segment V3, which replaces the tail of the BFB path and indicates the end of the HBV integration BFB event (Fig. 4i).\nFurthermore, we found that the BFB mechanism might mediate three HPV integration events in cervical cancer. HELA and SIHA cell lines are two well-known cervical cancer cell lines associated with HPV16 interactions40. Ambigram detects an integration of HPV in chr3 of the HELA cell line that truncates the gene FHIT (Supplementary\nFig. 34). Tumor suppressor alterations FHIT are common signs of carcinogenesis41. For the SIHA cell line, the complex BFB that involves the integration of HPV into chr13 leads to the amplification of the gene DACH1, MZT1, BORA, DIS3, and PIBF1 (Supplementary Fig. 35). BORA, DIS3, PIBF have been reported to be carcinogenic in multiple cancers42\u201344. Ambigram also detected a complex BFB event involving HPV integration in chr19 of the cervical cancer sample45, causing amplification of the ZNF and LILR gene families (Supplementary\nFig. 36). ZNFs are oncogenic in cancer progression46.\nBFB may drive the genome reorganizations of Homo Sapiens Recently, Nurk et al. have published a complete sequence of a human genome (T2T-CHM13) that fixes gaps and issues in the reference genomeGRCh3847. The complete T2T genome facilitates the possibility of inferring the evolution process ofHomo sapiens. Here, we conducted a genome synteny analysis of T2T (Fig. 5a and Methods). As a result, we identified two local genomic regions inwhich the BFBmechanismmay have carried out genomic reorganization during the evolution into Homo sapiens (Fig. 5b). Thefirst region is chr5:70,630,000\u201371,169,999, which can be divided into five genomic fragments in sequence. The first and second genomic fragments are reverse complementary to each other, and the third fragment is the same as the first. Ambigram resolved the BFB evolution process in two stages. In the first stage, the local region undergoes two BFB cycles, contributing to two forward fragments and one reverse fragment. In the second stage, two purple fragments are inserted into the BFB path, composing the final genomic sequence in T2T. The BFB mechanism may also explain the formation of the genome region that spans chr8:86,110,000\u201386,909,999, involving eight genomic fragments. The green fragments are either reverse complements or forward-matching sequences. Similarly, Ambigram deciphers that the BFB evolution process has two stages. First, the green fragments are concatenated with three BFB cycles. Second, the purple fragments are inserted in the BFB path, which constitutes the final genomic sequence in T2T.\nAmbigram detects recurrent FBIs and complex BFBs in 1000GP We applied Ambigram to 923 healthy whole genome data from the 1000 Genome Project (1000GP)48 to investigate the presence of\nNature Communications | (2023) 14:5528 7\ngermline BFB. We observed 85 recurrent FBI polymorphisms (occurring in more than 5% of samples in the cohort) in 1000GP, directly truncating 32 genes (Supplementary Fig. 37a). The top three genes that carry FBI polymorphisms are APP, C4BPA, and SUGCTwith a frequency of 91%, 52%, and 49%. Among the 32 FBI hotspot genes, 11 genes are associated with BFB events involving at least two FBIs (Supplementary\nFig. 37b). The top three genes are APP, PCDH15, and CNTNAP5 with a frequency of 49%, 33%, and 26%.\nAmbigram detects CHD-related recurrent FBIs and complex BFBs Congenital heart disease (CHD) is a substantial cause of neonatal death. As large chromosomal rearrangements and copy number\nvariations have been reported to be the genetic pathogenesis of CHD49\u201351, the complex BFB events are likely related to CHD. Here, we investigated the possible complex BFB events from330CHDprobands and 612 of their parents52, with 923 whole genome data from 1000GP as unaffected controls48.\nFirst, weobserved recurrent FBI polymorphisms (occurring in >5% of samples in a cohort) across CHD probands (n=71), their parents (n = 89), and 1000GP controls (n = 85). The top three genes that carry recurrent FBI polymorphisms are APP, C4BPA, and BORCS5 (Fig. 6a\u2013c and Supplementary Table 1). The frequency of FBIs occurring in APP is 94%, 85%, and 91% in the proband, relative, and control cohorts, respectively. The prevalence of FBIs in C4BPA is 59%, 57%, and 52% in the proband, relative, and control groups, respectively. The\nc\n1 3215HBV (AB014381.1) 1600\nV1 V2\npolymerase\npreS1/S2/S\nX-protein\nenhancer-IIenhancer-I core-promoter\npreS1/S2/S\npolymerase\n1622\nprecore/core-protein\nd\nHBV integration\nH2- V1-\nH2 H2\nH2\nH2+ H3-\nintra-chromosome SV\nComplementary reverse segments\nTRX-th FBI-hh BFB SV\nV1\n( )H3 H4 f Ambigram resolved BFB path on chr7 case 1 1X H2 H3 H4V1 H2\nH3H2\nH3\nReal SV Virutual SV Negative strand\nb\nchr7\nS007T1 chr7 instance 1\n93108722 93111000 93111703 93109120 5.03 2.40\nH1 H2 H3 H4 93109722 9311070393109777\n93 .1\nM\n5.135.00\nSegment copy number\nCALCR\n93109600\nH1 H2 H3 H4 H5 H6 H7 H8 H9\ng\nchr7"
        },
        {
            "heading": "99759000 100002500 100633000 10063500099761500 99849600 99853900",
            "text": "99761350 99849723 99901082 100633515 99853744 99902027 100634202 99759994\n2.04 7.324.23 6.79 1.748.809.318.596.68\nLAMTOR4 SPDYE3 PPP1R35 AGFG2 GIGYF1 EPHB4 MUC12\nGAL3ST4 PILRB C7orf61 SAP25 GNB2 SLC12A9 C7orf43 PILRA NYAP1 FBXO24 POP7 TRIP6 GATS_ENSG00000160844 MEPCE LRCH4 EPO SRRT\nGPC2 ZCWPW1 PCOLCE ZAN UFSP1\nSTAG3 TSC22D4 MOSPD3 ACHE\nPVRIG TFR2\nACTL6B\n99 .7\n5M\nSegment copy number S007T1 chr7 instance 2\nh\n1 3215HBV (AB014381.1) 1600\nV1 V2 V3\npolymerase\npreS1/S2/S\nX-protein\nenhancer-IIenhancer-I\ncore-promoter\npreS1/S2/S\npolymerase\n1857 3005\nprecore/core-protein\ni\nHBV integration\nintrachromosome\nSVs\nComplementary reverse segments TRX-hh FBI-ttFBI-hhTRX-ht BFB SV\nH3H2- H3+ H2\nV3H7+ V3+ H7\nH8H8+ V1- V1\nH7H6- H7+ H6\nH3H3+ H4- H4\n( )H3 H4 H5 H6H2 H7 H8 V1H4 H5 H6 H7 H8 H7 H8 H2 H3 H4 H5 H6 H7 H8\nV1H3 H4 H5 H6 H7 H8\nH1 H2 H3 H4 H5 H6 H7 H8 V1\nH3 H4 H5 H6 H7 H8 V1\nH7 H8H6\nH7H6 V3\nH3 H4 H5 H6 H7 H8\nk Ambigram resolved BFB path on chr7 instance 2 Real SV Virutual SV Fragment substitued in the second stage (First stage)\n1X\n(Second stage)\nPrevious part (same as the first stage)\nNegative strand\nH7 H8\n10\n8\n6\n4\n2\n0\nVIT: 56,876,415\nVIT: 93,109,722 VIT: 100,633,515 VIT: 100,634,202\n0 10 20 30 40 50 60 70 80 90 100 110 120 130 140 150 159 chr7\na\n93 10\n88 00\nbp\n93 11\n14 00\nbp\n93 10\n90 00\nbp\n93 10\n92 00\nbp\n93 10\n94 00\nbp\n931 096\n00b p\n931098 00bp\n93110000bp\n93110200bp\n93110400bp\n93110600bp\n93110800bp\n93111000bp\n93111200bp\n93 11\n16 00\nbp\nchr7\n80 0b\np\n100 0bp\n1200bp 1400bp 1600bp\n1800bp\n2000bp\n2200bp\n2400bp 2600bp\nAB014381.1\n2 4 6 8\n2 4\n6 8\ne CIRCOS plot of instance 1\n99 78\n0K B\n10 02\n90 KB\n10 03\n20 KB\n10 03\n50 KB\n10 03\n80 KB\n10 04\n10 KB\n100 440\nKB 100\n470 KB\n10050 0KB 100530KB 100560KB 100590KB\n99 81\n0K B\n99 84\n0K B\n99 87\n0K B\n99 90\n0K B\n999 30K\nB\n9996 0KB\n99990KB100020KB 100050KB\n100080KB\n100110KB\n100140KB\n100170KB\n100200KB\n100230KB\n100260KB 100620KB chr7 1200bp 1800bp 2400bp 3000bp 3600bp AB014381.1 2 4 6 8 10 2 4 6 8 10 j CIRCOS plot of instance 2\nFig. 4 | Two complex BFB instances involving HBV integration and genes CALCR, MUC12, etc., on chr7 of HCC S0007T1. a VITs and CN profiles of chr7 in S0007T1 - VIT positions are indicatedby red arrows, and theCNprofile is illustrated by red lines with the chr7 ideogram. b S0007T1 BFB instance 1 - the SV breakpoints split the local genomeregion into four segments. The light yellowand light red lines on the topdenote the relative positionsof SVbreakpoints on chr7, and the gray box shows the average CN of segments. The middle layer shows gene annotation. c S0007T1 BFB instance 1 - the VIT breakpoint splits the virus genome into two segments. The top layer shows functional annotation. d S0007T1 BFB instance 1 - list of VITs, SVs, and the segments connected by them. e CIRCOS diagram of S0007T1 BFB instance 1. f S0007T1 BFB instance 1 - Ambigram resolved BFB path. Segment V1 of HBV is connected to segment H2 on chr7. Then three BFB cycles happen on the HBV-integrated local genomic map. g S0007T1 BFB instance 2 - the\nSV breakpoints split the local genome region into nine segments. The vertical lines on the topdenote the relative positionsof SVbreakpoints on chr7, and the gray box shows the average CN of segments. The middle layer shows gene annotation. h S0007T1 BFB instance 2 - the VIT breakpoints split the virus genome into three segments. The top layer shows functional annotation. iS0007T1BFB instance2 - list of VITs, SVs, and the segments connected by them. j CIRCOS diagram of S0007T1 BFB instance 2. k S0007T1 BFB instance 2 - Ambigram resolved BFB path. This complex BFB event consists of two stages. In the first stage, the HBV reverse segment V1 is connected to segment H8 on chr7. Then the HBV-integrated local genomic map undergoes six BFB cycles. In the second stage, another HBV integration connects segment H7 to segment V3, which replaces the tail of the BFB path.\nNature Communications | (2023) 14:5528 8\noccurrence of FBIs harboring in BORCS5 is 31%, 48%, and 42% in the proband, relative, and control cohorts, respectively. Among these detected FBIs, most are associated with BFB events involving at least two FBIs (Fig. 6f) or complex BFB events involving insertion or deletion (Fig. 6a\u2013c). These recurrent FBI polymorphisms can either be inherited or de novo, with the inherited ones predominating (Fig. 6d). 91%, 85%, and 72% of the recurrent FBI polymorphisms occurring in APP, C4BPA, and BORCS5 probands are inherited from their parents. Although APP and C4BPA are associated with heart disease (Supplementary Table 2), we showed that these recurrent FBI polymorphisms in the two genes were non-causative factors of CHD.\nNext, we detected six genes carrying recurrent FBI polymorphisms that significantly (p value <1e-5, Chi-square test) enriched in CHD probands compared to healthy controls from 1000GP. These genes are PTPRQ, PUS7, ITPRID1, PLEKHB2, IL1RAPL1, and EXT1 (Fig. 6e and Supplementary Table 1). Around 30%population in CHD probands exhibit FBIs or complex BFB events that harbor the three genes (PTPRQ: 31%, PUS7: 29%, and ITPRID1: 28%). In their relatives, the frequencies are 24%, 24%, and 21% for PTPRQ, PUS7, and ITPRID1, respectively. However, the frequency of occurrences decreases significantly in 1000GP controls, especially for PTPRQ with 8% frequency (p value: 7.7274e-25). Then, around 15% population in CHD\nprobands exhibit FBIs or complex BFB events harboring the three genes (PLEKHB2: 16%, IL1RAPL1: 15%, and EXT1: 15%). In their relatives, the frequencies are 14%, 15%, and 11%. In the controls, the frequencies are 7%, 6%, and 6%. The above results suggest that PTPRQ, PUS7, ITPRID1, PLEKHB2, IL1RAPL1, and EXT1 might carry recurrent FBI or BFB polymorphisms associated with CHD. PTPRQ, PLEKHB2, IL1RAPL1, and EXT1 are predicted to be involved in biological processes such as heart and large blood vessel development, as well as cardiac phenotypes such as arrhythmias, valve diseases, and cardiomyopathy (Supplementary Table 2). The proportion of CHD-related de novo recurrent FBI polymorphisms has increased or even dominated (Fig. 6d). For example, 74% and 73% of recurrent FBI polymorphisms occurring in PLEKHB2 and IL1RAPL1 of the proband occur de novo.\nFinally, we demonstrated how Ambigram constructed the local genomic map of a complex BFB event associated with PTPRQ in the male proband SRR5115023. This complex BFB event involved two FBIs and three deletions. Ambigram inferred that the formation of complex BFB consists of two stages (Fig. 6g\u2013j). In the first stage, the local region on chr12 undergoes seven BFB cycles. In the second stage, three deletions occur. An FBI occurs in PTPRQ, which may cause its loss of functionality. The pedigree analysis showed that the FBI which links\nT2T T2T 3 1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13 14 15 16 17 18 19 20 21 22 X\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13 14 15 16 17 18 19 20 21 22 X\na b Average match rateNumber of matched fragments\ninstance 1\ninstance 2\n0.87\n3\n0.97\n3 0.97\n2 0.89\n23 0.88\nAmbigram resolved BFB path\ninstance 1\n(First stage) (Second stage)\ninstance 2\nAmbigram resolved BFB path\n)egats dnoceS()egats tsriF(\nchr5:70630000-70639999\nchr5:70630000-70639999\nchr5:71050650-71059999\nchr5:71160421-71169999\nchr5:71160421-71169999\nchr5:70630000-70639999 chr5:70640000-71050649\nchr5:70640000-71050649\nchr5:71060000-71160420\nchr5:71060000-71160420\nchr5:71050650-71059999\nchr5:71160421-71169999\nchr8:86110000-86389995\nchr8:86520000-86569999\nchr8:86723643-86909999\nchr8:86390000-86519999\nchr8:86610000-86699999\nchr8:86110000-86389995\nchr8:86520000-86569999\nchr8:86389996-86519999\nchr8:86723643-86909999\nchr8:86390000-86519999\nchr8:86610000-86699999\nchr8:86570000-86609999\nchr8:86700000-86723642\nFig. 5 | Two T2T local genomic regions where the genomic reorganizationmay have been carried out by the BFB mechanism during evolution. a The genome synteny analysis of T2T. Lines and curves indicate match fragments on the complete human genome, which are aligned by MUMmer464. Gray regions have few reverse matches, which BFB cannot explain. Five local regions colored blue have considerable reverse matches and are further aligned with themselves by our algorithm (Supplementary Methods, Algorithm 5). Regions with darker blue have a highermatch rate ormorematch fragments. Redboxes represent two local regions possibly derived from complex BFB events. b Ambigram resolves BFB evolution\nprocesses on T2T local genome regions of chr5 and chr8, respectively. The first instance consists of two stages. In the first stage, the local region undergoes two BFB cycles, contributing to two forward fragments andone reverse fragment. In the second stage, two fragments colored purple are inserted into the BFB path, composing thefinal genomic sequence inT2T. Similarly, the second instanceconsists of two stages too. Firstly, the local regionon chr8undergoes three BFB cycles, leading to three forward fragments and two reverse segments. Moreover, three fragments colored purple are inserted into the BFB path, contributing to the final genomic sequence in T2T.\nNature Communications | (2023) 14:5528 9\nsegments H10 andH11 in the proband SRR5115023 is inherited fromhis mother SRR5115024. For the other five genes APP, C4BPA, BORCS5, PUS7, and ITPRID1, we also present a complex BFB event and its hereditary situation separately (Supplementary Fig. 38\u201342)."
        },
        {
            "heading": "Discussion",
            "text": "BFB is a complex rearrangement worth noting that leads to tumor malignancy. Supported by its two hallmarks, stairs-like CN gains and FBI enrichment, most studies claimed the occurrence of BFB events without resolving the exact BFB path, that is, the evolution process of BFB3\u20139,11,12,16.\nIn recent years, modeling the \u201cpalindrome\u201d or \u201cambigram\u201d nature of BFB-induced local genomic map given by CN profiles or FBIs from a mathematical point of view has become a growing interest (Table 1). Kinsella et al. claimed the first formalmathematical formulation of the BFB mechanism: the BFB segment path is a palindrome string - successive inverted prefix duplications of a string, e.g., abccba22. They proposed an exponential-time algorithm to determinewhether a given copy number count vector fits into a path of the BFB palindrome22. Zakov et al. then developed BFBFinder to speed up Kinsella\u2019s model to linear time, which fits the copy number count vector by folding BFB palindrome collections23. BFBFinder was further enhanced by making themodel tolerant to noisy copy number count vectors and predicting all possible segment count vectors and associated BFB architectures24. Greenman et al.25 modeled the evolution space of BFB cycles with 2-d trees and stochastic folding, investigating the space of possible BFB\nFig. 6 | BFB analysis in CHD probands, relatives, and controls. a The recurrent FBI landscape in the CHD probands with gender and phenotypic information. The landscape is plotted by https://bio.oviz.org/demo-project/analyses/landscape68. bThe recurrent FBI landscape in the CHDparents. The CHDprobands are vertically aligned with their parents. c The recurrent FBI landscape in the 1000GP cohort. dThe ratio of recurrent FBI polymorphisms inherited or de novo. eThe enrichment p value of genes carrying FBI polymorphisms in probands against 1000GP controls. We used the one-sided Chi-square test without adjustments. f The frequency of genes carrying BFB event (FBI count > 1) in CHD probands, relatives, and controls. g The FBI and SV breakpoints split the local genome region of chr12 into 11 segments. The vertical lines above show the positions of SVs on chr12, and the middle layer shows gene annotation. The black box shows the average CN of segments.\nh List of SVs and the segments connected by them. The head-to-tail (ht) deletion and tail-to-tail (tt) FBIs are colored light blue and light green, respectively. The reverse complementary segments have a red border. The family tree on the right shows the inherited relationship between parents and the child, and samples colored purple undergo BFB events in the local region, while the sample without color does not have signs of a BFB event. The SV labeled with a purple circle is the FBI inherited from the mother sample SRR5115024 to the proband sample SRR5115023. i CIRCOS diagram of the complex BFB. j Ambigram resolved the BFB path in sample SRR5115023. This complex BFB event consists of two stages. In the first stage, the local region on chr12 undergoes seven BFB cycles. In the second stage, three SVs happen between segments H1 and H3, H3 and H5, and H7 and H9, deleting parts of the BFB path.\nNature Communications | (2023) 14:5528 10\npaths. Greenman et al.26 then discussed the complexity of rearrangement evolution, including BFB cycles with an infinite-site model. Recently, computational pipelines to resolve complex structure rearrangement including complex BFB have emerged (Table 1). AmpliconArchitect + AmpliconClassifier19 and AmpliconReconstructor20 handle short reads or optical mapping data to detect focal amplicons. Shale et al. introduced LINX which utilizes clustering, chaining, and annotating schemes to resolve complex BFB in somatic genome rearrangements21.\nHere, we proposed a graph algorithm, Ambigram, which has the following advantages over the above rivals in detecting BFBs and reconstructing their local genomic maps during evolution. First, Ambigram detects complex BFB events that carry deletion, duplication, insertion, and translocation, while mathematical models rely on the perfect BFB hypothesis that merely has FBIs (Tables 1 and 2). Second, Ambigram is compatible with PE, 10x, PB, ONT, and OM protocols. We showed that incorporating read linkage evidence from linked read, long read, or optical mapping data facilitated the efficacy of BFB reconstruction on in silico and real benchmarking. We also showed that Ambigram is robust with various sequencing depths and tumor purities. However, other models have only validated their efficacy in outdated aCGH or PE data, except AmpliconReconstructor supports OM data (Table 1). Third, Ambigram is comparable with single-cell data (Table 1). Ambigram can efficiently work out a series of BFB paths with subclone annotations that share similar DNA patterns whilst differentiating their unique SVs and CNs. We deciphered the intratumor heterogeneity on complex BFB events from single-cell sequencing of melanoma and gastric cancer data. Fourth, Ambigram interprets oncovirus integration (Table 1). We have demonstrated that the BFB cycle mechanismmaymediate seven HBV integrations in four liver cancers and three HPV integrations in three cervical cancers. The BFB cycles truncate the tumor suppressor FHIT or amplify the oncogene MUC12, BORA, DIS3, PIBF, or ZNFs.\nAlthough BFB is proposed as a mechanism that leads to complex genome rearrangements in cancers. We detected BFB signals from non-cancer data (Table 4). First, we suggested that two genome reorganizations of Homo Sapiens during evolution may be carried out by the BFB mechanism after investigating the complete human genome. Second, Ambigram discovered 85 recurrent FBI or complex BFB polymorphisms (occurring in more than 5% of samples in the cohort) in 1000GP, directly truncating 32 genes, including APP, C4BPA, and SUGCT. Third, Ambigramdetected FBIs or BFBs in complex diseases. In a case study of 330CHDprobands and612 relatives,with samples from 1000GP as controls, we observed recurrent FBI or complex BFB polymorphisms in the three cohorts. The three genes that are most frequently implicated in FBIs areAPP,C4BPA, andBORCS5. We find that PTPRQ, PUS7, ITPRID1, PLEKHB2, IL1RAPL1, and EXT1 that carry FBI or complex BFB polymorphisms are significantly (p value < 1e-5) related to CHD. The observed FBI or complex BFB polymorphisms can either be inherited or occur de novo.\nThere are some concerns that we need to address. First, despite the fact that the time complexity of Ambigram with respect to the number of segments (n) is O(n3) (Methods and Supplementary Fig. 43a), we discovered that the worst instance scenario rarely occurs and the segment count is low in real BFB scenarios. In this study, we resolved 27 real BFB events and found that the minimum, Q1, median, Q3, and maximum segment count were 4, 7.5, 9, 11, and 18, respectively. The FBI count reached amedian valueof 2 and amaximumvalue of 10, the total CN of all segments reached a median value of 51 and a maximum value of 302, and the largest segment CN had a median value of 6 and amaximum value of 20 (Supplementary Fig. 43b). When running on the Ubuntu 20.04 platform with a 12th Gen Intel(R) Core(TM) i7-12700F (20 CPUs) and 32 GB RAM, the real trials were completed in 40 seconds with SV and CN setup as inputs (Supplementary Fig. 43c). Despite the relatively small segment count, these BFB events\ncaused focal amplicons with high CN values. Additionally, for the 410 simulated BFB paths with varying numbers of segments (ranging from 6 to 15), FBIs (ranging from 2 to 7), total segment CN (ranging from 13 to 105), and largest segment CN (ranging from 3 to 11). Ambigram completed the task within ten seconds (Supplementary Fig. 43b, d).\nSecond, Ambigram is a computational model that resolves the exact local genome structures from possible complex BFB candidates. Even though we benchmarked Ambigram with six in silico BFB events, two gold-standard real BFB events, and three silver-standard BFB events that were originally inferred by state-of-the-art tools (Tables 2 and 3). The biological insight and the underlying evolution hypothesis derived from Ambigram still need independent validation from biological experiments. However, Ambigram is a cost-effective tool that can help scientists screen possible complex BFB hypotheses for subsequent wet-lab experiments to decipher novel insights on tumor and complex disease development."
        },
        {
            "heading": "Methods",
            "text": ""
        },
        {
            "heading": "Problem formulation",
            "text": "Segments and junctions. A fold-back inversion (FBI), the hallmark of BFB, serves as a linkage to connect two segments that are reverse complements in the reference genome. Thus, an FBI consists of two breakpoints, corresponding to one end of the two segments. FBI breakpoints from sequencing data partition the relevant local genome into an ordered set of segments S = \u2329s1, s2,...,sn\u232a. Denote the reverse complement segment of si as si; the reverse complements of S are often attributed to the BFB event. Each segment si and its reverse complement segment si can occur multiple times in a BFB event, and denote the number of occurrences or the copy number (CN) as c(si).\nMeanwhile, the linkage connecting segment si and its reverse complement si is referred to as FBI junction, denoted \u00f0si,si\u00de. Besides, the CN of \u00f0si,si\u00de derived from the sequencing data is labeled c\u00f0si,si\u00de. Consequently, denote a set of FBI junctions involved in aBFB event as J, where \u2223J\u2223 =m.\nBFB paths. We term the sequence of segments s1s2...sn as reference path R, the original genome sequence before BFB occurs. Based on the mechanism of BFB (Fig. 1a), each BFB cycle undergoes two operations: (1) fusion of two sister chromatids due to the lack of telomeres during DNA replication; (2) breakage on the fused bridge of two centromeres in the anaphase. Starting with the reference path (R), a BFB path (P) is the local genomic map obtained after a sequence of fusion and breakage operations. Since a BFB path has a palindromic suffix, it is called a palindrome-like path. In the next cycle, P is fused with its reverse complementary path P derived from DNA replication. Here is an illustration of the BFB event with FBI junctions J occurring on R (Supplementary Fig. 44a):\nR= s1s2:::sn\n!FusionRjR= s1s2:::snjsn:::s2s1 !BreakageP1 = s1s2:::snjsn:::sa+ 1sa sa 1:::s2s1, 1\u2264a\u2264n and \u00f0sa,sa\u00de 2 J !Fusion s1s2:::snjsn:::sa+ 1sajsasa+ 1:::snjsn:::s2s1 !BreakageP2 = s1s2:::snjsn:::sa+ 1sajsasa+ 1:::sb\nsb+ 1sb + 2:::snjsn:::s2s1, a\u2264b\u2264n and \u00f0sb,sb\u00de 2 J !FusionP2jP2\n!BreakageP3 = s1s2:::snjsn:::sa+ 1sajsasa+ 1:::sbjsb:::sc+ 1sc sc 1:::sa+ 1sajsasa + 1:::snjsn:::s2s1, a\u2264 c\u2264 b and \u00f0sc,sc\u00de 2 J\n!Fusion . . .\nNature Communications | (2023) 14:5528 11\nAs shown above, each BFB cycle involves an FBI junction, while an FBI junctionmay occur more than once. For example, \u00f0sa,sa\u00demay occur in two consecutive BFB cycles when a = b (Supplementary Fig. 44b). The FBI junction \u00f0si,si\u00de in each BFB cycle, where fusion happens, corresponds to either FBI sijsi or FBI sijsi on the BFB path obtained after breakage. Each path has a palindromic suffix symmetric about the breakpoint where the FBI happens. As a result, we can get a BFB path with allm FBI junctions, which is the final palindrome-like path derived from the BFB event.\nMathematical formulation of BFB. Based on the palindromic properties of the BFB paths, we have formulated the following definitions: 1. A mono-chainm(a, b) = sasa+1...sb\u22121sb or sbsb 1:::sa + 1sa is a list of\nconsecutive segments boundedby FBI breakpoints, where a and b are the indices of the start and end segments that meet a \u2264 b. The length of mono-chain m(a, b) is the number of segments the mono-chain spans, defined as b \u2212 a + 1. 2. A loopl\u00f0a,b\u00de= sasa+ 1:::sbjsbsb 1:::sa or sbsb 1:::sajsasa+ 1:::sb is a concatenation of two reverse complementary mono-chains, where a \u2264 b. The length of loop l(a, b) is half of the number of segments that the loop spans, defined as b \u2212 a + 1. 3. An entity is a collective name that represents either a mono-chain or a loop, i.e., e(a, b) =m(a, b) or l(a, b). An entity e(a1, b1) is the child entity (mono-chain or loop)of the entity e(a2, b2), if andonly if (a1 = a2orb1 = b2) and b1 \u2212 a1 < b2 \u2212 a2. Consequently, e(a2, b2) is parent entity (mono-chain or loop) of e(a1, b1).\nRecall that a BFB path is a palindrome-like path obtained after a sequence of fusion and breakage operations on the reference path. As proved in Supplementary Methods, any BFB path can be constructed by integrating mono-chains and then inserting loops.\nBFB DAG and BFB tree. With the above definitions and proofs in Supplementary Methods, BFB paths can be represented by a DAG G(V, E), where V is an entity set and E consists of directed edges that connect parent and child entities (Supplementary Fig. 45a). The DAG is named BFB DAG, which is a superset of a BFB treeT\u00f0V ,E0\u00de, where E0 E. A BFB tree connects all entities in V and uniquely corresponds to a BFB path (Supplementary Fig. 44c). Considering a DAGmay have many BFB trees, we simplify the search space by only using topological orders to construct BFB trees and compose BFB paths (Supplementary Fig. 45b). As a result, given mono-chains and loops, we can construct a BFB DAG by connecting eachpair of parent and child entities and reconstruct BFB paths by assembling the entities on BFB trees derived from the BFBDAG in topological orders (Supplementary Methods, Algorithm 2 and 3).\nAdjusting CN configuration. As vibration occurred in sequencing, the measured read depth may comprise noises37. The CN configuration of segments and junctions may deviate from the underlying staircase-like CN pattern, which is the other hallmark of BFB. Therefore, we utilize integer linear programming (ILP) to derive an estimated CN configuration that best fits the BFB CN pattern by minimizing all differences between the observed and estimated CNs. As a result, given the segments, FBI junctions, and CN profiles in a tumor sample, we can calculate the estimated CNs of the entities by ILP. Then we construct a BFB DAG by connecting all pairs of parent and child entities with a CN larger than 0. Finally, we reconstruct the BFB paths by connecting the entities based on topological orders in the BFB DAG (Fig. 1c)."
        },
        {
            "heading": "The algorithm of Ambigram",
            "text": "Definition of SV, CSV, and BFB. Genomic structural variations (SVs) are the rearrangement of large DNA segments over 50 base pairs53. An SV serves as a junction to connect two segments that are not adjacent to each other in the reference genome. SV thus consists of two breakpoints corresponding to one end of the two segments. If the two segments are from the same chromosome, the type of junction can be head-to-tail deletion (DEL-ht), tail-to-head duplication (DUP-th), headto-head fold-back inversion (FBI-hh), and tail-to-tail fold-back inversion (FBI-tt) (Supplementary Fig. 46a). If the two segments are from different chromosomes, the junction type can be head-to-tail translocation (TRX-ht), tail-to-head translocation (TRX-th), head-to-head translocation (TRX-hh), and tail-to-tail translocation (TRX-tt) (Supplementary Fig. 46b).\nMost SVs do not occur independently but are caused by some catastrophic events or are mediated by one biological mechanism in a cell, leading to a combination of different types of SVs that links segments from different positions of the genome15. We term such an SV set containing at least two SVs as complex structure variation (CSV). If the biological mechanism is a series of BFB cycles, the resulting CSV contains merely a group of FBIs with two same breakpoints14\u201316. We term such a CSV as perfect BFB. Studies reported that deletion, duplication, insertion, and translocation could be involved during BFB cycles13,21, we term this CSV as complex BFB.\nFinding BFB candidate SV sets. Given SVs derived from the whole genome sequencing data, we adopted a breadth-first search algorithm to group the SVs with near breakpoints into sets, such that SVs involved in the same CSV event are grouped into the same set (Supplementary Methods, Algorithm 1). We consider the SV set containing\nTable 4 | Summary of datasets to investigate potential BFB event with Ambigram\nDataset Data Type Protocol Data Format Ambigram\nCOLO829 Melanoma SC WGS \u2713\nmkn45 Gastric cancer SC WGS \u2713\n101T Liver cancer+HBV PE SV+CN \u2713\n260T Liver cancer+HBV PE SV+CN \u2713\n261T Liver cancer+HBV PE SV+CN \u2713\nS0007T1 Liver cancer+HBV PE WGS \u2713\nHELA Cervical cancer+HPV PE SV+CN \u2713\nSIHA Cervical cancer+HPV PE SV+CN \u2713\nCRR046045 Cervical cancer+HPV PE WGS \u2713\n1000GP Normal PE WGS \u2713\nCHD Heart disease PE WGS \u2713\n\u2713means the BFB events aredetected and resolved.BFBbreakage-fusion-bridge.SC single cell,PEpaired-end,WGSwholegenomesequencing,SV+CN called structure variation and copynumber in the local genome.\nNature Communications | (2023) 14:5528 12\nmore than one FBI as the BFB candidate SV set, and the local genome regions involved with this set undergo a BFB event.\nEstimating the CN configuration for the candidate BFB Converting depth to observed CN. Given a candidate BFB, we obtained the observedCNsof related segments and junctions from the BFB candidate SV set based on tumor purity \u03c1 and read depths called from the BAM file, as suggested in FuseSV37. Assume that the average ploidy of the tumor and normal is Pt and Pn, respectively. The average depth of one BFB pathDh isDh = Dg \u03c1\u00d7 Pt + \u00f01 \u03c1\u00de\u00d7 Pn, whereDg represents the average sequencing depth of whole genome. With the average depth of one BFB pathDh, we convert the read depthsD covered in segments and junctions into their CN C by C = DDh.\nExplanation of formulas. Given a BFB event involved with a set of segments S = \u2329s1, s2,..., sn\u232a, Formula (1) defines the objective of ILP to minimize the disparities between the observed and estimated CNs of segment si and FBI junction \u00f0si,si\u00de, which are denoted by \u03b5i and \u03bei,i for \u2200i\u2208 {1, 2,...,n}.\nmin Xn\ni = 1\n\u03b5i + Xn\ni= 1\n\u03be i,i \u00f01\u00de\nWe can obtain the observed CNs of segment si and FBI junction \u00f0si,si\u00de from the sequencing data, which are c(si) and c\u00f0si,si\u00de, respectively. Based on the mathematical formulation of BFB, the estimated CNs of the segments and junctions correspond to the number of times the entities occur in the resultant BFB path, which is defined as the CN of entity e(a, b), denoted by ce(a, b). Additionally, the CNs of monochain m(a, b) and loop l(a, b) are denoted by cm(a, b) and cl(a, b), respectively.Hence,we have the following ILP formulas that define two CN disparities respectively.\nOn the one hand, we denote the sets of mono-chains and loops that contain segment si by Mi = {m(a, b)\u2223a \u2264 i \u2264 b} and Li = {l(a, b)\u2223a \u2264 i \u2264 b}, respectively. In addition, the corresponding sets of estimated CNs are defined as Cim = fcm\u00f0a,b\u00dejm\u00f0a,b\u00de 2 Mig and Cil = fcl\u00f0a,b\u00dejl\u00f0a,b\u00de 2 Lig. Amono-chainm(a, b)\u2208Mi contributes cm(a, b) to the estimated CN of si, while a loop l(a, b)\u2208 Li contributes 2 \u22c5 cl(a, b) to the estimated CN of si. Therefore, we have formula (2) to define the CN differences for \u2200si\u2208 S:\n\u03b5i \u2264 X\nc2Cim\nc+ X\nc02Cil\n2 c0 0 @ 1\nA c\u00f0si\u00de\u2264 \u03b5i \u00f02\u00de\nOn the other hand, we denote the set of mono-chain pairs, which are connected by FBI junction \u00f0si,si\u00de, as Pi = {[m(a1, b1),m(a2, b2)]\u2223b1 \u2212 a1 > b2 \u2212 a2 and (a1 = a2 = i or b1 = b2 = i)}. Meanwhile, the set of loops that contains the FBI junction is defined as Li,i = {l(a, b)\u2223a = i or b = i}. We suppose that a mono-chain pair in Pi contributes their average to the estimated CN of \u00f0si,si\u00de. A loop l(a, b) contributes cl(a, b) to the estimated CN of \u00f0si,si\u00de. Hence, we define two CN sets Cip = f12 \u00bdcm\u00f0a1,b1\u00de+ cm\u00f0a2,b2\u00de j\u00bdm\u00f0a1,b1\u00de,m\u00f0a2,b2\u00de 2 Pig and Ci,iL = fcl\u00f0a,b\u00dejl\u00f0a,b\u00de 2 Li,ig. As a result, we have formula (3) to define the CN disparities for all FBI junctions \u00f0si,si\u00de, where \u2200i\u2208 {1, 2,...,n}:\n\u03be i,i \u2264 X\nc2Cip \u222aCi,iL\nc\n0\nB@\n1\nCA c\u00f0si,si\u00de\u2264 \u03be i,i \u00f03\u00de\nAdditionally, we introduce several default constraints to the CN configuration of mono-chains and loops so that the adjusted CN profiles match the underlying BFB CN pattern (Supplementary Methods). Firstly, the ILP constraints guarantee each entity (except for the reference path) must have a parent entity in the result so that all entities generatedby ILP canbe integrated into a BFBDAG. Besides,we incorporate constraints on the CN differences of entities of multiple\nsubclones for single-cell data to reconstruct several BFB paths with some similar entities. Furthermore, since the linked and long sequencing techniques deliver long-distance read linkages, which provide evidence of the possible connections among segments for a real BFB path, we append a linkage constraint if the linked or long reads are available.\nConstructing BFB DAG. After calculating CNs of mono-chains and loops by ILP,we can construct a BFBDAG,where a vertex represents an entity and a directed edge links an entity to its child entity. Besides, each vertex is assigned a CN that indicates how many times the entity repeats in the resultant BFBpath. Here are themain steps for creating a BFB DAG: 1. Choose all mono-chains and loops with CN larger than 0 as\nvertices, and sort all the entities in decreasing order of length. 2. For each mono-chain, link it to its child mono-chains and loops. 3. For each loop, if a mono-chain is a child of the loop, then link the\nloop to the mono-chain. 4. For each loop, link it to its child loops.\nFurthermore, we extract a BFB tree that uniquely corresponds to a BFB path from the DAG (Supplementary Fig. 44c). As a result, we can reconstruct BFB paths by connecting all the vertices on the BFB tree."
        },
        {
            "heading": "Resolving BFB path",
            "text": "Compose a BFB path with topological order. According to the definition, a BFB DAG is a superset of BFB trees, which represent many possible BFB paths. For simplicity, we follow topological orders to construct BFB trees and compose BFB paths. After finding a topological order by Supplementary Methods, Algorithm 2, we follow it to iteratively concatenate each pair of parent and child entities. During the process of constructing a BFB path, there is a temporary BFB path P that is extended by an entity in each iteration. According to the topological order, we insert one entity into a proper position in P, which still keeps a palindromic suffix after the insertion. Eventually, if all entities are added to P, we get the final BFB path (Supplementary Methods, Algorithm 3). As multiple BFB paths can be derived from a BFB DAG, Ambigram outputs the BFB path constructed in the first topological order derived by Supplementary Methods, Algorithm 2 by default. Note that entities on the BFB path are arranged in decreasing order of length. Moreover, Ambigram provides an option to output BFB paths composed in all topological orders for users to investigate.\nTolerating BFB path with imperfect FBIs. In a real scenario, an imperfect FBI junctionmayconnect a segment to its neighbor\u2019s reverse complementary segment, i.e., \u00f0si,sj\u00de, leading to the loss of segments. To figure out a BFB pathwith imperfect FBI junctions,we assume these junctions to be perfect, considering \u00f0si,sj\u00de as \u00f0si,si\u00de, when calculating entity CNs by ILP and building a BFB DAG. After finding a perfect BFB path, Ambigram will adjust the FBI junctions by revising sijsi to sijsj .\nTolerating BFB path with DEL, DUP, and INS. In a real scenario, a region undergoing BFB can involve deletion (DEL), duplication (DUP), and insertion (INS), except for FBI and translocation. After constructing a BFB path of a complex BFB event, Ambigram revised local genomeregions ofdifferent chromosomeson theBFBpathbasedon intrachromosomal SVs involved with deletion, duplication, and insertion.\nTemporal orders of BFB cycle and translocation. In practice, a BFB event can involve translocation (TRX) on multiple chromosomes. Therefore, we propose two modes in accordance with two temporal orders of the BFB cycles and translocation, BFB-to-TRX and TRX-toBFB. BFB-to-TRX assumes that translocation occurs after the BFB cycles. In this mode, we construct the BFB path from each\nNature Communications | (2023) 14:5528 13\nchromosome separately and then iteratively concatenate two or more BFB paths with translocation junctions (Supplementary Methods, Algorithm 4). TRX-to-BFB supposes that the translocation happens before the BFB cycles. Here, we first integrate chromosomes with translocation and then take the synthesis as a virtual contig to reconstruct BFB paths.\nBFB path with virus integration. Ambigram can resolve potential BFB paths mediated with oncovirus integration since human-virus integration is analog to translocation if we take both human chromosomes and virus genomes as contigs. There is no credible evidence that the BFB mechanism causes the rearrangement of the viral genome; therefore, we adopt the TRX-to-BFBmode to resolve the local genomic map of virus integration. Virus segments are inserted into a human chromosome, then several BFB cycles take place on the virusintegrated chromosome."
        },
        {
            "heading": "Remarks of Ambigram",
            "text": "Suppose the number of segments is n, and the time and space complexity of Ambigram is O(n3) and O(n2), respectively (Supplementary Methods)."
        },
        {
            "heading": "Experiment settings",
            "text": "In silico processing. We designed six instances: one perfect BFB path on a single chromosome, one BFB path with imperfect FBI, two BFB paths integrated with translocation, one BFB path with intrachromosome SVs, and one BFB path with virus integration. To simulate different sequencing methods in a BFB event, we first generated the FASTA file of the ground truth BFB path and reference path with GRCh38 reference genome. Then we used simulators, including wgsim54, PBSIM55, and LRSim56, to generate FASTQ files that include simulated reads. Moreover, we aligned the simulated reads with the reference genome to generate BAM files using the corresponding read alignment software, including BWA57, NGMLR58, and Long Ranger59. Furthermore, we extracted SV information as VCF files from the BAM files with different SV calling software, SvABA60, and Sniffles58. All simulation tools are listed in Supplementary Methods, Table S1. To evaluate the impact of tumor purity, we randomly mixed reference path and BFB path BAM files with a depth of 30\u00d7 and tumor purities of 100%, 75%, 50%, 25%, 20%, and 10% for PE, 10\u00d7, ONT, and PB data, respectively. Furthermore, we sampled pure BFB path reads in BAM files at depths of 30\u00d7, 20\u00d7, 10\u00d7, and 5\u00d7 to assess the impact of sequencing depth on deciphering BFB paths.\nWe also simulated 410 BFB paths for measuring the running time of Ambigram. Starting with a random reference path, we concatenated the path with its reverse complementary path and cut off a random number of tailing segments. Each BFB path was simulated iteratively in this way, given a segment count and FBI count. Besides, we addedminor duplications onto a BFB path with a probability of 30%.\nCOLO829 processing. We downloaded the melanoma COLO829 cell line from PRJEB2769813 that provides diverse read information in BAM files derived from PE, PB, ONT, and 10x sequencing methods (with reference genome GRCh37-lite). To simulate varying tumor purity and sequencing depth, we used the same method of processing simulated data to merge tumor samples with normal samples and sample BAM files with various depths, respectively. Then we used the corresponding SV calling software (Supplementary Methods and Table S1) to extract SV information from these processed reads and select the SV sets containing FBIs involvedwith the two curated BFB instances. Also, we incorporated additional linkage information from linked reads (10\u00d7) and long reads (PB and ONT) to help Ambigram find more accurate and convincing BFB paths. Additionally, we ran AmpliconArchitect19 to get SV and CN information of COLO829 with\ndefault parameters.We further usedAmpliconClassifier19 todetectBFB events in COLO829 by inputting the results from AmpliconArchitect.\nCN and SV/FBI metrics for benchmarking. To evaluate the performance of a tool in reconstructing the BFB path, we measured the consistencies of segment CN and SV compared to the ground truth BFB path. First, we measured the segment CN consistency with the metricCNaccuracy. TheCNaccuracy is defined as the ratioof segment CN correctly inferred; that is, the number of segments with correctly inferred CNs divided by the total number of segments. Second, we measured the SV/FBI consistency with SV/FBI precision, SV/FBI recall, and SV/FBI F1-score. Given a set of SVs/FBIs inferred by a tool and the set of ground truth SVs/FBIs from the BFB path, we counted the FP (false positive), TP (true positive), and FN (false negative). FP is the number of inferred SVs/FBIs that do not belong to ground truth; TP is the number of correctly inferred SVs/FBIs; and FN is the number of ground truth SVs/FBIs that are failed to infer. Then, we calculated precision, recall, and F1-score by Precision= TPTP+FP , Recall = TP TP+FN, and F1-score= 2 \u00d7 Precision\u00d7Recall Precision+Recall .\nHCC827, PD4875 and PD3641 processing. AmpliconReconstructor resolved BFB events on the HCC827 lung cancer cell line20. We obtained the SV and OM data from Luebeck et al.20. We wrote a script to convert the OM data into linkage information that Ambigram can utilize. For the breast cancer sample PD4875, we got the SV and CN information directly from Greenman et al.\u2019s work25. As for the pancreatic cancer sample PD3641, the SV and CN information was obtained from Zakov et al.23. We fit the SVs and CNs into Ambigram with default parameters. For BFBFinder24 that only requires CNs, we ran it in the Poisson error model with parameters \u201c-s -a -e=PoissonErrorModel -w=0.858\u201d and chose the first string as its final output.\nSingle-cell processing. COLO829 single-cell data was downloaded from GSE15140933. The single-cell MKN45 data was downloaded from PRJNA49880932. The BAM and CN files for single cells were obtained from Cell Ranger (with the reference genome GRCh37)32. We grouped single cells into subclones based on hierarchical CN clustering. Then we independently sampled the BAM file with read information into different subclone BAM files and called subclone SVs with SvABA60. Next, we grouped SVs based on distance (Supplementary Methods, Algorithm 1) andmanually selected theBFB candidate SV sets. For each BFB candidate, we utilized Ambigram to resolve BFB paths in relevant subclones in single-cell mode.\nOncovirus integration processing. We investigated nine integrations ofHBV in threeHCC samples38 and identified seven candidates for BFB. For each virus-induced BFB event, we directly used segment CNs, VITs, and SVs curated by Jia et al. (with reference genome GRCh37)37 to resolve BFB paths that can interpret the corresponding HBV interaction instance. As for theotherHCCsample, S0007T139, the SVs andCNs of the whole genome were called from SvABA60 and Patchwork61. We first grouped all SVs by distance (Supplementary Methods, Algorithm 1). Then we found two SV sets involved with virus-induced BFB. Finally, we utilized Ambigram to resolve the complex BFB events involved with virus integration under TRX-BFB mode.\nHELA data and SIHA data were downloaded from SRP04876940; CRR046045 data were downloaded from NGDC with accession code CRX04058545. The reads were aligned to mixed reference (GRCh38 and HPV reference database PaVE, https://pave.niaid.nih.gov/explore/ reference_genomes/human_genomes62) with BWA57. We called HPV integration sites and SVs using Manta63. For each sample, we searched for FBIs within local genome regions involved with HPV integrations and span several million base pairs. Then we took FBIs and HPV integrations in a local region as a BFB candidate SV set and used Ambigram to resolve the complex BFB events under TRX-BFB mode.\nNature Communications | (2023) 14:5528 14\nT2T processing. We downloaded the complete human telomere-totelomere assembly (T2T-CHM13v1.1) from https://www.ncbi.nlm.nih. gov/assembly/GCA_009914755.3/47. We ran MUMmer (with parameter -l 5000)64 to align the whole genomic sequence with itself without considering matches on the same local regions. We found around 10,000matched fragments ranging from 10 to 30 kilobase pairs (kbp). We considered thematched reverse complementary fragment pairs as indicators of BFB events, so we selected five regions with alternate forward and reverse-matched fragments, which resemble BFB paths. Then, we developed a dynamic programming algorithm (Supplementary Methods, Algorithm 5) to split each region into fragments of length 10 kbp and aligned the first fragment with the subsequent fragments in both forward and reverse directions. In addition, the algorithm evaluated the match rate with the number of matched base pairs divided by the average length of both matched fragments. In addition, we calculated the average match rate and count the number ofmatches in the five local regions. As a result, we selected two regions with a highmatch rate (97%) or manymatched fragments (n = 23), and forward and reverse fragments in both regions were arranged in an alternate order. Furthermore, we considered the first fragment as a reference and split it into several segments based on breakpoints delimited by comparing the reference with other matched fragments (Fig. 5b). Finally, we counted the occurrence of each segment as CN and utilized Ambigram to resolve the BFB paths.\n1000GP and CHD processing. The 1000GP control data were obtained from http://ftp.sra.ebi.ac.uk/vol1/run/48. We downloaded the CHD band and relative data from dbGaP with accession codes phs001138.v3.p2 and phs001194.v2.p23652. We perform alignment using BWA57 and call SVs by SvABA60 and Manta63. If the 5\u2019 and 3\u2019 breakpoints of an SV can be detected separately in both SvABA and Manta with 100bp tolerance, we kept such consensus SVs with the breakpoints from SvABA. Then, we filtered consensus SVs with <20 supportive reads. We counted the occurrences of each FBI among three cohorts. On the one hand, we found BFB candidate SV sets for each 1000GP sample based on Algorithm 1 in Supplementary Methods. Then we selected genes truncated by recurrent FBIs in 1000GP data and investigated BFB candidate SV sets involved with these gene regions. On the other hand, we conducted a significant enrichment test with a chi-square test between the CHD proband and control cohorts for each FBI. We selected FBI truncated genes that occurred in at least 50% of probands. Moreover, we chose FBI truncated genes with a p value < 1e-5 in the proband enrichment test. As a result, we found nine genes and predicted their gene ontology and human phenotypes using Harmonizome (https://maayanlab.cloud/Harmonizome/)65. We found BFB candidate SV sets with a range <10 million base pairs (Mb) and applied Ambigram to decipher the local genomic map for probands."
        },
        {
            "heading": "Reporting summary",
            "text": "Further information on research design is available in the Nature Portfolio Reporting Summary linked to this article."
        },
        {
            "heading": "Data availability",
            "text": "The COLO829 PE, 10x, PB, and ONT data are downloaded from PRJEB27698 [https://www.ebi.ac.uk/ena/browser/view/PRJEB27698]13. The HCC827 PE and OM data are retrieved from Luebeck et al.20. The PD4875 data is obtained from Greenman et al.25. The PD3641 data are obtained fromZakov et al.23. COLO829 single-cell data are downloaded from GSE151409 [https://0-www-ncbi-nlm-nih-gov.brum.beds.ac.uk/ geo/query/acc.cgi?acc=GSE151409]33. mkn45 single-cell data are downloaded from PRJNA498809 [https://www.ncbi.nlm.nih.gov/ bioproject/?term=PRJNA498809]32. The 101T, 260T, and 261T HCC data are obtained from Jia et al.37. The S0007T1 HCC data is obtained from the China National GeneBank DataBase (CNGBdb)with accession\nnumber CNP0003155 [https://db.cngb.org/search/project/ CNP0003155/]39. HELA data and SIHA data are downloaded from SRP048769 [https://www.ncbi.nlm.nih.gov/Traces/study/?acc= SRP048769&o=acc_s%3Aa]40; CRR046045 data is downloaded from NGDC with accession code CRX040585 [https://ngdc.cncb.ac.cn/gsa/ browse/CRA001401/CRX040585]45. The 1000GP data are obtained from http://ftp.sra.ebi.ac.uk/vol1/run/48. The CHD data are downloaded from dbGaP with accession codes phs001194.v3.p2 [https:// www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id= phs001194.v3.p2]52. GRCh37 and GRCh38 reference genomes are downloaded from https://www.ncbi.nlm.nih.gov/datasets/genome/ GCF_000001405.26/. The complete T2T genome is downloaded from https://www.ncbi.nlm.nih.gov/datasets/genome/GCA_ 009914755.3/. The processed data in this work are freely available at https://github.com/deepomicslab/Ambigram_paperor https://zenodo. org/badge/latestdoi/42897077766."
        },
        {
            "heading": "Code availability",
            "text": "The C++ packages are available freely at https://github.com/ deepomicslab/Ambigram or https://zenodo.org/badge/latestdoi/ 44234109367."
        },
        {
            "heading": "Acknowledgements",
            "text": "This research is funded by the Hong Kong Innovation and Technology Fund (ITF 9440236 to SCL) and CityU Applied Research Grant (9667204 to SCL).\nThe authors thank Mr. Bowen Tan for discussing the algorithm development. The authors thank Dr. Wenlong Jia for sharing his paper\u2019s oncovirus integration SVG plot of 101T, 260T, and 261T samples. The authors thank Dr. Yinan Wang and Miss. Mengyao Wang for discussing the result of the S0007T1 sample. The authors thank The Pediatric Cardiac Genomics Consortium for authorization to download the CHD data. WeacknowledgeProf. BruceD.Gelb for his helpwith theCHDstudy.We acknowledge the free license from Freepik that provides all anatomy images in Fig. 1e."
        },
        {
            "heading": "Author contributions",
            "text": "SCL supervised the project and designed the algorithm. CHL implemented the algorithm. CHL and LXC designed the experiments and analyzed thedata.GZP is involved in the analysis ofHPV integrationdata.\nWQZ is involved in the analysis of the CHD data. LXC and CHL drafted the manuscript. SCL revised the manuscript. All authors read and approved the final manuscript."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-41259-w.\nCorrespondence and requests for materials should be addressed to Shuai Cheng Li.\nPeer review information Nature Communications thanks Anthony Papenfuss and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.\nReprints and permissions information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nNature Communications | (2023) 14:5528 17"
        }
    ],
    "title": "Deciphering complex breakage-fusion-bridge genome rearrangements with Ambigram",
    "year": 2023
}