{
    "abstractText": "The microgrid is a group of smaller renewable energy sources (REs), which act in a coordinated manner to provide the required amount of active power and additional services when required. This article proposes coordinated power management for a microgrid with the integration of solar PV plants with maximum power point tracking (MPPT) to enhance power generation and conversion using a hybrid MPPT method based on particle swarm optimization-adaptive neuro-fuzzy inference system (PSO-ANFIS) to acquire rapid and maximum PV power along with battery energy storage control to maintain the stable voltage and frequency (V-f) of an isolated microgrid. In addition, it is proposed to provide active and reactive power (P-Q) regulation for the grid connected. The approach used provides more regulation due to the least root mean square error (RMSE), which improves photovoltaic (PV) potential extraction. The comparison results of the PSO-ANFIS and P&O controllers of the MPPT and the controller of the energy storage devices combined with the V-f (or P-Q) controller of the inverter all show effective coordination between the control systems. This is the most important need for contemporary microgrids, considering the potential of changing irradiance in the grid following mode, the grid forming mode under an island scenario, and backto-grid synchronization. With the test model, the islanded and grid-islanded-grid connected modes are investigated separately. The results demonstrate conclusively that the proposed strategies are effective. To run the simulations, MATLAB and SimPowerSystems are utilized.",
    "authors": [
        {
            "affiliations": [],
            "name": "Siddaraj SIddaraj"
        },
        {
            "affiliations": [],
            "name": "Udaykumar R. Yaragatti"
        }
    ],
    "id": "SP:e62facd73b91be128ab07c22b40aff7dd7201e00",
    "references": [
        {
            "authors": [
                "T.L. Vandoorn",
                "J.C. Vasquez",
                "J. De Kooning",
                "J.M. Guerrero",
                "L. Vandevelde"
            ],
            "title": "Microgrids: Hierarchical control and an overview of the control and reserve management strategies",
            "venue": "IEEE Ind. Electron. Mag",
            "year": 2013
        },
        {
            "authors": [
                "S. Chowdhury",
                "S.P. Chowdhury",
                "P. Crossley"
            ],
            "title": "Microgrids and Active Distribution Networks; Instutation of Engineering and Technology: London, UK, 2022",
            "year": 2022
        },
        {
            "authors": [
                "J.S. Kim",
                "S.M. So",
                "J.T. Kim",
                "J.W. Cho",
                "H.J. Park",
                "F.H. Jufri",
                "J. Jung"
            ],
            "title": "Microgrids platform: A design and implementation of a common platform for seamless microgrids operation",
            "venue": "Electr. Power Syst. Res",
            "year": 2019
        },
        {
            "authors": [
                "J.C. Vasquez",
                "J.M. Guerrero",
                "M. Savaghebi",
                "J. Eloy-Garcia",
                "R. Teodorescu"
            ],
            "title": "Modeling, analysis, and design of stationaryreference-frame droop-controlled parallel three-phase voltage source inverters",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2012
        },
        {
            "authors": [
                "T.L. Vandoorn",
                "B. Meersman",
                "J.D. De Kooning",
                "L. Vandevelde"
            ],
            "title": "Analogy between conventional grid control and islanded microgrid control based on a global DC-link voltage droop",
            "venue": "IEEE Trans. Power Deliv",
            "year": 2012
        },
        {
            "authors": [
                "H. Li",
                "F. Li",
                "Y. Xu",
                "D.T. Rizy",
                "S. Adhikari"
            ],
            "title": "Autonomous and adaptive voltage control using multiple distributed energy resources",
            "venue": "IEEE Trans. Power Syst",
            "year": 2012
        },
        {
            "authors": [
                "M.J.Z. Zadeh",
                "S.H. Fathi"
            ],
            "title": "A new approach for photovoltaic arrays modeling and maximum power point estimation in real operating conditions",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2017
        },
        {
            "authors": [
                "F. El Aamri",
                "H. Maker",
                "D. Sera",
                "S.V. Spataru",
                "J.M. Guerrero",
                "A. Mouhsen"
            ],
            "title": "A direct maximum power point tracking method for single-phase grid-connected PV inverters",
            "venue": "IEEE Trans. Power Electron",
            "year": 2017
        },
        {
            "authors": [
                "O. Khan",
                "S. Acharya",
                "M. Al Hosani",
                "M.S. El Moursi"
            ],
            "title": "Hill climbing power flow algorithm for hybrid DC/AC microgrids",
            "venue": "IEEE Trans. Power Electron",
            "year": 2017
        },
        {
            "authors": [
                "D.C. Huynh",
                "M.W. Dunnigan"
            ],
            "title": "Development and comparison of an improved incremental conductance algorithm for tracking the MPP of a solar PV panel",
            "venue": "IEEE Trans. Sustain. Energy 2016,",
            "year": 2016
        },
        {
            "authors": [
                "A.G. Al-Gizi",
                "A. Craciunescu",
                "S.J. Al-Chlaihawi"
            ],
            "title": "The use of ANN to supervise the PV MPPT based on FLC",
            "venue": "In Proceedings of the 2017 10th International Symposium on Advanced Topics in Electrical Engineering (ATEE), Bucharest, Romania,",
            "year": 2017
        },
        {
            "authors": [
                "M. Mir",
                "M. Kamyab",
                "M.J. Lariche",
                "A. Bemani",
                "A. Baghban"
            ],
            "title": "Applying ANFIS-PSO algorithm as a novel accurate approach for prediction of gas density",
            "venue": "Pet. Sci. Technol",
            "year": 2018
        },
        {
            "authors": [
                "M. Ahmed",
                "M. Abdelrahem",
                "A. Farhan",
                "I. Harbi",
                "R. Kennel"
            ],
            "title": "DC-link sensorless control strategy for grid-connected PV systems",
            "venue": "Electr. Eng",
            "year": 2021
        },
        {
            "authors": [
                "K. Sundareswaran",
                "V. Vigneshkumar",
                "P. Sankar",
                "S.P. Simon",
                "P.S.R. Nayak",
                "S. Palani"
            ],
            "title": "Development of an improved P&O algorithm assisted through a colony of foraging ants for MPPT in PV system",
            "venue": "IEEE Trans. Ind. Inform. 2015,",
            "year": 2015
        },
        {
            "authors": [
                "J. Lee",
                "Y. Kim"
            ],
            "title": "Comparative Estimation of Electrical Characteristics of a Photovoltaic Module Using Regression and Artificial Neural Network Models",
            "venue": "Electronics 2022,",
            "year": 2022
        },
        {
            "authors": [
                "M.G. Villalva",
                "J.R. Gazoli",
                "E. Ruppert Filho"
            ],
            "title": "Modeling and circuit-based simulation of photovoltaic arrays",
            "venue": "In Proceedings of the 2009 Brazilian Power Electronics Conference, Bonito-Mato Grosso do Sul, Brazil,",
            "year": 2009
        },
        {
            "authors": [
                "N. Priyadarshi",
                "S. Padmanaban",
                "J.B. Holm-Nielsen",
                "F. Blaabjerg",
                "M.S. Bhaskar"
            ],
            "title": "An experimental estimation of hybrid ANFIS\u2013 PSO-based MPPT for PV grid integration under fluctuating sun irradiance",
            "venue": "IEEE Syst. J. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "N. Priyadarshi",
                "S. Padmanaban",
                "P.K. Maroti",
                "A. Sharma"
            ],
            "title": "An extensive practical investigation of FPSO-based MPPT for grid integrated PV system under variable operating conditions with anti-islanding protection",
            "venue": "IEEE Syst. J. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "H. Darvish",
                "S. Rahmani",
                "A. Maleki Sadeghi",
                "M.H. Emami Baghdadi"
            ],
            "title": "The ANFIS-PSO strategy as a novel method to predict interfacial tension of hydrocarbons and brine",
            "venue": "Pet. Sci. Technol",
            "year": 2018
        },
        {
            "authors": [
                "M. Ramezani",
                "S. Li",
                "S. Golestan"
            ],
            "title": "Analysis and controller design for stand-alone VSIs in synchronous reference frame",
            "venue": "IET Power Electron",
            "year": 2017
        },
        {
            "authors": [
                "I. Gonzalez",
                "A.J. Calder\u00f3n",
                "F.J. Folgado"
            ],
            "title": "IoT real time system for monitoring lithium-ion battery long-term operation in microgrids",
            "venue": "J. Energy Storage 2022,",
            "year": 2022
        },
        {
            "authors": [
                "O. Tremblay",
                "L.A. Dessaint"
            ],
            "title": "Experimental validation of a battery dynamic model for EV applications",
            "venue": "World Electr. Veh. J. 2009,",
            "year": 2009
        },
        {
            "authors": [
                "S. Adhikari",
                "Y. Xu",
                "F. Li",
                "H. Li",
                "J.D. Kueck",
                "I.B. Snyder",
                "T.J. Barker",
                "R. Hite"
            ],
            "title": "Utility-side voltage and PQ control with inverter-based photovoltaic systems",
            "venue": "IFAC Proc. Vol",
            "year": 2011
        },
        {
            "authors": [
                "B. Naji Alhasnawi",
                "B.H. Jasim",
                "M.D. Esteban"
            ],
            "title": "A new robust energy management and control strategy for a hybrid microgrid system based on green energy",
            "venue": "Sustainability",
            "year": 2020
        },
        {
            "authors": [
                "T.K. Chau",
                "S.S. Yu",
                "T. Fernando",
                "H.H.C. Iu",
                "M. Small"
            ],
            "title": "An investigation of the impact of PV penetration and BESS capacity on islanded microgrids\u2013a small-signal based analytical approach",
            "venue": "In Proceedings of the 2019 IEEE International Conference on Industrial Technology (ICIT), Melbourne, VIC, Australia,",
            "year": 2019
        },
        {
            "authors": [
                "L. Kafle",
                "Z. Ni",
                "R. Tonkoski",
                "Q. Qiao"
            ],
            "title": "Frequency control of isolated micro-grid using a droop control approach",
            "venue": "In Proceedings of the 2016 IEEE International Conference on Electro Information Technology (EIT), Grand Forks, ND, USA,",
            "year": 2016
        },
        {
            "authors": [
                "R. Majumder",
                "B. Chaudhuri",
                "A. Ghosh",
                "G. Ledwich",
                "F. Zare"
            ],
            "title": "Improvement of stability and load sharing in an autonomous microgrid using supplementary droop control loop",
            "venue": "IEEE Trans. Power Syst",
            "year": 2009
        },
        {
            "authors": [
                "A. Firdaus",
                "S. Mishra"
            ],
            "title": "A double derivative-based droop controller for improved power sharing in inverter based autonomous microgrid",
            "venue": "In Proceedings of the 2018 IEEMA Engineer Infinite Conference (eTechNxT),",
            "year": 2018
        },
        {
            "authors": [
                "J. He",
                "Y.W. Li",
                "F. Blaabjerg"
            ],
            "title": "An enhanced islanding microgrid reactive power, imbalance power, and harmonic power sharing scheme",
            "venue": "IEEE Trans. Power Electron",
            "year": 2014
        },
        {
            "authors": [
                "Q.-C. Zhong",
                "T. Hornik"
            ],
            "title": "Cascaded current\u2013voltage control to improve the power quality for a grid-connected inverter with a local load",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2012
        },
        {
            "authors": [
                "M.N. Marwali",
                "A. Keyhani"
            ],
            "title": "Control of distributed generation systems-Part I: Voltages and currents control",
            "venue": "IEEE Trans. Power Electron",
            "year": 2004
        },
        {
            "authors": [
                "P. Giroux",
                "O. Tremblay",
                "G. Sybille",
                "P. Brunelle"
            ],
            "title": "Microgrid Dynamic Operation",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Citation: SIddaraj, S.; Yaragatti, U.R.;\nHarischandrappa, N. Coordinated\nPSO-ANFIS-Based 2 MPPT Control\nof Microgrid with Solar Photovoltaic\nand Battery Energy Storage System. J.\nSens. Actuator Netw. 2023, 12, 45.\nhttps://doi.org/10.3390/\njsan12030045\nAcademic Editors: Subhas\nMukhopadhyay and Nagender\nKumar Suryadevara\nReceived: 21 April 2023\nRevised: 4 May 2023\nAccepted: 9 May 2023\nPublished: 27 May 2023\nCopyright: \u00a9 2023 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: microgrid; photovoltaic (PV) system; PSO-ANFIS MPPT; PQ power control; battery energy storage system (BESS); droop control\n1. Introduction\nThe microgrid is a network of dispersed micro resources, storage devices, and demands that work as a single, autonomous, controllable system able to supply both electricity and heat to the service area [1]. The micro resources of a microgrid consist of minor devices with less than 1 MW of electricity and a power electronic (PE) interface. The distribution power supply is connected to the most prevalent non-conventional resources, such as solar photovoltaic systems, fuel cells, microturbines, storage devices, etc. The micro source controllers in a microgrid connect the storage and micro sources to the feeders, while the control system manages coordination amongst all sources [2]. The circuit breakers establish the point of common coupling (PCC), where the microgrid is connected to the electrical grid. When the microgrid is associated with the grid, the grid maintains its ability to operationally regulate frequency and voltage, but the microgrid continues to supply PCC\u2019s loads and acts as a PQ bus. For the microgrid to regulate its frequency and voltage in an isolated mode, it must provide all its power without much assistance from the grid. In this way, the microgrid performs like a power-voltage bus. Micro-resource controllers are present both locally and globally to coordinate and control\nJ. Sens. Actuator Netw. 2023, 12, 45. https://doi.org/10.3390/jsan12030045 https://www.mdpi.com/journal/jsan\nJ. Sens. Actuator Netw. 2023, 12, 45 2 of 20\nthe various modes of operation and resource management. On the inverter side droop, the controller is switched to share power among distributed generators in an autonomous mode and back to grid mode as the PQ controller. This controller is feasible to manage the microgrid\u2019s frequency and voltage in a manner comparable to that of a traditional synchronous machine [3]. Meanwhile, the secondary controller addressed in [4] reinstates the frequency and magnitude deviations generated by the primary controller, which is slower. An in-depth analysis of the similarities that exist between the control of an inverter and that of a synchronous generator in an isolated microgrid can be found in [5]. Sustaining the microgrid frequency and voltage within an appropriate range in distributed generation (DG) in a microgrid presents significant operational and control challenges. In [6], an adaptive control-based dynamic voltage regulation is suggested. The proposed control and battery management system is understudied in the context of Solar PV microgrid V-f and P-Q control literature. For PV converter Numerous MPPT, control techniques have been examined in the literary work [7,8]. As traditional MPPT approaches, perturb and observe (P&O), hill climbing (HC), and incremental conductance (INC) are examined [9,10]. P&O and HC techniques are easier to implement in hardware, but they include high oscillations that are closer to an MPPT, which causes power losses. The INC approach is precise and adaptable under varying meteorological conditions. However, it has complicated simulation and experimentation. However, with fluctuating sun irradiation, the aforementioned algorithms are ineffective. Artificial neural network (ANN) and intelligent fuzzy logic control (FLC) approaches are thus chosen as MPPT trackers to address the shortcomings of traditional MPPT algorithms under variable weather situations [11]. Fuzzy systems\u2019 derived rules and member functions both depend on probability to decide how the system will work. The examination of them is immoderate and sensitive to parameter changes. ANN techniques, on the other hand, depend on learned information and a multi-layered structure. The primary problem with this strategy is that there are no rules for establishing layer architecture. Furthermore, FLC and ANN are both comprehensive approaches to intelligence. An ANFIS technique is a rule base of inference that uses learning data to accelerate the calculations required for factual modeling while retaining high accuracy [12]. The PSO method is used to modify the MPPT and the parameters of PI controller which in turn compensates for the model\u2019s unaccounted-for losses and significantly reduces DC-link voltage overshoots [13]. Particle swarm optimization (PSO), firefly algorithm, artificial bee colony (ABC), and ant colony optimization (ACO) are examples of contemporary AI approaches that are utilized to address optimized problems [14,15]. PSO produces an excellent result with little user adjustment. The PSO approach has several benefits over the optimization methods mentioned above, including a lower sample point, simpler mathematical analysis, simple hardware implementation, and cost-effective computer estimate. It also enables quick and accurate PV power monitoring under various operating conditions. The effectiveness of renewable power systems is currently a top concern related to optimization problems and a burgeoning research area for academia. The industry\u2019s specialists cannot discuss the offered optimization problems\u2019 intricate mathematical formulations. By combining knowledge from academia with applications in the industrial sector, optimization challenges may be addressed with microgrids, to maintain a voltage regulation goal in addition to frequency controlling. This research presents a coordinated control algorithm that could be used to enhance PV generation and its ability to control voltage and frequency as well as an active and reactive power in both off-grid and grid-connected microgrids. For this study, precise models of PV systems with two MPPT methods such as P&O and PSO-ANFIS were studied, and the proposed PSO-ANFIS-based control method was developed with photovoltaic functioning and microgrid integration. The most important thing about this work is the novelty of controllers that lie in the coordination in a system among the proposed controllers. These include the control on the PV side with maximum power point tracking (MPPT), battery energy storage system (BESS) control, and V-f and P-Q control in the\nJ. Sens. Actuator Netw. 2023, 12, 45 3 of 20\ninverter. By integrating the proposed PSO_ANFIS MPPT control method which provides fast convergence, zero steady-state error achieving the power balancing aim at either side of the converter can invariably manage the DC side voltage at the right value to keep the AC side voltage at the utility necessary level. This work presents accurate power sharing maintaining stable frequency and voltage in grid-connected mode as well as an autonomous microgrid mode which is a significant contribution to the presented work. In addition, the controls can easily switch from one mode to another, for example, from utility P-Q to V-f controller in isolated operation, without any loss of performance. It has been found that the offered methods of control are effective. The measured values of voltages and current are used to design the controls in abc-dq0 reference frames. As a result, it is simple and quick to build, and also it eliminates the need for transforming between different reference frames, hence making the controller much simpler. The structure of the paper is as follows: Section 2 depicts the analytical modeling of photovoltaic systems with the proposed PV MPPT control and coordinated P-Q control. Section 3 describes a BESS with the unit of synchronization and droop control method. Section 4 provides compelling evidence that the suggested control strategies are effective. Finally, Section 5 provides a summary of the paper.\n2. Photovoltaic Systems with P-Q Control Method\nThe two inverters and utility test microgrid electrical energy network are shown in Figure 1. The following are the main parts of the proposed microgrid: Solar PV, BESS, and Grid. For this study, MATLAB/SIMULINK is used to simulate a two-inverter, three-phase, grid-based test microgrid. A distribution line of the grid is connected to the PV system and BESS inverters. The PCC is where loads are linked. For one inverter, the input is a PV system followed by a boost converter. For the other inverter, the input is a BESS. In microgrid mode, the two inverters and the grid work together in a coordinated PQ and droop-controlled islanded mode to keep system frequency and bus voltages stable while making sure that generation and load are balanced.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 3 of 20\nwork is the novelty of controllers that lie in the coordination in a system among the proposed controllers. These include the control on the PV side with maximum power point tracking (MPPT), battery energy storage system (BESS) control, and V-f and P-Q control in the inverter. By integrating the proposed PSO_ANFIS MPPT control method which provides fast convergence, zero steady-state error achieving the power balancing aim at either side of the converter can invariably manage the DC side voltage at the right value to keep the AC side voltage at the utility necessary level. This work presents accurate power sharing maintaining stable frequency and voltage in grid-connected mode as well as an autonomous microgrid mode which is a significant contribution to the presented work. In addition, the controls can easily switch from one mode to another, for example, from utility P-Q t V-f troller i isolated operation, without any loss of performance. It has been found that the offered met ods of control ar effective. The measured values of voltages and current are used to design the controls in abc-dq0 reference frames. As a result, it is simple and quick to build, and also it eliminates the need for transforming between different reference frames, hence making the controller much simpler.\nThe structure f the pap r is as follows: Section II d pi ts the analytical modeling of photovoltaic systems with the proposed PV MPPT control and coordinated P-Q control. Section III describes a BESS with the unit of synchronization and droop control method. Section IV provides compelling evidence that the suggested control strategies are effective. Finally, Sec ion V provides a summary of the paper.\n2. Photovoltaic Systems with P-Q Control Method The two inverters and utility test microgrid electrical energy network are shown in\nFigure 1. The following are the main parts of the proposed microgrid: Solar PV, BESS, and Grid. For this study, MATLAB/SIMULINK is used to simulate a two-inverter, three-phase, grid-based test microgrid. A distribution line of the grid is connected to the PV system and BESS inverters. The PCC is where loads are linked. For one inverter, the input is a PV system followed by a boost convert r. For the other inverter, the input is a BESS. In microgrid mode, the two inverters and the grid work together in a coordinated PQ and droop-controlled islanded mode to keep system frequency and bus voltages stable while making sure that generation and load are balanced.\nBoost Converter\nSun\nPCC Inv_PV\nPV Array\nLOADS\nGRID\nInverter LC filter\nTRANSFORMER_1\nInverter LC filter\nInv_BESSStorage Device TRANSFORMER_2\nTRANSFORMER_3\nFigure 1. AC microgrid architecture.\nFigure 1. AC microgrid architecture.\nJ. Sens. Actuator Netw. 2023, 12, 45 4 of 20\n2.1. Solar PV Modeling and System Configuration\nFigure 2 shows the equivalent circuit for the practical solar cell. The physics of semiconductors gives us the basic equation that describes the I\u2013V characteristic of an ideal solar cell in a mathematical way [16]. It is as follows in (1):\nI = Ipv,cell \u2212 Io,cell ( exp (\nqV akT\n) \u2212 1 )\n\ufe38 \ufe37\ufe37 \ufe38 Id\n(1)\nwhere Id is the Shockley diode equation, Io,cell [A] is the reverse saturation or leakage current of the diode [A], Ipv,cell is the current produced by incident light (directly proportional to Sun irradiation), a is the diode ideality constant, T [K] is the temperature of the p-n junction, k is the Boltzmann constant, and q is the electron charge 1.602176634 \u00d7 10\u221219C.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 4 of 20\n2.1. Solar PV Modeling and System Configuration Figure 2 shows the equivalent circuit for the practical solar cell. The physics of semiconductors giv s us the basic equation that describes the I\u2013V characteristic of an ideal solar cell in a mathematical way [16]. It is as follows in (1):\nexp 1 , ,\nqV I I I\npv cell o cell akT\nI d\n= \u2212 \u2212   \n    \n(1)\nwhere Id is the Shockley diode equation, Io,cell [A] is the reverse saturation or leakage current of the diode [A], Ipv,cell is the current produced by incident light (directly proportional to Sun irradiation), a is the di de ideality constant, T [K] is the temperature of the p-n junction, k is the Boltzmann constant, and q is the electron charge 1.602176634 \u00d710 \ud835\udc36.\nFigure 2. Single-diode model of photovoltaic cell.\nThe fundamental Equation (1) of the simple photovoltaic cell does not describe the IV characteristic of an actual solar module. Observation of the features at the solar module terminals demands the addition of extra factors to the fundamental equation because practical modules are composed of several interconnected photovoltaic cells:\n( ) exp 1 V IRV IR ssI I Ipv o V a Rpt ++ = \u2212 \u2212 \u2212         \n(2)\nwhere Ipv and Io are the photovoltaic and saturation currents of the module, respectively, and Vt = NskT/q is the thermal voltage of the module with Ns cells connected in series. Series-connected cells produce higher output voltages whereas those connected in parallel boost current. The photovoltaic and saturation currents may be stated as Ipv = Ipv,cellNp and Io = Io,cellNp, respectively, if the module is made up of parallel connections of cells Np. In (2), Rp is the equivalent parallel resistance and Rs is the corresponding series resistance of the array. The following equation of array is given as:\nexp 1 N NSer SerV IR V IRs sN NPar ParI N I N Ipv oP Par Par V aN Nt Ser SerRP NPar + + = \u2212 \u2212 \u2212                                                \n(3)\nwhere the parameters for each module are Ipv, Io, Rs, Rp, and Vt. Please note that the values of Ns, the series cell numbers within a single solar module, are distinct from Nser in the equation above. Using the above equations and parameters the adapted photovoltaic modeled with the standard I\u2013V characteristics with MPP under variable irradiance (W/m2) with the cell temperature of 25 \u00b0C as shown in Figure 3. The parameters of the PV panel under study\nFigure 2. Single-diode model of photovoltaic cell.\nThe fundamental Equation (1) of the simple photovoltaic cell does not describe the I-V characteristic of an actual solar module. Observation of the features at the solar module terminals demands the addition of extra factors to the fundamental equation because practical modules are composed of several interconnected photovoltaic cells:\nI = Ipv \u2212 Io ( exp (\nV + IRs Vta\n) \u2212 1 ) \u2212 (V + IRs)\nRp (2)\nwhere Ipv and Io are the photovoltaic and saturation currents of the module, respectively, and Vt = NskT/q is the thermal voltage of the module with Ns cells connected in series. Series-connected cells produce higher output voltages whereas those connected in parallel boost current. The photovoltaic and saturation currents may be stated as Ipv = Ipv,cellNp and Io = Io,cellNp, respectively, if the module is made up of parallel connections of cells Np. In (2), Rp is the equivalent parallel resistance and Rs is the corresponding series resistance of the array. The following equation of array is given as:\nIP = NPar Ipv \u2212 NPar Io\nexp V + IRs ( NSer Par ) VtaNSer \u2212 1 \u2212 V + IRs ( NSer NPar ) RP (\nNSer NPar\n)  (3)\nwhere the parameters for each module are Ipv, Io, Rs, Rp, and Vt. Please note that the values of Ns, the series cell numbers within a single solar module, are distinct from Nser in the equation above. Using the above equations and parameters the adapted photovoltaic modeled with the standard I\u2013V characteristics with MPP under variable irradiance (W/m2) with the cell temperature of 25 \u25e6C as shown in Figure 3. The parameters of the PV panel under study are shown in Table 1. The 15 series panels with 190 strings totaling 1 MW are considered under study.\nJ. Sens. Actuator Netw. 2023, 12, 45 5 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 5 of 20 are shown in Table 1. The 15 series panels with 190 strings totaling 1 MW are considered under study. Table 1. PV panel parameters at 1000 W/m2 and 25 \u00b0C.\nParameters Nominal Value PMPP 355.012 VMPP 43.4 IMPP 8.18 VOC 51.9 ISC 8.68\nThe MPP varies as cell temperature and irradiance change. An MPPT controller\ncontrols a converter that is linked to the PV system as shown in Figure 4. The MPPT is affected by both radiation and temperature variation. Thus, under any circumstance, the MPPT controller is guided by the PSO-ANFIS and P&O MPPT algorithms to adjust the operating point in the direction of the MPP [17].\nMPPT Vpv Ipv\nC C\nL D\nPWM\nTo VSC\nPV Panel\nFigure 4. Controller for MPPT boost converter coupled to a PV.\n2.2. PSO-ANFIS MPPT Control The training and refining of ANFIS requirement have become a difficult challenge for developers. The PSO is simpler to implement and has a more rapid convergence rate than gradient algorithms [18]. The PSO also does not require any kind of initial parameter computation or a specific learning rate. The ANFIS controller depicted in Figure 5 is 5\nParameters Nominal Value\nPMPP 355.012 VMPP 43.4 IMPP 8.18 VOC 51.9 ISC 8.68\nThe MPP varies as cell temperature and irradiance change. An MPPT controller controls a converter that is linked to the PV system as shown in Figure 4. The MPPT is affected by both radiation and temperature variation. Thus, under any circumstance, the MPPT controller is guided by the PSO-ANFIS and P&O MPPT algorithms to adjust the operating point in the direction of the MPP [17].\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 5 of 20 are shown in Table 1. The 15 series panels with 190 strings totaling 1 MW are considered under study. Table 1. PV panel parameters at 1000 W/m2 and 25 \u00b0C.\nParameters Nominal Value PMPP 355.012 VMPP 43.4 IMPP 8.18 VOC 51.9 ISC 8.68\nFigure 3. The adopted PV array characteristics.\nThe MPP varies as cell temperature and irradiance change. An MPPT controller controls a converter that is linked to the PV system as shown in Figure 4. The MPPT is affected by both radiation and temperature variation. Thus, under any circumstance, the MPPT controller is guided by the PSO-ANFIS and P&O MPPT algorithms to adjust the operating point in the direction of the PP [17].\nMPPT Vpv Ipv\nC C\nL D\nPWM\nTo VSC\nPV Panel\nFigure 4. Controller for MPPT boost converter coupled to a PV.\n2.2. PSO-ANFIS MPPT Control The training and refining of ANFIS requirement have become a difficult challenge for\ndevelopers. The PSO is simpler to implement and has a more rapid convergence rate than gradient algorithms [18]. The PSO also does not require any kind of initial parameter computation or a specific learning rate. The ANFIS controller depicted in Figure 5 is 5\nFigure 4. Controller for MPPT boost converter coupled to a PV.\nJ. Sens. Actuator Netw. 2023, 12, 45 6 of 20\n2.2. PSO-ANFIS MPPT Control\nThe training and refining of ANFIS requirement have become a difficult challenge for developers. The PSO is simpler to implement and has a more rapid convergence rate than gradient algorithms [18]. The PSO also does not require any kind of initial parameter computation or a specific learning rate. The ANFIS controller depicted in Figure 5 is 5 layered as well, a structure of hierarchy whose primary components are antecedents and conclusions. These mathematical formulas describe multilayer feedforward networks:\nWj = \u00b5pj(x) \u2217 \u00b5Qj(y), Wj = Wj\nW1 + W2 , j = 1, 2. (4)\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 6 of 20 layered as well, a structure of hierarchy whose primary components are antecedents and conclusions. These mathematical formulas describe multilayer feedforward networks: ( )* ( ),j jWj p x Q y\u03bc \u03bc= 1 2 ,j W Wj W W = + 1,2.j = (4) K1, K2, and K can be expressed as follows: 1 1 1 1 ,K A x B y R z= + + 2 2 2 2K A x B y R z= + + (5) 1 1 2 2 1 1 1 2 2 1 2 WK W KK W K W K W W \u2212 \u2212+= = + + (6)\n32\n2\n1( ) 1 [(( ) ) ]\n( ) exp\nj bj j j\nbj\nj j\nj\np x x r p\nx r p x\np\n\u03bc\n\u03bc\n\u2212 = + \u2212     \u2212   = \u2212           \n(7)\nwhere the parameters pj, rj, and bj are t e membership function. According to the equations given above, the antecedent element can depend on pj, rj,\nand bj whi e being tra ned. Let aj, bj, and cj represe t the conclusion components. The number of members of the conclusion component chromosomes is composed as (N + 1)S, where N is the total amount of data input and S is the number of rule bases. Thus, the expression is evaluated by RMSE estimations [19,20].\nFaster dynamics, a quicker speed of convergence, and a simpler design are just a few benefits this controller provides over conventional MPPT controllers. Fuzzification, inference, and defuzzification processes make up the main building blocks of this approach. Given an input parameter (PV voltage), the final signal of the pulse-width modulation (PWM) created by the MATLAB/Simulink model of a PSO-ANFIS technique is called the duty ratio. Figure 6 depicts the comprehensive flowchart arrangement of the PSO-ANFIS-based MPPT control. It is necessary to correctly modify the membership values based on the fuzzy data gathered utilizing a potent ANFIS algorithm with learnt training rules before the error is decreased to an absolute minimum. The trained system can function as a controller as MPPT once the appropriate membership parameters have been adjusted.\nK1 = A1x + B1y + R1z, K2 = A2x + B2y + R2z (5)\nK1 = W1K1 + W2K2\nW1 + W2 =\n\u2212 W1K1 + \u2212 W2K2 (6)\n\u00b5pj(x) = 1 1+[((x\u2212rj)pj)2] bj\u22123\n\u00b5pj(x) = exp\n[ \u2212 [( x\u2212rj\npj\n)2]bj]  (7)\nwhere the parameters pj, rj, and bj are the membership function. According to the equations given above, the antecedent element can depend on pj, rj, and bj while being trained. Let aj, bj, and cj represent the conclusion components. The number of members of the conclusion component chromosomes is composed as (N + 1)S, where N is the otal amount of data input and S is the number of rule bases. Thus, the expression is evaluated by RMSE estimations [19,20]. Faster dynamics, a quicker speed of convergence, and a simpler design are just a few benefits this controller provides over conventional MPPT controllers. Fuzzification, inference, and defuzzification processes make up the main building blocks of this approach. Given an input parameter (PV voltage), the final signal of the pulse-width modulation (PWM) created by the MATLAB/Simulink model of a PSO-ANFIS technique is called the\nJ. Sens. Actuator Netw. 2023, 12, 45 7 of 20\nduty ratio. Figure 6 depicts the comprehensive flowchart arrangement of the PSO-ANFISbased MPPT control. It is necessary to correctly modify the membership values based on the fuzzy data gathered utilizing a potent ANFIS algorithm with learnt training rules before the error is decreased to an absolute minimum. The trained system can function as a controller as MPPT once the appropriate membership parameters have been adjusted. J. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 7 of 20\nCollection of PV Data from system\nCollect ion of Fuzzy Data\nApplication of FIS Rule\nImplementat ion of ANFIS Model\nT rain model using PSO\nCheck Error <=Max.Error\nReturn\nNew Numerical Simulation\nNO\nYES\nFigure 6. Flowchart of PSO_ANFIS-based MPPT.\nThis procedure is used to adapt the boost converter duty ratio determined by the flowchart in Figure 6 and the PSO-ANFIS parameters are listed in Table 2 for use during defuzzification.\nThe factors of the antecedent/consequent parameters are often examined separately in the conventional method. In this PSO-ANFIS approach, the mean square error is reduced by all parameters being trained and tested simultaneously. The ANFIS architecture\u2019s adaptive learning is calculated through online learning evaluation using the input/output parameters. Figures 7 and 8 show the trained and tested data with the error of the PSO-ANFIS controller.\nFigure 6. Flowchart of PSO_ANFIS-based MPPT.\nThis procedure is used to adapt the boost converter duty ratio determined by the flowchart in Figure 6 and the PSO-ANFIS parameters are listed in Table 2 for use during defuzzification.\nTable 2. PSO-ANFIS parameters.\nThe factors of the antecedent/consequent parameters are often examined separately in the conventional method. In this PSO-ANFIS approach, the mean square error is reduced by all parameters being trained and tested simultaneously. The ANFIS architecture\u2019s adaptive learning is calculated through online learning evaluation using the input/o tput param ters. Figures 7 and 8 show the trained and tested data with the error of the PSOANFIS ontroller.\nJ. Sens. Actuator Netw. 2023, 12, 45 8 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 8 of 20\nFigure 7. Train Data with the error of PSO_ANFIS.\nFigure 8. Test Data with the error of PSO_ANFIS.\n2.3. Inverter Control The output voltage (DC bus voltage) of the boost converters is maintained at a stable\nacceptable value. This is given to the inverter to get a three-phase supply to balance the generation and the load using the inverter PQ controller. The DC voltage must constantly remain at an acceptable value for the inverter to control [21], and this is irrespective of how much ever real power the PV system provides. The connection between the inverter and the microgrid is made using an LC power filter on the AC side and a three-phase coupling transformer as shown in Figure 1. The following is the mathematical modeling that is required for a typical three-phase inverter model for a PV system grid-connected as follows.\ndiav R i L va a gaf f dt dibv R i L vb f b f gbdt dicv R i L vc c gcf f dt = + + = + + = + +        \n(8)\nFigure 7. Train Data with the error of PSO_ANFIS.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 8 of 20\nFigure 7. Train Data with the error of PSO_ANFIS.\nFigure 8. Test Data with the error of PSO_ANFIS.\n2.3. Inverter Control The output voltage (DC bus voltage) of the boost converters is maintained at a stable\nacceptable val e. This is given to the inverter to get a thre -phase supply to balance th gen ration and the load using the inverter PQ c ntroller. The DC voltage must constantly remain at an acceptable value for the inverter to c ntrol [21], and this is irrespective of how much ever r al power th PV system provides. The connection between the inverter and the microgrid is made using an LC power filter on the AC side and a t ree-phase coupling transformer as shown in Figure 1. The followi g is the mathematical modeling that is required for a typical three-phase invert r m del for a PV syste grid-connected as follows.\ndiav R i L va a gaf f dt dibv R i L vb f b f gbdt dicv R i L vc c gcf f dt = + + = + + = + +     \n\n(8)\nFigure 8. Test Data with the error of PSO_ANFIS.\n2.3. Inverter Control\nThe output voltage (DC bus voltage) of the boost converters is maintained at a stable acceptable value. This is given to the inverter to get a three-phase supply to balance the generation and the load using the inverter PQ controller. The DC voltage must constantly remain at an acceptable value for the inverter to control [21], and this is irrespective of how much ever real power the PV system provides. The connection betwe n t e inverter and the microgrid is made using an LC power filter on th AC side and a t ree-phase coupling transformer as shown in Figure 1. The following is the mathematical modeling that is required for a typical three-phase inverter model for a PV system grid-connected as follows.\nva = R f ia + f dia dt + vga vb = R f ib + L f dib dt + vgb vc = R f ic + L f dic dt + vgc\n (8)\nJ. Sens. Actuator Netw. 2023, 12, 45 9 of 20\nwhere ia, ib, and ic are the inverter output currents, va, vb, and vc are the inverter side voltages, vga, vgb, and vgc are the grid side voltages, and Rf and Lf are the LC power filter resistor and inductor. An equation can be expressed as:\ndia dt = \u2212 R f L f ia \u2212 vga L f + vaL f dib dt = \u2212 R f L f ib \u2212 vgb L f\n+ vbL f dic dt = \u2212 R f L f ic \u2212 vgc L f + vcL f  (9) The primary responsibilities of the inverter controller are to regulate the DC-link\nvoltage and also to transmit the DG\u2019s active power into the grid through the converters. The projected control technique is shown in Figure 9. The voltage loop is fed by the measured DC-link voltage and the reference voltage, to get the reference current. This reference current and the measured current are given to the current control loop to get the reference voltage, which is given to the pulse generator to get the pulses for inverter switches. J. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 10 of 20\nPower Filter\nVSC\nPLL\nabc to dq Transformationdq to abcTransformation Current control\nloop(Inner loop)\nPWMVoltage control\nloop\nGrid\n\u03b8 Id\nIq Iq_ref = 0\nVd\nVq\nId_ref\nVdc__ref Vdc\nVref\nVdc\nIabc Vabc\nC\nFigure 9. Controller block of three-phase PV inverter.\n3. Battery Energy Storage System (BESS) The BESS consists of a storage element, which is taken from the MATLAB 2022b version of the SimPowerSystem/Simscape electrical library. As given in the paper about the battery model the deep cycle battery being necessary due to the uncertain weather, the parameters are appropriately used as needed for the controller [22]. The equation of discharge and charge Lithium-ion Iron Phosphate (LFP) battery model is given as [23],\n( )0 . (it + t*) .exp( . ) it Q V V R i K A B itBAT Q = \u2212 \u2212 + \u2212 \u2212 (13)\n( ) ( )0 . * .it exp( . ) it 0.1 it Q Q V V Ri K i K A BitBAT Q Q = \u2212 \u2212 \u2212 + \u2212 \u2212 \u2212 (14)\nwhere VBAT is the battery voltage (V), Vo is the battery constant voltage (V), K is polarization constant (V/Ah), Q is battery capacity (Ah), it is the actual battery charge (Ah), R is the internal resistance (\u03a9), i is battery current (A), i* is filtered current (A), A is exponential zone amplitude (V), and B is exponential zone time constant inverse (Ah). The solar power output varies, and load variability is the reason to use a storage system for the microgrid application. The battery system has 1 MWh of backup energy to balance PV power for the critical load and frequency control. The other elements in this system are an inverter, filter, and coupling transformer. Figure 10 shows the BESS controller, which generates a reference voltage to the PWM block. The controller consists of droop control, a power and voltage regulator, and current controller. To ensure the system frequency and voltage while ensuring the generation load balance. The control methodology is explained below.\nFigure 9. Controller block of thre -phase PV inverter.\nTh transformati n is used to generate the reference signal for modulating three-phase inverters from the static reference frame to rotating reference frame park components (dq) as: [\nd q\n] = [ cos \u03b8 sin \u03b8 \u2212 sin \u03b8 cos \u03b8 ][ \u03b1 \u03b2 ] (10)\nThe PI regulators of voltage a d the current controllers are given as:\nId\u2212re f = (kpvpv + kiviv\ns )(Vdc\u2212re f \u2212 vdc) Iq_re f = 0\n} (11)\nVd = (kpib + kiib s )(Idre f \u2212 Id) +Vd \u2212 \u03c9L f f Iqre f Vq = (kpib + kiib s )(Iqre f \u2212 Iq) +Vq + \u03c9L f f Idre f  (12)\nJ. Sens. Actuator Netw. 2023, 12, 45 10 of 20\nwhere kpvpv and kivpv are the gains of the PV voltage loop PI controller, and the current controller PI gains are kpipv and kiipv. The suggested method ensures power balance at the DC-link via a precise model of the system, where in the power that needs to be pumped onto the grid is determined precisely using the PSO-ANFIS MPPT method and from the system\u2019s observed value. Since the obtained power from the PV source is delivered into the microgrid, thus the current generation is predicted using PI controller with the aim that the DC-link voltage will stabilize. Additionally, the DC-link voltage stability is substantially improved.\n3. Battery Energy Storage System (BESS)\nThe BESS consists of a storage element, which is taken from the MATLAB 2022b version of the SimPowerSystem/Simscape electrical library. As given in the paper about the battery model the deep cycle battery being necessary due to the uncertain weather, the parameters are appropriately used as needed for the controller [22]. The equation of discharge and charge Lithium-ion Iron Phosphate (LFP) battery model is given as [23],\nVBAT = V0 \u2212 R.i \u2212 K Q\n(Q \u2212 it) (it + t \u2217) + A. exp(\u2212B.it) (13)\nVBAT = V0 \u2212 R.i \u2212 K Q (it \u2212 0.1Q) i \u2217 \u2212 K Q (Q \u2212 it) .it + A exp(\u2212B.it) (14)\nwhere VBAT is the battery voltage (V), V0 is the battery constant voltage (V), K is polarization constant (V/Ah), Q is battery capacity (Ah), it is the actual battery charge (Ah), R is the internal resistance (\u2126), i is battery current (A), i* is filtered current (A), A is exponential zone amplitude (V), and B is exponential zone time constant inverse (Ah). The solar power output varies, and load variability is the reason to use a storage system for the microgrid application. The battery system has 1 MWh of backup energy to balance PV power for the critical load and frequency control. The other elements in this system are an inverter, filter, and coupling transformer. Figure 10 shows the BESS controller, which generates a reference voltage to the PWM block. The controller consists of droop control, a power and voltage regulator, and current controller. To ensure the system frequency and voltage while ensuring the generation load balance. The control methodology is explained below. J. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 11 of 20\nVSC\nCurrent Regulators (Inner loop)\nPWM\nC\nGrid\nabc to dq Transformation\nResynchronization Unit\nP/F & Q/V Droop Control\nPower Calculation\nPower Regulators\nVoltage Regulators\nVref Generation\nPower Filter\nPCC\nVqi Vdi\n\u0394f \u0394V\nVqpVdpQ\nIdref\nIqref\nIdref\nIqref\nVdq\nP\nSwitch Qref\nPref\nIdqrefVdqref\nVod\nIabc Vabc\nVdc\nFigure 10. The storage system inverter controller.\n3.1. Unit of Resynchronization The microgrid out-of-phase recloses with the supply system, leading to incredibly\nhigh inrush currents. Instead, the microgrid voltage is in phase with the distribution voltage; the resynchronization system will prevent a blackout. Operating this will ensure a soft reconnection to the supply system. Three seconds will pass during the synchronization process. The voltage and frequency will gradually catch up to that of the central grid using PI regulators.\nThe voltage and frequency deviations computed using PLL are computed using the resynchronization block as in [24,25]. The primary droop will be modified to include these deviations to account for the altered voltage or frequency. The instantaneous complex powers of the inverter in dq reference frame and the power on the DC side Pdc of the inverter are represented as:\nP V Idc dc dc= (15)\n3 ( ) 2 3\n( ) 2\nP V I V Iq qd d\nQ V I V Iq qd d\n= +\n= \u2212\n    \n(16)\n3.2. Droop Controller In the microgrid under the grid-forming mode, the BESS must control the microgrid\u2019s\nvoltage and frequency. The BESS has a droop P/F put to 0.5%, (the inverter produces its nominal active power). The microgrid voltage at the PCC bus can be adjusted by the adjustment of the droop Q/V put to 3%. Hence, droop control serves two purposes: it regulates real/reactive power using frequency/voltage control [26,27]. The following is how a droop control equation is created. A transmission line\u2019s actual and reactive power are as follows:\n1 2 sin\n2 1 2 1cos\nV V P\nX\nV V V Q\nX X\n\u03b4\n\u03b4\n=\n= \u2212 +\n    \n(17)\nThe power angle (\ud835\udeff) is much lower, so Sin \ud835\udeff = \ud835\udeff and Cos \ud835\udc36 = 1. Hence, equations become\nFigure 10. The storage system inverter controller.\nJ. Sens. Actuator Netw. 2023, 12, 45 11 of 20\n3.1. Unit of Resynchronization\nThe microgrid out-of-phase recloses with the supply system, leading to incredibly high inrush currents. Instead, the microgrid voltage is in phase with the distribution voltage; the resynchronization system will prevent a blackout. Operating this will ensure a soft reconnection to the supply system. Three seconds will pass during the synchronization process. The voltage and frequency will gradually catch up to that of the central grid using PI regulators. The voltage and frequency deviations computed using PLL are computed using the resynchronization block as in [24,25]. The primary droop will be modified to include these deviations to account for the altered voltage or frequency. The instantaneous complex powers of the inverter in dq reference frame and the power on the DC side Pdc of the inverter are represented as:\nPdc = Vdc Idc (15)\nP = 32 (Vd Id + Vq Iq) Q = 32 (Vd Id \u2212 Vq Iq)\n} (16)\n3.2. Droop Controller\nIn the microgrid under the grid-forming mode, the BESS must control the microgrid\u2019s voltage and frequency. The BESS has a droop P/F put to 0.5%, (the inverter produces its nominal active power). The microgrid voltage at the PCC bus can be adjusted by the adjustment of the droop Q/V put to 3%. Hence, droop control serves two purposes: it regulates real/reactive power using frequency/voltage control [26,27]. The following is how a droop control equation is created. A transmission line\u2019s actual and reactive power are as follows:\nP = V1V2X sin \u03b4 Q = \u2212V1V2X cos \u03b4 + V21 X\n} (17)\nThe power angle (\u03b4) is much lower, so Sin \u03b4 = \u03b4 and Cos C = 1. Hence, equations become\n\u03b4 = PX\nV1V2 (18)\nV2 \u2212 V1 \u223c= \u2212 XQ V1\n(19)\nThe preceding equations demonstrate that power angle control can be done using real power. The voltage can be managed using reactive power. Frequency control results in power angle regulation, which controls the actual power flow [28]. So, the frequency and voltage droop control can be calculated as follows:\nf = fs + kp f (P \u2212 Ps) V = Vs + kQV(Q \u2212 Qs)\n} (20)\nThe measured and set values of frequency, voltage, and active and reactive power are denoted as f, V, P, and Q, and fs, Vs, Ps, and Qs, respectively. Droop proportional constants are kpf and kQV.\n3.3. Power and Voltage Regulators\nIn the microgrid mode, the voltage regulator is set and computes Id and Iq from the measured dq voltages and the voltage reference Vref which is generated by the droop controller. Under the grid mode, the active and reactive power regulators are set. The power regulators are used to produce Idref and Iqref reference currents using the measured\nJ. Sens. Actuator Netw. 2023, 12, 45 12 of 20\nand reference active/reactive power. The voltage regulator and power regulator governing equation with PI controller are given in (21 and 22) as [29,30] as shown in Figure 10.\nId = (kpvb + kivb\ns )(Vre f \u2212 Vd) Iq = (kpvb + kivb s )(0 \u2212 Vq)\n} (21)\nIdre f = (kppb + kipb\ns )(P \u2212 Pre f ) Iqre f = (kpqb + kiqb s )(Q \u2212 Qre f )\n} (22)\nwhere kpvb kivb and kppqb, kipqb are the PI gains of the BESS voltage controller and the power controller, respectively.\n3.4. Current Regulators\nThe processed currents which are obtained from the voltage regulator (isolated) mode or power regulator (grid mode) through switch are fed to the Current Regulator. To produce the required dq voltages to generate pulses for the inverter, it is important to note that the regulators use feedforward computation to achieve a high dynamical response. Current control functions as an inner loop section on the control of inverters. The PI controllers control keeps track of current reference values, respectively. The PI controller output, the dq voltage, and the cross voltage drop in the resistor and inductor Rff and Lff are combined to generate the reference voltages Vdrref and Vqrref. This reference voltage is used to generate the PWM, which creates the necessary commands for the switches on the grid-connected inverter [31\u201333]. The equation is given as:\nVdre f = (kpib + kiib s )(Idre f \u2212 Id) +Vd \u2212 \u03c9L f f Iq Vqre f = (kpib + kiib s )(Iqre f \u2212 Iq) +Vq \u2212 \u03c9L f f Iq  (23) where kpib and kiib are the PI values for the BESS current loop controller. The translated and scaled Vdref and Vqref are used to generate a three-phase reference signal Vref, and then fed to the PWM block to produce pulses for the inverter switches.\n4. Results and Discussion\nThe simulation results for the test microgrid with the proposed P-Q and droop control method are presented in this section with PSO-ANFIS MPPT control. First, the gridconnected mode with the coordinated P-Q control method is considered. After that, droop control coordination is shown, with a BESS and a PV system coupled to PCC in an island scenario.\n4.1. Grid Connected Mode\nThe study on PQ controllers with integrated MPPT such as PSO-ANFIS with battery control is summarized here. Tables 3 and 4 show the controller gain parameters. The proposed PSO-ANFIS MPPT method has an edge in terms of precise and rapid power (PPV) as shown in Figure 11, i.e., from 0.1 s to 0.2 s. Additionally, from 4.4 s to 4.5 s, the settling the power to steady state is faster than P&O method. The demand for active power is met with PV power, storage system, and the grid. The coordinated P-Q control is tested, and the result shown here determines the effectiveness of the suggested control.\nJ. Sens. Actuator Netw. 2023, 12, 45 13 of 20\nTable 3. Photovoltaic System Data.\nSymbol Description Nominal Value\nKppv Power regulator Proportional gain 0.05 Kipv Power regulator Integral gain 2 Kpvpv Current regulator Proportional gain 6 Kivpv Current regulator Integral gain 30 Kpipv Voltage regulator Proportional gain 0.2 Kiipv Voltage regulator Integral gain 15 Fsw PWM switching freq. Hz 2700 Kpsvn Sync. Proportional gain (Kpsyn) 0.075 Kisvn Sync. Integral gain 0.03\nTable 4. Battery Energy Storage System Data.\nSymbol Description Nominal Value\nKpf Frequency droop 0.5 KQV Voltage droop 3 Kppb Power regulator Proportional gain 1.5 Kipb Power regulator Integral gain 15 Kpib Current regulator Proportional gain 0.2 Kiib Current regulator Integral gain 15 Kpvb Voltage regulator Proportional gain 2 Kivb Voltage regulator Integral gain 25 Fsw PWM switching freq. Hz 2700\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 14 of 20\nFsw PWM switching freq. Hz 2700\nFigure 11 shows the active power requirement by the load met by the grid and the solar PV system. The excess generation by PV will be stored in the battery storage device.\nFigure 11. Power sharing of the system.\nThe load terminal voltage Vrms as shown in Figure 12, as the voltage stays almost constant at about 415 V irrespective of load variation. The solar PV system with PSOANFIS controller tracks MPP as it is shown in Figure 4 in accordance with irradiance as depicted in Figure 13; the PV system produces power accordingly during the simulation\u2019s time frame.\nFigure 12. PCC Voltage.\nFigure 11. Power sharing of the system.\nFigure 11 shows the active power requirement by the load met by the grid and the solar PV system. The exce s generation by PV will be stored in the battery torage device. The load terminal voltage Vrms as shown in Figure 12, as the voltage stays almost constant at about 415 V irrespective of load variation. The solar PV system with PSO-ANFIS controller tracks MPP as it is shown in Figure 4 in accordance with irradiance as depicted in Figure 13; the PV system produce ower accordingly during the simulation\u2019s time frame.\nJ. Sens. Actuator Netw. 2023, 12, 45 14 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 14 of 20 Fsw PWM switching freq. Hz 2700 Figure 11 shows the active power requirement by the load met by the grid and the solar PV system. The excess generation by PV will be stored in the battery storage device. Figure 11. Power sharing of the system.\nThe load terminal voltage Vrms as shown in Figure 12, as the voltage stays almost constant at about 415 V irrespective of load variation. The solar PV system with PSOANFIS controller tracks MPP as it is shown in Figure 4 in accordance with irradiance as depicted in Figure 13; the PV system produces power accordingly during the simulation\u2019s time frame.\nFigure 12. PCC Voltage.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 14 of 20 Fsw PWM switching freq. Hz 2700 Figure 11 shows the active power requirement by the load met by the grid and the solar PV system. The excess generation by PV will be stored in the battery storage device. Figure 11. Power sharing of the system.\nThe load terminal voltage Vrms as shown in Figure 12, as the voltage stays almost constant at about 415 V irrespective of load variation. The solar PV system with PSOANFIS controller tracks MPP as it is shown in Figure 4 in accordance with irradiance as depicted in Figure 13; the PV system produces power accordingly during the simulation\u2019s time frame.\nConsidering the solar irradiation is about 900 W/m2 at 4 s as shown in Figure 13, the PV system produces power of almost 1 MW, which is more than enough to sustain the frequency of the microgrid. Thus, the controller act such that the battery gets charged with excess power. The battery power shows a negative sign in the charging mode, indicating that the battery is absorbing energy. These references illustrate both the discharging and charging phases of the standby energy storage battery positive and negative, respectively. As irradiance varies, PV effectively operates at MPP. When PV system energy is not enough to hold up the frequency of the microgrid at an acceptable value of almost 50 Hz, the grid provides a deficit power as shown in Figure 11. Figures 14 and 15 show the boost converters regulating voltage of the PV system and storage device, respectively, choosing initially the battery state of charge (SoC) at 50%. As demand is constant, the PV system generates excess power due to an increase in irradiance at 4 s when the battery starts charging; i.e., the SoC slope becomes positive as shown in Figure 16. The battery keeps charging and discharging for 6 h, which is investigated with 6 s.\nJ. Sens. Actuator Netw. 2023, 12, 45 15 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 15 of 20 Figure 13. Solar irradiation.\nConsidering the solar irradiation is about 900 W/m2 at 4 s as shown in Figure 13, the PV system produces power of almost 1 MW, which is more than enough to sustain the frequency of the microgrid. Thus, the controller act such that the battery gets charged with excess power. The battery power shows a negative sign in the charging mode, indicating that the battery is absorbing energy. These references illustrate both the discharging and charging phases of the standby energy storage battery positive and negative, respectively. As irradiance varies, PV effectively operates at MPP. When PV system energy is not enough to hold up the frequency of the microgrid at an acceptable value of almost 50 Hz, the grid provides a deficit power as shown in Figure 11. Figures 14 and 15 show the boost converters regulating voltage of the PV system and storage device, respectively, choosing initially the battery state of charge (SoC) at 50%. As demand is constant, the PV system generates excess power due to an increase in irradiance at 4 s when the battery starts charging; i.e., the SoC slope becomes positive as shown in Figure 16. The battery keeps charging and discharging for 6 h, which is investigated with 6 s.\nFigure 14. Output voltage of boost converter.\nFigure 15. Battery energy storage system charging voltage.\nFigure 14. Output voltage of boost converter.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 15 of 20 Figure 13. Solar irradiation.\nConsidering the solar irradiation is about 900 W/m2 at 4 s as shown in Figure 13, the PV system produces power of almost 1 MW, which is more than enough to sustain the frequency of the microgrid. Thus, the controller act such that the battery gets charged with excess power. The battery power shows a negative sign in the charging mode, indicating that the battery is absorbing energy. These references illustrate both the discharging and charging phases of the standby energy storage battery positive and negative, respectively. As irradiance varies, PV effectively operates at MPP. When PV system energy is not enough to hold up the frequency of the microgrid at an acceptable value of almost 50 Hz, the grid provides a deficit power as shown in Figure 11. Figures 14 and 15 show the boost converters regulating voltage of the PV system and storage device, respectively, choosing initially the battery state of charge (SoC) at 50%. As demand is constant, the PV system generates excess power due to an increase in irradiance at 4 s when the battery starts charging; i.e., the SoC slope becomes positive as shown in Figure 16. The battery keeps charging and discharging for 6 h, which is investigated with 6 s.\nFigure 14. Output voltage of boost converter.\nFigure 15. Battery energy storage system charging voltage. Figure 15. Battery energy storage system charging voltage.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 16 of 20\nFigure 16. Battery energy storage SoC.\nHence, the constant DC link voltage is provided to the inverter. This is processed from the PSO_ANFIS method to get the duty ratio for the boost converter to extract the maximum power from the PV system. Along with the proper controller, the DC-link voltage stability is maintained as shown in Figure 14. Hence, the power balance indicates that the coordinated P-Q proposed controller is appropriate in microgrids.\n4.2. Grid to Microgrid to Grid Mode An additional case study demonstrates the dynamic features of the suggested control\nalgorithms during grid-to-microgrid and back-to-grid transitions. In this study, the system first acts as a standard grid, and then the tie switch is opened after one second to make an intentional island. As a result, the microgrid is solely reliant on the PCC\u2019s solar farm and BESS. The combined real and reactive power infusion from the BESS inverter and solar plant with PSO-ANFIS during microgrid mode is shown in Figure 17. The controller instructs the solar plant to produce an assuring of active power at MPP when it switches from grid-connected to microgrid mode based on the irradiance which is constant in this case; the irradiance is at 650 W/m2, so the solar plant produces a consistent 650 kW throughout the study. In a microgrid-connected mode, i.e., when it transits to the islanded condition, the PV system is managed to provide real power, and the deficit power required for the load is covered by the BESS inverter system with reactive power. As the microgrid transitions to the islanded situation, there are both active and reactive power injections from the PV system and battery.\nFigure 17. Power sharing of the system.\nFigure 16. Battery energy storage SoC.\nJ. Sens. Actuator Netw. 2023, 12, 45 16 of 20\nHence, the constant DC link voltage is provided to the inverter. This is processed from the PSO_ANFIS method to get the duty ratio for the boost converter to extract the maximum power from the PV system. Along with the proper controller, the DC-link voltage stability is maintained as shown in Figure 14. Hence, the power balance indicates that the coordinated P-Q proposed controller is appropriate in microgrids.\n4.2. Grid to Microgrid to Grid Mode\nAn additional case study demonstrates the dynamic features of the suggested control algorithms during grid-to-microgrid and back-to-grid transitions. In this study, the system first acts as a standard grid, and then the tie switch is opened after one second to make an intentional island. As a result, the microgrid is solely reliant on the PCC\u2019s solar farm and BESS. The combined real and reactive power infusion from the BESS inverter and solar plant with PSO-ANFIS during microgrid mode is shown in Figure 17. The controller instructs the solar plant to produce an assuring of active power at MPP when it switches from grid-connected to microgrid mode based on the irradiance which is constant in this case; the irradiance is at 650 W/m2, so the solar plant produces a consistent 650 kW throughout the study. In a microgrid-connected mode, i.e., when it transits to the islanded condition, the PV system is managed to provide real power, and the deficit power required for the load is covered by the BESS inverter system with reactive power. As the microgrid transitions to the islanded situation, there are both active and reactive power injections from the PV system and battery.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 16 of 20\nFigure 16. Battery energy storage SoC.\nHence, the constant DC link voltage is provided to the inverter. This is processed from the PSO_ANFIS method to get the duty ratio for the boost converter to extract the maximum power from the PV system. Along with the proper controller, the DC-link voltage stability is maintained as shown in Figure 14. Hence, the power balance indicates that the coordinated P-Q proposed controller is appropriate in microgrids.\n4.2. rid to icrogrid to rid ode a iti al case st e strates t e a ic feat res f t e s este c tr l\nl rit s during grid-to-microgrid and back-to-grid transitions. In this stud , the sy tem fir t acts as standard grid, and then the tie switch is opened after one second to make an intentional island. As a result, the m crogrid is solely reliant on the PCC\u2019s solar farm and BESS. The combined real and reactive power nfusi n from the BESS inverter and solar plant with PSO-ANFIS during microgrid mode is shown in Figure 17. The controller instructs the solar plant to prod ce an assuring f active power at MPP hen it switches fr m grid-connected to icrogrid m de based on the irradiance which is const nt in this case; the irradiance is at 650 W/m2, so the solar plant produce a consistent 650 kW throughout the study. In a microgrid-connected mod , i.e., when i trans ts to the islanded condition, he PV system is manag d to provide real power, and the deficit power required fo the load is covered by the BESS inverter system with reactive p wer. As the micr grid tr sitions to the islanded situation, th re are both active and reactive p wer injections from the PV system and battery.\nInverters are in charge of keeping the microgrid frequency and voltage at the PCC level. In the isolated mode, the solar plant\u2019s active power is insufficient to supply the microgrid\u2019s energy demands due to irradiance of 650 W/m2. The microgrid frequency drops to 49.9 Hz because of the mismatch in load and generation. The controller from the BESS begins within seconds and immediately returns to the normal value as shown in Figure 18. Additionally, the PCC voltage of almost acceptable value of 415 V in rms even though considering step load variation by injecting reactive power during 1 to 5 s is shown in Figure 19. Following the start of the control, the voltage is swiftly regulated at 415 Vrms. Figures 20 and 21 show the boost converters regulated voltage with PSO-ANFIS MPPT for the PV system and storage device, respectively. Similarly, under microgrid mode, choosing initially the battery State of charge (SoC) is at 50%. It was discharging as demand was more between 1 to 5 s as grid power was intentionally made unavailable solely on microgrid mode, so the SoC slope becomes negative up to 5 s as shown in Figure 22. The battery keeps charging and discharging for 6 h, which is investigated for 6 s. At 5 s, when the grid is again made available, the slope becomes zero. Thus, the results shown here make clear that the droop and inverter control along with the PSO-ANFIS MPPT for PV converter operates effectively under grid-isolated-grid mode.\nJ. Sens. Actuator Netw. 2023, 12, 45 17 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 17 of 20\nInverters are in charge of keeping the microgrid frequency and voltage at the PCC level. In the isolated mode, the solar plant\u2019s active power is insufficient to supply the microgrid\u2019s energy demands due to irradiance of 650 W/m2. The microgrid frequency drops to 49.9 Hz because of the mismatch in load and generation. The controller from the BESS begins within seconds and immediately returns to the normal value as shown in Figure 18. Additionally, the PCC voltage of almost acceptable value of 415 V in rms even though considering step load variation by injecting reactive power during 1 to 5 s is shown in Figure 19. Following the start of the control, the voltage is swiftly regulated at 415 Vrms. Figures 20 and 21 show the boost converters regulated voltage with PSO-ANFIS MPPT for the PV system and storage device, respectively. Similarly, under microgrid mode, choosing initially the battery State of charge (SoC) is at 50%. It was discharging as demand was more between 1 to 5 s as grid power was intentionally made unavailable solely on microgrid mode, so the SoC slope becomes negative up to 5 s as shown in Figure 22. The battery keeps charging and discharging for 6 h, which is investigated for 6 s. At 5 s, when the grid is again made available, the slope becomes zero. Thus, the results shown here make clear that the droop and inverter control along with the PSO-ANFIS MPPT for PV converter operates effectively under grid-isolated-grid mode.\ni . i f i ri .\n. . . , ,\n. , . . . . , j . , . , . , , .\n, .\n, . , , . ,\n.\n. .\n. . i r . oltage.\nFigure 21. Energy storage Voltage.\nFigure 22. Battery energy storage SoC.\nThe suggested ANFIS-PSO algorithm effectively and quickly monitors MPP in all patterns in the grid and islanded mode. In comparison to the traditional P&O-based MPPT approach, the proposed PSO-ANFIS-based MPPT has a swift convergence velocity, high PV monitoring efficiency due to the least RMSE, and the ability to produce a quick MPP region.\n. .\nJ. Sens. Actuator Netw. 2023, 12, 45 18 of 20\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 18 of 20\nFigure 22. Battery energy storage SoC.\nThe suggested ANFIS-PSO algorithm effectively and quickly monitors MPP in all patterns in the grid and islanded mode. In comparison to the traditional P&O-based MPPT approach, the proposed PSO-ANFIS-based MPPT has a swift convergence velocity, high PV monitoring efficiency due to the least RMSE, and the ability to produce a quick MPP region.\nJ. Sens. Actuator Netw. 2023, 12, x FOR PEER REVIEW 18 of 20\nFigure 20. Output voltage of PV boost converter.\nThe suggested ANFIS-PSO algorithm effectively and quickly monitors MPP in all patterns in the grid and islanded mode. In comparison to the traditional P&O-based MPPT approach, the proposed PSO-ANFIS-based MPPT has a swift convergence velocity, high PV monitoring efficiency due to the least RMSE, and the ability to produce a quick MPP region.\ntt r r t .\nThe suggested FIS-PS algorith effectively and quickly onitors PP in all patterns in the grid and islanded ode. In co parison to the traditional P -based PPT approach, the proposed PSO-ANFIS-based MPPT has a swift convergence velocity, high PV monitoring efficiency due to the least RMSE, and the ability to produce a quick MPP region.\n5. C clusions\nThe proposed work demonstrates coordinated V-f/P-Q techniques for the grid and islanded mode using a photovoltaic system with PSO-ANFIS MPPT and battery storage. In this work, the photovoltaic system is run with two methods to obtain maximum power point (MPP). The proposed PSO-ANFIS MPPT method has an edge over the P&O method for quick, accurate, and exact PV tracking in variable irradiance. Along with the proposed control method, a seamless change from grid-connected side PQ control to island V-f management back to grid resynchronization, respectively, was seamless and successful. In the suggested microgrid, the V-f control mechanism brings back the microgrid frequency and PCC voltage with the use of battery installations. The battery storage acts as a buffer to inject and receive power as needed via the charge/discharge cycle to make up for any shortfalls or surpluses. Additionally, the coordinated PQ control method under the grid follows the mode of the active power requirement by the load met by the grid, the solar PV system, and the storage device. The excess generation by PV will be stored in the battery storage device. The limitation is, the larger the data, the convergent time is large with the proposed method. The proposed work can be extended with the Internet of Things-based MPPT control method, also for partial shading of photovoltaic as the future scope.\nJ. Sens. Actuator Netw. 2023, 12, 45 19 of 20\nAuthor Contributions: Conceptualization, S.S., U.R.Y. and N.H.; methodology, S.S., U.R.Y. and N.H.; software, S.S., U.R.Y. and N.H.; validation, S.S., U.R.Y. and N.H.; writing\u2014original draft preparation, S.S., U.R.Y. and N.H.; writing\u2014review and editing, S.S., U.R.Y. and N.H.; supervision, U.R.Y. and N.H. All authors have read and agreed to the published version of the manuscript.\nFunding: This research received no external funding.\nData Availability Statement: Data are contained within the article.\nConflicts of Interest: The authors declare no conflict of interest.\nReferences 1. Vandoorn, T.L.; Vasquez, J.C.; De Kooning, J.; Guerrero, J.M.; Vandevelde, L. Microgrids: Hierarchical control and an overview of the control and reserve management strategies. IEEE Ind. Electron. Mag. 2013, 7, 42\u201355. [CrossRef] 2. Chowdhury, S.; Chowdhury, S.P.; Crossley, P. Microgrids and Active Distribution Networks; Instutation of Engineering and Technology: London, UK, 2022. [CrossRef] 3. Kim, J.S.; So, S.M.; Kim, J.T.; Cho, J.W.; Park, H.J.; Jufri, F.H.; Jung, J. Microgrids platform: A design and implementation of a common platform for seamless microgrids operation. Electr. Power Syst. Res. 2019, 167, 21\u201338. [CrossRef] 4. Vasquez, J.C.; Guerrero, J.M.; Savaghebi, M.; Eloy-Garcia, J.; Teodorescu, R. Modeling, analysis, and design of stationary-\nreference-frame droop-controlled parallel three-phase voltage source inverters. IEEE Trans. Ind. Electron. 2012, 60, 1271\u20131280. [CrossRef]\n5. Vandoorn, T.L.; Meersman, B.; De Kooning, J.D.; Vandevelde, L. Analogy between conventional grid control and islanded microgrid control based on a global DC-link voltage droop. IEEE Trans. Power Deliv. 2012, 27, 1405\u20131414. [CrossRef] 6. Li, H.; Li, F.; Xu, Y.; Rizy, D.T.; Adhikari, S. Autonomous and adaptive voltage control using multiple distributed energy resources. IEEE Trans. Power Syst. 2012, 28, 718\u2013730. [CrossRef] 7. Zadeh, M.J.Z.; Fathi, S.H. A new approach for photovoltaic arrays modeling and maximum power point estimation in real operating conditions. IEEE Trans. Ind. Electron. 2017, 64, 9334\u20139343. [CrossRef] 8. El Aamri, F.; Maker, H.; Sera, D.; Spataru, S.V.; Guerrero, J.M.; Mouhsen, A. A direct maximum power point tracking method for single-phase grid-connected PV inverters. IEEE Trans. Power Electron. 2017, 33, 8961\u20138971. [CrossRef] 9. Khan, O.; Acharya, S.; Al Hosani, M.; El Moursi, M.S. Hill climbing power flow algorithm for hybrid DC/AC microgrids. IEEE Trans. Power Electron. 2017, 33, 5532\u20135537. [CrossRef] 10. Huynh, D.C.; Dunnigan, M.W. Development and comparison of an improved incremental conductance algorithm for tracking the MPP of a solar PV panel. IEEE Trans. Sustain. Energy 2016, 7, 1421\u20131429. [CrossRef] 11. Al-Gizi, A.G.; Craciunescu, A.; Al-Chlaihawi, S.J. The use of ANN to supervise the PV MPPT based on FLC. In Proceedings of the 2017 10th International Symposium on Advanced Topics in Electrical Engineering (ATEE), Bucharest, Romania, 23\u201325 March 2017; IEEE: Piscataway, NJ, USA, 2017; pp. 703\u2013708. 12. Mir, M.; Kamyab, M.; Lariche, M.J.; Bemani, A.; Baghban, A. Applying ANFIS-PSO algorithm as a novel accurate approach for prediction of gas density. Pet. Sci. Technol. 2018, 36, 820\u2013826. [CrossRef] 13. Ahmed, M.; Abdelrahem, M.; Farhan, A.; Harbi, I.; Kennel, R. DC-link sensorless control strategy for grid-connected PV systems. Electr. Eng. 2021, 103, 2345\u20132355. [CrossRef] 14. Sundareswaran, K.; Vigneshkumar, V.; Sankar, P.; Simon, S.P.; Nayak, P.S.R.; Palani, S. Development of an improved P&O algorithm assisted through a colony of foraging ants for MPPT in PV system. IEEE Trans. Ind. Inform. 2015, 12, 187\u2013200. 15. Lee, J.; Kim, Y. Comparative Estimation of Electrical Characteristics of a Photovoltaic Module Using Regression and Artificial Neural Network Models. Electronics 2022, 11, 4228. [CrossRef] 16. Villalva, M.G.; Gazoli, J.R.; Ruppert Filho, E. Modeling and circuit-based simulation of photovoltaic arrays. In Proceedings of the 2009 Brazilian Power Electronics Conference, Bonito-Mato Grosso do Sul, Brazil, 27 September\u20131 October2009; IEEE: Piscataway, NJ, USA, 2009; pp. 1244\u20131254. 17. Islam, H.; Mekhilef, S.; Shah NB, M.; Soon, T.K.; Seyedmahmousian, M.; Horan, B.; Stojcevski, A. Performance evaluation of maximum power point tracking approaches and photovoltaic systems. Energies 2018, 11, 365. [CrossRef] 18. Priyadarshi, N.; Padmanaban, S.; Holm-Nielsen, J.B.; Blaabjerg, F.; Bhaskar, M.S. An experimental estimation of hybrid ANFIS\u2013 PSO-based MPPT for PV grid integration under fluctuating sun irradiance. IEEE Syst. J. 2019, 14, 1218\u20131229. [CrossRef] 19. Priyadarshi, N.; Padmanaban, S.; Maroti, P.K.; Sharma, A. An extensive practical investigation of FPSO-based MPPT for grid integrated PV system under variable operating conditions with anti-islanding protection. IEEE Syst. J. 2018, 13, 1861\u20131871. [CrossRef] 20. Darvish, H.; Rahmani, S.; Maleki Sadeghi, A.; Emami Baghdadi, M.H. The ANFIS-PSO strategy as a novel method to predict interfacial tension of hydrocarbons and brine. Pet. Sci. Technol. 2018, 36, 654\u2013659. [CrossRef] 21. Ramezani, M.; Li, S.; Golestan, S. Analysis and controller design for stand-alone VSIs in synchronous reference frame. IET Power Electron. 2017, 10, 1003\u20131012. [CrossRef] 22. Gonzalez, I.; Calder\u00f3n, A.J.; Folgado, F.J. IoT real time system for monitoring lithium-ion battery long-term operation in microgrids. J. Energy Storage 2022, 51, 104596. [CrossRef]\nJ. Sens. Actuator Netw. 2023, 12, 45 20 of 20\n23. Tremblay, O.; Dessaint, L.A. Experimental validation of a battery dynamic model for EV applications. World Electr. Veh. J. 2009, 3, 289\u2013298. [CrossRef] 24. Adhikari, S.; Xu, Y.; Li, F.; Li, H.; Kueck, J.D.; Snyder, I.B.; Barker, T.J.; Hite, R. Utility-side voltage and PQ control with inverter-based photovoltaic systems. IFAC Proc. Vol. 2011, 44, 6110\u20136116. [CrossRef] 25. Naji Alhasnawi, B.; Jasim, B.H.; Esteban, M.D. A new robust energy management and control strategy for a hybrid microgrid system based on green energy. Sustainability 2020, 12, 5724. [CrossRef] 26. Chau, T.K.; Yu, S.S.; Fernando, T.; Iu, H.H.C.; Small, M. An investigation of the impact of PV penetration and BESS capacity on islanded microgrids\u2013a small-signal based analytical approach. In Proceedings of the 2019 IEEE International Conference on Industrial Technology (ICIT), Melbourne, VIC, Australia, 13\u201315 February 2019; IEEE: Piscataway, NJ, USA, 2019; pp. 1679\u20131684. 27. Kafle, L.; Ni, Z.; Tonkoski, R.; Qiao, Q. Frequency control of isolated micro-grid using a droop control approach. In Proceedings of the 2016 IEEE International Conference on Electro Information Technology (EIT), Grand Forks, ND, USA, 19\u201321 May 2016; IEEE: Piscataway, NJ, USA, 2016; pp. 0771\u20130775. 28. Majumder, R.; Chaudhuri, B.; Ghosh, A.; Majumder, R.; Ledwich, G.; Zare, F. Improvement of stability and load sharing in an autonomous microgrid using supplementary droop control loop. IEEE Trans. Power Syst. 2009, 25, 796\u2013808. [CrossRef] 29. Firdaus, A.; Mishra, S. A double derivative-based droop controller for improved power sharing in inverter based autonomous microgrid. In Proceedings of the 2018 IEEMA Engineer Infinite Conference (eTechNxT), New Delhi, India, 13\u201314 March 2018; IEEE: Piscataway, NJ, USA, 2018; pp. 1\u20136. 30. He, J.; Li, Y.W.; Blaabjerg, F. An enhanced islanding microgrid reactive power, imbalance power, and harmonic power sharing scheme. IEEE Trans. Power Electron. 2014, 30, 3389\u20133401. [CrossRef] 31. Zhong, Q.-C.; Hornik, T. Cascaded current\u2013voltage control to improve the power quality for a grid-connected inverter with a local load. IEEE Trans. Ind. Electron. 2012, 60, 1344\u20131355. [CrossRef] 32. Marwali, M.N.; Keyhani, A. Control of distributed generation systems-Part I: Voltages and currents control. IEEE Trans. Power Electron. 2004, 19, 1541\u20131550. [CrossRef] 33. Giroux, P.; Tremblay, O.; Sybille, G.; Brunelle, P. Microgrid Dynamic Operation. 2021. Available online: https://www.mathworks. com/matlabcentral/fileexchange/93235-microgrid-dynamic-operation (accessed on 4 May 2023).\nDisclaimer/Publisher\u2019s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content."
        }
    ],
    "title": "Coordinated PSO-ANFIS-Based 2 MPPT Control of Microgrid with Solar Photovoltaic and Battery Energy Storage System",
    "year": 2023
}