{
    "abstractText": "Data clustering belongs to the category of unsupervised learning and plays an important role in the dynamic systems and big data. The clustering problem of sampled time\u2010series data is undoubtedly much more challenging than that of repeatable sampling data. Most of the existing time\u2010series clustering methods stay at the level of algorithm design, lacking rigorous theoretical foundation and being inefficient in dealing with large\u2010scale time series. To address this issue, in this paper, we establish the mathematical theory for the large\u2010scale time series clustering of dynamic system. The main contributions of this paper include proposing the concept of time series morphological isomorphism, proving that translation isomorphism and stretching isomorphism are equivalent relations, developing the calculation method of morphological similarity measure, and establishing a new time series clustering method based on equivalent partition and morphological similarity. These contributions provide a new theoretical foundation and practical method for the clustering of large\u2010 scale time series. Simulation results in typical applications verify the validity and practicability of the aforementioned clustering methods.",
    "authors": [
        {
            "affiliations": [],
            "name": "Shaolin Hu"
        }
    ],
    "id": "SP:47587009bfef80b9a3dc1fdc766203f8f2029da0",
    "references": [
        {
            "authors": [
                "Hailin",
                "Li",
                "Z. Liping"
            ],
            "title": "Summary of clustering research in time series data mining",
            "venue": "J. Univ. Electron. Sci. Technol. China",
            "year": 2022
        },
        {
            "authors": [
                "Huang",
                "X.H. et al. Time series k-means"
            ],
            "title": "a new k-means type smooth subspace clustering for time series data",
            "venue": "Inf. Sci. 367, 1\u201313. https:// doi. org/ 10. 1016/j. ins. 2016. 05. 040",
            "year": 2016
        },
        {
            "authors": [
                "G He"
            ],
            "title": "A fast semi-supervised clustering framework for large-scale time series data",
            "venue": "IEEE Trans. Syst. Man. Cybern. Syst",
            "year": 2021
        },
        {
            "authors": [
                "H. Izakian",
                "W. Pedrycz",
                "I. Jamal"
            ],
            "title": "Fuzzy clustering of time series data using dynamic time warping distance",
            "venue": "Eng. Appl. Artif. Intell",
            "year": 2014
        },
        {
            "authors": [
                "D. Chang",
                "Y.F. Ma",
                "X.L. Ding"
            ],
            "title": "Time series clustering based on singularity",
            "venue": "Int. J. Comput. Commun. Control",
            "year": 2017
        },
        {
            "authors": [
                "Zhou",
                "L. H"
            ],
            "title": "Clustering multivariate time series data a via multi-nonnegative matrix factorization in multi-relational networks",
            "venue": "IEEE Access",
            "year": 2018
        },
        {
            "authors": [
                "P D\u2019Urso"
            ],
            "title": "Robust fuzzy clustering of time series based on B-splines",
            "venue": "Int. J. Approx. Reason",
            "year": 2021
        },
        {
            "authors": [
                "D Guijo-Rubio"
            ],
            "title": "Time-series clustering based on the characterization of segment typologies",
            "venue": "IEEE Trans. Cybern",
            "year": 2021
        },
        {
            "authors": [
                "K.J. Krishnan",
                "K. Mitra"
            ],
            "title": "A modified Kohonen map algorithm for clustering time series data",
            "venue": "Expert Syst. Appl",
            "year": 2022
        },
        {
            "authors": [
                "T. Rajesh",
                "Y. Devi",
                "K.V. Rao"
            ],
            "title": "Hybrid clustering algorithm for time series data\u2014A literature survey",
            "venue": "Proceedings of the 2017 International Conference on Big Data Analytics and Computational Intelligence,",
            "year": 2017
        },
        {
            "authors": [
                "V. Niennattrakul",
                "D. Srisai",
                "C.A. Ratanamahatana"
            ],
            "title": "Shape-based template matching for time series data",
            "venue": "Knowl.-Based Syst",
            "year": 2011
        },
        {
            "authors": [
                "J. Zhao",
                "R. Ju",
                "X. Xie",
                "Y. Ye"
            ],
            "title": "Multivariate time series similarity measure based on weighted dynamic time warping",
            "venue": "ACM Int. Conf. Proc. Ser. https:// doi",
            "year": 2020
        },
        {
            "authors": [
                "Shaolin",
                "Hu",
                "Huang Xiaomin",
                "Su",
                "W.S. Naiqian"
            ],
            "title": "Morphological similarity clustering and its applications in anomaly detection of time series",
            "venue": "Int. J. Data Sci. Technol",
            "year": 2021
        },
        {
            "authors": [
                "K. Zhou",
                "S. Hu"
            ],
            "title": "An improved morphological weighted dynamic similarity measurement algorithm for time series",
            "venue": "Int. J. Intell. Comput. Cybern",
            "year": 2018
        },
        {
            "authors": [
                "Y. Li",
                "D. Shen",
                "T. Nie",
                "Y. Kou"
            ],
            "title": "A new shape-based clustering algorithm for time series",
            "venue": "Inf. Sci",
            "year": 1016
        },
        {
            "authors": [
                "W. Meesrikamolkul",
                "V. Niennattrakul",
                "C.A. Ratanamahatana"
            ],
            "title": "Shape-Based Clustering for Time Series Data",
            "venue": "Lecture Notes in Computer Science",
            "year": 2012
        },
        {
            "authors": [
                "F. Ilijas"
            ],
            "title": "Set Theory and Quotients",
            "year": 2019
        },
        {
            "authors": [
                "W. Jinfeng",
                "Z. Yuan"
            ],
            "title": "Metric theory of partial quotients of N-continued fractions. Fractals-Complex Geometry Patterns Scal",
            "venue": "Nat. Soc",
            "year": 2023
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nwww.nature.com/scientificreports"
        },
        {
            "heading": "Equivalence partition based",
            "text": "morphological similarity clustering for large\u2011scale time series"
        },
        {
            "heading": "Shaolin Hu",
            "text": "Data clustering belongs to the category of unsupervised learning and plays an important role in the dynamic systems and big data. The clustering problem of sampled time\u2011series data is undoubtedly much more challenging than that of repeatable sampling data. Most of the existing time\u2011series clustering methods stay at the level of algorithm design, lacking rigorous theoretical foundation and being inefficient in dealing with large\u2011scale time series. To address this issue, in this paper, we establish the mathematical theory for the large\u2011scale time series clustering of dynamic system. The main contributions of this paper include proposing the concept of time series morphological isomorphism, proving that translation isomorphism and stretching isomorphism are equivalent relations, developing the calculation method of morphological similarity measure, and establishing a new time series clustering method based on equivalent partition and morphological similarity. These contributions provide a new theoretical foundation and practical method for the clustering of large\u2011 scale time series. Simulation results in typical applications verify the validity and practicability of the aforementioned clustering methods.\nLarge-scale time series clustering is an important tool for simplifying the design of complex equipment process monitoring systems. With the rapid development and wide application of intelligent sensing technology, industrial equipment not only becomes more and more intelligent but also has increasingly complex structures. During the operation of large-scale devices with complex structures, large-scale data sequences that vary over time widely appear and serve as an important basis for sensing equipment status and monitoring equipment failures. Taking the integrated control system of an ethylene plant with a production capacity of 900,000 tons/ year as an example, the DCS and SIS systems, as its two core parts, involve as many as 8020 components. The DCS has 9782 I/O communication slots, 97 sets of analytical instruments, 581 flow meters, 246 sets of liquid level instruments, 2965 sets of pressure and temperature instruments, 2319 sets of transmission devices, 1034 control valves, more than 210 sets of air source distributors, and more than 110\u00a0km of Tube and Pipe pipelines. During the production process of these equipment and instruments, there are over 100,000 sampling data sequence formed by acquiring data at different sampling times (short as the sampled time series) along with changes in materials, working conditions, and environment. For another example, during the orbit operation of a large spacecraft or constellation, the number of the sampled telemetry time series is typically more than millions. Whether the production process of ethylene or the on-orbit management process of spacecraft, a large number of sampled time series are an important basis for us to monitor production conditions, to detect abnormalities, and to implement safety control, although these sampling sequences are difficult to fully control due to their various modal, non-stationary, and high dynamic changes. For such a large-scale time series, it is very necessary to adopt appropriate clustering methods to cluster the time series to simplify the design complexity and difficulty of monitoring systems.\nTime series clustering is a hot research topic in the field of knowledge engineering and machine learning. In the past 20\u00a0years, people have conducted a lot of research and proposed a series of clustering and algorithms1, which mainly focuses on overall time series clustering, subsequence clustering, and time point clustering, using methods such as distance metric2,3, similarity metric4\u20136, spline approximation7,8, feature representation9, and clustering prototypes3,10, etc. In the usual sense, the time series clustering is to partition a large-scale data set of time series into many clusters based on the mutual distance among the data, which means time series data in the same cluster are intrinsically similar, so that time series data in the same cluster are similar. In knowledge discovery and its related fields, there are various methods and algorithms proposed to cluster time series 11, including general purpose clustering algorithms commonly used in time series clustering. Besides, existing literatures\nOPEN"
        },
        {
            "heading": "Automation School, Guangdong University of Petrochemical Technology, Maoming 525000, China. email: hfkth@",
            "text": "gdupt.edu.cn\n2 Vol:.(1234567890) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nhave considered for evaluating the performance of the clustering performance, and the metrics to determine the resemblance between two time series, either in the forms of raw data, extracted features, or model parameters. Typical practical methods are composed of two steps: the first step is to work out a set of appropriate distance/ similarity metrics, and the second step is to build the clustering structures through existing techniques, such as k-means clustering, hierarchical clustering, density based clustering and subspace clustering, etc. Among these, the dynamic time warping (DTW) distance is one of the most commonly adopted metrics for time series clustering. However, the computational complexity of DTW is the main disadvantage that affects its application 11,12, especially in the case of handling large volumes of data. Although many techniques including index structure and lower bound function have been proposed to speed up the search, it is remains challenging to search the entire database of the system with limited resources within a given time. More unfavorably, the DTW distance measurement is an algorithm that only measures the similarity of time series in a linear manner 13. Although the DTW metric is effective in processing time axis compression and expansion, it is insensitive to amplitude changes 14 and does not satisfy the triangular inequality of distance. In order to overcome these drawbacks, Zhou and Hu15 proposed an improved morphological weighted DTW algorithm for time series data clustering. Another method is to consider clustering and classification of time series from the perspective of the shape changes 12,16. Niennattrakul et\u00a0al. 12 elaborated that the template matching is a solution to efficiently reduce storage and computation load and proposed a template matching framework with using DTW distance, where a shape-based averaging algorithm was utilized to construct significant templates. Besides, they raised a shape-based template matching framework (STMF) to discover a cluster representative of time series and maintain good accuracy against its rivals. Hu et\u00a0al. 14 developed a morphological clustering algorithm based on morphological similarity measurement. Meesrikamolkul et\u00a0al.17 argued that although the k-means similarity clustering with Euclidean distance was one of the most famous algorithms for time series data clustering, its DTW distance makes it impractical because the current averaging functions fail to preserve characteristics of time series within the cluster. Thus, they proposed a shape-based clustering for time series (SCTS) by means of ranking shape-based template matching framework (RSTMF) to average a group of time series effectively. Nevertheless, neither STMF nor SCTS specifically considers the shape of the time series. In particular, most of the time series clustering algorithms are unsupervised machine learning methods. They cannot solve the data clustering problems at the mechanism level, such as determining how many classes can be clustered and why they can be clustered, etc. This makes the clustering methods lack of rigor in mathematical theory. For time series clustering, it is desired that some basic changes (e.g., transverse/longitudinal translation and stretching) do not alter the clustering categories. In other words, some invariance in the time series morphological clustering should be maintained, such as affine invariance, so as to gather the similar time series into the same clustering category.\nDue to the significant differences between time series dataset and sampling dataset in mathematical statistics, these time series clustering methods stated above are far from perfect in clustering theory and practical technology. Taking the large-scale time series sampled by a large number of instruments during the operation of ethylene production units aforementioned as an example, sampling time series from different instruments at different stages of time may have different statistical characteristics: strong stationary, weak stationary, and a large number of non-stationary. In order to actually design a process monitoring system based on time series clustering, it is necessary to break through at least three difficult problems which directly related to clustering: (a). Theoretically, there is a need to be able to answer how many categories a large-scale time series dataset should be clustered into; (b). For time series with the same morphology (such as sinusoidal and cosine vibration signals), regardless of their curve length, amplitude, and axis position, they should be clustered into the same cluster; (c) For production processes with periodic characteristics, the change patterns of data in different periods of the instrument are usually similar, and therefore, they cannot be incorrectly clustered in different clusters due to differences in starting time and change intervals. These problems are three unresolved issues that must be addressed in time series clustering research with universal significance. As an important branch of data clustering, although time series clustering similarly inherits the key requirement of \"significant differences between different classes and sufficient similarity within each class\" derived from data clustering, the characteristics of time series are diverse and multifaceted, how to measure the similarity and evaluate the difference between time series is very complex, and it cannot be separated from the domain of the object, the morphology of time series data, and the application of clustering scenarios. In fact, the aforementioned problems widely exist and limit the rigor of clustering research. Specifically, in the machine learning field, it is generally recognized that clustering is an unsupervised learning process for identifying clusters and that different methods used in cluster analysis often lead to different results. In this way, the number of clusters obtained by different researchers may not be consistent. In order to overcome the above problems, this paper takes time series dataset as the object, and analyzes the clustering problem of large-scale sampling time series, with the aim to establish both a rigorous theoretical foundation and a practical method.\nIn view of the aforementioned considerations and the practical demand of efficient and rigorous time series clustering, this paper proposes a morphological similarity clustering method based on equivalence relationship. Specifically, in \u201cMethods and main results\u201d section, four groups of equivalence relations and pertaining isomorphism theorems of multi-source time series are established by employing time series sampling data. In \u201cPartitioning large-scale time Series set\u201d section, we develop the equivalent partition theorem of large-scale time series datasets and the partition structure of large-scale datasets. In \u201cMetric of morphological deviation\u201d section, the calculation methods of morphological similarity metrics are proposed, which can be directly used for clustering of time series datasets based on different equivalence relations. In \u201cTwo typical application scenarios\u201d section, simulation results of two typical applications are provided, which verify the effectiveness of the proposed clustering methods based on equivalence relations for time series data sets.\n3 Vol.:(0123456789) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6"
        },
        {
            "heading": "Methods and main results",
            "text": "In order to solve the difficult problem of how many clusters a large-scale time series should be clustered into, which has long plagued the development of clustering theory, the main method proposed in this paper is to adopt the idea of equivalence division, and to propose four kinds of morphological similarity equivalence relationship which are particularly suitable for large-scale time series analysis, as well as four series of morphological similarity measurement algorithms to determine the number of clusters through the morphological similarity equivalence relationship.\nThe number of clusters is determined by the equivalence relationship of morphological similarity, and the clustering method is determined by the measurement of morphological similarity, which fundamentally advances the establishment and development of clustering theory.\nAnalysis of isomorphism and equivalence. The so-called isomorphism of time series is a very important concept in time series clustering. Intuitively, for any two time series, if one of them can be transformed into the other through translation or stretching, we call the two time series isomorphic. In the field of data analysis and statistical learning, isomorphism can be divided into two types: strict isomorphism and weak isomorphism. The former means that one time series can completely coincide with another time series after translation or stretching and the latter means that the mathematical expectation trajectory of one time series can completely coincide with another time series after translation or stretching, Considering that uncertainty error and random disturbance are ubiquitous in the sampling process, this paper focuses on weak isomorphism. In subsequent sections of this paper, the term \"isomorphism\" refers to \u201cweak isomorphism\u201d. As the time series data transformation, in the mathematical sense, both the translation transformation and the stretching transformation are equivalent relations, which have some important properties such as reflexivity, symmetry and transitivity, etc.\nTranslation isomorphism and equivalence relation. Before specifying that time series are isomorphic with respect to translation, we simplify the description of time series as follows\nwhere, tm,0 is the initial sampling time and tm,i is the i-th sampling time and hm is the sampling interval of the m-th channel.\nDefinition 1. For two time series {xa} and {xb} , if there is a constant H such that the mathematical expectation\nthen {xa} and {xb} are isomorphic with respect to transverse translation; if there is a constant W such that\nthen {xa} and {xb} are said to be isomorphic with respect to longitudinal translation.\nDefinition 2. For any two time series {xa} and {xb} , whether they are isomorphic for transverse translation, or isomorphic for longitudinal translation, or isomorphic for both transverse translation and longitudinal translation, we call them isomorphic with respect to translation and use {xa} \u2248T {xb} to represent the translational isomorphic relationship.\nTheorem\u00a01 For any two time series {xa} and {xb} , {xa} \u2248T {xb} if and only if there are two constants H and W such that\nProof: (a). According to definition 2, if {xa} \u2248T {xb} , then time times {xa} and {xb} are either transversely translational isomorphic,i.e.\nor longitudinally translational isomorphic, i.e.\nor both transversely translational isomorphic and longitudinally translational isomorphic, i.e.\n(b). If there are two constants H and W such that the formula (3) holds, then, in case (H = 0 & W \u2260 0), the core trajectories of these two time series can coincide by longitudinally translating W; in case (W = 0 & H \u2260 0), the core trajectories of these two time series can coincide by transversely translating H; in case ( HW = 0 ), the core trajectories of these two time series can be coincident by firstly translating W longitudinally and then H transversely. So, time series {xa} and {xb} are translation isomorphic. \u258b\nIt can be seen from Definition 1 that if {xa} \u2248T {xb} , then the core trajectories of {xa} and {xb} can be coincident without considering the influence of stochastic disturbance. In other words, translation isomorphic time\n{xm} = {x(tm,i) : tm,i = tm,0 + (i \u2212 1)hm, i = 1, 2, 3, ...}\n(1)E{xa(ta,i)\u2212 xb(tb,i +H)} = 0 for \u2200 i \u2208 N\n(2)E{xa(ta,i)\u2212 xb(tb,i)} = W for \u2200 i \u2208 N\n(3)E{xa(ta,i)\u2212 xb(tb,i +H)} = W\n(4)\u2203H , E{xa(ta,i)\u2212 xb(tb,i +H)} = W (W = 0)\n(5)\u2203W , E{xa(ta,i)\u2212 xb(tb,i +H)} = W (H = 0)\n(6)\u2203H ,W : E{xa(ta,i)\u2212 xb(tb,i +H)} = W\n4 Vol:.(1234567890) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nseries can realize the coincidence of core trajectories by the transverse translation as well as the longitudinal translation. Therefore, large-scale time series obtained from multiple different measurement channels can be classified into multiple isomorphic classes through isomorphic reduction or similarity clustering, which can provide great convenience for knowledge extraction and process monitoring.\nTheorem\u00a02 For large-scale sampled time series, the translation isomorphism \u2248T of time series is an equivalent relationship.\nProof The so-called equivalent relation refers to the mathematical relation satisfying reflexivity, symmetry and transitivity. It is easy to verify that the translation isomorphism \u2248T satisfies the following three properties:\na) Reflexivity. In fact, for any time series {xa} , the relation E{xa(ta,i)\u2212 xa(ta,i)} = 0 holds, so we have {xa}\u2248T {xa}; b) Symmetry. In fact, if the constants (H ,W) exists so that {xa} \u2248T {xb} holds, then H\u0303 = \u2212H and W\u0303 = \u2212W can be selected so that E{xb(tb,i)\u2212 xa(ta,i + H\u0303)} = W\u0303 holds, and thus the relationship {xb} \u2248T {xa} holds; c) Transitivity. In fact, if {xa} \u2248T {xb} and {xb} \u2248T {xc} with constants {H ,W} and {H \u2032,W \u2032} respectively, setting constants H\u0303 = H +H \u2032 and W\u0303 = W +W \u2032 , we get E{xa(ta,i)\u2212 xc(tc,i + H\u0303)} = W\u0303 , and {xa} \u2248T {xc}.\nThe above properties show that translational isomorphism satisfies the three properties of reflexivity, symmetry and transitivity, and is an equivalence relation.\nStretching isomorphism and equivalence relation. The stretching isomorphism of the shape of time series graph is another important isomorphism of time series, which means that one time series can overlap with another time series graph by elongating or compressing the scatter graph. The stretching isomorphism includes transversely stretching isomorphism and longitudinally stretching isomorphism.\nDefinition 3. For two time series {xa} and {xb} , if the following formula (7) holds:\nwhere ha and hb are the sampling intervals of {xa} and {xb} respectively, then these two time series {xa} and {xb} are isomorphic with respect to stretching time interval; if there exists a constant C such that\nthen these two time series {xa} and {xb} are isomorphic with respect to stretching range. \u258b\nFor any two time series {xa} and {xb} , if they are transverse stretching isomorphic, longitudinal stretching isomorphic, or both, they are referred to as stretching isomorphic and the relation of these two time series {xa} and {xb} are denoted by {xa} \u2248S {xb}.\nIt can be seen from Definition 3 that if {xa} \u2248S {xb} , then the core trajectories of {xa} and {xb} can be coincident without considering the influence of stochastic disturbance. In other words, two stretching isomorphic time series can realize the coincidence of core trajectories by the transversely stretching as well as the longitudinally stretching.\nTheorem\u00a03 For any two time series {xa} and {xb} , {xa} \u2248S {xb} if and only if there are two constants C and D such that\nProof: Given the proof process of Theorem\u00a01 and combining with Definition 3, it follows directly that this theorem holds.\nTheorem\u00a04 For large-scale time series, the stretching isomorphism relation \u2248S is an equivalent relationship.\nProof In order to deduce that the relation \u2248S is equivalent, we only need to prove that the relation \u2248S satisfies reflexivity, symmetry and transitivity.\na) Reflexivity. In fact, for any sampling time series {xa} , E{xa(ta,i)\u2212 xa(ta,i)} = 0 holds, and {xa} \u2248S {xa} is true. b) Symmetry. In fact, if {xa} \u2248S {xb} with constants C and D, then the following expression is hold\nSelecting C\u0303 = C\u22121 and D\u0303 = D\u22121 , we have\nTherefore, {xb} \u2248S {xa} is true.\n(7)E{xa(ta,1 + (i \u2212 1)ha)\u2212 xb(tb,1 + (i \u2212 1)hb)} = 0 for \u2200 i \u2208 N\n(8)E{xa(ta,i)\u2212 Cxb(tb,i)} = 0 for \u2200 i \u2208 N\n(9)E{xa(ta0 + iha)\u2212 Cxb(tb,0 + ihbD)} = 0 for \u2200 i \u2208 N\n(10)E{xa(ta,0 + iha)\u2212 Cxb(tb,0 + ihbD)} = 0 for forall i \u2208 N\n(11)E{xb(tb,0 + ihb)\u2212 C\u0303xa(ta,0 + ihaD\u0303)} = 0 for \u2200 i \u2208 N\n5 Vol.:(0123456789) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nc) Transitivity. In fact, if {xa} \u2248S {xb} and {xb} \u2248S {xc} with constants {C,D} and {C\u2019,D\u2019} respectively, then we have the following mathematical expressions:\nSelecting constants C\u0303 = CC\u2032 and D\u0303 = DD\u2032 , the following expression (14) can be derived by formula (12) and (13), i.e.\nSo, {xa} \u2248S {xc} is true, and the transitivity holds. \u258b\nThe translation equivalence relation \u2248T and the stretching equivalence relations \u2248S stated above are very useful for partitioning, clustering and classifying large-scale time series.\nPartitioning large\u2011scale time series set. The partition theorem based on the equivalence relation in set theory18,19 shows that any set can be uniquely and definitely divided into several equivalence subsets by any equivalence relation defined on the set, satisfying that different elements in each class are equivalent. Therefore, it is possible to use the translation isomorphism given in Theorem\u00a02 and the stretching isomorphism given in Theorem\u00a04 to divide a large-scale time series set into several equivalent class subsets.\nWithout loss of generality, use the set A to represent the multi-source sampling time series set obtained by the multi-sensor monitoring network composed of M sensors, which can be expressed in the following form:\nand set up equivalence relation R \u2208 {\u2248T ,\u2248S} on set A. Then the following Theorem\u00a05 can be derived directly from the set partition theory18 based on equivalence relation.\nTheorem\u00a05 Given that A = and the equivalent class is denoted as [xa]R = {{xb}|{xb} \u2208 A, {xb}R{xa}} , the following properties hold: (a) the equivalent class [xa]R \ufffd= for any series {xa} \u2208 A ; (b) if {xa} \u2208 A and {xb} \u2208 A are isomorphic, then [xa]R = [xb]R ; (c) if two series {xa} \u2208 A and {xb} \u2208 A are not isomorphic with respect to R \u2208 {\u2248T ,\u2248S} , then [xa]R \u2229 [xb]R = ; (d) for any time series {xc} \u2208 A , it belongs to and only belongs to an equivalent cluster; (e) The union of all clusters is equal to the complete set, i.e. \u222a{xa}[xa] = A.\nProof Firstly, for the equivalence relation R \u2208 {\u2248T ,\u2248S} , and the time seires {xa} \u2208 A , the following Eq.\u00a0(15) holds\nSo we have\nSecondly, for any two time series {xa} \u2208 A and {xb} \u2208 A , if the intersection set of equivalent calsses [xa]R and [xb]R is not empty set, [xa]R \u2229 [xb]R \ufffd= , then there is a time series {y(ti)} \u2208 [xa]R \u2229 [xb]R satisfying the following equivalent realtion\nUsing the transitive properties of equivalence relation given in Theorem\u00a02 and Theorem\u00a04, we get\nwhich means that these two series {xa} \u2208 A and {xb} \u2208 A are isomorphic with respect to R. Further, if {xa} \u2208 A and {xb} \u2208 A are isomorphic, we have the following equivalent relation (19) for any time series {z(ti)} \u2208 [xa]R\nUsing the transitive properties of equivalence relation given in Theorem\u00a02 and Theorem\u00a04, the relation (20) is holds\nSimilarly, using the transitive properties of equivalence relation given in Theorem\u00a02 and Theorem\u00a04, the relation (21) is holds\nSo, we get [xa]R = [xb]R . Using the Theorem\u00a05(b), it can be deduced that Theorem\u00a05(c)-(e) are valid. \u258b Theorem\u00a05 indicates us that a group of large-scale time series can be divided into several non-intersecting subsets, by means of stretching isomorphism \u2248S or translation isomorphism \u2248T . Moreover, all of the different\n(12) E{xb(tb,0 + ihb) =\n1 C Exa(ta,0 + iha 1 D )} E{xc(tc,0 + ihc)\n= 1 C \u2032 Exb(tb,0 + ih b 1 D \u2032 )} for \u2200 i \u2208 N\n(13)E{xc(tc,0 + ih c) = 1\nC\u0303 Exa(ta,0 + ih a\n1 D\u0303 )} for \u2200 i \u2208 N\n(14)A = {{xa}|xa(ta,i) \u2208 R; a = 1, ...,M; i = 1, 2, ...}}\n(15)E{xa(ta,i)\u2212 xa(ta,i)} = 0\n(16){xa} \u2208 [xa]R \u21d2 [xa]R \ufffd=\n(17){y(ti)} \u2248R {xa} {y(ti)} \u2248R {xb}\n(18){xa} \u2248R {y(ti)} \u2248R {xb}\n(19){z(ti)} \u2248R {xa} {z(ti)} \u2248R {xb}\n(20){z(ti)} \u2248R {xb} \u21d2 [xa]R \u2286 [xb]R\n(21)[xb]R \u2286 [xa]R\n6 Vol:.(1234567890) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\ntime series from the same cluster are isomorphic, and any two time series from two different separate subsets are not isomorphic. These important features should undoubtedly become the mathematical mechanism of large-scale time series clustering.\nTheorem\u00a05 is significant as it makes up for the incomplete-ness of existing time series clustering algorithms by providing reasonable mathematical explanation. The innovation of Theorem\u00a05 lies in that it solves the technical problem of how many clusters are most suitable for a given large-scale time series set by introducing the idea of equivalent relationship clustering. Specifically, Theorem\u00a05 shows that for large-scale time series, the number of the most suitable clustering classes is equal to the number of quotient sets,i.e.,\nAccording to the theory of quotient set19, any equivalence relation on set A can uniquely determine a clustering partition of set A. Therefore, if we use the above two equivalence relations R \u2208 {\u2248T ,\u2248S} , the large-scale time series set A can be divided into four parts. Any two time series in Part 1 are both translation isomorphic and stretching isomorphic, any two time series in Part 2 are translation isomorphic but not stretching isomorphic, any two time series in Part 3 are stretching isomorphic but not translation isomorphic, and any two time series in Part 4 are neither translation isomorphic nor stretching isomorphic. Each partition is a set of subsets of several equivalent classes.\nMetric of morphological deviation. Before using these theoretical results to the actual clustering calculation and knowledge acquisition, it is necessary to give a calculation method for the morphological similarity of time series from the perspective of computational mathematics.\nFor any two time series, their similarity is inversely proportional to their deviation degree, that is, we can start from the measurement of deviation to establish the similarity measurement index. In this section, four indictors are built to measure deviation and used to measure the morphological similarity of different time series data.\n(a) Metric of minimum deviation under transverse translation\nAccording to Definition 1 and Eq.\u00a0(1), the minimum deviation TT ,a\u2192b of two time series {xa} and {xb} under transverse translation can be theoretically expressed by the mathematical expectation of absolute deviation, i.e.,\nObviously, TT ,a\u2192b is suitable to measure the difference between time series {xa} and {xb} under transverse translation and can be estimated as\nIn order to determine the minimization involved in (24), a two-step algorithm is proposed as follows: Step 1: Determine number of sliding steps m by solving the minimum point in the following formula (25)\nwhere J is the integer set and hb is the sampling interval of the time series {xb,i}. Step 2: Determine the remnants \u03b4b of time by solving the minimum point in the following formula (26)\nThen, the minimum deviation metric TT ,a\u2192b between time series {xa} and {xb} under transverse translation can be estimated by\n(b) Metric of Minimum Deviation under Longitudinal Translation\nAccording to Definition 1 and Eq.\u00a0(2), the minimum deviation metric TL,a\u2192b of any two time series {xa} and {xb} under longitudinal translation is estimated by.\n(22)A/R = {[xa]R|{xa} \u2208 A}\n(23)TT ,a\u2192b = minizing H\u2208R E|xa(t)\u2212 xb(t +H)|\n(24)T\u0302T ,a\u2192b = minizing H\u2208R\n\u221a \u221a\n\u221a\n\u221a\n1\nN\nN \u2211 i=1 (xa(ti)\u2212 xb(ti +H))2\n(25)m\u0303b = argminizing m\u2208J\nN \u2211 i=1 (xa(ta,i)\u2212 xb(tb,i +mhb))2\n(26)\u03b4\u0302b = arg minizing db\u2208[\u2212hb ,hb]\nN \u2211 i=1 (xa(ta,i)\u2212 xb(tb,i + m\u0303bhb + \u03b4b))2\n(27)T\u0302T ,a\u2192b = 1\u221a N\n\u221a \u221a\n\u221a\n\u221a\nN \u2211 i=1 (xa(ti)\u2212 xb(ti + m\u0303bhb + \u03b4\u0302b))2\n(28)TL,a\u2192b = minizing W\u2208R E|xa(t)\u2212 (xb(t +W)|\n7 Vol.:(0123456789) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nwhich can be used to describe the difference between time series {xa} and {xb} with respect to the longitudinal translation. Then, the minimum deviation metric TL,a\u2192b with respect to longitudinal translation can be estimated by\nUsing xa and xb to represent the statistical mean estimators of {xa(t)} and {xb(t)} respectively, we are able to verify that the following formula (30) is true:\nAccording to Eq.\u00a0(30), W\u0302 is called the least deviation offset. The residual sequence {Ea,b(ti)} under the longitudinal translation based on the least deviation is as follows\nIt can be seen that calculation formula (29) of the minimum deviation under the longitudinal translation can be estimated by\n(c) Metric of Minimum Deviation under Transverse Stretching\nBased on Definition 3 and Eq.\u00a0(7), the minimum deviation ST ,a\u2192b of any two time series {xa} and {xb} under transverse stretching is defined by\nwhich can be used to describe the difference between time series {xa} and {xb} with respect to the transverse stretching. Then, the minimum deviation metric ST ,a\u2192b under transverse stretching can be estimated by the formula (34)\nIn order to determine the minimization of the formulae (34), a two-step algorithm is proposed as follows: Step 1: According to the First Weierstrass Approximation Theorem, the sampling time series can be fitted with k-order polynomials, where the value of k can be determined by Akachi Information Criterion. Using the classical least squared fitting method, we can construct the vectors formed by the fitting coefficients\nand the fitting curves f\u0302a(t) and f\u0302b(t) are as follows\nfor {xa} and {xb} respectively, where the matrices Hz,k are determined by the following formula\nStep 2: Determine the transverse stretching ratio D by\n(29)T\u0302L,a\u2192b = 1\u221a N\n\u221a \u221a\n\u221a \u221aminizing W\u2208R\nN \u2211 i=1 (xa(ti)\u2212 xb(ti)\u2212W)2\n(30)W\u0302 = argminizing W\u2208R\nN \u2211 i=1 (xa(ti)\u2212 xb(ti)\u2212W)2 = 1 N N \u2211 i=1 (xa(ti)\u2212 xb(ti)) = xa \u2212 xb\n(31)Ea,b(ti) = xa(ti)\u2212 (xb(ti)\u2212 W\u0302) = [xa(ti)\u2212 xa] \u2212 [xb(ti)\u2212 xb]\n(32)T\u0302L,a\u2192b =\n\u221a \u221a\n\u221a\n\u221a\n1\nN\nN \u2211 i=1 E2a,b(ti)\n(33)ST ,a\u2192b = minizing D\u2208[0,+\u221e) E|xa(t)\u2212 xb(t0 + D(t \u2212 t0))|\n(34)S\u0302T ,a\u2192b =\n\u221a \u221a\n\u221a\n\u221a\n1 N minizing D\u2208[0,+\u221e)\nN \u2211 i=1 (xa(ta,0 + iha)\u2212 xb(tb,0 + ihbD))2\n(35)\n\n\n \u03b8\u0302z,1 ...\n\u03b8\u0302z,kz\n\n  =\n\ufffd Hz,k \ufffd\u22121\n\n\n t0z,1 \u00b7 \u00b7 \u00b7 tkz,1 ... ...\nt0z,N \u00b7 \u00b7 \u00b7 tkz,N\n\n\n\n\u03c4\n\n xz(tz,1) ...\nxz(tz,N )\n\n  (z = a, b)\n(36)f\u0302z(t) = kz \u2211\ni=0 \u03b8\u0302z,it\ni (z = a, b)\n(37)Hz,k =\n\n\n t0z,1 \u00b7 \u00b7 \u00b7 tkz,1 ... ...\nt0z,N \u00b7 \u00b7 \u00b7 tkz,N\n\n\n\n\u03c4\n\n t0z,1 \u00b7 \u00b7 \u00b7 tkz,1 ... ...\nt0z,N \u00b7 \u00b7 \u00b7 tkz,N\n\n  (z = a, b)\n(38)D\u0302 = argminizing D\u2208[0,+\u221e)\n\u222b ta,N\nta,1\n( f\u0302a(t)\u2212 f\u0302b(ta,1 + D(t \u2212 ta,1)) )2 dt\n8 Vol:.(1234567890) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nand calculate the difference metric under transverse stretching by the following formula\n(d) Metric of Minimum Deviation under Longitudinal Stretching\nAccording to Definition 3 and Eq.\u00a0(8), the minimum deviation SL,a\u2192b of any two time series {xa} and {xb} under longitudinal stretching is defined by\nwhich can be used to describe the difference between time series {xa} and {xb} with respect to the longitudinal stretching. Then, the minimum deviation metric SL,a\u2192b under longitudinal stretching is constructed as follows\nIt is easy to verify that the following formula (42) is true,\nFor two time series {xa} and {xb} , selecting C\u0302 as the optimal elongation coefficient and adopting the notation\nthen the residual sequence {Fa,b(ti)} under the longitudinal expansion based on the optimal elongation is as follows\nand the estimator of SL,a\u2192b can be transformed into\nIt is worth noting that these aforementioned metrics unifies the conventional time series clustering methods based on Euclidean distance, the Shape-based template matching, and the Dynamic Time Warping (DTW).\nMoreover, when using the above minimum deviation metrics for machine learning and clustering of time series data, the errors in the time series of measurement data must be considered. This is because of the inevitable measurement errors and random disturbances. In other words, it is difficult to obtain a zero-value metric of the minimum deviation when morphological clustering is carried out on the actual sampled data. Nevertheless, the closer the minimum deviation metric is to zero, the higher the similarity is."
        },
        {
            "heading": "Two typical application scenarios",
            "text": "These proposed methods of equivalent division based on morphological similarity and clustering based on similarity metric are very valuable in many different fields such as clustering of massive time series, monitoring of on-orbit spacecraft operation status, monitoring of petrochemical production process, monitoring of process abnormal changes, etc. In this section, two typical applications are provided, where the proposed methods are used for reduction of massive monitoring data and for detection of abnormal changes in times series, respectively.\nScenario 1: reduction of massive monitoring data. Reduction of large-scale sampled data is an important issue in the field of process monitoring for complex objects. In order to monitor the dynamic changes of complex dynamic objects, it is often necessary to use large-scale sensor networks to obtain time series data of dynamic objects from different perspectives or levels. It is difficult and bandwidth-consuming to transmit a large amount of sampling data to the monitoring center. To do this, we need to reduce the large amount of redundant data. In other words, For actual project status monitoring, if there are multiple sets of data sequences with similar changes, we only need to transmit a set of time series data to the monitoring center, thereby reducing a large number of redundant data sequences. A feasible and practical method is to cluster tens of thousands or even hundreds of thousands of sampling time series from sensors. Although the sampling objects of multi-position\n(39)S\u0302T ,a\u2192b = \u222b ta,N\nta,1\n( f\u0302a(t)\u2212 f\u0302b(ta,1 + D\u0302(t \u2212 ta,1)) )2 dt\n(40)SL,a\u2192b = minizing C\u2208(0,+\u221e)\n\u221a\nE(xa(t)\u2212 Cxb(t))2\n(41)S\u0302L,a\u2192b = 1\u221a N minizing C\u2208(0,+\u221e)\n\u221a \u221a\n\u221a\n\u221a\nN \u2211 i=1 (xa(ta,i)\u2212 Cxb(tb,i))2\n(42)C\u0302 = 1\nN argmin izing\nC\u2208R\nN \u2211 i=1 (xa(ta,i)\u2212 Cxb(tb,i))2 =\nN \u2211 i=1 xa(ta,i)xb(tb,i)\nN \u2211 i=1 xb(tb,i)xb(tb,i)\n(43)Ra,b = 1\nN\nN \u2211 i=1 xa(ta,i)xb(tb,i)\n(44)Fa,b(ta,i) = xa(ta,i)\u2212 Ra,b\nRb,b xb(tb,i)\n(45)S\u0302L,a\u2192b = 1\u221a N\n\u221a \u221a\n\u221a\n\u221a\nN \u2211 i=1 F2a,b(ta,i)\n9 Vol.:(0123456789) Scientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nsensors may be different in the actual engineering process, the change patterns of time series often have some similarity. This feature provides the possibility for clustering-based analysis and diagnosis.\nFor example, as one of the many functional systems of a satellite, the attitude control system is usually equipped with four reaction wheels. Each reaction flywheel typically has more than 10 different types of sampled data. The current sampling data is directly used to monitor whether the reaction flywheel is working properly. If it can be determined that the current change patterns of the four reaction flywheels are the same, we may significantly reduce the number of current telemetry data downloads, and reasonably use the difference between data changes to find possible faulty flywheels. Figure\u00a01 is the sampling data plots of motor currents of four reaction wheels during spacecraft in orbit.\nUsing the sampled current data from the four series shown in Fig.\u00a01, it can be seen that the amplitudes of the four series of data are significantly different, but their morphology is somewhat similar. We need to determine whether these four sets of data are essentially homogeneous. If they are isomorphic, we may focus our attention from four sets of data to one set of data when monitoring the flywheel current, thereby effectively reducing the workload.\nFor this reason, we use Eq.\u00a0(32) to calculate the minimum deviation for each two groups of these four time series. The results are shown in the following matrix (46), which indicates that all minimum deviations between any two time series in the four time series are very close to zero (it is worth noting that the closer the estimated minimum deviation is to zero, the more similar the two time series are).\nFigure\u00a02 is the plots of the residuals calculated according to formula (31) under the longitudinal translation equivalent transformation, which can be observed that the four groups of data are longitudinally translational equivalent and thus belong to the same morphological isomorphic equivalent cluster. Further, it can be concluded that the four different sampling time series shown in Fig.\u00a02 are almost identical statistically.\nThe metric matrix TL of the minimum deviation under longitudinal translation conditions shown in Eq.\u00a0(46) calculated using measured data shows that the morphological differences of the four time series can be eliminated through appropriate longitudinal translation, which is also confirmed by Fig.\u00a02. Therefore, when the flywheel operates normally, the workload of simultaneously monitoring the currents of four flywheels can be simplified to monitoring the current data of one flywheel. If some flywheels may be abnormal, we can use the morphological similarity of the four modes under normal conditions to determine whether the flywheel data maintains a similar morphology, thereby locating the faulty flywheel.\nScenario2: detection of abnormal changes in time series. The aforementioned morphological similarity metrics can not only cluster time series data with similar morphology, but also distinguish time series with different morphology, thereby detecting inconsistencies and abnormal changes. Taking a heating furnace as an example, we can use the method of monitoring the morphological differences of petrochemical produc-\n(46)\nFigure\u00a01. Plot of sampling current data from four reaction wheel motors of an on-orbit spacecraft.\n10\nVol:.(1234567890)\nScientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\ntion process sampling data obtained from a large number of sensors and instruments during the petrochemical production process to achieve the monitoring of production equipment status changes and implement safe operation management.\nHeating furnaces are important equipment in petrochemical industry, and their temperature changes are the main basis for monitoring the working conditions of heating furnaces. Whether the temperature changes at different measuring points of the heating furnace are similar is of great significance for simplifying temperature monitoring and finding corrosion and damage in the heating furnace. Figures\u00a03(a-c) show the temperature curves at the measuring points I1, I2 and I3 of the heating furnace I seperately. Besides, Fig.\u00a03(d) shows the exhaust gas temperature curve of the heating furnace II. In the followings, we find out which data sequence has different change pattern compared with the others from the four groups of data.\nAccording to formula (44), we calculate the residual of the variation under the longitudinal expansion based on the optimal elongation, as shown in Fig.\u00a04. It can be observed that these four sets of data are neither longitudinally stretched equivalent nor belong to the same morphological isomorphic equivalent cluster. Furthermore, it can be concluded that the change patterns of sequences S2 and S4 are different from the cluster {S1, S3}, and there are abnormal changes in the changing pattern of time series.\nIntuitively, Fig.\u00a04a,c show that the pattern of time series S1 is similar to that of S3. Figure\u00a04b shows that the pattern of S2 is significantly different from those of the other three time series. Figure\u00a04d shows that the pattern\nFigure\u00a02. Residuals of sampling current of four reaction wheel motors under longitudinal translation.\nFigure\u00a03. Plots of the temperature of furnace I and the temperature of the exhaust gas from furnace II.\n11\nVol.:(0123456789)\nScientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nof S4 is significantly different from those of the other three time series. The question now is how to confirm the above inconsistency and whether the changing patterns of time series S1, S2, and S3 are inconsistent.\nIn order to rigorously measure the morphological differences and similarities between the aforementioned four time series, we use the morphological similarity metric formulae (45) to estimate the longitudinal stretching similarity metrics between any two radiation time series of the four monitoring points. Results\u00a0are\u00a0obtained\u00a0as\u00a0follows\nIt can be clearly seen from the similarity metric matrix that time series S1 and S3 are similar in morphology, but S2 and S4 are not morphological similarity with S1 and S3. In other words, these four time series are morphologically divided into three categories, i.e., {S1, S3}, {S2}, and {S4}. It can also be confirmed from Fig.\u00a04 that it is appropriate to divide these four groups of time series into three clusters."
        },
        {
            "heading": "Discussion",
            "text": "This study proposes the concept of time series morphological isomorphism, proves that translation isomorphism and stretch isomorphism are equivalent relationships, develops computational methods for morphological similarity measures, and establishes a time series clustering method based on equivalence partitioning and morphological similarity.\nIn the field of machine learning, how many classes should be clustered in theory rather than relying on guesswork is a difficult problem that plagues the research and application of time series clustering methods. Based on four equivalence relationships that do not change the shape of time series data (i.e., horizontal translation, vertical translation, horizontal scaling, and vertical scaling), four equivalence partitioning methods for large-scale time series data sets are established, and algorithms for determining the number of clusters is given through quotient sets. These theoretical research results given in this paper provide a theoretical basis for how many clusters a large-scale time series should be clustered into.\nWith the help of the similarity metrics and their calculation formulas proposed in this paper, we can rigorously implement clustering of large-scale time series. The effectiveness of the proposed algorithms is verified by using the practical data in important industrial application scenarios as well as spacecraft monitoring scenarios.\nIt should be noted that although this study provides theoretical results on the number of clusters and computational metrics to measure morphological similarity between time series, morphological similarity is not a term with clear boundaries. How to accurately delineate similarity using metrics requires further research in the future."
        },
        {
            "heading": "Data availability",
            "text": "The datasets used and analyzed during the current study are available upon reasonable request from the corresponding author (S.H.). There are no restrictions on data availability.\n(47)\nFigure\u00a04. Plot of residual temperature difference based on longitudinal stretching transformation.\n12\nVol:.(1234567890)\nScientific Reports | (2023) 13:5900 | https://doi.org/10.1038/s41598-023-33074-6\nReceived: 24 November 2022; Accepted: 6 April 2023"
        },
        {
            "heading": "Acknowledgements",
            "text": "This paper is financially supported by the National Nature Science Foundation of China (61973094) and Guangdong Natural Science Foundation (2023A1515012341)."
        },
        {
            "heading": "Author contributions",
            "text": "S.H. wrote the main manuscript text and proposed the entire theoretical approaches."
        },
        {
            "heading": "Competing interests",
            "text": "The author declares no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Correspondence and requests for materials should be addressed to S.H.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2023"
        }
    ],
    "title": "Equivalence partition based morphological similarity clustering for large-scale time series",
    "year": 2023
}