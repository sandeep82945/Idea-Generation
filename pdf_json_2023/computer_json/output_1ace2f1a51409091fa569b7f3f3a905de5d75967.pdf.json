{
    "abstractText": "Getting standard multigrid to work efficiently for the high-frequency Helmholtz equation has been an open problem in applied mathematics for years. Much effort has been dedicated to finding solution methods which can use multigrid components to obtain solvers with a linear time complexity. In this work we present one among the first stand-alone multigrid solvers for the 2D Helmholtz equation using both a constant and non-constant wavenumber model problem. We use standard smoothing techniques and do not impose any restrictions on the number of grid points per wavelength on the coarse-grid. As a result we are able to obtain a full Vand W-cycle algorithm. The key features of the algorithm are the use of higher-order inter-grid transfer operators combined with a complex constant in the coarsening process. Using weighted-Jacobi smoothing, we obtain a solver which is h \u0301independent and scales linearly with the wavenumber k. Numerical results using 1 to 5 GMRES(3) smoothing steps approach k \u0301 and h \u0301 independent convergence, when combined with the higher-order inter-grid transfer operators and a small or even zero complex shift. The proposed algorithm provides an important step towards the perpetuating branch of research in finding scalable solvers for challenging wave propagation problems.",
    "authors": [
        {
            "affiliations": [],
            "name": "VANDANA DWARKA"
        }
    ],
    "id": "SP:b449202b485083b15b2e9143e7213eb595108823",
    "references": [
        {
            "authors": [
                "J.H. Bramble",
                "J.E. Pasciak",
                "J. Xu"
            ],
            "title": "The analysis of multigrid algorithms for nonsymmetric and indefinite elliptic problems",
            "venue": "Mathematics of Computation, 51 ",
            "year": 1988
        },
        {
            "authors": [
                "J. Brannick",
                "F. Cao",
                "K. Kahl",
                "R.D. Falgout",
                "X. Hu"
            ],
            "title": "Optimal interpolation and compatible relaxation in classical algebraic multigrid",
            "venue": "SIAM Journal on Scientific Computing, 40 ",
            "year": 2018
        },
        {
            "authors": [
                "M. Brezina",
                "A.J. Cleary",
                "R.D. Falgout",
                "V.E. Henson",
                "J.E. Jones",
                "T.A. Manteuffel",
                "S.F. McCormick",
                "J.W. Ruge"
            ],
            "title": "Algebraic multigrid based on element interpolation (amge)",
            "venue": "SIAM Journal on Scientific Computing, 22 ",
            "year": 2001
        },
        {
            "authors": [
                "M. Brezina",
                "R. Falgout",
                "S. MacLachlan",
                "T. Manteuffel",
                "S. McCormick",
                "J. Ruge"
            ],
            "title": "Adaptive smoothed aggregation (\u03b1 sa) multigrid",
            "venue": "SIAM review, 47 ",
            "year": 2005
        },
        {
            "authors": [
                "H. Chen",
                "P. Lu",
                "X. Xu"
            ],
            "title": "A robust multilevel method for hybridizable discontinuous galerkin method for the helmholtz equation",
            "venue": "Journal of Computational Physics, 264 ",
            "year": 2014
        },
        {
            "authors": [
                "H. Chen",
                "H. Wu",
                "X. Xu"
            ],
            "title": "Multilevel preconditioner with stable coarse grid corrections for the helmholtz equation",
            "venue": "SIAM Journal on Scientific Computing, 37 ",
            "year": 2015
        },
        {
            "authors": [
                "P.-H. Cocquet",
                "M.J. Gander"
            ],
            "title": "How large a shift is needed in the shifted helmholtz preconditioner for its effective inversion by multigrid",
            "venue": "SIAM Journal on Scientific Computing, 39 ",
            "year": 2017
        },
        {
            "authors": [
                "P.-H. Cocquet",
                "M.J. Gander",
                "X. Xiang"
            ],
            "title": "Closed form dispersion corrections including a real shifted wavenumber for finite difference discretizations of 2d constant coefficient helmholtz problems",
            "venue": "SIAM Journal on Scientific Computing, 43 ",
            "year": 2021
        },
        {
            "authors": [
                "S. Cools",
                "B. Reps",
                "W. Vanroose"
            ],
            "title": "A new level-dependent coarse grid correction scheme for indefinite helmholtz problems",
            "venue": "Numerical Linear Algebra with Applications, 21 ",
            "year": 2014
        },
        {
            "authors": [
                "V. Dwarka",
                "C. Vuik"
            ],
            "title": "Scalable convergence using two-level deflation preconditioning for the helmholtz equation",
            "venue": "SIAM Journal on Scientific Computing, 42 ",
            "year": 2020
        },
        {
            "authors": [
                "V. Dwarka",
                "C. Vuik"
            ],
            "title": "Scalable multi-level deflation preconditioning for highly indefinite time-harmonic waves",
            "venue": "Journal of Computational Physics, 469 ",
            "year": 2022
        },
        {
            "authors": [
                "H.C. Elman",
                "O.G. Ernst"
            ],
            "title": "and D",
            "venue": "P. O\u2019leary, A multigrid method enhanced by krylov subspace iteration for discrete helmholtz equations, SIAM Journal on scientific computing, 23 ",
            "year": 2001
        },
        {
            "authors": [
                "Y. Erlangga",
                "E. Turkel"
            ],
            "title": "Iterative schemes for high order compact discretizations to the exterior helmholtz equation",
            "venue": "ESAIM: Mathematical Modelling and Numerical Analysis, 46 ",
            "year": 2012
        },
        {
            "authors": [
                "Y.A. Erlangga",
                "R. Nabben"
            ],
            "title": "On a multilevel krylov method for the helmholtz equation preconditioned by shifted laplacian",
            "venue": "Electronic Transactions on Numerical Analysis, 31 ",
            "year": 2008
        },
        {
            "authors": [
                "Y.A. Erlangga",
                "C.W. Oosterlee",
                "C. Vuik"
            ],
            "title": "A novel multigrid based preconditioner for heterogeneous helmholtz problems",
            "venue": "SIAM Journal on Scientific Computing, 27 ",
            "year": 2006
        },
        {
            "authors": [
                "O.G. Ernst",
                "M.J. Gander"
            ],
            "title": "Why it is difficult to solve helmholtz problems with classical iterative methods",
            "venue": "Numerical analysis of multiscale problems, Springer",
            "year": 2012
        },
        {
            "authors": [
                "O.G. Ernst",
                "M.J. Gander"
            ],
            "title": "Multigrid methods for helmholtz problems: a convergent scheme in 1d using standard components",
            "venue": "Direct and Inverse Problems in Wave Propagation and Applications. De Gruyer, ",
            "year": 2013
        },
        {
            "authors": [
                "R.D. Falgout",
                "P.S. Vassilevski"
            ],
            "title": "On generalizing the algebraic multigrid framework",
            "venue": "SIAM Journal on Numerical Analysis, 42 ",
            "year": 2004
        },
        {
            "authors": [
                "W. Hackbusch"
            ],
            "title": "Multi-grid methods and applications",
            "venue": "vol. 4, Springer Science & Business Media",
            "year": 2013
        },
        {
            "authors": [
                "G.R. Hadley"
            ],
            "title": "A complex jacobi iterative method for the indefinite helmholtz equation",
            "venue": "Journal of computational physics, 203 ",
            "year": 2005
        },
        {
            "authors": [
                "D. Lahaye",
                "H. De Gersem",
                "S. Vandewalle",
                "K. Hameyer"
            ],
            "title": "Algebraic multigrid for complex symmetric systems",
            "venue": "IEEE Transactions on Magnetics, 36 ",
            "year": 2000
        },
        {
            "authors": [
                "B. Lee",
                "T.A. Manteuffel",
                "S.F. McCormick",
                "J. Ruge"
            ],
            "title": "First-order system least-squares for the helmholtz equation",
            "venue": "SIAM Journal on Scientific Computing, 21 ",
            "year": 2000
        },
        {
            "authors": [
                "I. Livshits",
                "A. Brandt"
            ],
            "title": "Accuracy properties of the wave-ray multigrid algorithm for helmholtz equations",
            "venue": "SIAM Journal on Scientific Computing, 28 ",
            "year": 2006
        },
        {
            "authors": [
                "S.P. MacLachlan",
                "C.W. Oosterlee"
            ],
            "title": "Algebraic multigrid solvers for complex-valued matrices",
            "venue": "SIAM Journal on scientific computing, 30 ",
            "year": 2008
        },
        {
            "authors": [
                "Y. Notay"
            ],
            "title": "Convergence analysis of perturbed two-grid and multigrid methods",
            "venue": "SIAM journal on numerical analysis, 45 ",
            "year": 2007
        },
        {
            "authors": [
                "Y. Notay"
            ],
            "title": "An aggregation-based algebraic multigrid method",
            "venue": "Electronic transactions on numerical analysis, 37 ",
            "year": 2010
        },
        {
            "authors": [
                "Y. Notay"
            ],
            "title": "Algebraic analysis of two-grid methods: The nonsymmetric case",
            "venue": "Numerical Linear Algebra with Applications, 17 ",
            "year": 2010
        },
        {
            "authors": [
                "Y. Notay"
            ],
            "title": "Analysis of two-grid methods: The nonnormal case",
            "venue": "Mathematics of Computation, 89 ",
            "year": 2020
        },
        {
            "authors": [
                "L.N. Olson",
                "J.B. Schroder"
            ],
            "title": "Smoothed aggregation for helmholtz problems",
            "venue": "Numerical Linear Algebra with Applications, 17 ",
            "year": 2010
        },
        {
            "authors": [
                "L.N. Olson",
                "J.B. Schroder",
                "R.S. Tuminaro"
            ],
            "title": "A general interpolation strategy for algebraic multigrid using energy minimization",
            "venue": "SIAM Journal on Scientific Computing, 33 ",
            "year": 2011
        },
        {
            "authors": [
                "L.G. Ramos",
                "R. Nabben"
            ],
            "title": "On optimal algebraic multigrid methods",
            "venue": "arXiv preprint arXiv:1906.01381, ",
            "year": 2019
        },
        {
            "authors": [
                "A. Sheikh",
                "D. Lahaye",
                "L.G. Ramos",
                "R. Nabben",
                "C. Vuik"
            ],
            "title": "Accelerating the shifted laplace preconditioner for the helmholtz equation by multilevel deflation",
            "venue": "Journal of Computational Physics, 322 ",
            "year": 2016
        },
        {
            "authors": [
                "J. Wang"
            ],
            "title": "Convergence analysis of multigrid algorithms for nonselfadjoint and indefinite elliptic problems",
            "venue": "SIAM journal on numerical analysis, 30 ",
            "year": 1993
        }
    ],
    "sections": [
        {
            "text": "Key words. Helmholtz Equation, Multigrid, Jacobi, Indefinite Matrix, CSLP, Convergence\nAMS subject classifications. 65N55, 65F10, 65F15\n1. Introduction. For over three decades, researchers have studied ways to design convergent and efficient multigrid schemes for the indefinite Helmholtz equation, which to this day remains an open problem in applied mathematics. The Helmholtz equation finds its application in many engineering practices, ranging from geoscience to plasma physics and quantum mechanics. Solving the Helmholtz equation numerically is a challenging task. Multigrid methods are widely known to be efficient and scalable numerical solvers for elliptic PDEs. It provided a state-of-the-art numerical approach, where the amount of computational work scales with the number of unknowns. In essence, the method combines solutions on coarser grids with relaxation (smoothing) techniques to arrive at a solution on the fine grid.\nWhile multigrid works well for the positive-definite variant of the Helmholtz equation or when the wavenumber is small, the method generally fails to converge as a stand-alone solver for the indefinite version. This break-down can be attributed to two things. First of all, the coarse-grid needs to be fine enough in order to resolve the waves. A difference between the wavenumber on the fine vs. coarse-grid(s) can cause a phase error leading to instabilities [17]. Moreover, eigenvalues approaching zero also hamper the convergence as they lead to near-singularity within the coarsegrid operator [17]. Several strategies have been proposed to study the convergence behavior of such indefinite systems [2, 1, 34, 20]. This boils down to prove convergence of the two-grid method for the positive definite variant (see [20], chapter 11.6). Another approach lies in trying to find upper and lower bounds to the field of values of the two-grid operator [28, 26, 27, 29]. This requires that the Hermitian part of the linear system 12 ` A ` AT \u02d8\nis positive definite, which is not the case for the indefinite Helmholtz equation. While we can still use the condition that the spectral radius\n\u02daDepartment of Applied Mathematics, Delft University of Technology, Delft, the Netherlands (v.n.s.r.dwarka@tudelft.nl).\n:Department of Applied Mathematics, Delft University of Technology, Delft, the Netherlands (c.vuik@tudelft.nl, homepage.tudelft.nl/d2b4e/).\n1\nar X\niv :2\n30 8.\n13 47\n6v 1\n[ m\nat h.\nN A\n] 2\n5 A\nug 2\n02 3\nof the two-grid iteration matrix should be smaller than one, the computation of the eigenvalues becomes difficult in case of Sommerfeld boundary conditions. Moreover, it has been noted that for nonnormal (complex) systems in particular, the Helmholtz equation being an example of such, assessing convergence solely based on the spectral radii can be misleading as it only rigorously describes asymptotic convergence [29]. Bounds in terms of norms would be more appropriate. However, these often go hand in hand with assumptions which are difficult to check and contain unknown constants, which reduces their practical applicability.\nFor positive-definite and complex Hermitian problems, Geometric and/or Algebraic Multigrid are powerful solvers which provide solutions in linear time complexity by constructing coarser linear systems based on the information provided by the finegrid linear system. For complex Hermitian matrices, the coarse linear systems can be build using the Galerkin condition, which has been studied in [22, 25]. If the use of a simple smoother by means of a stationary iterative method such as weighted-Jacobi or Gauss-Seidel is preferred, the coarse grid correction scheme should balance the simplicity of the smoother by accurately transferring smooth errors from the coarse grid to the fine grid [25]. When the linear system is complex symmetric, linear interpolation can be used to construct the prolongation operator. The restriction operator can then be chosen as the transpose of the prolongation operator. In fact, for real matrices optimality studies have been conducted in order to construct the interpolation and prolongation operators [4, 5, 19, 3]. In [32], a similar optimality condition from [19, 3] has been extended to the Hermitian case. These studies show that the optimal prolongation and restriction operator are based on the eigenvectors of the system matrix and several approximations are given which could function as a satisfactory proxy in the case of symmetric positive definite (SPD) and Hermitian systems respectively.\nIncluding a complex shift, leads to the Complex Shifted Laplacian (CSL), which can be solved using multigrid as a stand-alone solver. Consequently, for the original indefinite Helmholtz problem, multigrid applied to the CSL can be used as a preconditioner, together with an iterative Krylov subspace method, such as GMRES. Here, the original indefinite Helmholtz problem is solved by approximately inverting the CSL using geometric multigrid [16, 15, 14, 8]. While this works well for homogeneous problems, it is not suitable for heterogeneous problems with high contrasts [33, 15].\nWhen it comes to using multigrid as a stand-alone solver for the original Helmholtz operator, several studies have focused on getting multigrid to comply with the underlying characteristics of the indefinite nonsymmetric system. One study uses a smoothed aggregation approach, where an effective prolongation operator is constructed by minimizing the energy norm defined using the normal equations A\u02daA. This is achieved by running the CGNR algorithm to solve the equation A\u02daAP \u201c 0, where P is the tentative prolongation operator [30, 31]. Two other methods are the wave-ray approach [24] and the first-order least squares (FOLS) approach [23]. Both compute multiple coarse spaces to approximate the plane waves in the near null space. In both works, the development of more efficient approaches for such linear systems has been stressed. Moreover, for variable wave numbers, it remains challenging to choose an effective prolongation and restriction operator, especially if the aim is to keep the algorithm as light as possible.\nAnother difficulty arises in picking a suitable smoother, as for Helmholtz problems, the (weighted)-Jacobi method diverges. While the latter has natural parallelization properties and is often preferred for SPD problems, no clear remedy exists to apply it suitably for Helmholtz problems at large wavenumbers and tailored adaptions are needed [21, 18, 16]. Essentially, this relates to the indefiniteness of the underlying\noperators, leading to negative eigenvalues which ensure that the spectral radius of the weighted-Jacobi iteration matrix is always greater than 1. One important recent study finds that replacing the weighted-Jacobi smoother with a few GMRES iterations could lead to improved convergence [13]. In [17, 18], it was shown that for the one-dimensional indefinite Helmholtz equation, convergence can be achieved by considering a two-step Jacobi smoother. Scheduling the smoothing steps on all levels as a function of the wave number provides a uniform error reduction in the high-frequency modes. More recently a two-dimensional dispersion correction has been developed for the original Helmholtz operator when using a constant wave number. Here, a larger number of smoothing steps combined with at least 4.5 grid points per wavelength at the coarsest level leads to a convergent multigrid scheme. [9].\nA full multigrid hierarchy, without any restrictions on the grid resolution at the coarsest level, is given in [10]. Here, a re-discretization technique is used where a leveldependent complex shift is incorporated, except the finest level. The authors show that the altered two-grid correction scheme, combined with 3 GMRES iterations as a smoother, remains robust and does not lead to agitation of smooth modes. The method works well on structured grids and in cases where the behavior of the wave number on the fine and coarse(r) grids can be defined a-priori. Complex geometries, high-contrast and irregularly varying wave number would pose difficulties in constructing the coarser linear systems along the multilevel hierarchy, when re-discretization is used combined with a level-dependent parameter.\nIn this work we aim to solve the complex indefinite Helmholtz problem using constant and variable wave numbers with a stand-alone multigrid method using Galerkin coarsening. For the baseline convergence study, we impose two requirements: the method should converge with a small number of smoothing steps and the intergrid transfer operators should be level-independent and easy to construct and implement.\nOur contribution to this long standing field of research can be summarized into the following points:\n\u201a To the best of our knowledge, we are the first to present a fully convergent multigrid solver for the two-dimensional indefinite nonsymmetric Helmholtz equation using classical multigrid components for elliptic problems (V- and W-cycle hierarchy, damped Jacobi smoothing and no restriction on the (coarsest) levels. \u201a We provide a novel generalized proof to assess two-grid convergence for any (highly) indefinite system. Our proof is not limited to the Helmholtz equation and does not require the calculation of eigenvalues. \u201a The novelty in our theory also lies in the fact that we do not require assumptions on normality of the operator. \u201a For Helmholtz problems in particular, we provide a optimality condition which can easily be verified without computing eigenvalues. \u201a The results are robust to large wavenumbers and non-constant wavenumbers representing high-contrast heterogeneities. In particular, we show that the use of coarsening on the CSL combined with a higher-order prolongation and restriction operator leads to a convergent scheme, even when using the classical divergent weighted-Jacobi smoother.\nSeveral remarks are in place. First of all, in this work we solely consider getting a convergent solver rather than a solver with wavenumber independent convergence. This is a topic for future research due to the sheer difficulty in getting a convergent stand-alone multigrid solver in the first place. Second of all, given that multi-\ngrid generally already diverges for one-dimensional Helmholtz problems with small wavenumbers, this research will, in accordance with the literature, focus on one- and two-dimensional model problems. The study of three-dimensional problems is a topic for future research as it requires a thorough understanding of the convergence behavior in one- and two-dimensions first.\nThe structure of this paper is as follows. In section 2 we introduce the model problems which will be the focus of this work. In section 3 we give an introduction to the multigrid scheme and its parameters, to continue with the analysis of the convergence of multigrid methods for Helmholtz problems in section 4. Numerical experiments are presented in section 5. Our conclusions are summarized in section 6.\n2. Problem Description. We continue by defining the model problems which will be studied in this paper. We focus on the 2D constant wavenumber model using k \u0105 0, which we call MP 2-A.\n\u00b4\u2206upx, yq \u00b4 k2upx, yqupx, yq \u201c \u03b4px \u00b4 1 2 , y \u00b4 1 2 q, px, yq P \u2126 \u201c r0, 1s2,\n\u02c6\nB Bn \u00b4 ik\n\u02d9\nupx, yq \u201c 0, px, yq P B\u2126.\nThe final test problem uses a non-constant wavenumber kpx, yq. This gives us MP 2-B as defined below\n\u00b4\u2206upx, yq \u00b4 kpx, yq2upx, yqupx, yq \u201c \u03b4px \u00b4 1 2 , y \u00b4 1 2 q, px, yq P \u2126 \u201c r0, 1s2,\n\u02c6\nB Bn \u00b4 ikpx, yq\n\u02d9\nupx, yq \u201c 0, px, yq P B\u2126,\nwhere \u03c7px, yq is a random real function in the range of r0, 1s and k1, k2 are positive real numbers. Note that in this case k varies exactly between k1 and k2. We use second-order finite differences to discretize the model problems and define the stepsize h \u201c 1n , where n is chosen such that for each k1, k2 we have kh \u201c 0.625. This is equivalent to having 10 grid points per wavelength.\n3. Multigrid Methods. Multigrid method as a stand-alone solver combines two ingredients in a recursive way: a coarse grid correction and a smoother. If we let P and P 1 denote the matrix variant of the prolongation and restriction operators, then we define the coarse grid correction matrix CGC as"
        },
        {
            "heading": "CGC \u201c I \u00b4 P 1Ac\u00b41PA, Ac \u201c PAP 1.",
            "text": "Note that we here denote the coarse grid version of A by Ac instead of AH as the matrix A is now complex due to the Sommerfeld boundary conditions and we reserve the H\u00b4script to denote the conjugate transpose.\nAs for the smoother, we work with the standard weighted-Jacobi smoother, which is defined as\nSJAC \u201c I \u00b4 X\u00b41A, X \u201c \u03c9\u039bA,\nwhere \u039bA denotes the matrix containing the diagonal elements of our matrix A. In general, for symmetric elliptic problems such as the Poisson equation, the optimal relaxation parameter is set at \u03c9 \u201c 32 . For the indefinite nonsymmetric Helmholtz problem, more tailored values of relaxation parameters should be used, especially outside the context of using multigrid as a preconditioner [18, 21].\nTo develop the theory, we start with the assumption that we are only using a post-smoother. In this case, the two-grid iteration matrix is given by\nT0 \u201c ` I \u00b4 P 1Ac\u00b41PA \u02d8 ` I \u00b4 X\u00b41A \u02d8 .(3.1)\nGenerally the multigrid iteration scheme converges if the spectral radius of the two-grid iteration matrix is less than 1. Thus, the straightforward way to prove convergence is by showing that the spectral radius of the two-grid iteration matrix is strictly less than zero. If Dirichlet conditions are used, this naturally boils down to using Rigorous Fourier Analysis (RFA) to find analytical expressions for the eigenvalues of T0. However, once we use Sommerfeld boundary conditions, this is no longer an option and we have to find another way to assess the boundedness of the spectral radius, which will be the focus of the next section, where we develop a general theoretical framework to assess the convergence, irrespective of the boundary conditions used.\n3.1. Convergence. For convergence of the two-grid method we require that }T0}2 \u0103 1 independent of h. We can write T0 as T0 \u201c I \u00b4 DA, where D represents an approximation to A\u00b41. This is shown in Lemma 3.1. We use this to show that if the two-grid operator T0 can be written in this form and the two-norm is bounded by one, then the multigrid method will converge.\nLemma 3.1. Convergence - I Let A P Cn\u02c6n be a non-singular and non-defective matrix, and let the two-grid operator be given by T0 \u201c ` I \u00b4 P 1Ac\u00b41PA \u02d8 ` I \u00b4 X\u00b41A \u02d8\n. Then, T0 can be written as T0 \u201c I \u00b4 DA, with\nD \u201c X\u00b41 ` P 1Ac\u00b41P \u00b4 P 1Ac\u00b41PX\u00b41(3.2)\nMoreover we have T0 H \u201c I \u00b4 AHDH .\nProof. Expanding T0, and factoring in terms of A we have\nT0 \u201c I \u00b4 X\u00b41A \u00b4 P 1Ac\u00b41PA ` P 1Ac\u00b41PX\u00b41A,(3.3) \u201c I \u00b4 ` X\u00b41 ` P 1Ac\u00b41P \u00b4 P 1Ac\u00b41PX\u00b41 \u02d8 A,(3.4) \u201c I \u00b4 DA,(3.5)\nwhere D \u201c X\u00b41 ` P 1Ac\u00b41P \u00b4 P 1Ac\u00b41PX\u00b41. We similarly obtain\nT0 H \u201c\n`` I \u00b4 P 1Ac\u00b41PA \u02d8 ` I \u00b4 X\u00b41A \u02d8\u02d8H ,(3.6)\n\u201c ` I \u00b4 X\u00b41A \u02d8H` I \u00b4 P 1Ac\u00b41PA \u02d8H ,(3.7)\n\u201c ` I \u00b4 AHX\u00b41 \u02d8\n\u00b4\nI \u00b4 AHP 1 ` Ac H \u02d8\u00b41 P \u00af ,(3.8)\n\u201c I \u00b4 AHX\u00b41 \u00b4 AHP 1 ` Ac H \u02d8\u00b41 P ` AHX\u00b41AHP 1 ` Ac H \u02d8\u00b41 P,(3.9)\n\u201c I \u00b4 AH \u00b4 X\u00b41 ` P 1 ` Ac H \u02d8\u00b41 P \u00b4 X\u00b41AHP 1 ` Ac H \u02d8\u00b41 P \u00af ,(3.10)\n\u201c I \u00b4 AHDH ,(3.11)\nwhere DH \u201c X\u00b41 ` P 1 ` Ac H \u02d8\u00b41 P \u00b4 X\u00b41P 1 ` Ac H \u02d8\u00b41 P .\nIt has been shown that convergence of the two-grid operator implies multigrid convergence, see [20]. The proof is based on an induction argument, where for the\nW\u00b4cycle, it is shown that the multigrid iteration matrix can be written as the twogrid iteration matrix plus a perturbation term. The perturbation term is bounded if the prolongation operator is a bounded linear operator and the smoother can be bounded by a constant. Note that a convergent smoothing scheme is not required. In fact, the smoothing property also holds for non-convergent iterations [20]. It is only required that the error is smoothed up to a certain \u03bd, where \u03bd is the number of smoothing steps. In other words, there exists a \u03bd such that the error is reduced. It is not imperative that the smoothing property holds for \u03bd \u201c 8. We now work towards conditions for which }T0}2 \u0103 1 holds.\nTheorem 3.2 (Hermitian Positive Definiteness (HPD) implies Convergence). Let A P Cn\u02c6n be a non-singular and non-defective matrix. Let the two-grid operator be given by T0 \u201c ` I \u00b4 P 1Ac\u00b41PA \u02d8 ` I \u00b4 X\u00b41A \u02d8\n, where X is the \u03c9\u00b4Jacobi smoother, P, P 1 P Rn\u02c6m are the prolongation and restriction operator and Ac \u201c P 1AP . Let\n\u0393 \u201c AHDH ` DA \u00b4 AHDHDA,(3.12)\nthen T0 HT0 \u201c I \u00b4 \u0393. If \u0393 is positive definite, then \u03bbj p\u0393q P p0, 2q and }T0}2 \u0103 1 independent of h.\nProof. Using equation Lemma 3.1, equation (3.5) and (3.11), we can write\nT0 HT0 \u201c\n` I \u00b4 AHDH \u02d8 pI \u00b4 DAq ,(3.13) \u201c I \u00b4 ` DA ` AHDH \u00b4 AHDHDA \u02d8 ,(3.14)\n\u201c I \u00b4 \u0393.(3.15)\nWe can show a stronger result than just positive definiteness since \u0393 is also Hermitian. To see this, note\n\u0393H \u201c ` AHDH ` DA \u00b4 AHDHDA \u02d8H ,(3.16)\n\u201c ` DA ` AHDH \u02d8H \u00b4 ` AHDHDA \u02d8H ,(3.17)\n\u201c pDAqH ` ` AHDH \u02d8H \u00b4 ` AHDHDA \u02d8H ,(3.18)\n\u201c AHDH ` DA \u00b4 AHDHDA \u201c \u0393.(3.19)\nGiven that \u0393 is HPD, the singular value decomposition (SVD) and eigendecomposition coincide, so we can find a unitary matrix U P Cn\u02c6n such that \u0393 \u201c U\u03a3\u0393UH , where \u03a3 is the diagonal matrix containing the singular resp. eigenvalues p\u03c3jq, where we have \u03c31 \u011b \u03c32 \u011b \u03c33 . . . \u011b \u03c3n \u0105 0. We have\n\u0393 \u201c AHDH ` DA \u00b4 AHDHDA,(3.20)\nwhich is equivalent to\n\u03a3\u0393 \u201c UAHDHUH ` UDAUH \u00b4 UAHDHDAUH .(3.21)\nBy our assumption on \u0393 being positive definite, we have that for all x P Cnzt0u,\n0 \u0103 xH\u0393x \u00f4 0 \u0103 xHAHDHx ` xHDAx \u00b4 xHAHDHDAx.(3.22)\nSimilarly, by using (3.21), for all x P Cnzt0u,\n0 \u0103 xH\u03a3\u0393x \u00f4 0 \u0103 xHUAHDHUHx ` xHUDAUHx \u00b4 xHUAHDHDAUHx,(3.23) \u00f4 0 \u0103 xHUAHDHDAUHx \u0103 xHUAHDHUHx ` xHUDAUHx.(3.24)\nUsing the unitary invariance of the SVD, (3.24) leads to\n0 \u0103 xHUAHDHDAUHx \u0103 xHUAHDHUHx ` xHUDAUHx,(3.25) \u00f1 0 \u0103 \u03c3jpDAq2 \u0103 \u03c3jpAHDH ` DAq \u010f 2\u03c3jpDAq,(3.26) \u00f1 \u03c3jpDAq \u0103 2.(3.27)\nThis gives an upperbound for \u03c3jpDAq. We now develop the upper bound for the largest singular value of \u0393, which is denoted by \u03c31p\u0393q. We know that 0 \u010f \u03c3jpDAq \u0103 2. The case where 0 \u010f \u03c3jpDAq \u0103 1 is trivial as that automatically renders }T0}2 \u0103 1. We focus on the case where 1 \u010f \u03c3jpDAq \u0103 2. Recall, we assumed \u0393 is HPD, but DA does not necessarily have to be. As a result, the singular value decomposition for \u0393 with unitary matrix U might not coincide with the singular value decomposition for DA.\nSuppose, we can write DA as DA \u201c W\u0393DAV H , where WV H \u2030 I. We then still have\nAHDHDA \u201c V \u0393DAHWHW\u0393DAV H ,(3.28) V HAHDHDAV \u201c \u0393DAH\u0393DA \u201c p\u0393DAq2.(3.29)\nMoreover, we also have for vj P V\nDAvj \u201c \u03c3jpDAqwj and(3.30) pDAvjqH \u201c vjHAHDH \u201c wjH\u03c3jpDAq.(3.31)\nFor WV H \u2030 I we will always have that for some index j and vj P V and wj P W\nvj Hwj ` wjHvj \u0103 2,(3.32)\nwhere we used that the complex parts cancel out. We therefore have\nvHDAv ` vHAHDHv \u201c vjH\u03c3jpDAqwj ` wjH\u03c3jpDAqvj \u0103 2\u03c3jpDAq.(3.33)\nTaking x \u201c vj in (3.22) and using (3.33), xH\u0393x can be bounded by\n0 \u0103 vjH\u0393vj \u201c vjHAHDHvj ` vjHDAvj \u00b4 vjHAHDHDAvj ,(3.34) \u201c \u03c3jpDAq ` vj Hwj ` wjHvj \u02d8\n\u00b4 \u03c3jpDAq2,(3.35) \u0103 2\u03c3jpDAq \u00b4 \u03c3jpDAq2 \u201c \u03c3jpDAq p2 \u00b4 \u03c3jpDAqq ,(3.36) \u0103 \u03c3jpDAq \u0103 2.(3.37)\nAs \u0393 is positive definite, the eigenvalues and singular values coincide and we have\n\u03bbminp\u0393q \u0105 0 and \u03bbmaxp\u0393q \u0103 2.(3.38)\nWe are now ready to bound the two-grid operator T0 using the 2-norm over Cn\u02c6n\n}T0}2 \u201c sup xPCn,}x}2\u201c1 } ` T0 HT0 \u02d8\nx}2 \u201c b \u03c1 ` T0 HT0 \u02d8 ,\n\u201c b \u03c1 pI \u00b4 pAHDH ` DA \u00b4 AHDHDAqq,(3.39)\n\u201c c\nmax 1\u010fj\u010fn\n|\u03bbj pI \u00b4 pAHDH ` DA \u00b4 AHDHDAqq |,(3.40)\n\u010f c\n|1 \u00b4 min 1\u010fj\u010fn \u03bbj pAHDH ` DA \u00b4 AHDHDAq |,(3.41)\n\u0103 1,\nwhere we used that trivially 0 \u0103 min\u03bbj ` AHDH ` DA \u00b4 AHDHDA \u02d8\nby positive definiteness of \u0393. As regards, the largest eigenvalue max\u03bbj p\u0393q \u0103 2, we obtain\n}T0}2 \u201c sup xPCn,}x}2\u201c1 } ` T0 HT0 \u02d8\nx}2 \u201c b \u03c1 ` T0 HT0 \u02d8 ,\n\u201c b \u03c1 pI \u00b4 pAHDH ` DA \u00b4 AHDHDAqq,(3.42)\n\u201c c\nmax 1\u010fj\u010fn\n|\u03bbj pI \u00b4 pAHDH ` DA \u00b4 AHDHDAqq |,(3.43)\n\u010f c\n|1 \u00b4 max 1\u010fj\u010fn \u03bbj pAHDH ` DA \u00b4 AHDHDAq |,(3.44)\n\u0103 a |1 \u00b4 2| \u201c 1, using (3.38).(3.45)\nThus, if \u0393 is positive definite then \u03bbjp\u0393q P p0, 2q and consequently \u03bbjpT0q P p0, 1q.\nTheorem 3.2 shows that if \u0393 is positive definite, then the eigenvalues of T0 will lie in the interval p0, 1q which automatically leads to a bound for the 2-norm of the two-grid operator. Note that this is independent of h, as no constant appears in (3.38) which depends on h. Now that we know that a sufficient conditions for convergence is to have \u0393 be positive definite, we need a way to practically assess this. One approach is by simplifying the expression for \u0393 and finding another sufficient condition for positive definiteness, which is more easy to analyze. This will be constructed in Corollary 3.4. We again start by defining the simplified operator in Definition 3.3.\nDefinition 3.3 (Simplified operator). Let A P Cn\u02c6n be a non-singular and nondefective matrix. P, P 1 P Rn\u02c6m are real valued prolongation and restriction operators and Ac \u201c P 1AP . The \u03c9\u00b4Jacobi smoother is given by X \u201c \u03c9\u039bA, where \u039b denotes the diagonal matrix containing the diagonal entries of A. Then we define D\u0303 \u201c X\u00b41 ` P 1Ac \u00b41P such that \u0393\u0303 \u201c AHD\u0303H ` D\u0303A \u00b4 AHD\u0303HD\u0303A.\nNote that in the definition given above, D\u0303 does not contain the term P 1Ac \u00b41PX\u00b41A, which is part of the original operator D.\nCorollary 3.4. Convergence - II Let A P Cn\u02c6n be a non-singular and nondefective matrix. Let \u0393\u0303 be defined as in Definition 3.3. If \u0393\u0303 is positive definite, then \u0393 from Theorem 3.2 is positive definite.\nProof. To see this, we write \u0393 as\n\u0393 \u201c AHDH ` DA \u00b4 AHDHDA,(3.46)\n\u201c \u00b4 AHD\u0303H ` D\u0303A \u00b4 AHD\u0303HD\u0303A \u00af ` AHX\u00b41P 1 ` Ac H \u02d8\u00b41 PP 1Ac \u00b41PX\u00b41A(3.47)\n\u00b4 AHD\u0303HP 1Ac\u00b41PX\u00b41A \u00b4 AHX\u00b41P 1 ` Ac H \u02d8\u00b41 PD\u0303A.(3.48)\nWe assume \u0393\u0303 is positive definite and HPD respectively. Now, assuming the opposite, i.e. \u0393 is not HPD implies that Dx P Cnz t0u such that\nxH \u0393\u0303x ` xHAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PP 1Ac \u00b41PX\u00b41Ax p\u02daq\n\u00b4 xHAHD\u0303HP 1Ac\u00b41PX\u00b41Ax \u00b4 xHAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PD\u0303Ax \u010f 0. p\u02da\u02daq\nBy assumption and the fact that the second term in p\u02daq contains a quadratic form, p\u02daq is always positive for any x P Cnz t0u. But if \u0393 is not positive definite then using p\u02da\u02daq we must also have\n0 \u0103 xH \u0393\u0303x ` xHAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PP 1Ac \u00b41PX\u00b41Ax,(3.49)\n\u010f xHAHD\u0303HP 1Ac\u00b41PX\u00b41Ax ` xHAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PD\u0303Ax(3.50)\nWe show that P 1Ac \u00b41PX\u00b41A has singular values equal to zero. Observe that the rank of P 1Ac \u00b41PX\u00b41A is n2 . Suppose we can write the singular value decomposition as \u0393\u0302 \u201c WH ` P 1Ac \u00b41PX\u00b41A \u02d8 V . In this case we have V and W to represent two unitary complex matrices as we have not assumed that P 1Ac \u00b41PX\u00b41A is HPD. We know that P 1Ac \u00b41P is singular and half of all singular values are equal to zero. We thus need to show that P 1Ac \u00b41PX\u00b41A has zero singular values as well. In order to do this, we use an analogous version of Ostrowski\u2019s theorem. Here instead of using eigenvalues, we use singular values. According to the theorem, for K P Cn\u02c6n and Y P Cn\u02c6n with Y is non-singular, we have\n\u03c3jpKY q \u010f \u03c31pY q\u03c3jpAq, j \u201c 1, 2, . . . n,(3.51)\nwhere \u03c31 \u011b \u03c32 \u011b . . . \u03c3n. Applying (3.51) to our case by taking K \u201c P 1Ac\u00b41P and Y \u201c X\u00b41A, we obtain\n\u03c3j ` P 1Ac \u00b41PX\u00b41A \u02d8 \u010f \u03c31pX\u00b41Aq\u03c3jpP 1Ac\u00b41P q, j \u201c 1, 2, . . . n.(3.52)\nWe know that \u03c31pX\u00b41Aq \u0105 0 given that both X and A are non-singular. However, we know that P 1Ac\n\u00b41P is singular and has zero singular values. Thus there exists indices j\u0303 such that\n\u03c3j\u0303 ` P 1Ac \u00b41PX\u00b41A \u02d8 \u010f 0, j\u0303 P t1, 2, . . . nu.(3.53)\nTrivially 0 \u010f \u03c3j\u0303 ` P 1Ac \u00b41PX\u00b41A \u02d8\nis a lower bound for the smallest singular value. Combining this with (3.53) leads to\n0 \u010f \u03c3j\u0303 ` P 1Ac \u00b41PX\u00b41A \u02d8 \u010f 0, Dj\u0303 P t1, 2, . . . nu,(3.54)\nand so by the interlacing theorem, we must have that there exist at least one singular value at an index j\u0303 such that \u03c3j\u0303 ` P 1Ac \u00b41PX\u00b41A \u02d8 \u201c 0. Naturally, the eigenvalue\nof P 1Ac \u00b41PX\u00b41A corresponding to the index j\u0303 must be zero as well, given that the singular value is zero. We know that for any complex matrix, there exists a unitary matrix such that we can write it in the Schur decomposition. Without the assumption of normality, it solves a general eigenvalue problem of the form Kv \u201c \u03bbBv for some matrix B.\nWe take x \u201c vj\u0303 , corresponding to the zero eigenvalue, which we denote by \u03bb0j\u0303 such that\nP 1Ac \u00b41PX\u00b41Avj\u0303 \u201c \u03bbj\u0303pP 1Ac \u00b41PX\u00b41AqBvj\u0303 \u201c 0Bvj\u0303 .(3.55)\nSubstituting (3.55) into (3.50) gives\n0 \u0103 vj\u0303 H \u0393\u0303vj\u0303 ` vj\u0303 HAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PP 1Ac \u00b41PX\u00b41Avj\u0303 ,(3.56)\n\u010f vj\u0303 HAHD\u0303HP 1Ac \u00b41PX\u00b41Avj\u0303 ` vj\u0303 HAHX\u00b41P 1 ` Ac H \u02d8\u00b41 PD\u0303Avj\u0303 ,(3.57)\n\u201c \u03bb0 j\u0303 vj\u0303 HAHD\u0303HBvj\u0303 ` \u03bb 0 j\u0303 vj\u0303 HBHD\u0303Avj\u0303 \u201c 0.(3.58)\nThis gives a contradiction as \u0393\u0303 is assumed to be positive definite and must always be larger than zero for any x P Cnz t0u. We thus have that if \u0393\u0303 is positive definite, then xH\u0393x \u0105 0 @x P Cnz t0u, i.e. \u0393 must be positive definite as well.\nUsing the above, we now have that it is sufficient to check if \u0393\u0303 is positive definite. We therefore test for convergence by verifying whether \u0393\u0303 is positive definite. We use the Cholesky decomposition to determine whether \u0393\u0303 is positive definite, as any HPD system matrix B can be written as B \u201c LL\u02da, where L P Cn\u02c6n is a lower-triangular matrix. Another method to check for positive definiteness without having to compute the Cholesky factors is by checking all of the following\n1. bii \u0105 0@i 2. bii ` bjj \u0105 2 |\u211c rbijs| for i \u2030 j 3. The element with the largest modulus lies on the diagonal 4. detpBq \u0105 0\nThe results from this section show that if we have an HPD \u0393 matrix, then the two-grid method converges. This can also be tested for a simplified operator \u0393\u0303. Note that so far, all theoretical considerations are for general matrices. Next, we will apply this theory to the Helmholtz operator.\n4. Convergence for indefinite nonsymmetric Helmholtz operators. The previous section has stipulated properties which we can check in order to find a convergent configuration for the indefinite nonsymmetric Helmholtz equation. For this we need to consider optimality conditions for the smoother and coarse grid correction scheme.\nStarting with the smoother, we will the use classical \u03c9\u00b4Jacobi smoother due to its natural parallelizability. Even though the smoother diverges for Helmholtz problems, we will show that combined with CSL-coarsening and higher-order prolongation and restriction, the \u0393\u0303 and consequently \u0393 operator becomes HPD, leading to a convergent solver on a complete V-cycle hiearchy. In the remainder of this paper, unless stated otherwise, we will use aggregate values from the literature presented for the two-step Jacobi as our \u03c9 in the weighted-Jacobi method, which boils down to keeping \u03c9 \u201c 4.5. Our own experimental results in subsection 4.2 are in line with the aggregate values from the literature, confirming relaxation parameters which are generally lower than the underrelaxation parameters reported for symmetric elliptic problems, such as Poisson\u2019s equation.\nWe proceed by evaluating these properties for the Helmholtz operator. We use MP2-A with constant wavenumber k. We numerically investigate the changes we can make to the design of the coarse-grid system in order to achieve convergence. In this work, we consider two options; we either use higher-order interpolation schemes to construct the prolongation and restriction operator and/or we use the CSL, which will be denoted by C, as the system on which we apply the coarsening operations. We use the higher-order interpolation scheme based on the quadratic rational Bezie\u0301r curve from [11, 12]. There, the scheme was used to construct the deflation vectors for a two-level and multi-level deflation preconditioner, which showed wavenumber independent convergence for the two-level scheme and close to wavenumber independent convergence for the multi-level scheme. The main motivation for studying these type of higher-order schemes is that they have been shown to reduce the projection error [11]. Using this scheme, the prolongation operator acts on a grid function as follows\n(4.1) P ru2hsi \u201c\n$\n&\n%\n1 8\n\u00b4 ru2hspi\u00b42q{2 ` 6 ru2hspiq{2 ` ru2hspi`2q{2 \u00af if i is even,\n1 2\n\u00b4 ru2hspi\u00b41q{2 ` ru2hspi`1q{2 \u00af\nif i is odd,\n,\n.\n-\n,\nfor i \u201c 1, . . . , N and for i \u201c 1, . . . , N2 , where N denotes the size of the fine-level linear system. Note that the second line (i = odd) is in fact the linear interpolation scheme. Thus, we now have a combination of both a higher-order and linear interpolation scheme for the nodes i within the numerical domain.\nThe inclusion of the complex shift was first applied to multigrid schemes in [10]. There, the main motivation relies on spectral analysis of the two-grid operator and the observation that the coarse-grid eigenvalues can never approach zero due to the complex part. We proceed by a different yet general theoretical argument, which is independent of the boundary conditions. Moreover, we include a constant complex shift compared to a level-dependent one and also evaluate the effect of a classic smoother compared to the polynomial GMRES(3) smoother.\nIn Table 1, we show that the use of the CSL in combination with a higher-order interpolation scheme in fact leads to an HPD system. Note that while our conditions do not require the actual computation of the spectral norm, we will do so for sake of illustration and completeness.\nSeveral interesting observations can be made. First of all, in almost call cases when using the classical smoothing operator, a combination of both higher-order interpolation and CSL for coarsening is needed to obtain an HPD matrix and consequently a spectral norm which is bounded by one. Thus, using either level independent CSLcoarsening or higher-order prolongatrion and restriction, will not solve the problem.\n4.1. Optimality. Apart from having a condition to check for convergence, we would like to have a measure of how fast we can expect the two-grid method to converge. By having a positive definite \u0393, we know that the spectral norm is bounded from above by one. To obtain a more qualitative estimate, we study the condition number of \u0393 and \u0393\u0303. Using the condition numbers we obtain a sharper bound in Theorem 3.2. This entails that the smallest eigenvalue of \u0393\u0303 will be a lower bound to the smallest eigenvalue of \u0393.\nCorollary 4.1. Convergence Optimality Condition - I Let A P Cn\u02c6n be a nonsingular and non-defective matrix and let D\u0303 \u201c X\u00b41 ` P 1Ac\u00b41P . If \u0393\u0303 \u201c AHD\u0303H ` D\u0303A \u00b4 AHDHDA is positive definite and }\u0393} \u010f }\u0393\u0303} together with \u03bap\u0393\u0303q \u010f \u03bap\u0393q then \u03bbminp\u0393\u0303q is given and bounded by\n}\u0393\u0303} \u03bap\u0393\u0303q \u010f \u03bbminp\u0393q.(4.2)\nProof. Note that \u0393\u0303 and \u0393 are HPD and so all eigenvalues are real, so we can consider }\u0393\u00b41} and }\u0393\u0303\u00b41}. Moreover, @ matrices B P Cn\u02c6n, \u03c1pBq \u201c max1\u010fj\u010fn |\u03bbjpBq| \u010f }B} in any associative norm. If \u03bap\u0393\u0303q \u010f \u03bap\u0393q, then we obtain\n}\u0393} \u010f }\u0393\u0303} \u00f1 1 }\u0393\u0303} \u010f 1}\u0393} \u00f1 \u03bap\u0393\u0303q }\u0393\u0303} \u010f \u03bap\u0393q}\u0393} \u00f1 }\u0393\u0303 \u00b41} \u010f }\u0393\u00b41}.(4.3)\nUsing that the systems are HPD, we have\n\u03c1p\u0393\u00b41q \u201c max 1\u010fj\u010fn |\u03bbjp\u0393\u00b41q| \u201c min 1\u010fj\u010fn |\u03bbjp\u0393q|\u00b41 \u010f }\u0393\u00b41}.(4.4)\nNote that this gives the reciprocal of the smallest eigenvalue of \u0393. To get the actual smallest eigenvalue of \u0393, we have to take the reciprocal, which provides us with inequality (4.2) and a lower bound to \u03bbminp\u0393q.\nWe can use Corollary 4.1 to construct a sharper bound in Theorem 3.2.\nCorollary 4.2. Convergence Optimality Condition - II Let A P Cn\u02c6n be a nonsingular and non-defective indefinite matrix. Let T0 be such that we can write T0 as T0 \u201c I \u00b4 DA with D \u201c X\u00b41 ` P 1Ac\u00b41P \u00b4 P 1Ac\u00b41PX\u00b41. Let \u0393 \u201c AHDH ` DA \u00b4 AHDHDA. If \u0393\u0303 \u201c AHD\u0303H ` D\u0303A\u00b4AHD\u0303HD\u0303A with D\u0303 \u201c X\u00b41 `P 1Ac\u00b41P , is positive definite and }\u0393\u0303} \u010f }\u0393} together with \u03bap\u0393q \u010f \u03bap\u0393\u0303q, then\n}T0}2 \u0103\ng f f e \u02c7 \u02c7 \u02c7\n\u02c7 \u02c7 1 \u00b4 }\u0393\u0303} \u03bap\u0393\u0303q\n\u02c7 \u02c7 \u02c7 \u02c7 \u02c7 \u0103 1.\nProof. Using Theorem 3.2 we can write T0 HT0 \u201c I \u00b4 \u0393. Using (3.41) from\nTheorem 3.2 and substituting (4.2) from Corollary 4.2 have\n}T0}2 \u201c sup xPCn,}x}2\u201c1 } ` T0 HT0 \u02d8\nx}2 \u201c b \u03c1 ` T0 HT0 \u02d8 ,\n\u201c b |1 \u00b4 min\u03bbj p\u0393q |,(4.5)\n\u0103 c |1 \u00b4 min\u03bbj \u00b4 \u0393\u0303 \u00af |,(4.6)\n\u0103\ng f f e \u02c7 \u02c7 \u02c7\n\u02c7 \u02c7 1 \u00b4 }\u0393\u0303} \u03bap\u0393\u0303q\n\u02c7 \u02c7 \u02c7 \u02c7 \u02c7 \u0103 1.(4.7)\n4.2. Optimal convergence for Helmholtz. From section 4, we have observed that we need a clever combination of coarsening using the CSL, higher-order interpolation schemes and the right amount of smoothing steps in order to obtain HPD systems. The results from Table 1, however, indicate that convergence, in terms of total number of iterations, will be slow as the spectral norm is still close to one.\nThe results from Table 2 reveal that a lower \u03c9 is in favor when we use one post-smoothing steps and the wavenumber is small. For \u03c9 \u201c 1.5, we observe that increasing k and \u03bd leads to an decrease in }\u0393\u0303}\u03bap\u0393\u0303q\u00b41. This means that as we perform more smoothing steps, the two-grid spectral norm moves closer and closer to one. For convergence, we require the opposite: the addition of a few more smoothing steps should lead to an increase rather than a decrease in }\u0393\u0303}\u03bap\u0393\u0303q\u00b41. Based on these results, the optimal estimate for \u03c9 lies between r2, 4.5s for the reported values of k. These values are different from the general consensus on the optimal relaxation parameter for poisson-type of problems. While we focus on the classical smoother in this work, our reported values do seem to coincide with underrelaxation parameters observed in other studies where a two-step weighted Jacobi smoother is analyzed [21, 18]\n5. Numerical Experiments. In this section we examine the convergence behavior of the multigrid solver. We use the model problems from section 2. Unless stated otherwise, we use 10 grid points per wavelength, which is equivalent to kh \u201c 0.625. All experiments are implemented sequentially on a Dell laptop using 8GB RAM and a i7-8665U processor. In all experiments, we set the relative tolerance to 10\u00b45. We allow for coarsening until the dimension of the underlying linear system Nc is smaller than 10. The maximum size of the linear system on the coarsest grid is therefore 10 \u02c6 10. We use the \u03c9\u00b4Jacobi smoother with the approximate optimal relaxation parameter from subsection 4.2, i.e. \u03c9 \u201c 4.5 as we want to test for large k.\nMoreover, we perform the coarse-grid corrections using the higher-order prolongation and restriction operator, together with the CSL. For the latter, the complex shift is set at \u03b22 \u201c 0.7 unless stated otherwise.\n5.1. 2D Constant k. For the constant wavenumber problem (MP 2-A), we first start by confirming that we have h\u00b4independent convergence. Recall that the constant from Theorem 3.2 does not depend on h, which for the proposed setup should lead to h\u00b4independent convergence. Thus, while the convergence bounds can be shown to be independent of h, the practical convergence speed may still depend on h.\n5.1.1. h\u00b4independence. We report the results for various k using h \u201c 2\u00b4p, with p \u201c 5 up to p \u201c 9. We observe that the solver indeed performs independently of\nh. In fact, it appears that with 4 smoothing steps, the solver converges in about C\u0303k iterations, where C\u0303 \u00ab 1 is a constant. The latter holds irrespective of the problem size.\n5.1.2. General results. Now that we have established, both theoretically and numerically, that the convergence is h\u00b4independent once we take 4 smoothing steps, we revert back to letting kh \u201c 0.625. Note that in order to obtain improved accuracy, kh can be decreased without affecting the convergence behavior due to the h\u00b4independence. In Table 4 we report the results for MP 2-A using a constant wavenumber and Sommerfeld boundary conditions. From Table 4 we observe that for the V-cycle the convergence improves if we use more smoothing steps. Note that these additional smoothing steps are computationally cheap, as we use the \u03c9\u00b4Jacobi smoother. In general, we observe that we again need approximately C\u0303k iterations with C\u0303 \u00ab 1, in order to reach convergence. While the convergence behavior is promising, the results do provide some further insights into the behavior of the smoother. For example, we observe that moving from a V-cycle to a W-cycle does not seem to improve the performance. In fact, we observe that we need more iterations instead of less. One potential explanation could be that we know that in general the \u03c9\u00b4Jacobi smoother diverges for Helmholtz-type of problems. While this in itself does not have to lead to divergence (the smoothing property is still satisfied for a divergent smoother, see [20]), the use of the W-cycle requires more smoothing iterations than the V-cycle. At some point we expect the efficiency of these smoothing steps to reduce, which could be reflected in the higher number of iterations.\n5.2. 2D results non-constant kpx, yq. In this subsection we report on the numerical results for the non-constant wavenumber model problem. We distinguish two cases; a medium-varying and a highly-varying wavenumber profile problem. In this respect the profile contains either smooth or sharp changes between a range of wavenumbers. For an illustration of the wavenumber profile, see Figure 2 for the smooth changing wavenumber profile and Figure 3 for the profile where the wavenumber changes sharply. In all cases we make sure that the largest value of kpx, yq still obeys the rule of thumb kh \u00ab 0.625.\n5.2.1. Smooth Changes. Figure 2 illustrates how the wavenumber varies between 10 and 75 for the medium-varying problem. Note that the transition from a low to high wavenumber goes gradually.\nTable 5 contains the number of V-cycles needed to reach convergence for kpx, yq varying between p10, 50q and p10, 75q respectively. We again observe that the number of iterations scales linearly with k. The iteration count follows approximately C\u0303k, with C\u0303 \u00ab 1, where k in this case denotes the largest wavenumber. In this event, the W-cycle does lead to a smaller number of iterations, compared to the case where we have a constant wavenumber.\n5.2.2. Sharp Changes. In this subsection we report on the results for the highly-varying profile model problem, containing sharp changes between the wavenumbers k \u201c 10 and k \u201c 75. Figure 3 illustrates how the wavenumber varies between 10 and 75 for the medium-varying problem. In this case, we let kpx, yq vary randomly, which gives a wavenumber which varies highly across the entire numerical domain.\nTable 6 contains the number of V-cycles needed to reach convergence for kpx, yq varying between p10, 50q and p10, 75q respectively. We immediately observe that the number of iterations goes up by a factor of approximately 1.5 once we allow for the sharp and rapid changes in the wavenumber. For example for the medium-varying case containing more smooth transition between the wavenumbers, using 8 smoothing steps, we had 59 and 57 iterations respectively for the V- and W-cycle. In this case, we have 94 iterations for both the V- and W-cycle. Another interesting observation is that for the W-cycle, kpx, yq varying between 10 and 75 leads to a larger number of iterations when \u03bd \u0105 4. This could again be an indication of the smoother losing some of its efficacy when we allow for more smoothing operations using the W-cycle. Also for this model problem, we conclude that as the wavenumber grows, the V-cycle is preferred over the W-cycle for this choice of smoothing scheme. In the reported cases, the method converges in approximately 1.5k iterations, where k is the largest admissible wavenumber.\n5.3. GMRES-smoothing. In this section we explore how the solver performs when we use GMRES(3) smoothing. In [10], where the authors propose coarsening on the CSL instead of the original Helmholtz operator, GMRES(3) is used as the only smoother. The motivation for this lies in the fact that indeed the \u03c9\u00b4Jacobi diverges when combined with the original and standard configuration of the multigrid method. By using a few GMRES iterations, the smoother acts as a polynomial smoother.\nAlready in [13], the use of GMRES(3) was proposed as a smoother. There, the authors manually optimized the smoothing schedule, where the number of smoothing steps ranges between 13 and 39 smoothing steps for a constant k ranging from 4\u03c0 to 32\u03c0. More generally in the literature, on each level where the Jacobi smoother becomes unstable, the smoother is replaced by the Krylov iterations ranging between 5-40 iterations per smoothing step [13, 6, 7]. In this work we let the number of smoothing steps using GMRES(3) vary between 1 and 5. One advantage of this approach is that by allowing for only 3 GMRES iterations per smoothing step, the cost of applying GMRES does not increase significantly with respect to memory and computation time. We perform the same numerical experiments using the model problems mentioned previously.\n5.3.1. 2D results constant k. In this subsection we report the results for the constant wavenumber model problem (MP 2-A). As we are coarsening using the CSL, we want to distinguish between the cases where the complex shift is large versus small. We therefore start by keeping the shift \u03b22 \u201c 0.7, similar to the one used in all previous experiments. Results are reported in Table 7 for 1 up to 5 smoothing steps. We immediately observe that the number of iterations for both the V- and W-cycle are drastically reduced. If we compare these results to the ones obtained when using the \u03c9\u00b4Jacobi smoother in Table 4, the reduction in the number of iterations is approximately 2.5 times. For example, when using 5 smoothing steps within a V-cycle, the \u03c9\u00b4Jacobi smoother requires 238 iterations to reach convergence. When GMRES(3) is used as a smoother with a similar amount of smoothing steps, 88 iterations are required to reach convergence. Note that there appears to be no difference in the number of iterations when using the V-cycle and W-cycle.\nNext, we repeat the same numerical experiments, however this time we set the complex shift to \u03b22 \u201c k\u00b41. Note that this is a very small shift, in fact the CSL matrix starts being a close resemblance of the original Helmholtz operator. Results are reported in Table 8. For all cases, we report that there is a drastic improvement in the number of iterations. We obtain a solver which is close to k\u00b4 independent when we use \u03bd \u0105 2 and \u03b3 \u201c 2. Unlike the previous case where \u03b22 \u201c 0.7 in Table 7, we now do observe a lower number of iterations for the W-cycle.\nIn fact, additional numerical experiments confirm that the results are similar if we let \u03b22 \u201c 0, which results in the original Helmholtz operator. Thus, when using GMRES(3) as a smoother, the original Helmholtz operator can in fact be used instead of the CSL for coarsening within the multigrid hierarchy. However, the fast\nconvergence is only observed when combined with the high-order prolongation and restriction operators.\nGiven that we obtained the best numerical results with \u03b22 \u201c k\u00b41 without any additional costs, we continue with this shift for the CSL in the upcoming sections.\n5.3.2. 2D results non-constant kpx, yq. Finally, we investigate the convergence behavior using the GMRES(3) smoother on the highly-varying problem (MP 2-B2). In subsection 5.2, we observed that this was the hardest problem to solve in terms of heterogeneous problem, due to the wavenumber varying highly between k \u201c 10 and k \u201c 75 across the numerical domain. Thus, we only test for this case in this subsection.\n5.3.3. Sharp Changes. Results are reported in Table 9 and again indicate a drastic improvement compared to the case where we use the \u03c9\u00b4Jacobi smoother. In fact, even for this highly-varying model containing sharp changes between the wavenumbers k \u201c 10 and k \u201c 75, where the wavenumber is allowed to vary randomly between 10 and 75 across the domain, we obtain a k\u00b4 and h\u00b4independent multigrid solver for \u03bd \u011b 3. Similar to the previous case, even when using the original Helmholtz operator, we reach convergence when using GMRES(3) as a smoother. However, the k\u00b4independence is only observed when the higher-order prolongation and restriction scheme is used. These results are promising and provide a solid framework for future research, given that the current industry standard (CSL preconditioner with multigrid inversion) works well for homogeneous problems, but is less suitable for heterogeneous problems with sharp changes between wavenumbers due to the instability of the inexact inversion using geometric multigrid [33, 15].\n6. Conclusion. In this paper, we present the first full multigrid hierarchy for both the V- and W-cycles using classic multigrid components for the indefinite nonsymmetric Helmholtz problem. Here, we emphasized the use of classical components, such as the weighted Jacobi smoother. The resulting algorithm shows h\u00b4independent convergence and thus adheres to the classic multigrid features. Two novel and striking features should be mentioned. First of all, no restriction is imposed on the number of grid points on the coarsest grid. Second of all, no level-dependent parameters are needed.\nApart from the numerical results, we provide a new theory to assess convergence of highly indefinite linear systems. Where most proofs require some adjointness and/or symmetry assumptions on the underlying linear system, we have constructed theoretical notions which do not require such assumptions. In fact, we have found that the addition of a complex shift, solely for the purpose of coarsening in the multigrid hierarchy, combined with higher-order interpolation schemes for the inter-grid transfer operators leads to an HPD system. The positive definiteness can be verified for medium-sized wavenumbers by assessing properties of the matrix. As a result, it can be shown that the convergence is independent of h. Thus, the computation of the spectral radius can be circumvented, especially since the analytical eigenvalues can only be computed in case of Dirichlet boundary conditions. We also study the behavior of the solver once we use GMRES(3) as a smoother instead of \u03c9\u00b4Jacobi. The convergence significantly improves and less smoothing steps are needed. Second of all, if we use GMRES(3) as a smoother, we can keep the complex shift very small without paying a penalty in terms of additional costs. As a result, we obtain close to k\u00b4 and h\u00b4independent convergence, both for the constant wavenumber model problem and the non-constant wavenumber model problem. In fact, we can even use the original Helmholtz operator for coarsening in this configuration without losing efficiency and effectiveness as the GMRES iterations provide polynomial smoothing.\nThis work is one of the few to demonstrate, both theoretically and numerically, the existence and potential of multigrid methods for such linear systems. However, a lot of future work remains to be done. For example, future research could focus on exploring different combinations of interpolation schemes and smoothers and extending proofs. Also, instead of coarsening on the CSL, other candidates in terms of \u2019near positive definite operators\u2019 could also be explored. We have shown convergence for \u03c9\u00b4Jacobi, mainly because of its simplicity and parallelizability, but many other options remain to be examined. Moreover, once a convergent solver has been established, the next step in shifting the paradigm would be to study wavenumber independent convergence."
        }
    ],
    "title": "STAND-ALONE MULTIGRID FOR HELMHOLTZ REVISITED: TOWARDS CONVERGENCE USING STANDARD COMPONENTS",
    "year": 2023
}