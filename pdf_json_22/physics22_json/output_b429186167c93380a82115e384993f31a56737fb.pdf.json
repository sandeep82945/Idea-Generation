{
    "abstractText": "Photonic balls are spheres tens of micrometers in diameter containing assemblies of nanoparticles or nanopores with a spacing comparable to the wavelength of light. When these nanoscale features are disordered, but still correlated, the photonic balls can show structural color with low angle-dependence. Their colors, combined with the ability to add them to a liquid formulation, make photonic balls a promising new type of pigment particle for paints, coatings, and other applications. However, it is challenging to predict the color of materials made from photonic balls, because the sphere geometry and multiple scattering must be accounted for. To address these challenges, we 1 ar X iv :2 20 7. 03 03 3v 3 [ co nd -m at .s of t] 9 J an 2 02 3 develop a multiscale modeling approach involving Monte Carlo simulations of multiple scattering at two different scales: we simulate multiple scattering and absorption within a photonic ball and then use the results to simulate multiple scattering and absorption in a film of photonic balls. After validating against experimental spectra, we use the model to show that films of photonic balls scatter light in fundamentally different ways than do homogeneous films of nanopores or nanoparticles, because of their increased surface area and refraction at the interfaces of the balls. Both effects tend to sharply reduce color saturation relative to a homogeneous nanostructured film. We show that saturated colors can be achieved by placing an absorber directly in the photonic balls and mitigating surface roughness. With these design rules, we show that photonic-ball films have an advantage over homogeneous nanostructured films: their colors are even less dependent on the angle.",
    "authors": [
        {
            "affiliations": [],
            "name": "Anna B. Stephenson"
        },
        {
            "affiliations": [],
            "name": "Ming Xiao"
        },
        {
            "affiliations": [],
            "name": "Victoria Hwang"
        },
        {
            "affiliations": [],
            "name": "Liangliang Qu"
        },
        {
            "affiliations": [],
            "name": "Paul A. Odorisio"
        },
        {
            "affiliations": [],
            "name": "Michael Burke"
        },
        {
            "affiliations": [],
            "name": "Keith Task"
        },
        {
            "affiliations": [],
            "name": "Ted Deisenroth"
        },
        {
            "affiliations": [],
            "name": "Solomon Barkley"
        },
        {
            "affiliations": [],
            "name": "Rupa H. Darji"
        },
        {
            "affiliations": [],
            "name": "Vinothan N. Manoharan"
        },
        {
            "affiliations": [],
            "name": "John A. Paulson"
        }
    ],
    "id": "SP:2c627f78c12cf1f76990c9cecfc77d5dbe266684",
    "references": [
        {
            "authors": [
                "V. Hwang",
                "A.B. Stephenson",
                "S. Barkley",
                "S. Brandt",
                "M. Xiao",
                "J. Aizenberg",
                "V.N. Manoharan"
            ],
            "title": "Designing angle-independent structural colors using Monte Carlo simulations of multiple scattering",
            "venue": "Proceedings of the National Academy of Sciences",
            "year": 2015
        },
        {
            "authors": [
                "E. Kov\u00e1cs"
            ],
            "title": "Rotation about an arbitrary axis and reflection through an arbitrary plane",
            "venue": "Annales Mathematicae et Informaticae 2012,",
            "year": 2012
        },
        {
            "authors": [
                "B.W. Silverman"
            ],
            "title": "Density Estimation for Statistics and Data Analysis",
            "year": 1986
        },
        {
            "authors": [
                "M. Xiao",
                "A.B. Stephenson",
                "A. Neophytou",
                "V. Hwang",
                "D. Chakrabarti",
                "V.N. Manoharan"
            ],
            "title": "Investigating the trade-off between color saturation and angle-independence in photonic glasses",
            "venue": "Optics Express 2021,",
            "year": 2021
        },
        {
            "authors": [
                "M. Kness"
            ],
            "title": "ColorPy - A python package for handling physical descriptions of color and light spectra. http://markkness.net/colorpy/ColorPy.html, (accessed 202211-18)",
            "venue": "GNU Lesser General Public License",
            "year": 2022
        },
        {
            "authors": [
                "G.A. Klein"
            ],
            "title": "Industrial Color Physics ; Springer Series in Optical Sciences",
            "year": 2010
        },
        {
            "authors": [
                "S. Torquato",
                "F.H. Stillinger"
            ],
            "title": "Jammed hard-particle packings: From Kepler to Bernal and beyond",
            "venue": "Reviews of Modern Physics 2010,",
            "year": 2010
        },
        {
            "authors": [
                "I.H. Malitson"
            ],
            "title": "Interspecimen Comparison of the Refractive Index of Fused Silica",
            "venue": "Journal of the Optical Society of America 1965,",
            "year": 1965
        },
        {
            "authors": [
                "R. Kitamura",
                "L. Pilon",
                "M. Jonasz"
            ],
            "title": "Optical constants of silica glass from extreme ultraviolet to far infrared at near room temperature",
            "venue": "Applied Optics",
            "year": 2007
        },
        {
            "authors": [
                "S.E. Han",
                "S. Atiganyanun",
                "S.H. Lee",
                "S. Cheek",
                "S.M. Han"
            ],
            "title": "Determination of internal reflectance for photonic glasses",
            "venue": "Physical Review B 2019,",
            "year": 2019
        },
        {
            "authors": [
                "G.A. D\u2019Almeida",
                "E.P. Shettle",
                "P. Koepke"
            ],
            "title": "Atmospheric aerosols: global climatology and radiative characteristics ; Studies in geophysical optics and remote sensing; A",
            "venue": "Deepak Publishing:",
            "year": 1991
        },
        {
            "authors": [
                "P. Ch\u00fdlek",
                "G. Videen",
                "D. Ngo",
                "R.G. Pinnick",
                "J.D. Klett"
            ],
            "title": "Effect of black carbon on the optical properties and climate forcing of sulfate aerosols",
            "venue": "Journal of Geophysical Research: Atmospheres",
            "year": 1995
        },
        {
            "authors": [
                "M. Rubin"
            ],
            "title": "Optical properties of soda lime silica glasses",
            "venue": "Solar Energy Materials 1985,",
            "year": 1985
        },
        {
            "authors": [
                "T.H. Zhao",
                "G. Jacucci",
                "X. Chen",
                "D.-P. Song",
                "S. Vignolini",
                "R.M. Parker"
            ],
            "title": "AngularIndependent Photonic Pigments via the Controlled Micellization of Amphiphilic Bottlebrush Block Copolymers",
            "venue": "Advanced Materials 2020,",
            "year": 2020
        },
        {
            "authors": [
                "Y. Takeoka",
                "S. Yoshioka",
                "A. Takano",
                "S. Arai",
                "K. Nueangnoraj",
                "H. Nishihara",
                "M. Teshima",
                "Y. Ohtsuka",
                "T. Seki"
            ],
            "title": "Production of Colored Pigments with Amorphous Arrays of Black and White Colloidal Particles",
            "venue": "Angewandte Chemie International Edition",
            "year": 2013
        },
        {
            "authors": [
                "V.A. Markel"
            ],
            "title": "Introduction to the Maxwell Garnett approximation: tutorial",
            "venue": "Journal of the Optical Society of America A 2016,",
            "year": 2016
        },
        {
            "authors": [
                "S. Fraden",
                "G. Maret"
            ],
            "title": "Multiple light scattering from concentrated, interacting suspensions",
            "venue": "Physical Review Letters 1990,",
            "year": 1990
        },
        {
            "authors": [
                "P.D. Kaplan",
                "A.D. Dinsmore",
                "A.G. Yodh",
                "D.J. Pine"
            ],
            "title": "Diffuse-transmission spectroscopy: A structural probe of opaque colloidal mixtures",
            "venue": "Physical Review E",
            "year": 1994
        },
        {
            "authors": [
                "G.J. Aubry",
                "L. Schertel",
                "M. Chen",
                "H. Weyer",
                "C.M. Aegerter",
                "S. Polarz",
                "H. C\u00f6lfen",
                "G. Maret"
            ],
            "title": "Resonant transport and near-field effects in photonic glasses",
            "venue": "Physical Review A 2017,",
            "year": 2017
        },
        {
            "authors": [
                "P.D. Garc\u00eda",
                "R. Sapienza",
                "J. Bertolotti",
                "M.D. Mart\u00edn",
                "\u00c1. Blanco",
                "A. Altube",
                "L. Vi\u00f1a",
                "D.S. Wiersma",
                "C. L\u00f3pez"
            ],
            "title": "Resonant light transport through Mie modes in photonic glasses",
            "venue": "Physical Review A 2008,",
            "year": 2008
        },
        {
            "authors": [
                "P. Yazhgur",
                "G.J. Aubry",
                "L.S. Froufe-P\u00e9rez",
                "F. Scheffold"
            ],
            "title": "Scattering phase delay and momentum transfer of light in disordered media",
            "venue": "Physical Review Research 2022,",
            "year": 2022
        },
        {
            "authors": [
                "R.O. Prum",
                "R.H. Torres",
                "S. Williamson",
                "J. Dyck"
            ],
            "title": "Coherent light scattering by blue feather barbs",
            "venue": "Nature",
            "year": 1998
        },
        {
            "authors": [
                "J.D. Forster",
                "H. Noh",
                "S.F. Liew",
                "V. Saranathan",
                "C.F. Schreck",
                "L. Yang",
                "J.G. Park",
                "R.O. Prum",
                "S.G.J. Mochrie",
                "C.S. O\u2019Hern",
                "H. Cao",
                "E.R. Dufresne"
            ],
            "title": "Biomimetic Isotropic Nanostructures for Structural Coloration",
            "venue": "Advanced Materials",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "Photonic balls are spheres tens of micrometers in diameter containing assemblies of nanoparticles or nanopores with a spacing comparable to the wavelength of light. When these nanoscale features are disordered, but still correlated, the photonic balls can show structural color with low angle-dependence. Their colors, combined with the ability to add them to a liquid formulation, make photonic balls a promising new type of pigment particle for paints, coatings, and other applications. However, it is challenging to predict the color of materials made from photonic balls, because the sphere geometry and multiple scattering must be accounted for. To address these challenges, we\n1\nar X\niv :2\n20 7.\ndevelop a multiscale modeling approach involving Monte Carlo simulations of multiple scattering at two different scales: we simulate multiple scattering and absorption within a photonic ball and then use the results to simulate multiple scattering and absorption in a film of photonic balls. After validating against experimental spectra, we use the model to show that films of photonic balls scatter light in fundamentally different ways than do homogeneous films of nanopores or nanoparticles, because of their increased surface area and refraction at the interfaces of the balls. Both effects tend to sharply reduce color saturation relative to a homogeneous nanostructured film. We show that saturated colors can be achieved by placing an absorber directly in the photonic balls and mitigating surface roughness. With these design rules, we show that photonic-ball films have an advantage over homogeneous nanostructured films: their colors are even less dependent on the angle."
        },
        {
            "heading": "Keywords",
            "text": "structural color, photonic ball, multiple scattering, Monte Carlo model, angle-independent, photonic glass"
        },
        {
            "heading": "Introduction",
            "text": "Photonic balls\u2014also called photonic microspheres,1 microcapsules,2 supraballs,3 or supraparticles4\u2014consist of nanoparticles or nanopores that are packed into micrometer-scale spheres1\u201324 (Fig. 1a). They are called \u201cphotonic\u201d because the spacing between the particles or nanopores is on the order of the wavelength of light, resulting in constructive interference and structural color (Fig. 1b). Of particular interest are photonic balls where the nanoscale features are disordered, but still correlated. These disordered photonic balls have structural colors that vary only weakly with the sample orientation and angle of illumination,2,3,8,10\u201312,21\u201325 because the constructive interference condition is partially met at a range\n2\nof wavelengths. Compared to the more iridescent, or angle-dependent, colors produced by crystalline photonic balls,1,4\u20137,9,13\u201320 the colors of disordered photonic balls can be nearly indistinguishable from those of dyes. Their weak angle-dependence, combined with the ability to incorporate them in formulations such as liquid suspensions, powders, or coating precursors, make disordered photonic balls a promising way to create customizable colors for many different industrial-scale applications.\nThe challenge is to determine what color a photonic ball will produce in a given formulation. The color is determined by the nanoparticle or nanopore size, the structure of the nanoparticles or nanopores, the photonic ball size, and the refractive index of the materials that compose the photonic ball as well as the media in the rest of the formulation (Fig. 1c). Because of the size of this design space, it is not possible to fabricate every combination of parameters. Instead, a predictive model is needed (Fig. 1d).\nSome groups have used simulations and modeling to gain a physical understanding of the scattering from these disordered assemblies of nanoparticles or nanopores. Single-scattering models, in which light scatters once from a nanostructured film, are useful for guiding design, because they are parameterized in terms of the sample variables,26\u201328 but they do not, in general, quantitatively reproduce measured spectra because they do not include multiple scattering, and they do not capture the effects of the photonic-ball geometry on the color. Numerical methods such as finite-difference time-domain and finite-integration time-domain25,29\u201331 can account for multiple scattering and photonic ball geometry, but these techniques are computationally intensive and require specifying the positions of every nanoparticle or nanopore. For systems in which only the volume fraction and sizes of the nanoscale features are known, an effective-medium approach is easier to apply and much less computationally intensive. Schertel and colleagues combined a physically realistic effective-medium theory with a diffusion approximation.32 This model works well for highly multiply scattering systems, but when designing saturated colors, our principal goal is to reduce multiple scattering to the point that the diffusion approximation is no longer valid.\n3\n4\nIn addition to accounting for weak to moderate multiple scattering, a model must also account for the effect of the photonic ball\u2019s geometry on its interaction with light. Patil and colleagues have developed models combining molecular dynamics simulations33 or computational reverse-engineering analysis for scattering experiments34 with finite-difference timedomain calculations. Though these models do account for the photonic ball geometry, we seek a model that is less computationally intensive and which does not require specifying the positions of all the nanoscale features. A promising development along these lines is the single-scattering model developed by Yazhgur and colleagues24 to predict the optical response of individual photonic balls. Their model has provided a new understanding of the interplay between the contributions of the nanostructured scatterers inside the ball and the Mie resonances of the photonic ball itself. However, this approach does not yet include multiple scattering. For our purposes, it is essential to account for multiple scattering not only within a single photonic ball but also within a film of packed photonic balls, as would be found in many applications.\nTo address these challenges, we develop a multiscale Monte Carlo model that can be used to predict the color of a composite film of photonic balls (Fig. 2). Our model focuses on a weak multiple scattering regime\u2014in which the refractive index contrast is high enough that we must consider multiple scattering but not so high that we must consider near-field effects. We first use a Monte Carlo calculation to simulate the light scattering and absorption in an individual photonic ball. This first calculation is based on previous work by Hwang and coworkers,35 though we modify that model to account for the effects of the photonic-ball geometry. We then use the results of this simulation in a second Monte Carlo calculation that simulates the scattering and absorption among multiple photonic balls in a film. We validate our model against experimental spectra and compare its predictions to those of other models, showing that the two scales of simulation and boundary conditions are necessary to achieve experimental agreement. Our calculations show that the scattering in a photonic-ball film has fundamental differences from scattering in a nanostructured film, and those differences\n5\nlead to different optical effects. We explore the physical origins of these differences and show that taking them into consideration brings in new design parameters: the packing fraction of the photonic balls, the material between the photonic balls, the thickness of the film, and, importantly, the location of any absorbing material\u2014in the nanoparticles, photonicball matrix, or film matrix. By exploring the effects of these new design parameters, we develop design rules for fabricating structurally colored materials for applications."
        },
        {
            "heading": "Results and Discussion",
            "text": "Overview of multiscale modeling approach\nIn brief, our multiscale model involves two coupled Monte Carlo simulations (Fig. 2). The first simulates light transport (scattering and absorption) within a photonic ball, and the second simulates transport in a film of many photonic balls. To model transport in an individual photonic ball, we simulate light trajectories by sampling probability distributions for the scattering length and direction. These distributions are calculated from Mie theory and effective-medium theory, and they also include the effects of constructive interference due to structural correlations. To model light transport in a film of photonic balls, we use the same basic approach, but the probability distributions are calculated from the results of the simulation for a single photonic ball. The physical rules taken into account at each scale are the key to accurately modeling these materials. We discuss the modeling at both scales in detail in the Methods section."
        },
        {
            "heading": "Model validation",
            "text": "To validate our multiscale Monte Carlo model, we compare the predictions of our model to three sets of samples. First, we compare the predictions of the first level of the model\u2014the Monte Carlo simulation for individual photonic balls\u2014to experimental reflectance data for individual photonic balls fabricated by Zhao and colleagues.23 Next, we compare predictions\n6\n7\n8\nfrom the second level\u2014the Monte Carlo simulation for films of photonic balls\u2014to experimental data from photonic-ball films that we fabricate and measure ourselves. Finally, for additional validation, we compare our predictions to measurements of a set of photonic-ball films made by Takeoka and colleagues8 using a different fabrication technique.\nOur validations focus on samples in an intermediate range of refractive-index contrast, which we define as |nparticle/pore \u2212 nmatrix|. In this regime, the index contrast is high enough for multiple scattering to be important, but not so high that we must model near-field effects. We discuss this refractive-index regime and our choice to use effective-medium theory in more detail in the Supporting information. There we compare experimental data on scattering strength and reflectance spectra to predictions from various methods (Figs. S3 and S4). Based on these calculations, we expect our model to yield reasonable predictions for samples with an index contrast of about 0.5, which includes the systems we examine in this paper (contrasts between 0.45 and 0.52). We do not expect it to accurately predict the reflectance spectra for samples with lower contrast, such as polystyrene in water (about 0.26). In the low-contrast regime, it may be better to avoid an effective-medium description or to use models intended for the single-scattering regime, such as models developed by Yazhgur and colleagues.24,36\nWe validate the first level of the multiscale Monte Carlo model by comparing the predicted reflectance of individual photonic balls to experimental measurements from Zhao and colleagues,23 who fabricated and characterized disordered photonic balls and also performed precisely normalized measurements of the reflectance of individual photonic balls. We use the data from this study because precise, quantitative reflectance measurements of a single photonic ball require careful configuration of the microscope\u2019s optical setup to capture only the reflected light from the photonic ball in view, and the measurements must be normalized under exactly the same conditions. The measurements by Zhao and colleagues meet these criteria. The photonic balls used in this study are inverse structures, with nanopores embedded in a matrix made from an amphiphilic bottlebrush block copolymer.\n9\nTo simulate the reflectance spectrum, we must estimate some model parameters by comparing the model predictions to the data. We vary the nanopore radius and photonic-ball diameter to lie within two standard deviations (based on the reported experimental uncertainties) of the measured values in Ref. 23. Because we do not have experimentally measured values for the volume fraction, fine roughness, and detection angle range, we choose prior ranges for these parameters based on physical or experimental considerations and then estimate the parameters by comparing model predictions to experiment (see Supporting Information for full details on parameter estimation). We do not, however, vary the refractive indices. For the matrix refractive index, we use Zhao et al.\u2019s estimated value of 1.52, which they calculated from reported values from constituent side chains of the block copolymer. We take the refractive index of the nanopores to be 1, since the photonic balls are dry.\nWe find that for each color, the predicted and measured peak locations line up well (Fig. 3). The deviations between model and experiment might be due to uncertainty in the photonic-ball size or other estimated parameters, or they might arise because we do not include dispersion of the refractive index of the bottlebrush block copolymer (which, to the best of our knowledge, has not been measured). Because the refractive index we use is independent of wavelength, and spectral features appear at different wavelengths for each nanopore size, we expect the mismatch between data and prediction to vary among the three samples. But because the model produces good agreement for the overall magnitude of the reflectance as well as the peak positions for all three colors, the predicted colors are still close to the measured colors (see swatches in Fig. 3). Though our model includes adjustable parameters, these parameters all come from physical characteristics of the system and are restricted to reasonable physical ranges. These results show that it is possible to reproduce the main reflectance features for a single photonic ball, which allows us to extend this model to a film of photonic balls.\nNext we compare the predictions from our model to experimental measurements of films of photonic balls, validating the second level of our multiscale model. Reflectance measurements\n10\nfor a film are easier to perform than measurements on an individual photonic ball, and therefore we do these measurements in our own setup, using photonic balls that we fabricate and pack into films (see Methods). These photonic balls consist of nanopores inside a silica matrix. We fabricate photonic balls with reflectance peaks in the blue, green, and red (Fig. 1b) by changing the nanopore size. We then add carbon black to the photonic balls to suppress multiple scattering and increase saturation, using a method that likely deposits most of the carbon black on the photonic-ball surface (see Methods). We measure the carbon-black concentration, nanopore size, nanopore polydispersity, photonic ball size, and film thickness to use as input parameters for our model. For the refractive indices of the silica and carbon black, we use measurements from the literature.37\u201340 We choose the nanopore volume fraction, photonic-ball volume fraction, fine roughness, and coarse roughness to lie within reasonable physical ranges for our samples (see Supporting Information).\nThe model produces good agreement for the magnitudes and peak positions of the reflectance spectra for all three colors (Fig. 4a), and the predicted colors match the measured colors well for the blue and green samples. We observe a discrepancy between predicted and measured colors for the red sample. This discrepancy might arise from differences between the structure that is modeled and the actual structure of the sample. The observed peak-to-background ratio of the red sample is lower than that of the blue or green samples, suggesting weaker structural correlations and differences in the nanopore structure of the red photonic balls compared to the blue and green samples.\nTo further validate our model, we also compare our simulated spectra to reflectance spectra of disordered photonic-ball films fabricated and measured by Takeoka and colleagues.8 This comparison allows us to test the model on photonic-ball films that are direct structures of nanoparticles, rather than inverse structures of nanopores, and that are made using a different fabrication technique and with a different placement of absorber. The photonic balls are composed of silica nanoparticles in air and are packed into 200 \u00b5m-thick films. Using input parameters that are within the uncertainty of the measured values (see Supporting\n11\n12\nInformation), we find good agreement between our multiscale model and the measured reflectance spectra, as well as good agreement between the calculated and measured colors (Fig. 4b).\nTo understand whether the multiscale nature of our model is essential to the agreement with experiment, we compare the measured spectra for a green photonic-ball film to the spectra calculated from five different models, including our multiscale model (Fig. 5; see Fig. S1 for comparisons to other measurements). Each of the four other models accounts for some, but not all, of the physical effects that the multiscale model accounts for. The simplest model accounts for only single scattering within a planar film geometry26 using Mie theory, an effective-medium approximation, and a structure factor. This single-scattering film model reproduces the correct peak position near 550 nm, but the reflectance amplitudes are far from the experimental spectrum (Fig. 5a). A Monte Carlo model that accounts for multiple scattering in a planar film produces better agreement with the measured reflectance at low wavelengths, but the peak reflectance is still much higher than the data, and the long-wavelength reflectance much lower (Fig. 5b). An improved version of this model that accounts for the geometry of an individual photonic ball causes the peak height to decrease, bringing the reflectance closer to the data, but this model still produces discrepancies at long wavelengths (Fig. 5c). These remaining discrepancies cannot be resolved by adjusting the roughness parameters, because the peak shape and height are not significantly affected by the roughness. The multiscale Monte Carlo model resolves the discrepancies (Fig. 5d). These results show that modeling the multiple scattering due to the nanostructure, the scattering from the boundary of the photonic balls, and the inter-ball scattering are all necessary to capture the experimental reflectance features."
        },
        {
            "heading": "Developing design rules",
            "text": "Having shown that the multiscale model can reproduce the spectral features of photonic-ball films better than models that do not account for inter- and intra-ball multiple scattering\n13\n14\nand the spherical geometry, we now use the model to understand the physical mechanisms behind spectral features. This understanding enables us to develop design rules to make desired colors.\nWe first consider how and why the color of a photonic-ball film differs from that of a film containing only nanopores with no higher-level structure. The predicted reflectance spectrum of our green photonic-ball film produces a much less saturated color than that of a comparable nanopore film (Fig. 5b), as evidenced by the high off-peak scattering in the photonic-ball film spectrum. The reduced saturation in the photonic-ball film could stem from the effects of fine roughness or from where the broadband absorber is located. We use our model to examine both cases.\nIn the absence of absorber and of fine roughness, the spectra of the photonic-ball and\n15\nnanopore films are similar, aside from the photonic-ball film\u2019s slightly larger reflectance, which becomes more pronounced at longer wavelengths (top left panel of Fig. 6). The larger reflectance likely comes from Fresnel reflection and refraction at the boundaries of the photonic balls. Light that reflects at the boundary can scatter more times before it exits. The effect of the Fresnel reflections is more prominent at longer wavelengths, where there is less scattering overall, and therefore the relative increase in scattering is greater. Adding a broadband absorber to both films while keeping the effective imaginary indices equal reduces the overall reflectance in both (top right panel of Fig. 6). The reflectance peak of the nanopore film becomes more pronounced, but the spectra are still similar. These results show that the scattering in roughness-free films is similar, whether they are composed of photonic balls or contain a homogeneous arrangement of nanopores.\nHowever, adding fine roughness leads to stark differences in the reflectance spectra of the films. In the absence of absorber, adding fine roughness raises the long-wavelength reflectance of the photonic-ball film (bottom left panel of Fig. 6), leading to a much less saturated color. When both fine roughness and absorption are included in the model, the photonic-ball film shows a lower peak and nearly uniform, broadband reflectance, while the nanopore film shows a more pronounced peak with much lower long-wavelength reflectance (bottom right panel of Fig. 6). Thus the fine roughness is responsible for the difference in color between photonic-ball films and homogeneous nanopore films.\nThe effects of fine roughness are magnified in a photonic-ball film because of the higher surface area of the film compared to a homogeneous nanopore film: each photonic ball has fine roughness, and therefore more incoherent surface scattering occurs in the photonic-ball films. One way to mitigate this effect\u2014and achieve more saturated colors in photonic-ball films\u2014would be to reduce the fine roughness as much as possible. However, this approach might require developing new fabrication techniques. An alternative approach, which we consider next, is to control the location of the absorber in the sample.\nOur multiscale simulations show that the color is much less saturated when the absorber\n16\n17\nis placed in the film matrix compared to when it is in the nanopores or in the photonicball matrix (Fig. 7a). We also find that when the absorber concentration is increased in the film matrix (top panel of Fig. 7b), the entire reflectance spectrum shifts downward. By contrast, when the absorber concentration is increased in the photonic-ball matrix or nanopores, the long-wavelength, off-peak reflectance decreases much more than the shortwavelength reflectance does. The drop in long-wavelength reflectance leads to much more saturated blue and green colors. Thus, placing the absorber in either the nanopores or the photonic-ball matrix offers more saturated colors and better control over the saturation.\nTo understand why the off-peak reflectance decreases so much more than the peak reflectance when the absorber is embedded inside the nanopores or matrix of the photonic balls, we plot the effective absorption coefficient for the photonic-ball film (Eq. (11)) as a function of wavelength (Fig. 7c). Although the imaginary effective indices ni are equal for each film, the effective absorption coefficient \u00b5abs,eff, which includes absorption contributions from inside the photonic balls as well as from the surrounding matrix, is greater when the absorber is in the nanopores or matrix of the photonic balls. This increase in absorption occurs because most of the scattering happens within the photonic balls, and so placing the absorber inside the photonic balls reduces multiple scattering to a greater extent than placing it outside the balls. The multiple scattering is the principal contribution to the off-peak reflectance. By contrast, there is less multiple scattering at the reflectance peak, because much of the light is backscattered out of the ball before it can scatter multiple times within the ball. As a result, there is less absorption at the wavelength of the peak. This interplay between scattering and absorption explains why placing the absorber inside the photonic balls instead of the film matrix increases the absorption preferentially at off-peak wavelengths, leading to more saturated colors.\nTo further understand why there is little difference between placing the absorber in the nanopores or in the photonic-ball matrix, we consider how the effective imaginary index affects the reflectance. Because the effective imaginary index is constrained to be equal for\n18\nthe two placements (Fig. 7a), the absorption coefficient \u00b5abs calculated in the Monte Carlo simulation for each individual photonic ball is also identical (Fig. 7c). Therefore the intensity decreases with distance in exactly the same way (set by Eq. (6)) for each ball. Although the imaginary index can in principle affect the form factor F , calculated from the Mie solutions, the effects on F are negligible because the imaginary indices are small compared to the difference between the real refractive indices. Thus the reflectance values for absorber in the nanopores and in the photonic-ball matrix are nearly identical. Note that the reflectances overlap only when the imaginary indices are equal, even though the total volume of absorber may be different across the samples. However, the reflectance trend of increasing saturation remains the same whether absorber volume or imaginary refractive index is increased.\nFinally we examine the angle-dependence of the color, another important property for applications. To characterize the angle-dependence of a photonic-ball film, we simulate the reflectance for a range of detection angles and compare the results to simulations for a nanopore film (Fig. 8). To facilitate comparison, we simulate spectra with similar colors (Fig. 8a) by choosing the same base scattering parameters of material, nanopore size, volume fraction, and roughness but varying the absorber concentration slightly to match the colors. We find that both film geometries show the low angle-dependence expected for disordered systems, but the photonic-ball films show almost no shift in the peak of the reflectance with wavelength (Fig. 8c). To quantify the color change with angle, we calculate the CIE 1976 color difference (Fig. 8d; see Supporting Information for calculation details). The color of the photonic-ball film shifts much less with angle than does the color of the nanopore film, and the small color shift results from changes in the magnitude of the reflectance rather than a change in the peak wavelength. This suppression of peak shift suggests that photonic-ball films present a route to even more angle-independent colors than can be achieved with nanostructured films, making photonic-ball films promising for applications where a homogeneous color is needed.\nThe increased angle-independence in a photonic-ball film can be understood by consider-\n19\ning the effect of the photonic-ball boundaries on the incident light. When light is normally incident on the surface of a photonic-ball film, it is refracted at the surface of each ball to a different extent, depending on where it hits the ball surface (owing to the curvature of the ball). Because of the variation in the direction of light entering the ball, the reflectance at any given detection angle will include light from a broad range of scattering angles. As shown in a previous study,41 a broader range of scattering angles leads to less angle-dependence. The fundamental reason is that the single-scattering interference that largely determines the peak wavelength is a function of the scattering wavevector |q| = 4\u03c0 sin(\u03b8/2)/\u03bb, which couples the scattering angle \u03b8 and wavelength \u03bb."
        },
        {
            "heading": "Conclusions",
            "text": "We have shown not only that a multiscale Monte Carlo model allows for accurate predictions of the color of films of disordered photonic balls with weak multiple scattering, but also that the model allows us to understand how and why these colors differ from those of homogenous nanostructured films. When we started our study, we hypothesized that the two types of films would show similar reflectance spectra. Our results show that this hypothesis is not correct for most photonic-ball films that are made in practice. These films generally show reduced color saturation compared to homogeneous nanostructured films. The differences are related to exactly the effects that we account for in our model: boundary effects at the photonic-ball surfaces and both inter- and intra-ball multiple scattering. Specifically, we find that refraction at the boundaries of the photonic balls leads to more scattering at wavelengths longer than that of the reflectance peak. Furthermore, because the surface area of a film of photonic balls is much higher than that of a homogeneous nanostructured film, even small amounts of surface roughness can markedly increase multiple scattering. Both of these effects lead to reduced color saturation in photonic-balls films. For those who want to make saturated structural colors from photonic balls, these effects pose a challenge.\n20\n21\nBut we have also shown that it is possible to mitigate these effects by controlling where absorber is placed in the film. In particular, placing the absorber inside the nanopores or the matrix of the photonic balls increases the saturation compared to placing it between the balls. This increase in scattering arises because the film absorbs more multiply scattered light when the absorber is placed inside the balls. Methods to fabricate photonic balls could therefore aim to add the absorber directly to the matrix precursor or to infiltrate the photonic balls with absorber before the balls are packed together.\nAlthough the color saturation of the resulting photonic-ball film may still be lower than that of a homogenous nanostructured film (owing to the effects of fine roughness), there is an advantage to using the photonic-ball film: the angle-dependence should be weaker and the color more uniform because of the refraction of light at the photonic-ball surfaces. Though these disordered nanostructure assemblies offer more angle-independence than their more ordered counterparts, the photonic-ball film geometry further improves the angleindependence. Thus, we argue that disordered photonic-ball films are indeed a promising method to fabricate structural colors for applications, not only because they can be readily added to coating and paint formulations, but also because they have more angle-independent colors.\nThese design rules and our model open a path to engineering photonic pigments for various applications. The model can be used as part of a design process in which a target color is specified and an optimization algorithm is used to determine the sample parameters (refractive indices, particle size, volume fractions, and others) required to achieve the best match to the target. To expand the palette of colors that can be achieved, future work on fabrication methods might focus on minimizing surface roughness, which would further increase saturation. Future improvements to the model might include incorporating the exit directions of totally internally reflected photon packets in the phase function, calculating the scattering effects of absorbers such as carbon black, and accounting for interference among different, multiply scattered trajectories. Accounting for these physical effects may\n22\nhelp bring the model into even better agreement with measurements, thereby enabling more accurate design of target colors. Furthermore, as shown in previous work by Yazhgur and colleagues,36 there is a need to better understand the limits of index contrast where effectivemedium theories can be reliably used. Future work on this subject could allow us to expand our model to study a wider range of materials.\nThe model can readily be extended to account for scattering in other hierarchical structures. Photonic balls containing nanoparticles or nanopores in arrangements not described by the Percus-Yevick structure factor\u2014bicontinuous pore structures or packings of nanorods, for example\u2014can be modeled by first specifying the appropriate structure factor, which can be derived or measured. Alternatively, if the angular reflectance of the photonic ball can be measured or calculated, for example through the finite-difference time-domain method, this data can be used as input to the photonic-ball film model. These approaches would allow modeling films of photonic balls containing a wide variety of nanostructures, as long as these nanostructures are roughly isotropic."
        },
        {
            "heading": "Methods",
            "text": "Modeling light transport in a single photonic ball\nAt the smallest scale of our model, we determine the single-scattering properties from an assembly of nanoparticles or nanopores (Fig. 2a). To calculate the scattering and absorption from individual nanoparticles or nanopores, we treat the surrounding nanoparticles or pores and the photonic-ball matrix material as a homogeneous, effective medium. We use the Bruggeman approximation42 to calculate the effective index of refraction from the volume fraction of nanoparticles, their refractive index, and the refractive index of the photonic-ball matrix. We then use Mie theory43 for a homogeneous sphere embedded in the effective medium to calculate the form factor F of the nanoparticle or nanopore, which is its differential scattering cross-section as a function of angle. We use a structure factor S to take into\n23\naccount the constructive interference that results from the short-range order in the packing of the particles. We assume the spheres are packed as a hard-sphere liquid, such that S can be described by the Percus-Yevick approximation.41,44 The total scattering cross-section of the sample \u03c3sca is\n\u03c3sca = \u222b d\u03c3sca d\u2126 d\u2126, (1)\nwhere d\u03c3sca/d\u2126 is the differential scattering cross-section for the nanostructure packing:26\nd\u03c3sca d\u2126 = FS. (2)\nThis combination of Mie theory, effective-medium theory, and structure factor is the foundation of the single-scattering model developed by Magkiriadou and colleagues to predict the reflectance from a film of disordered colloids26 as well as the first step of our multiscale model.\nFrom these results we calculate two distributions. The first is the distribution of distances (which we call steps) that light travels before being scattered. This distribution is based on the Beer-Lambert law:\nP (step) = 1\nlsca exp(\u2212step/lsca). (3)\nThe mean of this distribution is the scattering length lsca = 1/\u03c1\u03c3sca, where \u03c1 is the number density of nanoparticles. The second distribution is the phase function, or the distribution of angles that the light scatters into:\nP (\u03b8) = d\u03c3sca/d\u2126\n\u03c3sca . (4)\nTo simulate multiple scattering within a photonic ball, we use a Monte Carlo scheme based on these two distributions (Fig. 2b). We simulate trajectories of photon \u201cpackets,\u201d which have a wavelength, initial direction, and initial weight which can be reduced by absorption. The photon packets travel linearly until they are scattered; we determine the distance they\n24\ntravel by sampling from the step-size distribution, Eq. (3). The scattering event changes the direction of the photons. We sample the direction from the phase function, Eq. (4).\nBecause the materials used for the nanoparticles or matrix material may have some absorption, and broadband absorbers such as carbon black are often added to structurally colored materials, we must also account for absorption in the model. When a component material has a complex refractive index, we calculate the appropriate Mie solutions for absorbing materials, as described by Hwang and coworkers.35 In addition, we calculate the absorption length as\nlabs = 1\n\u00b5abs = \u03bb0 4\u03c0ni , (5)\nwhere ni is the imaginary component of the sample\u2019s effective refractive index. By using this definition of absorption length, we are assuming there are no strong resonances that would lead to higher absorption than predicted by effective-medium theory. We then reduce the weight of each photon packet according to the Beer-Lambert law:\nW = Wi exp(\u2212step/labs), (6)\nwhere Wi is the initial weight and W the weight after the step. The integrated reflectance is then calculated by summing the weights that exit the sample in the reflection hemisphere.\nAs described thus far, this Monte Carlo scheme is the same as that of Hwang and coworkers,35 which yielded reflectance spectra that were in quantitative agreement with experimental measurements on disordered nanoparticle films. In applying the scheme to a photonic ball, however, we must augment the model to account for the boundary conditions of the ball. In particular, we include refraction and Fresnel reflection at the boundary of the ball. When a photon packet encounters the interface between the ball and its surrounding medium, it splits into two packets, where one packet exits the ball and the other is internally reflected back into the ball. The weights of these two new packets are determined by the Fresnel transmission and reflection coefficients, which in turn depend on the effective index of the\n25\nball and the index of the matrix surrounding the ball. The incident, refraction, and reflection angles are determined with respect to the local normal vector on the photonic ball\u2019s surface. We simulate the trajectory of the refracted packet as usual, then simulate a new trajectory for the packet reflected back into the sphere. When this packet eventually encounters the boundary, we again split it and simulate a new trajectory for the reflected packet. This process is repeated until the total weights of all packets left inside the ball is less than 1 % of the original packet weights. The details of these calculations are discussed in the Supporting Information.\nModeling light transport in a film of photonic balls\nOur scheme also differs from that of Hwang and coworkers35 in that the aim is to extract a phase function, total scattering cross-section, and total absorption cross-section for the photonic ball, which are needed for modeling light transport in a film of many photonic balls. We therefore simulate each photon packet until it exits the ball or is almost completely absorbed.\nTo obtain the photonic ball phase function, we start by tracking where each photon packet exits the ball\u2019s surface and its weight upon exiting. We then use Gaussian kernel density estimation to construct the phase function from these exit positions and weights (see Supporting Information for details).\nTo calculate the step-size distribution and absorption length, we must first calculate the total scattering and absorption cross-sections for a single photonic ball. To calculate the scattering cross-section from the scattered photon weights, we must introduce a scaling factor to assign appropriate units and set a maximum value for the cross-section. The total scattering cross-section for a single photonic ball is\n\u03c3sca, ball = 2\u03c0r 2 \u2211 Wsca\u2211 Winc , (7)\n26\nwhere r is the radius of the photonic ball, Wsca is the scattered weight of a photon packet, and Winc is the incident weight of a photon packet. The summations are over all photon packets. The scaling factor of 2\u03c0r2 is the maximum scattering cross-section of a sphere in the geometrical-optics limit.45 Setting the maximum scattering cross-section to the geometricaloptics maximum is justified by the size of the photonic balls, which are roughly 12\u201375 times the wavelength. We note that this use of geometrical optics affects only the scaling of the cross-section, and we do not use geometrical optics to determine the photon-packet trajectories. The photonic ball absorption cross-section is then\n\u03c3abs, ball = \u03c0r 2 ( 1\u2212 \u2211 Wsca\u2211 Winc ) , (8)\nwhere the cross-section is scaled by the factor \u03c0r2, the maximum absorption cross-section in the geometrical optics limit.45\nNext, we simulate trajectories in the photonic-ball film by sampling probability distributions for the step size and direction, using the same method as in the first simulation but with different distributions (Fig. 2b,c). The step size is sampled from the distribution in Eq. (3), where lsca is replaced with lsca, ball, the scattering length in a photonic-ball film:\nP (step) = 1\nlsca, ball exp(\u2212step/lsca, ball), (9)\nwhere\nlsca, ball = 1\n\u03c1ball\u03c3sca, ball , (10)\nand \u03c1ball is the number density of photonic balls inside the film. The direction is sampled from the photonic-ball phase function, calculated from the exit positions and weights of the photon packets as described above. To account for absorption, we decrease the weights according to Eq. (6), replacing labs with an effective absorption length for the photonic-ball\n27\nfilm:\nlabs, eff = 1\n\u00b5abs, eff , (11)\nwhere \u00b5abs, eff is the effective absorption coefficient,\n\u00b5abs, eff = \u03c1ball\u03c3abs, ball + 4\u03c0ni \u03bb (1\u2212 \u03c6ball), (12)\n\u03c6ball is the volume fraction of photonic balls in the film, and ni is the imaginary refractive index of the matrix material surrounding the photonic balls.\nWe calculate the integrated reflectance by adding the reflected weights of trajectories and normalizing by the total incident weights. From the reflectance, we can determine color coordinates for the perceived color of the sample using the CIE color matching functions, as described by Xiao and colleagues.41\nThere are a few differences between the two Monte Carlo simulations due to the different scales on which they operate. Because the photonic balls are much larger than the wavelengths of visible light, we cannot use effective-medium theory in the second level of our model. Instead we consider the photonic balls to be embedded in the matrix material of the film, and not in an effective medium. Also, because the photonic balls are large compared to the wavelength, we neglect interference of light scattered from different photonic balls. This assumption is equivalent to choosing S = 1 for the structure factor of the photonic-ball film. Finally, we take into account surface roughness as described by Hwang and coworkers28 by considering two separate scales of roughness: coarse and fine. The coarse roughness accounts for sample roughness at a scale greater than the wavelength of light, which changes the orientation of the sample surface at each point in space, thereby modifying the refraction angles and Fresnel reflection coefficients when photon packets hit the sample interface. We include in our model a coarse roughness parameter, which is the root-mean-square slope of the surface.46 The fine roughness accounts for wavelength-scale roughness, produced by features such as particles protruding from the sample surface. We model fine roughness by\n28\nexcluding the structure-factor contribution from the calculation of the step-size distribution for the first step of the photon packets. The fine roughness parameter in our model is the fraction of photon packets that encounter this roughness at the scale of a single particle. We model coarse roughness only at the film surface and fine roughness only at the photonic-ball surfaces, and for both roughness types, we model the effect of roughness when light enters the film or ball, but not when it exits."
        },
        {
            "heading": "Photonic ball fabrication",
            "text": "To produce photonic balls of varying nanopore size, we first synthesize sacrificial polymer templates. Three separate traditional emulsion polymerizations were performed to produce poly(methyl methacrylate) colloidal dispersions, each poly(methyl methacrylate) nanoparticle having an average particle diameter of 250 nm, 332 nm, and 402 nm.\nThe aqueous poly(methyl methacrylate) colloidal dispersion was diluted to 1 % w/w with deionized water containing 1 % w/w colloidal silica (Ludox SM colloidal silica, Sigma Aldrich). The mixture was sonicated to prevent particle agglomeration. This aqueous dispersion was injected by syringe pump into a microfluidic device having a 50 \u00b5m droplet junction. At the same time, a continuous oil phase containing 0.1 % w/w polyethylene glycol/perfluoropolyether surfactant (FluoroSurfactant, RAN Biotechnologies) in a fluorinated oil (Novec 7500, 3M) was injected into the same device. When the device started to produce droplets, the droplets were collected in a beaker containing fluorinated oil.\nThe collected droplets were then dried in an oven at 45 \u00b0C for 4 h and then calcined by placing on a silicon wafer, heating from room temperature to 500 \u00b0C over 4 h, holding at 500 \u00b0C for 2 h, and cooling back to room temperature. This procedure results in photonic balls as a dried powder. To produce photonic balls containing 3 % w/w carbon black, we mix 10 mg of photonic balls with 150 mg of an aqueous dispersion of carbon black (0.2 % w/w, Covarine Black WS 9199, Sensient Cosmetic Technologies), and then dry at 70 \u00b0C for 1 h.\n29"
        },
        {
            "heading": "Photonic-ball film fabrication",
            "text": "To make the structurally colored films shown in Fig. 4a, we make ordered photonic balls of three different colors. These photonic balls are made using the procedure described above and consist of a silica matrix with air nanopores. The nanopore sizes are (208\u00b1 10) nm (blue), (265\u00b1 5) nm (green), (338\u00b1 12) nm (red). We deposit photonic balls onto a glass slide, then place a second glass slide on top of the deposited photonic balls. We then compress the two glass slides on both sides using binder clips and seal the edges of this sample chamber using 5-min epoxy. After the epoxy is cured, we remove the binder clips."
        },
        {
            "heading": "Reflectance measurements",
            "text": "We measure the reflectance spectra of films of photonic balls using an Agilent Cary 7000 Universal Measurement Spectrophotometer with an attached integrating sphere that collects the light scattered into the reflection hemisphere. The sample is illuminated with light from a double out-of-plane Littrow monochromator on a 1 mm \u00d7 3 mm rectangular spot. The sample is placed behind a circular port with a 6 mm diameter. We normalize the intensity measurement to a diffuse white reflectance standard (Spectralon, Labsphere). We calculate error bars (shown in gray in spectral data) as two standard deviations about the mean of measurements taken at different locations on the samples. For the blue sample, we measure 8 locations. For the green sample, we measure 11 locations. For the red sample, we measure 10 locations. We convert the average reflectance spectra into a color swatch using the software package ColorPy.47"
        },
        {
            "heading": "Model",
            "text": "The hierarchical Monte Carlo model was written in Python and is available as an open-source package on GitHub.48\n30\nSupporting Information Available\nDetails of the model design and implementation, colorspace calculations, sample parameter measurement and estimation, absorber concentration calculations, additional results and validations, as well as a detailed discussion of the use of effective-medium theory in our model."
        },
        {
            "heading": "Acknowledgement",
            "text": "We thank Bernhard von Vacano, Rupert Konradi, Jennifer McGuire, and Audrey von Raesfeld for helpful discussions. We thank Martin Panchula for suggesting the multiscale modeling approach and Diane Tom for the SEM imaging. We thank Lukas Schertel and Geoffroy Aubry for providing their scattering strength data for comparison with our model."
        },
        {
            "heading": "Funding Sources",
            "text": "Anna B. Stephenson acknowledges the support of the National Science Foundation (NSF) Graduate Research Fellowship Program under grant number DGE-1745303. This work was funded by BASF through the Northeast Research Alliance. This research was partially supported by NSF through the Harvard University Materials Research Science and Engineering Center under grant number DMR-2011754. In addition, this work was performed in part at the Center for Nanoscale Systems (CNS), a member of the National Nanotechnology Coordinated Infrastructure Network (NNCI), which is supported by the National Science Foundation under grant number EECS-1541959. CNS is part of Harvard University.\n31"
        },
        {
            "heading": "Graphical TOC Entry",
            "text": "For Table of Contents Use Only\nManuscript Title: Predicting the structural colors of films of disordered photonic balls\nManuscript Authors: Anna B. Stephenson, Ming Xiao, Victoria Hwang, Liangliang Qu, Paul A. Odorisio, Michael Burke, Keith Task, Ted Deisenroth, Solomon Barkley, Rupa H. Darji, Vinothan N. Manoharan\nBrief Synopsis: Diagram depicting a model for light transport in a photonic ball. At left is a simulated trajectory of light scattering in a photonic ball. The results of many simulated trajectories are used to calculate a reflectance spectrum, shown on the right (dotted line) and compared to an experimentally measured reflectance spectrum (solid line).\n38\nSupporting Information:\nPredicting the structural colors of films of\ndisordered photonic balls"
        },
        {
            "heading": "Anna B. Stephenson,\u2020 Ming Xiao,\u2020 Victoria Hwang,\u2020 Liangliang Qu,\u2021 Paul A.",
            "text": ""
        },
        {
            "heading": "Odorisio,\u2021 Michael Burke,\u2021 Keith Task,\u2021 Ted Deisenroth,\u2021 Solomon Barkley,\u00b6",
            "text": ""
        },
        {
            "heading": "Rupa H. Darji,\u2021 and Vinothan N. Manoharan\u2217,\u2020,\u00b6",
            "text": "\u2020Harvard John A. Paulson School of Engineering and Applied Sciences, Harvard\nUniversity, Cambridge, Massachusetts 02138, USA\n\u2021BASF Corporation, Tarrytown, New York 10591, (USA)\n\u00b6Department of Physics, Harvard University, Cambridge, Massachusetts 02138, USA"
        },
        {
            "heading": "E-mail: vnm@seas.harvard.edu",
            "text": "Number of pages: 27 Number of figures: 5 Number of tables: 1\nS-1\nar X\niv :2\n20 7.\n03 03\n3v 3\n[ co\nnd -m\nat .s\nof t]\n9 J\nan 2\n02 3"
        },
        {
            "heading": "1 Model details",
            "text": ""
        },
        {
            "heading": "1.1 Accounting for the spherical boundary of photonic balls",
            "text": "In applying the modeling scheme from Hwang and colleaguesS1 to a photonic ball, we must augment the model to account for the boundary conditions of the ball.\nFirst, we must use a different algorithm to determine whether a photon packet has left the photonic ball. Instead of checking their position in z, which would tell us their depth in the film, we must check their radial position from the center of the photonic ball. Photon packets that have attempted to exit the photonic ball have trajectories that satisfy the equation below at some time step:\nx2 + y2 + (z \u2212 radius)2 > radius2, (1)\nwhere x, y, and z are the global positions of the photon packet, and \u201cradius\u201d is the radius of the photonic ball. The subtraction of the radius from z is a result of the definition of our coordinate system, where the center of the sphere is found at the point x = 0, y = 0, z = radius.\nThese photon packets are said to have attempted an exit because satisfying this equation alone is not enough to determine that they have exited. Owing to their angle of exit, they may have been totally internally reflected back into the ball.\nWe check for this internal reflection by finding the angle between the photon packet\u2019s trajectory and the vector normal to the ball surface and applying Snell\u2019s law. To find the normal vector, we analytically solve for the intersection between the line of the photon\u2019s trajectory and the sphere surface at the photon packet exit. The solution is found by solving a system of parametric equations. The equation for a 3-dimensional line in parametric form\nS-2\nis given by:\nx = x0 + (x1 \u2212 x0)t, y = y0 + (y1 \u2212 y0)t, z = z0 + (z1 \u2212 z0)t,\n(2)\nwhere the line is parameterized by t, and (x0, y0, z0) is the point on the photon packet\u2019s trajectory just before the attempted exit takes place. The point (x1, y1, z1) is the photon packet\u2019s position just after the attempted exit. Substituting this line equation into the equation of a sphere gives the quadratic equation:\ndt2 + ft+ g = 0, (3)\nwhere d = k2x + k 2 y + k 2 z ,\nf = 2(kxx0 + kyy0 + kzz0), g = x20 + y 2 0 + z 2 0 \u2212 radius2,\n(4)\nwhere we define a vector k for the trajectory\u2019s propagation direction at the attempted exit,\nk = (x1 \u2212 x0) + (y1 \u2212 y0) + (z1 \u2212 z0), (5)\nand the solution for t is\nt = (\u2212f \u00b1 \u221a f 2 \u2212 4dg)/(2d). (6)\nWe can express the trajectory-sphere intersection point as\nxint = x0 + tkx,\nyint = y0 + tky,\nzint = z0 + tkz,\n(7)\nwhere (xint, yint, zint) is the photon\u2019s exit point on the ball\u2019s surface. Since t has two solutions,\nS-3\nleading to two intersection points, we take only the point that is closest to the photon packet\u2019s position after exit. We take the dot product between the photon packet\u2019s exit vector and the normal vector to find the angle at which the photon packet attempts to exit:\nn1 sin \u03b81 = n2 sin \u03b82, (8)\nwhere n1 is the effective refractive index of the photonic ball, and n2 is the effective refractive index of the surrounding matrix, and \u03b81 and \u03b82 are the angles from the normal before and after refraction.\nMany photon packets, however, are not totally internally reflected, and at least some portion of their weight exits the photonic ball. When calculating the reflectance of an individual photonic ball, we must determine which photon packets exit into the reflection hemisphere. This requires that we accurately calculate the photon packet direction after exit, so we must include the direction change due to refraction by rotating k, the vector that describes the propagation direction. We perform this rotation using a matrix that rotates a vector about an arbitrary axis.S2 The axis about which we rotate k is the cross product of k and the normal vector of the sphere surface at the photon packet\u2019s exit position. We refer to k before rotation as \u3008kx,1, ky,1, kz,1\u3009 and the exit point on the ball\u2019s surface as (a, b, c). The angle about which we are rotating is \u03b1 = \u2212(\u03b82 \u2212 \u03b81).\nTo perform this rotation, we must first express a point on the line in the direction of the\ninitial k: x = a+ kx,1,\ny = b+ ky,1,\nz = c+ kz,1.\n(9)\nS-4\nThen, we can perform the rotation, multiplying the vector \u3008x, y, z\u3009 by the rotation matrix:\nxrot = (a(v 2 + w2)\u2212 u(bv + cw \u2212 ux\u2212 vy \u2212 wz))(1\u2212 cos(\u03b1))\n+ x cos(\u03b1) + (\u2212cv + bw \u2212 wy + vz) sin(\u03b1),\nyrot = (b(u 2 + w2)\u2212 v(au+ cw \u2212 ux\u2212 vy \u2212 wz))(1\u2212 cos(\u03b1))\n+ y cos(\u03b1) + (cu\u2212 aw + wx\u2212 uz) sin(\u03b1),\nzrot = (c(u 2 + v2)\u2212 w(au+ bv \u2212 ux\u2212 vy \u2212 wz))(1\u2212 cos(\u03b1))\n+ z cos(\u03b1) + (\u2212bu+ av \u2212 vx+ uy) sin(\u03b1),\n(10)\nwhere \u3008u, v, w\u3009 is the unit direction vector of the normal at the exit point. Then we convert back to a vector: kx,2 = xrot \u2212 a,\nky,2 = yrot \u2212 b, kz,2 = zrot \u2212 c,\n(11)\nwhere \u3008kx,2, ky,2, kz,2\u3009 is the rotated k.\nWe also calculate the Fresnel reflection at the entrance and exit. For both the entrance and exit, we use the method described above to calculate the angle between a photon packet\u2019s trajectory and the ball\u2019s normal vector at the position of entrance into the ball or exit from the ball. Using the angle of incidence, we then calculate the Fresnel coefficients to determine the fraction of photon-packet weight that successfully enters the photonic ball in the first time step, as well as the fraction of photon packet weight that is internally reflected back into the photonic ball upon an attempted exit. Some of these photons are totally internally reflected, meaning that their full weight is reflected back into the photonic ball."
        },
        {
            "heading": "1.2 Splitting photon packets at the ball boundary",
            "text": "Finally, we have to handle the photon packets that are partially or totally internally reflected upon an attempted exit, as well as any photon packets that are still scattering inside the ball.\nS-5\nWe split packets into two components when they exit, where the weights of these packets are assigned according to their corresponding Fresnel coefficient. We then use a recursive process to simulate the scattering of these new photon packets. The reflected photon packet directions are calculated by performing a reflection of k off of the plane tangent to the sphere surface at the position of the photon packet exit:\nkr = k1 \u2212 2(k1 \u00b7 n\u0302)n\u0302. (12)\nThe Monte Carlo simulation steps described in the text are repeated, and we recursively simulate new trajectories within each simulation run until the total photon weights inside the sample is no larger than 1% of the original weights. The remaining weights are distributed equally between reflection and transmission:\nRextra = 0.5Wstuck,\nTextra = 0.5Wstuck,\n(13)\nwhere Rextra is the extra reflectance, Textra is the extra transmittance, and Wstuck is the normalized sum of the trajectory weights stuck inside the photonic ball.\nUsing this method, we calculate the total reflectance and transmittance for a single photonic ball, as well as the reflectance per original photon packet and the transmittance per original photon packet."
        },
        {
            "heading": "1.3 Photonic-ball phase function calculation",
            "text": "To calculate the distribution of directions, or phase function, for the photonic ball, we first assign an angle to each photon packet by finding the position on the ball\u2019s surface where each photon packet exits. In our recursive method of calculating the reflectance and transmittance per photon packet, we don\u2019t track the exit positions of all of the additional photon packets that are split from the initial photon packet. Instead, we add up the exit weights of any\nS-6\nphoton packets that derived from one original packet and associate that full weight with the exit position of the originating photon. The assumption behind this procedure is that the distribution of initial exit positions is representative of the distributions of exits of the photon packets produced from the splitting at the boundary.\nIn assigning an angle to each photon packet, we use the angle of the exit position on the surface rather than the exit direction, which enforces an assumption that the photon packets exit normal to the sphere surface. Though the simulated photon packets do not necessarily exit the ball normal to the surface, the alternative of using the exit directions would neglect how exit positions can geometrically restrict the direction of the next scattering event. Because unpolarized scattering depends only on the scattering angle \u03b8 and not on the azimuthal angle \u03c6, we assume that the distribution of azimuthal angles is uniform, and we restrict our calculation of the photonic-ball phase function to a distribution of \u03b8 only.\nWe use kernel density estimation to produce a probability distribution of photon-packet directions. This distribution is the photonic-ball phase function. We use Silverman\u2019s rule for unequally weighted data to select the kernel bandwidth:S3\n( 3meff\n4\n)\u22121/5 , (14)\nwhere meff is the effective number of data points, defined as\nmeff = ( \u2211 wsca) 2\n\u2211 w2sca , (15)\nwhere wsca is the weight of a scattered trajectory at exit."
        },
        {
            "heading": "1.4 Computational considerations for the Monte Carlo simulations",
            "text": "We run each integrated reflectance Monte Carlo simulation for 80,000 trajectories at each wavelength. For film geometries, we run the simulations for 800 events. For photonic-ball geometries, we run the simulations for an initial 300 events. We report the initial event\nS-7\nnumber, since the simulation splits an exiting photon packet into two and continues to simulate the scattering trajectory of the internally reflected photon packet for another 300 events. These nested simulations run until the total weight of trajectories left inside the ball is less than 1% of the total initial weights. For the reflectance simulations in which we detect scattered light over a small range of angles, we increase the trajectory number to 300,000 since only a small fraction of these trajectories encounter the detector.\nWe characterize the uncertainty by analyzing the results of 5 runs using the parameters of our green photonic-ball-film sample. We calculate the total weight percent of trajectories left inside the photonic-ball films after 800 events, finding a mean of 9.78\u00d7 10\u22126 % and standard deviation 2.06\u00d7 10\u22125 % across the 41 wavelengths and 5 runs. To calculate an uncertainty for the reflectance values, we calculate the standard deviation in reflectance across the 5 runs at each wavelength, and then take the mean across the spectrum. This spectrum-averaged standard deviation for the green photonic-ball film is 0.0775 %, well below the measurement uncertainty in our samples. Performing the same calculation for the photonic balls that compose the film yields a spectrum-averaged standard deviation of 0.127 %.\nThese simulations are run on Harvard\u2019s Cannon high-performance computing cluster, on a single core using a maximum memory of 119.4 GB with an average clock speed of 1.1 GHz. A typical simulation with the above simulation parameters and these computational parameters takes about 12 min per wavelength. We choose the trajectory number of 80,000 and the large limit of requested CPU memory to lower uncertainty values while maximizing simulation speed. However, using a high-performance computing cluster and such high trajectory-event numbers is not necessary to obtain spectra with uncertainty less than measurement uncertainty. To demonstrate this point, we also run quicker simulations with the parameters of our green photonic-ball-film sample. We run each simulation for 1,000 trajectories and 100 events for photonic-ball and film geometries. For the individual photonic-ball simulation, the total weights of stuck photon packets is still less than 1% of the incident photon packet weights, because this number is a set threshold. The mean weight\nS-8\npercentages across 41 wavelengths and 5 runs of photon packets left inside the photonic-ball films after 100 events is 5.75\u00d7 10\u22126 \u00b1 2.9\u00d7 10\u22125 %. These percentages are within the same order of magnitude as for the case of 800 events, suggesting that for these sample parameters, 100 events is sufficient, and increasing the event number to 800 offers no clear improvement. The spectrum-averaged standard deviation in photonic-ball-film reflectance across 5 runs at each wavelength is 0.705 %, and the spectrum-averaged standard deviation in photonic-ball reflectance is 1.01 %. Running on a 2.4 GHz core on a machine with 8 GiB of RAM, the simulations took a mean of 2.24 s per wavelength."
        },
        {
            "heading": "2 CIELAB colorspace calculations",
            "text": "From our spectra, we calculate color coordinates that can then be used to display colors on a screen or calculate the CIE 1976 color difference, which characterizes the perceived differences between colors. We calculate the CIELAB color coordinates L\u2217, a\u2217, and b\u2217 and the RGB color coordinates using the method described by Xiao and colleagues,S4 where the calculations are performed using the ColorPy Python package.S5 The CIE 1976 color difference is calculated asS6\n\u2206 = \u221a\n(L\u22171 \u2212 L\u22170)2 + (a\u22171 \u2212 a\u22170)2 + (b\u22171 \u2212 b\u22170)2, (16)\nwhere (L\u22170, a\u22170, b\u22170) and (L\u22171, a\u22171, b\u22171) are coordinates for two colors."
        },
        {
            "heading": "3 Sample parameter measurement and estimation",
            "text": ""
        },
        {
            "heading": "3.1 Photonic ball parameter measurement and estimation",
            "text": "We perform SEM imaging to characterize the photonic balls and to determine the average photonic-ball diameter and nanopore diameter. Samples of each photonic ball size are loaded\nS-9\nonto a conductive carbon tape and sputtered with a platinum layer of 1 nm in thickness prior to imaging. The images are obtained on a JEOL cold cathode Field Emission Scanning Electron Microscope in low detector LEI mode. We measure the mean photonic-ball diameter and polydispersity using ImageJ image analysis software, where 50\u201370 photonic balls are measured. The mean nanopore diameter and standard deviation are measured similarly by analyzing 50\u201370 nanopores across several photonic balls. For the blue photonic balls, made with a 250 nm poly(methyl methacrylate) template, we measure a mean nanopore diameter of (208\u00b1 10) nm and a mean photonic ball diameter of (16.1\u00b1 2.4) \u00b5m. For the green photonic balls, made with a 332 nm poly(methyl methacrylate) template, we measure a mean nanopore diameter of (265\u00b1 5) nm and a mean photonic ball diameter of (17.8\u00b1 2.7) \u00b5m. For the red photonic balls, made with a 402 nm poly(methyl methacrylate) template, we measure a mean nanopore diameter of (338\u00b1 12) nm and a mean photonic ball diameter of (16.3\u00b1 3.3) \u00b5m. We adjust the nanopore and photonic-ball diameters that we input into the model within a standard deviation of the mean to fit the model to the data.\nBecause nanopore volume fraction is difficult to measure using SEM, we estimate the volume fraction within a range of reasonable values. Collective jamming of hard spheres is thought to occur at volume fractions as low as around 0.49, and the maximum randomly jammed state occurs at a volume fraction around 0.64.S7 We therefore restrict the nanopore volume fraction estimates to this range. The nanopore volume fraction primarily affects the reflectance peak width and, to a certain extent, the peak position. We therefore adjust the volume fraction within the range to improve agreement with data in the reflectance peak width and position.\nThe photonic balls in our samples have a matrix of silica. We estimate the real part of the refractive index using the Sellmeier dispersion formula with parameters that were fit to experimental data for fused silica.S8 Measurements of the imaginary refractive index of fused silica in the visible wavelength range yield values ranging from roughly 7\u00d7 10\u22128 to 1\u00d7 10\u22127.S9 For simplicity, we use the midpoint between these estimated limits, 8.5\u00d7 10\u22128.\nS-10\nUsing such an estimate is reasonable since these values are several orders of magnitude lower than the imaginary index contribution from the carbon black in our samples. Because the nanopores are assumed to contain only air, we use a real refractive index of 1.\nThe fine roughness in our model accounts for wavelength-scale roughness on the sample surface which leads to a breakdown in effective-medium theory at the sample interface. Because of its small scale, the fine roughness is difficult to measure, and we therefore adjust the fine roughness parameter between 0 and 1 to best fit the data. However, we do not fit the values for each individual sample. Instead, we fit the values to all samples fabricated with the same method under the same conditions, since we expect the fine roughness values to depend largely on the drying and packing processes that occur during sample assembly. Because the fine roughness primarily affects the magnitude of the off-peak reflectance, we adjust the value to produce good agreement between the predicted and measured off-peak reflectance magnitudes. This method of empirically determining the roughness parameter for a given sample fabrication protocol can then be used to design specific colors made with that protocol.\nWhen the sample preparation protocol is not known, we have no means to determine the roughness parameters. In future work, we could address this problem by using a more comprehensive model for the transition of refractive index from the medium to the sample, such as the one developed by Han and coworkers.S10"
        },
        {
            "heading": "3.2 Photonic-ball film parameter measurement and estimation",
            "text": "We also measure or estimate the photonic-ball film properties that are input into our model. To measure the thickness of the photonic-ball film, we first use a micrometer to measure the thickness of the two glass slides used to make the sample chamber. After preparing the film sample, we use a micrometer to measure the total thickness of the sample including the glass slides. We perform each thickness measurement 3\u20135 times across the sample surface. To find the thickness of the photonic-ball film, we subtract the thickness of the two glass slides from\nS-11\nthe total sample thickness. We find thicknesses of (227\u00b1 5) \u00b5m for the blue film, 200 \u00b5m for the green film, and (195\u00b1 5) \u00b5m for the red film. We adjust the parameter values used in the simulations within a standard deviation about the mean.\nSince the photonic-ball film is held in place by compression between two glass slides, we assume the photonic balls are in a jammed packing in the photonic-ball film. To find the photonic-ball volume fraction, we therefore restrict our inputs to a range of reasonable values as described in Section 3.1. Since the photonic-ball volume fraction primarily affects the predicted reflectance magnitudes across the spectrum, we use a value that results in a broadband reflectance magnitude close to that of the data.\nTo obtain the refractive index of the matrix surrounding the photonic balls, we perform a calculation based on the carbon black and silica parameters. Owing to the small weight of carbon black added (3 % w/w), we ignore the contribution of the real refractive index of carbon black. We assume that the real component of the matrix refractive index is 1, since the photonic balls are surrounded by only air and carbon black. The carbon black used is a suspension of carbon black nanoparticles in a water and glycerin mixture (Covarine Black WS 9199, Sensient Cosmetic Technologies). The reported density of the carbon black in the suspension is 1.7 g/mL, the reported size is 1 nm to 100 nm, and the reported concentration is 25 % w/w. We use an imaginary index of 0.44 for carbon black, which is commonly used in the literature.S11,S12 We use these values, combined with the volume fraction of the film matrix, the total film weight, and total film volume to calculate the volume fraction of carbon black in the film matrix. We then multiply this carbon black volume fraction by the imaginary index of carbon black (0.44) to obtain the imaginary index of the photonic-ball-film matrix.\nWe also specify the incident illumination and detection angles in our model. The incident illumination angle is the angle between the light source and the vector normal to the film plane. We use a value of 8\u00b0, which is the angle of the sample port of the integrating sphere. We assume that the entire reflection hemisphere is captured by the detector, as is expected for integrating sphere measurements. We therefore set the detection angle range to 90\u00b0\u2013180\u00b0.\nS-12\nBecause our films are between two glass slides, we also account for the Fresnel reflections due to air-glass and sample-glass interfaces, using a measured wavelength-dependent refractive index for soda-lime glass.S13\nBecause the coarse roughness parameter slightly affects the magnitude of the reflectance across the spectrum, we set the value to produce good agreement between the predicted and measured reflectance magnitudes. We use the same coarse roughness parameter for our three samples, since each film is fabricated using the same technique, and we expect the sample interface shape to depend largely on the pressure and shape of the interface enforced by the glass slides."
        },
        {
            "heading": "3.3 Estimation of parameters of samples from literature",
            "text": "We generate predicted reflectance spectra for the photonic balls from Ref. S14 (Fig. 3 of the main text), starting with input parameters equal to the reported measured values for nanopore size, photonic-ball size, and matrix refractive index. We adjust the nanopore and photonic-ball diameters to achieve agreement with reflectance peak positions in the data, and our parameters fall within two standard deviations of the measured values. The photonic ball consists of air nanopores embedded in a matrix made from an amphiphilic bottlebrush block copolymer, P(PS-NB)-b-P(PEO-NB). We use the estimated refractive index of 1.52 reported by Zhao and colleagues,S14 which does not include dispersion. We adjust the volume fraction using the same method described in Sections 3.1 and 3.2. We adjust the fine roughness value, which primarily affects the off-peak reflectance, to reproduce the measured off-peak reflectance values, using the same fine roughness value (0.01) for the three samples. Because these measurements are taken through a microscope, the reflectance measured does not capture the entire reflection hemisphere. An angular detection range of 120\u00b0 results in good agreement with the data. The illumination angle is set according to the experimental details of the setup, where the illumination angle is limited by the numerical aperture of the objective used (Zeiss, W N-Achroplan, 63\u00d7, NA 0.9). Since the objective is immersed in water, this\nS-13\nNA gives a maximum illumination angle of 43\u00b0.\nFor the photonic-ball films from Ref. S15 (Fig. 4b of the main text), we adjust input parameters within reasonable uncertainty estimates of measured values. The reported hydrodynamic diameters from dynamic light scattering are 280 nm (green) and 360 nm (red). We use 218 nm and 288 nm in our model, which are within 25% of the mean hydrodynamic diameters. Smaller values for optical diameters are expected, because hydrodynamic diameters are often larger than optical diameters. In these samples, carbon black is added during the photonic ball assembly. Therefore, some of the carbon black may be located inside the photonic balls, and some in the film matrix, outside the photonic balls. We treat the sample imaginary index and the relative amounts of carbon black inside and outside the photonic ball as fitting parameters. The best-fit carbon black concentrations are proportional to carbon black concentration, which indicates they are physically reasonable (Fig. S2). We use an illumination angle of 8\u00b0, as specified by the authors. Since these measurements are taken using an integrating sphere, we include reflectance contributions from the entire reflection hemisphere. We also simulate the Fresnel reflections at the interface of the substrate, a glass slide, using a measured wavelength-dependent refractive index for soda-lime glass.S13 Because the same assembly techniques are used across the eight samples shown (Fig. 4b of the main text), we use the same coarse roughness parameter for each sample. We use the same fine roughness parameters for all of the samples, except for the two samples that do not contain carbon black. Because the presence of the carbon black nanoparticles could influence the packing behavior of the silica nanoparticles, a different fine roughness is expected for these samples.\nS-14"
        },
        {
            "heading": "4 Calculations involving absorbers",
            "text": ""
        },
        {
            "heading": "4.1 Absorber volume in samples",
            "text": "For the simulations shown in Fig. 5 of the main text, we keep the total volume of carbon black constant across the simulations for the nanopore film and the photonic-ball film. We choose to keep the carbon black volume constant, rather than the effective imaginary refractive index, because the total volumes of the samples are not equal. If we were to keep the effective imaginary refractive indices constant, we would find a significantly smaller absorption contribution in the nanopore film, because it has a significantly smaller sample thickness. In this case, keeping the volume constant in the two samples allows us to compare them more easily. When the absorber is in the photonic-ball-film matrix, we use the equation\nVcb = ni, PB-film matrix(1\u2212 \u03c6ball)\nni,cb tA, (17)\nwhere Vcb is the volume of carbon black in the sample, ni, PB-film matrix is the imaginary refractive index of the photonic-ball-film matrix, \u03c6ball is the volume fraction of photonic balls in the film, the imaginary index of the carbon black is ni,cb = 0.44,S11,S12 t is the sample thickness, and A is an arbitrary sample area. When the absorber is placed in the photonic-ball matrix, we use the equation\nVcb = ni, PB matrix(1\u2212 \u03c6)\nni,cb tA, (18)\nwhere ni, PB matrix is the imaginary refractive index of the photonic-ball matrix and \u03c6 is the volume fraction of nanopores or nanoparticles. When the absorber is placed in the nanopores or nanoparticles, we use the equation\nVcb = ni, np\u03c6\nni,cb tA, (19)\nS-15\nwhere ni, np is the imaginary refractive index of the nanopores or nanoparticles."
        },
        {
            "heading": "4.2 Effective imaginary indices",
            "text": "For the simulations shown in Fig. 7 of the main text, we keep the effective, sample imaginary refractive indices constant across samples with the broadband absorber placed in the three locations: the photonic-ball-film matrix, the photonic-ball matrix, and the nanopores. For this set of simulations, keeping the imaginary refractive indices constant (rather than the total volume of carbon black) allows a more fair comparison since the samples each have the same total volume. However, we must be careful when comparing refractive indices across samples where the absorber is placed in these different locations. When the absorber is placed inside the photonic ball, either in the photonic-ball matrix or the nanopores, we use the Bruggeman weighted average to calculate an effective index for the photonic balls, which takes into account the nanopore volume fraction and the complex refractive indices of the photonic-ball matrix and nanopores.S16 We take the imaginary component of this index and then multiply by the volume fraction of photonic balls in the film to approximate a refractive index for the entire sample:\nni, sample = Im(nbruggeman)\u03c6ball, (20)\nwhere nbruggeman is the refractive index calculated using the Bruggeman weighted average, and \u03c6ball is the volume fraction of photonic balls in the film.\nWhen the absorber is in the photonic-ball-film matrix, we specify an imaginary component of the refractive index and then multiply by the total volume fraction of matrix material surrounding the photonic balls:\nni, sample = ni,PB-film matrix(1\u2212 \u03c6ball), (21)\nwhere ni,PB-film matrix is the imaginary refractive index of the photonic-ball-film matrix. Be-\nS-16\nlow, we report the imaginary refractive indices used as inputs to the model for each of the simulations shown in Fig. 7 of the main text, and we also list their corresponding effective, sample imaginary indices, which we keep constant across the simulations for different absorber locations:\nTable S1: Imaginary index values for Fig. 7 of the main text\nni, sample ni, PB-film matrix ni, PB matrix ni, nanopore\n8.25\u00d7 10\u22125 1.65\u00d7 10\u22124 3.83\u00d7 10\u22124 2.86\u00d7 10\u22124 2.06\u00d7 10\u22124 4.12\u00d7 10\u22124 9.58\u00d7 10\u22124 7.15\u00d7 10\u22124 3.30\u00d7 10\u22124 6.59\u00d7 10\u22124 1.53\u00d7 10\u22123 1.14\u00d7 10\u22123 4.53\u00d7 10\u22124 9.06\u00d7 10\u22124 2.11\u00d7 10\u22123 1.57\u00d7 10\u22123 5.77\u00d7 10\u22124 1.15\u00d7 10\u22123 2.68\u00d7 10\u22123 2.00\u00d7 10\u22123"
        },
        {
            "heading": "5 Additional results",
            "text": "Fig. S1 shows comparison between measurements and various model predictions for additional samples, and Fig. S2 shows the linear relationship between the sample\u2019s carbon black concentration and the sample\u2019s imaginary index for the imaginary indices input into simulations shown in Fig. 4b of the main text."
        },
        {
            "heading": "6 Investigating the effective-medium approximation",
            "text": "The use of effective-medium theory for materials with refractive indices on the order of the wavelength of light is an active area of research and deserves some discussion as it relates to our model. For low index-contrast samples, such as polystyrene particles in water, effectivemedium theory is normally not needed to accurately predict scattering properties.S17,S18 However, as index contrast increases, such as in samples of polymers in air, an effectivemedium approximation can improve predictions of the scattering resonances. To illustrate\nS-17\nFigure S1: Additional model comparisons for a photonic-ball film and a single photonic ball. Top: Measured reflectance data (solid line) for a photonic-ball film and predicted reflectance spectra (dashed lines) for various geometries of our Monte Carlo models for a sample from Ref. S15. The measured reflectance and photonic-ball film model reflectance are also shown in Fig. 4b of the main text, and the model parameters are listed in the corresponding caption. For the nanoparticle film, the film thickness is multiplied by the volume fraction of photonic balls so that the volume of scattering material is the same as in the photonic-ball film models: thickness = 200 \u00b5m \u00d7 0.55 = 110 \u00b5m. The imaginary refractive index for the matrix of the nanoparticle film is 3.997\u00d7 10\u22124. This imaginary index is chosen to keep the volume the same across the models for the nanoparticle film and photonic-ball film. Other parameters are shared between the simulations and are listed in the caption of Fig. 4b of the main text. Bottom: Measured reflectance data (solid line) for an individual photonic ball and predicted reflectance spectra (dashed lines) for two geometries of Monte Carlo models for an individual photonic ball sample from Ref. S14. The measured reflectance and photonic-ball film model reflectance are also shown in Fig. 3b of the main text, and the model parameters are listed in the corresponding caption.\nS-18\nFigure S2: Imaginary index increases linearly with carbon black concentration. Plot shows the best-fit imaginary index for the green samples (stars) and purple samples (circles) for the samples from Ref. S15, with reflectance spectra plotted against our model in Fig. 4b of the main text. The dashed line shows a least-squares fit for the purple samples, with equation ni = 7.79\u00d7 10\u22124 [cb], where ni is the imaginary index and [cb] is the concentration of carbon black. The plotted ni values combine the carbon black concentrations in the photonic-ball matrix with those in the photonic-ball-film matrix by weighting them according to volume fraction and adding the two values. For the green samples, the ni values for the photonicball matrix are, from darkest to lightest color: 1\u00d7 10\u22126 , 4\u00d7 10\u22126 , 3\u00d7 10\u22126 , 0, and the ni values for the photonic-ball-film matrix are 2.8\u00d7 10\u22123 , 9.7\u00d7 10\u22124 , 4.1\u00d7 10\u22124 , 0. For the purple samples, the ni values for the photonic-ball matrix are, from darkest to lightest color: 1.2\u00d7 10\u22124 , 3.7\u00d7 10\u22125 , 3\u00d7 10\u22126 , 0, and the ni values for the photonic-ball-film matrix are 2.83\u00d7 10\u22123 , 9.7\u00d7 10\u22124 , 4.15\u00d7 10\u22124 , 0.\nS-19\nhow the Bruggeman effective-medium theory, which we use in our model, affects the prediction of scattering resonances and scattering strength, we compare the scattering strength predicted by our model to data on scattering strength as a function of size parameter for polystyrene particles in air. The scattering strength is defined as 1/l\u2217, where l\u2217 is the transport length. These data are from Fig. 4 of Ref. S19 and from Ref. S20.\nWithout effective-medium theory, the calculation overestimates the scattering strength by up to a factor of 4 (Fig. S3a); also, the peaks in the scattering strength, corresponding to resonances, do not align with those in the data. Next, we use the Bruggeman effectivemedium approximation in only the structure factor, which allows us to account for the effect of the phase delay as described in recent work by Yazhgur and colleagues.S21 This approach helps to align the resonances with those of the data, but the magnitudes of the scattering strength are still overestimated (Fig. S3b). Finally, we show the results of including the effective-medium in both the form and structure factor, as is the case in our model (Fig. S3c). Although the effective-medium approach underestimates the scattering strength, it aligns the resonances with the data for the size parameters we are interested in (roughly less than 0.5) and also gives a closer magnitude for the scattering strength. These calculations show that the use of the Bruggeman effective index for the form and structure factor matches more closely to data than the other options for samples with an index contrast corresponding to polystyrene in air. Moreover, we note that many researchers have successfully used effectivemedium theories to predict scattering properties of materials in this intermediate refractive index regime.S1,S22,S23\nTo further compare these three different types of calculations, we ran the model for the samples from Zhao and colleaguesS14 shown in Fig. 3 in the text. These samples have an index contrast of roughly 0.52. We find that the peak position is predicted accurately when an effective-medium approximation is used for the structure factor only and when an effectivemedium approximation is used for both the form factor and structure factor (Fig. S4). For these measurements we choose a measurement aperture half-angle of 60\u00b0 to fit the magnitude\nS-20\nFigure S3: Measured and calculated scattering strength of polystyrene particles with radius 125 nm to 610 nm and a volume fraction of 0.5. Calculations use refractive indices corresponding to (a) polystyrene particles in air with no effective-medium approximation, (b) polystyrene particles in a Bruggeman effective medium applied to the structure-factor calculation but in air for the form-factor calculation, and (c) polystyrene particles in a Bruggeman effective medium applied to the structure-factor and form-factor calculations. Data is reproduced from Ref. S20 (red circles) and Ref. S19 (other colors).\nS-21\nof the data. Because this number is a fitting parameter, it is difficult to determine whether the second approach (effective medium for structure factor only) or third approach (effective medium for both form and structure factor) is a better approximation. However, based on the scattering strength calculations above, using the full Bruggeman approximation appears to be the best choice for an intermediate index contrast since it produces a scattering strength closer to the data.\nFor completeness, we also use the same three types of calculations to model the reflectance of the same photonic-ball samples (Fig. S5) immersed in an aqueous suspension, which lowers their index contrast to roughly 0.19. As expected, we find agreement between the measured and predicted peak locations only when we do not use effective-medium theory.\nS-22\nFigure S4: Measured (solid lines) and predicted (dotted lines) reflectance spectra for photonic balls with a primary reflectance peak in the ultraviolet, blue, and green. Measurements are from Ref. S14. Each row compares measurements to model predictions with a different sample refractive index. The model calculations for each row are top, no effective index; middle, Bruggeman effective refractive index used to calculate the structure factor only; bottom, Bruggeman effective refractive index used to calculate both the structure and form factors. The model parameters are left : nanopore radius 78 nm, photonic ball diameter 40 \u00b5m, middle: nanopore radius 103 nm, photonic ball diameter 19.9 \u00b5m, and right : nanopore radius 123 nm, photonic ball diameter 19.3 \u00b5m. All simulations use a nanopore volume fraction of 0.5, a fine roughness of 0.01, a matrix refractive index of 1.52, and a matrix and medium refractive index of 1.\nS-23\nFigure S5: Measured (solid lines) and predicted (dotted lines) reflectance spectra for photonic balls with a primary reflectance peak in the blue, green, and red. Measurements are from Ref. S14, and calculations are as described in Fig. S4. The model parameters are left : nanopore radius 78 nm, photonic ball diameter 40 \u00b5m, middle: nanopore radius 103 nm, photonic ball diameter 19.9 \u00b5m, and right : nanopore radius 123 nm, photonic ball diameter 19.3 \u00b5m. All simulations use a nanopore volume fraction of 0.5, a fine roughness of 0.01, a matrix refractive index of 1.52, and a matrix and medium refractive index corresponding to that of water.\nS-24"
        }
    ],
    "title": "Predicting the structural colors of films of disordered photonic balls",
    "year": 2023
}