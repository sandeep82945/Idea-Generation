{
    "abstractText": "Respecting the laws of thermodynamics is crucial for ensuring that numerical simulations of dynamical systems deliver physically relevant results. In this paper, we construct a structurepreserving and thermodynamically consistent finite element method and time-stepping scheme for heat conducting viscous fluids. The method is deduced by discretizing a variational formulation for nonequilibrium thermodynamics that extends Hamilton\u2019s principle for fluids to systems with irreversible processes. The resulting scheme preserves the balance of energy and mass to machine precision, as well as the second law of thermodynamics, both at the spatially and temporally discrete levels. The method is shown to apply both with insulated and prescribed heat flux boundary conditions, as well as with prescribed temperature boundary conditions. We illustrate the properties of the scheme with the Rayleigh-B\u00e9nard thermal convection. While the focus is on heat conducting viscous fluids, the proposed discrete variational framework paves the way to a systematic construction of thermodynamically consistent discretizations of continuum systems.",
    "authors": [
        {
            "affiliations": [],
            "name": "Evan S. Gawlik"
        },
        {
            "affiliations": [],
            "name": "Fran\u00e7ois Gay-Balmaz"
        }
    ],
    "id": "SP:e14ea655ad3fe5b336c0e45d72e45ac087891774",
    "references": [
        {
            "authors": [
                "T. Alboussi\u00e8re",
                "Y. Ricard"
            ],
            "title": "Rayleigh-B\u00e9nard stability and the validity of quasi-Boussinesq or quasianelastic liquid approximations",
            "venue": "Journal of Fluid Mechanics,",
            "year": 2017
        },
        {
            "authors": [
                "V.I. Arnold"
            ],
            "title": "Sur la g\u00e9om\u00e9trie diff\u00e9rentielle des des groupes de Lie de dimension infinie et ses applications \u00e0 l\u2019hydrodynamique des fluides parfaits",
            "venue": "Ann. Inst. Fourier,",
            "year": 1966
        },
        {
            "authors": [
                "D.N. Arnold"
            ],
            "title": "An interior penalty finite element method with discontinuous elements",
            "venue": "SIAM Journal on Numerical Analysis,",
            "year": 1982
        },
        {
            "authors": [
                "D.N. Arnold",
                "F. Brezzi",
                "B. Cockburn",
                "L.D. Marini"
            ],
            "title": "Unified analysis of discontinuous Galerkin methods for elliptic problems",
            "venue": "SIAM Journal on Numerical Analysis,",
            "year": 2002
        },
        {
            "authors": [
                "W. Bauer",
                "F. Gay-Balmaz"
            ],
            "title": "Towards a variational discretization of compressible fluids: the rotating shallow water equations",
            "venue": "Journal of Computational Dynamics,",
            "year": 2019
        },
        {
            "authors": [
                "A. Bormann"
            ],
            "title": "The onset of convection in the Rayleigh-B\u00e9nard problem for compressible fluids",
            "venue": "Continuum Mech. Thermodyn.,",
            "year": 2001
        },
        {
            "authors": [
                "S.C. Brenner",
                "L.R. Scott"
            ],
            "title": "The Mathematical Theory of Finite Element Methods, Third Edition, Texts",
            "year": 2008
        },
        {
            "authors": [
                "F. Brezzi",
                "L.D. Marini",
                "E. S\u00fcli"
            ],
            "title": "Discontinuous Galerkin methods for first-order hyperbolic problems",
            "venue": "Mathematical Models and Methods in Applied Sciences",
            "year": 2004
        },
        {
            "authors": [
                "S. Chandrasekhar"
            ],
            "title": "Hydrodynamic and Hydromagnetic Stability",
            "year": 1961
        },
        {
            "authors": [
                "C.J. Chapman",
                "M.R.E. Proctor"
            ],
            "title": "Nonlinear Rayleigh-B\u00e9nard convection between poorly conducting boundaries",
            "venue": "J. Fluid Mech",
            "year": 1980
        },
        {
            "authors": [
                "B. Cou\u00e9raud",
                "F. Gay-Balmaz"
            ],
            "title": "Variational discretization of simple thermodynamical systems on Lie groups, Disc",
            "venue": "Cont. Dyn. Syst. Ser",
            "year": 2020
        },
        {
            "authors": [
                "B. Cou\u00e9raud",
                "F. Gay-Balmaz"
            ],
            "title": "Variational discretization of the Navier-Stokes-Fourier system",
            "year": 2022
        },
        {
            "authors": [
                "F. Demoures",
                "F. Gay-Balmaz"
            ],
            "title": "Unified discrete multisymplectic Lagrangian formulation for hyperelastic solids and barotropic fluids",
            "venue": "J. Nonlin. Sc.,",
            "year": 2022
        },
        {
            "authors": [
                "F. Demoures",
                "F. Gay-Balmaz",
                "T.S. Ratiu"
            ],
            "title": "Multisymplectic variational integrators for nonsmooth Lagrangian continuum mechanics",
            "venue": "Forum Math. Sigma, 4,",
            "year": 2016
        },
        {
            "authors": [
                "M. Desbrun",
                "E. Gawlik",
                "F. Gay-Balmaz",
                "V. Zeitlin"
            ],
            "title": "Variational discretization for rotating stratified fluids",
            "venue": "Disc. Cont. Dyn. Syst. Series A,",
            "year": 2014
        },
        {
            "authors": [
                "C. Eldred",
                "F. Gay-Balmaz"
            ],
            "title": "Thermodynamically consistent semi-compressible fluids: a variational perspective",
            "venue": "Journal of Physics A: Mathematical and Theoretical,",
            "year": 2021
        },
        {
            "authors": [
                "A. Ern",
                "J.-L"
            ],
            "title": "Theory and Practice of Finite Elements",
            "venue": "Guermond",
            "year": 2004
        },
        {
            "authors": [
                "E.S. Gawlik",
                "P. Mullen",
                "D. Pavlov",
                "J.E. Marsden",
                "M. Desbrun"
            ],
            "title": "Geometric, variational discretization of continuum theories",
            "venue": "Physica D,",
            "year": 2011
        },
        {
            "authors": [
                "E.S. Gawlik",
                "F. Gay-Balmaz"
            ],
            "title": "A conservative finite element method for the incompressible Euler equations with variable density",
            "venue": "Journal of Computational Physics",
            "year": 2020
        },
        {
            "authors": [
                "E.S. Gawlik",
                "F. Gay-Balmaz"
            ],
            "title": "A variational finite element discretization of compressible flow, Found",
            "venue": "Comput. Math.,",
            "year": 2021
        },
        {
            "authors": [
                "E.S. Gawlik",
                "F. Gay-Balmaz"
            ],
            "title": "A structure-preserving finite element method for compressible ideal and resistive MHD",
            "venue": "Journal of Plasma Physics",
            "year": 2021
        },
        {
            "authors": [
                "E.S. Gawlik",
                "F. Gay-Balmaz"
            ],
            "title": "A finite element method for MHD that preserves energy, cross-helicity, magnetic helicity, incompressibility, and divB = 0",
            "venue": "Journal of Computational Physics",
            "year": 2022
        },
        {
            "authors": [
                "F. Gay-Balmaz"
            ],
            "title": "A variational derivation of the nonequilibrium thermodynamics of a moist atmosphere with rain process and its pseudoincompressible approximation",
            "venue": "Geophysical & Astrophysical Fluid Dynamics,",
            "year": 2019
        },
        {
            "authors": [
                "F. Gay-Balmaz",
                "H. Yoshimura"
            ],
            "title": "2017a], A Lagrangian variational formalism for nonequilibrium thermodynamics",
            "venue": "Part I: discrete systems, J. Geom. Phys.,",
            "year": 2017
        },
        {
            "authors": [
                "F. Gay-Balmaz",
                "H. Yoshimura"
            ],
            "title": "2017b], A Lagrangian variational formalism for nonequilibrium thermodynamics",
            "venue": "Part II: continuum systems, J. Geom. Phys.,",
            "year": 2017
        },
        {
            "authors": [
                "F. Gay-Balmaz",
                "H. Yoshimura"
            ],
            "title": "Variational discretization for the nonequilibrium thermodynamics of simple systems, Nonlinearity",
            "year": 2018
        },
        {
            "authors": [
                "F. Gay-Balmaz",
                "H. Yoshimura"
            ],
            "title": "2018b], A variational formulation of nonequilibrium thermodynamics for discrete open systems with mass and heat",
            "venue": "transfer, Entropy,",
            "year": 2018
        },
        {
            "authors": [
                "F. Gay-Balmaz",
                "H. Yoshimura"
            ],
            "title": "From Lagrangian mechanics to nonequilibrium thermodynamics: a variational perspective, Entropy",
            "year": 2019
        },
        {
            "authors": [
                "D. Hurle",
                "E. Jakeman",
                "E. Pike"
            ],
            "title": "On the solution of the B\u00e9nard problem with boundaries of finite conductivity",
            "venue": "Proc. R. Soc. Lond. A,",
            "year": 1967
        },
        {
            "authors": [
                "J.E. Marsden",
                "G.W. Patrick"
            ],
            "title": "Multisymplectic geometry, variational integrators and nonlinear PDEs",
            "venue": "Shkoller",
            "year": 1998
        },
        {
            "authors": [
                "Natale A",
                "C. Cotter"
            ],
            "title": "A variational H(div) finite-element discretization approach for perfect incompressible fluids",
            "venue": "IMA Journal of Numerical Analysis,",
            "year": 2018
        },
        {
            "authors": [
                "D. Pavlov",
                "P. Mullen",
                "Y. Tong",
                "E. Kanso",
                "J.E. Marsden",
                "M. Desbrun"
            ],
            "title": "Structure-preserving discretization of incompressible fluids",
            "venue": "Physica D,",
            "year": 2010
        },
        {
            "authors": [
                "F. Robinson",
                "K. Chan"
            ],
            "title": "Non-Boussinesq simulations of Rayleigh-B\u00e9nard convection in a perfect gas",
            "venue": "Phys. Fluids,",
            "year": 2004
        }
    ],
    "sections": [
        {
            "text": "Contents"
        },
        {
            "heading": "1 Introduction 2",
            "text": ""
        },
        {
            "heading": "2 Variational formulation for heat conducting viscous fluids 3",
            "text": "2.1 Insulated boundaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 2.2 Dirichlet boundary conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2.3 Associated weak formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8"
        },
        {
            "heading": "3 Structure preserving variational discretization 10",
            "text": "3.1 Discrete setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.2 Discrete variational formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 3.3 Discretization of thermodynamic fluxes . . . . . . . . . . . . . . . . . . . . . . . . . . 15 3.4 Temporal discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 3.5 Enhancements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20"
        },
        {
            "heading": "4 Numerical test 21",
            "text": ""
        },
        {
            "heading": "A Finite dimensional guiding examples 23",
            "text": "\u2217Department of Mathematics, University of Hawai\u2018i at Manoa, egawlik@hawaii.edu \u2020CNRS - LMD, Ecole Normale Supe\u0301rieure, francois.gay-balmaz@lmd.ens.fr\nar X\niv :2\n21 1.\n08 74\n5v 1\n[ m\nat h.\nN A\n] 1\n6 N\nov 2\nB Variational derivation of heat conducting viscous fluid equations 26 B.1 Lagrangian description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 B.2 Neumann boundary conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 B.3 Dirichlet boundary conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 B.4 Weak forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\nReferences 27"
        },
        {
            "heading": "1 Introduction",
            "text": "Structure preserving discretization of continuum systems, such as fluids and elastic bodies, is today widely recognized as an essential tool for the construction of numerical schemes when the long time accuracy and the respect of the balance and conservation laws of the simulated system are crucial. Such properties are especially relevant in the context of geophysical fluid dynamics for weather and climate prediction, or in the context of plasma physics.\nA well-known constructive approach to deriving such structure preserving discretizations is to exploit the variational formulation underlying the equations of motion. This formulation is deduced from Hamilton\u2019s critical action principle and provides a useful setting for both the temporal and spatial discretization steps. While variational time integrators for finite dimensional systems are today well-established (see [34] and the large series of subsequent works), spatial and spacetime discrete variational approaches for continuum systems are still undergoing foundational developments (e.g. [32, 31, 36, 14, 13, 20]).\nDespite their wide range of applicability, a main limitation of variational formulations issued from Hamilton\u2019s principle is their inability to consistently include irreversible processes in the systems. In most of the real world applications of continuum mechanics, however, such processes do have a deep impact on the dynamics. For instance, in the case of fluid dynamics, the processes of heat conduction, diffusion, viscosity, or chemical reactions, play a major role in geophysical, astrophysical, engineering and technological applications. Thermal convection occurring in the planets\u2019 oceans, atmospheres and mantles, as well as in stars, is a typical phenomenon occurring in conjunction with the process of heat transfer among others. Importantly, due to their irreversible character, such phenomena fit into the realm of nonequilibrium thermodynamics, governed by the two laws imposing constraints on the energy and entropy behavior. In order to get reliable and physically meaningful numerical solutions for such systems, it is of paramount importance to preserve these laws at the discrete level, thereby highlighting the need to extend variational discretization from reversible continuum mechanics to nonequilibrium thermodynamics.\nWe propose in this paper a first step in this direction for the case of fluid dynamics with heat conduction and viscosity. Our approach is based on a variational formulation for nonequilibrium thermodynamics that extends Hamilton\u2019s principle to include irreversibility ([25, 26, 28]). Importantly for the present work, this approach extends to the irreversible setting the well-known variational and geometric formulation of hydrodynamics on diffeomorphism groups initiated in [2]. The resulting class of schemes satisfies the two laws of thermodynamics at the fully discrete level. More precisely, the total energy is shown to be exactly preserved at the fully discrete level when the fluid is adiabatically closed, while a discrete energy balance holds in the presence of external heating. Regarding the second law, the entropy generated by the internal irreversible processes is shown to grow at each time step on each cell.\nIt turns out that the variational formulation for nonequilibrium thermodynamics yields the equations for heat conducting viscous fluids in a weak form that is quite suitable to achieve ther-\nmodynamic consistency and, at the same time, can naturally accommodate both prescribed heat flux (Neumann) or prescribed temperature (Dirichlet) boundary conditions. The variational formulation also naturally involves an internal entropy variable, helping identify the internal entropy production at the fully discrete level, which is well-known to differ from the rate of entropy change in the presence of the entropy flux.\nOur paper is structured as follows. In \u00a72 we recall the variational formulation for heat conducting viscous fluids in the insulated case ([26]) and then present the modifications needed for the treatment of a prescribed temperature or prescribed heat flux on the boundary, consistently with the variational formulation of open systems ([28]). We also give the weak formulation of the equations resulting from the variational framework. In \u00a73, following previous works on the reversible case, we carry out this variational formulation on a discrete version of the diffeomorphism group, based on a discontinuous Galerkin discretization of functions. A suitable spatially discrete version of heat conducting viscous flow is obtained for any given discrete fluid Lagrangian. A main subsequent step is the appropriate discretization of the thermodynamic fluxes, which is chosen in accordance with the considered Neumann or Dirichlet boundary conditions, and realized for the Navier-Stokes-Fourier case. It is then shown that the resulting spatial discretization satisfies the two laws of thermodynamics exactly. Thanks to its structure preserving form, the resulting finite element scheme can be followed by an energy preserving time discretization which allows satisfaction of the second law at each step on each fluid cell. Rayleigh-Be\u0301nard convection tests are carried out in \u00a74 for both prescribed temperature (Dirichlet) and prescribed heat flux (Neumann) boundary conditions, for several values of Rayleigh numbers, illustrating the predictive value and thermodynamic consistency of our scheme."
        },
        {
            "heading": "2 Variational formulation for heat conducting viscous fluids",
            "text": "We review here the variational formulation of nonequilibrium thermodynamics underlying the structure preserving discretization method that we present for heat conducting viscous fluids. This variational formulation, developed in [25, 26, 28], is an extension of the Hamilton principle which allows one to systematically include irreversible processes in the dynamics, such as friction, viscosity, heat conduction, matter transfer, or chemical reactions. Importantly for the present work, the variational formulation applies to adiabatically closed systems as well as systems exchanging heat and matter with their surroundings [28].\nWe recall in \u00a72.1 this formulation for heat conducting viscous fluids with insulated boundaries (homogeneous Neumann boundary conditions), and then present the modifications needed for the treatment of a prescribed temperature on the boundary (Dirichlet boundary conditions) or prescribed heat flux at the boundary (nonhomogeneous Neumann boundary conditions), see \u00a72.2. A weak formulation of the equation is deduced from the variational formulation in \u00a72.3 in a unified way for all boundary conditions.\nIn order to help identify the role and meaning of each variable in a simpler context, both for the adiabatically closed case and for the open case, we present in Appendix A an application of the variational formulation to an elementary finite dimensional example."
        },
        {
            "heading": "2.1 Insulated boundaries",
            "text": "The variational formulation is best expressed in the material (or Lagrangian) description since it is in this description that it is an extension of the Hamilton principle of continuum mechanics and takes its simpler form. The variational formulation in the spatial (or Eulerian) description that\nunderlies our approach is then deduced by using the fluid relabelling symmetry. A finite element spatial discretization of this \u201cLagrangian-to-Eulerian\u201d variational approach will be developed in \u00a73.\nLagrangian description. Let \u2126 \u2282 Rd, d = 2, 3, be a bounded domain with smooth boundary, Diff(\u2126) the group of diffeomorphisms of \u2126, and Diff0(\u2126) the subgroup of diffeomorphisms keeping \u2202\u2126 pointwise fixed. We denote by F(\u2126) and F(\u2126)\u2217 the spaces of functions and densities on \u2126 with sufficient regularity. We identify densities with functions, bearing in mind that the action of Diff(\u2126) on F(\u2126)\u2217 under this identification differs from the action of Diff(\u2126) on F(\u2126); see (6). In the Lagrangian description, the motion of a compressible fluid in the domain \u2126 is given by two time dependent maps, the fluid configuration map \u03d5 : [t0, t1]\u2192 Diff0(\u2126), giving the position x = \u03d5(t,X) at time t of a particle located at X at t = t0, and the entropy density S : [t0, t1] \u2192 F(\u2126)\u2217. From mass conservation, the mass density %0 \u2208 F(\u2126)\u2217 is constant in time in the Lagrangian description, %(t,X) = %0(X).\nIn the absence of irreversible processes, the entropy density is also constant in time S(t,X) = S0(X) and the equations of motion follow from the Hamilton principle\n\u03b4 \u02c6 t1 t0 L(\u03d5, \u03d5\u0307, S0, %0)dt = 0 (1)\nfor variations \u03b4\u03d5 with \u03b4\u03d5|t=t0,t1 = 0. In (1) the function L : T Diff0(\u2126) \u00d7 F(\u2126)\u2217 \u00d7 F(\u2126)\u2217 \u2192 R is the Lagrangian of the compressible fluid model, the standard expression being\nL(\u03d5, \u03d5\u0307, S, %) = \u02c6 \u2126 [1 2 %|\u03d5\u0307|2 \u2212 ( %/J\u03d5, S/J\u03d5 ) \u2212 %\u03c6(\u03d5) ] dX (2)\nwith J\u03d5 the Jacobian of \u03d5, the internal energy density, and \u03c6(x) the gravitational potential.\nFor the heat conducting viscous fluid one also needs to specify the phenomenological expressions of the viscous stress tensor and entropy flux, denoted P and JS in the Lagrangian description. The extension of Hamilton\u2019s principle (1) to heat conducting viscous fluids given in [26] involves two additional variables besides \u03d5(t) \u2208 Diff0(\u2126) and S(t) \u2208 F(\u2126)\u2217: the internal entropy density variable \u03a3(t) \u2208 F(\u2126)\u2217, whose time rate of change is the internal entropy production, and the thermal displacement \u0393(t) \u2208 F(\u2126), whose time rate of change is the temperature. The variational principle reads as follows.\nFind the curves \u03d5 : [t0, t1] \u2192 Diff0(\u2126), S,\u03a3 : [t0, t1] \u2192 F(\u2126)\u2217, and \u0393 : [t0, t1] \u2192 F(\u2126), which are critical for the variational condition\n\u03b4 \u02c6 t1 t0 [ L ( \u03d5, \u03d5\u0307, S, %0 ) + \u02c6 \u2126 (S \u2212 \u03a3)\u0393\u0307 dX ] dt = 0 (3)\nsubject to the phenomenological constraint\n\u03b4L \u03b4S \u03a3\u0307 = \u2212P : \u2207\u03d5\u0307\ufe38 \ufe37\ufe37 \ufe38\nviscosity + JS \u00b7 \u2207\u0393\u0307\ufe38 \ufe37\ufe37 \ufe38 heat conduction\n(4)\nand for variations subject to the variational constraint\n\u03b4L \u03b4S \u03b4\u03a3 = \u2212P : \u2207\u03b4\u03d5\ufe38 \ufe37\ufe37 \ufe38\nviscosity + JS \u00b7 \u2207\u03b4\u0393\ufe38 \ufe37\ufe37 \ufe38 heat conduction\n(5)\nwith \u03b4\u03d5|t=t0,t1 = \u03b4\u0393|t=t0,t1 = 0, and \u03b4\u03d5|\u2202\u2126 = 0. The critical condition of this variational formulation gives the heat conducting viscous fluid equation in the Lagrangian description, see \u00a7B.1. In (4) and (5) \u03b4L\u03b4S is the functional derivative of L with respect to S, defined as d d\u03b5 \u2223\u2223 \u03b5=0\nL(\u03d5, \u03d5\u0307, %, S + \u03b5\u03b4S) =\u00b4 \u2126 \u03b4L \u03b4S \u03b4S dX, for all \u03b4S. It is identified with minus the temperature of the fluid, denoted T = \u2212 \u03b4L \u03b4S in the Lagrangian description.\nRemark 2.1 (Structure of the variational formulation). The variational formulation (3)\u2013(5) is an extension of the Hamilton principle (1) for fluids which includes two types of constraints: a kinematic (phenomenological) constraint (4) on the critical curve and a variational constraint (5) on the variations to be considered when computing this critical curve. The two constraints are related in a systematic way which formally involves replacing the time rate of changes (here \u03a3\u0307, \u03d5\u0307, and \u0393\u0307) by the \u03b4-variations (here \u03b4\u03a3, \u03b4\u03d5, and \u03b4\u0393). More precisely, on the right hand side of (4) the two terms correspond to the dissipated power density associated to the processes of viscosity and heat conduction, with their virtual version appearing in (5). In coordinates P : \u2207\u03d5\u0307 = PAa \u2202A\u03d5\u0307a and JS \u00b7 \u2207\u0393\u0307 = (JS)A\u2202A\u0393\u0307. This setting is common to the variational formulation of adiabatically closed thermodynamic systems [25, 26] and is a nonlinear version of the Lagrange-d\u2019Alembert principle used in nonholonomic mechanics. In Appendix A we recall an application of this type of variational formulation to an elementary finite dimensional thermodynamic system for which the computation of the critical condition is straightforward and which helps explain the role and the meaning of the variables \u03a3 and \u0393.\nEulerian description. We recall here how (3)\u2013(5) can be converted to the Eulerian frame, thereby yielding the variational formulation underlying our structure preserving finite element discretization. The Eulerian versions of the variables \u03d5\u0307, %0, S,\u03a3,\u0393 are the Eulerian velocity u, mass density \u03c1, entropy density s, internal entropy density \u03c2, and thermal displacement \u03b3 given as\nu = \u03d5\u0307 \u25e6 \u03d5\u22121 \u2208 X0(\u2126), \u03c1 = (%0 \u25e6 \u03d5\u22121)J\u03d5\u22121 \u2208 F(\u2126)\u2217, s = (S \u25e6 \u03d5\u22121)J\u03d5\u22121 \u2208 F(\u2126)\u2217, \u03c2 = (\u03a3 \u25e6 \u03d5\u22121)J\u03d5\u22121 \u2208 F(\u2126)\u2217, \u03b3 = \u0393 \u25e6 \u03d5\u22121 \u2208 F(\u2126), (6)\nwhere X0(\u2126) = {u \u2208 X(\u2126) | u|\u2202\u2126 = 0} is the space of vector fields on \u2126 vanishing on the boundary. The Eulerian viscous stress tensor \u03c3 and entropy flux js are related to their Lagrangian counterparts P and JS via the Piola transformations\n\u03c3 = ((P \u00b7 \u2207\u03d5T) \u25e6 \u03d5\u22121)J\u03d5\u22121 and js = ((\u2207\u03d5 \u00b7 JS) \u25e6 \u03d5\u22121)J\u03d5\u22121, (7)\n[33]. From its relabelling symmetries, the Lagrangian L can be expressed in terms of the Eulerian variables as L(\u03d5, \u03d5\u0307, S, %0) = `(u, \u03c1, s). For the standard expression given in (2) one gets\n`(u, \u03c1, s) = \u02c6 \u2126 [1 2 \u03c1|u|2 \u2212 (\u03c1, s)\u2212 \u03c1\u03c6 ] dx. (8)\nWith relations (6) and (7), the Eulerian version of the principle (3)\u2013(5) reads as follows. Find the curves u : [t0, t1]\u2192 X0(\u2126), s, \u03c2 : [t0, t1]\u2192 F(\u2126)\u2217, and \u03b3 : [t0, t1]\u2192 F(\u2126), which are critical for the variational condition\n\u03b4 \u02c6 t1 t0 [ `(u, \u03c1, s) + \u02c6 \u2126 (s\u2212 \u03c2)Dt\u03b3 dx ] dt = 0, (9)\nwith the phenomenological constraint and variational constraint given by\n\u03b4` \u03b4s D\u0304t\u03c2 = \u2212\u03c3 : \u2207u\ufe38 \ufe37\ufe37 \ufe38\nviscosity + js \u00b7 \u2207(Dt\u03b3)\ufe38 \ufe37\ufe37 \ufe38 heat conduction , (10)\n\u03b4` \u03b4s D\u0304\u03b4\u03c2 = \u2212\u03c3 : \u2207v\ufe38 \ufe37\ufe37 \ufe38\nviscosity + js \u00b7 \u2207(D\u03b4\u03b3)\ufe38 \ufe37\ufe37 \ufe38 heat conduction , (11)\nand the Euler-Poincare\u0301 constraints\n\u03b4u = \u2202tv + [u, v], \u03b4\u03c1 = \u2212div(\u03c1v), (12)\nsee [26] for details. Here v = \u03b4\u03d5 \u25e6 \u03d5\u22121 : [t0, t1] \u2192 X0(\u2126) and \u03b4\u03b3 : [t0, t1] \u2192 F(\u2126) are arbitrary curves with v|t=t0,t1 = 0 and \u03b4\u03b3|t=t0,t1 = 0, and \u03b4s, \u03b4\u03c2 : [t0, t1]\u2192 F(\u2126)\u2217. In (9)\u2013(11) we have used the following notations for the Lagrangian derivatives and variations of functions f and densities g:\nDtf = \u2202tf + u \u00b7 \u2207f D\u03b4f = \u03b4f + v \u00b7 \u2207f D\u0304tg = \u2202tg + div(gu) D\u0304\u03b4g = \u03b4g + div(gv),\n(13)\nwhere v = \u03b4\u03d5 \u25e6 \u03d5\u22121 and u = \u03d5\u0307 \u25e6 \u03d5\u22121. By applying the variational principle (9)\u2013(12), we get the equations for a compressible heat conducting viscous fluid with Lagrangian `(u, \u03c1, s) (\u2202t + \u00a3u) \u03b4` \u03b4u = \u03c1\u2207 \u03b4` \u03b4\u03c1 + s\u2207 \u03b4` \u03b4s + div \u03c3 \u2212 \u03b4` \u03b4s (D\u0304ts+ div js) = \u03c3 :\u2207u+ js \u00b7\u2207 \u03b4` \u03b4s\nD\u0304t\u03c1 = 0,\n(14)\nwith \u00a3u the Lie derivative of one-form densities, together with the conditions\nDt\u03b3 = \u2212 \u03b4`\n\u03b4s , D\u0304t\u03c2 = D\u0304ts+ div js, and js \u00b7 n = 0 on \u2202\u2126, (15)\nsee \u00a7B.2 for details on the derivation. We have used the functional derivatives of `, defined as d d\u03b5 \u2223\u2223 \u03b5=0 `(u + \u03b5\u03b4u, \u03c1, s) = \u00b4 \u2126 \u03b4` \u03b4u \u00b7 \u03b4udx, etc. Since \u2212 \u03b4` \u03b4s is identified with the temperature T , the first condition in (15) implies that the variable \u03b3 is the thermal displacement. From the second condition it follows that D\u0304t\u03c2 is the rate of internal entropy production, which must be positive by the second law of thermodynamics, namely\nD\u0304t\u03c2 = D\u0304ts+ div js \u2265 0. (16)\nThe last condition in (15) is the insulated boundary condition. We refer to [23, 16, 24] for the use of this type of variational formulation for modelling purposes in nonequilibrium thermodynamics.\nStandard Lagrangian. By using the Lagrangian for Euler fluids given in (8) one gets \u03b4`\u03b4u = \u03c1u, \u03b4` \u03b4\u03c1 = 1 2 |u| 2\u2212 \u2202 \u2202\u03c1 \u2212\u03c6, and \u2212 \u03b4` \u03b4s = \u2202 \u2202s = T > 0 the temperature, so that the fluid momentum equation and the entropy equation in (14) take the usual form\n\u03c1(\u2202tu+ u \u00b7 \u2207u) = \u2212\u03c1\u2207\u03c6\u2212\u2207p+ div \u03c3, T (D\u0304ts+ div js) = \u03c3 :\u2207u\u2212 js \u00b7\u2207T\nwith p = \u2202 \u2202\u03c1\u03c1+ \u2202 \u2202ss\u2212 the pressure.\nEnergy and entropy balances. Defining the total energy E = \u2329 \u03b4` \u03b4u , u \u232a \u2212 `(u, \u03c1, s), from (14) and the boundary conditions u|\u2202\u2126 = 0 and js \u00b7 n = 0 we directly get the energy conservation\nd dt E = \u02c6 \u2126 div ( \u03c1 \u03b4` \u03b4\u03c1 u+ s \u03b4` \u03b4s u+ \u03c3 \u00b7 u+ js \u03b4` \u03b4s ) dx = 0. (17)\nFrom now on we will focus on the Navier-Stokes-Fourier case with the phenomenological relations\n\u03c3 = \u03c3(u) = 2\u00b5Def u+ \u03bb(div u)\u03b4, with \u00b5 \u2265 0 and \u03b6 = \u03bb+ 2 d \u00b5 \u2265 0\njs = js(T ) = \u2212 1\nT \u03ba\u2207T, with \u03ba \u2265 0.\n(18)\nHere Def u = 12(\u2207u +\u2207u T) is the rate of deformation tensor, \u00b5 \u2265 0 and \u03b6 = \u03bb + 2d\u00b5 \u2265 0 are the shear and bulk viscosity coefficients, and \u03ba \u2265 0 is the thermal conductivity coefficient. The signs of the coefficients are imposed by the second law of thermodynamics D\u0304ts+ div js \u2265 0 . Indeed, with (18), the entropy equation reads\nD\u0304ts+ div js = 1 T \u03c3 :\u2207u\u2212 1 T js \u00b7\u2207T = 2\u00b5 T (Def u)(0) : (Def u)(0) + \u03b6 T (div u)2 + \u03ba T 2 |\u2207T |2 \u2265 0, (19)\nwhere (Def u)(0) denotes the trace-free part of Def u. For simplicity, in this paper we will assume that these coefficients are constant.\nThe discretization that we will develop preserves both the energy conservation (17) and the positivity of the rate of internal entropy production (19)."
        },
        {
            "heading": "2.2 Dirichlet boundary conditions",
            "text": "We present here a modification of the variational formulation which allows the treatment of a fluid with prescribed temperature on the boundary \u2202\u2126.\nLagrangian description. Since in this case the fluid system is no longer adiabatically closed, the appropriate formulation is found by considering the continuum version of the variational formulation for finite dimensional open thermodynamic systems [28]. This amounts to replacing the constraints (4) and (5) by the kinematic and variational constraints\n\u02c6 \u2126 W \u03b4L \u03b4S \u03a3\u0307 dX = \u2212 \u02c6 \u2126 W (P : \u2207\u03d5\u0307)\ufe38 \ufe37\ufe37 \ufe38\nviscosity\ndX + \u02c6 \u2126 W (JS \u00b7 \u2207\u0393\u0307)\ufe38 \ufe37\ufe37 \ufe38\nheat conduction\ndX \u2212 \u02c6 \u2202\u2126 W (JS \u00b7 n)(\u0393\u0307\u2212 T0)\ufe38 \ufe37\ufe37 \ufe38\nheat transfer\ndA, \u2200W\n(20)\u02c6 \u2126 W \u03b4L \u03b4S \u03b4\u03a3 dX = \u2212 \u02c6 \u2126 W (P : \u2207\u03b4\u03d5)\ufe38 \ufe37\ufe37 \ufe38\nviscosity\ndX + \u02c6 \u2126 W(JS \u00b7 \u2207\u03b4\u0393)\ufe38 \ufe37\ufe37 \ufe38\nheat conduction\ndX \u2212 \u02c6 \u2202\u2126 W (JS \u00b7 n)\u03b4\u0393\ufe38 \ufe37\ufe37 \ufe38\nheat transfer\ndA, \u2200W, (21)\nwith T0(X) the prescribed temperature on the boundary in the Lagrangian description. When JS \u00b7 n = 0 they consistently recover (4) and (5).\nWe refer to the Appendix A for an application of this type of variational principle for an elementary finite dimensional thermodynamic system exchanging heat with the exterior, which helps the understanding of the new boundary term. In particular, (20) and (21) are continuum versions of the constraints (82) and (83) in Appendix A.\nEulerian description. Exactly as in \u00a72.1, the variational principle can be converted to the Eulerian description, thereby yielding (9)\u2013(12) with the constraints (10) and (11) replaced by\n\u02c6 \u2126 w \u03b4` \u03b4s D\u0304t\u03c2 dx = \u2212 \u02c6 \u2126 w(\u03c3 : \u2207u) dx+ \u02c6 \u2126 w(js \u00b7 \u2207Dt\u03b3) dx\u2212 \u02c6 \u2202\u2126 w(js \u00b7 n) (Dt\u03b3 \u2212 T0) da, \u2200 w (22)\n\u02c6 \u2126 w \u03b4` \u03b4s D\u0304\u03b4\u03c2 dx = \u2212 \u02c6 \u2126 w(\u03c3 : \u2207v) dx+ \u02c6 \u2126 w(js \u00b7 \u2207D\u03b4\u03b3) dx\u2212 \u02c6 \u2202\u2126 w(js \u00b7 n)D\u03b4\u03b3 da, \u2200 w. (23)\nAn application of the variational formulation (9)-(22)-(23)-(12) yields the equations (14) and (15), with the last equation of (15) replaced by\n(js \u00b7 n)(T \u2212 T0) = 0 on \u2202\u2126, (24)\nsee \u00a7B.3 for details. With the boundary condition (24), the energy balance (17) is modified as\nd dt E = \u02c6 \u2126 div ( \u03c1 \u03b4` \u03b4\u03c1 u+ s \u03b4` \u03b4s u+ \u03c3 \u00b7 u+ js \u03b4` \u03b4s ) dx = \u2212 \u02c6 \u2202\u2126 (js \u00b7 n)T0 da. (25)\nRemark 2.2 (Prescribed heat flux). It is also possible to treat the boundary condition\njq \u00b7 n = q0\nwhere jq = Tjs is the heat flux and for some given function q0 : \u2202\u2126\u2192 R, which may itself depend on the boundary temperature as q0(T ). This is achieved by replacing the last term in (22) with\n\u2212 \u02c6 \u2202\u2126 w ( (js \u00b7 n)Dt\u03b3 \u2212 q0 ) da. (26)\nThe variational constraint (23) is kept unchanged, as it follows from the general variational framework for open systems, see Appendix A. The energy balance now reads\nd dt E = \u2212 \u02c6 \u2202\u2126 q0 da."
        },
        {
            "heading": "2.3 Associated weak formulation",
            "text": "The variational derivation presented above yields a weak formulation of the equations and boundary conditions, that will be shown to have a discrete version.\nIn the absence of irreversible processes, this weak formulation has been derived in [20] and is based on the trilinear forms a : L\u221e(\u2126)d\u00d7H1(\u2126)d\u00d7H1(\u2126)d \u2192 R and b : L2(\u2126)\u00d7H1(\u2126)\u00d7L\u221e(\u2126)d \u2192 R defined by\na(w, u, v) = \u2212 \u02c6\n\u2126 w \u00b7 [u, v] dx\nb(f, \u03c1, v) = \u2212 \u02c6\n\u2126 \u03c1\u2207f \u00b7 v dx.\nFor the treatment of the irreversible part, we restrict to the expressions \u03c3 = \u03c3(u) and js = js(T ) given in (18). For viscosity, we define the trilinear form c : L\u221e(\u2126)\u00d7H1(\u2126)d \u00d7H1(\u2126)d \u2192 R by\nc(w, u, v) = \u02c6 \u2126 w \u03c3(u) : \u2207v dx. (27)\nFor heat conduction, we set F = {f \u2208 H1(\u2126) | 1/f \u2208 L\u221e(\u2126), div(\u2207f/f) \u2208 L2(\u2126)} and define d : W 1,\u221e(\u2126)\u00d7 F \u00d7H1(\u2126)\u2192 R by\nd(w, f, g) =  \u02c6 \u2126 w js(f) \u00b7 \u2207g dx for homogeneous Neumann\n\u02c6 \u2126 w js(f) \u00b7 \u2207g dx\u2212 \u02c6 \u2202\u2126 wjs(f) \u00b7 ng da for Dirichlet and nonhomogeneous Neumann\n(28) and e : W 1,\u221e(\u2126)\u00d7 F \u2192 R by\ne(w, f) =  0 for homogeneous Neumann\u02c6 \u2202\u2126 wjs(f) \u00b7 nT0 da for Dirichlet\u02c6\n\u2202\u2126 wq0(f) da for nonhomogeneous Neumann\n(29)\nso that the constraints (10)\u2013(11) and (22)\u2013(23) (including the modified version in (26)) can be written in a unified way for all boundary conditions as\u2329\nw, \u03b4`\n\u03b4s D\u0304t\u03c2\n\u232a = \u2212c(w, u, u) + d ( w,\u2212 \u03b4`\n\u03b4s ,Dt\u03b3\n) + e ( w,\u2212 \u03b4`\n\u03b4s\n) , \u2200w (30)\nand \u2329 w, \u03b4`\n\u03b4s D\u0304\u03b4\u03c2\n\u232a = \u2212c(w, u, v) + d ( w,\u2212 \u03b4`\n\u03b4s ,D\u03b4\u03b3\n) , \u2200w, (31)\nwith \u3008\u00b7, \u00b7\u3009 the L2 inner product. Note that the condition div(\u2207f/f) \u2208 L2(\u2126) was included in the definition of F so that the term \u2212 \u00b4 \u2202\u2126wjs(f) \u00b7 ng da can be given meaning using the identity\u02c6\n\u2202\u2126 w\n1 f \u2207f \u00b7 ng da = \u02c6 \u2126 \u2207w \u00b7 1 f (\u2207f)g dx+ \u02c6 \u2126 w div\n( 1 f \u2207f ) g dx + \u02c6 \u2126 w 1 f \u2207f \u00b7 \u2207g dx.\nThis condition can be omitted from the definition of F in the homogeneous Neumann setting. Note also that we really have two ways to impose homogeneous Neumann boundary conditions: by choosing d and e as indicated above, or by using the \u201cnonhomogeneous Neumann\u201d d and e with q0 = 0. Both approaches lead to the same equations of motion, but the first approach is slightly simpler, and it simplifies the statement of the second law of thermodynamics below. Therefore we prefer to treat it separately.\nImportantly, by using these notations when carrying out the variational formulations (9)\u2013(12) and (9)-(22)-(23)-(12), we get the equations (14), together with the boundary conditions js \u00b7 n = 0 or (js \u00b7 n)(T \u2212 T0) = 0 in the weak form \u2329 \u2202t \u03b4` \u03b4u , v \u232a + a ( \u03b4` \u03b4u , u, v ) + b ( \u03b4` \u03b4\u03c1 , \u03c1, v ) + b ( \u03b4` \u03b4s , s, v ) = \u2212c(1, u, v), \u2200 v \u2212 \u2329 \u2202ts, \u03b4` \u03b4s w \u232a \u2212 b ( \u03b4` \u03b4s w, s, u ) + d ( 1,\u2212 \u03b4` \u03b4s , \u03b4` \u03b4s w ) = c(w, u, u) + d ( w,\u2212 \u03b4` \u03b4s , \u03b4` \u03b4s ) \u2212 e ( w,\u2212 \u03b4` \u03b4s ) , \u2200w\n\u3008\u2202t\u03c1, \u03b8\u3009+ b(\u03b8, \u03c1, u) = 0, \u2200 \u03b8,\n(32)\nsee \u00a7B.4 for details. Note in particular the very specific form of the two terms involving d(\u00b7, \u00b7, \u00b7) in the weak form of the entropy equation, which plays a crucial role in our discretization.\nWith these notations, the energy balance follows as\nd dt E =\n\u2329 \u2202t \u03b4`\n\u03b4u , u\n\u232a \u2212 \u2329 \u03b4`\n\u03b4\u03c1 , \u2202t\u03c1\n\u232a \u2212 \u2329 \u03b4`\n\u03b4s , \u2202ts \u232a = \u2212a ( \u03b4` \u03b4u , u, u ) \u2212 b ( \u03b4` \u03b4\u03c1 , \u03c1, u ) \u2212 b ( \u03b4` \u03b4s , s, u ) \u2212 c(1, u, u)\n+ b ( \u03b4` \u03b4\u03c1 , \u03c1, u ) + b ( \u03b4` \u03b4s , s, u ) \u2212 d ( 1,\u2212 \u03b4` \u03b4s , \u03b4` \u03b4s ) + c(1, u, u) + d ( 1,\u2212 \u03b4`\n\u03b4s , \u03b4` \u03b4s\n) \u2212 e (\n1,\u2212 \u03b4` \u03b4s\n) = \u2212e ( 1,\u2212 \u03b4`\n\u03b4s\n) (33)\nfrom the property a(w, u, v) = \u2212a(w, v, u), \u2200u, v, w\nof the trilinear form a. Conservation of total mass \u00b4 \u2126 \u03c1dx follows from the property\nb(1, \u03c1, v) = 0, \u2200\u03c1, v.\nRegarding entropy production, we have the inequalities \u03c3(u) :\u2207u \u2265 0 and \u2212js(T )\u00b7\u2207T \u2265 0 for all u and all T > 0, consistently with the second law of thermodynamics written in (16). In terms of c, the first condition is equivalently written as\nc(w, u, u) \u2265 0, \u2200u, \u2200w \u2265 0. (34)\nFor homogeneous Neumann boundary conditions, the second condition is equivalently written as\nd(w, f, f) \u2264 0, \u2200 f > 0, \u2200w \u2265 0, (35)\nwhile for Dirichlet and nonhomogeneous Neumann boundary conditions, it can be equivalently written as\nd(w, f, f) \u2264 0, \u2200 f > 0, \u2200w \u2265 0, w with compact support in the interior of \u2126, (36)\nwhere we recall that the expression for d depends on the boundary condition used. Discrete versions of (34)\u2013(36) will be shown to hold in the discrete case.\nFinally, the second law (16) can be equivalently written by using b and d as\n\u3008\u2202ts, Tw\u3009+ b(Tw, s, u)\u2212 d(1, T, Tw) \u2265 0 (37)\nfor all w \u2265 0 with compact support in \u2126."
        },
        {
            "heading": "3 Structure preserving variational discretization",
            "text": "The structure preserving finite element integrator is obtained by developing a discrete version of the variational formulation presented above. In particular, exactly as in the continuous case, the discrete variational formulation of the Eulerian form of the equation is inherited by a variational formulation extending Hamilton\u2019s principle in the Lagrangian description.\nThis is achieved thanks to the introduction of a discrete version Gh of the diffeomorphism group Diff(\u2126) of fluid motion, acting on discrete functions and densities. We shall follow the approach developed for compressible fluids in [20] based on the earlier works [36, 18, 15, 35, 5]. We refer to [12] for another approach to the variational discretization of (9)\u2013(12) for heat conducting viscous fluids, also based on a discrete version of the diffeomorphism group."
        },
        {
            "heading": "3.1 Discrete setting",
            "text": "Let Th be a triangulation of \u2126. We regard Th as a member of a family of triangulations parametrized by h = maxK\u2208Th hK , where hK = diamK denotes the diameter of a simplex K. We assume that this family is shape-regular, meaning that the ratio maxK\u2208Th hK/\u03c1K is bounded above by a positive constant for all h > 0. Here, \u03c1K denotes the inradius of K.\nWe shall discretize functions with the discontinuous Galerkin space\nVh = DGq(Th) := {f \u2208 L2(\u2126) | f |K \u2208 Pq(K), \u2200K \u2208 Th}.\nConsidering the discrete diffeomorphism group as a certain subgroup Gh \u2282 GL(Vh), the action f \u2208 Vh 7\u2192 gf \u2208 Vh, g \u2208 Gh is understood as a discrete analogue of the action f \u2208 F(\u2126) 7\u2192 f \u25e6\u03d5\u22121 \u2208 F(\u2126), \u03d5 \u2208 Diff(\u2126), of diffeomorphisms on functions. The discrete analogue of the action \u03c1 \u2208 F(\u2126)\u2217 7\u2192 (\u03c1 \u25e6 \u03d5)J\u03d5 \u2208 F(\u2126)\u2217 on densities, written as \u03c1 \u2208 Vh 7\u2192 \u03c1 \u00b7 g \u2208 Vh, is defined by L2 duality as in the continuous case\n\u3008\u03c1 \u00b7 g, f\u3009 = \u3008\u03c1, gf\u3009 , \u2200f, \u03c1 \u2208 Vh. (38)\nIn particular, the Lagrange-to-Euler relations (6) have the discrete analog\nA = g\u0307g\u22121, \u03c1 = %0 \u00b7 g\u22121 \u2208 Vh, s = S \u00b7 g\u22121 \u2208 Vh, \u03c2 = \u03a3 \u00b7 g\u22121 \u2208 Vh, \u03b3 = g\u0393 \u2208 Vh.\n(39)\nThe Lie algebra gh \u2282 L(Vh, Vh) of Gh acts on discrete functions and densities as f \u2208 Vh 7\u2192 fA \u2208 Vh and \u03c1 \u2208 Vh 7\u2192 \u03c1 \u00b7A \u2208 Vh, which satisfy\n\u3008\u03c1 \u00b7A, f\u3009 = \u3008\u03c1,Af\u3009 , \u2200f, \u03c1 \u2208 Vh. (40)\nAs shown in [20], the realization of elements of this Lie algebra as discrete vector fields is obtained by associating to each u \u2208 H0(div,\u2126) \u2229 Lp(\u2126)d (with p > 2) the Lie algebra element Au \u2208 gh defined by\n\u3008Auf, g\u3009 := \u2212 \u2211 K\u2208Th \u02c6 K (\u2207uf)g dx+ \u2211 e\u2208E0h \u02c6 e u \u00b7 JfK{g} da, \u2200f, g \u2208 Vh,\nwhich yields a consistent approximation of the distributional derivative in the direction u. Moreover, the linear map u \u2208 H0(div,\u2126)\u2229Lp(\u2126)d 7\u2192 Au \u2208 gh becomes injective on the Raviart-Thomas finite element space RT2q(Th) [20, Proposition 3.4]. Above, we used the notation JfK and {f} for the jump and average of a scalar function f across e = K1 \u2229K2 \u2208 E0h, which are defined by\nJfK = f1n1 + f2n2, {f} = 1\n2 (f1 + f2).\nHere, fi = f |Ki and ni is the unit normal vector to e pointing outward from Ki. Later we will also apply {\u00b7} to vector fields and interpret it componentwise.\nThis setting is used in [20] to develop a finite element variational discretization of compressible fluids, by writing the analog to the Hamilton principle (1) on the discrete diffeomorphism group Gh and using the first three relations (39) to deduce its Eulerian version. The discrete Lagrangian `d : gh \u00d7 Vh \u00d7 Vh \u2192 R can be defined from a given continuous Lagrangian ` as\n`d(A, \u03c1, s) := `(A\u0302, \u03c1, s)\nthanks to the Lie algebra-to-vector field map A \u2208 gh 7\u2192 A\u0302 \u2208 [Vh]d defined by\nA\u0302 := \u2212 d\u2211\nk=1\nA(\u03c0h(x k))ek,\nwhere xk : \u2126 \u2192 R is the kth coordinate function, {ek}dk=1 is the standard basis for Rd, and \u03c0h : L\n2(\u2126) \u2192 Vh the L2-orthogonal projector, which we interpret componentwise when applied to a vector field. It satisfies A\u0302u = \u03c0h(u)."
        },
        {
            "heading": "3.2 Discrete variational formulation",
            "text": "We discretize the velocity by using the continuous Galerkin space\nUgradh = CGr(Th) d := {u \u2208 H10 (\u2126)d | u|K \u2208 Pr(K)d, \u2200K \u2208 Th}.\nAssuming r \u2264 q (see Remark 3.1 for r > q), we denote by \u2206h \u2282 gh the subspace corresponding to Ugradh via the injective map u 7\u2192 Au. We denote by \u03c0 grad h : L 2(\u2126)d \u2192 Ugradh the L 2-orthogonal projector onto Ugradh . Consider discretizations of d and e given as dh : Vh \u00d7 Vh \u00d7 Vh \u2192 R and eh : Vh \u00d7 Vh \u2192 R. For now, we only suppose that dh is linear in its first and third arguments, and eh is linear in its first argument. The explicit form and their properties are stated later.\nWith this setting, the discrete version of the variational formulation (9)-(30)-(31)-(12) reads as follows. Find A : [t0, t1] \u2192 \u2206h and \u03c1, s, \u03c2, \u03b3 : [t0, t1] \u2192 Vh which are critical for the variational condition\n\u03b4 \u02c6 t1 t0 [ `d(A, \u03c1, s) + \u3008s\u2212 \u03c2,Dht \u03b3\u3009 ] dt = 0, (41)\nwith the phenomenological constraint and variational constraint given by\u2329 \u03b4`d \u03b4s D\u0304ht \u03c2, w \u232a = \u2212c(w, A\u0302, A\u0302) + dh ( w,\u2212\u03b4`d \u03b4s ,Dht \u03b3 ) + eh ( w,\u2212\u03b4`d \u03b4s ) , \u2200w \u2208 Vh, (42)\n\u2329 \u03b4`d \u03b4s D\u0304h\u03b4 \u03c2, w \u232a = \u2212c(w, A\u0302, B\u0302) + dh ( w,\u2212\u03b4`d \u03b4s ,Dh\u03b4 \u03b3 ) , \u2200w \u2208 Vh, (43)\nand with Euler-Poincare\u0301 variations\n\u03b4A = \u2202tB + [B,A], (44)\n\u03b4\u03c1 = \u2212\u03c1 \u00b7B, (45)\nfor B(t) an arbitrary curve in \u2206h with B(0) = B(T ) = 0, and with \u03b4\u03b3|t=0,T = 0. Above we have defined the discrete analogues to the Lagrangian time derivatives and variations considered in (13) as\nDht f = \u2202tf \u2212Af Dh\u03b4 f = \u03b4f \u2212Bf D\u0304ht \u03c1 = \u2202t\u03c1+ \u03c1 \u00b7A D\u0304h\u03b4 \u03c1 = \u03b4\u03c1+ \u03c1 \u00b7B.\n(46)\nIn (42) and (43), the partial derivative \u03b4`d\u03b4s \u2208 Vh is defined exactly as in the continuous case, with respect to the L2 duality pairing on Vh.\nProposition 3.1. The equations of motion that result from (41)\u2013(43) and from the definition \u03c1 = %0 \u00b7 g\u22121 are \u2329 \u2202t \u03b4` \u03b4u , v \u232a + ah ( \u03c0h \u03b4` \u03b4u , u, v ) + bh ( \u03c0h \u03b4` \u03b4\u03c1 , \u03c1, v ) +bh ( \u03c0h \u03b4` \u03b4s , s, v ) = \u2212c(1, u, v), \u2200 v \u2208 Ugradh , \u3008\u2202t\u03c1, \u03b8\u3009+ bh(\u03b8, \u03c1, u) = 0, \u2200 \u03b8 \u2208 Vh, \u2212 \u2329 \u2202ts, \u03c0h ( \u03b4` \u03b4s ) w \u232a \u2212 bh ( \u03c0h ( \u03c0h ( \u03b4` \u03b4s ) w ) , s, u ) + dh ( 1,\u2212\u03c0h \u03b4` \u03b4s , \u03c0h ( \u03c0h ( \u03b4` \u03b4s ) w )) = c(w, u, u) + dh ( w,\u2212\u03c0h \u03b4`\n\u03b4s , \u03c0h\n\u03b4`\n\u2202s\n) \u2212 eh ( w,\u2212\u03c0h \u03b4`\n\u03b4s\n) , \u2200w \u2208 Vh,\n(47)\nwhere\nah(w, u, v) = \u2212 \u02c6\n\u2126 A\u0302w \u00b7 \u0302[Au, Av] dx = \u2212 \u02c6 \u2126 w \u00b7 [u, v] dx (48)\nbh(f, \u03c1, u) = \u3008\u03c1,Auf\u3009 = \u2212 \u2211 K\u2208Th \u02c6 K (\u2207uf)\u03c1 dx+ \u2211 e\u2208E0h \u02c6 e u \u00b7 JfK{\u03c1} da. (49)\nThe variational principle (41)\u2013(43) also yields the conditions\nDht \u03b3 = \u2212\u03c0h \u03b4`\n\u03b4s ,\n\u2329 D\u0304ht (\u03c2 \u2212 s), \u03b4\u03b3 \u232a = \u2212dh ( 1,\u2212\u03c0h \u03b4` \u03b4s , \u03b4\u03b3 ) , \u2200 \u03b4\u03b3 \u2208 Vh. (50)\nRemark 3.1. The second equality in (48) is valid if r \u2264 q. If r > q, then we can still arrive at the same scheme by considering a discrete diffeomorphism group Gh \u2282 GL(DGr(Th)) and treating \u03c1, s, \u03c2, \u03b3 as elements of DGq(Th) \u2282 DGr(Th); see [20, Remark 5.1]. In both cases, the fact that our discrete velocity field is continuous is important. In the absence of continuity, the formula (48) contains additional terms involving jumps across codimension-1 faces; see [20, Proposition 4.3]. The absence of these jump terms renders ah independent of h, so we drop the subscript h in what follows.\nRemark 3.2. Note that (49) is a standard discontinuous Galerkin discretization of the scalar advection operator, see [8].\nProof. Taking the variations in (41) yields\n\u02c6 t1 t0 [\u2329\u2329\u03b4`d \u03b4A , \u03b4A \u232a\u232a + \u2329\u03b4`d \u03b4\u03c1 , \u03b4\u03c1 \u232a + \u2329\u03b4`d \u03b4s , \u03b4s \u232a + \u2329 \u03b4s,Dht \u03b3 \u232a \u2212 \u2329 \u03b4\u03c2,Dht \u03b3 \u232a \u2212 \u2329 D\u0304ht (s\u2212 \u03c2), \u03b4\u03b3 \u232a \u2212 \u2329 s\u2212 \u03c2, \u03b4A\u03b3 \u232a] dt = 0,\n(51)\nwhere \u2329\u2329 \u00b7, \u00b7 \u232a\u232a : g\u2217h \u00d7 gh \u2192 R denotes the duality pairing on g\u2217h \u00d7 gh. We used \u00b4 t1 t0 \u2329 s\u2212 \u03c2,Dht \u03b4\u03b3 \u232a dt =\n\u2212 \u00b4 t1 t0 \u2329 D\u0304ht (s\u2212 \u03c2), \u03b4\u03b3 \u232a dt which follows from (40), (46), and \u03b4\u03b3|t=t0,t1 = 0. Since \u03b4s is arbitrary in Vh, we get the condition\nDht \u03b3 = \u2212 \u03b4`d \u03b4s . (52)\nMaking use of this condition and using (43) yields\n\u02c6 t1 t0 [\u2329\u2329\u03b4`d \u03b4A , \u03b4A \u232a\u232a + \u2329\u03b4`d \u03b4\u03c1 , \u03b4\u03c1 \u232a \u2212 c(1, A\u0302, B\u0302) + dh ( 1,\u2212\u03b4`d \u03b4s ,Dh\u03b4 \u03b3 ) \u2212 \u2329\u03b4`d \u03b4s , \u03c2 \u00b7B \u232a \u2212 \u2329 D\u0304ht (s\u2212 \u03c2), \u03b4\u03b3 \u232a \u2212 \u2329 s\u2212 \u03c2, \u03b4A\u03b3 \u232a] dt = 0.\nUsing that \u03b4\u03b3 is arbitrary and independent of the other variations, we get\u2329 D\u0304ht (\u03c2 \u2212 s), \u03b4\u03b3 \u232a = \u2212dh ( 1,\u2212\u03b4`d \u03b4s , \u03b4\u03b3 ) , \u2200 \u03b4\u03b3 \u2208 Vh. (53)\nWith this, the previous condition becomes \u02c6 t1 t0 [\u2329\u2329\u03b4`d \u03b4A , \u03b4A \u232a\u232a \u2212 \u2329 s\u2212 \u03c2, \u03b4A\u03b3 \u232a \u2212 \u2329\u03b4`d \u03b4\u03c1 , \u03c1 \u00b7B \u232a \u2212 \u2329\u03b4`d \u03b4s , \u03c2 \u00b7B \u232a \u2212c(1, A\u0302, B\u0302)\u2212dh ( 1,\u2212\u03b4`d \u03b4s ,B\u03b3 )] dt = 0.\nUsing \u03b4A = \u2202tB + [B,A] and the computation\n\u02c6 t1 t0 \u3008s\u2212 \u03c2, \u03b4A\u03b3\u3009dt = \u02c6 t1 t0 \u3008s\u2212 \u03c2, (\u2202tB + [B,A])\u03b3\u3009 dt\n= \u02c6 t1 t0 \u3008\u2212\u2202t(s\u2212 \u03c2), B\u03b3\u3009 \u2212 \u3008s\u2212 \u03c2, B\u2202t\u03b3\u3009+ \u3008(s\u2212 \u03c2) \u00b7B,A\u03b3\u3009 \u2212 \u3008(s\u2212 \u03c2) \u00b7A,B\u03b3\u3009dt\n= \u02c6 t1 t0 \u2329 \u2212D\u0304ht (s\u2212 \u03c2), B\u03b3 \u232a \u2212 \u2329 (s\u2212 \u03c2) \u00b7B,Dht \u03b3 \u232a dt\n= \u02c6 t1 t0 \u2212dh ( 1,\u2212\u03b4`d \u03b4s ,B\u03b3 ) + \u2329 (s\u2212 \u03c2) \u00b7B, \u03b4`d \u03b4s \u232a dt,\nthe previous condition becomes\n\u02c6 T 0 [\u2329\u2329 \u2212 \u2202t \u03b4`d \u03b4A ,B \u232a\u232a + \u2329\u2329\u03b4`d \u03b4A , [B,A] \u232a\u232a \u2212 \u2329\u03b4`d \u03b4\u03c1 , \u03c1 \u00b7B \u232a \u2212 \u2329\u03b4`d \u03b4s , s \u00b7B \u232a \u2212 c(1, A\u0302, B\u0302) ] dt = 0.\nUsing that A \u2208 \u2206h means A = Au for u \u2208 Ugradh and using the definitions of a and bh in (48) and (49), together with \u03b4`d\u03b4\u03c1 = \u03c0h \u03b4` \u03b4\u03c1 , \u03b4`d \u03b4s = \u03c0h \u03b4` \u03b4s , and \u2329\u2329 \u03b4`d \u03b4Au , C \u232a\u232a = \u2329 \u03c0h \u03b4` \u03b4u , C\u0302 \u232a , we get the first equations of (47). Combining the constraint (42) and condition (52), we get\u2329\nD\u0304ht \u03c2, \u03c0h (\u03b4`d \u03b4s w )\u232a = \u2212c(w, A\u0302, A\u0302)\u2212 dh ( w,\u2212\u03b4`d \u03b4s , \u03b4`d \u03b4s ) + eh ( w,\u2212\u03b4`d \u03b4s ) , \u2200w \u2208 Vh.\nUsing (53) and A = Au this becomes\u2329 D\u0304ht s, \u03c0h (\u03b4`d \u03b4s w )\u232a \u2212 dh ( 1,\u2212\u03b4`d \u03b4s , \u03c0h (\u03b4`d \u03b4s w )) = \u2212c(w, u, u)\u2212 dh ( w,\u2212\u03b4`d \u03b4s , \u03b4`d \u03b4s ) + eh ( w,\u2212\u03b4`d \u03b4s ) ,\n\u2200w \u2208 Vh. We have thus derived the entropy equation in (47). The mass density equation readily follows from \u03c1 = %0 \u00b7 g\u22121 while the conditions (50) have been obtained in (52) and (53).\nEnergy balance and mass conservation. The exact same proof as in the continuous case works, see (33), giving energy balance and mass conservation in the spatially discrete setting as\nd dt E = \u2212eh\n( 1,\u2212\u03c0h \u03b4`\n\u03b4s\n) (54)\nd\ndt \u02c6 \u2126 \u03c1dx = 0. (55)\nRemark 3.3. The conservation properties above continue to hold if we omit the outermost pro-\njection \u03c0h from the terms of the form \u03c0h ( \u03c0h ( \u03b4` \u03b4s ) w ) in (47). They also continue to hold if we omit the \u03c0h from \u03c0h \u03b4` \u03b4u in (47). We find it advantageous to make these modifications, since they simplify the implementation of the scheme. We do not omit the \u03c0h from \u03c0h \u03b4` \u03b4\u03c1 , since this interferes with the balance of energy. Likewise, we do not omit the \u03c0h from \u03c0h \u03b4` \u03b4s , since we have found that the time-discrete version of (47) is difficult to solve numerically without it; Newton\u2019s method converges much more reliably when the projection is present.\nIn summary, we solve \u2329 \u2202t \u03b4` \u03b4u , v \u232a + a ( \u03b4` \u03b4u , u, v ) + bh ( \u03c0h \u03b4` \u03b4\u03c1 , \u03c1, v ) \u2212 bh(T, s, v) = \u2212c(1, u, v), \u2200 v \u2208 Ugradh , \u3008\u2202t\u03c1, \u03b8\u3009+ bh(\u03b8, \u03c1, u) = 0, \u2200 \u03b8 \u2208 Vh,\n\u3008\u2202ts, Tw\u3009+ bh(Tw, s, u)\u2212 dh(1, T, Tw) = c(w, u, u)\u2212 dh(w, T, T )\u2212 eh(w, T ), \u2200w \u2208 Vh,\n(56)\nwhere T = \u2212 \u03b4`d\u03b4s = \u2212\u03c0h \u03b4` \u03b4s ."
        },
        {
            "heading": "3.3 Discretization of thermodynamic fluxes",
            "text": "We now discuss our discretizations dh and eh of the maps d and e defined in (28) and (29). We will design dh and eh so that the discrete entropy equation\n\u3008\u2202ts, Tw\u3009+ bh(Tw, s, u)\u2212 dh(1, T, Tw) = c(w, u, u)\u2212 dh(w, T, T )\u2212 eh(w, T ), \u2200w \u2208 Vh (57)\nyields a consistent discretization of the continuous entropy equation\nT (D\u0304ts+ div js) = \u03c3 : \u2207u\u2212 js \u00b7 \u2207T.\nWe restrict our attention to the setting where js = js(T ) = \u2212 1T \u03ba\u2207T , so that the above equation simplifies to\nTD\u0304ts\u2212 \u03c3 : \u2207u = \u03ba\u2206T.\nNote that an integration by parts shows that the exact solution (u, \u03c1, s, T ) of the continuous problem satisfies\n\u3008\u2202ts, Tw\u3009+ bh(Tw, s, u)\u2212 c(w, u, u) = \u3008TD\u0304ts\u2212 \u03c3 : \u2207u,w\u3009, \u2200w \u2208 Vh.\nThus, to ensure consistency, we aim to design dh and eh so that the exact solution also satisfies\ndh(1, T, Tw)\u2212 dh(w, T, T )\u2212 eh(w, T ) = \u3008\u03ba\u2206T,w\u3009, \u2200w \u2208 Vh. (58)\nOur discussion is split into three cases: homogeneous Neumann boundary conditions on T , Dirichlet boundary conditions on T , and nonhomogneous Neumann boundary conditions on T . To simplify the discussion, we consider the setting where (57) is implemented with T = \u2212 \u03b4`\u03b4s . The case in which one uses T = \u2212\u03c0h \u03b4`\u03b4s is addressed in Remark 3.4.\nHomogeneous Neumann boundary conditions. In this case we set eh = 0 and discretize d with\ndh(w, f, g) = \u2212 \u2211 K\u2208Th \u02c6 K w f \u03ba\u2207f \u00b7 \u2207g dx+ \u2211 e\u2208E0h \u02c6 e 1 {f} {w\u03ba\u2207f} \u00b7 JgK da\n\u2212 \u2211 e\u2208E0h \u02c6 e 1 {f} {w\u03ba\u2207g} \u00b7 JfK da\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e {w} {f} JfK \u00b7 JgK da, (59)\nwhere \u03b7 > 0 is a penalty parameter. This is a standard non-symmetric interior penalty discretization of \u2212 \u00b4 \u2126 \u03ba\u2207f \u00b7 \u2207g dx [7, Section 10.5], generalized to incorporate the weight w/f appearing in\nd(w, f, g) = \u2212 \u00b4\n\u2126 w f \u03ba\u2207f \u00b7\u2207g dx. Using the identity JfgK = JfK{g}+{f}JgK, a few calculations show\nthat for every w, T \u2208 Vh,\ndh(1, T, Tw)\u2212 dh(w, T, T ) = \u2212 \u2211 K\u2208Th \u02c6 K \u03ba\u2207T \u00b7 \u2207w dx+ \u2211 e\u2208E0h \u02c6 e {\u03ba\u2207T} \u00b7 JwK da\u2212 \u2211 e\u2208E0h \u02c6 e \u03ba({\u2207w}+ \u03b5) \u00b7 JT K da\n\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e JT K \u00b7 JwK da,\n(60)\nwhere\n\u03b5 = 1\n{T} ({\u2207(Tw)} \u2212 {\u2207T}{w} \u2212 {T}{\u2207w}) . (61)\nHence, for smooth T , we get\ndh(1, T, Tw)\u2212 dh(w, T, T )\u2212 eh(w, T ) = \u02c6\n\u2126 \u03ba\u2206Tw dx\u2212 \u02c6 \u2202\u2126 \u03ba\u2207T \u00b7 nw da, \u2200w \u2208 Vh. (62)\nThis shows that the method is consistent: The exact solution (with homogeneous Neumann boundary conditions on T ) satisfies (58) (where here eh = 0). Furthermore, the presence of \u00b4 \u2202\u2126\u2207T \u00b7nw da in (62) shows that the scheme enforces homogeneous Neumann boundary conditions on T in a natural way.\nWe also have for every w, T \u2208 Vh,\ndh(w, T, T ) = \u2212 \u2211 K\u2208Th \u02c6 K w T \u03ba|\u2207T |2 dx\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e {w} {T} |JT K|2 da, (63)\nso the following inequality holds:\ndh(w, T, T ) \u2264 0, \u2200 T > 0, \u2200 w \u2265 0, T, w \u2208 Vh. (64)\nThis is the discrete version of the thermodynamic consistency condition (35). In particular, dh(1K , T, T ) \u2264 0, for all K, where 1K denotes the indicator function for K.\nDirichlet boundary conditions. Next we consider Dirichlet boundary conditions. To distinguish the choice of dh above from the forthcoming choice, we denote the former by d N h and the latter by dDh , and similarly for eh. We define\neDh (w, f) = \u2212 \u02c6 \u2202\u2126 w f \u03ba\u2207f \u00b7 nT0 da+ \u2211 e\u2208E\u2202h \u03b7 he \u02c6 e w(f \u2212 T0) da (65)\nand dDh (w, f, g) = \u2212 \u2211 K\u2208Th \u02c6 K w f \u03ba\u2207f \u00b7 \u2207g dx+ \u2211 e\u2208E0h \u02c6 e 1 {f} {w\u03ba\u2207f} \u00b7 JgK da\u2212 \u2211 e\u2208E0h \u02c6 e 1 {f} {w\u03ba\u2207g} \u00b7 JfK da\n\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e {w} {f} JfK \u00b7 JgK da\u2212 \u2211 e\u2208E\u2202h \u02c6 e w f \u03ba\u2207g \u00b7 n(f \u2212 T0) da+ \u2211 e\u2208E\u2202h \u02c6 e w f \u03ba\u2207f \u00b7 ng da,\n(66)\nwhere T0 : \u2202\u2126 \u2192 R is the prescribed temperature on the boundary. Like (59), (66) is a standard non-symmetric interior penalty discretization of \u2212 \u00b4 \u2126 \u03ba\u2207f \u00b7 \u2207g dx (this time for problems with Dirichlet boundary conditions), generalized to incorporate the weight w/f appearing in d(w, f, g) = \u2212 \u00b4\n\u2126 w f \u03ba\u2207f \u00b7 \u2207g dx + \u00b4 \u2202\u2126 w f \u03ba\u2207f \u00b7 ng da, see (28). It is related to (59) via the addition of three\nboundary terms: 1. A term \u2211\ne\u2208E\u2202h\n\u00b4 e w f \u03ba\u2207f \u00b7 ng da that corresponds to the term \u2212 \u00b4 \u2202\u2126wjs(f) \u00b7 ng da appearing\nin (28). 2. A term \u2212 \u2211\ne\u2208E\u2202h\n\u00b4 e w f \u03ba\u2207g \u00b7 nf da whose role is to cancel with \u2211 e\u2208E\u2202h \u00b4 e w f \u03ba\u2207f \u00b7 ng da when\nf = g. 3. A term \u2211\ne\u2208E\u2202h\n\u00b4 e w f \u03ba\u2207g \u00b7 nT0 da that restores the consistency of d D h .\nSimilar calculations as earlier show that for every w, T \u2208 Vh,\ndDh (1, T, Tw)\u2212 dDh (w, T, T )\u2212 eDh (w, T ) = \u2212 \u2211 K\u2208Th \u02c6 K \u03ba\u2207T \u00b7 \u2207w dx+ \u2211 e\u2208E0h \u02c6 e {\u03ba\u2207T} \u00b7 JwK da\u2212 \u2211 e\u2208E0h \u02c6 e \u03ba({\u2207w}+ \u03b5) \u00b7 JT K da\n\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e JT K \u00b7 JwK da\u2212 \u2211 e\u2208E\u2202h \u02c6 e \u03ba\u2207(Tw) \u00b7 n ( 1\u2212 T0 T ) da\n+ \u2211 e\u2208E\u2202h \u02c6 e \u03ba\u2207T \u00b7 nw da\u2212 \u2211 e\u2208E\u2202h \u03b7 he \u02c6 e w(T \u2212 T0) da,\n(67)\nwhere \u03b5 is given by (61). Hence, for smooth T ,\ndDh (1, T, Tw)\u2212 dDh (w, T, T )\u2212 eDh (w, T ) = \u02c6\n\u2126 \u03ba\u2206Tw dx+ \u02c6 \u2202\u2126 \u03ba\u2207(Tw) \u00b7 n ( T0 T \u2212 1 ) da\n+ \u2211 e\u2208E\u2202h \u03b7 he \u02c6 e w(T0 \u2212 T ) da, \u2200w \u2208 Vh.\nThis shows that the method is consistent, and it enforces Dirichlet boundary conditions on T in a nearly standard way.\nIf w has compact support in the interior of \u2126 and T > 0, then dDh (w, T, T ) takes exactly the same form as in the homogeneous Neumann case in (63). So the discrete version of the thermodynamic consistency condition (36) for Dirichlet boundary conditions holds. In particular, dDh (1K , T, T ) \u2264 0, for all K away from \u2202\u2126.\nThe terms associated with heat conduction processes on the right hand side of the discrete entropy equation (57) are given by\ndDh (w, T, T ) + e D h (w, T ) =\u2212 \u2211 K\u2208Th \u02c6 K w T \u03ba|\u2207T |2 dx\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e {w} {T} |JT K|2 da\n+ \u2211 e\u2208E\u2202h \u03b7 he \u02c6 e w(T \u2212 T0)da.\n(68)\nNonhomogeneous Neumann boundary conditions. In view of the expressions (28) and (29) for d and e in the nonhomogeneous Neumann case, we discretize d and e with\ndNNh (w, f, g) = d N h (w, f, g) + \u2211 e\u2208E\u2202h \u02c6 e w f \u03ba\u2207f \u00b7 ng da and eNNh (w, f) = \u02c6 \u2202\u2126 wq0 da,\nwhere dNh is taken from the homogeneous Neumann case, see (59). The consistency of the method can be checked by following the same steps as before, and similarly for the discrete version of the thermodynamic consistency condition (36).\nNow the expression entering into the right hand side of the discrete entropy equation (57) reads\ndNNh (w, T, T ) + e NN h (w, T ) =\u2212 \u2211 K\u2208Th \u02c6 K w T \u03ba|\u2207T |2 dx\u2212 \u2211 e\u2208E0h \u03b7 he \u02c6 e {w} {T} |JT K|2 da\n\u2212 \u02c6 \u2202\u2126 w ( Tjs(T ) \u00b7 n\u2212 q0 ) da;\n(69)\ncompare to (68).\nRemark 3.4. In the discussion above, we established the consistency of (57) in the setting where T = \u2212 \u03b4`\u03b4s . If instead T = \u2212\u03c0h \u03b4` \u03b4s , then we have consistency in a weaker sense: The solution to the continuous problem satisfies the discrete equations approximately rather than exactly. One can equivalently view this situation as a variational crime [7, Chapter 10]. Indeed, by using \u2212\u03c0h \u03b4`\u03b4s in place of \u2212 \u03b4`\u03b4s , we are in essence modifying the maps d and e. This is analogous to the effect of quadrature on classical finite element methods for elliptic problems [17, Section 8.1.3].\nDiscrete form of the second law. The rate of entropy production in the discrete setting is Dht \u03c2. According to (53), it satisfies\n\u3008D\u0304ht \u03c2, Tw\u3009 = \u3008D\u0304ht s, Tw\u3009 \u2212 dh(1, T, \u03c0h(Tw)), \u2200w \u2208 Vh,\nwhere T = \u2212\u03c0h \u03b4`\u03b4s . For piecewise constant w, we have \u03c0h(Tw) = Tw, so\n\u3008D\u0304ht \u03c2, Tw\u3009 = \u3008D\u0304ht s, Tw\u3009 \u2212 dh(1, T, Tw) = ch(w, u, u)\u2212 dh(w, T, T )\u2212 eh(w, T ), \u2200w \u2208 DG0(Th).\nSee (63), (68), and (69) for the concrete expressions for each boundary condition. From the definition of c and the thermodynamic consistency of dNh , d D h , d NN h , the numerical solution satisfies \u3008D\u0304ht \u03c2, Tw\u3009 = \u3008D\u0304ht s, Tw\u3009 \u2212 dh(1, T, Tw) \u2265 0, (70)\nfor all w \u2208 DG0(Th) with w \u2265 0 (provided that w has compact support in \u2126 for Dirichlet and nonhomogeneous Neumann boundary conditions), which is the discrete form of the second law (16) as reformulated in (37). In particular \u00b4 K TD\u0304 h t \u03c2 dx \u2265 0 on each K (provided that K is away from \u2202\u2126 in the Dirichlet and nonhomogeneous Neumann cases). If T is piecewise constant, then this implies that \u00b4 K D\u0304 h t \u03c2 dx \u2265 0 on those K."
        },
        {
            "heading": "3.4 Temporal discretization",
            "text": "As shown in [20, Proposition 5.1], in the absence of irreversible processes (c = d = 0) an energy preserving time discretization can be developed for Lagrangians of the standard form (8).\nWe show that a natural extension of this scheme to the discrete heat conducting viscous fluid equations (56) allows one to exactly preserve energy balance and mass conservation, while satisfying the second law of thermodynamics on each cell at the fully discrete level. The scheme reads\n\u3008D\u2206t(\u03c1u), v\u3009+ a ( (\u03c1u)k+1/2, uk+1/2, v ) + bh\n( 1\n2 \u03c0h(uk \u00b7 uk+1)\u2212D1 \u2212 \u03c0h\u03c6, \u03c1k+1/2, v ) \u2212 bh ( D2 , sk+1/2, v ) = \u2212c(1, uk+1/2, v), \u2200 v \u2208 U grad h\n\u3008D\u2206t\u03c1, \u03b8\u3009+ bh(\u03b8, \u03c1k+1/2, uk+1/2) = 0, \u2200 \u03b8 \u2208 Vh \u3008D\u2206ts,D2 w\u3009+ bh ( D2 w, sk+1/2, uk+1/2 ) \u2212 dh (1, D2 ,D2 w)\n= c(w, uk+1/2, uk+1/2)\u2212 dh (w,D2 ,D2 )\u2212 eh(w,D2 ), \u2200w \u2208 Vh\n(71)\nwith\nD1 = \u03c0h\n( \u03b41(\u03c1k, \u03c1k+1, sk) + \u03b41(\u03c1k, \u03c1k+1, sk+1)\n2\n) , \u03b41(\u03c1, \u03c1 \u2032, s) = (\u03c1\u2032, s)\u2212 (\u03c1, s)\n\u03c1\u2032 \u2212 \u03c1\nD2 = \u03c0h\n( \u03b42(sk, sk+1, \u03c1k) + \u03b42(sk, sk+1, \u03c1k+1)\n2\n) , \u03b42(s, s \u2032, \u03c1) = (\u03c1, s\u2032)\u2212 (\u03c1, s)\ns\u2032 \u2212 s\nD\u2206tx = xk+1 \u2212 xk\n\u2206t , D\u2206t(\u03c1u) = \u03c1k+1uk+1 \u2212 \u03c1kuk \u2206t\nxk+1/2 = xk + xk+1\n2 , (\u03c1u)k+1/2 = \u03c1kuk + \u03c1k+1uk+1 2 .\nProposition 3.2. The solution of (71) satisfies the energy balance and conservation of mass\nEk+1 \u2212 Ek \u2206t\n= \u2212eh(1, D2 ) (72)\u02c6 \u2126 \u03c1k+1dx = \u02c6 \u2126 \u03c1kdx, (73)\nas well as the second law \u3008D\u2206ts,D2 w\u3009+ bh ( D2 w, sk+1/2, uk+1/2 ) \u2212 dh (1, D2 ,D2 w) \u2265 0, \u2200w \u2208 DG0(Th), w \u2265 0, (74)\nfor all k (provided that w has compact support in \u2126 for Dirichlet and nonhomogeneous Neumann boundary conditions). Here Ek = \u00b4 \u2126 [ 1 2\u03c1k|uk| 2 + (\u03c1k, sk) + \u03c1k\u03c6 ]\ndx is the total energy of the system at time k\u2206t.\nProof. Taking v = uk+1/2 in the fluid momentum equation, \u03b8 = \u2212 ( 1 2\u03c0h(uk \u00b7 uk+1)\u2212D1 \u2212 \u03c0h\u03c6 ) in the mass equation, w = 1 in the entropy equation, and adding the three equations together, we get\n\u2212eh(1, D2 ) = \u3008D\u2206t(\u03c1u), uk+1/2\u3009+ \u3008D\u2206t\u03c1, \u03b8\u3009+ \u3008D\u2206ts,D2 \u3009\n= \u3008D\u2206t(\u03c1u), uk+1/2\u3009 \u2212 1\n2 \u3008D\u2206t\u03c1, uk \u00b7 uk+1\u3009+ \u3008D\u2206t\u03c1,D1 \u3009+ \u3008D\u2206t\u03c1, \u03c6\u3009+ \u3008D\u2206ts,D2 \u3009.\nThe energy balance relation (72) then follows from the identities\n\u3008D\u2206t(\u03c1u), uk+1/2\u3009 \u2212 1\n2 \u3008D\u2206t\u03c1, uk \u00b7 uk+1\u3009 =\n1\n\u2206t \u02c6 \u2126 1 2 \u03c1k+1|uk+1|2 \u2212 1 2 \u03c1k|uk|2 dx,\n\u3008D\u2206t\u03c1,D1 \u3009+ \u3008D\u2206ts,D2 \u3009 = 1\n\u2206t \u02c6 \u2126 (\u03c1k+1, sk+1)\u2212 (\u03c1k, sk) dx,\n\u3008D\u2206t\u03c1, \u03c6\u3009 = 1\n\u2206t \u02c6 \u2126 \u03c1k+1\u03c6\u2212 \u03c1k\u03c6 dx.\nConservation of mass (73) follows by taking \u03b8 = 1 in the mass density equation. Finally, the discrete second law is a direct consequence of the last equation together with the\ndefinition of c and the thermodynamic consistency of dNh , d D h , and d NN h ."
        },
        {
            "heading": "3.5 Enhancements",
            "text": "The scheme (71) admits several enhancements and generalizations.\nRotation. Rotational effects, which are important in geophysical applications, can be easily incorporated by using a Lagrangian\n`(u, \u03c1, s) = \u02c6 \u2126 [1 2 \u03c1|u|2 + \u03c1R \u00b7 u\u2212 \u03c1\u03c6\u2212 (\u03c1, s) ] dx\nin place of (8). Here, R is half the vector potential of the angular velocity \u03c9 of the fluid domain; that is, curlR = 2\u03c9.\nVariable coefficients. Temperature-dependent and density-dependent coefficients \u00b5(\u03c1, T ) and \u03b6(\u03c1, T ) can be treated without difficulty. The map c then depends parametrically on \u03c1 and T , and the balance of energy, conservation of mass, and second law of thermodynamics remain valid at the discrete level if we evaluate c(1, uk+1/2, v) and c(w, uk+1/2, uk+1/2) at, e.g., (\u03c1, T ) = (\u03c1k+1/2, D2 ) in (71). It is also possible to treat a temperature-dependent and density-dependent heat conduction coefficient \u03ba(\u03c1, T ). In (59) and (66), one must choose appropriate discretizations of the trace of \u03ba(\u03c1, f) (such as {\u03ba(\u03c1, f)} or \u03ba({\u03c1}, {f})) when treating integrals over e \u2208 E0h. The balance of energy and conservation of mass remain valid at the discrete level, and so does the second law of thermodynamics, assuming that \u03ba remains positive and its discrete trace along each e \u2208 E0h remains positive.\nUpwinding. Upwinding can be incorporated into the discrete advection equations for the density and entropy, while still preserving the balance of energy, conservation of mass, and second law of thermodynamics. Following [19, 21, 22], one introduces a u-dependent trilinear form\nb\u0303h(u; f, g, v) = bh(f, g, v) + \u2211 e\u2208E0h \u02c6 e \u03b2e(u) (v \u00b7 n u \u00b7 n ) JfK \u00b7 JgK da,\nwhere {\u03b2e(u)}e\u2208E0h are nonnegative scalars. One then replaces every appearance of bh(\u00b7, \u00b7, \u00b7) in (71) by b\u0303h(uk+1/2; \u00b7, \u00b7, \u00b7). We used this upwinding strategy with\n\u03b2e(u) = 1 \u03c0 (u \u00b7 n) arctan (10u \u00b7 n) \u2248 1 2 |u \u00b7 n|\nin the numerical experiments below."
        },
        {
            "heading": "4 Numerical test",
            "text": "We use our scheme to simulate Rayleigh-Be\u0301nard convection driven by a temperature difference between the top and bottom boundaries of the fluid\u2019s container.\nRayleigh-Be\u0301nard convection has been mainly studied in the Boussinesq approximation which is valid only for thin layers of fluid and cannot take into account the full thermodynamic description. We consider here Rayleigh-Be\u0301nard convection in the general compressible Navier-Stokes-Fourier equations, which are well adapted to treat deep convection.\nTaking a perfect gas with adiabatic exponent \u03b3 > 1, in a gravitational potential \u03c6 = gz, and assuming \u03bb = \u22122d\u00b5 (Stokes hypothesis), we consider the following nondimensional form of the equations:\n\u03c1(\u2202tu+ u \u00b7 \u2207u) = \u2212\u2207p\u2212 1\nFr \u03c1z\u0302 +\n1 Re div \u03a3, \u03a3 = Def u\u2212 1 d (div u)\u03b4\nT (D\u0304ts+ div js) = 1\nRe \u03a3:\u2207u\u2212 js \u00b7 \u2207T, js = \u2212\n1\nRe\n1\nPr\n\u03b3 \u03b3 \u2212 1 1 T \u2207T,\nwith Fr, Re, and Pr, the Froude, Reynold, and Prandtl numbers, respectively. We assume that the fluid moves in a 2D domain [0, 2] \u00d7 [0, 1] 3 (x, z) that is periodic in the x-direction, with no slip boundary condition u = 0 for the velocity at the top and bottom. We consider an initial temperature profile T (z) = 1 + Z(1\u2212 z) and initial velocity\nu(x, z) = (0, \u03c8(x, z)) ,\nwhere\n\u03c8(x, z) =\n{ exp ( 1\n(x\u22121)2+(z\u22120.5)2\u22120.2\n) if (x\u2212 1)2 + (z \u2212 0.5)2 < 0.2,\n0 otherwise.\nUsing the hydrostatic equilibrium \u2207p = \u2212 1Fr\u03c1z\u0302, one gets the initial mass density and pressure profiles \u03c1(z) = T (z)m and p(z) = T (z)m+1 with m = 1FrZ \u2212 1 the polytropic index.\nIn the Boussinesq case the critical conditions for the onset of convection are uniquely determined by a certain value of the Rayleigh number (e.g., [9]). In the compressible case, the situation is more involved since the critical value depends on other parameters, such as the temperature difference Z ([6, 1] and references therein). Following [37], we will use the following expression of the Rayleigh number in the compressible case:\nRa = Re2(m+ 1)Z2Pr(1\u2212 (\u03b3 \u2212 1)m)/\u03b3.\nDirichlet boundary conditions. In the series of experiments below, we fix \u03b3 = 1.1 and test the onset of Rayleigh-Be\u0301nard convection for several values of the four parameters Re, m, Z, Pr, for Dirichlet boundary conditions T (x, 0) = 1 +Z and T (x, 1) = 1, corresponding to the case of ideally conducting upper and lower plates. Starting with Re = 100, m = 0, Z = 0.419524, and Pr = 2.5, which corresponds to a flow with Rayleigh number 4000, we varied each of the four parameters individually to realize flows with Rayleigh numbers Ra \u2208 {2000, 3000, 4000, 5000, 6000}. We ran each of these simulations from time t = 0 to time t = 300 and plotted the evolution of the L2-norm of the velocity field in Figure 1. In our simulations, we used a uniform triangulation of \u2126 with maximum element diameter h = 0.0625, a time step \u2206t = 0.4, penalty parameter \u03b7 = 0.01\u03ba, and finite element spaces Vh = DG1(Th) and Ugradh = CG2(Th)\n2. One can see in Figure 1 that in each experiment, the flow begins to exhibit instability when the Rayleigh number exceeds a critical value lying somewhere between Ra = 4000 (the green curves) and Ra = 5000 (the blue curves), regardless of which of the four parameters Re, m, Z, Pr is varied.\nPrescribed heat flux boundary conditions. In order to illustrate the impact of the boundary condition on the critical value of the Rayleigh number, we repeat below the same experiments, now with prescribed heat flux boundary conditions jq \u00b7 n = q0 (nonhomogeneous Neumann boundary conditions). This boundary condition describes cases where the upper and lower plates conduct heat poorly compared with the fluid. In order to use exactly the same initial temperature profile, we set q0(x, 0) = \u2212 1Re 1 Pr \u03b3 \u03b3\u22121Z, q0(x, 1) = 1 Re 1 Pr \u03b3 \u03b3\u22121Z. This change of boundary condition is known to have a significant impact on the onset of convection by decreasing the critical Rayleigh number, see [30, 10] for the Boussinesq case. Figure 2 confirms this; one can see in Figure 2 that the flow begins to exhibit instability when the Rayleigh number exceeds a critical value lying somewhere\nbetween Ra = 2000 (the red curves) and Ra = 3000 (the yellow curves), regardless of which of the four parameters Re, m, Z, Pr is varied.\nWe also repeated the above experiment with Re = 100, m = 0, Z = 2, and Pr = 2.5, which corresponds to a much higher Rayleigh number Ra = 90909.1. We used a finer mesh with h = 0.03125. A plot of the computed temperature at time t \u2248 14.5 is shown in Figure 3. Note that since the prescribed heat flux q0 satisfies \u00b4 z=0 q0 da+ \u00b4 z=1 q0 da = 0, this system conserves energy (and mass) exactly in the continuous setting. The rightmost plot in Figure 3 shows that energy and mass are conserved to machine precision in the discrete setting as well."
        },
        {
            "heading": "A Finite dimensional guiding examples",
            "text": "The treatment of finite dimensional systems is useful for understanding several aspects of the variational formulation for the heat conducting viscous fluid, such as the occurrence of two entropy variables (S and \u03a3 in the Lagrangian description, s and \u03c2 in the Eulerian description) and the form of the constraints, especially in the case when the system is not adiabatically closed, which arises when the temperature is prescribed at the boundary. We follow the variational setting developed in [25] and [28] for adiabatically closed and for open systems.\nConsider a thermodynamic system described by a mechanical variable q \u2208 Q in a finite dimensional configuration manifold and an entropy variable S \u2208 R. We assume the system has a Lagrangian L : TQ\u00d7R\u2192 R and involves a friction force F fr : TQ\u00d7R\u2192 T \u2217Q, with F fr(q, v, S) \u2208 T \u2217qQ.\nThe total energy and the temperature of the system are defined from L by\nE =\n\u2329 \u2202L\n\u2202q\u0307 , q\u0307\n\u232a \u2212 L and T = \u2212\u2202L\n\u2202S . (75)\nIt is assumed that the Lagrangian is such that T > 0 for all (q, v, S).\nAdiabatically closed system. When the system does not interact with its surroundings, the variational formulation is given as follows: find the curves q(t) \u2208 Q, S(t) \u2208 R which are critical for the variational condition\n\u03b4 \u02c6 t1 t0 L(q, q\u0307, S)dt = 0, (76)\nsubject to the phenomenological constraint\n\u2202L \u2202S S\u0307 =\n\u2329 F fr, q\u0307 \u232a , (77)\nand for variations subject to the variational constraint\n\u2202L \u2202S \u03b4S =\n\u2329 F fr, \u03b4q \u232a , (78)\nwith \u03b4q(t0) = \u03b4q(t1) = 0. A direct application of (76)\u2013(78) yields the coupled mechanical-thermal evolution equations:\nd\ndt\n\u2202L \u2202q\u0307 \u2212 \u2202L \u2202q = F fr, \u2202L \u2202S S\u0307 =\n\u2329 F fr, q\u0307 \u232a . (79)\nWith these equations, one directly gets the balance of total energy, see (75), and entropy\nE\u0307 = 0 and S\u0307 = \u2212 1 T\n\u2329 F fr, q\u0307 \u232a . (80)\nIn particular, the second law requires that the force F fr must be dissipative. A time discretization of this variational approach has been proposed in [27, 11].\nSystem with a heat source. Assume that the system has an external heat source of temperature TH with an entropy flow JS,H . The variational formulation needs the introduction of two additional variables, namely, (i) the thermal displacement \u0393 with \u0393\u0307 = T the temperature and (ii) the entropy variable \u03a3 with \u03a3\u0307 = I \u2265 0 the rate of internal entropy production. The two relations \u0393\u0307 = T and \u03a3\u0307 = I are not imposed a priori but follow from the variational formulation. For such systems the variational formulation is given as follows: find the curves q(t) \u2208 Q, S(t),\u0393(t),\u03a3(t) \u2208 R which are critical for the variational condition\n\u03b4 \u02c6 t1 t0 [ L(q, q\u0307, S) + \u0393\u0307(S \u2212 \u03a3) ] dt = 0, (81)\nsubject to the kinematic constraint\n\u2202L \u2202S \u03a3\u0307 =\n\u2329 F fr, q\u0307 \u232a + JS,H(\u0393\u0307\u2212 TH) (82)\nand for variations subject to the variational constraint\n\u2202L \u2202S \u03b4\u03a3 =\n\u2329 F fr, \u03b4q \u232a + JS,H\u03b4\u0393, (83)\nwith \u03b4q|t=t0,t1 = 0. Application of (81)\u2013(83) yields the conditions\n\u03b4q : d\ndt\n\u2202L \u2202q\u0307 \u2212 \u2202L \u2202q = F fr, \u03b4S : \u0393\u0307 = \u2212\u2202L \u2202S , \u03b4\u0393 : S\u0307 = \u03a3\u0307 + JS,H .\nThe second condition imposes that \u0393 is the thermal displacement while the third condition splits the rate of entropy production S\u0307 as the sum of the rate of internal entropy production \u03a3\u0307 and the entropy flow rate JS,H . Finally, one gets the coupled mechanical-thermal evolution equations:\nd\ndt\n\u2202L \u2202q\u0307 \u2212 \u2202L \u2202q = F fr, \u2202L \u2202S (S\u0307 \u2212 JS,H) =\n\u2329 F fr, q\u0307 \u232a + JS,H ( \u2212 \u2202L \u2202S \u2212 TH ) . (84)\nWith this system, the balance of energy and entropy (80) is modified as\nE\u0307 = THJS,H and S\u0307 = \u2212 1\nT\n\u2329 F fr, q\u0307 \u232a \u2212 1 T JS,H(T \u2212 TH) + JS,H . (85)\nThe second law requires that \u2212 1T \u2329 F fr, q\u0307 \u232a \u2265 0 and \u2212 1T JS,H(T \u2212 TH) \u2265 0, while the entropy flow JS,H can have an arbitrary sign.\nStructure of the variational formulation. In the adiabatically closed case, one passes from the phenomenological constraint (77) to the variational constraint (78) by formally replacing the time rate of changes (here S\u0307 and q\u0307) by \u03b4-variations (here \u03b4S and \u03b4q). This is a general variational setting for adiabatically closed systems, see [25], which is reminiscent of the Lagrange-d\u2019Alembert principle used in nonholonomic mechanics. The same approach is used to pass from the phenomenological constraint (4) to the variational constraint (5) for fluids in the adiabatically closed case.\nIn the case with a heat source the kinematic constraint is affine in the rate of changes, hence one passes from (82) to (83) by formally replacing the rate of changes (here S\u0307, q\u0307, and \u0393\u0307) by \u03b4-variations (here \u03b4S, \u03b4q, and \u03b4\u0393) and by removing the affine terms associated to the exterior (here JS,HTH). This is a general approach for open systems, see [28]. It is used to pass from the constraint (20) to the constraint (21) for fluids with prescribed boundary temperature\nB Variational derivation of heat conducting viscous fluid equations\nB.1 Lagrangian description\nIn the Lagrangian description, the computation of the critical condition is much simpler than its Eulerian counterpart and follows closely its finite dimensional analogue mentioned above.\nFor the adiabatically closed case, one gets from (3)\u2013(5) the fluid conducting viscous fluid equation in Lagrangian form as d dt \u03b4L \u03b4\u03d5\u0307 \u2212 \u03b4L \u03b4\u03d5 = DIVP \u2212\u03b4L \u03b4S (S\u0307 + DIV JS) = P : \u2207\u03d5\u0307+ JS \u00b7 \u2207 \u03b4L \u03b4S , (86)\ntogether with the conditions\n\u0393\u0307 = \u2212\u03b4L \u03b4S , \u03a3\u0307 = S\u0307 + DIV JS and JS \u00b7 n = 0 on \u2202\u2126 (87)\nassociated to the variations \u03b4S and \u03b4\u0393. Since \u2212\u03b4L/\u03b4S > 0 is identified with the temperature, the first condition implies that \u0393 is the thermal displacement. The expression S\u0307+ DIV JS is the rate of internal entropy production, positive by the second law, hence the second condition implies that \u03a3 is the internal entropy density. The last condition is the insulated boundary condition. It follows from the variation \u03b4\u0393 on the boundary \u2202\u2126 and implies that the fluid system is adiabatically closed.\nFor the case with prescribed boundary temperature, one applies the variational principle (3)- (20)-(21) and directly gets the equations (86) and (87) with the last equation of (87) replaced by the boundary condition\n(Js \u00b7 n)(T\u2212 T0) = 0 on \u2202\u2126.\nHere T = \u2212\u03b4L/\u03b4S is the temperature in the Lagrangian frame.\nB.2 Neumann boundary conditions\nWe show that the variational formulation (9)\u2013(12) yields the equations (14) together with the conditions (15).\nTaking the variations in (9) and using \u03b4\u03b3|t=t0,t1 = 0 and u|\u2202\u2126 = 0, we get \u02c6 T\n0 \u02c6 \u2126 [ \u03b4` \u03b4u \u00b7 \u03b4u+ \u03b4` \u03b4\u03c1 \u03b4\u03c1+ \u03b4` \u03b4s \u03b4s+ \u03b4sDt\u03b3 \u2212 \u03b4\u03c2Dt\u03b3 \u2212 D\u0304t(s\u2212 \u03c2)\u03b4\u03b3 + (s\u2212 \u03c2)\u2207\u03b3 \u00b7 \u03b4u ] dxdt = 0. (88)\nSince \u03b4s is arbitrary, we get the condition\nDt\u03b3 = \u2212 \u03b4`\n\u03b4s (89)\nthereby recovering the first condition in (15). Making use of this condition and of the variational constraint (11) yields\n\u02c6 T 0 \u02c6 \u2126 [ \u03b4` \u03b4u \u00b7 \u03b4u+ \u03b4` \u03b4\u03c1 \u03b4\u03c1\u2212 \u03c3 : \u2207v + js \u00b7 \u2207(\u03b4\u03b3 + v \u00b7 \u2207\u03b3)\u2212 div(\u03c2v) \u03b4` \u03b4s\n\u2212 D\u0304t(s\u2212 \u03c2)\u03b4\u03b3 + (s\u2212 \u03c2)\u2207\u03b3 \u00b7 \u03b4u ] dxdt = 0.\n(90)\nSince \u03b4\u03b3 is arbitrary, we get\nD\u0304t\u03c2 = D\u0304ts+ div js and js \u00b7 n = 0 on \u2202\u2126 (91)\nthereby recovering the second and third conditions in (15). Having found these conditions, we now use v|\u2202\u2126 = 0 and the second condition of (12), i.e. \u03b4\u03c1 = \u2212div(\u03c1v), to rewrite (90) in the form\u02c6 t1\nt0\n\u02c6 \u2126 [( \u03b4` \u03b4u + (s\u2212 \u03c2)\u2207\u03b3 ) \u00b7 \u03b4u+ ( \u03c1\u2207 \u03b4` \u03b4\u03c1 + \u03c2\u2207 \u03b4` \u03b4s + div \u03c3 ) \u00b7 v \u2212 (div js)v \u00b7 \u2207\u03b3 ] dxdt = 0.\nUsing the first condition of (12), i.e. \u03b4u = \u2202tv + [u, v], integrating by parts, and using the identity (\u2202t + \u00a3u) ( (s\u2212 \u03c2)\u2207\u03b3 ) = D\u0304t(s\u2212 \u03c2)\u2207\u03b3 + (s\u2212 \u03c2)\u2207Dt\u03b3 = \u2212div js\u2207\u03b3 \u2212 (s\u2212 \u03c2)\u2207 \u03b4`\n\u03b4s ,\nwith \u00a3u the Lie derivative of one-form densities, we get the first equation in (14). The second equation in (14) follows from the phenomenological constraint (10) together with (89) and the first condition in (91).\nB.3 Dirichlet boundary conditions\nWe briefly explain how the variational formulation (9)-(22)-(23)-(12) yields the equations (14) together with the conditions in (15), with the last one replaced by (24).\nWe proceed similarly as in \u00a7B.2 before. Making use of (23) instead of (11) we get only the first condition in (91), namely\nD\u0304t\u03c2 = D\u0304ts+ div js (92)\nsince the boundary term involving js \u00b7 n is cancelled by the additional term in the constraint (23). The first equation in (14) follows exactly as before. Now the kinematic constraint (22), together with (89) and the first condition in (91) give both the second equation in (14) and the boundary condition (24).\nB.4 Weak forms\nAs explained in \u00a72.3, the constraints (10)\u2013(11) and (22)\u2013(23) can be written in a unified way by using the expressions d(\u00b7, \u00b7, \u00b7) and e(\u00b7, \u00b7), see (30)\u2013(31). The computations reviewed above can be equivalently formulated with these expressions. However, it is useful to explain how the form of the entropy equation (the second equation in (32)) emerges since its form plays a crucial role in our approach.\nAfter taking the variation as earlier in (88), one uses in it the variational constraint with w = 1, i.e. \u2329\n1, \u03b4`\n\u03b4s D\u0304\u03b4\u03c2\n\u232a = \u2212c(1, u, v) + d ( 1,\u2212 \u03b4`\n\u03b4s ,D\u03b4\u03b3\n) .\nProceeding as earlier, this yields\u2329 D\u0304t(\u03c2 \u2212 s), \u03b4\u03b3 \u232a = \u2212d ( 1,\u2212 \u03b4` \u03b4s , \u03b4\u03b3 ) , \u2200 \u03b4\u03b3 (93)\nwhich is the weak form of both (91) and (92) depending on the boundary conditions considered. One finally gets the first equation in (32), while the second equation in (32) follows from the kinematic constraint (30) in which (93) is used with \u03b4\u03b3 = w \u03b4`\u03b4s . This explains the very specific forms of the two terms involving d(\u00b7, \u00b7, \u00b7) in the weak form of the entropy equation, namely\nd (\n1,\u2212 \u03b4` \u03b4s , \u03b4` \u03b4s w ) and d ( w,\u2212 \u03b4` \u03b4s , \u03b4` \u03b4s ) ."
        }
    ],
    "title": "Variational and thermodynamically consistent finite element discretization for heat conducting viscous fluids",
    "year": 2022
}