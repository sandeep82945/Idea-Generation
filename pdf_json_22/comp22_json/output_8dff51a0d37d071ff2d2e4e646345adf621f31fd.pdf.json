{
    "abstractText": "In this work, we analyse and design feedback policies for discrete-time Piecewise-Affine (PWA) systems with uncertainty in both the affine dynamics and the polytopic partition. The main idea is to utilise the Difference-of-Convex (DC) decomposition of continuous PWA systems to derive quadratic Lyapunov functions as stability certificates and stabilizing affine policies in a higher dimensional space. When projected back to the state space, we obtain time-varying PWQ Lyapunov functions and time-varying PWA feedback policies.",
    "authors": [
        {
            "affiliations": [],
            "name": "Siddharth H. Nair"
        },
        {
            "affiliations": [],
            "name": "Yvonne R. St\u00fcrz"
        }
    ],
    "id": "SP:51815d39f718a4bc229e590b4d5405957ca02f73",
    "references": [
        {
            "authors": [
                "E. Sontag"
            ],
            "title": "Nonlinear regulation: The piecewise linear approach",
            "venue": "IEEE Transactions on automatic control, vol. 26, no. 2, pp. 346\u2013358, 1981.",
            "year": 1981
        },
        {
            "authors": [
                "W.P. Heemels",
                "B. De Schutter",
                "A. Bemporad"
            ],
            "title": "Equivalence of hybrid dynamical models",
            "venue": "Automatica, vol. 37, no. 7, pp. 1085\u20131091, 2001.",
            "year": 2001
        },
        {
            "authors": [
                "A.B. Hempel",
                "P.J. Goulart",
                "J. Lygeros"
            ],
            "title": "Every continuous piecewise affine function can be obtained by solving a parametric linear program",
            "venue": "2013 European Control Conference (ECC), pp. 2657\u2013 2662, IEEE, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "G. Ferrari-Trecate",
                "F.A. Cuzzola",
                "D. Mignone",
                "M. Morari"
            ],
            "title": "Analysis of discrete-time piecewise affine and hybrid systems",
            "venue": "Automatica, vol. 38, no. 12, pp. 2139\u20132146, 2002.",
            "year": 2002
        },
        {
            "authors": [
                "D. Mignone",
                "G. Ferrari-Trecate",
                "M. Morari"
            ],
            "title": "Stability and stabilization of piecewise affine and hybrid systems: An lmi approach",
            "venue": "Proceedings of the 39th IEEE Conference on Decision and Control (Cat. No. 00CH37187), vol. 1, pp. 504\u2013509, IEEE, 2000.",
            "year": 2000
        },
        {
            "authors": [
                "M. Hovd",
                "S. Olaru"
            ],
            "title": "Relaxing pwq lyapunov stability criteria for pwa systems",
            "venue": "Automatica, vol. 49, no. 2, pp. 667\u2013670, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "M. Rubagotti",
                "S. Trimboli",
                "D. Bernardini",
                "A. Bemporad"
            ],
            "title": "Stability and invariance analysis of approximate explicit mpc based on pwa lyapunov functions",
            "venue": "IFAC Proceedings Volumes, vol. 44, no. 1, pp. 5712\u20135717, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Prajna",
                "A. Papachristodoulou"
            ],
            "title": "Analysis of switched and hybrid systems-beyond piecewise quadratic methods",
            "venue": "Proceedings of the 2003 American Control Conference, 2003., vol. 4, pp. 2779\u20132784, IEEE, 2003.",
            "year": 2003
        },
        {
            "authors": [
                "A. Bemporad",
                "F. Borrelli",
                "M. Morari"
            ],
            "title": "Optimal controllers for hybrid systems: Stability and piecewise linear explicit form",
            "venue": "Proceedings of the 39th IEEE Conference on Decision and Control, vol. 2, pp. 1810\u20131815, IEEE, 2000.",
            "year": 1810
        },
        {
            "authors": [
                "F. Borrelli",
                "M. Baoti\u0107",
                "A. Bemporad",
                "M. Morari"
            ],
            "title": "Dynamic programming for constrained optimal control of discrete-time linear hybrid systems",
            "venue": "Automatica, vol. 41, no. 10, pp. 1709\u20131721, 2005.",
            "year": 2005
        },
        {
            "authors": [
                "E.C. Kerrigan",
                "D.Q. Mayne"
            ],
            "title": "Optimal control of constrained, piecewise affine systems with bounded disturbances",
            "venue": "Proceedings of the 41st IEEE Conference on Decision and Control, 2002., vol. 2, pp. 1552\u20131557, IEEE, 2002.",
            "year": 2002
        },
        {
            "authors": [
                "Y. Gao",
                "Z. Liu",
                "H. Chen"
            ],
            "title": "Robust h-\u221e control for constrained discrete-time piecewise affine systems with time-varying parametric uncertainties",
            "venue": "IET control theory & applications, vol. 3, no. 8, pp. 1132\u20131144, 2009.",
            "year": 2009
        },
        {
            "authors": [
                "S. Trimboli",
                "M. Rubagotti",
                "A. Bemporad"
            ],
            "title": "Stability and invariance analysis of uncertain pwa systems based on linear programming",
            "venue": "2011 50th IEEE Conference on Decision and Control and European Control Conference, pp. 7398\u20137403, IEEE, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "M. Hovd",
                "S. Olaru"
            ],
            "title": "Parameter-dependent pwq lyapunov function stability criteria for uncertain piecewise linear systems",
            "venue": "2018.",
            "year": 2018
        },
        {
            "authors": [
                "A.B. Hempel",
                "P.J. Goulart",
                "J. Lygeros"
            ],
            "title": "Inverse parametric optimization with an application to hybrid system control",
            "venue": "IEEE Transactions on automatic control, vol. 60, no. 4, pp. 1064\u20131069, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "L.B. Groff",
                "G. Valm\u00f3rbida",
                "J.M.G. da Silva"
            ],
            "title": "Stability analysis of piecewise affine discrete-time systems",
            "venue": "2019 IEEE 58th Conference on Decision and Control (CDC), pp. 8172\u20138177, IEEE, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "A. Aydinoglu",
                "V.M. Preciado",
                "M. Posa"
            ],
            "title": "Contact-aware controller design for complementarity systems",
            "venue": "arXiv preprint arXiv:1909.11221, 2019.",
            "year": 1909
        },
        {
            "authors": [
                "S.H. Nair",
                "M. Bujarbaruah",
                "F. Borrelli"
            ],
            "title": "Modeling of dynamical systems via successive graph approximations",
            "venue": "IFAC-PapersOnLine, vol. 53, no. 2, pp. 977\u2013982, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "R.J. Caverly",
                "J.R. Forbes"
            ],
            "title": "Lmi properties and applications in systems, stability, and control theory",
            "venue": "arXiv preprint arXiv:1903.08599, 2019.",
            "year": 1903
        }
    ],
    "sections": [
        {
            "text": "I. INTRODUCTION\nA discrete-time Piecewise-Affine (PWA) system is described by the dynamics\nx(t+ 1) = f(x(t), u(t)) (1) = Aix(t) +Biu(t) + ci, \u2200(x(t), u(t)) \u2208 \u2126i\nwhere x(t), u(t) are the state and input respectively at time t, and \u2126i, i = 1, . . . , nr form a polytopic partition of the state and input space \u2126 = X \u00d7U \u2282 Rn+m, denoted as \u222a\u2126i = \u2126. PWA systems are a versatile modeling framework; They can approximate smooth nonlinear dynamics arbitrarily well [1] and have also been shown to be equivalent to certain classes of hybrid systems such as Mixed Logical Dynamical (MLD) systems and Linear Complementarity (LC) systems under mild conditions [2]. More recently in [3], it was shown that continuous PWA systems can be written as the difference of two continuous convex PWA functions and that they can be written as optimizing processes.\nThe analysis and control of PWA systems has been widely studied in the literature. In [4], [5], [6], stabilizing feedback controllers are synthesized using quadratic and Piecewise-Quadratic (PWQ) Lyapunov functions as stability certificates. PWQ Lyapunov functions, being a generalisation of quadratic Lyapunov functions, provide less conservative stability certificates but are more difficult to synthesize. They require an explicit description of the polytopic partition t\u2126i = \u2126 and need to account for all possible transitions between the polytopic pieces \u2126i explicitly. Similarly, the works [7], [8] consider piecewise-linear and piecewisepolynomial Lyapunov functions for stability. A significantly more challenging problem is the synthesis of optimal feedback control of PWA systems, studied in [9], [10], [11]. Here, the control problem is complicated by the fact that the stabilizing controller must transition between polytopic parititions in an optimal fashion over a finite-time horizon. In this article, we focus on the simpler task of synthesizing stabilizing feedback control but for uncertain PWA systems.\nEmail IDs:{siddharth nair, y.stuerz}@berkeley.edu\nA PWA system is said to be uncertain if the dynamics function f(\u00b7) is not known exactly. Uncertain PWA systems are relatively less studied in the literature due to the complexity of uncertain switching systems. The uncertainty descriptions considered in the literature assume some form of parametric uncertainty in the matrices Ai, Bi, ci but with known, static partition \u222a\u2126i = \u2126 [12], [13], [14]. This uncertainty description is justified when the PWA framework is used to approximate a smooth nonlinear system. However for a system that is inherently hybrid and uncertain, the polytopic partition \u222a\u2126i(t) = \u2126 itself may be dynamic with time-varying polytopic pieces \u2126i(t).\nIn this article, we investigate the control of uncertain PWA systems where both the affine dynamics and the polytopic partition are uncertain leveraging results in the control and analysis of nominal PWA systems from [15], [16], [17]. The main challenge in the synthesis of stabilizing control of such systems is the derivation of a stability certificate that does not require an explicit description of the uncertain, timevarying polytopic partition \u222a\u2126i(t) = \u2126. An obvious solution to this problem would be to construct a common quadratic Lyapunov function on the state space but this has been shown to be overly conservative [4]. We show how this issue can be addressed for continuous PWA systems for which a Difference of Convex (DC) functions decomposition can be derived [3]. Inspired by graph approximation techniques in [16], [17], [18], we show that the DC decomposition permits a construction of affine stabilizing policies with quadratic Lyapunov functions in a higher dimensional space, which when projected back to the state space result in time-varying PWA policies and time-varying PWQ Lyapunov functions.\nThe remainder of the article is organized as follows. We briefly discuss our notations in Section II before formally stating our problem statement in Section III. Section IV presents the key technique we use for expressing the PWA dynamics in a higher dimensional space. Section V describes our synthesis procedure in detail which we demonstrate on two applications in Section VI."
        },
        {
            "heading": "II. NOTATION",
            "text": "\u2016 \u00b7 \u2016 denotes the Euclidean norm in Rn unless explicitly stated otherwise. With slight abuse of notation, \u2016 \u00b7 \u2016 also denotes the norm on Rn\u00d7n induced by the Euclidean norm. In \u2208 Rn\u00d7n is the identity matrix and 0 is a matrix of zeros with relevant dimensions. [x]i denotes the ith element of vector x \u2208 Rn, [M ]ij denotes the ith element in the jth column of matrix M \u2208 Rn\u00d7m and [M ]i denotes its ith column. We denote the Hermitian of a real square matrix M\nar X\niv :2\n20 9.\n12 99\n0v 2\n[ m\nat h.\nO C\n] 2\n0 M\nar 2\n02 3\nas He(M) = M+M > 2 . Given matrices A1, . . . , AN \u2208 R n\u00d7m, we denote their convex hull as the set conv{Ak}Nk=1 \u2282 Rn\u00d7m. Given matrices A1, . . . AN \u2208 Rn\u00d7n, we denote by blkdiag(A1, . . . , AN ) \u2208 RNn\u00d7Nn as the matrix with block diagonals given by A1, . . . , AN and zeros everywhere else. As a shorthand, we write the symmetric block matrix[ A B B> C ] as [ A B ? C ] ."
        },
        {
            "heading": "III. PROBLEM FORMULATION",
            "text": "We start with the Difference of Convex (DC) decomposition of f(\u00b7) in (1). As shown in [3], all continuous PWA functions defined on convex polytopes admit a DC decomposition and so we restrict our focus to such systems.\nAssumption 1: The PWA system dynamics f(\u00b7) in (1) is continuous \u2200(x(t), u(t)) \u2208 \u2126 where \u2126 = X \u00d7U is a convex set with polyhedral partition \u2126 = \u222a\u2126i. Consider the DC decomposition of the dynamics (1) given by\nx(t+ 1) = Ax(t) + \u03b3(x(t))\u2212 \u03b7(x(t)) +Bu(t), (2) [\u03b3(x)]i = max\n1\u2264j\u2264\u03b1 [Ej ]ix+ [dj ]i,\n[\u03b7(x)]i = max 1\u2264l\u2264\u03b2 [Hl]ix+ [fl]i, i = 1, . . . , n\nwhere without loss of generality, we have assumed that the convex functions \u03b3(\u00b7), \u03b7(\u00b7) are functions of state x(t) only and the number of affine functions \u03b1 and \u03b2 for \u03b3(\u00b7) and \u03b7(\u00b7) respectively are the same for each dimension i = 1, . . . , n. This DC decomposition can be obtained using the constructive procedure outlined in Lemma 4 of [3].\nRemark 1: If \u03b3(\u00b7), \u03b7(\u00b7) are functions of u, we augment the state space as x\u0303 = [x>u>] by adding integrators.\nRemark 2: If [\u03b3(x)]i = max1\u2264j\u2264\u03b1i [Ej ]ix+ [dj ]i, define \u03b1 = max1\u2264i\u2264n \u03b1i and add \u03b1 \u2212 \u03b1i affine functions that lower bound the convex function [\u03b3(x)]i on the set X to get [\u03b3(x)]i = max1\u2264j\u2264\u03b1 [Ej ]ix+[dj ]i. A similar procedure can be repeated for \u03b7(x). Suppose that the DC system in (2) is uncertain, i.e., the matrices Ej , dj , Hj , fj are uncertain and time-varying, but bounded. We formalize this in the assumption below.\nAssumption 2: The matrix-valued random variable W(t) \u2208 Rn\u00d7(n+1)(\u03b1+\u03b2) given by\nW(t) = [E1(t) d1(t) . . . E\u03b1(t) d\u03b1(t) H1(t) f1(t)\n. . . H\u03b2(t) f\u03b2(t)]\nis independent, identically distributed (i.i.d) for all time t \u2265 0 and supported on a known compact convex polytope W = conv{W k}nVk=1 \u2282 Rn\u00d7(n+1)(\u03b1+\u03b2) where W k = [Ek1 d k 1 . . . E k \u03b1 d k \u03b1 H k 1 f k 1 . . . H k \u03b2 f k \u03b2 ]. To emphasize that system (2) is time-varying, we write the uncertain convex functions as \u03b3(t, x(t)), \u03b7(t, x(t)). This system description captures the scenario of PWA systems with uncertainty in both the PWA function definitions (Ai, Bi, ci for (1)) and the polytopic partitions (\u2126i for (1)).\nWe also assume that the origin x = 0 is an unforced (u = 0) equilibrium for (2). More formally, we assume the following matching condition.\nAssumption 3: The origin is an unforced equilibrium of system (2), i.e.,\n\u03b3(t,0) = \u03b7(t,0) \u2200W(t) \u2208 W, t \u2265 0\u21d4 max 1\u2264j\u2264\u03b1 [dkj ]i = max 1\u2264l\u2264\u03b2 [fkl ]i\nfor all i = 1, . . . , n and k = 1, . . . , nV . In this article, we aim to synthesize PWA feedback policies\nu(t, x) = Fi(t)x+ gi(t) \u2200x \u2208 X\u0303i(t) (3)\nwith disjoint partition X\u0303i(t), s.t. \u222aX\u0303i(t) = X , such that the origin is exponentially stable for the closed-loop system. Notice that the partition on which the policy is defined is time-varying. This class of uncertain PWA systems has not been studied in the literature to the best of our knowledge. Most approaches for feedback control synthesis for PWA systems in the literature rely on an explicit description of the static polytopic partitions and construct affine policies local to each partition. This is impossible for the PWA systems considered in this work because the polytopic partitions are dynamic (time-varying) and unknown. Therefore, to deal with these uncertain hybrid systems, we present a technique that allows us to design PWA policies without explicitly computing the polytopic partitions. We illustrate our approach on two uncertain PWA systems in Section VI: A) an inverted pendulum against a soft wall and B) a robot collaborating with a human to transport a payload."
        },
        {
            "heading": "IV. LIFTED QUADRATIC REPRESENTATIONS FOR CONVEX PIECEWISE AFFINE FUNCTIONS",
            "text": "In this section, we describe the key technique for verifying if a continuous PWA function satisfies a given quadratic inequality without explicitly computing the polytopic partitions. First, consider the element-wise convex PWA function \u03bb : Rn \u2192 Rn,\n\u03bb(x) = max 1\u2264j\u2264\u03be\n{Ejx+ dj}\nwhere the max{\u00b7} operation is defined element-wise. Recursively define the following functions\n\u03bbj(x) = max{\u03bbj\u22121(x), Ejx+ dj} j = 2, . . . , \u03be (4)\nwith \u03bb1(x) = E1x+ d1. Note that due to the fact that the max{\u00b7} operation can be equivalently written in a nested fashion (for e.g., max{p, q, r} = max{max{p, q}, r}), we actually have \u03bb\u03be(x) = \u03bb(x).\nEach function \u03bbj(x) defined in (4) can be equivalently written as the unique solution to 2n affine inequalities and 1 quadratic equality in (x, \u03bbj\u22121(x)) as shown below.\n\u03bb1(x) = E1x+ d1,\n\u03bbj(x) \u2265 \u03bbj\u22121(x), \u03bbj(x) \u2265 Ejx+ dj , (5) (\u03bbj(x)\u2212 \u03bbj\u22121(x))>(\u03bbj(x)\u2212 Ejx\u2212 dj) = 0, j = 2, . . . , \u03be.\nGiven any x \u2208 Rn, the functions \u03bbj(x) \u2200j = 1, . . . , \u03be are the unique solutions to (5). Consequently, the function \u03bb(x) (or equivalently, its graph (x, \u03bb(x))) is given by the solution to a set of affine inequalities and quadratic equalities given in (5)\nin the space (x, \u03bb1, . . . , \u03bb\u03b1) \u2208 Rn(\u03be+1) where x, \u03bb1, . . . , \u03bb\u03b1 are arbitrary variables. The next proposition offers a useful tool to construct a convex relaxation of the set of solutions (x, \u03bb(x)) given by (5).\nProposition 1: Let\n\u03c7(x) = [1 x> \u03bb1(x) > \u03bb2(x) > . . . \u03bb\u03be(x) >]>\nand define the selection matrices Sj \u2208 R(1+3n)\u00d7(n(\u03be+1)+1) such that Sj\u03c7(x) = [1 x> \u03bbj\u22121(x)> \u03bbj(x)>]> for j = 2, . . . , \u03be and S1 \u2208 R(1+2n)\u00d7(n(\u03be+1)+1) such that S1\u03c7(x) = [1 x> \u03bb1(x)\n>]>. Given any diagonal matrices Dj \u2208 Rn\u00d7n and any non-negative matrices Mj \u2208 R+\nn\u00d7n \u2200j = 1, . . . , \u03be, define the set\nX(x) = {\u03c7 = [1 x> \u03bb>1 . . . \u03bb>\u03be ]> \u2208 Rn(\u03be+1)+1 : \u03c7>S>j G > j DjG\u0304jSj\u03c7 = 0, \u03c7 >S>j G > j MjG\u0304jSj\u03c7 \u2265 0\n\u2200j = 1, . . . , \u03be.} (6)\nwhere Gj = [0 0 \u2212 In In], G\u0304j = [\u2212dj \u2212 Ej 0 In] for j = 2, . . . \u03be and G1 = [1 0 0], G\u03041 = [\u2212d1 \u2212 E1 In]. Then\n\u03c7(x) \u2208 X(x). Proof: First see that for any j = 2, . . . , \u03be, we have GjSj\u03c7(x) = \u03bbj(x) \u2212 \u03bbj\u22121(x) and G\u0304jSj\u03c7(x) = \u03bbj(x) \u2212 Ajx\u2212 dj . For the equality in (5), we have\n(\u03bbj(x)\u2212 \u03bbj\u22121(x))>(\u03bbj(x)\u2212 Ejx\u2212 dj) = 0 \u21d2([\u03bbj(x)\u2212 \u03bbj\u22121(x)]i)[Dj ]ii([\u03bbj(x)\u2212 Ejx\u2212 dj ]i) = 0,\n\u2200i = 1, . . . , n \u21d4\u03c7>S>j G>DjG\u0304jSj\u03c7 = 0\nwhere Dj \u2208 Rn\u00d7n is any diagonal matrix. For the inequalities in (5), we have for any non-negative matrix Mj \u2208 R+n\u00d7n that\n\u03bbj(x) \u2265 \u03bbj\u22121(x), \u03bbj(x) \u2265 Ejx+ dj \u21d2 ([\u03bbj(x)\u2212 \u03bbj\u22121(x)]i)([\u03bbj(x)\u2212 Ejx\u2212 dj ]k) \u2265 0,\n\u2200i, k = 1, . . . , n \u21d2 ([\u03bbj(x)\u2212 \u03bbj\u22121(x)]i)[Mj ]ik([\u03bbj(x)\u2212 Ejx\u2212 dj ]k) \u2265 0,\n\u2200i, k = 1, . . . , n \u21d4\u03c7>S>j G>MjGjSj\u03c7 \u2265 0.\nFor j = 1, see that G1S1\u03c7(x) = 1 and G\u03041S1\u03c7(x) = \u03bb1(x)\u2212E1x\u2212d1. Proceeding as above, we get the result for j = 1 where the inequality \u03c7(x)S>1 G > 1 M1G\u03041S1\u03c7(x) \u2265 0 holds trivially with equality. The above proposition provides us with a tool to construct a sufficiency certificate for a quadratic inequality [1 x> \u03bb>1 . . . \u03bb > \u03be ]P [1 x > \u03bb>1 . . . \u03bb > \u03be ] > \u2265 0 to hold given that [1 x>\u03bb>1 . . . \u03bb > \u03be ] > = \u03c7(x). Using the S-procedure, if \u2203Dj \u2208 Rn\u00d7n,Mj \u2208 R+ n\u00d7n for j = 1, . . . , \u03be such that\nP \u2212 \u03be\u2211 j=1 He(S>j G > j (Mj +Dj)G\u0304jSj) \u2265 0,\nthen \u03c7(x)>P\u03c7(x) \u2265 0. This can be readily verified by multiplying both sides of the above inequality by \u03c7(x) and using Proposition 1.\nTo use Proposition 1 for a general continuous PWA function \u03bb : Rn \u2192 Rn, we first obtain its DC decomposition \u03bb(x) = \u03b3(x)\u2212\u03b7(x). Then we can use proposition 1 for \u03b3(\u00b7) and \u03b7(\u00b7) to characterize the set (x, \u03b3(x), \u03b7(x)) in the space (x, \u03b31, . . . , \u03b3\u03b1, \u03b71, . . . , \u03b7\u03b2) \u2208 Rn(1+\u03b1+\u03b2). We illustrate this procedure by synthesizing a PWA policy and PWQ Lyapunov function for the uncertain DC system (2)."
        },
        {
            "heading": "V. SYNTHESIS OF STABILIZING PWA POLICIES",
            "text": "In this section, we provide a procedure for synthesizing stabilizing PWA feedback policies for uncertain DC systems (2) using PWQ Control Lyapunov Functions (CLFs) as stability certificates. First, we provide conditions under which a function qualifies as a CLF which in turn, establishes the existence of a stabilizing controller for system (2). Second, we propose a redefinition of the DC decomposition in model (2) without changing the system dynamics. Finally, we use the redefined model to synthesize a PWQ CLF and a PWA control policy using Linear Matrix Inequalties (LMIs)."
        },
        {
            "heading": "A. Stability via Control Lyapunov Functions",
            "text": "Lemma 1: Suppose that there exists a function V : R+ \u00d7 X \u2192 R and scalars \u03c11, \u03c12 \u2208 R+, \u03c13 \u2208 (0, 1) such that:\n1) \u03c11\u2016x\u20162 \u2264 V (t, x) \u2264 \u03c12\u2016x\u20162 \u2200x \u2208 X , t \u2265 0 2) \u2200t \u2265 0, x(t) \u2208 X ,\u2203u\u2217(t, x(t)) \u2208 U :\nV (t+ 1, x(t+ 1)) \u2264 \u03c13V (t, x(t)), \u2200W(t) \u2208 W . Then V (t, x) is a Control Lyapunov function for system (2), and the origin of the closed-loop system with u(t) = u\u2217(t, x(t)) is exponentially stable.\nProof: Let V (t, x) be a CLF for system (2). Then for any initial condition x(0) = x0 \u2208 X , we have V (0, x(0)) \u2264 \u03c12\u2016x0\u20162 using the second inequality in property 1). Using property 2) for trajectories of the uncertain system (2) in closed-loop with u\u2217(t, x(t)), we also have\nV (t, x(t)) \u2264 \u03c13V (t\u2212 1, x(t\u2212 1)) \u2264 \u00b7 \u00b7 \u00b7 \u2264 \u03c1t3V (0, x(0))\nfor all W(0), . . . ,W(t\u2212 1) \u2208 W . Using the first inequality in property 1), we get \u03c11\u2016x(t)\u20162 \u2264 V (t, x(t)). Combining these inequalities, we get \u2016x(t)\u2016 \u2264 \u221a \u03c1t3 \u03c12 \u03c11 \u2016x0\u2016 which in turn, implies limt\u2192\u221e \u2016x(t)\u2016 = 0 because \u03c13 \u2208 (0, 1) and \u03c12 \u03c11 > 0. Since x0 was arbitrary, the proof is complete. In order to present CLF candidates for system (2), we redefine its DC decomposition without effectively changing the dynamics in the next section."
        },
        {
            "heading": "B. Redefinition of DC Decomposition",
            "text": "Lemma 2: Let dk\u2217 \u2208 Rn such that\n[dk\u2217]i = max 1\u2264j\u2264\u03b1 [dkj ]i = max 1\u2264l\u2264\u03b2 [fkj ]i\nfor system (2), which exists by assumption 3. Let E\u0303kj = Ekj , d\u0303 k j = d k j \u2212 dk\u2217 , for j = 1, . . . , \u03b1 and H\u0303kj = Hkj , f\u0303kl = fkl \u2212dk\u2217 , for l = 1, . . . , \u03b2. Accordingly redefine the matrices\nW\u0303(t), W\u0303 k and polytope W\u0303 as in Assumption 2. Then the redefined DC decomposition of system (2) given by\nx(t+ 1) = Ax(t) + \u03b3\u0303(t, x(t))\u2212 \u03b7\u0303(t, x(t)) +Bu(t), (7) [\u03b3\u0303(t, x)]i = max\n1\u2264j\u2264\u03b1 [E\u0303j(t)]ix+ [d\u0303j(t)]i,\n[\u03b7\u0303(t, x)]i = max 1\u2264l\u2264\u03b2 [H\u0303l(t)]ix+ [f\u0303l(t)]i, i = 1, . . . , n\nsatisfies the following properties\n1) \u03b3(t, x)\u2212 \u03b7(t, x) = \u03b3\u0303(t, x)\u2212 \u03b7\u0303(t, x),\u2200t \u2265 0, x \u2208 X 2) \u03b3\u0303(t,0) = \u03b7\u0303(t,0) = 0,\u2200t \u2265 0 3) \u2203C\u03b3 , C\u03b7 \u2208 R+ : \u2016\u03b3\u0303(t, x)\u2016 \u2264 C\u03b3\u2016x\u2016, \u2016\u03b7\u0303(t, x)\u2016 \u2264\nC\u03b7\u2016x\u2016. Proof:\n1) We have W(t) \u2208 W from Assumption 2, therefore\n\u2200t \u2265 0, \u2203v(t) \u2208 (R+)nV ,1>v(t) = 1 : nV\u2211 k=1 [v(t)]kW k = W(t).\nDefine d\u2217(t) = \u2211nV k=1[v(t)]kd k \u2217 and see that for any t \u2265 0, x \u2208 X ,\n[\u03b3(t, x)\u2212 \u03b7(t, x)]i = max\n1\u2264j\u2264\u03b1 [Ej(t)]ix(t) + [dj(t)]i\n\u2212 max 1\u2264l\u2264\u03b2 [Hl(t)]ix(t) + [fl(t)]i\n= \u2212d\u2217(t) + max 1\u2264j\u2264\u03b1 [Ej(t)]ix(t) + [dj(t)]i\n+ d\u2217(t)\u2212 max 1\u2264l\u2264\u03b2 [Hl(t)]ix(t) + [fl(t)]i\n= nV\u2211 k=1 [v(t)]k ( max 1\u2264j\u2264\u03b1 [Ekj ]ix(t) + [d k j \u2212 dk\u2217]i\n\u2212 max 1\u2264l\u2264\u03b2 [Hkl ]ix(t) + [f k l \u2212 dk\u2217]i ) =\nnV\u2211 k=1 [v(t)]k ( max 1\u2264j\u2264\u03b1 [E\u0303kj ]ix(t) + [d\u0303 k j ]i\n\u2212 max 1\u2264l\u2264\u03b2\n[H\u0303kl ]ix(t) + [f\u0303 k l ]i )\n= [\u03b3\u0303(t, x)\u2212 \u03b7\u0303(t, x)]i, i = 1, . . . , n.\n2) Let j\u0303ik = arg max1\u2264j\u2264\u03b1[d k j ]i and l\u0303 i k =\narg max1\u2264l\u2264\u03b2 [fkl ]i. By Assumption 3, we have [dk j\u0303ik ]i = [f k l\u0303ik ]i = [d k \u2217]i. Therefore, d\u0303 k j , f\u0303 k j \u2264 0 and \u2200i = 1, . . . , n,\n[\u03b3\u0303(t,0)]i = max 1\u2264j\u2264\u03b1 [d\u0303jk]i = [d k j\u0303ik ]i \u2212 [dk\u2217]i = 0,\n[\u03b7\u0303(t,0)]i = max 1\u2264l\u2264\u03b2 [f\u0303 jk ]i = [f k l\u0303ik ]i \u2212 [dk\u2217]i = 0.\n3) Let C\u03b3 = max 1\u2264j\u2264\u03b1 1\u2264k\u2264nV \u2016Ekj \u2016F (where \u2016 \u00b7 \u2016F is the\nFrobenius norm). We have already seen in 2) that d\u0303kj \u2264\n0 and so we have\nEkj x+ d\u0303 k j \u2264 Ekj x, \u2200j = 1, . . . , \u03b1\n\u21d2 nV\u2211 k=1 [v(t)]k( max 1\u2264j\u2264\u03b1 Ekj x+ d\u0303 k j ) \u2264 nV\u2211 k=1 [v(t)]k( max 1\u2264j\u2264\u03b1 Ekj x)\n\u21d2\u03b3\u0303(t, x) \u2264 nV\u2211 k=1 [v(t)]k( max 1\u2264j\u2264\u03b1 Ekj x)\n\u21d2\u2016\u03b3\u0303(t, x)\u2016 \u2264 ( nV\u2211 k=1 [v(t)]k)C\u03b3\u2016x\u2016 = C\u03b3\u2016x\u2016\nBy setting C\u03b7 = max 1\u2264l\u2264\u03b2 1\u2264k\u2264nV \u2016Hkl \u2016F , we can similarly show \u2016\u03b7\u0303(t, x)\u2016 \u2264 C\u03b7\u2016x\u2016.\nRemark 3: If \u03b3(t,0) = \u03b7(t,0) = \u0393 \u2200t \u2265 0 for some constant, known \u0393 \u2208 Rn then \u03b3\u0303(t, x) = \u03b3(t, x) \u2212 \u0393 and \u03b7\u0303(t, x) = \u03b7(t, x)\u2212 \u0393."
        },
        {
            "heading": "C. Control Policy Synthesis",
            "text": "We consolidate our results to construct a PWQ CLF V (t, x(t)) and stabilizing PWA policy u\u2217(t, x(t)) satisfying the properties in Lemma 1 for system (2) using the technique presented in section IV and the redefined dynamics (7) from Lemma 2. The main idea is to express the convex PWA functions \u03b3\u0303(\u00b7), \u03b7\u0303(\u00b7) as the solution to a set of linear inequalities and quadratic equalities in a lifted space (as in (5)) and then derive certificates to check if the candidate V (\u00b7) and u\u2217(\u00b7) satisfies the properties given in Lemma 1.\nConsider CLF candidates for system (7) (or equivalently, (2)) of the form\nV (t, x) =  x\u03b3\u0303(t, x) \u03b7\u0303(t, x) > P  x\u03b3\u0303(t, x) \u03b7\u0303(t, x)  . (8) Note that since \u03b3\u0303(t, \u00b7), \u03b7\u0303(t, \u00b7) are PWA in x, V (t, \u00b7) is PWQ in x. The polytopic partition and the quadratic functions describing V (t, \u00b7) are implicitly defined by \u03b3\u0303(t, \u00b7) and \u03b7\u0303(t, \u00b7).\nNow we proceed to construct the policy class for our stabilizing policy u\u2217(t, x(t). Recursively define the following functions\n\u03b3\u0303j(t, x) = max{\u03b3\u0303j\u22121(t, x), E\u0303j(t)x+ d\u0303j(t)} j = 2, . . . , \u03b1 \u03b7\u0303l(t, x) = max{\u03b7\u0303l\u22121(t, x), H\u0303l(t)x+ f\u0303l(t)} l = 2, . . . , \u03b2\nwith \u03b3\u03031(t, x) = E\u03031(t)x+d\u03031(t) and \u03b7\u03031(t, x) = H\u03031(t)x+f\u03031(t) and define\n\u03c7(t, x) = [1 x> \u03b3\u03031(t, x) > . . . \u03b3\u0303\u03b1(t, x) > \u03b7\u03031(t, x) >\n. . . \u03b7\u0303\u03b2(t, x) >]>. (9)\nDue to the nested maximizations property as noted earlier, we have \u03b3\u0303(t, x) = \u03b3\u0303\u03b1(t, x) and \u03b7\u0303(t, x) = \u03b7\u0303\u03b2(t, x). Similar to (5), we have for any t \u2265 0 that (x, \u03b3\u0303(t, x), \u03b7\u0303(t, x)) is given as the solution to the following linear inequalities and quadratic equalities in the\nspace (x, \u03b3\u03031, . . . , \u03b3\u0303\u03b1, \u03b7\u03031, . . . , \u03b7\u0303\u03b2) \u2208 Rn(1+\u03b1+\u03b2) (where x, \u03b3\u03031, . . . , \u03b7\u0303\u03b2 are arbitrary).\n\u03b3\u03031 = E\u03031(t)x+ d\u03031(t),\n\u03b3\u0303j \u2265 \u03b3\u0303j\u22121, \u03b3\u0303j \u2265 E\u0303j(t)x+ d\u0303j(t), (\u03b3\u0303j \u2212 \u03b3\u0303j\u22121)>(\u03b3\u0303j \u2212 E\u0303j(t)x\u2212 d\u0303j(t)) = 0, j = 2, . . . , \u03b1, \u03b7\u03031 = H\u03031(t)x+ f\u03031(t),\n\u03b7\u0303l \u2265 \u03b7\u0303l\u22121, \u03b7\u0303l \u2265 E\u0303l(t)x+ f\u0303l(t), (\u03b7\u0303l \u2212 \u03b7\u0303l\u22121)>(\u03b7\u0303l \u2212 E\u0303l(t)x\u2212 f\u0303l(t)) = 0, l = 2, . . . , \u03b2.\n(10) For defining our policy class, we make the following assumption on the feedback structure of system (2).\nAssumption 4: There exists a known matrix C \u2208 Rp\u00d7(1+n(1+\u03b1+\u03b2)) such that C\u03c7(t, x) is observed. With this assumption, we consider policy candidates parametrized by K \u2208 Rm\u00d7p of the form\nu(t, x) = KC\u03c7(t, x). (11)\nSince \u03c7(t, \u00b7) as defined in (9) is PWA in x, the policy u(t, \u00b7) is PWA in x where the time-varying polytopic partition tnr(t)i=1 X\u0303i(t) = X and affine functions Fi(t)x + gi in (3) are defined implicitly.\nThe following theorem is our main result that describes LMIs whose solution yields a CLF V (t, x(t)) and stabilizing policy u(t, x(t)) of the form discussed above. Before stating the theorem, we require some definitions. Let\nx+ = Ax+ \u03b3\u0303\u03b1(t, x)\u2212 \u03b7\u0303\u03b2(t, x) +BKC\u03c7(t, x) \u03c7+(t, x) = [\u03c7(t, x)>\u03b3\u03031(t+ 1, x +)> . . . \u03b3\u0303\u03b1(t+ 1, x +)>\n\u03b7\u03031(t+ 1, x +)> . . . \u03b7\u0303\u03b2(t+ 1, x +)>]>\n(12) and define the following selection matrices:\n\u2022 S such that S\u03c7+(t, x) = \u03c7(t, x), \u2022 S\u03bb such that S\u03bb\u03c7+(t, x) = [1 x> \u03b3\u0303(t, x)> \u03b7\u0303(t, x)>]>, \u2022 Sx such that Sx\u03c7+(t, x) = [1 x>]>, \u2022 S+ such that S+\u03c7+(t, x) = \u03c7(t+ 1, x+), \u2022 G\u03b31, G\u03b71 such that G\u03b31\u03c7(t, x) = In, G\u03b71\u03c7(t, x) = In\nrespectively, \u2022 G\u03b3j , G\u03b7l such that G\u03b3j\u03c7(t, x) = \u03b3\u0303j(t, x)\u2212 \u03b3\u0303j\u22121(t, x), G\u03b7l\u03c7(t, x) = \u03b7\u0303l(t, x)\u2212 \u03b7\u0303l\u22121(t, x) for j = 2, . . . , \u03b1 and l = 2, . . . , \u03b2 respectively, \u2022 Gk\u03b3j , G k \u03b7l such that G k \u03b3j\u03c7(t, x) = \u03b3\u0303j(t, x)\u2212 E\u0303kj x\u2212 d\u0303kj ,\nGk\u03b7l\u03c7(t, x) = \u03b7\u0303l(t, x)\u2212 H\u0303kl x\u2212 f\u0303kl for j = 1, . . . , \u03b1 and l = 1, . . . , \u03b2 respectively.\nNote that S+ is affine in the unknown gain K from (12). All the other matrices are constant, known matrices that depend on the problem data.\nTheorem 1: Fix some \u03c11 \u2208 R+, \u03c13 \u2208 (0, 1). Define the ellipsoidal set U\u0303 = {u \u2208 Rm : u>Quu \u2264 1} \u2282 U where Q>u = Qu, Qu 0. Suppose that there exist real-valued matrices T, V , diagonal matrix J , non-negative matrices M\u03b3j , M\u03b7l, M\u0304\u03b3j , M\u0304\u03b7l, M\u0303\u03b3j , M\u0303\u03b7l, M+\u03b3j , M + \u03b7l , diagonal matrices D\u03b3l, D\u03b7l, D\u0304\u03b3j , D\u0304\u03b7l D\u0303\u03b3l, D\u0303\u03b7l, D+\u03b3l, D + \u03b7l for j = 1, . . . , \u03b1 and l = 1, . . . , \u03b2, such that for some symmetric matrix P \u2217\nand feedback gain K\u2217 we have:\n(Positive-definite Lyapunov Function)\n(S\u03bbS) >P \u2217S\u03bbS \u2212 S>x [ 0 0 0 \u03c11In ] Sx\n\u2212 S>He( \u03b1\u2211 j=1 G>\u03b3j(D\u03b3j +M\u03b3j)G k \u03b3j + \u03b2\u2211 l=1 G>\u03b7l(D\u03b7l +M\u03b7l)G k \u03b7l)S 0\nk = 1, . . . , nV (13) [P \u2217]11 = 0 (14)\n(Input Constraints) (CS)> [\n1 0 0 \u2212Qu\n] CS\n\u2212 S>He( \u03b1\u2211 j=1 G>\u03b3j(D\u0304\u03b3j + M\u0304\u03b3j)G k \u03b3j + \u03b2\u2211 l=1 G>\u03b7l(D\u0304\u03b7l + M\u0304\u03b7l)G k \u03b7l)S 0\nk = 1, . . . , nV (15)\n(Decreasing Lyapunov Function) Zk1 V Zq2? 2He(T )\u2212 Y ? Z3  0 k = 1, . . . , nV , q = 1, . . . , nV (16)\nwhere\nZk1 = (1\u2212 \u03c13)S>P \u2217S\n\u2212 S>He( \u03b1\u2211 j=1 G>\u03b3j(D\u0303\u03b3j + M\u0303\u03b3j)G k \u03b3j + \u03b2\u2211 l=1 G>\u03b7l(D\u0303\u03b7l + M\u0303\u03b7l)G k \u03b7l)S,\nZq2 = [ Uq V 0 T> ] , Z3 = [ J 0 ? 2I \u2212 J ] ,\nUq = S+>[S>\u03bb G > \u03b31 G q> \u03b31 . . . G > \u03b3\u03b1 G q> \u03b3\u03b1 G > \u03b71 G q> \u03b71 . . . G > \u03b7\u03b2 G q> \u03b7\u03b2 ],\nY = blkdiag(P \u2217, Y\u03b31, . . . , Y\u03b3\u03b1, Y\u03b71, . . . , Y\u03b7\u03b2),\nY\u03b3j =\n[ 0 D+\u03b3j +M + \u03b3j\n? 0\n] , Y\u03b7j = [ 0 D+\u03b7j +M + \u03b7j\n? 0\n] .\nThen the origin of the closed-loop system (2) with u\u2217(t, x) = K\u2217C\u03c7(t, x) is exponentially stable and u\u2217(t, x) \u2208 U \u2200x \u2208 X , t \u2265 0.\nProof: Multiplying the kth inequality in (13) by \u03c7+(t, x) on both sides for x \u2208 X , t \u2265 0, gives V (t, x)\u2212 \u03c11\u2016x\u20162 \u2265 \u03b1\u2211 j=1 \u03c7>(t, x)G>\u03b3j(D\u03b3j +M\u03b3j)G k \u03b3j\u03c7(t, x)\n+ \u03b2\u2211 l=1 \u03c7>(t, x)G>\u03b7l(D\u03b7l +M\u03b7l)G k \u03b7l\u03c7(t, x).\nFrom Assumption 2, we know that W(t) \u2208 W \u21d2 \u2200t \u2265 0,\u2203v(t) \u2208 (R+)nV ,1>v(t) = 1 : \u2211nV k=1[v(t)]kW\nk = W(t). Also notice that the matrices Gk\u03b3j , G k \u03b7j are linear in W k. Let G\u0304\u03b3j(t), G\u0304\u03b7l(t) be matrices such that \u03b3\u0303j(t, x) \u2212 E\u0303j(t)x\u2212 d\u0303j(t) = G\u0304\u03b3j(t)\u03c7(t, x), \u03b7\u0303l(t, x)\u2212 H\u0303l(t)x\u2212 f\u0303l(t) = G\u0304\u03b7l(t)\u03c7(t, x) for j = 1, . . . , \u03b1 and l = 1, . . . , \u03b2 respectively. Then we have G\u0304\u03b3j = \u2211nV k=1[v(t)]kG k \u03b3j and G\u0304\u03b7l =\n\u2211nV k=1[v(t)]kG k \u03b7l. Thus multiplying the kth inequality above by [v(t)]k and adding all gives\nV (t, x)\u2212 \u03c11\u2016x\u20162 \u2265 \u03b1\u2211 j=1 \u03c7(t, x)>G>\u03b3j(D\u03b3j +M\u03b3j)G\u0304\u03b3j(t)\u03c7(t, x)\n+ \u03b2\u2211 l=1 \u03c7(t, x)>G>\u03b7l(D\u03b7l +M\u03b7l)G\u0304\u03b7l(t)\u03c7(t, x)\nFrom Proposition 1, we have that the two terms on the right are positive and so\n\u03c11\u2016x\u20162 \u2264 V (t, x) \u2200x \u2208 X , t \u2265 0.\nSimilarly, (15) gives for any x \u2208 X , t \u2265 0\n1\u2212 u\u2217(t, x)>Quu\u2217(t, x) \u2265 \u03b1\u2211 j=1 \u03c7(t, x)>G>\u03b3j(D\u03b3j +M\u03b3j)G\u0304\u03b3j(t)\u03c7(t, x)\n+ \u03b2\u2211 l=1 \u03c7(t, x)>G>\u03b7l(D\u03b7l +M\u03b7l)G\u0304\u03b7l(t)\u03c7(t, x)\nfor any x \u2208 X , t \u2265 0. From Proposition 1, we have that the two terms on the right are positive and so\nu\u2217(t, x) \u2208 U\u0303 \u2282 U \u2200x \u2208 X , t \u2265 0.\nFrom lemma 2, we have \u2016\u03b3\u0303(t, x)\u2016 \u2264 C\u03b3\u2016x\u2016, \u2016\u03b7\u0303(t, x)\u2016 \u2264 C\u03b7\u2016x\u2016 for some C\u03b3 , C\u03b7 \u2208 R+. Using (14) and setting \u03c12 = \u03bbmax(P \u2217)(1 + C2\u03b3 + C 2 \u03b7), we get\nV (t, x) \u2264 \u03c12\u2016x\u20162 \u2200x \u2208 X , t \u2265 0.\nObserve that Zk1 , Z q 2 in inequality (16) are linear in Gk\u03b3j , G k \u03b7l and G q \u03b3j , G q \u03b7l respectively. Define Z1(t) by replacing Gk\u03b3j , G k \u03b7l with G\u0304\u03b3j(t), G\u0304\u03b7l(t) in the definition of Z k 1 and\nsee that Z1(t) = \u2211nV k=1[v(t)]kZ k 1 . Similarly, define Z2(t+1) by replacing Gq\u03b3j , G q \u03b7l with G\u0304\u03b3j(t + 1), G\u0304\u03b7l(t + 1) in the\ndefinition of Zq2 and see that Z2(t+1) = \u2211nV q=1[v(t+1)]qZ q 2 . For a fixed q, multiplying the kth inequality in (16) by [v(t)]k and adding the nV inequalities gives Z1(t) V Zq2? 2He(T )\u2212 Y\n? Z3  0. Again, multiplying the qth inequality above with [v(t+ 1)]q and adding the nV resulting inequalities gives Z1(t) V Z2(t+ 1)? 2He(T )\u2212 Y\n? Z3  0. Now we proceed to eliminate the variables J, T and V as follows. Using the AM-GM inequality, we have J\u22121 2I\u2212 J which we replace in Z3. Then, we use Schur\u2019s complement and Young\u2019s inequality to eliminate J . Variables T and V are eliminated by employing the reciprocal-projection\nlemma ([19, Section 2.5.4, 1]). Multiplying both sides of the resulting inequality with \u03c7+(t, x) for x \u2208 X , gives\n\u2212 (V (t+ 1, x+)\u2212 \u03c13V (t, x)) \u2265 \u03b1\u2211 j=1 \u03c7(t, x)>G>\u03b3j(D\u0303\u03b3j + M\u0303\u03b3j)G\u0304\u03b3j(t)\u03c7(t, x)+ \u03b2\u2211 l=1 \u03c7(t, x)>G>\u03b7l(D\u0303\u03b7l + M\u0303\u03b7l)G\u0304\u03b7l(t)\u03c7(t, x)+\n\u03b1\u2211 j=1 \u03c7(t+ 1, x+)>G>\u03b3j(D + \u03b3j +M + \u03b3j)G\u0304\u03b3j(t+ 1)\u03c7(t+ 1, x +)+ \u03b2\u2211 l=1 \u03c7(t+ 1, x+)>G>\u03b7l(D + \u03b7l +M + \u03b7l)G\u0304\u03b7l(t+ 1)\u03c7(t+ 1, x +).\nFrom Proposition 1, we have that the four terms on the right are positive and so\nV (t+ 1, x+) \u2264 \u03c13V (t, x) \u2200x \u2208 X , t \u2265 0.\nThus by Lemma 1, the origin of the closed-loop system (2) with u\u2217(t, x) = K\u2217C\u03c7(t, x) is exponentially stable.\nRemark 4: Note that although (13),(14) make V (t, x) positive-definite on Rn, the matrix P \u2217 \u2208 R(1+3n)\u00d7(1+3n) can be indefinite.\nRemark 5: The LMI (16) can be conservative in practice. Alternatively, it can be replaced by the following BMI.\n(Decreasing Lyapunov Function)[ Zk1 Z q 2\n? Z3\n] 0\nk = 1, . . . , nV , q = 1, . . . , nV (17)\nwhere\nZk1 = (1\u2212 \u03c13)S>P \u2217S + r\u0303S>x [ \u22121 0 0 Qx ] Sx \u2212 UV > \u2212 V U>\n\u2212 S>He( \u03b1\u2211 j=1 G>\u03b3j(D\u0303\u03b3j + M\u0303\u03b3j)G k \u03b3j + \u03b2\u2211 l=1 G>\u03b7l(D\u0303\u03b7l + M\u0303\u03b7l)G k \u03b7l)S,\nZq2 = V \u2212 U qT, Z3 = T + T > \u2212 Y,\nUq = S+>[S>\u03bb G > \u03b31 G q> \u03b31 . . . G > \u03b3\u03b1 G q> \u03b3\u03b1 G > \u03b71 G q> \u03b71 . . . G > \u03b7\u03b2 G q> \u03b7\u03b2 ],\nY = blkdiag(P \u2217, Y\u03b31, . . . , Y\u03b3\u03b1, Y\u03b71, . . . , Y\u03b7\u03b2),\nY\u03b3j =\n[ 0 D+\u03b3j +M + \u03b3j\n? 0\n] , Y\u03b7j = [ 0 D+\u03b7j +M + \u03b7j\n? 0\n] ."
        },
        {
            "heading": "VI. NUMERICAL EXAMPLES",
            "text": "In this section we illustrate the proposed control synthesis procedure on two examples: A) an inverted pendulum against a soft wall and B) the human-robot collaboration scenario from section III. For each example, we obtain the DC decomposition, verify our assumptions and synthesize feedback policies which are demonstrated via simulations.\nA. Inverted pendulum against Wall\n1) System Model: Consider the inverted pendulum of mass m and length l in Figure 1. The state of the system at time t, x(t) = [\u03b8(t) \u03b8\u0307(t)]>, is described by the deviation \u03b8 of the pendulum from the vertical, and its angular velocity \u03b8\u0307. At distance d(t) from the vertical, there is a soft wall modeled as a spring with spring constant k(t). Both the spring constant k(t) and distance d(t) are uncertain and timevarying. The torques acting on the pendulum are mgl sin \u03b8 (due to gravity), u(t) (control torque) and the moment due to the spring given by \u03bb(t, x) = l cos \u03b8max{0, k(t)(l sin \u03b8\u2212 d(t))} in the counter-clockwise direction. Assuming small deviations (sin \u03b8 \u2248 \u03b8) and using forward-Euler discretization, we can write the system dynamics as the PWA model\nx(t+ 1) = [ 1 dt dt gl 1 ] \ufe38 \ufe37\ufe37 \ufe38\nA\nx(t) + [ 0 dt ml2 ] \ufe38 \ufe37\ufe37 \ufe38 B u(t)\n\u2212 [\n0 dt ml ] max{0, k(t)l\u03b8(t)\u2212 k(t)d(t)}\ufe38 \ufe37\ufe37 \ufe38\n\u03b7(t,x(t))\n.\n(18)\nWe assume that the uncertain parameters W(t) = [k(t) k(t)d(t)] lie in some convex polytope W = conv{[ki kid]} nV i=1 as in Assumption 2. We can also assume ki, kid \u2265 0 \u2200i = 1, . . . , nV to represent non-negative spring constants and distances. Thus k(t), k(t)d(t) \u2265 0 and so we have \u03b7(t,0) = max{0,\u2212k(t)d(t)} [ 0 dtml ]> = 0 = \u03b3(t,0) in Assumption 3. From Remark 3, the redefined DC decomposition is simply \u03b7\u0303(t, x) = \u03b7(t, x).\nFor policy synthesis, we construct \u03c7(t, x) = [1 x> \u03b71(t, x) >\u03b72(t, x) >]> where \u03b71(t, x) = 0 and \u03b72(t, x) = max{\u03b71(t, x), [0 dtk(t)ml (l\u03b8 \u2212 d(t))] >}. For the observation model, we assume that the full state x(t) is observable and that we can also observe the contact torque \u03bb(t, x). Thus, the matrix C \u2208 R4\u00d77 in Assumption 4 is given by C = [ [I7] > 1 [I7] > 2 [I7] > 3 [I7] > 7 ]> . We now proceed to synthesize a control policy using theorem 1 for a specific realization of this system.\n2) Simulations: The various parameters in (18) are given as follows (in SI units): dt = 0.01, m = 1, l = 2, g = 9.8, W = conv{[10 2], [10 2.5], [5 1], [5 1.25]}. The state and input constraints are given by X = [\u22120.5, 0.5] \u00d7 [\u22122, 1], U = [\u2212200, 200].\nWe use YALMIP with SDPT3 to find a feasible solution to the inequalities of theorem 1. The synthesized\npolicy is tested on three different initial conditions x0 = {[0.18 0.8]>, [0.1 1]>, [0.22 0]>}\n3) Discussion: Figures 2,3 show that the system trajectories converge to the origin for all three initial conditions while satisfying state and input constraints. The uncertainty description tells us that d(t) \u2208 [0.2, 0.25], or d(t) l \u2208 [0.1, 0.125]. So the pendulum starts close to the wall in the considered initial conditions, which is confirmed by the first plot in Figure 3. The first and last trajectories start with the pendulum in contact with the wall whereas in the second trajectory, the pendulum bounces off the wall before converging to the origin. The control signal in the second plot of Figure 3 has kinks when contact is made or broken.\nB. Human-Robot Collaboration\n1) System Model: Suppose we have a collaborative setup where a robot is transporting a payload with assistance from a human as illustrated in figure 4. Denote the position and velocity of the robot by xR and vR respectively. The velocity vR is controlled by u via first order discrete-time dynamics. Denote the position of the payload as xP and let x(t) = [xR(t) vR(t) xP (t)]\n> describe the state of the system at time t. The velocity of the payload is determined by the human\u2019s policy as \u03bb(t, x(t)) given by\n\u03bb(t, x(t)) = { K(t)(xR(t)\u2212 xP (t)) c(t)xP (t) > xR(t) K(t)(c(t)\u2212 1)xP (t)) c(t)xP (t) \u2264 xR(t)\nwhere c(t) \u2208 (0, 1],K(t) \u2265 0 are uncertain parameters of the human\u2019s policy. The contact model between the robot and the payload is given by that of inelastic collision. The model of the system is thus given byxR(t+ 1)vR(t+ 1) xP (t+ 1)  =  xR(t) + dt \u00b7 vR(t)vR(t) + dt \u00b7 u(t) max{xR(t) + dt \u00b7 vR(t), xP (t) + dt \u00b7 \u03bb(t, x(t))}  (19)\nwhere dt is the discretization time-step. Observe that because K(t), c(t) are uncertain and time-varying, the polytopic partition of the PWA system (19) is uncertain and time-varying too. Also notice that the set XI = {x \u2208 R3 : xR \u2264 xP } is invariant for the dynamics (19) and we assume that x(0) \u2208 XI . When xp(t) \u2265 0, the human drives the payload towards the origin if it is close to the robot (c(t)xP (t) \u2264 xR(t)) and towards the robot otherwise. When xP (t) < 0, the payload is always pushed to the left (towards \u2212\u221e). Now we derive the DC decomposition of the system model (19). The velocity that the human imparts to the payload, \u03bb(t, x), can be written as\n\u03bb(t, x) =\u2212max{\u2212K(t)(xR \u2212 xP ),\u2212K(t)(c(t)\u2212 1)xP }.\nUsing this expression and the fact that max{a, b + c} = max{a \u2212 b, c} + b, the system (19) can be written in the form (2) as\nx(t+ 1) =Ax(t) +Bu(t) + \u03b3(t, x(t))\u2212 \u03b7(t, x(t)) (20)\nwhere [\u03b3(t, x)]i = [\u03b7(t, x)]i = 0 for i = 1, 2 and [\u03b3(t, x)]3 = max{xR + dt(vR \u2212 \u03bb(t, x)), xP } = max{xR + dt(vR \u2212 K(t)(xR \u2212 xP )), xR + dt(vR \u2212 K(t)(c(t) \u2212 1)xP ), xP }, [\u03b7(t, x)]3 = \u2212dt\u03bb(t, x).\nWe assume that the uncertain parameters W(t) = [K(t) K(t)c(t)] lie in some convex polytope W =\nconv{[Ki KiC ]} nV i=1 as in Assumption 2. We also assume that Ki,Kic \u2265 0,Kic < Ki \u2200i = 1, . . . , nV and so K(t) \u2265 0, c(t) \u2208 [0, 1). For any W(t) \u2208 W , we have \u03b3(t,0) = \u03b7(t,0) = 0. So from Remark 3, the redefined DC decomposition is simply \u03b3\u0303(t, x) = \u03b3(t, x), \u03b7\u0303(t, x) = \u03b7(t, x).\nFor policy synthesis, we construct \u03c7(t, x) = [1 x> \u03b31(t, x) > \u03b32(t, x) > \u03b33(t, x) >\u03b71(t, x) >\u03b72(t, x) >]> where \u03b31(t, x) = [0 0 xR + dt(vR \u2212 K(t)(xR \u2212 xP ))]>, \u03b32(t, x) = max{\u03b31(t, x), [0 0 xR + dt(vR \u2212 K(t)(c(t) \u2212 1)xP )]\n>}, \u03b33(t, x) = max{\u03b32(t, x), [0 0 xP ]>}, \u03b71(t, x) = [0 0 \u2212 dtK(t)(xR \u2212 xP )]> and \u03b72(t, x) = max{\u03b71(t, x), [0 0 \u2212 dtK(t)(c(t) \u2212 1)xP ]>}. For the observation model, we assume that the full state x(t) is observable and that we can also observe the velocity imparted by the human, \u03bb(t, x). Thus, the matrix C \u2208 R6\u00d719 in Assumption 4 is given by C = [ [I19] > 1 [I19] > 2 [I19] > 3 [I19] > 4 [I19] > 13 [I19] > 19\n]> where the last two rows correspond to [\u03b33(t, x)]3 and [\u03b73(t, x)]3. We now proceed to synthesize a control policy using theorem 1 for a specific realization of this system.\n2) Simulations: The various parameters in (20) are given as follows (in SI units): dt = 0.01, W = conv{[10 6], [5 3], [10 8], [5 4]}.\nWe use YALMIP with SDPT3 to find a feasible solution to the inequalities of Theorem 1. The synthesized policy is tested on two different initial conditions x0 = {[1 0 3.5]>, [\u22123 \u22122 1.5]>} in XI . The two rows of plots in Figure 5 correspond to simulations with the first and second initial conditions respectively.\n3) Discussion: Figure 5 shows that the system trajectories converge to the origin for both initial conditions. Since K(t) \u2265 0, c(t) \u2208 [0, 1) and x(t) \u2208 XI \u2200t \u2265 0, we see that the velocity imparted by the human \u03bb(t, x(t)) is always negative. In the first row of plots for initial condition x0 = [1 0 3.5]\n>, we see that the robot is driven to the origin first while the payload follows behind. For the second initial condition, the robot starts at xR = \u22123. The payload is pushed until it makes contact with the robot and then the robot pushes it to the origin with no further action from the human (\u03bb(t, x(t)) = 0)."
        },
        {
            "heading": "VII. CONCLUSION",
            "text": "In this work, we analysed and designed feedback controllers for discrete-time Piecewise-Affine (PWA) systems with uncertainty in both the affine dynamics and the polytopic partition. Using the Difference-of-Convex (DC) decomposition of continuous PWA systems and the lifting technique discussed in section IV, we provided LMI tests to synthesize quadratic Lyapunov functions and stabilizing affine policies in a higher dimensional space. When projected back to the state space, these resulted in time-varying PWQ Lyapunov functions and time-varying PWA feedback policies. We demonstrated our technique on two examples- an inverted pendulum against a soft wall and a human-robot collaboration task to transport a payload."
        }
    ],
    "title": "Control of Uncertain PWA Systems using Difference-of-Convex Decompositions",
    "year": 2023
}