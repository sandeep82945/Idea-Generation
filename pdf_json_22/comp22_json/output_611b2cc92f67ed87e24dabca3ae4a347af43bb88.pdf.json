{
    "abstractText": "The flip graph for a set P of points in the plane has a vertex for every triangulation of P , and an edge when two triangulations differ by one flip that replaces one triangulation edge by another. The flip graph is known to have some connectivity properties: (1) the flip graph is connected; (2) connectivity still holds when restricted to triangulations containing some constrained edges between the points; (3) for P in general position of size n, the flip graph is dn2 \u2212 2e-connected, a recent result of Wagner and Welzl (SODA 2020). We introduce the study of connectivity properties of the flip graph when some edges between points are forbidden. An edge e between two points is a flip cut edge if eliminating triangulations containing e results in a disconnected flip graph. More generally, a set X of edges between points of P is a flip cut set if eliminating all triangulations that contain edges of X results in a disconnected flip graph. The flip cut number of P is the minimum size of a flip cut set. We give a characterization of flip cut edges that leads to an O(n log n) time algorithm to test if an edge is a flip cut edge and, with that as preprocessing, an O(n) time algorithm to test if two triangulations are in the same connected component of the flip graph. For a set of n points in convex position (whose flip graph is the 1-skeleton of the associahedron) we prove that the flip cut number is n\u2212 3.",
    "authors": [
        {
            "affiliations": [],
            "name": "Reza Bigdeli"
        },
        {
            "affiliations": [],
            "name": "Anna Lubiw"
        }
    ],
    "id": "SP:630672141d1a60b162dd3eb5f38603af1bfc7ac0",
    "references": [
        {
            "authors": [
                "Zachary Abel",
                "Brad Ballinger",
                "Prosenjit Bose",
                "S\u00e9bastien Collette",
                "Vida Dujmovi\u0107",
                "Ferran Hurtado",
                "Scott Duke Kominers",
                "Stefan Langerman",
                "Attila P\u00f3r",
                "David R Wood"
            ],
            "title": "Every large point set contains many collinear points or an empty pentagon",
            "venue": "Graphs and Combinatorics,",
            "year": 2011
        },
        {
            "authors": [
                "Nima Anari",
                "Shayan Oveis Gharan",
                "Cynthia Vinzant"
            ],
            "title": "Log-concave polynomials, entropy, and a deterministic approximation algorithm for counting bases of matroids",
            "venue": "IEEE 59th Annual Symposium on Foundations of Computer Science (FOCS),",
            "year": 2018
        },
        {
            "authors": [
                "Michel L Balinski"
            ],
            "title": "On the graph structure of convex polyhedra in n-space",
            "venue": "Pacific Journal of Mathematics,",
            "year": 1961
        },
        {
            "authors": [
                "Marshall Bern",
                "David Eppstein"
            ],
            "title": "Mesh generation and optimal triangulation",
            "venue": "Computing in Euclidean Geometry,",
            "year": 1995
        },
        {
            "authors": [
                "Prosenjit Bose",
                "Ferran Hurtado"
            ],
            "title": "Flips in planar graphs",
            "venue": "Computational Geometry,",
            "year": 2009
        },
        {
            "authors": [
                "Pietro Caputo",
                "Fabio Martinelli",
                "Alistair Sinclair",
                "Alexandre Stauffer"
            ],
            "title": "Random lattice triangulations: Structure and algorithms",
            "venue": "The Annals of Applied Probability,",
            "year": 2015
        },
        {
            "authors": [
                "Cesar Ceballos",
                "Francisco Santos",
                "G\u00fcnter M Ziegler"
            ],
            "title": "Many non-equivalent realizations of the associahedron",
            "year": 2015
        },
        {
            "authors": [
                "L. Paul Chew"
            ],
            "title": "Constrained Delaunay triangulations",
            "venue": "Algorithmica, 4(1):97\u2013108",
            "year": 1989
        },
        {
            "authors": [
                "Bhaskar DasGupta",
                "Xin He",
                "Tao Jiang",
                "Ming Li",
                "John Tromp",
                "Louxin Zhang"
            ],
            "title": "On distances between phylogenetic trees",
            "venue": "In Proceedings of the ACM-SIAM Symposium on Discrete Algorithms (SODA),",
            "year": 1997
        },
        {
            "authors": [
                "Jes\u00fas De Loera",
                "J\u00f6rg Rambau",
                "Francisco Santos"
            ],
            "title": "Triangulations: Structures for Algorithms and Applications, volume 25",
            "venue": "Springer Science & Business Media,",
            "year": 2010
        },
        {
            "authors": [
                "Herbert Edelsbrunner"
            ],
            "title": "Geometry and Topology for Mesh Generation",
            "year": 2001
        },
        {
            "authors": [
                "David Eppstein"
            ],
            "title": "Happy endings for flip graphs",
            "venue": "Journal of Computational Geometry,",
            "year": 2010
        },
        {
            "authors": [
                "Sabine Hanke",
                "Thomas Ottmann",
                "Sven Schuierer"
            ],
            "title": "The edge-flipping distance of triangulations",
            "venue": "Journal of Universal Computer Science,",
            "year": 1996
        },
        {
            "authors": [
                "Heiko Harborth"
            ],
            "title": "Konvexe f\u00fcnfecke in ebenen punktmengen",
            "venue": "Elemente der Mathematik,",
            "year": 1978
        },
        {
            "authors": [
                "Ferran Hurtado",
                "Marc Noy",
                "Jorge Urrutia"
            ],
            "title": "Flipping edges in triangulations",
            "venue": "Discrete & Computational Geometry,",
            "year": 1999
        },
        {
            "authors": [
                "Iyad Kanj",
                "Eric Sedgwick",
                "Ge Xia"
            ],
            "title": "Computing the flip distance between triangulations",
            "venue": "Discrete & Computational Geometry,",
            "year": 2017
        },
        {
            "authors": [
                "C.L. Lawson"
            ],
            "title": "Generation of a triangular grid with application to contour plotting",
            "venue": "Technical report, Memo 299, Jet Propulsion Laboratory",
            "year": 1972
        },
        {
            "authors": [
                "C.L. Lawson"
            ],
            "title": "Transforming triangulations",
            "venue": "Discrete Mathematics, 3",
            "year": 1016
        },
        {
            "authors": [
                "Carl W. Lee"
            ],
            "title": "The associahedron and triangulations of the n-gon",
            "venue": "European Journal of Combinatorics,",
            "year": 1989
        },
        {
            "authors": [
                "Anna Lubiw",
                "Zuzana Mas\u00e1rov\u00e1",
                "Uli Wagner"
            ],
            "title": "A proof of the orbit conjecture for flipping edge-labelled triangulations",
            "venue": "Discrete & Computational Geometry,",
            "year": 2019
        },
        {
            "authors": [
                "Anna Lubiw",
                "Vinayak Pathak"
            ],
            "title": "Flip distance between two triangulations of a point set is NPcomplete",
            "venue": "Computational Geometry,",
            "year": 2015
        },
        {
            "authors": [
                "Michael Molloy",
                "Bruce Reed",
                "William Steiger"
            ],
            "title": "On the mixing rate of the triangulation walk",
            "venue": "DIMACS Series in Discrete Mathematics and Theoretical Computer Science,",
            "year": 2001
        },
        {
            "authors": [
                "Alexander Pilz"
            ],
            "title": "Flip distance between triangulations of a planar point set is APX-hard",
            "venue": "Computational Geometry,",
            "year": 2014
        },
        {
            "authors": [
                "Lionel Pournin"
            ],
            "title": "The diameter of associahedra",
            "venue": "Advances in Mathematics,",
            "year": 2014
        },
        {
            "authors": [
                "Dana Randall",
                "Prasad Tetali"
            ],
            "title": "Analyzing Glauber dynamics by comparison of Markov chains",
            "venue": "Journal of Mathematical Physics,",
            "year": 2000
        },
        {
            "authors": [
                "Daniel D Sleator",
                "Robert E Tarjan",
                "William P Thurston"
            ],
            "title": "Rotation distance, triangulations, and hyperbolic geometry",
            "venue": "Journal of the American Mathematical Society,",
            "year": 1988
        },
        {
            "authors": [
                "Uli Wagner",
                "Emo Welzl"
            ],
            "title": "Connectivity of triangulation flip graphs in the plane (Part I: Edge flips)",
            "venue": "In Proceedings of the 2020 ACM-SIAM Symposium on Discrete Algorithms (SODA),",
            "year": 1611
        }
    ],
    "sections": [
        {
            "text": "We introduce the study of connectivity properties of the flip graph when some edges between points are forbidden. An edge e between two points is a flip cut edge if eliminating triangulations containing e results in a disconnected flip graph. More generally, a set X of edges between points of P is a flip cut set if eliminating all triangulations that contain edges of X results in a disconnected flip graph. The flip cut number of P is the minimum size of a flip cut set.\nWe give a characterization of flip cut edges that leads to an O(n log n) time algorithm to test if an edge is a flip cut edge and, with that as preprocessing, an O(n) time algorithm to test if two triangulations are in the same connected component of the flip graph. For a set of n points in convex position (whose flip graph is the 1-skeleton of the associahedron) we prove that the flip cut number is n\u2212 3."
        },
        {
            "heading": "1 Introduction",
            "text": "Given a set P of n points in the plane, which may include collinear points, an edge of P is a line segment pq that intersects P in exactly the two endpoints p and q. A triangulation of P is maximal set of non-crossing edges. Triangulations have important applications in graphics and mesh generation [4, 11] and are of significant mathematical interest [10].\nA fundamental approach to understanding triangulations is by means of flips. A flip operates on a triangulation by removing one edge pq and adding another edge uv to obtain a new triangulation\u2014 of necessity, the edges pq and uv will cross and their four endpoints will form a convex quadrilateral with no other points of P inside it. For example, in Figure 1, edge a1b1 can be flipped to uv. In 1972, Lawson [17, 18] proved that any triangulation of point set P can be reconfigured to any other triangulation of P by a sequence of flips. This can be expressed as connectivity of the flip graph, which has a vertex for every triangulation of P and an edge when two triangulations differ by a\nar X\niv :2\n20 6.\n02 70\n0v 1\n[ cs\n.C G\n] 6\nJ un\nflip. Reconfiguring triangulations via flips is well studied [5], but there are some very interesting open questions, and many properties of flip graphs remain to be discovered.\nThere is considerable work on distances and diameter of flip graphs [12, 13, 15, 16, 24, 26]. The worst-case diameter of the flip graph is \u0398(n2) for general point sets, and 2n\u2212 10 for n > 12 points in convex position [24, 26]. For a general point set, finding the distance in the flip graph between two triangulations (the \u201cflip distance\u201d) is known to be NP-hard [21], and even APX-hard [23]. However, a main open question is the complexity of the flip distance problem for convex point sets (is it NP-hard or in P?).\nThe case of points in convex position is especially interesting because there is a bijection between flips in triangulations of a convex point set and rotations in binary trees [26], so that flip distance becomes rotation distance between binary trees. Finding the rotation distance between two binary trees is of great interest in biology for phylogenetic trees [9], and in data structures for splay trees [26]. Furthermore, the flip graph for n points in convex position is the 1-skeleton of an (n\u22123)-dimensional polytope called the associahedron [19], or see [7]. See Figure 2. Although there is no geometric analogue of the associahedron for the case of triangulations of a general point set, some of its properties carry over to an abstract complex called the flip complex. For example, the 2-dimensional faces of the flip complex, like those of the associahedron, have size 4 or 5 [20].\nAn open frontier in the study of flip graphs has to do with expander properties, which would potentially lead to rapid mixing via random flips. For results on mixing in triangulations, see [6, 22, 25]. It has recently been shown that the reconfiguration graph of bases of a matroid is an expander [2], and it would be interesting to know if similar results hold for triangulation flip graphs. More generally, researchers study connectivity properties of flip graphs. Recently, Wagner and Welzl [27] showed that for n points in general position in the plane, the flip graph is dn2 \u2212 2econnected. For points in convex position, the flip graph is (n \u2212 3)-connected, which follows from Balinski\u2019s theorem [3] applied to the 1-skeleton of the associahedron, see [27].\nOne intriguing thing about flip graphs of triangulations is that many properties carry over when we restrict to triangulations containing some specified non-crossing edges\u2014so-called constrained triangulations. The subgraph of the flip graph consisting of triangulations that contain all the constrained edges is connected, as proved by Chew [8] using the constrained Delaunay triangulation.\nOur Results. In this paper we study connectivity properties of the flip graph when\u2014instead of constraining certain edges between points to be present\u2014we forbid certain edges between points. To be precise, if a set X of edges between points is forbidden, we eliminate all triangulations that contain an edge of X, and examine whether the flip graph on the remaining triangulations is connected. We say that X is a flip cut set if the resulting flip graph is disconnected; in the special case where X is a single edge, we say that the edge is a flip cut edge. For example the\nedge uv in Figure 1 is a flip cut edge, but the two red edges in Figure 2 do not form a flip cut set. We define the flip cut number of a set of points to be the minimum size of a flip cut set. This is analogous to the connectivity of a graph\u2014the minimum number of vertices whose removal disconnects the graph.\nSince the structure of the flip graph depends on the edges between the points, it seems more natural to study connectivity of the flip graph after deleting some of these edges, rather than deleting some vertices of the flip graph, as standard graph connectivity does, and as the result of Wagner and Welzl [27] does.\nAs our main result, we characterize when an edge e is a flip cut edge in terms of connectivity (in the usual graph sense) of the edges that cross e. Observe that a triangulation that does not contain e must contain an edge that crosses e. We then use the characterization to give an O(n log n) time algorithm to test if a given edge e in a point set of size n is a flip cut edge. With that algorithm as preprocessing, we give a linear time algorithm to test if two triangulations are still connected after we eliminate from the flip graph all triangulations containing edge e.\nFor the case of n points in convex position, there are no flip cut edges and we show that the flip cut number is n \u2212 3. For example, in Figure 2 the leftmost and rightmost triangulations become disconnected if we forbid one more edge, which yields a flip cut set of size 3 for n = 6.\nWe show that a point set of size n may have \u0398(n2) flip cut edges (see Figure 3), and we show that a flip cut edge may result in \u0398(n) disconnected components in the flip graph. We also examine various special point sets whose flip graphs have been previously studied, such as points on an integer grid [6] and, more generally, point sets without empty convex pentagons [12]. Our characterization of flip cut edges becomes simpler in the absence of empty convex pentagons. Point sets without empty convex pentagons must have collinear points; our results do not assume points in general position."
        },
        {
            "heading": "1.1 Examples",
            "text": "Figure 1 shows the smallest example of a point set that has a flip cut edge\u2014in fact, by forbidding one edge, we get a triangulation from which no flips are possible. Such an isolated vertex in the flip graph is called a frozen triangulation.\nMore generally, the triangulation of a channel shown in Figure 3 becomes frozen (modulo triangulating the upper and lower convex subpolygons) when we forbid one flip cut edge. In fact, any edge joining an interior vertex of the top curve and an interior vertex of the bottom curve is a flip cut edge. So there are \u0398(n2) flip cut edges. We justify this more carefully in Section 2.3.2. Channels have been studied previously\u2014they provide lower bounds on the maximum diameter of the flip graph [15], and are building blocks for proving NP-hardness of flip distance [21, 23].\nGrid points are another well-studied case for triangulation flips [6], in part because of physics applications. For n points lying on a \u221a n\u00d7 \u221a n grid, there are again \u0398(n2) flip cut edges. In fact, for an infinite grid, every edge is a flip cut edge, though boundary effects interfere in finite grids. See Section 2.3.2. Points in a grid have the special property that there are no empty convex pentagons. Flips for point sets without empty convex pentagons were studied by Eppstein [12]. Such point sets must have collinear points [1]. See Section 2.3.1.\nThe \u201chourglass\u201d shown in Figure 4 has a flip cut edge e = uv such that forbidding e results in \u0398(n) disconnected components in the flip graph, which is the most possible. See Section 2.3.4.\nSome point sets have \u0398(n2) flip cut edges but at the other extreme, some point sets have no flip cut edges. For example, there are no flip cut edges for points in convex position. The standard way to flip between two triangulations of a convex polygon is via a star triangulation with all edges incident to one point. If there is a point not incident to any forbidden edge, we can still flip to a star centered on that point. See Figure 5. A more detailed version of this argument is given in Lemma 16 when we investigate flip cut sets for points in convex position.\nFigure 6 shows some more examples of flip cut edges in point sets."
        },
        {
            "heading": "1.2 Notation and Definitions",
            "text": "We denote the flip graph of point set P by F(P ), or just F , when P is clear from the context. For a subset E of the edges of P , let T+E(P ) be the set of triangulations of P that include all the edges of E. These are known as constrained triangulations. Let F+E(P ) be the subgraph of the flip graph induced on the vertex set T+E(P ). It is known that F+E(P ) is connected [8].\nLet T\u2212E(P ) be the set of triangulations of P that include none of the edges of E, and let\nF\u2212E(P ) be the subgraph of the flip graph induced on T\u2212E(P ). When E consists of a single edge e, we will write T\u2212e(P ), and so on. Also, we will omit P when the point set is clear from the context.\nA subset E of edges of P is a flip cut set if the flip graph F\u2212E(P ) is disconnected. The smallest size of a flip cut set is called the flip cut number of P . If {e} is a flip cut set of size one, we call e a flip cut edge.\nAn empty convex quadrilateral or EC4 is a set of 4 points in P that form a convex quadrilateral with no other points of P inside or on the boundary. We also use EC3 for empty triangles, EC5 for empty convex pentagons, etc.\nPoint set P is a convex point set if all the points of P are extreme points of the convex hull of P , i.e., for every point p \u2208 P , there is a line through p with all other points of P strictly to one side of the line. Point set P is in general position if no three points are collinear."
        },
        {
            "heading": "2 Flip Cut Edges",
            "text": "In this section we characterize flip cut edges (Section 2.1) and give an O(n log n) time algorithm to test if a given edge is a flip cut edge (Section 2.2). In Section 2.3 we examine some special point sets and establish bounds on the number of flip cut edges and the number of connected components."
        },
        {
            "heading": "2.1 Characterizing Flip Cut Edges",
            "text": "Consider an edge e = uv of P . Let us orient e horizontally so we can use the terms \u201cabove\u201d and \u201cbelow\u201d to refer to the two sides of e. In the horizontal orientation, suppose that u lies to the left of v.\nLet Y be the set of edges f of P such that f crosses e. Let GY be the line graph of Y , i.e., the vertex set of GY is Y , and two edges of Y are adjacent in GY if they meet at a point See Figure 7.\nWe will prove that e is a flip cut edge if and only if GY is disconnected. In fact, we will be able to identify the connected components of F\u2212e from GY .\nObservation 1. T\u2212e is the union of the sets of triangulations T+f for f \u2208 Y . Each flip graph F+f is connected.\nProof. For any edge f , F+f is connected by properties of constrained triangulations [8]. For f \u2208 Y ,\nT+f is a subset of T\u2212e because triangulations that contain f cannot contain e. Finally, since every triangulation of T\u2212e contains some edge of Y , T\u2212e is the union of T+f for f \u2208 Y .\nThe observation says that every vertex of the graph F\u2212e appears in some F+f for f \u2208 Y . In fact, every edge of the graph F\u2212e appears in some F+f for f \u2208 Y , as we will prove as part of Theorem 3.\nBased on Observation 1, in order to identify connected components of the flip graph F\u2212e, it suffices to figure out which subgraphs F+f are connected to which other ones in F\u2212e, i.e., to know when there is a path in F\u2212e from an element of T+f to an element of T+g.\nBefore giving the main theorem, we give one more observation.\nObservation 2. For any triangulation T in T\u2212e, the edges of Y in T , which we denote Y \u2229T , are connected in GY .\nProof. The triangles of T that cross the segment uv form a path in the planar dual of the triangulation, and so the edges of Y \u2229 T form a connected subgraph of GY . See Figure 8.\nTheorem 3. Edge e is a flip cut edge if and only if GY is disconnected. More specifically, edges f and g in Y are connected in GY if and only if T+f and T+g are connected in F\u2212e.\nProof. If fg is an edge of GY , then, in the point set, the edges f and g are incident at a common endpoint so they do not cross, which implies that there is a triangulation containing f and g, so F+f and F+g are connected (they have a triangulation in common). Thus, by transitivity, if f and g are connected in GY then F+f and F+g are connected.\nFor the converse, it suffices to show that if we flip from T1 in T\u2212e to T2 in T\u2212e, then Y \u2229T1 and Y \u2229 T2 are connected in GY . First note that by Observation 2, Y \u2229 T1 is a connected set in GY\nand the same for Y \u2229 T2. We will show that Y \u2229 T1 and Y \u2229 T2 have an element in common. Let fi \u2208 Ti \u2229 Y , i = 1, 2. If either edge is in the other triangulation, we are done. Otherwise, the flip from T1 to T2 must flip f1 to f2. Then the EC4 formed by the endpoints of f1 and f2 has a side edge h that is an edge of Y in both T1 and T2. See Figure 8. (Note that this argument shows that every edge of the flip graph F\u2212e lies in F+h for some h \u2208 Y .)\nAlgorithmic implications. The theorem gives an immediate polynomial time algorithm to test if e is a flip cut edge: construct GY (a graph on O(n\n2) vertices) and test connectivity. In Subsection 2.2 we give a faster O(n log n) time algorithm.\nOur other algorithmic goal is to \u201cidentify\u201d the connected components of F\u2212e. Since the flip graph is exponentially large, we focus on the problem of testing whether two triangulations T1 and T2 in T\u2212e are in the same connected component of F\u2212e. Using Theorem 3 we can do that as follows. Pick f1 in Y \u2229 T1 and f2 in Y \u2229 T2 (note that such edges exist). Then T1 \u2208 T+f1 and T2 \u2208 T+f2 . So T1 and T2 are connected in F\u2212e iff T+f1 and T+f2 are connected in F\u2212e iff (by Theorem 3) f1 and f2 are connected in GY , which we can test in polynomial time. In Subsection 2.2 we give a faster O(n) time algorithm.\nAlternative characterization of flip cut edges. For the efficient algorithms in Section 2.2, we need an alternative characterization of flip cut edges in terms of a subgraph of GY .\nFor any f \u2208 Y , let Q(f) be the convex quadrilateral formed by the endpoints of f and e = uv. Let Z be the set of edges f \u2208 Y such that Q(f) is an EC4. Let GZ be the line graph of Z.\nNote that any f \u2208 Z has one point above e and one point below e, and these points make empty triangles with e. Let A be the set of points a above e such that auv is an empty triangle (an EC3). Let B be the set of points b below e such that bvu is an empty triangle. Thus Z consist of the edges from A to B that cross e = uv, i.e., Z = Y \u2229 (A\u00d7B). See Figure 10.\nWe will prove an analogue of Theorem 3:\nTheorem 4. Edge e is a flip cut edge if and only if GZ is disconnected.\nWe will also be able to characterize connected components of F\u2212e in terms of GZ , but this cannot be analogous to Theorem 3, because not every triangulation contains an edge of Z. We begin with some preliminary results.\nLemma 5. Edges f, g \u2208 Z are connected in GZ if and only if they are connected in GY .\nProof. The forward direction is clear since GZ is an induced subraph of GY . For the other direction, suppose f and g are connected in GY . Suppose, f = f1, f2, ..., fm = g is a shortest path in GY between f and g. If all the fi\u2019s are in Z, then f and g are connected in GZ . Otherwise, we will modify the path to replace edges of Y by edges of Z. Suppose fi = piqi with pi above uv and qi below uv. Because the path is shortest, the common points between successive edges are alternately above and below the line L through uv. In particular, suppose without loss of generality that p1 = p2, q2 = q3, . . . , p2i\u22121 = p2i, q2i = q2i+1, . . ..\nThe plan is to replace pi by some point p \u2032 i and replace qi by some point q \u2032 i so that the segments\nf \u2032i = p \u2032 iq \u2032 i are edges in Z and form a path connecting f to g.\nIf triangle piuv is empty, then p \u2032 i = pi; otherwise p \u2032 i is a point inside triangle piuv that is closest\nto line L. Define q\u2032i similarly with respect to triangle qiuv. Note that f \u2032 1 = f1 and f \u2032 m = fm.\nWe claim that each f \u2032i is in Z. We must show that the line segment p \u2032 iq \u2032 i is an edge, that it\ncrosses e = uv, and that the quadrilateral Q(f \u2032i) is empty. First note that triangles p\u2032iuv and q \u2032 iuv are empty because we picked p \u2032 i and q \u2032 i closest to line L. Next we claim that these two empty triangles together form a convex quadrilateral. This is because fi crosses uv, so Q(fi) is convex, and when we move pi to p \u2032 i and qi to q \u2032 i, convexity is preserved. Thus f \u2032i is an edge of Z. Finally, note that p\u20322i\u22121 = p \u2032 2i and q \u2032 2i = q \u2032 2i+1 because that was true of the original points. Thus the edges f \u2032i form a path in GZ connecting f and g.\nLemma 6. Every connected component of GY contains an edge of Z.\nThis lemma can be proved in several different ways. One possibility is to take an edge f \u2208 Y and construct the edge f \u2032 \u2208 Z inside Q(f) as in the above proof. However, showing that f and f \u2032 are connected in GY runs into some complications due to the possibility of collinear points.\nInstead we take an edge f \u2208 Y and consider a triangulation T containing f . Below we give a short proof based on this idea, and in Section 2.2 we give an alternative algorithmic proof that efficiently finds an edge of Z connected to f in GY .\nProof. Let f be an edge of Y and let T be a triangulation that contains f . We will prove there is an edge g \u2208 Z that is connected to f in GY . There is a flip sequence from T to a triangulation that contains e = uv. The last flip in this sequence must involve an edge g of Z flipping to e. Until the last flip, we are in one connected component of F\u2212e, so, by Theorem 3, all the edges of Y in all the trianglulations in the sequence are in the same connected component of GY . Thus f and g are connected in GY .\nProof of Theorem 4. If e is a flip cut edge, then by Theorem 3, GY is disconnected. By Lemma 6, every connected component of GY contains an edge of GZ . Thus GZ is disconnected.\nIn the other direction, if GZ is disconnected, then by Lemma 5, GY is disconnected, so e is a flip cut edge by Theorem 3.\nIn the following section we give efficient algorithm that uses GZ to test if edge e is a flip cut edge, and, if so, to identify when two given triangulations are in different components of F\u2212e."
        },
        {
            "heading": "2.2 Algorithms for Flip Cut Edges",
            "text": "In this section we give an O(n log n) time algorithm to test if a given edge e is a flip cut edge. Then, with that algorithm as a preprocessing step, we give an O(n) time algorithm to test if two triangulations in T\u2212e are connected in F\u2212e. We also show how to find all flip cut edges in time O(n3) (note that there may be \u0398(n2) flip cut edges)."
        },
        {
            "heading": "2.2.1 Testing for a Flip Cut Edge",
            "text": "To test if edge e is a flip cut edge, it suffices to test if GZ is connected by Theorem 4. The algorithm also identifies the connected components of GZ (though without explicitly listing the elements of Z, since there can be \u0398(n2) of them). In particular, we find disjoint subsets A1, . . . , Ac of A, and B1, . . . , Bc of B such that the ith connected component of GZ consists of the edges of Z between Ai and Bi. Note that Z will not in general contain all pairs from Ai \u00d7Bi.\nWe first need some more properties of the sets A and B and the graph GZ . Because no empty triangle is contained in another, the ordering of a \u2208 A by decreasing (convex) angle \u2220auv is the same as the ordering by increasing (convex) angle \u2220avu. Let a1, . . . , ak be this ordering of A. Similarly, let b1, . . . , bl be the ordering of B by decreasing (convex) angle \u2220bvu, or equivalently, by increasing angle \u2220buv. Thus the cyclic order of A \u222a B around u is a1, . . . , ak, b1, . . . , bk. See Figure 10.\nObservation 7. For any point bj, the set of points ai such that the edge aibj is in Z(e) form a subinterval of the ordering of A. And similarly for ai.\nLater on, we will find it useful to have an even stronger property:\nObservation 8. Let L be the line through uv.\n1. If aibj crosses L to the right of v then the same is true for all ai\u2032bj\u2032, i \u2032 \u2265 i, j\u2032 \u2264 j.\n2. If aibj crosses L to the left of u then the same is true for all ai\u2032bj\u2032, i \u2032 \u2264 i, j\u2032 \u2265 j.\n3. If ai1bj2 and ai2bj1 are in Z for some ii \u2264 i2 and j1 \u2264 j2 then aibj is in Z for all i1 \u2264 i \u2264 i2 and all j1 \u2264 j \u2264 j2.\nProof. It suffices to prove (1), since (2) is symmetric, and (3) follows from (1) and (2). To prove (1), suppose aibj crosses L to the right of v. Then the angle \u2220aivbj is convex to the right of v, so (by the ordering) the same is true of \u2220ai+1vbj and \u2220aibj\u22121. The result follows by induction.\nFinding the ordered sets A and B. We show how to find the ordered set A in O(n log n) time. Sort all the points p \u2208 P that lie above e by decreasing angle \u2220puv, breaking ties by distance from u. Call this the u-order, <u. Also sort the same points by increasing angle \u2220pvu, and call this the v-order, <v. Define a1 be the first point in the v-order. Observe that a1 is a member of A (the first member of A), and that any points p with p <u a1 do NOT belong to A and can be discarded. In general, we proceed through the v-order. Define ai to be the next un-discarded element of the v-order, and discard all points p with p <u ai.\nTo prove that this is correct, observe that when we discard p, we have p <u ai and p >v ai, so the triangle puv contains ai, so discarding p is correct. And observe that when we choose ai, we\nhave ai\u22121 <v ai because we follow the v-order, and we have ai\u22121 <u ai because we discarded all points p <u ai\u22121 in the previous step.\nWe can find the ordered set B similarly. The time to find the ordered sets A and B is O(n log n), and in fact, it is O(n) after the preliminary sorting steps.\nFinding the connected components of GZ . Given the ordered lists A and B, we find the connected components of GZ in linear time as follows. The algorithm has two phases. In Phase 1, we find the first edge of the next component, and in Phase 2, we complete the component. Phase 1 initially begins with a1 and b1, but more generally, we will find the first edge of the next component Ac, Bc among the \u201cactive\u201d points ai, . . . , ak and bj , . . . , b`, maintaining the invariant that there are no edges of Z from an inactive point to an active point. We search for an edge that crosses uv. Let L be the line through uv. If aibj crosses L to the right of v, then by Observation 8(1), there are no edges of Z from bj to any active point. So we increment j and the invariant is maintained. If aibj crosses L to the left of u, then, with similar justification, we increment i. Continue until aibj crosses uv. This completes Phase 1\u2014we have found the first edge of the connected component. Add ai to Ac and add bj to Bc.\nFor Phase 2, we complete the connected component by alternately \u201cpivoting\u201d on ai and bj . To pivot on ai, update j to the maximum index such that aibj crosses uv, putting all the b points we find into Bc. To pivot on bj , update i to the maximum index such that aibj crosses uv, putting all the a points we find into Ac. When no more pivots are possible, we are done with this connected component and done with Phase 2. We increment i and j by 1, and go back to Phase 1 to find the next connected component.\nMore details are given as Algorithm 1. The algorithm runs in linear time since it only performs a linear scan through each of the ordered lists A and B, doing constant work for each point.\nWe now justify correctness of the algorithm. We already argued that during Phase 1 we maintain the invariant that there are no edges of Z between an inactive point and an active point, i.e., there are no edges of Z of the form ai\u2032bj\u2032 with i\n\u2032 \u2264 i and j\u2032 > j or with i\u2032 > i and j\u2032 \u2264 j. Now consider Phase 2. Observe that when we add points to Ac and Bc, they are part of the same connected component of GZ . This is because when we pivot on ai, all the b points that we add to Bc are adjacent to ai in Z, and similarly, when we pivot on bj , all the a points that we add to Ac are adjacent to bj in Z. It remains to show that when we declare a connected component \u201cdone\u201d because we can no longer pivot at ai or bj , then the invariant holds for active points ai+1, . . . , ak and bj+1, . . . , b`, i.e., there are no edges of Z of the form ai\u2032bj\u2032 with i\n\u2032 \u2264 i and j\u2032 > j or with i\u2032 > i and j\u2032 \u2264 j. First suppose ai\u2032bj\u2032 \u2208 Z for some i\u2032 \u2264 i and j\u2032 > j. Then by Observation 8(3), aibj+1 is in Z, so we would not have been done pivoting at ai. The case of i\n\u2032 > i and j\u2032 \u2264 j follows by symmetry."
        },
        {
            "heading": "2.2.2 Finding All Flip Cut Edges",
            "text": "To find all the flip cut edges, we run the above test on each of the O(n2) edges. We preprocess by sorting the points cyclically around each point p in a total of O(n2 log n) time. Then, to test a particular edge e = uv, we break the orderings around u and around v, and apply Algorithm 1, which takes linear time apart from the sorting. Thus the total time to find all flip cut edges is O(n3).\nAlgorithm 1 Connected components of GZ Input: u, v, a1, . . . , ak, b1, . . . , b` Output: Connected components of GZ in the form of A1, . . . , Ac, B1, . . . , Bc\n1: procedure ConnctedComponents 2: for all i, done[ai] \u2190 False; for all j, done[bj] \u2190 False 3: i\u2190 1; j \u2190 1; c\u2190 0 4: while i \u2264 k and j \u2264 ` do 5: // Phase 1. Find the first edge of component c 6: while aibj does not cross uv do 7: if aibj crosses L to the right of v then 8: j \u2190 j + 1; if j > ` then Halt 9: end if\n10: if aibj crosses L to the left of u then 11: i\u2190 i + 1; if i > k then Halt 12: end if 13: end while 14: c\u2190 c + 1; Insert ai into Ac, and bj into Bc 15: // Phase 2. Find all edges in component c by alternately pivoting on ai, bj until no\nfurther pivot is possible 16: repeat 17: // Pivot on ai 18: while aibj crosses uv and j \u2264 ` do 19: insert bj into Bc; j \u2190 j + 1 20: end while 21: j \u2190 j \u2212 1; done[ai] \u2190 True 22: // Pivot on bj 23: while aibj crosses uv and i \u2264 k do 24: insert ai into Ac; i\u2190 i + 1 25: end while 26: i\u2190 i\u2212 1; done[bj] \u2190 True 27: until done[ai] and done[bj] 28: i\u2190 i + 1; j \u2190 j + 1 29: end while 30: end procedure"
        },
        {
            "heading": "2.2.3 Testing Connectivity of Two Triangulations",
            "text": "We now show how to test if two triangulations T1 and T2 in T\u2212e are connected in F\u2212e. We assume that we have the output of the above algorithm, i.e., the sets A1, . . . , Ac and B1, . . . , Bc such that the ith connected component of GZ consists of the edges of Z between Ai and Bi. We can then find the component i of a given edge e \u2208 Z in constant time.\nAs mentioned in Section 2.1 one approach is to pick one edge f1 from Y \u2229 T1, and one edge f2 from Y \u2229 T2, and test if f1 and f2 are in the same connected component of GY . However, we only have GZ available to us, and there are triangulations in T\u2212e that contain no edges of Z.\nInstead, we give an algorithmic version of Lemma 6 that finds an edge g1 \u2208 Z in the same component of GY as the edges Y \u2229 T1, and an edge g2 \u2208 Z in the same component of GY as the edges Y \u2229 T2. Then we simply test if g1 and g2 are in the same set Ai \u00d7Bi.\nWe first establish correctness and then give the details of finding g1 and g2 in linear time. We must prove that g1 and g2 are connected in GZ if and only if T1 and T2 are connected in F\u2212e. Let fi be an edge of Y \u2229 Ti. By Observation 2, the edges of Y \u2229 Ti are all connected in GY , so the choice of fi is arbitrary. Now T1 and T2 are connected in F\u2212e iff (by Theorem 3) f1 and f2 are connected in GY iff (by choice of g1, g2) g1 and g2 are connected in GY iff (by Lemma 5) g1 and g2 are connected in GZ .\nWe now give the details of finding g1 (finding g2 is exactly similar). Triangulation T1 has a sequence C of triangles that intersect uv. See Figure 11. Each triangle in C shares an edge of Y \u2229T1 with the previous triangle in C, and all the edges of Y \u2229T1 are in one connected component of GY (by Observation 2). Among the vertices of triangles of C, let a be a vertex above the line L through uv that is closest to L and let b be a vertex below the line L that is closest to L. Then ab is an edge of Z and is in the same connected component as Y \u2229 T1. This can be done in linear time."
        },
        {
            "heading": "2.3 Further Results on Flip Cut Edges",
            "text": "In this section we establish some bounds on the number of flip cut edges, and on the number of disconnected components caused by forbidding one flip cut edge. To do this, we fill in the details\nof the claims made in Section 1.1 (Examples) about some special point sets: channels, hourglasses, and grid point sets. We begin by relating flip cut edges to empty convex pentagons. Throughout the section we refer to a forbidden edge e, and to Z, GZ , A, B, etc., as defined above."
        },
        {
            "heading": "2.3.1 Empty Convex Pentagons (EC5\u2019s)",
            "text": "Empty convex pentagons (EC5\u2019s) play a significant role in the study of flip graphs. Eppstein [12] studied the flip graph of points without EC5\u2019s, and gave a polynomial time algorithm to find the minimum number of flips between two given triangulatioins. Points on an n\u00d7m grid have no EC5\u2019s, and in the other direction, a point set without EC5\u2019s must have collinear points. In particular, any n \u2265 10 points in general position contain an EC5 [14], and sufficiently large point sets with no EC5 have arbitrarily large subsets of collinear points [1]. Empty convex pentagons also play a significant role in analyzing flips for coloured edges and proving the Orbit Theorem [20].\nWe show that the absence of EC5\u2019s leads to a simple condition for flip cut edges. In particular, if a point set has no EC5\u2019s, then edge e is a flip cut edge if and only if e is in (i.e., is a diagonal of) at least two EC4\u2019s. In fact it suffices to exclude local EC5\u2019s:\nLemma 9. An edge e that is not a diagonal of an EC5 is a flip cut edge if and only if it is a diagonal of at least two EC4\u2019s, i.e., |Z| \u2265 2.\nProof. If e is a flip cut edge, then by Theorem 4, GZ is disconnected, so we must have |Z| \u2265 2. (For this direction we did not use the assumption about EC5\u2019s.)\nFor the other direction, suppose e is not a flip cut edge and |Z| \u2265 2. We will show that e is a diagonal of an EC5. By Theorem 4, GZ is connected. Because neighbours in GZ are consecutive in the orderings of A and B (by Observation 7), there must be two edges f, g in Z that are incident at one end and consecutive in the ordering of A (or B) at the other end.\nWithout loss of generality, suppose f = aibj and g = ai+1bj . See Figure 12. The five points ai, ai+1, bj , u, v form a convex pentagon. (Observe that the angle at u is convex because of the EC4 Q(f), and the angle at ai is convex because ai and ai+1 make empty triangles with uv and ai precedes ai+1 in A, and similar arguments show that the other angles are convex.) If this pentagon is not empty, then it contains a point p outside Q(f) \u222a Q(g) and such a point of minimum y\ncoordinate is a point of A between ai and ai+1, contradition. Thus the pentagon is empty, so e is a diagonal of an EC5."
        },
        {
            "heading": "2.3.2 Grid Point Sets",
            "text": "The points of a k \u00d7 ` grid have no empty convex pentagons, so by Lemma 9, an edge is a flip cut edge if and only if |Z| \u2265 2. Edges \u201cnear\u201d the boundary of the grid may fail to be flip cut edges, but we show that edges farther from the boundary are flip cut edges, and we show that in an infinite grid, all edges are flip cut edges. We first deal with horizontal/vertical edges.\nClaim 10. Let e be a horizontal/vertical edge of a grid point set. Then e is a flip cut edge if and only if it does not lie on the boundary of the grid.\nProof. Note that e must have unit length since no edge goes through intermediate points. We may assume without loss of generality that e goes from (x, y) to (x + 1, y). If e lies on the boundary then Z is empty. For the converse, suppose e is not on the boundary. Then the points just above e, a1 = (x, y+ 1), a2 = (x+ 1, y+ 1), and the points just below e, b1 = (x+ 1, y\u2212 1), b2 = (x, y\u2212 1), lie in the grid, and the two edges a1, b1 and a2, b2 lie in Z, so e is a flip cut edge by Lemma 9.\nNext consider an edge e that is not horizontal or vertical. Reflect so that e goes from the point (x, y) to the point (x + \u2206x, y + \u2206y) with \u2206x \u2265 \u2206y > 1. Since an edge cannot go through intermediate points, gcd(\u2206x,\u2206y) = 1. Let L be the line through e. On the infinite grid, translate L upward and parallel to itself until it hits grid points and call the resulting line LU . Similarly, translate L downward and parallel to itself until it hits grid points, and call the resulting line LD.\nClaim 11. A grid point makes an empty triangle with e iff it lies on LU or LD.\nProof. The \u201cif\u201d direction is clear. For the other direction, consider a triangle T determined by e and an apex grid point strictly above LU . The area of T is strictly larger than the area of a triangle with apex on LU . By Pick\u2019s theorem (the area of a triangle on the grid is the number of grid points strictly inside the triangle plus half the number on the boundary of the triangle), triangle T cannot be empty.\nBy the easy direction of this claim, a grid point a \u2208 LU and a grid point b \u2208 LD provide an edge ab \u2208 Z iff ab crosses e. The other direction of the claim is used in Figure 13b to demonstrate that some edges are not flip cut edges.\nWe now analyze the points on LU and LD. We claim that there is a point a = (ax, ay) on LU with ax \u2208 [x, x+\u2206x) and ay \u2208 (y, y+\u2206y]. To justify this, note that if a = (ax, ay) is a point on LU , then so is (ax +\u2206x, ay +\u2206y) and (ax\u2212\u2206x, ay\u2212\u2206y). This implies that there is a point a = (ax, ay) on LU with ax \u2208 [x, x+\u2206x). And then we must have ay \u2208 (y, y+\u2206y] otherwise (ax, ay\u22121) would be between L and LU . By symmetry, the point b = (bx, by) := ((x+\u2206x)\u2212(ax\u2212x), (y+\u2206y)\u2212(ay\u2212y)) = (2x + \u2206x \u2212 ax, 2y + \u2206y \u2212 ay) lies on LD and has bx \u2208 (x, x + \u2206x] and by \u2208 [y, y + \u2206y). Then the segment ab crosses e at their midpoints, so ab \u2208 Z. The same is true for the segment from (ax + i\u2206x, ay + i\u2206y) to (bx \u2212 i\u2206x, by \u2212 i\u2206y) for any i = 0, 1, . . .. This implies that on an infinite grid, Z has infinite size. Thus we have proved:\nLemma 12. For the points of the infinite integer grid, every edge is a flip cut edge.\nIn a finite grid, the boundary edges are not flip cut edges, but they are not the only exceptions, see Figure 13. It is possible to characterize flip cut edge in terms of integer solutions to equations, but for now we simply note that a large enough grid of n points has \u0398(n2) flip cut edges, as justified by the following.\nProposition 13. Let G be a k \u00d7 ` grid and let G\u2032 be the middle one-third. Then every edge of G\u2032 is a flip cut edge of G.\nProof. Let e be an edge of G\u2032. We will show that Z has at least two elements. As above, we may assume that e goes from (x, y) to (x+ \u2206x, y+ \u2206y) with \u2206x \u2265 \u2206y > 1 and gcd(\u2206x,\u2206y) = 1. Since e lies in G\u2032 we have \u2206x \u2264 k/3, \u2206y \u2264 `/3.\nAs noted above, there is a point a = (ax, ay) on LU with ax \u2208 [x, x+\u2206x) and ay \u2208 (y, y+\u2206y] and a point b = (bx, by) = (2x+\u2206x\u2212ax, 2y+\u2206y\u2212ay) on LD with bx \u2208 (x, x+\u2206x] and by \u2208 [y, y+\u2206y). Both a and b lie in the grid G and ab \u2208 Z. For our second element of Z, we use the edge from (ax + \u2206x, ay + \u2206y) on LU to (bx \u2212\u2206x, by \u2212\u2206y) on LD. Note that these points lie in G."
        },
        {
            "heading": "2.3.3 The Number of Flip Cut Edges",
            "text": "In Section 1.1, we claimed that channels, as shown in Figure 3, are point sets with \u0398(n2) flip cut edges. Here we justify that claim.\nProposition 14. For a channel, every edge between an interior point on the upper reflex chain and an interior point on the lower reflex chain is a flip cut edge.\nProof. Let the points of the upper reflex chain be t1, . . . , tn and the points of the lower reflex chain be b1, . . . , bn, as shown in Figure 3. Consider the edge bitj where i, j /\u2208 {1, n}. We use Lemma 9 to show that bitj is a flip cut edge. There is no EC5 with bitj as a diagonal because such an EC5 would have to have at least 3 points of one reflex chain, say the upper one, and those points cannot be part of a convex polygon with bi. However, both the edges bi\u22121tj+1 and bi+1tj\u22121 form EC4\u2019s together with bitj . Thus by Lemma 9, bitj is a flip cut edge."
        },
        {
            "heading": "2.3.4 The Number of Components from a Flip Cut Edge",
            "text": "In Section 1.1, we claimed that one flip cut edge e can cause \u0398(n) disconnected components in F\u2212e. Here we justify that claim.\nTheorem 15. A flip cut edge can create O(n) disconnected components in the flip graph, and this is the most possible.\nProof. First of all, connected components in the flip graph F\u2212e correspond to connected components in GY (by Theorem 3) and therefore correspond to disjoint sets of points, so there are at most n of them.\nThe hourglass in Figure 4 is an example of a point set of size 2n+ 2 with a flip cut edge e that results in n components in F\u2212e. To construct the hourglass, place points a1, . . . , an along the top half of a circle, and let b1, . . . , bn be the diametrically opposite points. For each i construct the wedge from ai to bi\u22121 and bi+1. Place points u and v on the horizontal diameter of the circle, so close to the center of the circle that they are inside all the wedges. Then GY consists of the n edges aibi, and no two of these are connected in GY . Thus (by Theorem 3) F\u2212e has n disconnected components."
        },
        {
            "heading": "3 Flip Cut Number for Points in Convex Position",
            "text": "As mentioned in the Introduction, a point set in convex position has no flip cut edge, i.e., its flip cut number is greater than 1. In this section we show that the flip cut number of n points in convex position is n\u2212 3.\nWe give a direct proof, but first we discuss what the result means in terms of associahedra. The flip graph of n points in convex position is the 1-skeleton of the (n\u2212 3)-dimensional associahedron An\u22121 (see Figure 2) so by Balinski\u2019s theorem [3], the 1-skeleton is (n \u2212 3)-connected. The dual polytope A\u0304n\u22121 is also an (n\u2212 3)-dimensional polytope with an (n\u2212 3)-connected 1-skeleton. The face lattice of A\u0304n\u22121 is the inverted face lattice of An\u22121, so the vertices of A\u0304n\u22121 correspond to the (n \u2212 4)-dimensional faces (the facets) of An\u22121 and the edges of A\u0304n\u22121 correspond to (n \u2212 5)- dimensional faces of An\u22121. Forbidding a chord of the original polygon corresponds to deleting a facet of An\u22121, i.e., a vertex of A\u0304n\u22121. Deleting fewer than n\u2212 3 facets of An\u22121 leaves the remaining facets connected via (n\u22125)-dimensional faces. What our result shows is that the remaining vertices (0-dimensional faces) of An\u22121 are connected via the remaining edges (1-dimensional faces) of An\u22121. We do not see how to prove our result using this polyhedral interpretation. Instead, we give a direct proof that the flip cut number of n points in convex position is n\u2212 3.\nFor points in convex position, we number the points p1, . . . , pn in cyclic order around the convex hull. The edges pipi+1 (addition modulo n) must be present in every triangulation. A chord is a line segment joining points that are not consecutive in the cyclic ordering. An ear is a chord of the form pi\u22121pi+1 (addition modulo n), and we say that this ear cuts off point pi. Every triangulation of a convex point set on n \u2265 4 points has at least two ears (because the dual tree has at least two leaves). A star triangulation is a triangulation all of whose chords are incident to the same point.\nFor a set X of chords, we study connectivity of F\u2212X . We define the degree of a point p in X to be the number of chords of X incident to p.\nWe begin with a necessary condition for a flip cut set. This provides a rigourous proof that the flip cut number is greater than 1, and will also be needed for our main result.\nLemma 16. If X is a flip cut set for a set of points in convex position, then every point is incident to an edge of X, i.e., the degree in X of every point is at least 1.\nProof. We prove the contrapositive: if there is a point p \u2208 P with no incident edges of X, then X is not a flip cut set. Specifically, we prove that any triangulation T in T\u2212X is connected to the star triangulation centered at p. This is in fact the standard way to show connectivity of the (full) flip graph of a convex point set. In our situation, we must show that the required flips do not use forbidden edges.\nSo, suppose triangulation T contains a triangle incident to p whose other two points, q and r, are not consecutive on the convex hull. Now T contains a triangle, say qrs, on the other side of qr. Then pqsr forms a convex quadrilateral, and we can flip the chord qr to the chord ps (which is not forbidden). This increases the number of chords incident to p, so, by induction, T can be flipped to the star triangulation centered at p without using forbidden edges.\nCorollary 17. There is no flip cut edge in a convex point set.\nIn the rest of this section we prove that the flip cut number for n points in convex position is n\u2212 3. We begin with the following two lemmas.\nLemma 18. A convex point set of size n has a flip cut set of size n\u2212 3.\nProof. Consider a \u201czigzag\u201d triangulation T of a convex n-gon as shown in Figure 14a. This triangulation has n\u22123 chords that form a path p0, pn\u22122, p1, pn\u22123, ..., pbn\n2 c. Each chord e of T can flip to a\nunique other chord f(e). If we forbid the n\u22123 chords X := {f(e) : e a chord of T} then T becomes a frozen triangulation, i.e., it becomes an isolated node in the flip graph F\u2212X . In order to complete the proof, we only need to show that there exists another triangulation in F\u2212X different from T . (This is where we use that T is a zig-zag triangulation\u2014for example, a star triangulation would not work.) We create another zigzag triangulation T \u2032 in the following way. The path of chords for T \u2032 starts at the same vertex p0 = pn but the first chord from p0 goes in the other direction, i.e., to p2. See Figure 14b. The new zigzag path is p0, p2, pn\u22121, p3, pn\u22122, ...pdn\n2 e. We prove that T \u2032 does not use any forbidden edges. Note that each forbidden edge crosses only one chord of T . However, each chord of T \u2032, crosses at least two chords of T . This is because each chord in T \u2032 of the form pi+2pn\u2212i for i = 0, .., bn2 c \u2212 2 crosses pi+1pn\u2212i\u22122 and pi+1pn\u2212i\u22123 from T and any chord of the form\npi+1pn\u2212i for i = 1, .., bn2 c\u22122 in T \u2032 crosses pipn\u2212i\u22121 and pi\u22121pn\u2212i\u22121 from T . So, since each forbidden edge e \u2208 X crosses exactly one chord of T , but each chord of T \u2032 crosses at least two chords of T , therefore T \u2032 does not contain any forbidden edges.\nLemma 19. Consider a convex point set P with n points and a set X of forbidden edges with |X| \u2264 n \u2212 3. Then there is a triangulation of P that uses no forbidden edges, i.e., T\u2212X is nonempty.\nProof. The proof is by induction on n with base case n = 3. If there is a point p that is incident to no forbidden edges, then take the star triangulation at p. Otherwise, suppose every point is incident to at least one forbidden edge. There are n chords of the form pi\u22121pi+1 (addition modulo n). So, there exists at least one of them that is not forbidden. Suppose it is pi\u22121pi+1. We build a triangulation containing the ear pi\u22121pi+1. Let P\n\u2032 be P \u2212{pi} of size n\u2032 = n\u22121. Since pi is incident to at least one forbidden edge, there are at most n \u2212 4 = n\u2032 \u2212 3 forbidden edges of P \u2032. Thus, by induction, there is a triangulation of P \u2032 that uses no forbidden edges. Together with chord pi\u22121pi+1 this provides the desired triangulation of P . Thus T\u2212X is non-empty.\nTheorem 20. The flip cut number of a convex point set P with n points is n\u2212 3.\nProof. By Lemma 18, we can disconnect P \u2019s flip graph by forbidding n\u2212 3 edges. So, now we only need to show that if X is a set of forbidden edges and |X| \u2264 n \u2212 4, then F\u2212X(P ) is connected. By Lemma 16, F\u2212X(P ) is connected if there is a point p \u2208 P not incident to any edge of X. Thus we may assume that every point p \u2208 P is incident to some edge of X. Let S and T be two triangulations of P that do not contain any edges of X. We will prove that S is connected to T in F\u2212X(P ). We will prove this by induction on n, with the base case n = 3 where the statement is vacuously true.\nWe know that each triangulation contains at least two ears. We consider two cases. Case 1. S and T have a shared ear that cuts off point pi. Consider sub-polygon P\n\u2032 obtained by removing point pi. By assumption there is a forbidden edge incident to pi. Let X\n\u2032 be the forbidden edges of X not incident to pi. Then |X \u2032| \u2264 |X| \u2212 1 \u2264 |P | \u2212 5 = |P \u2032| \u2212 4 so by induction, the triangulations of P \u2032 induced from S and T are connected in F\u2212X\u2032(P \u2032). Thus S and T are connected in F\u2212X(P ). Case 2. S and T have no shared ear. We claim that there is an ear e1 in S and an ear e2 in T such that e1 and e2 do not cross, i.e., the points that are cut off by e1 and by e2 are not adjacent on the convex hull. Suppose S has an ear e1 that cuts off point pi. T has at least two ears, and if they cross e1, they must cut off points pi\u22121 and pi+1. But then the second ear of S cannot cross both these ears of T unless n = 4 (and X = \u2205), in which case, a single flip converts S to T .\nThus we may assume a pair of non-crossing ears e1 of S and e2 of T . Suppose e1 cuts off point q1 and e2 cuts off point q2. Let P1 be P \u2212 {q1}. P1 has n1 = n \u2212 1 points. Let X1 be the forbidden edges of X induced on P1. By assumption there is at least one edge of X incident to q1, so |X1| \u2264 |X| \u2212 1 \u2264 n \u2212 5 = n1 \u2212 4. By induction, the flip graph F\u2212X1(P1) is connected. Let S1 be the triangulation of P1 formed by cutting the ear e1 off S. The plan is to apply induction on P1 to connect triangulation S1 to a new triangulation R1 of P1 that includes the chord e2.\nWe construct R1 as follows. Let P2 be P \u2212 {q1, q2}. Then P2 has size n2 = n \u2212 2. Let X2 be the forbidden edges of X induced on P2. Then |X2| \u2264 |X1| \u2264 n1 \u2212 4 = n2 \u2212 3. By Lemma 19, P2 has a triangulation that uses no chords of X2. Adding chord e2 yields the triangulation R1.\nBy induction on P1 and X1 the triangulations S1 and R1 are connected in F\u2212X1(P1). Finally, R1 and T share the ear e2, so by Case 1, they are connected in F\u2212X(P ). Altogether, we have connected S to T in F\u2212X(P ), as required."
        },
        {
            "heading": "4 Conclusions and Open Problems",
            "text": "We examined connectivity of the flip graph of triangulations when some edges between points are forbidden, and introduced the concepts of flip cut edges, flip cut sets, and the flip cut number. We gave an O(n log n) time algorithm to identify flip cut edges and test connectivity after forbidding a flip cut edge, and we proved that the flip cut number of a convex n-gon is n \u2212 3. We conclude with some open questions.\n1. Is there a polynomial time algorithm to test if a set of edges is a flip cut set? To compute the flip cut number?\n2. The asymptotic diameter of the flip graph of a convex n-gon is 2n \u2212 10\u2014a famous result of Sleater, Tarjan and Turston [26], improved to all n > 12 by Pournin [24]. For a convex point set and a set X of forbidden edges with |X| < n\u2212 3 what is the diameter of F\u2212X in terms of n and |X|?\n3. It is open whether there is a polynomial time algorithm for the flip distance problem for a convex polygon. Is the following generalization NP-complete: Given n points in convex position, a set X of forbidden chords, two triangulations T1 and T2, and a number k, is the flip distance from T1 to T2 in F\u2212X less than or equal to k?\n4. A flip cut edge is a bottleneck to connecting triangulations via flips. One might guess that point sets with no flip cut edges provide better mixing properties. More generally, how does the flip cut number affect mixing properties?"
        },
        {
            "heading": "Acknowledgements",
            "text": "For helpful comments we thank Lionel Pournin and participants of the 2022 Banff International Research Station (BIRS) workshop on Combinatorial Reconfiguration."
        }
    ],
    "title": "Forbidding Edges between Points in the Plane to Disconnect the Triangulation Flip Graph",
    "year": 2022
}