{
    "abstractText": "With the flourishing development of nanophotonics, Cherenkov radiation pattern can be designed to achieve superior performance in particle detection by fine-tuning the properties of metamaterials such as photonic crystals (PCs) surrounding the swift particle. However, the radiation pattern can be sensitive to the geometry and material properties of PCs, such as periodicity, unit thickness, and dielectric fraction, making direct analysis and inverse design difficult. In this article, we propose a systematic method to analyze and design PC-based transition radiation, which is assisted by deep learning neural networks. By matching boundary conditions at the interfaces, Cherenkov-like radiation of multilayered structures can be resolved analytically using the cascading scattering matrix method, despite the optical axes not being aligned with the swift electron trajectory. Once well trained, forward deep learning neural networks can be utilized to predict the radiation pattern without further direct electromagnetic simulations; moreover, Tandem neural networks have been proposed to inversely design the geometry and/or material properties for desired Cherenkov radiation pattern. Our proposal demonstrates a promising strategy for dealing with layered-medium-based Cherenkov radiation detectors, and it can be extended for other emerging metamaterials, such as photonic time crystals. \u00a9 2022 Optica Publishing Group",
    "authors": [
        {
            "affiliations": [],
            "name": "XIAOKE GAO"
        },
        {
            "affiliations": [],
            "name": "XIAOYU ZHAO"
        },
        {
            "affiliations": [],
            "name": "RUOYU HUANG"
        },
        {
            "affiliations": [],
            "name": "SIYUAN MA"
        },
        {
            "affiliations": [],
            "name": "XIKUI MA"
        },
        {
            "affiliations": [],
            "name": "TIANYU DONG"
        }
    ],
    "id": "SP:15f2ae478da3cfb0f7956177829f674a15c6e5cd",
    "references": [
        {
            "authors": [
                "J.V. Jelley"
            ],
            "title": "Cerenkov radiation and its applications,",
            "venue": "Br. J. Appl. Phys. 6,",
            "year": 1955
        },
        {
            "authors": [
                "J.E. Walsh",
                "E.E. Fisch"
            ],
            "title": "Radio-frequency-injector-driven Cherenkov free-electron laser,",
            "venue": "Nucl. Instruments Methods Phys. Res. Sect. A: Accel. Spectrometers, Detect. Assoc. Equip",
            "year": 1992
        },
        {
            "authors": [
                "H. Liu",
                "X. Zhang",
                "B. Xing",
                "P. Han",
                "S.S. Gambhir",
                "Z. Cheng"
            ],
            "title": "Radiation-luminescence-excited quantum dots for in vivo multiplexed optical imaging,",
            "venue": "Small 6,",
            "year": 2010
        },
        {
            "authors": [
                "A.K. Glaser",
                "R. Zhang",
                "J.M. Andreozzi",
                "D.J. Gladstone",
                "B.W. Pogue"
            ],
            "title": "Cherenkov radiation fluence estimates in tissue for molecular imaging and therapy",
            "venue": "applications,\u201d Phys. Med. & Biol",
            "year": 2015
        },
        {
            "authors": [
                "S. Liu",
                "P. Zhang",
                "W. Liu",
                "S. Gong",
                "R. Zhong",
                "Y. Zhang",
                "M. Hu"
            ],
            "title": "Surface polariton Cherenkov light radiation source,",
            "venue": "Phys. Rev. Lett. 109,",
            "year": 2012
        },
        {
            "authors": [
                "J. Yao",
                "P. Liu",
                "D. Xu",
                "Y. Lv",
                "D. Lv"
            ],
            "title": "THz source based on optical Cherenkov radiation,",
            "venue": "Sci. China Inf. Sci. 55,",
            "year": 2012
        },
        {
            "authors": [
                "P. Zhang",
                "M. Hu",
                "R. Zhong",
                "X. Cheng",
                "S. Gong",
                "T. Zhao",
                "S. Liu"
            ],
            "title": "A tunable terahertz radiation source based on a surface wave trans- formed into Cherenkov radiation in a subwavelength array,",
            "venue": "J. Phys. D: Appl. Phys",
            "year": 2016
        },
        {
            "authors": [
                "R. Zhong",
                "C. Yu",
                "M. Hu",
                "S. Liu"
            ],
            "title": "Surface plasmon polaritons light radiation source with asymmetrical structure,",
            "venue": "AIP Adv",
            "year": 2018
        },
        {
            "authors": [
                "Z. Su",
                "B. Xiong",
                "Y. Xu",
                "Z. Cai",
                "J. Yin",
                "R. Peng",
                "Y. Liu"
            ],
            "title": "Manipulating Cherenkov radiation and Smith\u2013Purcell radiation by artificial structures,",
            "venue": "Adv. Opt. Mater",
            "year": 2019
        },
        {
            "authors": [
                "M. Bache",
                "O. Bang",
                "B.B. Zhou",
                "J. Moses",
                "F.W. Wise"
            ],
            "title": "Optical Cherenkov radiation in ultrafast cascaded second-harmonic genera- tion,",
            "venue": "Phys. Rev. A",
            "year": 2010
        },
        {
            "authors": [
                "H. Hu",
                "X. Lin",
                "L.J. Wong",
                "Q. Yang",
                "D. Liu",
                "B. Zhang",
                "Y. Luo"
            ],
            "title": "Surface Dyakonov\u2013Cherenkov radiation,",
            "venue": "eLight 2,",
            "year": 2022
        },
        {
            "authors": [
                "F. Liu",
                "L. Xiao",
                "Y. Ye",
                "M. Wang",
                "K. Cui",
                "X. Feng",
                "W. Zhang",
                "Y. Huang"
            ],
            "title": "Integrated Cherenkov radiation emitter eliminating the electron velocity threshold,",
            "venue": "Nat. Photonics",
            "year": 2017
        },
        {
            "authors": [
                "D. Wintz",
                "A. Ambrosio",
                "A.Y. Zhu",
                "P. Genevet",
                "F. Capasso"
            ],
            "title": "Anisotropic surface plasmon polariton generation using bimodal V- antenna based metastructures,",
            "venue": "ACS Photonics",
            "year": 2017
        },
        {
            "authors": [
                "J. Benedicto",
                "R. Poll\u00e8s",
                "C. Cirac\u00ec",
                "E. Centeno",
                "D.R. Smith",
                "A. Moreau"
            ],
            "title": "Numerical tool to take nonlocal effects into account in metallo-dielectric multilayers,",
            "venue": "J. Opt. Soc. Am. B",
            "year": 2015
        },
        {
            "authors": [
                "T. Dong",
                "Y. Shi",
                "L. Lu",
                "F. Chen",
                "X. Ma",
                "R. Mittra"
            ],
            "title": "Optical response of cylindrical multilayers in the context of hydrodynamic convection- diffusion model,",
            "venue": "J. Appl. Phys. 120,",
            "year": 2016
        },
        {
            "authors": [
                "T. Dong",
                "K. Yin",
                "G. Li",
                "X. Ma"
            ],
            "title": "Numerical tool for analyzing planar semiconductor multilayers within the two-fluid hydrodynamic model framework,",
            "venue": "IEEE Trans. on Magn",
            "year": 2020
        },
        {
            "authors": [
                "P. Yeh"
            ],
            "title": "Optics of anisotropic layered media: a new 4\u00d7 4 matrix alge- bra,",
            "venue": "Surf. Sci. 96,",
            "year": 1980
        },
        {
            "authors": [
                "M.I. Jordan",
                "T.M. Mitchell"
            ],
            "title": "Machine learning: trends, perspectives, and prospects,",
            "venue": "Science 349,",
            "year": 2015
        },
        {
            "authors": [
                "R. Susmita"
            ],
            "title": "A quick review of machine learning algorithms,",
            "year": 2019
        },
        {
            "authors": [
                "C. Ma",
                "G. Li",
                "L. Qin",
                "W. Huang",
                "H. Zhang",
                "W. Liu",
                "T. Dong",
                "S.-T. Li"
            ],
            "title": "Analytical model of micropyramidal capacitive pressure sensors and machine-learning-assisted design,",
            "venue": "Adv. Mater. Technol",
            "year": 2021
        },
        {
            "authors": [
                "S. Molesky",
                "Z. Lin",
                "A.Y. Piggott",
                "W. Jin",
                "J. Vuckovi\u0107",
                "A.W. Ro"
            ],
            "title": "driguez, \u201cInverse design in nanophotonics,",
            "venue": "Nat. Photonics",
            "year": 2018
        },
        {
            "authors": [
                "W. Ma",
                "Z. Liu",
                "Z.A. Kudyshev",
                "A. Boltasseva",
                "W. Cai",
                "Y. Liu"
            ],
            "title": "Deep learning for the design of photonic structures,",
            "venue": "Nat. Photonics",
            "year": 2021
        },
        {
            "authors": [
                "P.R. Wiecha",
                "A. Arbouet",
                "C. Girard",
                "O.L. Muskens"
            ],
            "title": "Deep learning in nano-photonics: inverse design and beyond,",
            "venue": "Photonics Res. 9,",
            "year": 2021
        },
        {
            "authors": [
                "D. Liu",
                "Y. Tan",
                "E. Khoram",
                "Z. Yu"
            ],
            "title": "Training deep neural networks for the inverse design of nanophotonic structures,",
            "venue": "ACS Photonics",
            "year": 2018
        },
        {
            "authors": [
                "J. Jiang",
                "M. Chen",
                "J.A. Fan"
            ],
            "title": "Deep neural networks for the evaluation and design of photonic devices,",
            "venue": "Nat. Rev. Mater",
            "year": 2021
        },
        {
            "authors": [
                "T. Ma",
                "T. Mustafa",
                "H. Wang",
                "G. L Jay"
            ],
            "title": "Benchmarking deep learning-based models on nanophotonic inverse design problems,",
            "venue": "Opto-Electronic Sci",
            "year": 2022
        },
        {
            "authors": [
                "V.N.V.L. Ginzburg"
            ],
            "title": "Tsytovich, \u201cSeveral problems of the theory of transition radiation and transition scattering,",
            "venue": "Phys. Reports 49,",
            "year": 1979
        },
        {
            "authors": [
                "V.L. Ginzburg"
            ],
            "title": "Transition radiation and transition scattering,",
            "venue": "Phys. Scripta 1982,",
            "year": 1982
        },
        {
            "authors": [
                "W. Ma",
                "F. Cheng",
                "Y. Liu"
            ],
            "title": "Deep-learning-enabled on-demand design of chiral metamaterials,",
            "venue": "ACS Nano 12,",
            "year": 2018
        },
        {
            "authors": [
                "K. Sohn",
                "H. Lee",
                "X. Yan"
            ],
            "title": "Learning structured output representation using deep conditional generative models,",
            "venue": "Adv. Neural Inf. Process. Syst. 28,",
            "year": 2015
        },
        {
            "authors": [
                "Z. Liu",
                "D. Zhu",
                "S.P. Rodrigues",
                "K.-T. Lee",
                "W. Cai"
            ],
            "title": "Generative model for the inverse design of metasurfaces,",
            "venue": "Nano Lett",
            "year": 2018
        },
        {
            "authors": [
                "G. Ross"
            ],
            "title": "Fast R-CNN,",
            "venue": "Proceedings of the IEEE International Con- ference on Computer Vision (ICCV),",
            "year": 2015
        },
        {
            "authors": [
                "A. Paszke",
                "S. Gross",
                "F. Massa",
                "A. Lerer",
                "J. Bradbury",
                "G. Chanan",
                "T. Killeen",
                "Z. Lin",
                "N. Gimelshein",
                "L. Antiga",
                "A. Desmaison",
                "A. Kopf",
                "E. Yang",
                "Z. DeVito",
                "M. Raison",
                "A. Tejani",
                "S. Chilamkurthy",
                "B. Steiner",
                "L. Fang",
                "J. Bai",
                "S. Chintala"
            ],
            "title": "PyTorch: An imperative style, high- performance deep learning library,",
            "venue": "Advances in Neural Information Processing Systems",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Analysis and design of transition radiation in layered uniaxial crystals using Tandem neural networks XIAOKE GAO ID 1, XIAOYU ZHAO ID 1, RUOYU HUANG ID 1, SIYUAN MA ID 1, XIKUI MA1, AND TIANYU DONG ID 1,*\n1School of Electrical Engineering, Xi\u2019an Jiaotong University, Xi\u2019an 710049, China *Corresponding author: tydong@mail.xjtu.edu.cn\nCompiled November 24, 2022\nWith the flourishing development of nanophotonics, Cherenkov radiation pattern can be designed to achieve superior performance in particle detection by fine-tuning the properties of metamaterials such as photonic crystals (PCs) surrounding the swift particle. However, the radiation pattern can be sensitive to the geometry and material properties of PCs, such as periodicity, unit thickness, and dielectric fraction, making direct analysis and inverse design difficult. In this article, we propose a systematic method to analyze and design PC-based transition radiation, which is assisted by deep learning neural networks. By matching boundary conditions at the interfaces, Cherenkov-like radiation of multilayered structures can be resolved analytically using the cascading scattering matrix method, despite the optical axes not being aligned with the swift electron trajectory. Once well trained, forward deep learning neural networks can be utilized to predict the radiation pattern without further direct electromagnetic simulations; moreover, Tandem neural networks have been proposed to inversely design the geometry and/or material properties for desired Cherenkov radiation pattern. Our proposal demonstrates a promising strategy for dealing with layered-medium-based Cherenkov radiation detectors, and it can be extended for other emerging metamaterials, such as photonic time crystals. \u00a9 2022 Optica Publishing Group\nhttp://dx.doi.org/10.1364/josab.XXXXXX"
        },
        {
            "heading": "1. INTRODUCTION",
            "text": "Since its discovery in the 1930\u2019s, Cherenkov radiation has demonstrated a variety of applications, such as the detection of highenergy charged particles [1] and Cherenkov free-electron laser [2], labeled bio-molecules detection [3], molecular imaging [4] and cosmic rays detection [5], to name a few. Recent applications of Cherenkov radiation in the emerging field of nanophotonics including surface plasmon excitation [6\u201310] and charged particle velocity detection [11\u201314]. Significant research efforts are concentrated on regulating the radiation behaviors and lowing or even eliminating the Cherenkov threshold through the use of metamaterials and metasurface, which have fascinating applications, e.g., hyperbolic-metamaterial-based intense Cherenkov radiation emitted by low-energy electrons [15, 16], controlling the transition radiation angles with high sensitivity by photonic crystals (PCs) [12, 17], controlling the Cherenkov radiation by the metasurface with one-dimensional sub-wavelength rotated apertures [18], etc. In addition, particle identification sensitivity can be increased by introducing material anisotropy for Cherenkov radiation [19] and surface Dyakonov\u2013Cherenkov radiation [13].\nRecently, it has been demonstrated that the angle of Cherenkov radiation can be controlled with resonance transition\nradiation by modifying the photonic crystal band structure [12]; additionally, the velocity direction of the swift charge can be distinguished by introducing uniaxial media [13]. Theoretically, Cherenkov radiation can be controlled by modifying the properties of multilayered (meta)materials surrounding the swift electron, such as the periodicity, thickness of the unit cells, dielectric permittivity, and fractions or filling ratios. In order to analyze and design Cherenkov radiation, electromagnetic simulation of such a structure is essential. Other than widely-used general numerical methods such as finite element methods or finite difference time domain methods in nanophotonics, analytical solution may be obtained for layered structures [12], even when the material is spatially dispersive [20\u201322]. Yet most work focus either on the plane wave interaction with layered structure comprised of anisotropic media [23] or on the interaction of swift electron on 1D PCs comprised of isotropic medium [12], we have extended the powerful scattering matrix method (SMM) for simulating the Cherenkov transition radiation of multilayered structures that may contain anisotropic uniaxial crystals, even when the optical axis is not aligned to the electron trajectory.This numerical Swiss army knife for the Cherenkov radiation of multilayers provides not only a potent electromagnetic simulation ar X iv :2 21 1.\n15 11\n7v 1\n[ ph\nys ic\ns. op\ntic s]\n2 8\nN ov\n2 02\n2\ntool, but also an easy-to-use and highly efficient data generator for the deep neural networks that will be presented in the following section.\nDespite the fact that multilayered PC-based Cherenkov detectors have high performance when the transition resonances exhibit [12], it can be allergic to the material permittivity and the filling ratio. When a PC reduces to an ordinary multilayered structure due to fabrication error or the periodicity of PC changes, the above-mentioned direct analytical solution can be time-consuming with the large number of layers, which is unacceptable for the inverse design of such a multilayered structure. In this regard, the rapidly developing data-driven methods based on machine learning [24\u201327] offer promising solutions to such nanophotonic problems for both the direct simulation and the inverse design [28\u201330]. Rather than directly solving a problem for given parameters using conventional methods, one can generate a neural network (NN) whose training data are available according to present analytical or numerical methods, and new problems can be resolved by the well-trained deep neural networks even if the provided parameters do not appear in the training dataset. The NN-assisted methods have been successful in predicting the optical properties of a complex physical system, such as the extinction spectrum of multilayered nano-particles and meta-structures [31, 32] and the dispersion relation of metamaterials, etc.; they are also capable of inverse design when the desired properties are required. Typically, an inverse problem presents multiple solutions for a specific desired response, which traditional neural networks cannot effectively solve because they are difficult to converge [33]. The deterministic and generative modes , such as Tandem networks, variational auto-encoders (VAEs), and generative adversarial networks (GAN), etc, have been introduced to the nanophotonic community in order to solve the convergence problems for inverse problems [34]. In this paper, a Tandem network containing the pre-trained simulation forward sub-net is proposed, which demonstrates excellent performance in the design of multilayer-PC-based meta-structures for effective Cherenkov radiation.\nBeginning with the transition radiation at a single interface [35, 36], we derive the boundary conditions for general anisotropic uniaxial crystals. Next, the generalized scattering matrix method that accounts for inhomogeneous source term has been proposed to calculate the interaction between a swift electron and a multilayered structure. In addition, by varying the angle between the electron trajectory and the optical axis of uniaxial crystals, we demonstrate the existence of a strong directional effective Cherenkov radiation in the plane perpendicular to the charge velocity. A Tandem network has also been proposed to manage the inverse design of PC-based effective Cherenkov-like radiation."
        },
        {
            "heading": "2. THEORY AND METHODS",
            "text": "Fig. 1 depicts the schematic of a swift electron traversing perpendicularly a single planar interface located at z = zn, which is separated by two mediums denoted by n and n + 1. The interface normal is parallel to the electron\u2019s trajectory, i.e., z-axis. In general, \u03b5d = diag(\u03b51, \u03b52, \u03b53) represents the relative permittivity of the nonmagnetic medium, which can be isotropic, uniaxial or bi-axial. When the medium is isotropic, \u03b51 = \u03b52 = \u03b53 and when it is uniaxial, \u03b51 = \u03b52 6= \u03b53. For uniaxial crystals, the optic axis may be deviated from the z-axis; therefore, the corresponding dielectric tensor reads \u03b5 = \u039b\u22121\u03b5d\u039b, where \u039b = \u039b(\u03b1, \u03b2, \u03b3) is the so-called Euler rotation matrix (y-z-y type) with \u03b1, \u03b2 and \u03b3 being\nthe Euler angles (pitch, yaw, and roll angles, respectively) of the global coordinate axes and the \u201coptical axes\u201d determined by the uniaxial permittivity \u03b5d."
        },
        {
            "heading": "A. Governing equations and the solutions",
            "text": "Assuming that the velocity of the electron v = z\u0302v is unaffected by the radiation, the swift electron can be regarded as a current source which can be expressed as Je(r, t) = z\u0302qv\u03b4(x)\u03b4(y)\u03b4(z\u2212 vt). Thus, the governing partial differential equation (PDE) for the electric field En(r, t) inside the n-th layer reads as\n\u2207\u00d7\u2207\u00d7 En(r, t) + \u00b50\u03b50\u03b5n \u00b7 \u22022t En(r, t) = \u2212\u00b50\u2202tJe(r, t), (1)\nwhere \u00b50 and \u03b50 are the permeability and permittivity of the free space, respectively; \u03b5n is the relative dielectric tensor of the n-th layer; \u2202t and \u22022t denote the first- and second-order time derivatives, respectively.\nFor the considered multilayered structure, instead of handling the wave equation (1) in the spatial-temporal domain, we can apply the Fourier transform defined as\nF(kx, ky, z, \u03c9) = \u222b F(r, t)ei(\u03c9t\u2212kx x\u2212kyy)dtdxdy (2a)\nto the source Je(r, t) and the fields En(r, t), with the inverse Fourier transform reading as\nF(r, t) = (\n1 2\u03c0\n)3 \u222b F(kx, ky, z, \u03c9)e\u2212i(\u03c9t\u2212kx x\u2212kyy)d\u03c9dkxdky.\n(2b) Here, an e\u2212i\u03c9t time harmonic is adopted throughout. Note that, although the same kernels F are shared in (2a) and (2b), they are essential different physical quantities for different domain of interest; and the arguments (kx, ky, z, \u03c9) or (r, t) are typically omitted without introducing ambiguity hereafter. Therefore, the wave equation (1) in the spatial-temporal domain can be rewritten in the hybrid domain {kx, ky, z, \u03c9} as k2y \u2212 d 2 dz2 \u2212kxky ikx \u00b7 d dz \u2212kykx k2x \u2212 d 2 dz2 iky \u00b7 d dz\nd dz \u00b7 ikx\nd dz \u00b7 iky k 2 x + k2y  \u00b7En\u2212 \u03b5nk20 \u00b7En = i\u03c9\u00b50Je, (3) where Je(kx, ky, z, \u03c9) = z\u0302qeikez with ke = \u03c9/v; k20 = \u03c9\n2\u00b50e0 denotes the wave number in free space; d/dz and d2/dz2 denote the first- and second-order spatial derivatives with respect to\nthe variable z, respectively. Now, the ordinary differential equations (ODEs) (3) can be solved in the hybrid domain for different wavenumbers kx and ky at different frequencies \u03c9, and the final solutions to the original PDEs (1) can be readily obtained using the inverse Fourier transform (2b). For the inhomogeneous ODE (3), the solution consists of the so-called the general solutions En,g and the particular solution En,p, which correspond to the transverse electromagnetic modes and the longitudinal electromagnetic mode excited by the moving charge, respectively.\nGeneral solution. For the general solutions En,g to (3), they satisfy dEn,g/dz = ikz,nEn,g. As a result, a set of linear algebraic equations can be derived, which reads\nMn,g(kx, ky, kz,n, k0) \u00b7 En,g = 0, (4)\nwhere\nMn,g(kx, ky, kz,n, k0) = \u03b5nk20\u2212  k2y + k2z,n \u2212kxky \u2212kxkz,n \u2212kykx k2x + k2z,n \u2212kykz,n \u2212kz,nkx \u2212kz,nky k2x + k2y  . (5) For any non-trivial modes En,g, the zero determinant of the matrix Mn,g(kx, ky, kz,n, k0) yields the dispersion relation of the material, i.e.,\ndet[Mn,g(kx, ky, kz,n, k0)] = 0, (6)\nwhich is a quartic polynomial equation with respect to kz, whose solutions are denoted by k(i)z,n (i = 1, 2, 3, 4), indicating that four different waves could exhibit. Accordingly, the corresponding polarization modes E(i)n can be readily obtained by evaluating the null space of the matrix M(i)n,g(kx, ky, k (i) z,n, k0), i.e.,\nE(i)n = NullVector[Mn,g(kx, ky, k (i) z,n, k0)], (7)\nwhich corresponds to the wave vector k = (kx, ky, k (i) z,n). Specifically, when the material is isotropic, modes will be degenerated. In the subsequent discussion, we assume that k(1)z,n ( k (3) z,n) corresponds the forward wave and k(2)z,n (k (4) z,n) corresponds the backward wave. As a result, the general solutions to (3) can be expressed in terms of the independent modes E(i)n .\nParticular solution. For the particular solution En,s to (3), it satisfies dEn,s/dz = ikeEn,s since the inhomogeneous source term \u2212i\u03c9\u00b50Je = \u2212z\u0302i\u03c9\u00b50qeikez is a harmonic function with respect to z. Thus, one can obtain a set of linear algebraic equations from (3), which reads as\nMn,s(kx, ky, k0) \u00b7 En,s = \u2212i\u03c9\u00b50Je, (8)\nwhere Mn,s(kx, ky, k0) = Mn,g(kx, ky, ke, k0). As a result, the particular solution to (3) can be directly obtained as\nEsn = \u2212i\u03c9\u00b50M\u22121n,s (kx, ky, k0) \u00b7 Je. (9)"
        },
        {
            "heading": "B. Boundary conditions",
            "text": "Given the general solution En,g for the transverse wave and the particular solution Esn for the longitudinal wave, the overall electric field in each layer En(r) can be expressed in terms of theses modes En,g and Esn, which reads as\nEn(z) =t (1) n E (1) n eik (1) z,n z + r(2)n E (2) n eik (2) z,n z\n+ t(3)n E (3) n eik (3) z,n z + r(4)n E (4) n eik (4) z,n z + Esne ikez, (10)\nwhere t(1)n (t (3) n ) denotes the amplitude of the forward wave E(1)n (E (3) n ), and r (2) n (r (4) n ) denotes the amplitude of the backward wave E(2)n (E (4) n ). Accordingly, the magnetic field can be expressed as\nHn(z) =t (1) n H (1) n eik (1) z,n z + r(2)n H (2) n eik (2) z,n z\n+ t(3)n H (3) n eik (3) z,n z + r(4)n H (4) n eik (4) z,n z + Hsne ikez, (11)\nwhere H(i)n = (\u03c9\u00b50)\u22121(kx, ky, k (i) z,n) T \u00d7 E(i)n and Hsn = (\u03c9\u00b50)\n\u22121(kx, ky, ke)T\u00d7Esn. Yet unknown, these mode amplitudes t\u2019s and r\u2019s can be resolved by matching boundary conditions at each interface, which will be discussed next.\nAs shown in Fig. 1(b), at the planar interface located at z = zn which separates the media \u03b5n and \u03b5n+1, the tangential components of En and Hn are respectively continuous, yielding a set of equations that can be expressed in a compact matrix form with respect to the mode coefficients t\u2019s and r\u2019s as\nDn,n+1 \u00b7 Pn,n+1 \u00b7 Cn,n+1 + fn = Dn+1,n \u00b7 Pn+1,n \u00b7 Cn+1,n + fn+1. (12)\nwhere\nDl,m =  x\u0302 \u00b7 E(1)l x\u0302 \u00b7 E (3) l \u2212x\u0302 \u00b7 E (2) m \u2212x\u0302 \u00b7 E (4) m y\u0302 \u00b7 E(1)l y\u0302 \u00b7 E (3) l \u2212y\u0302 \u00b7 E (2) m \u2212y\u0302 \u00b7 E (4) m x\u0302 \u00b7H(1)l x\u0302 \u00b7H (3) l \u2212x\u0302 \u00b7H (2) m \u2212x\u0302 \u00b7H (4) m\ny\u0302 \u00b7H(1)l y\u0302 \u00b7H (3) l \u2212y\u0302 \u00b7H (2) m \u2212y\u0302 \u00b7H (4) m\n , (13a)\nPl,m = diag(eik (1) z,l zn , eik (3) z,l zn , eik (2) z,mzn , eik (4) z,mzn ), (13b)\nCl,m = ( t(1)l , t (3) l , r (2) m , r (4) m )T , (13c)\nand fl = (x\u0302 \u00b7 Esl , y\u0302 \u00b7 E s l , x\u0302 \u00b7H s l , y\u0302 \u00b7H s l ) T eikezn (13d)\nwith l and m being n or n + 1; x\u0302 and y\u0302 being the unit vectors along the x- and y-directions, respectively. Evidently, the additional longitudinal wave caused by the swift electrons serving as the source enriches the transmission/reflection phenomena in such a structure with multiple layers. Although it is now possible to solve for the mode coefficients t\u2019s and r\u2019s in all layers, the linear system of equations grows large when the number of layers increases. To make large problems solvable, we intend to develop a matrix cascading technique."
        },
        {
            "heading": "C. Generalized cascading scattering matrix method",
            "text": "As described in literature [20, 22, 23], the transfer matrix method (TMM) and scattering matrix method (SMM) may be used for such multilayers under plane wave excitation, where the source terms f \u2019s in (12) disappear for intermediate layers. Here, we have extended the SMM to account for the presence of f \u2019s in an inhomogeneous scenario.\nWe can rewrite the boundary equation (12) in the context of scattering matrix, which reads\nCn+1,n = Sn,n+1 \u00b7 Cn,n+1 + Fn,n+1, (14)\nwhere the generalized scattering matrix Sn,n+1 and source matrix Fn,n+1 can be extracted from (12) :\nSn,n+1 = (Dn+1,n \u00b7 Pn+1,n)\u22121 \u00b7 (Dn,n+1 \u00b7 Pn,n+1) , (15a) Fn,n+1 = (Dn+1,n \u00b7 Pn+1,n)\u22121 \u00b7 ( fn \u2212 fn+1) . (15b)\nNow, having two successive systems denoted by Cm,l = Sl,m \u00b7 Cl,m + Fl,m and Cn,m = Sm,n \u00b7 Cm,n + Fm,n, one can readily cascade them and form a new system denoted by Cn,l = Sl,n \u00b7 Cl,n + Fl,n, where the elements of the cascading scattering matrix Sl,n and source vector Fl,n read as\nS11l,n = S 11 m,n \u00b7 \u03c71 \u00b7 S11l,m, (16a) S12l,n = S 12 m,n + S 11 m,n \u00b7 \u03c71 \u00b7 S12l,m \u00b7 S 22 m,n, (16b) S21l,n = S 21 l,m + S 22 l,m \u00b7 \u03c72 \u00b7 S 21 m,n \u00b7 S11l,m, (16c) S22l,n = S 22 l,m \u00b7 \u03c72 \u00b7 S 22 m,n, (16d) F1l,n = F 1 m,n + S 11 m,n \u00b7 \u03c71 \u00b7 (F1l,m + S 12 l,m \u00b7 F 2 m,n), (16e) F2l,n = F 2 l,m + S 22 l,m \u00b7 \u03c72 \u00b7 (F 2 m,n + S 21 m,n \u00b7 F1l,m). (16f)\nHere, \u03c71 = ( I\u2212 S12l,m \u00b7 S 21 m,n )\u22121 and \u03c72 = ( I\u2212 S21m,n \u00b7 S12l,m )\u22121 with I denoting a 2\u00d7 2 identity matrix; Sijl,m denotes the (i, j)-th 2\u00d7 2 block matrix of the 4\u00d7 4 Sl,m; Fil,m denotes the i-th 2\u00d7 1 sub-vector of Fl,m.\nFor a structure with multiple layers, we assume that the swift electron travels from layer 0 to layer N. Now, starting from S0,1, S1,2, S2,3, ..., SN\u22121,N and F0,1, F1,2, F2,3, ..., FN\u22121,N , and by successively cascading the adjacent scattering matrices according to (16), we can obtain S0,2, S0,3, S0,4, ... and F0,2, F0,3, F0,4, ..., and finally the overall scattering matrix S0,N and the inhomogeneous term F0,N . Thus, the overall backward reflection\ncoefficients r(2,4)0 = ( r(2)0 , r (4) 0 )T and forward transmission co-\nefficients t(1,3)N = ( t(1)N , t (3) N )T of the multilayered structure can readily be derived according to S0,N and F0,N , which reads ast(1,3)N r(2,4)0  = S110,N S120,N S210,N S 22 0,N t(1,3)0 r(2,4)N + F10,N F20,N\n , (17) where the transmission coefficients t(1,3)0 = ( t(1)0 , t (3) 0 )T in the entrance layer 0 are typically known and the reflection coeffi-\ncients r(2,4)N = ( r(2)N , r (4) N )T in the exit layer N are zero. Algorithm I illustrates the corresponding pseudo code. In addition, it is simple to obtain the mode coefficients for the intermediate layers [21].\nAlgorithm I. Calculation of radiation properties excited by the swift particle in multilayered structures.\nInput: Angles of interest: \u03b8, \u03c6; Frequency: \u03c9; Interface locations: zn; Layer permittivity: \u03b5n; # of interfaces: N. Output: Forward/backward mode coefficients t(1,3)N , r (2,4) 0 . 1: for m\u2190 1 : Nm do . Compute modes; Nm: # of media types 2: E(i)m , H (i) m , k (i) m \u2190 \u03b8, \u03c6, \u03c9, \u03b5m . With (6), (7) and (9). 3: for n\u2190 1 : N do . Form S-matrices at each interface 4: Sn\u22121,n, Fn\u22121,n \u2190 E (i) n\u22121, E (i) n , H (i) n\u22121, H (i) n , zn . With (15). 5: for n\u2190 2 : N do . Cascade S-matrices 6: S0,n, F0,n \u2190 S0,n\u22121, F0,n\u22121 . With (16) 7: return t(1)N , t (3) N , r (2) 0 , r (4) 0 . With (17)"
        },
        {
            "heading": "D. Angular spectral energy",
            "text": "Now, the forward (backward) angular spectral energy density of PC-based Cherenkov-like transition radiation, defined as the radiation energy W = \u222b V \u03b5E\n2dV per unit angular frequency \u03c9 per solid angle \u2126, reads U(\u03b8, \u03c6, \u03c9) = d3W/(d\u03c9d\u03b8d\u03c6). Here, the angles of interest \u03b8 and \u03c6 are related to the components of the \u201cwave vector\u201d k by kx = k0 sin \u03b8 cos \u03c6, ky = k0 sin \u03b8 sin \u03c6 where k0 is the wave number of free space (entrance medium). Thus, the forward and backward spectral energy densities respectively read as [12, 13]\nU f (\u03b8, \u03c6, \u03c9) = 1\n16\u03c03 \u2223\u2223\u2223t(1)N E(1)N + t(3)N E(3)N \u2223\u2223\u22232 \u00b7 \u03b5Nk2N sin 2\u03b8, (18a) Ub(\u03b8, \u03c6, \u03c9) =\n1 16\u03c03 \u2223\u2223\u2223r(2)0 E(2)0 + t(4)0 E(4)0 \u2223\u2223\u22232 \u00b7 \u03b50k20 sin 2\u03b8, (18b) where \u03b50 and \u03b5N represent the permittivity in the initial (entrance) and final (exit) media, respectively; k0 and kN denote the corresponding wave numbers. Using the elegant and powerful tool of generalized cascading scattering matrix method for swift electrons in multilayers, as illustrated in Algorithm I, one can now evaluate the forward (backward) radiation in the bottom (top) free space region of the multilayers according to U f (b)(\u03b8, \u03c6, \u03c9). Consequently, unique Cherenkov radiation detectors can be designed by configuring the geometry and material properties of multilayers in a sophisticated manner. Thus, a Swiss army knife is desired for both analysis and design."
        },
        {
            "heading": "E. Tandem-network-assisted analysis and design of multilayers",
            "text": "If we view the problem of forward analysis as the process of evaluating y = f (x), the inverse (design) problem x = f\u22121(y) is not straightforward as it may appear. Although optical responses such as transmission/reflection spectra and the Cherenkov-like radiation can be easily calculated for multilayer problems by analytical or numerical methods, the solution to the corresponding inverse problem may not exist. Such an inverse design in nanophotonics is typically a one-to-many problem, which makes it difficult to find a suitable solution x for a given desired response y. Consequently, intelligent algorithms have been widely utilized to solve inverse problems.\nFor the majority of intelligent algorithms, including genetic algorithms, particle swarm and ant colony optimization techniques and neural networks (NNs), solving the inverse problem frequently requires repeatedly evaluating the forward problems with varying designing parameter values. When the forward problems\u2019 analysis methods are inefficient, the inverse problems become computationally expensive. Although the proposed generalized cascading scattering matrix method is more efficient than traditional numerical methods for multilayers, a deep neural network can be designed and trained to approximate the exact electromagnetic simulation (see Algorithm I). Once the NN has been well trained, no further electromagnetic simulation is required; additionally, the NN is capable of predicting the electromagnetic response even if the designing parameters are not present in the training dataset, which is generated by using the proposed method (Algorithm I). Consequently, we can use the more efficient NN to make the forward simulation solvable despite large number of layers.\nAs for the corresponding inverse problem, one may consider adopting a similar structure of NN, with the desired electromagnetic properties as input and the designing parameters as output of the training dataset. Nevertheless, such a reverse NN\nfrequently fails due to the one-to-many mapping nature of its inverse design. Although it is possible to improve the NN by carefully selecting the training dataset, this has little effect on the convergence performance for large training datasets [32]. Consequently, variations of NN, such as Tandem networks[32, 37], variational auto-encoders (VAEs)[38], and generative adversarial networks (GANs) [39], are regarded as effective solutions. Fig. 2(a) illustrates a Tandem network composed of two cascaded fully-connected deep neural networks, one serving as the forward NN for the purpose of analysis and the other as the design NN. In constrast to the simple reverse NN, the error between the desired and designed electromagnetic responses, i.e., |y\u2212 y\u2032|, is used for the back propagation algorithm during the training process, ensuring that the mid-products of the Tandem network x\u2032 (the designed parameters) will produce a response that is nearly identical to the designed response as desired. In addition, the design object x\u2032 in the Tandem network is no longer restricted to be as similar to the actual x in the training dataset.\n(a) (b)\nPre-trained Net\nWe shall mention that only a portion of parameter space for the angular response is used to train the Tandem network, whereas the designed parameters can produce a spectrum that closely matches the desired one across the whole entire range of angles of interest. This is a result of the physics-informed nature of the designed NN. During the training processing of the Tandem network, only the weights of the network for the inverse design will be updated, while the pre-trained forward network will remain unchanged. Although the proposed analytical model can be used as the forward model in the Tandem network, we retain the pre-trained NN because it is computationally inexpensive."
        },
        {
            "heading": "3. RESULTS AND DISCUSSION",
            "text": ""
        },
        {
            "heading": "A. Benchmark validation",
            "text": "We have validated the proposed generalized cascading scattering matrix method for multilayers constituting of uniaxial crystals by examining the PC-based Cherenkov-like radiation and comparing the obtained results with the literature [12]. In the validation, the multilayered structure consists of an isotropic medium with \u03b51 = 10.6 and a uniaxial crystal \u03b52. For different filling ratios of the isotropic medium \u03b7 = d1/Lunit, where Lunit = d1 + d2 is the unit cell thickness with di (i = 1, 2) being the thickness of the medium \u03b5i, different types of Cherenkovlike transition radiation could exhibit when the other material property \u03b52 varies, as shown in Fig. 3.\nFig. 3(a) displays the angular spectral energy density of two types of Cherenkov-like transition radiation for different configurations of multilayers in unit cell thickness, filling ratios, and the cell material property. In the top panel, when the thickness of the unit cell is Lunit = 1.0205\u03bb0 and the filling ratio of \u03b51 is \u03b7 = 0.3, as the on-axis permittivity of the other uniaxial crystal \u03b52s varies from 1.0 to 4.0 while the off-axis permittivity is fixed at \u03b52p = 2.1, the detectable angle range of the Cherenkov-like transition radiation is increased from 7.48 \u00b0 to 12.9 \u00b0. Specifically, when the uniaxial crystal \u03b52 reduces to an isotropic medium, the calculated angular spectrum of forward radiation matches that presented in Ref. [12] for PCs. Similarly, strong backward Cherenkov-like transition radiation can occur when Lunit, \u03b7 and \u03b52 change, as depicted in the lower panel in Fig. 3(b).\nFig. 3(b) shows the so-called detection curve that corresponds to the peaks in Fig. 3(a) for various filling ratios of PCs constituting of isotropic media. As the filling ratio \u03b7 increases, the\nvelocity threshold of the Cherenkov-like transition radiation decreases and the observable angle grows. In contrast, the resolution, i.e., \u2206\u03b8/(\u2206v/c0), would decrease as \u03b7 is increasing; for example, it decreases from 575 at \u03b7 = 0.31 to 307 at \u03b7 = 0.38. When designing a PC-based Cherenkov radiation detector, a trade-off occurs between the particle velocity threshold (and range) and the detection accuracy."
        },
        {
            "heading": "B. Cherenkov-like radiation in multilayers comprised of uniaxial crystals with tilting optical axes",
            "text": "The Cherenkov-like radiation pattern depends on the proper configurations of the geometry and material properties; thus, by adding a new degree of freedom for the uniaxial-crystal-based PC design, i.e., the angle of the optical axis, it is possible to realize new types of Cherenkov-like radiation. Fig. 4 illustrates the Cherenkov-like resonant transition radiation in PCs that are made of alternating layers of a high-dielectric constant (isotropic) material and a uniaxial crystal with tilting optical axis. Actual dielectrics GaP and CaCO3 are used as the isotropic medium and uniaxial crystal, with relative permittivities \u03b51 = 10.6, \u03b52p = 2.749 and \u03b52s = 2.208 at the wavelength of interest \u03bb0 = 590 nm.\nFig. 4(a) plot the detection curves corresponding to the bright line in the angular spectral energy density when the optical axes of CaCO3 for the multilayers are titled by an angle \u03b2 with respect to z-axis. Now, the transform \u03b52 = \u039b\u22121(0, \u03b2, 0)diag(\u03b52p, \u03b52p, \u03b52s)\u039b(0, \u03b2, 0) is applied when calculating the optical properties of the GaP-CaCO3-made PCs, where \u039b(0, \u03b2, 0) denotes the coordinate rotation Euler matrix. It is evident that the maximum detectable velocity vmax decreases as the inclination angle \u03b2 decreases. Moreover, as the tilting angle increases, the detection curve becomes flatter, implying that greater velocity resolution can be achieved.\nAs shown in Fig. 4(b), when the optical axis of the uniaxial crystal is tilted, the PCs no longer have rotational symmetry, and directional radiation would appear in the horizontal planes normal to the electron trajectory. Intriguingly, with only a minor tilting angle \u03b2, the radiation acquires strong directionality. As the tilting angle increases, the corresponding half-power beamwidth (3dB angle) \u03a63dB decreases, indicating nearly improved orientation in the x direction. Meanwhile, the maximum detectable energy density U f ,max is significantly greater than that without tilting, indicating that Cherenkov-like radiation may be easier to observe in such a structure. Since the pitch and roll angles are zero for the Euler matrix \u039b(0, \u03b2, 0) in the simulation, the radiation patterns U f (\u03b8 \u03b2 max, \u03c6, \u03c90) are symmetric with respect to x-axis (viz., \u03c6 = 0)."
        },
        {
            "heading": "C. Tandem-network-assisted design of angular spectrum",
            "text": "By breaking the rotation symmetry of materials with respect to the direction of the charge trajectory, it may be possible to excert comprehensive control over the Cherenkov-like transition radiation in multilayers. However, it would add complexity to the design. Moreover, as mentioned previously, analyzing and designing multilayered structures per se such as PCs can be difficult. As shown in Fig. 3 and Fig. 4, similar electromagnetic properties exist for various configurations of geometry (e.g., unit cell thickness, filling ratio, periodicity, etc.) and materials (isotropic or anisotropic). Deep neural networks provide a promising solution to this problem in this paper. The parameters of the Tandem neural network are summarized in Table 1.\nThe objective of this paper is to design Cherenkov-like radiation based on PC, which constitutes of alternating layers of an\npatterns U f (\u03b8 = \u03b8 \u03b2 max, \u03c6, \u03c90) are normalized to the isotropic spectral density U f (\u03b8 \u03b2=0 max = 25.01 \u00b0, 0, \u03c90). In addition, the halfpower beamwidth (3dB angle) \u03a63dB is calculated. The electron velocity is v = 0.8420c0 and \u03c90 = 2\u03c0c0/\u03bb0.\na range of angle \u03b8, where only the data between \u03b8 \u2208 [18 \u00b0, 24 \u00b0] have been adopted. Here, the evenly sampled M = 20 data are represented by (xi = \u03b8i, yi = vi/c0) (i = 1, ..., M). The output of the overall Tandem network y\u2032 has the same physical meanings as the input y, which is the predicted (calculated) response for the designed parameter x\u2032 (i.e., the mid-products of the Tandem network). The designing parameters x\u2032 to be determined include the filling ratio \u03b7, the thickness of the unit cell Lunit, and tilting angle \u03b2 of the uniaxial crystal with respect to z-axis, i.e., x\u2032 = {\u03b7, Lunit, \u03b2}. Note that x\u2032 is the output of the inverse network and the input to the forward network. During the training, {x, y} is referred to as the training element; however, x becomes the designed parameters x\u2032 during the design process.\nThe deep learning framework PyTorch [41] is adopted. The training dataset was produced by uniformly sampling parameter tensor x = [\u03b7, Lunit, \u03b2] in the parameter space with \u03b7 \u2208 [0.68, 0.71], Lunit \u2208 [1.02, 1.06] and \u03b2 \u2208 [0 \u00b0, 60 \u00b0] and calculating the corresponding response tensor y using the proposed generalized scattering matrix method, as shown in Algorithm I. For the to-be-designed PC, the actual dielectrics GaP and CaCO3 are utilized, along with Nc = 4000 unit cells. 8000 data sets are divided into training, validation and test sets in a ratio of 3:1:1 during the training process for both the forward network and the Tandem network. In Table 1, the loss function and other meta-parameters for the Tandem network are listed.\nFig. 5(a) shows the validation error with respect to epochs, which is defined as the mean square error (MSE) between the expected and trained responses, i.e., error = MSE(y, y\u2032). For the forward network, the error for the validation dataset quickly converges to the order of 10\u22127 at after about 80 training epochs, indicating that it is capable of predicting the angular spectrum (response, y) according to the geometry and material parameters (x) rather than the conventional electromagnetic simulation methods. Moreover, the validation error converges for the Tandem networks, suggesting that the one-to-many design problem can also be effectively addressed.\nFig. 5(b) compares the designed angular spectrum to the desired response. We have obtained x\u2032 = (0.7064, 1.0577, 46.5060 \u00b0) from the inverse network within a subset of parameter space used to train the Tandem network (see the inset in Fig. 5); meanwhile, it yields nearly the same spectrum (circle) as the desired one (dashed curves) over the entire angle ranges of interest, which is calculated according to Algorithm I. We notice that\nby only learning the local features, NNs can imitate the physical information hidden beneath a large dataset. In addition, the physical information contained in the model (i.e., the pretrained forward network) provides crucial foundations for the final convergence of the entire network, which are unavailable by traditional data-driven neural networks."
        },
        {
            "heading": "4. CONCLUSION",
            "text": "In summary, we have proposed a general cascading scattering matrix method for calculating the electromagnetic properties induced by a moving charge traversing planar multilayered structures, which can be comprised of uniaxial crystals with tilted optical axes. In the external vacuum of photonic crystals with the proper configurations, Cherenkov-like resonant transition radiation can be observed, whose energy distribution can be used to detect particles\u2019 velocity. Incorporating uniaxial crystals and appropriately adjusting their optical axes enable the external radiation to be strongly directional in the plane normal to the electron trajectory, thereby introducing a new degree of freedom when designing PC-based Cherenkov detectors. Furthermore, PCs with a tilting optical axis can attain a higher resolution of velocity. In addition, with the help of Tandem networks, we are able to design PCs according to the desired detection curve, which demonstrates a significant improvement over conventional inverse neural networks by considering local sampling of training data and incorporating errors for both the design parameters and the response. We anticipate that the proposed Swiss army knives will benefit other PC applications in nanophotonics community.\nFunding. National Natural Science Foundation of China (51977165).\nDisclosures. The authors declare no conflicts of interest.\nData availability. Data underlying the results presented in this paper may be obtained from the authors upon reasonable request."
        }
    ],
    "title": "Analysis and design of transition radiation in layered uniaxial crystals using Tandem neural networks",
    "year": 2022
}