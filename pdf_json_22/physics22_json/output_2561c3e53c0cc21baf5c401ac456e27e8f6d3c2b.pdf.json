{
    "abstractText": "We consider large-scale dynamics of non-equilibrium dense soliton gas for the Korteweg\u2013de Vries (KdV) equation in the special \u201ccondensate\u201d limit. We prove that in this limit the integro-differential kinetic equation for the spectral density of states reduces to the N -phaseKdV\u2013Whithammodulation equations derived byFlaschka et al. (Commun Pure Appl Math 33(6):739\u2013784, 1980) and Lax and Levermore (Commun Pure Appl Math 36(5):571\u2013593, 1983). We consider Riemann problems for soliton condensates and construct explicit solutions of the kinetic equation describing generalized rarefaction and dispersive shock waves. We then present numerical results for \u201cdiluted\u201d soliton condensates exhibiting rich incoherent behaviors associated with integrable turbulence.",
    "authors": [
        {
            "affiliations": [],
            "name": "T. Congy"
        },
        {
            "affiliations": [],
            "name": "G. Roberti"
        },
        {
            "affiliations": [],
            "name": "A. Tovbis"
        }
    ],
    "id": "SP:c8a0cef91e724c9eb363e8c9dd26e548327ce33b",
    "references": [
        {
            "authors": [
                "Press",
                "D. Cambridge (2011) Agafontsev",
                "V. Zakharov"
            ],
            "title": "Integrable turbulence and formation of rogue waves. Nonlinearity",
            "year": 2011
        },
        {
            "authors": [
                "D. Agafontsev",
                "S. Randoux",
                "P. Suret"
            ],
            "title": "Extreme rogue wave generation from narrowband partially coherent",
            "year": 2015
        },
        {
            "authors": [
                "E.D. Belokolos",
                "A.I. Bobenko",
                "V.Z. Enolski",
                "A.R. Its",
                "V.B. Matveev"
            ],
            "title": "Algebro-geometric Approach",
            "venue": "waves. Phys. Rev. E",
            "year": 2021
        },
        {
            "authors": [
                "M. Bertola",
                "T. Grava",
                "G. Orsatti"
            ],
            "title": "Nonlinear Integrable Equations",
            "year": 1994
        },
        {
            "authors": [
                "Rev. Lett"
            ],
            "title": "The Whitham approach to the c \u2192 0 limit of the Lieb-Liniger model and generalized",
            "year": 2023
        },
        {
            "authors": [
                "T. Bonnemain",
                "B. Doyon",
                "G. El"
            ],
            "title": "Generalized hydrodynamics of the KdV soliton gas",
            "venue": "hydrodynamics. J. Phys. A: Math. Theor",
            "year": 2020
        },
        {
            "authors": [
                "P.F. Byrd",
                "M.D. Friedman"
            ],
            "title": "Handbook of Elliptic Integrals for Engineers and Physicists",
            "year": 2022
        },
        {
            "authors": [
                "F. Carbone",
                "D. Dutykh",
                "G.A. El"
            ],
            "title": "Macroscopic dynamics of incoherent soliton ensembles: Soliton gas",
            "year": 1954
        },
        {
            "authors": [
                "T. Congy",
                "G. El",
                "G. Roberti"
            ],
            "title": "Soliton gas in bidirectional dispersive hydrodynamics",
            "venue": "Phys. Rev. E 103(4),",
            "year": 2016
        },
        {
            "authors": [
                "B. Doyon"
            ],
            "title": "Lecture notes on Generalised Hydrodynamics",
            "venue": "SciPost Physics Lecture Notes,",
            "year": 2020
        },
        {
            "authors": [
                "P. Drazin",
                "R. Johnson"
            ],
            "title": "Solitons: An Introduction, 2nd edn",
            "year": 1989
        },
        {
            "authors": [
                "D. Zakharov",
                "V. Zakharov"
            ],
            "title": "Primitive potentials and bounded solutions of theKdV equation",
            "venue": "Hamiltonian theory. Russ. Math. Surv",
            "year": 1989
        },
        {
            "authors": [
                "G.A. El"
            ],
            "title": "Soliton gas in integrable dispersive hydrodynamics",
            "venue": "Physica D",
            "year": 2041
        },
        {
            "authors": [
                "G. El",
                "A. Tovbis"
            ],
            "title": "Spectral theory of soliton and breather gases for the focusing nonlinear Schr\u00f6dinger",
            "year": 2005
        },
        {
            "authors": [
                "G.A. El",
                "A.L. Krylov",
                "S. Venakides"
            ],
            "title": "Unified approach to KdV modulations",
            "venue": "equation. Phys. Rev. E",
            "year": 2020
        },
        {
            "authors": [
                "G.A. El",
                "A.M. Kamchatnov",
                "M.V. Pavlov",
                "S.A. Zykov"
            ],
            "title": "Kinetic equation for a soliton gas and its hydro",
            "year": 2001
        },
        {
            "authors": [
                "E.V. Ferapontov",
                "M.V. Pavlov"
            ],
            "title": "Kinetic equation for soliton gas: integrable reductions",
            "venue": "J. Nonlinear Sci",
            "year": 2011
        },
        {
            "authors": [
                "S. Gavrilyuk",
                "B. Nkonga",
                "K.M. Shyue",
                "L. Truskinovsky"
            ],
            "title": "Stationary shock-like transition fronts",
            "venue": "Korteweg\u2013de Vries equation. Commun. Pure Appl. Math. 33(6),",
            "year": 1980
        },
        {
            "authors": [
                "A. Gelash",
                "D. Agafontsev",
                "V. Zakharov",
                "G. El",
                "S. Randoux",
                "P. Suret"
            ],
            "title": "Bound state soliton gas dynamics",
            "year": 2018
        },
        {
            "authors": [
                "A. Gelash",
                "D. Agafontsev",
                "P. Suret",
                "S. Randoux"
            ],
            "title": "Solitonic model of the condensate",
            "venue": "underlying the spontaneous modulational instability. Phys. Rev. Lett. 123(23),",
            "year": 2019
        },
        {
            "authors": [
                "M. Girotti",
                "T. Grava",
                "McLaughlin"
            ],
            "title": "K.D.T.-R.: Rigorous asymptotics of a KdV soliton gas. Commun.Math",
            "year": 2023
        },
        {
            "authors": [
                "I.S. Gradshteyn",
                "I.M. Ryzhik"
            ],
            "title": "Tables of integrals, series, and products, 7th edn. Academic Press (2007) Grava, T., Tian, F.-R.: The generation, propagation, and extinction ofmultiphases in theKdVzero-dispersion",
            "year": 2007
        },
        {
            "authors": [
                "Teor. Fiz"
            ],
            "title": "Statistical limit in a completely integrable system",
            "year": 1973
        },
        {
            "authors": [
                "A. Kuijlaars",
                "A. Tovbis"
            ],
            "title": "On minimal energy solutions to certain classes of integral equations related",
            "year": 2000
        },
        {
            "authors": [
                "P.D. Lax"
            ],
            "title": "soliton gases for integrable systems. Nonlinearity",
            "year": 2021
        },
        {
            "authors": [
                "P.D. Lax",
                "C.D. Levermore"
            ],
            "title": "The small dispersion limit of the Korteweg\u2013de Vries equation: 2",
            "year": 1973
        },
        {
            "authors": [
                "S.P. Novikov",
                "S. Manakov",
                "L.P. Pitaevskii",
                "V. Zakharov"
            ],
            "title": "Theory of Solitons: The Inverse Scattering",
            "venue": "Physica D",
            "year": 2020
        },
        {
            "authors": [
                "S. Okada",
                "D. Elliot"
            ],
            "title": "The finite Hilbert transform",
            "year": 1984
        },
        {
            "authors": [
                "M.V. Pavlov",
                "V.B. Taranov",
                "G.A. El"
            ],
            "title": "Generalized hydrodynamic reductions of the kinetic equation for a soliton gas",
            "venue": "Theor. Math. Phys. 171(2),",
            "year": 2012
        },
        {
            "authors": [
                "E. Pelinovsky",
                "E. Shurgalina"
            ],
            "title": "KDV soliton gas: interactions and turbulence. In: Advances in Dynamics, Patterns, Cognition, pp. 295\u2013306",
            "year": 2017
        },
        {
            "authors": [
                "G. Roberti",
                "G. El",
                "A. Tovbis",
                "F. Copie",
                "P. Suret",
                "S. Randoux"
            ],
            "title": "Numerical spectral synthesis of breather",
            "venue": "equation. Commun. Nonlin. Sci. Numer. Simul",
            "year": 2021
        },
        {
            "authors": [
                "J. Smoller"
            ],
            "title": "Shock Waves and Reaction\u2013Diffusion Equations",
            "year": 1994
        },
        {
            "authors": [
                "A. Tovbis",
                "F. Wang"
            ],
            "title": "dispersion limits of traveling waves. Nonlinearity",
            "year": 2020
        },
        {
            "authors": [
                "F. Tricomi"
            ],
            "title": "On the finite Hilbert transformation",
            "venue": "gases. J. Phys. A: Math. Theor",
            "year": 1951
        },
        {
            "authors": [
                "S. Venakides"
            ],
            "title": "The continuum limit of theta functions",
            "venue": "method. Math. USSR-Izvestiya",
            "year": 1989
        },
        {
            "authors": [
                "V.E. Zakharov",
                "Zh. Eksp. Teor. Fiz"
            ],
            "title": "Zakharov, V.E.: Turbulence in integrable systems",
            "venue": "(March,",
            "year": 1971
        }
    ],
    "sections": [
        {
            "text": "Keywords Soliton gas \u00b7 Kinetic equation \u00b7 Integrability \u00b7 Korteweg-de Vries equation \u00b7 Whitham modulation equations Mathematics Subject Classification 35Q53 \u00b7 37K40 \u00b7 35L60"
        },
        {
            "heading": "1 Introduction",
            "text": "Solitons represent the fundamental localized solutions of integrable nonlinear dispersive equations such as the Korteweg\u2013de Vries (KdV), nonlinear Schr\u00f6dinger (NLS), sine-Gordon, Benjamin\u2013Ono and other equations. Alongwith the remarkable localization properties, solitons exhibit particle-like elastic pairwise collisions accompanied by definite phase/position shifts. A comprehensive description of solitons and their\nCommunicated by Paul Newton.\nB T. Congy thibault.congy@northumbria.ac.uk\n1 Department of Mathematics, Physics and Electrical Engineering, Northumbria University, Newcastle upon Tyne NE1 8ST, United Kingdom\n2 Department of Mathematics, University of Central Florida, Orlando, Florida 32816, USA\ninteractions is achieved within the inverse scattering transform (IST) method framework, where each soliton is characterized by a certain spectral parameter related to the soliton\u2019s amplitude, and the phase related to its position (for the sake of definiteness, we refer here to the properties of KdV solitons). Generally, integrable equations support N -soliton solutions, which can be viewed as nonlinear superpositions of N solitons. Within the IST framework, N -soliton solution is characterized by a finite set of spectral and phase parameters completely determined by the initial conditions for the integrable PDE.\nThe particle-like properties of solitons suggest some natural questions pertaining to the realm of statistical mechanics, e.g. one can consider a soliton gas as an infinite ensemble of interacting solitons characterized by random spectral (amplitude) and phase distributions. The key question is to understand the emergent macroscopic dynamics (i.e. hydrodynamics or kinetics) of soliton gas given the properties of the elementary, \u201cmicroscopic\u201d, two-soliton interactions. It is clear that due to the presence of an infinite number of conserved quantities and the lack of thermalization in integrable systems the properties of soliton gases will be very different compared to the properties of classical gases whose particle interactions are non-elastic. Invoking the wave aspect of the soliton\u2019s dual identity, soliton gas can be viewed as a prominent example of integrable turbulence (Zakharov 2009). The pertinent questions arising in this connection are related to the determination of the parameters of the random nonlinear wave field in the soliton gas such as probability density function, autocorrelation function, power spectrum, etc.\nThe IST-based phenomenological construction of a rarefied, or diluted, gas of KdV solitonswas proposed in 1971 byZakharov (1971)who has formulated an approximate spectral kinetic equation for such a gas based on the properties of soliton collisions: the conservation of the soliton spectrum (isospectrality) and the accumulation of phase shifts in pairwise collisions that results in the modification of an effective average soliton\u2019s velocity in the gas. Zakharov\u2019s spectral kinetic equation was generalized in El (2003) to the case of a dense gas using the finite gap theory and the thermodynamic, infinite-genus, limit of theKdV\u2013Whithammodulation equations (Flaschka et al. 1980). The results of El (2003) were used in El and Kamchatnov (2005) for the formulation of a phenomenological construction of kinetic equations for dense soliton gases for integrable systems describing both unidirectional and bidirectional soliton propagation and including the focusing, defocusing and resonant NLS equations, as well as the Kaup\u2013Boussinesq system for shallow-water waves (Congy et al. 2021). The detailed spectral theory of soliton and breather gases for the focusing NLS equation has been developed in El and Tovbis (2020).\nThe spectral kinetic equation for a dense soliton gas represents a nonlinear integrodifferential equation describing the evolution of the density of states (DOS)\u2014the density function u(\u03b7; x, t) in the phase space (\u03b7, x) \u2208 + \u00d7 R, where \u03b7 \u2208 + is the spectral parameter in the Lax pair associated with the nonlinear integrable PDE,\nut + (us)x = 0, s(\u03b7; x, t) = s0(\u03b7) + \u222b + G(\u03b7, \u03bc)u(\u03bc; x, t)[s(\u03b7; x, t) \u2212 s(\u03bc; x, t)]d\u03bc. (1.1)\nHere s0(\u03b7) is the velocity of a \u201cfree\u201d soliton, and the integral term in the second equation represents the effective modification of the soliton velocity in the gas due to pairwise soliton collisions that are accompanied by the phase-shifts described by the kernel G(\u03b7, \u03bc). Both s0(\u03b7) and G(\u03b7, \u03bc) are system-specific. In particular, for\nKdV s0(\u03b7) = 4\u03b72 and G(\u03b7, \u03bc) = 1\u03b7 ln \u2223\u2223\u2223\u03bc+\u03b7\u03bc\u2212\u03b7 \u2223\u2223\u2223. The spectral support + of the DOS is determined by initial conditions. We note that, while + \u2282 R+ for the KdV equation, one can have + \u2282 C+ for other equations, e.g. the focusing NLS equation, see (El and Tovbis 2020). Equation (1.1) describes the DOS evolution in a dense soliton gas and represents a broad generalization of Zakharov\u2019s kinetic equation for rarefied gas (Zakharov 1971). The existence, uniqueness and properties of solutions to the \u201cequation of state\u201d (the integral equation in (1.1) for fixed (x, t) for the focusing NLS and KdV equations were studied in Kuijlaars and Tovbis (2021).\nThe original spectral theory of the KdV soliton gas (El 2003) has been developed under the assumption that the spectral support + of the DOS is a fixed, simplyconnected interval of R+; without loss of generality, one can assume + = [0, 1]. In El and Tovbis (2020), Kuijlaars and Tovbis (2021), this restriction has been removed by allowing the spectral support + to be a union of N + 1 disjoint intervals \u03b3 j = [\u03bb2 j\u22121, \u03bb2 j ], termed here s-bands: + = \u222aNj=0\u03b3 j , (\u03b3i \u2229 \u03b3 j = \u2205, i = j). In this paper, we introduce a further generalization of the existing theory by allowing the endpoints \u03bb j of the s-bands be functions of x, t . We show that this generalization has profound implications for soliton gas dynamics; in particular, the kinetic equation implies certain nonlinear evolution of the endpoints \u03bb j (x, t) of the s-bands. We determine this evolution for a special type of soliton gases, termed in El and Tovbis (2020) soliton condensates. Soliton condensate represents the \u201cdensest possible\u201d gas whose DOS is uniquely defined by a given spectral support +. The number N of disjoint s-bands in + determines the genus g = N\u22121 of the soliton condensate.We show that the evolution of\u03bb j \u2019s in a soliton condensate is governed by the g-phase-averagedKdV\u2013 Whithammodulation equations (Flaschka et al. 1980), also derived in the context of the semi-classical, zero-dispersion limit of the KdV equation (Lax and Levermore 1983).\nWe then consider the soliton condensate dynamics arising in the Riemann problem initiated by a rapid jump in the DOS. Our results suggest that in the condensate limit theKdVdynamics of soliton gas is almost everywhere equivalent to the (deterministic) generalized rarefaction waves (RWs) and generalized dispersive shock waves (DSWs) of the KdV equation. We prove this statement for the genus 0 case and present a strong numerical evidence for genus 1. Our results also suggest direct connection of the \u201cdeterministic KdV soliton gases\u201d constructed in the recent paper (Girotti et al. 2021) with modulated soliton condensates.\nOur work puts classical results of integrable dispersive hydrodynamics (Flaschka et al. 1980; Lax and Levermore 1983; Gurevich and Pitaevskii 1974) in a broader context of the soliton gas theory. Namely, we show that the KdV\u2013Whitham modulation equations describe the emergent hydrodynamic motion of a special soliton gas\u2014a condensate\u2014resulting from the accumulated effect of \u201cmicroscopic\u201d two-soliton interactions. This new interpretation of the Whitham equations is particularly pertinent in the context of generalized hydrodynamics, the emergent hydrodynamics of quantum and classical many-body systems (Doyon 2020). The direct connection between the\nkinetic theory of KdV soliton gas and generalized hydrodynamics was established recently in (see also Bettelheim 2020 where the Whitham equations for the defocusing NLS equation were shown to arise in the semi-classical limit of the generalized hydrodynamics of the quantum Lieb\u2013Liniger model).\nOur work also paves the way to a major extension of the existing dispersive hydrodynamic theory by including the random aspect of soliton gases. To this end, we consider \u201cdiluted\u201d soliton condensates whose DOS has the same spectral distribution as in genuine condensates but allows for a wider spacing between solitons giving rise to rich incoherent dynamics associated with \u201cintegrable turbulence\u201d (Zakharov 2009). In particular, we show numerically that evolution of initial discontinuities in diluted soliton condensates results in the development of incoherent oscillating rarefaction and dispersive shock waves.\nAn important aspect of our work is the numerical modeling of soliton condensates using n-soliton KdV solutions with large n, configured according to the condensate DOS. The challenges of the numerical implementation of standard n-soliton formulae for sufficiently large n due to rapid accumulation of roundoff errors are known very well. Here we use the efficient algorithm developed in Huang (1992), which relies on the Darboux transformation. We improve this algorithm following the recent methodology developed in Gelash and Agafontsev (2018) for the focusing NLS equation with the implementation of high-precision arithmetic routine. Our numerical simulations show excellent agreement with analytical predictions for the solutions of soliton condensate Riemann problems and provide a strong support to the basic conjecture about the connection of KdV soliton condensates with finite-gap potentials.\nIt should be noted that soliton condensates have been recently studied for the focusing NLS equation, where they represent incoherent wave fields exhibiting distinct statistical properties. In particular, itwas shown inGelash et al. (2019) that the so-called bound state soliton condensate dynamics underlies the long-term behavior of spontaneous modulational instability, the fundamental physical phenomenon that gives rise to the statistically stationary integrable turbulence (Agafontsev and Zakharov 2015; Agafontsev et al. 2021).\nThe paper is organized as follows: in Sect. 2, we present a brief outline of the spectral theory of soliton gas for the KdV equation and introduce the notion of soliton condensate for the simplest genus 0 case. In Sect. 3, following Kuijlaars and Tovbis (2021), we generalize the spectral definition of soliton condensate to an arbitrary genus case and prove the main Theorem 3.2 connecting spectral dynamics of nonuniform soliton condensates with multiphase Whitham modulation theory (Flaschka et al. 1980) describing slowdeformations of the spectrumof periodic and quasiperiodic KdV solutions. Section3 is concerned with properties of KdV solutions corresponding to the condensate spectral DOS, i.e. the soliton condensate realizations. We formulate Conjecture 4.1 that any realization of an equilibrium soliton condensate almost surely coincides with a finite-gap potential defined on the condensate\u2019s hyperelliptic spectral curve. This proposition is proved for genus 0 condensates, and a strong numerical evidence is provided for genus 1 and 2. In Sect. 5, we construct solutions to Riemann problems for the soliton gas kinetic equation subject to discontinuous condensate initial data. These solutions describe evolution of generalized rarefaction and\ndispersive shock waves. In Sect. 6, we present numerical simulations of the Riemann problem for the KdV soliton condensates and compare them with analytical solutions from Sect. 5. Finally, in Sect. 7 we consider basic properties of \u201cdiluted\u201d condensates having a scaled condensate DOS and exhibiting rich incoherent behaviors. In particular, we present numerical solutions to Riemann problems for such diluted condensates. Appendix A contains details of the numerical implementation of dense soliton gases. In Appendix B, we present results of the numerical realization of the genus 2 soliton condensate and its comparison with two-phase solution of the KdV equation."
        },
        {
            "heading": "2 Spectral Theory of KdV Soliton Gas: Summary of Results",
            "text": "Here we present an outline of the spectral theory of KdV soliton gas developed in El (2003, 2021). We consider the KdV equation in the form\n\u03d5t + 6\u03d5\u03d5x + \u03d5xxx = 0. (2.1) The inverse scattering theory associates soliton of the KdV equation (2.1) with a point z = z1 = \u2212\u03b721, \u03b71 > 0 of the discrete spectrum of the Lax operator\nL = \u2212\u22022xx \u2212 \u03d5(x, t), (2.2) with sufficiently rapidly decaying potential \u03d5(x, t): \u03d5(x, t) \u2192 0 as |x | \u2192 \u221e. The corresponding KdV soliton solution is given by:\n\u03d5s(x, t; \u03b71) = 2\u03b721sech2[\u03b71(x \u2212 4\u03b721t \u2212 x01 )], (2.3) where the soliton amplitude a1 = 2\u03b721, the speed s1 = 4\u03b721, and x01 is the initial position or \u201cphase\u201d. Along with the simplest single-soliton solution (2.3), the KdV equation supports n-soliton solutions \u03d5n(x, t) characterized by n discrete spectral parameters 0 < \u03b71 < \u03b72 < \u00b7 \u00b7 \u00b7 < \u03b7n and the set of initial positions {x0i |i = 1, . . . , n} associated with the phases of the so-called norming constants (Novikov et al. 1984). It is also known that n-soliton solutions can be realized as special limits of more general n-gap solutions, whose Lax spectrum Sn consists of n finite and one semi-infinite bands separated by n gaps (Novikov et al. 1984; Belokolos et al. 1994),\nz \u2208 Sn = [\u03b61, \u03b62] \u222a [\u03b63, \u03b64] \u222a \u00b7 \u00b7 \u00b7 \u222a [\u03b62n+1,\u221e). (2.4) The n-gap solution of the KdV equation (2.1) represents a multiphase quasiperiodic function\n\u03d5(x, t) = Fn(\u03b81, \u03b82, . . . , \u03b8n), \u03b8 j = k j x \u2212 \u03c9 j t + \u03b80j , Fn(. . . , \u03b8 j + 2\u03c0, . . . ) = Fn(. . . , \u03b8 j , . . . ),\n(2.5)\nwhere k j and \u03c9 j are the wavenumber and frequency associated with the j-th phase \u03b8 j , and \u03b80j are the initial phases. Details on the explicit representation of the solution (2.5) in terms of Riemann theta-functions can be found in classical papers and monographs on finite-gap theory, see (Matveev 2008; Belokolos et al. 1994) and references therein.\nThe n-phase (n-gap) KdV solution (2.5) is parametrized by 2n + 1 endpoints {\u03b6 j }2n+1j=1 of the spectral bands. The nonlinear dispersion relations (NDRs) for finite gap potentials can be represented in the general form, see (Flaschka et al. 1980) for the concrete expressions,\nk j = K j (\u03b61, . . . , \u03b62n+1), \u03c9 j = j (\u03b61, . . . , \u03b62n+1), j = 1, . . . , n, (2.6)\nand connect the wavenumber-frequency set {k j , \u03c9 j }nj=1 of (2.5) with the spectral set Sn (2.4). These are complemented by the relation \u3008\u03d5\u3009 = (\u03b61, . . . , \u03b62n+1), where \u3008\u03d5\u3009 = \u222b Fnd\u03b81 . . . d\u03b8n is the mean obtained by averaging of Fn over the phase n-torus T n = [0, 2\u03c0)\u00d7\u00b7 \u00b7 \u00b7\u00d7 [0, 2\u03c0), assuming respective non-commensurability of k j \u2019s and \u03c9 j \u2019s and, consequently, ergodicity of the KdV flow on the torus. The n-soliton limit of an n-gap solution is achieved by collapsing all the finite bands [\u03b62 j\u22121, \u03b62 j ] into double points corresponding to the soliton discrete spectral values, \u03b62 j \u2212 \u03b62 j\u22121 \u2192 0, \u03b62 j , \u03b62 j\u22121 \u2192 \u2212\u03b72j , j = 1, . . . , n. (2.7)\nIt was proposed in El (2003) that the special infinite-soliton limit of the spectral n-gap KdV solutions, termed the thermodynamic limit, provides spectral description the KdV soliton gas. The thermodynamic limit is achieved by assuming a special band-gap distribution (scaling) of the spectral set Sn for n \u2192 \u221e on a fixed interval [\u03b61, \u03b62n+1] (e.g. [\u22121, 0]). Specifically, we set the spectral bands to be exponentially narrow compared to the gaps so that Sn is asymptotically characterized by two smooth positive functions on some fixed interval + \u2282 R+: the density \u03c6(\u03b7) of the lattice points \u03b7 j \u2208 + defining the band centers via \u2212\u03b72j = (\u03b62 j + \u03b62 j\u22121)/2, and the scaled logarithmic bandwidth distribution \u03c4(\u03b7) defined for n \u2192 \u221e by\n\u03b7 j \u2212 \u03b7 j+1 \u223c 1 n\u03c6(\u03b7 j ) , \u03c4 (\u03b7 j ) \u223c \u22121 n ln(\u03b62 j \u2212 \u03b62 j\u22121), (2.8)\nwhere \u03c6(\u03b7), \u03c4(\u03b7) are O(1). The spectral scaling (2.8) was originally introduced by Venakides (1989) in the context of the continuum limit of theta functions.\nWe complement the spectral distributions (2.8) with the uniform distribution of the initial phase vector \u03b80 on the torus Tn and say that the resulting random finite gap solution \u03d5(x, t) approximates soliton gas as n \u2192 \u221e. An important consequence of this definition of soliton gas is ergodicity, implying that spatial averages of the KdV field in a soliton gas are equivalent to the ensemble averages, i.e. the averages over Tn in the thermodynamic limit n \u2192 \u221e. We shall use the notation \u3008F[\u03d5]\u3009 for ensemble averages and F[\u03d5] for spatial averages.\nFrom now on, we shall refer to \u03b7 > 0 as the spectral parameter and +\u2013the spectral support. The DOS u(\u03b7) of a spatially homogeneous (equilibrium) soliton gas is phenomenologically introduced in such a way that u(\u03b70)d\u03b7dx gives the number of solitonswith the spectral parameter\u03b7 \u2208 [\u03b70, \u03b70+d\u03b7] contained in the portion of soliton gas over a macroscopic (i.e. containing sufficiently many solitons) spatial interval x \u2208 [x0, x0+dx] \u2282 R for any x0 (the individual solitons can be counted by cutting out the relevant portion of the gas and letting them separate with time). The corresponding spectral fluxdensityv(\u03b7) represents the temporal counterpart of theDOS, i.e. |v(\u03b70)|d\u03b7\nis the number of solitons with the spectral parameter \u03b7 \u2208 [\u03b70, \u03b70 + d\u03b7] crossing any given point x = x0 per unit interval of time; note that, even if the velocity of an \u201cisolated\u201d KdV soliton is always positive, the flux density v(\u03b7) in the KdV soliton gas can be negative, see e.g. Remark 2.1. These definitions are physically suggestive in the context of rarefied soliton gas where solitons are identifiable as individual localized wave structures. The general mathematical definitions of u(\u03b7) and v(\u03b7) applicable to dense soliton gases are introduced by applying the thermodynamic limit to the finite-gap NDRs (2.6), leading to the integral equations (El 2003, 2021):\n\u222b + ln \u2223\u2223\u2223\u2223\u03bc + \u03b7\u03bc \u2212 \u03b7 \u2223\u2223\u2223\u2223 u(\u03bc)d\u03bc + u(\u03b7)\u03c3 (\u03b7) = \u03b7, (2.9)\u222b\n+ ln \u2223\u2223\u2223\u2223\u03bc + \u03b7\u03bc \u2212 \u03b7 \u2223\u2223\u2223\u2223 v(\u03bc)d\u03bc + v(\u03b7)\u03c3 (\u03b7) = 4\u03b73, (2.10)\nfor all \u03b7 \u2208 +. Here the spectral scaling function \u03c3 : + \u2192 [0,\u221e) is a continuous non-negative function that encodes the Lax spectrum of soliton gas via \u03c3(\u03b7) = \u03c6(\u03b7)/\u03c4(\u03b7). Equations (2.9), (2.10) represent the soliton gas NDRs.\nEliminating \u03c3(\u03b7) = 0 from the NDRs (2.9), (2.10) yields the equation of state for KdV soliton gas:\ns(\u03b7) = 4\u03b72 + 1 \u03b7 \u222b + ln \u2223\u2223\u2223\u2223\u03b7 + \u03bc\u03b7 \u2212 \u03bc \u2223\u2223\u2223\u2223 u(\u03bc)[s(\u03b7) \u2212 s(\u03bc)]d\u03bc, (2.11)\nwhere s(\u03b7) = v(\u03b7)/u(\u03b7) can be interpreted as the velocity of a tracer soliton in the gas. It was shown in El (2003) that for a weakly non-uniform (non-equilibrium) soliton gas, for which u(\u03b7) \u2261 u(\u03b7; x, t), s(\u03b7) \u2261 s(\u03b7; x, t), the DOS satisfies the continuity equation\nut + (us)x = 0, (2.12)\nso that s(\u03b7; x, t) acquires the natural meaning of the transport velocity in the soliton gas. Equations (2.11), (2.12) form the spectral kinetic equation for soliton gas. One should note that the typical scales of spatiotemporal variations in the kinetic equation (2.12) are much larger than in the KdV equation (2.1), i.e. the kinetic equation describes macroscopic evolution, or hydrodynamics, of soliton gases.\nLet the spectral support + be fixed. Then, differentiating equation (2.9) with respect to t , equation (2.10) with respect to x , and using the continuity equation (2.12), we obtain the evolution equation for the spectral scaling function\n\u03c3t + s\u03c3x = 0, (2.13)\nwhich shows that \u03c3(\u03b7; x, t) plays the role of the Riemann invariant for the spectral kinetic equation.\nFinally, the ensemble averages of the conserved densities of the KdV wave field in the soliton gas (the Kruskal integrals) are evaluated in terms of the DOS as \u3008Pn[\u03d5]\u3009 = Cn \u222b + \u03b7 2n\u22121u(\u03b7)d\u03b7, wherePn[\u03d5], n = 1, 2, . . . are conserved quantities of the KdV\nequation and Cn constants (El 2003, 2021) (see also Tovbis and Wang (2022) for rigorous derivation in the NLS context). In particular, for the two first moments we have, on dropping the x, t-dependence (El 2003, 2021),\n\u3008\u03d5\u3009 = 4 \u222b\n+ \u03b7 u(\u03b7)d\u03b7, \u3008\u03d52\u3009 = 16 3 \u222b + \u03b73 u(\u03b7)d\u03b7. (2.14)\nWe note that in the original works on KdV soliton gas it was assumed (explicitly or implicitly) that the spectral support + of the KdV soliton gas is a fixed, simply connected interval (without loss of generality one can assume that in this case + = [0, 1]). In what follows we will be considering a more general configuration where + represents a union of N + 1 disjoint intervals, N = 0, 1, . . . . In addition, we will allow the endpoints of these intervals to be functions of x, t .\nA special kind of soliton gas, termed soliton condensate, is realized spectrally by letting \u03c3 \u2192 0 in the NDRs (2.9), (2.10). This limit was first considered in El and Tovbis (2020) for the soliton gas in the focusing NLS equation and then in Kuijlaars and Tovbis (2021) for KdV. Loosely speaking, soliton condensate can be viewed as the \u201cdensest possible\u201d gas (for a given spectral support +) whose properties are fully determined by the interaction (integral) terms in the NDRs (2.9), (2.10).\nFor theKdV equation, setting \u03c3 = 0 and, considering the simplest case + = [0, 1] in (2.9), (2.10), we obtain the soliton condensate NDRs (El 2021):\n\u222b 1 0 ln \u2223\u2223\u2223\u2223\u03bc + \u03b7\u03bc \u2212 \u03b7 \u2223\u2223\u2223\u2223 u(\u03bc)d\u03bc = \u03b7, \u222b 1 0 ln \u2223\u2223\u2223\u2223\u03bc + \u03b7\u03bc \u2212 \u03b7 \u2223\u2223\u2223\u2223 v(\u03bc)d\u03bc = 4\u03b73. (2.15)\nThese are solved by\nu(\u03b7) = \u03b7 \u03c0 \u221a 1 \u2212 \u03b72 , v(\u03b7) = 6\u03b7(2\u03b72 \u2212 1) \u03c0 \u221a 1 \u2212 \u03b72 , (2.16)\nas verified by direct substitution (it is advantageous to first differentiate equations (2.15) with respect to \u03b7). The formula (2.16) for u(\u03b7) is sometimes called the Weyl distribution, following the terminology from the semiclassical theory of linear differential operators (Ivrii 2016; Lax and Levermore 1983). Remark 2.1 The meaning of the zero \u03b70 = 1/ \u221a 2 of v(\u03b7) is that all the tracer solitons with the spectral parameter \u03b7 > \u03b70 move to the right, whereas all the tracer solitons with \u03b7 < \u03b70 move in the opposite direction, while the tracer soliton with \u03b7 = \u03b70 is stationary. The somewhat counter-intuitive \u201cbackflow\u201d phenomenon (we remind that KdV solitons considered in isolation move to the right) has been observed in the numerical simulations of the KdV soliton gas (Pelinovsky and Shurgalina 2017) and can be readily understood from the phase shift formula of two interacting solitons, where the larger soliton gets a kick forward upon the interaction, while the smaller soliton is pushed back. As a matter of fact, the KdV soliton backflow is general and can be observed for a broad range of sufficiently dense gases (see Fig. 16 in Sect. 7.1 for the numerical illustration)."
        },
        {
            "heading": "3 Soliton Condensates and Their Modulations",
            "text": "We now consider the general case of the soliton gas NDRs (2.9), (2.10) by letting the support + of u(\u03b7), v(\u03b7) to be a union of disjoint intervals \u03b3k \u2282 R+, k = 0, 1, . . . , N where \u03b30 = [0, \u03bb1] and \u03b3 j = [\u03bb2 j , \u03bb2 j+1], j = 1, . . . , N , i.e.\n+ = [0, \u03bb1] \u222a [\u03bb2, \u03bb3] \u222a \u00b7 \u00b7 \u00b7 \u222a [\u03bb2N , \u03bb2N+1]. (3.1)\nWe shall call the intervals \u03b3k the s-bands, and the soliton gas spectrally supported on + (3.1)\u2014 the genus N soliton gas. Correspondingly, we refer to the intervals c j = (\u03bb2 j\u22121, \u03bb2 j ) separating the s-bands as to s-gaps. Note that the s-bands and s-gaps are different from the original bands and gaps in the spectrum Sn of finitegap potential (cf. (2.4)) as they emerge after the passage to the thermodynamic limit: loosely speaking, one can view the s-bands as a continuum limit of the \u201cthermodynamic band clusters\u201d, each representing an isolated dense subset of S\u221e consisting of the collapsing original bands. The existence and uniqueness of solutions u(\u03b7), v(\u03b7) for (2.9), (2.10), respectively, as well as the fact that u(\u03b7) \u2265 0 on + with some mild constraints, were established in Kuijlaars and Tovbis (2021). Our goal here is to find explicit expressions for u, v for the genus N soliton condensate, that is, solutions of (2.9), (2.10) for the particular case \u03c3 \u2261 0 on +.\nDenote by \u2212 the symmetric image of + with respect to the origin, i.e., \u2212 = \u2212 +. If we take the odd continuation of u, v to \u2212 (preserving the same notations), we observe that equations (2.9), (2.10) become\n\u2212 \u222b ln |\u03bc \u2212 \u03b7|u(\u03bc)d\u03bc + u(\u03b7)\u03c3 (\u03b7) = \u03b7, (3.2) \u2212 \u222b ln |\u03bc \u2212 \u03b7|v(\u03bc)d\u03bc + v(\u03b7)\u03c3 (\u03b7) = 4\u03b73, (3.3)\nwhere := + \u222a \u2212, for all \u03b7 \u2208 +. In fact, if we symmetrically extend \u03c3(\u03b7) from + to , equations (3.2), (3.3) should be valid on since every term in these equations is odd. The expressions (2.14) for the first two moments (ensemble averages) of the KdV wave field in the soliton gas become\n\u3008\u03d5\u3009 = 2 \u222b\n\u03b7 u(\u03b7)d\u03b7, \u3008\u03d52\u3009 = 8 3\n\u222b\n\u03b73 u(\u03b7)d\u03b7. (3.4)\nWe now consider soliton condensate of genus N by setting \u03c3 \u2261 0 in (3.2), (3.3). Then, differentiating in \u03b7 we obtain\nH [u] = 1 \u03c0 , H [v] = 12\u03b7 2 \u03c0 on , (3.5)\nwhere H denotes the finite Hilbert transform (FHT) on , see for example (Tricomi 1951; Okada and Elliot 1991),\nH [ f ](\u03be) = 1 \u03c0\n\u222b\nf (y)dy\ny \u2212 \u03be . (3.6)\nEquations (3.5) are the (transformed) NDRs for the KdV soliton condensate. To find u, v for the soliton condensate, it is sufficient to invert the FHT H on\n. Denote by R2N the hyperelliptic Riemann surface of the genus 2N , defined by the branchcuts (s-bands) \u03b3k , k = 0,\u00b11, . . . ,\u00b1N , where \u03b3\u2212k = \u2212\u03b3k . Define two meromorphic differentials of second kind, dp and dq onR2N by\ndp = i P(\u03b7) 2\u03c0R(\u03b7) d\u03b7, dq = 2i Q(\u03b7) \u03c0R(\u03b7) d\u03b7, (3.7)\nwhere\nR(\u03b7) = \u221a\n(\u03b72 \u2212 \u03bb21)(\u03b72 \u2212 \u03bb22) . . . (\u03b72 \u2212 \u03bb22N+1), (3.8)\nand P, Q are odd monic polynomials of degree 2N + 1 and 2N + 3, respectively, that are chosen so that all their s-gap integrals are zero, i.e.\n\u03bb2 j\u222b\n\u03bb2 j\u22121\ndp = \u03bb2 j\u222b\n\u03bb2 j\u22121\ndq = 0, j = 1, . . . , N . (3.9)\nEquivalently, one can say that dp, dq are real normalized differentials. Note that Equations (3.7), (3.9) uniquely define dp, dq.\nTheorem 3.1 Functions u(\u03b7) = dp/d\u03b7 and v(\u03b7) = dq/d\u03b7 defined by (3.7) and (3.9) satisfy the respective equations (3.5) and are odd and real valued on . Thus, u, v are the solutions of NDRs (2.9), (2.10) for \u03c3 = 0. Moreover, u(\u03b7) \u2265 0 on +. Here the value of R(\u03b7) for \u03b7 \u2208 is taken on the positive (upper) shore of the branchcut.\nTheorem 3.1 for u was proven in Kuijlaars and Tovbis (2021), Sect. 6, for the so-called bound state soliton condensate for the focusing NLS equation. The proof for KdV is analogous. The proof for v goes along the same lines, except v(\u03b7) attains different signs.\nThus, for the soliton condensate of genus N , we obtain, on using Theorem 3.1 and Equation (3.7),\nu(\u03b7) \u2261 u(N )(\u03b7; \u03bb1, . . . \u03bb2N+1) = i P(\u03b7) 2\u03c0R(\u03b7) ,\nv(\u03b7) \u2261 v(N )(\u03b7; \u03bb1, . . . , \u03bb2N+1) = 2i Q(\u03b7) \u03c0R(\u03b7) .\n(3.10)\nThe velocity of a tracer soliton with the spectral parameter \u03b7 propagating in the soliton condensate with DOS u(\u03b7) is then found as\ns(\u03b7) \u2261 s(N )(\u03b7; \u03bb1, . . . , \u03bb2N+1) = v(\u03b7) u(\u03b7) = 4Q(\u03b7) P(\u03b7) . (3.11)\nAs an illustrative example we present in Fig. 1, the plots of the DOS and tracer velocity for the genus 2 soliton condensate.\nWe now consider slow modulations of non-equilibrium (non-uniform) soliton condensates by assuming u \u2261 u(\u03b7; x, t), v \u2261 v(\u03b7; x, t), \u2261 (x, t). Equations (2.12), (3.10) then yield the kinetic equation for genus N soliton condensate:\n( P\nR ) t + ( 4Q R ) x = 0, (3.12)\nthat is valid for \u03b7 \u2208 = \u222aNk=\u2212N (\u03b3k). The velocity (3.11) then assumes the meaning of the tracer, or transport, velocity in a non-uniform genus N soliton condensate.\nTheorem 3.2 The kinetic equation (3.12) for soliton condensate implies the evolution of the endpoints \u03bb j , j = 1, . . . , 2N + 1 according to the Whitham modulation equations\n\u2202t\u03bb j + Vj (\u03bb)\u2202x\u03bb j = 0, j = 1, . . . , 2N + 1, (3.13)\nwhere \u03bb = (\u03bb1, . . . , \u03bb2N+1) and\nVj (\u03bb) = s(N )(\u03bb j ; \u03bb1, . . . , \u03bb2N+1) = 4Q(\u03bb j ) P(\u03bb j ) . (3.14)\nProof (See Dubrovin and Novikov 1989) Multiplying (3.12) by (\u03b72 \u2212 \u03bb2j )3/2 and passing to the limit \u03b7 \u2192 \u03bb j , we obtain equations (3.13), (3.14) for the evolution of the spectral s-bands (i.e. the evolution of (x, t)). These are the KdV\u2013Whitham\nmodulation equations Flaschka et al. (1980), Lax and Levermore (1983) (see also Remark 3.1). Corollary 3.1 The endpoints of the \u201cspecial\u201d band \u03b3k = [\u03bb2k, \u03bb2k+1], k = 0, containing the point \u03b70 of zero tracer speed, s(\u03b70) = 0, are moving in opposite directions, whereas all the endpoints on the same side from \u03b70 are moving in the same direction. See Fig. 1 (right) for N = 2 Remark 3.1 Modulation equations (3.12), (3.13) were originally derived by Flaschka et al. (1980) by averaging the KdV equation over the multiphase (finite-gap) family of solutions. These equations, along with the condensate NDRs (3.5), also appear in the seminal work of Lax and Levermore (1983) in the context of the semiclassical (zero-dispersion) limit of multi-soliton KdV ensembles (see Sect. 5 and, in particular, Equation (5.23) in Lax and Levermore (1983)). A succinct exposition of the spectral Whitham theory for the KdV equation can be found in Dubrovin and Novikov (1989)).\nRemark 3.2 The Whitham modulation equations (3.13), (3.14) are locally integrable for any N via Tsarev\u2019s generalized hodograph transform (Tsar\u00ebv 1991; Dubrovin and Novikov 1989). Moreover, by allowing the genus N to take different values in different regions of x, t-plane, N = N (x, t), global solutions of the KdV\u2013Whitham system can be constructed for a broad class of initial data (see Sect. 4.2 for further details). Invoking the definitive property \u03c3 \u2261 0 of a soliton condensate, the existence of the solution to an initial value problem for theWhitham system for all t > 0 implies that this property will remain invariant under the t-evolution, i.e. soliton condensate will remain a condensate during the evolution; however, its genus can change.\nThe finite-genus Whitham modulation system (3.13), (3.14) can be viewed as an exact hydrodynamic reduction of the full kinetic equation (2.11), (2.12) under the ansatz (3.10), (3.11). Recalling the origin of the soliton gas kinetic equation as a singular, thermodynamic limit of theWhitham equations (El 2003), the recovery of the finite-genus Whitham dynamics in the condensate limit might not look surprising. On the other hand, viewed from the general soliton gas perspective the condensate reduction notably shows that the highly nontrivial nonlinear modulation (hydro)dynamics emerges as a collective effect of the elementary two-soliton scattering events. This understanding is in line with ideas of generalized hydrodynamics, a powerful theoretical framework for the description of non-equilibrium macroscopic dynamics in many-body quantum and classical integrable systems. The connection of the KdV soliton gas theory with generalized hydrodynamics has been recently established in Bonnemain et al. (2022). Relevant to the above, it was shown in that the semiclassical limit of the generalized hydrodynamics for the Lieb\u2013Liniger model of Bose gases yields the Whitham modulation system for the defocusing NLS equation.\nA different type of hydrodynamic reductions of the soliton gas kinetic equation realized via themulti-component delta-function ansatz u(\u03b7; x, t)=\u2211mi=1 wi (x, t)\u03b4(\u03b7\u2212\u03b7 j ) for the DOS has been studied in El et al. (2011) for \u03b7 j = const and in Pavlov et al. (2012); Ferapontov andPavlov (2022) for\u03b7 j = \u03b7 j (x, t). One of the defining properties of the multicomponent hydrodynamic reductions of this type is their linear degeneracy which, in particular, implies the absence of wavebreaking and the occurrence of\ncontact discontinuities in the solutions of Riemann problems (Smoller 1994) studied in the context of two-component KdV soliton gases in Carbone et al. (2016). In contrast, the condensate (Whitham) system (3.13), (3.14) obtained under the condition \u03c3 \u2261 0 is known to be genuinely nonlinear, \u2202Vj/\u2202\u03bb j = 0, j = 1, . . . 2N + 1 (Levermore 1988) implying the inevitability of wavebreaking for general initial data, which is in stark contrast with linear degeneracy of the multicomponent \u201ccold-gas\u201d hydrodynamic reductions. Reconciling the genuine nonlinearity property of the Whitham equations governing soliton condensates with linearly degenerate noncondensate multicomponent cold-gas dynamics is an interesting problem, which will be considered in future publications.\nThus, we have shown that the spectral dynamics of non-equilibrium soliton condensates are equivalent to those of modulated finite gap potentials, which naturally suggests a close connection between (or even equivalence of) these two objects at the level of realizations, i.e. the corresponding solutions\u03d5(x, t) of theKdV equation itself. This connection will be explored in the next section using a combination of analytical results and numerical simulations for genus 0 and genus 1 soliton condensates."
        },
        {
            "heading": "4 Genus 0 and Genus 1 Soliton Condensates",
            "text": "Having developed the spectral description of KdV soliton condensates, we now look closer at the two simplest representatives: genus 0 and genus 1 condensates. In particular, we shall be interested in the characterization of the realizations of soliton condensates, i.e. the KdV solutions, denoted \u03d5(N )c (x, t), corresponding to the condensate spectral DOS u(N )(\u03b7) for N = 0, 1.We do not attempt here to construct the soliton gas realizations explicitly via the thermodynamic limit of finite gap potentials (see Sect. 2); instead, we infer some of their key properties from the expressions (3.4) for the ensemble averages as moments of the spectral DOS. We then conjecture the exact form of soliton condensate realizations and support our conjecture by comparison with detailed numerical simulations."
        },
        {
            "heading": "4.1 Equilibrium Properties",
            "text": ""
        },
        {
            "heading": "4.1.1 Genus 0",
            "text": "For N = 0, equations (3.10) for theDOS and the spectral flux density yield (cf. (2.16))\nu(\u03b7) = u(0)(\u03b7; \u03bb1) \u2261 \u03b7 \u03c0 \u221a \u03bb21 \u2212 \u03b72\n, v(\u03b7) = v(0)(\u03b7; \u03bb1) \u2261 6\u03b7(2\u03b7 2 \u2212 \u03bb21)\n\u03c0 \u221a \u03bb21 \u2212 \u03b72 , (4.1)\nso that the tracer velocity (cf. (3.11))\ns(\u03b7) = s(0)(\u03b7; \u03bb1) = 6(2\u03b72 \u2212 \u03bb21). (4.2)\nNext, substituting (4.1) in (3.4) (where = [\u2212\u03bb1, \u03bb1] or, equivalently, + = [0, \u03bb1]), we obtain for the ensemble averages:\n\u3008\u03d5\u3009 = \u03bb21, \u3008\u03d52\u3009 = \u03bb41, (4.3)\nwhere \u03d5 \u2261 \u03d5(0)c (x, t). Thus, the variance = \u221a\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 = \u221a\u3008(\u03d5 \u2212 \u3008\u03d5\u3009)2\u3009 = 0, which implies (see, e.g. Rohatgi and Ehsanes Saleh 2015) that genus 0 soliton condensate is almost surely described by a constant solution of the KdV equation, i.e.\n\u03d5 = \u3008\u03d5\u3009 = \u03bb21 (4.4)\n(note that constant solution is classified as a genus 0 KdV potential). This result can be intuitively understood by identifying soliton condensate with the \u201cdensest possible\u201d soliton gas for a given spectral support . The densest \u201cpacking\u201d for genus 0 is achieved by distributing soliton parameters according to the spectral DOS u(\u03b7) (4.1), which results in the individual solitons \u201cmerging\u201d into a uniformKdV field of amplitude \u03bb21. The numerical implementation of soliton condensate realizations, using n-soliton KdV solution with n large, shows that the condensate DOS (4.1) is only achievable within this framework if all n solitons in the solution have the same phase of the respective norming constants. Invoking the interpretation of the phase of the norming constant as the soliton position in space (Novikov et al. 1984; Drazin and Johnson 1989), one can say that in the condensate all solitons are placed at the same point, say x = 0 (cf. Appendix A for a mathematical justification). Details of the numerical implementation of KdV soliton gas using n-soliton solutions can be found in Appendix A. Figure 2 displays the realization \u03d5(0)c (x) of genus 0 soliton condensate with \u03bb1 = 1 modeled by n-soliton solutions \u03d5n(x) with n = 100 and n = 200, along with the absolute errors \u03d5n(x)\u22121; in the followingwe refer to these n-soliton solutions as \u201cnumerical realizations\u201d of the soliton gas. One can see that the error at the center of the numerical domain, where the gas is nearly uniform, is very small: Fig. 3 displays the variation of this error with n and shows that it decreases with 1/n2.\nThenumerical approximationusedhere is similar to the approximationof the soliton condensate of the focusing NLS equation via a n-soliton solution presented in Gelash et al. (2021). In the latter case, the uniform wavefield limit, which can be viewed as a central part of the so-called box potential, is also reached when the complex phases of the norming constants are chosen deterministically. The absolute error\u2014the difference between the focusing NLS n-soliton solution and the expected constant value of the wavefield\u2014measured at the center of the numerical realization\u2014follows a different scaling law and is proportional to n\u22121/2."
        },
        {
            "heading": "4.1.2 Genus 1",
            "text": "We now consider the case of genus 1 soliton condensate. For N = 1\nR(\u03b7) = \u221a\n(\u03b72 \u2212 \u03bb21)(\u03b72 \u2212 \u03bb22)(\u03b72 \u2212 \u03bb23) (4.5)\nis purely imaginary on = [\u2212\u03bb3,\u2212\u03bb2] \u222a [\u2212\u03bb1, \u03bb1] \u222a [\u03bb2, \u03bb3]. According to Theorem 3.1\nu(\u03b7) = u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) \u2261 i\u03b7(\u03b7 2 \u2212 w2)\n\u03c0R(\u03b7) , (4.6)\nv(\u03b7) = v(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) \u2261 12i\u03b7(\u03b7 4 \u2212 h2\u03b72 \u2212 r2) \u03c0R(\u03b7) , (4.7)\nwhere h2 = \u03bb21+\u03bb22+\u03bb232 follows from the fact that \u2212iRes Q(\u03b6 )(\u03b6\u2212\u03b7)R(\u03b6 ) \u2223\u2223\u2223 \u03b6=\u221e = \u22126\u03b7 2. The normalization conditions (3.9) imply that\nw2 = \u222b \u03bb2 \u03bb1\ny3dy R(y)\u222b \u03bb2\n\u03bb1\nydy R(y)\n, r2 = \u222b \u03bb2 \u03bb1 y5\u2212 \u03bb 2 1+\u03bb22+\u03bb23 2 y 3\nR(y) dy\u222b \u03bb2 \u03bb1 ydy R(y) . (4.8)\nUsing 3.131.3 and 3.132.2 from Gradshteyn and Ryzhik (2007), we calculate\nw2=\u03bb23 \u2212 (\u03bb23 \u2212 \u03bb21)\u03c7(m), where \u03c7(m)= E (m) K (m) and m= \u03bb\n2 2\u2212\u03bb21\n\u03bb23\u2212\u03bb21 . (4.9)\nCalculation of r2 is a bit more involved as it is based on the observation\n\u222b \u03bb2 \u03bb1 y5 R(y) dy = 1 2 \u222b \u03bb22 \u03bb21 z2dz R(z 1 2 ) ,\n= \u03bb 2 1 + \u03bb22 + \u03bb23\n3\n\u222b \u03bb22 \u03bb21 zdz R(z 1 2 ) \u2212 \u03bb 2 1\u03bb 2 2 + \u03bb21\u03bb23 + \u03bb22\u03bb23 6 \u222b \u03bb22 \u03bb21 dz R(z 1 2 ) .\n(4.10)\nUsing (4.8), (4.10), we obtain after some algebra\nr2 = 1 6\n[ \u03bb23(\u03bb 2 3 \u2212 \u03bb22 \u2212 \u03bb21) \u2212 2\u03bb22\u03bb21 \u2212 (\u03bb23 + \u03bb21 + \u03bb22)(\u03bb23 \u2212 \u03bb21)\u03c7(m) ] . (4.11)\nThus, the velocity of a tracer soliton with spectral parameter \u03b7 \u2208 + in the genus 1 soliton condensate, characterized by DOS (4.6), is given by\ns(\u03b7) \u2261 s(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) = 12\u03b7 4 \u2212 \u03bb22+\u03bb23+\u03bb212 \u03b72 \u2212 r2\n\u03b72 \u2212 w2\n= 12\u03b7 4 \u2212 \u03bb22+\u03bb23+\u03bb212 \u03b72 \u2212 \u03bb23(\u03bb 2 3\u2212\u03bb22\u2212\u03bb21)\u22122\u03bb22\u03bb21\u2212(\u03bb23+\u03bb21+\u03bb22)(\u03bb23\u2212\u03bb21)\u03c7(m) 6\n\u03b72 \u2212 \u03bb23 + (\u03bb23 \u2212 \u03bb21)\u03c7(m) .\n(4.12)\nWe note that a similar expression for the tracer velocity in a dense soliton gas was obtained in Girotti et al. (2022) in the context of the modified KdV (mKdV) equation.\nFor N = 1, the integrals (3.4) for the mean and mean square of the soliton condensate wave field \u03d5 \u2261 \u03d5(1)c (x, t) can be explicitly evaluated using (253.11) and (256.11) from Byrd and Friedman (1954) and 19.7.10 from Olver et al. (2022):\n\u3008\u03d5\u3009 = \u03bb21 + \u03bb22 \u2212 \u03bb23 + 2(\u03bb23 \u2212 \u03bb21)\u03c7(m), (4.13) \u3008\u03d52\u3009 = 2(\u03bb 2 1 + \u03bb22 + \u03bb23)\n3 \u3008\u03d5\u3009 + \u03bb\n4 1 + \u03bb42 + \u03bb43 \u2212 2\u03bb21\u03bb22 \u2212 2\u03bb22\u03bb23 \u2212 2\u03bb21\u03bb23\n3 , (4.14)\nwith \u03c7(m) and m given by (4.9). It is not difficult to verify that, unlike in the case of genus 0 condensates, the variance = \u221a\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 does not vanish identically, implying that all realizations of the genus 1 soliton condensate are almost surely non-constant.\nA key observation is that formulae (4.13), (4.14) coincide with the period averages \u03d5 and \u03d52 of the genus 1 KdV solution associated with the spectral Riemann surface R2 of (4.5) (see, e.g. Kamchatnov 2000; El and Hoefer 2016):\n\u03d5(x, t) \u2261 F1(\u03b8; \u03bb1, \u03bb2, \u03bb3) = \u03bb21 + \u03bb22 \u2212 \u03bb23 + 2(\u03bb23 \u2212 \u03bb21)dn2 \u239b \u239d \u221a \u03bb23 \u2212 \u03bb21 k \u03b8;m \u239e \u23a0 ,\n\u03b8 = k(x \u2212Ut) + \u03b80, U = 2(\u03bb21 + \u03bb22 + \u03bb23), k = \u03c0 \u221a \u03bb23 \u2212 \u03bb21 K(m) , (4.15)\nwhere \u03b80 \u2208 [0, 2\u03c0) is an arbitrary initial phase. The equivalence between the ensemble averages in genus 1 KdV soliton condensates and the period averages in single-phaseKdV solutions, alongwith the established in Sect. 3 equivalence between the respective modulation dynamics, strongly suggest that realizations of the genus 1 soliton condensates are described by the periodic solutions F1(\u03b8) (4.15) of the KdV equation. This motivates the following\nConjecture 4.1 For any realization \u03d5 = \u03d5(1)c (x, t) of the genus 1 KdV soliton condensate associated with the spectral curve R2 of (4.5), one can find the initial phase \u03b80 \u2208 [0, 2\u03c0) in the periodic solution F1(\u03b8; \u03bb1, \u03bb2, \u03bb3) (4.15) such that almost surely \u03d5(1)c (x, t) = F1(\u03b8; \u03bb1, \u03bb2, \u03bb3).\nWe support Conjecture 4.1 by a detailed comparison of a numerical realization of KdV soliton condensate (as n-soliton solution with n large) spectrally configured according to the DOS (4.6), and the periodic KdV solution (4.15), defined on the same spectral curveR2, with the appropriately chosen initial phase \u03b80 (see Appendix A for the details of the numerical implementation of soliton condensate). The comparison is presented in Fig. 4 and reveals a remarkable agreement, which further improves as n increases.\nConjecture 4.1 can be naturally generalized to an arbitrary genus N : for any realization of the KdV soliton condensate of genus N corresponding to the DOS\nu(N )(\u03b7;\u03bb) (3.10) and associated with the spectral Riemann surfaceR2N of (3.8), one can find N -component initial phase vector \u03b80 \u2208 TN so that \u03d5(N )c (x, t) almost surely coincides with N -phase KdV solution \u03d5 = FN (\u03b8;\u03bb) (2.5). To support this generalization, we performed a comparison of a numerical realization of the genus 2 soliton condensate with the respective two-phase (two-gap) KdV solution, see Appendix B.\nA rigorous mathematical proof of Conjecture 4.1 and its generalization for an arbitrary genus will be the subject of future work.\nIn conclusion, we note that Conjecture 4.1 correlates with the results of Girotti et al. (2021) where a particular \u201cdeterministic soliton gas\u201d solution of the KdV equationwas constructed by considering the n-soliton solution with the discrete spectrum confined within two symmetric intervals\u2014the analogs of s-bands of our work\u2014and letting n \u2192 \u221e. This solution was shown in Girotti et al. (2021) to represent a primitive potential (Dyachenko et al. 2016) whose long-time asymptotics is described at leading order by a modulated genus 1 KdV solution. A similar construction was realized in Girotti et al. (2022) for themKdVequation.We alsomention the recent paper (Nabelek 2020) where the direct connection between finite-gap KdV solutions and primitive potentials was established."
        },
        {
            "heading": "4.2 Modulation Dynamics",
            "text": "The dynamics of DOS in non-equilibrium (weakly non-homogeneous) soliton condensates is determined by the evolution of the endpoints \u03bb j of the spectral bands of (the s-bands). As proven in Sect. 3, this evolution is governed by the Whitham modulation equations (3.13). Properties of the KdV\u2013Whitham modulation systems are well studied: in particular, system (3.13) is strictly hyperbolic and genuinely nonlinear for any genus N \u2265 1 (Levermore 1988). This implies inevitability of wavebreaking for a broad class of initial conditions. What is the meaning of the wavebreaking in the context of soliton condensates, and how is the solution of the kinetic equation for the condensate continued beyond the wavebreaking point in the (x, t)-plane?\nWe first invoke the definitive property of a soliton condensate\u2014the vanishing of the spectral scaling function, \u03c3(\u03b7) \u2261 0, in the soliton gas NDRs (2.9). According to Remark 3.2, if \u03c3(\u03b7; x, 0) \u2261 0 for all x \u2208 R, then \u03c3(\u03b7; x, t) \u2261 0 for all x \u2208 R, \u2200t > 0, implying that soliton condensate necessarily remains a condensate during the evolution (at least of some class of initial data). The only qualitative modification that is permissible during the evolution is the change of the genus N . The description of the evolution of a soliton condensate is then reduced to the determination of the spectral support (x, t), parametrizing the DOS via the band edges \u03bb j (x, t): u = u(N )(\u03b7; \u03bb1, . . . \u03bb2N+1) (3.10).\nIn view of the above, the evolution of soliton condensates can be naturally put in the framework of the problem of hydrodynamic evolution of multivalued functions originally formulated by Dubrovin and Novikov (1989). Let N (x, t) = {\u03bb1(x, t), . . . , \u03bb2N+1(x, t)} be a smooth multivalued curve whose branches \u03bb j (x, t) satisfy the Whitham modulation equations (3.13). Then, if the wavebreaking occurs within one of the branches, it results in a change of the genus N so that N \u2192 N+1 in some space-time region [x\u2212(t), x+(t)] that includes the wavebreaking point. The\ncurves N and N+1 are glued together at free boundaries x\u00b1(t). Details of the implementation of this procedure can be found in (Dubrovin and Novikov 1989; Dubrovin 1997; El et al. 2001; Grava and Tian 2002). The simplest case of the multivalued curve evolution arises when the initial data for N is a piecewise-constant distribution (both for \u03bb j \u2019s and for N ), with a discontinuity at x = 0\u2014a Riemann problem. In this special case, the wavebreaking occurs at t = 0 (subject to appropriate sign of the initial jump) and smoothness of N is not a prerequisite.\nIn this paper, we restrict ourselves to Riemann problems involving only genus 0 and genus 1 modulation solutions and show how the resulting spectral dynamics are interpreted in terms of soliton condensates. For that, we will need explicit expressions for the Whitham characteristic velocities for N = 0 and N = 1. These expressions are known very well (see, e.g. Gurevich and Pitaevskii 1974; Kamchatnov 2000; El and Hoefer 2016), but here we obtain them as transport velocities for the respective soliton condensates, using the expressions (4.2), and (4.12), respectively.\n(i) N = 0. Consider a non-equilibrium (non-uniform) soliton condensate of genus 0, characterized by a space-time-dependent DOS u(\u03b7; x, t). To this end, we set \u03b7 = \u03bb1(x, t) in (4.2); then, the Whitham system (3.13), (3.14) assumes the form of the Hopf (inviscid Burgers) equation\n(\u03bb1)t + 6\u03bb21(\u03bb1)x = 0. (4.16)\nNote that this is exactly the result obtained by Lax and Levermore (1983) for the pre-breaking evolution of semi-classical soliton ensembles.\n(ii) N = 1. We obtain on using (4.12),\n(\u03bb j )t + Vj (\u03bb1, \u03bb2, \u03bb3)(\u03bb j )x = 0, j = 1, 2, 3, (4.17)\nwhere\nV1(\u03bb1, \u03bb2, \u03bb3) \u2261 s(1)(\u03bb1; \u03bb1, \u03bb2, \u03bb3) = 2(\u03bb21 + \u03bb22 + \u03bb23) + 4(\u03bb22 \u2212 \u03bb21) \u03c7(m) \u2212 1 , V2(\u03bb1, \u03bb2, \u03bb3) \u2261 s(1)(\u03bb2; \u03bb1, \u03bb2, \u03bb3) = 2(\u03bb21 + \u03bb22 + \u03bb23)\n+ 4(\u03bb 2 3 \u2212 \u03bb22)(\u03bb22 \u2212 \u03bb21)\n\u03bb23 \u2212 \u03bb22 \u2212 (\u03bb23 \u2212 \u03bb21)\u03c7(m) ,\nV3(\u03bb1, \u03bb2, \u03bb3) \u2261 s(1)(\u03bb3; \u03bb1, \u03bb2, \u03bb3) = 2(\u03bb21 + \u03bb22 + \u03bb23) + 4(\u03bb23 \u2212 \u03bb22)\n\u03c7(m) ,\n(4.18)\nand\u03c7(m) is defined in (4.9). System (4.17), (4.18) coincideswith the originalWhitham modulation equations derived for r j = 6\u03bb2j in Whitham (1965) by averaging KdV conservation laws over the single-phase, cnoidal wave family of solutions (see also Gurevich and Pitaevskii 1974; Dubrovin and Novikov 1989; Kamchatnov 2000; El and Hoefer 2016)."
        },
        {
            "heading": "5 Riemann Problem for Soliton Condensates",
            "text": "The classical Riemann problem consists of finding solution to a system of hyperbolic conservation laws subject to piecewise-constant initial conditions exhibiting discontinuity at x = 0. The distribution solution of suchRiemann problemgenerally represents a combination of constant states, simple (rarefaction) waves and strong discontinuities (shocks or contact discontinuities) (Lax 1973). In dispersive hydrodynamics, classical shock waves are replaced by dispersive shock waves (DSWs)\u2014nonlinear expanding wavetrains with a certain, well-defined structure (El and Hoefer 2016). Here we generalize the Riemann problem formulation to the soliton gas kinetic equation by considering (1.1) subject to discontinuous initial DOS:\nu(\u03b7; x, t = 0) = { u(N\u2212)(\u03b7; \u03bb\u22121 , . . . , \u03bb\u22122N\u2212+1), x < 0, u(N+)(\u03b7; \u03bb+1 , . . . , \u03bb+2N++1), x > 0,\n(5.1)\nwhere u(N )(\u03b7; \u03bb1, . . . , \u03bb2N+1) is the DOS (3.10) of genus N condensate and \u03bb\u00b1j > 0. As discussed in Sect. 4.2, soliton condensate necessarily retains its definitive property \u03c3 = 0 during the evolution, with the only qualitative modification permissible being the change of the genus N . The evolution of the soliton condensate is then determined by the motion of the s-band edges \u03bb j according to the Whitham modulation equations (3.13) subject to discontinuous initial conditions following from (5.1):\n{N ;\u03bb}(x, t = 0) = {\n{N\u2212; (\u03bb\u22121 , . . . , \u03bb\u22122N\u2212+1)}, x < 0, {N+; (\u03bb+1 , . . . , \u03bb+2N++1)}, x > 0.\n(5.2)\nThus, the Riemann problem for soliton gas kinetic equation is effectively reduced in the condensate limit to the Riemann problem (5.2) for the Whitham modulation equations (3.13). Depending on the sign of the jump \u03bb\u2212j \u2212 \u03bb+j , the regularization of the discontinuity in \u03bb j can occur in two ways: (i) if (\u03bb \u2212 j \u2212 \u03bb+j ) < 0, then the regularization occurs via the generation of a rarefaction wave for \u03bb j without changing the genus N of the condensate; (ii) if (\u03bb\u2212j \u2212 \u03bb+j ) > 0 (which implies immediate wavebreaking for \u03bb j ), the regularization occurs via the generation of a higher genus condensate whose evolution is governed by the modulation equations.\nBelow we consider several particular cases of Riemann problems describing some prototypical features of the soliton condensate dynamics."
        },
        {
            "heading": "5.1 N\u2212 = N+ = 0",
            "text": "Consider the initial condition for the kinetic equation in the form of a discontinuous genus 0 condensate DOS,\nu(\u03b7; x, t = 0) = { u(0)(\u03b7; q\u2212), x < 0, u(0)(\u03b7; q+), x > 0, (5.3)\nwhere q\u00b1 = \u03bb\u00b11 , and u(0) > 0 is defined in (4.1). The DOS distribution (5.3) implies the step initial conditions for the Whitham modulation system (3.13):\nN (x, t = 0) = 0, \u03bb1(x, t = 0) = { q\u2212, x < 0, q+, x > 0,\n(5.4)\nwith q\u2212 = q+. Additionally, since the wave field in a genus 0 soliton condensate is almost surely a constant, \u03d5(x, t) = (\u03bb1)2, we conclude that the DOS distribution (5.3) gives rise to the Riemann step data\n\u03d5(x, t = 0) = { q2\u2212, x < 0, q2+, x > 0,\n(5.5)\nfor the KdV equation (2.1) itself. The Riemann problem for the KdV equation was originally studied by Gurevich and Pitaevskii (GP) (Gurevich and Pitaevskii 1974) in the context of the description of dispersive shock waves. The key idea of GP construction was to replace the dispersive Riemann problem (5.5) for the KdV equation by an appropriate boundary value problem for the hyperbolic KdV\u2013Whitham system (4.17), which is then solved in the class of x/t-self-similar solutions. Here we take advantage of the GP modulation solutions and their higher genus analogues to describe dynamics of soliton condensates. The choice of the genus of the Whitham system and, correspondingly, the genus of the associated soliton condensate, depends on whether q\u2212 < q+ or q\u2212 > q+.\n5.1.1 Rarefaction Wave (q\u2212 < q+)\nThe solution of the Riemann problem (1.1), (5.3) is given globally (for t > 0) by the genus 0 DOS u(0)(\u03b7; \u03bb1) (4.1) modulated by the centered rarefaction wave solution of the Hopf equation (4.16) subject to the step initial condition (5.4):\n\u03bb1(x, t) = \u23a7\u23aa\u23aa\u23a8 \u23aa\u23aa\u23a9 q\u2212, x < s\u2212t,\u221a x 6t , s\u2212t < x < s+t,\nq+, s+t < x, (5.6)\nwhere\ns\u2212 = 6q2\u2212, s+ = 6q2+. (5.7)\nNote that the solution (5.6) is admissible since s\u2212 < s+. Behavior of \u03bb1 in the solution (5.6) is shown in Fig. 5a. The evolution of the soliton condensate\u2019sDOS associated with the spectral rarefaction wave solution (5.6) is given by:\nu(\u03b7; x, t) = \u03b7 \u03c0 \u221a \u03bb21(x, t) \u2212 \u03b72 . (5.8)\nA contour plot of the DOS (5.8) is presented in Fig. 5(a).\n5.1.2 Dispersive Shock Wave (q\u2212 > q+)\nThe solution (5.6), (5.8) derived previously is not admissible for q\u2212 > q+ since s\u2212 > s+ in that case. In other words, the compressive discontinuous initial data (5.4) imply immediate wavebreaking and necessitate the introduction of the higher genus DOS connecting u(0)(\u03b7; q\u2212) and u(0)(\u03b7; q+). The requisite DOS is given by equation (4.6), which we reproduce here for convenience,\nu(\u03b7; x, t) = u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) = i\u03b7(\u03b7 2 \u2212 w2)\n\u03c0R(\u03b7) , (5.9)\nHere w(\u03bb1, \u03bb2, \u03bb3) is given by (4.9) and \u03bb j = \u03bb j (x, t), j = 1, 2, 3, are slowly modulated according to the Whitham equations (4.17), (4.18).\nThe solution of (4.18) is self-similar, \u03bb j (x/t), such that u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3)matches with u(0)(\u03b7; q\u2212) at the left boundary x = s\u2212t , and with u(0)(\u03b7; q+) at the right boundary x = s+t , with s\u2212 < s+.\nThe requisite solution is the 2-wave of the Whitham system (4.17) (only \u03bb2 is non-constant)\n\u03bb1 = q+, V2(\u03bb1, \u03bb2, \u03bb3) = x/t, \u03bb3 = q\u2212, for s\u2212t < x < s+t, (5.10)\nwhere\ns\u2212 = V2(q+, q+, q\u2212) = 12q2+ \u2212 6q2\u2212, s+ = V2(q+, q\u2212, q\u2212) = 2q2+ + 4q2\u2212. (5.11)\nThis is the famous GP solution describing the DSW modulations in the KdV step resolution problem (Gurevich and Pitaevskii 1974). Indeed, we have s\u2212 < s+, and\ninterpreting the GP solution (5.10) in terms of soliton condensates, the limiting behaviors at the DSW edges are given by:\nx \u2192 s\u2212t, \u03bb2 \u2192 \u03bb1 = q+, u(1)(\u03b7; q+, \u03bb2, q\u2212) \u2192 u(0)(\u03b7; q\u2212), x \u2192 s+t, \u03bb2 \u2192 \u03bb3 = q\u2212, u(1)(\u03b7; q+, \u03bb2, q\u2212) \u2192 u(0)(\u03b7; q\u2212). (5.12)"
        },
        {
            "heading": "5.2 N\u2212 + N+ = 1",
            "text": "Before considering the soliton condensate Riemann problem (1.1), (5.1) for the case N\u2212 + N+ = 1, we list the admissible solutions to the kinetic equation connecting a genus 0 distribution u(0)(\u03b7; q) to a genus 1 distribution u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3). One can easily verify for the next four solutions that\nx \u2192 s\u2212t, u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) \u2192 u(N\u2212)(\u03b7;\u03bb\u2212), x \u2192 s+t, u(1)(\u03b7; \u03bb1, \u03bb2, \u03bb3) \u2192 u(N+)(\u03b7;\u03bb+),\n(5.13)\nwith s\u2212 < s+. We use the following convention to label the fundamental Riemann problem solutions: we call j\u00b1-wave, where j is the index of the only varying Riemann invariant \u03bb j in the solution, while the remaining invariants are constant; + indicates that N+ = 1, i.e., the genus 1 soliton condensate is initially at x > 0, and \u2212 indicates that N\u2212 = 1, i.e., the genus 1 soliton condensate is initially at x < 0. (i) 3+-wave\nConsider the initial condition for the soliton condensate DOS:\nu(\u03b7; x, t = 0) = { u(0)(\u03b7; q\u2212), x < 0, u(1)(\u03b7; \u03bb+1 , \u03bb+2 , \u03bb+3 ), x > 0, with \u03bb+1 = q\u2212. (5.14)\nThe resolution of the step (5.14) is described by\nu(\u03b7; x, t) = \u23a7\u23a8 \u23a9 u(1)(\u03b7; \u03bb\u22121 , \u03bb\u22122 , q+), x < s\u2212t, u(1)(\u03b7; \u03bb1(x/t), \u03bb\u22122 , q+), s\u2212t < x < s+t, u(0)(\u03b7; q+), x > s+t,\n(5.15)\nwhere \u03bb3(x/t) is given by the 3+-wave solution of the modulation equations (4.17):\n\u03bb1 = q\u2212, \u03bb2 = \u03bb+2 , V3(\u03bb1, \u03bb2, \u03bb3) = x/t, for s\u2212t < x < s+t, s\u2212 = V3(q\u2212, \u03bb+2 , \u03bb+2 ) = 2(q\u2212)2 + 4(\u03bb+2 )2, s+ = V3(q\u2212, \u03bb+2 , \u03bb+3 ). (5.16)\nThe behavior of the Riemann invariants \u03bb j in the 3+-wave is shown in Fig. 6a. The associated soliton condensate KdV solution \u03d5(x, t) along with the behavior of the mean \u3008\u03d5\u3009 is shown in Figs. 10 and 11. (ii) 2+-wave\nConsider the initial condition:\nu(\u03b7; x, t = 0) = { u(0)(\u03b7; q\u2212), x < 0, u(1)(\u03b7; \u03bb+1 , \u03bb+2 , \u03bb+3 ), x > 0, with \u03bb+3 = q\u2212. (5.17)\nThe resolution of the step (5.17) is described by:\nu(\u03b7; x, t) = \u23a7\u23aa\u23a8 \u23aa\u23a9 u(0)(\u03b7; q\u2212), x < s\u2212t, u(1)(\u03b7; \u03bb+1 , \u03bb2(x/t), q\u2212), s\u2212t < x < s+t, u(1)(\u03b7; \u03bb+1 , \u03bb+2 , q\u2212), x > s+t,\n(5.18)\nwhere \u03bb2(x/t) is given by the 2+-wave solution of the modulation equations (4.17):\n\u03bb1 = \u03bb+1 , V2(\u03bb1, \u03bb2, \u03bb3) = x/t, \u03bb3 = q\u2212, for s\u2212t < x < s+t, s\u2212 = V2(\u03bb+1 , \u03bb+1 , \u03bb+2 ) = 12(\u03bb+1 )2 \u2212 6(q\u2212)2, s+ = V2(\u03bb+1 , \u03bb+2 , q\u2212). (5.19)\nThe behavior of the Riemann invariants \u03bb j in the 2+-wave is shown in Fig. 6b. (iii) 1\u2212-wave\nConsider the initial condition:\nu(\u03b7; x, t = 0) = { u(1)(\u03b7; \u03bb\u22121 , \u03bb\u22122 , \u03bb\u22123 ), x > 0, u(0)(\u03b7; q+), x < 0, with \u03bb \u2212 3 = q+. (5.20)\nThe resolution of the step (5.20) is described by\nu(\u03b7; x, t) = \u23a7\u23aa\u23a8 \u23aa\u23a9 u(1)(\u03b7; \u03bb\u22121 , \u03bb\u22122 , q+), x < s\u2212t, u(1)(\u03b7; \u03bb1(x/t), \u03bb\u22122 , q+), s\u2212t < x < s+t, u(0)(\u03b7; q+), x > s+t,\n(5.21)\nwhere \u03bb1(x/t) is given by the 1\u2212-wave solution of the modulation equations (4.17):\nV1(\u03bb1, \u03bb2, \u03bb3) = x/t, \u03bb2 = \u03bb\u22122 , \u03bb3 = q+, for s\u2212t < x < s+t, s\u2212 = V1(\u03bb\u22121 , \u03bb\u22122 , q+), s+ = V1(\u03bb\u22122 , \u03bb\u22122 , q+) = 12(\u03bb\u22122 )2 \u2212 6(q+)2. (5.22)\nThe behavior of the Riemann invariants \u03bb j in the 1\u2212-wave is shown in Fig. 6c. (iv) 2\u2212-wave\nConsider the initial condition:\nu(\u03b7; x, t = 0) = { u(1)(\u03b7; \u03bb\u22121 , \u03bb\u22122 , \u03bb\u22123 ), x < 0, u(0)(\u03b7; q+), x > 0, with \u03bb \u2212 1 = q+. (5.23)\nThe resolution of the step (5.23) is described by\nu(\u03b7; x, t) = \u23a7\u23aa\u23a8 \u23aa\u23a9 u(1)(\u03b7; q+, \u03bb\u22122 , \u03bb\u22123 ), x < s\u2212t, u(1)(\u03b7; q+, \u03bb2(x/t), \u03bb\u22123 ), s\u2212t < x < s+t, u(0)(\u03b7; q+), x > s+t,\n(5.24)\nwhere \u03bb2(x/t) is given by the 2\u2212-wave solution of the modulation equations (4.17):\n\u03bb1 = q+, V2(\u03bb1, \u03bb2, \u03bb3) = x/t, \u03bb3 = \u03bb\u22123 , for s\u2212t < x < s+t, s\u2212 = V2(q+, \u03bb\u22122 , \u03bb\u22123 ), s+ = V2(q+, \u03bb\u22123 , \u03bb\u22123 ) = 2(q+)2 + 4(\u03bb\u22123 )2. (5.25)\nThe behavior of the Riemann invariants \u03bb j in the 2\u2212-wave is shown in Fig. 6d. The associated soliton condensate KdV solution \u03d5(x, t) along with the behavior of the mean \u3008\u03d5\u3009 is shown in Figs. 12 and 13."
        },
        {
            "heading": "6 Riemann Problem: Numerical Results",
            "text": "WeconsiderRiemannproblemswith N\u2212+N+ \u2264 1.Because of the inherent limitations of the numerical implementation of soliton gas detailed in Appendix A, we restrict the comparison to the cases q\u2212 = 0 or q+ = 0."
        },
        {
            "heading": "6.1 RarefactionWave",
            "text": "In this first example, we choose\n{N ;\u03bb}(x, t = 0) = {\n{0; q\u2212 = 0}, x < 0, {0; q+ = 1}, x > 0. (6.1)\nA numerical realization of the soliton condensate evolution corresponding to the steplike initial condition (6.1) is displayed in Fig. 7. The same figure displays the realization at t = 40. The realization corresponds to a n-soliton solution with parameters distributed according to the initial DOS of (5.3), (6.1); details are given inAppendixA. As predicted in Sect. 4.1, the realization of the condensate corresponds to the vacuum \u03d5 = 0 at the left of x = 0, and a constant \u03d5 = 1 at the right of x = 0. As highlighted in Appendix A.1, the n-soliton solution displays an overshoot at x = 0, regardless of the number of solitons n, which is reminiscent of Gibbs\u2019 phenomenon in the theory of Fourier series. This phenomenon has been originally observed in the numerical approximation of the soliton condensate of the focusing NLS equation by a n-soliton solution in Gelash et al. (2021); see, for instance, the similarities between Figs. 7a, 8a and Fig. 2a of Gelash et al. (2021). Indeed, in both cases, the IST spectrum of the step distribution contains a non-solitonic radiative component (cf. Ablowitz 2011), which is not taken into account by the n-soliton solution; the mismatch between the exact\nstep and the n-soliton solution manifests by the occurrence of the spurious oscillations observed near x = 0.\nThe solution of the Riemann problem with the initial condition (6.1) is given by u(0)(\u03b7; \u03bb1(x, t)) where \u03bb1(x, t) is the rarefaction wave (genus 0) solution (5.6). We have shown in Sect. 4.1 that the genus 0 soliton condensate is almost surely described by the constant solution \u03d5 = (\u03bb1)2. In the context of the evolution of the step (6.1) \u03bb1 varies according to (5.6) so \u03bb(x, t) should be treated as a slowly varying (locally constant) condensate solution. In Fig. 7, we compare the numerical realization of the evolution of genus 0 condensate with the analytical solution (5.6)."
        },
        {
            "heading": "6.2 Dispersive ShockWave",
            "text": "We now consider\n{N ;\u03bb}(x, t = 0) = {\n{0; q\u2212 = 1}, x < 0, {0; q+ = 0}, x > 0. (6.2)\nA numerical realization of the genus 0 soliton condensate corresponding to the stepinitial condition (6.2) is presented in Fig. 8a: it corresponds to the vacuum \u03d5 = 0 for\nx > 0, and a constant \u03d5 = 1 for x < 0. The realization at t = 40 is shown in Fig. 8b, and it corresponds to a classical DSW solution for the KdV equation. The solution of the condensate Riemann problem with the initial condition (5.3), (6.2) is given by the genus 1 DOS (5.9) modulated by the 2-wave solution (5.10) of the Whitham equations. In order to make a quantitative comparison of this analytical solution with the numerical evolution of the soliton gas displayed in Fig. 8, we compute numerically the mean \u3008\u03d5\u3009 and the variance \u221a\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092, the latter being an amplitude type characteristic of the cnoidal wave. We have conjectured in Sect. 4.1 that any realization of the uniform genus 1 condensate corresponds to a cnoidal wave modulo the initial phase \u03b80 \u2208 [0; 2\u03c0). In that case, the ensemble average of the soliton condensate reduces to an average over the phase \u03b80, or equivalently, over the period of the cnoidal wave, which can be performed on a single realization. We assume here that the result generalizes to non-uniform condensates so that the realization computed numerically and displayed in Fig. 8b can be consistently compared with a slowly modulated cnoidal wave solution. The averages \u3008\u03d5(x, t)\u3009 and \u3008\u03d5(x, t)2\u3009 can be determined via a local phase average of one realization of the condensate. The local\nFig. 9 Mean \u3008\u03d5\u3009 (a) and variance\n\u221a\n\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 (b) of the solution of the Riemann problem\u2019s solution\nwith the initial condition (6.2). The markers correspond to averages extracted from the numerical solution using (6.3), and the solid black lines to the corresponding analytical averages (4.13), (4.14) evaluated on the Gurevich\u2013Pitaevskii modulation solution (5.10)\nperiod averages are obtained via\n\u3008\u03d5(x, t)\u3009 = 1 L(x, t) \u222b x+L(x,t) x \u03d5(y, t)dy,\n\u3008\u03d5(x, t)2\u3009 = 1 L(x, t) \u222b x+L(x,t) x \u03d5(y, t)2dy,\n(6.3)\nwhere L(x, t) is the local wavelength extracted numerically. In the examples displayed in Figs. 9, 11, 13, the values of \u3008\u03d5(x, t)\u3009 and \u3008\u03d5(x, t)2\u3009 are computed at eachmaximum x = xi of the realization \u03d5(x, t), and the local wavelength is given by L(xi , t) = (xi+1 \u2212 xi\u22121)/2.\nThe comparison between the analytically determined averages (4.13), (4.14) evaluated on the Gurevich\u2013Pitaevskii modulation solution (5.10) for DSW and the averages (6.3) obtained numerically is presented in Fig. 9 and shows a very good agreement."
        },
        {
            "heading": "6.3 Generalized RarefactionWave",
            "text": "N\u2212 + N+ = 0 in the two previous examples. In the next examples, we choose N\u2212 + N+ = 1. Let\u2019s start with N+ = 1:\n{N ;\u03bb}(x, t = 0) = {\n{0; q\u2212 = 0}, x < 0, {1; (\u03bb+1 = 0, \u03bb+2 = 1/2, \u03bb+2 = 1)}, x > 0.\n(6.4)\nA numerical realization of the step-initial condition is displayed in Fig. 10. The same figure displays the realization at t = 40. The realization of the condensate corresponds to the \u201cvacuum\u201d \u03d5 = 0 for x < 0, and a cnoidal wave for x > 0. Note that the KdV equation does not admit heteroclinic traveling wave solutions, rendering difficult the numerical implementation of these \u201cgeneralized\u201d Riemann problems studied, for instance, in Sprenger and Hoefer (2020); Gavrilyuk et al. (2020). Remarkably here,\nFig. 11 Mean \u3008\u03d5\u3009 (a) and variance\n\u221a\n\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 (b) of the solution of the Riemann problem\u2019s solutionwith\nthe initial condition (6.4). The markers correspond to the averages extracted from the numerical solution using (6.3), and the solid black lines to the corresponding analytical averages (4.13), (4.14), (5.16)\nthe solution depicted in Fig. 10 is an exact, n-soliton solution of the KdV equation. As highlighted previously (see also Appendix A.1), the n-soliton solution exhibits an overshoot at x = 0, regardless of the number of solitons n.\nThe solution of the Riemann problem for the kinetic equation with the initial condition (5.14), (6.4) is given by the 3+-wave (5.15), (5.16). The comparison between the analytical averages (4.13), (4.14), (5.16) and the averages obtained numerically is shown in Fig. 11 and shows a very good agreement. The modulation depicted in Figs. 10b and 11a resembles the modulation of a cnoidal wave of an almost constant amplitude but with a varying mean. The variation of the mean \u3008\u03d5\u3009 is similar to the variation of the field in a classical rarefaction wave, so we call the corresponding structure shown in Fig. 10b a generalized rarefaction wave. The variance of the wavefield \u03d5 in the generalized rarefaction wave is shown in Fig. 11b."
        },
        {
            "heading": "6.4 Generalized Dispersive ShockWave",
            "text": "We now consider the \u201ccomplementary\u201d initial condition\n{N ;\u03bb}(x, t = 0) = {\n{1; (\u03bb\u22121 = 0, \u03bb\u22122 = 1/2, \u03bb\u22122 = 1)}, x < 0, {0; q+ = 0}, x > 0. (6.5)\nAn example of the numerical realization of the soliton gas step-initial condition and its evolution at t = 40 are displayed in Fig. 12.\nThe solution of the Riemann problem with the initial condition (6.5) is given by the 2\u2212-wave (5.24), (5.25). The comparison between the analytically derived averages (4.13), (4.14), (5.25) and the averages obtained numerically is displayed in Fig. 13 and shows a very good agreement. The modulation observed in Figs. 12, 13 resembles the modulation of partial dispersive shock wave: the modulated cnoidal wave reaches the soliton limit m = 1 for x \u2192 s+t but terminates at m = 0 for x \u2192 s\u2212t . The solution then continues as a non-modulated cnoidal wave for x < s\u2212t . This structure differs from the celebrated dispersive shock wave solution of the KdV equation involving the entire range 0 \u2264 m \u2264 1 (El and Hoefer 2016). We call the described structure connecting a constant state (a genus 0 condensate) at x \u2192 +\u221e with a periodic solution (a genus 1 condensate) at x \u2192 \u2212\u221e a generalized DSW. We note that the soliton condensate structure shown in Fig. 12b exhibits strong similarity to the \u201cdeterministic KdV soliton gas\u201d solution constructed in Girotti et al. (2021)."
        },
        {
            "heading": "7 Diluted Soliton Condensates",
            "text": ""
        },
        {
            "heading": "7.1 Equilibrium Properties",
            "text": "We now introduce the notion of a \u201cdiluted\u201d soliton condensate by considering DOS u(\u03b7) = Cu(N )(\u03b7), where u(N )(\u03b7) is the condensate DOS of genus N , and 0 < C < 1 is the \u201cdilution constant\u201d.\n\u221a\n\u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 (b) of the solution of the Riemann problem\u2019s solution\nWe recover the genus 0 condensate DOS (4.1) by setting C = 1. As C decreases, the \u201caveraged spacing\u201d between the solitons\n\u03ba\u22121 = (\u222b u(\u03b7)d\u03b7 )\u22121 \u221d C\u22121 (7.2)\nincreases and the condensate gets \u201cdiluted\u201d. Comparison between the most probable realization of the condensate (C = 1) and a typical realization of a slightly dilute condensate (C = 0.97) is given in Fig. 14. Remarkably, one can see that a slight increase of the average spacing between the solitons within the condensate results in the emergence of significant random oscillations of the KdV wave field.\nAs follows from (2.14), we have \u3008\u03d5\u3009 = \u3008\u03d52\u3009 = C for the diluted genus 0 condensate so that the variance is given by:\n= \u221a \u3008\u03d52\u3009 \u2212 \u3008\u03d5\u30092 = \u221aC(1 \u2212 C). (7.3)\nThe comparison between (7.3) and the variance obtained numerically by averaging over different diluted condensates is presented in Fig. 14. Assuming ergodicity of a generic uniform soliton gas, the ensemble average \u3008. . . \u3009 in Fig. 14b (and Fig. 15b) is computed here numerically with a spatial average of one, spatially broad, gas realization.\nMore generally, the diluted soliton condensate of genus N is characterized by DOS\nu(\u03b7) = Cu(N )(\u03b7; \u03bb1, . . . , \u03bb2N+1), 0 < C < 1. (7.4)\nWe have in the general case\n\u3008\u03d5\u3009 = C\u3008\u03d5(N )c \u3009, \u3008\u03d52\u3009 = C\u3008 ( \u03d5(N )c )2\u3009, (7.5)\nwhere \u3008\u03d5(N )c \u3009, \u3008 ( \u03d5 (N ) c )2\u3009 are the ensemble averages obtained for the genuine condensate\n(C = 1), which are functions of \u03bb1, . . . , \u03bb2N+1 only; for instance, \u3008\u03d5(1)c \u3009, \u3008 ( \u03d5 (1) c )2\u3009\nare given by (4.13), (4.14). Since \u3008(\u03d5(N )c )2\u3009 = \u3008\u03d5(N )c \u30092 for N \u2265 1 and distinct \u03bbi \u2019s, the variance of diluted genus condensates\n= \u221a C\u3008(\u03d5(N )c )2\u3009 \u2212 C2\u3008\u03d5(N )c \u30092 (7.6)\nnever vanishes if N \u2265 1, as can be seen in the example N = 1 shown in Fig. 15. Thus, in contrast to the genus 0 case, the transition from the genus 1 condensate (C = 1) to diluted genus 1 condensate (C < 1) does not see a drastic change in the oscillations\u2019 amplitude. In particular, the oscillations seem to remain \u201calmost\u201d coherent\u2014i.e. an average period can be identified\u2014for the dilution factors C close to 1 as depicted in the inset of Fig. 15.\nDiluted condensates provide a convenient framework to verify the prediction formulated in Remark 2.1 regarding the \u201cbackflow\u201d effect (i.e. the existence of tracer KdV solitons moving in negative direction) in sufficiently dense soliton gases. A numerical simulation of the diluted genus 0 condensate with C = 0.9 where one can clearly see the soliton trajectory with a negative slope is presented in Fig. 16."
        },
        {
            "heading": "7.2 Riemann Problem",
            "text": "We can now consider the Riemann problem for diluted condensates for which the initial DOS (5.1) is replaced by\nu(\u03b7; x, t = 0) = { C\u2212 u(N\u2212)(\u03b7; \u03bb\u22121 , . . . , \u03bb\u22122N\u2212+1), x < 0, C+ u(N+)(\u03b7; \u03bb+1 , . . . , \u03bb+2N++1), x > 0,\n(7.7)\nwhere 0 < C\u00b1 < 1. To be specific, we investigate numerically the evolution of the diluted condensate initial conditions (7.7) with N\u2212 +N+ \u2264 1 and \u03bbi chosen from the examples presented in Sect. 6. Numerical realizations of the step-initial condition and their evolution in time are presented in Fig. 17. One can see that generally, realizations of the diluted soliton condensate do not exhibit a macroscopically coherent structure as observed in Sect. 6. However, in the case N\u2212 + N+ = 1, the evolution of the diluted condensate realizations, despite the visible incoherence, still qualitatively resembles the evolution of the \u201cgenuine\u201d condensates depicted in Figs. 10, 12. One can see that the recognizable patterns of the generalized rarefaction wave (see Fig. 17f) and the generalized DSW (see Fig. 17h) persist even if C < 1. Indeed, as shown in Sect. 7.1, the oscilla-\ntions in a realization of the diluted genus 1 condensate appear almost coherent for a small dilution factor. The persistence of coherence can also be observed in the case N\u2212 + N+ = 0 when \u03bb\u22121 > \u03bb+1 (Fig. 17d): a DSW develops if C = 1, and coherent, finite amplitude oscillations still develop for C = 1 at the right edge of the structure where the amplitudes of oscillations are large. In connection with the above, it is important to note that, although the initial condition (7.7) is given by a discontinuous diluted condensate DOS, u(\u03b7; x, 0) = Cu(N )(\u03b7), the kinetic equation evolution does not imply that the DOS will remain to be of the same form for t > 0. In other words, unlike genuine condensates, the diluted condensates do not retain the spectral \u201cdiluted condensate\u201d property during the evolution."
        },
        {
            "heading": "8 Conclusions and Outlook",
            "text": "We have considered a special class of soliton gases for the KdV equation, termed soliton condensates, which are defined by the property of vanishing the spectral scaling function \u03c3(\u03b7) in the soliton gas nonlinear dispersion relations (2.9), (2.10). As a result, the DOS u(\u03b7) in a soliton condensate is uniquely determined by its spectral support + \u2208 R+. By considering + to be a union of N + 1 disjoint intervals, [0, \u03bb1] \u222a [\u03bb2, \u03bb3] \u222a \u00b7 \u00b7 \u00b7 \u222a [\u03bb2N , \u03bb2N+1], and allowing the endpoints {\u03bb j }2N+1j=1 vary slowly in space-time we prove that the kinetic equation for soliton gas reduces in the condensate limit to the genus N KdV\u2013Whitham modulation for \u03bb j (x, t). The KdV\u2013Whitham equations were originally derived via the wave averaging procedure in Whitham (1965), Flaschka et al. (1980) and via the semiclassical limit of the KdV equation in Lax and Levermore (1983). These equations have been extensively used for the description of dispersive shock waves (El and Hoefer 2016), particularly in the context of dispersive Riemann problem originally introduced by Gurevich and Pitaevskii (1974). One important implication of this reduction of the soliton gas kinetics to the modulation dynamics of finite gap potentials is the invariance of the definitive condensate property \u03c3 = 0 with respect to the time evolution, i.e. soliton condensate remains a condensate during the evolution; however, its genus N can change (increase) as a result of the wavebreaking of the multivalued spectral curve N (x, t) \u2261 {\u03bb1(x, t), \u03bb2(x, t), . . . , \u03bb2N+1(x, t)}. We note that the genuine nonlinearity of the Whitham modulation equations describing the evolution of soliton condensates is in sharp contrast to linear degeneracy of themulticomponent \u201ccold-gas\u201d hydrodynamic reductions of the kinetic equation studied earlier (El et al. 2011).Wealso mention intriguing parallels between the modulation dynamics of soliton condensates and the hydrodynamic properties of the so-called zero-entropy states in generalized hydrodynamics studied in Doyon et al. (2017).\nAlong with the characterization of the large-scale, modulation, dynamics of soliton condensates, our work suggests that they represent \u201ccoherent\u201d or \u201cdeterministic\u201d soliton gases whose typical realizations are given by finite-gap potentials. We prove this conjecture for genus 0 condensates and present strong numerical evidence for N = 1, 2.\nBy invoking the results from the modulation theory of dispersive shock waves, we have constructed analytical solutions to several Riemann problems for the soliton\ngas kinetic equation subject to discontinuous condensate initial data. These solutions describe the evolution of generalized rarefaction and dispersive shock waves in soliton condensates. We performed numerical simulations of the Riemann problem for the KdV soliton condensates by constructing an exact n-soliton solutions with n large and the spectral parameters distributed according to the condensate DOS. A comparison of the numerical simulations with analytical predictions from the solutions of the kinetic equation showed excellent agreement. Finally, we considered the basic properties of \u201cdiluted\u201d soliton condensateswith a scaled condensateDOS, exhibiting rich incoherent behaviors.\nThere are several avenues for future work suggested by our results. One natural direction is the extension of the developed KdV soliton condensate theory to other integrable equations. Such an extension looks pretty straightforward for the defocusingNLS and other equationswhose finite-gap solutions are associatedwith self-adjoint Lax operators (defocusing mKdV, Kaup-Boussinesq, etc.) and exhibit close similarities to the KdV case. There is a rich literature on the correspondingWhitham equations and their solutions describing the modulations in the rarefaction and dispersive shock waves (see, e.g. El and Hoefer 2016 and references therein). These results can now be naturally re-interpreted within the soliton gas context with potentially important implications forwaterwaves, nonlinear optics and condensedmatter physics. A related challenging problem of major interest is non-equilibrium dynamics of soliton condensates for the focusing NLS equation. Unlike the KdV soliton condensates, their focusing NLS counterparts exhibit strong incoherence and were shown to provide an accurate description of the long-time development of spontaneous modulational instability (Gelash et al. 2019). There are a growing number of theoretical and experimental research on soliton and breather gases for the focusing NLS equation (see El and Tovbis 2020; Roberti et al. 2021; Gelash et al. 2021; Bertola et al. 2023) posing further intriguing questions pertinent to the realm of integrable turbulence (Zakharov 2009).\nYet another interesting problem to be considered is the near-condensate soliton gas dynamics realized by assuming the spectral scaling function \u03c3 to be \u201csmall\u201d (\u03c3(\u03b7) = \u03c3\u0303 (\u03b7), 1, \u03c3\u0303 = O(1)). And last but not least, one of the most intriguing open questions is the possibility of phase transitions in soliton gases, i.e. the formation of a soliton condensate from non-condensate initial data. The generalized hydrodynamics approach to the thermodynamics of soliton gases (Bonnemain et al. 2022) provides a promising framework to explore this possibility. At the same time, this direction of research could require some departure from integrability and the development of the soliton gas theory for perturbed integrable equations.\nAcknowledgements The authors would like to thank the Isaac Newton Institute for Mathematical Sciences for support and hospitality during the programme \u201cDispersive hydrodynamics: mathematics, simulation and experiments, with applications in nonlinear waves\u201d when the work on this paper was undertaken. This work was supported by EPSRC Grant Number EP/R014604/1. GE\u2019s and GR\u2019s work was also supported by EPSRC Grant Number EP/W032759/1 and AT\u2019s work was supported by NSF Grant DMS 2009647. TC, GR and AT thank Simons Foundation for partial support. All authors thank T. Bonnemain, S. Randoux and P. Suret for numerous useful discussions.\nData Availability All data analyzed during this study are included in this article.\nDeclarations\nConflicts of interest All authors declare that they have no conflicts of interest.\nOpenAccess This article is licensedunder aCreativeCommonsAttribution 4.0 InternationalLicense,which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/."
        },
        {
            "heading": "A Numerical Implementation of Soliton Gas",
            "text": "A.1 Riemann Problem\nThe realizations of the soliton gas are approximated numerically by the n-soliton solution\n\u03d5 \u2261 \u03d5n(x, t; \u03b71, . . . , \u03b7n, x01 , . . . , x0n ), n \u2208 N, (A.1)\nwhere the \u03b7i \u2019s and x0i \u2019s correspond, respectively, to the spectral parameters and the \u201cspatial phases\u201d of the solitons; \u03b7i < \u03b7i+1 by convention. The numerical implementation of (A.1) is described in Sect. A.3 below. The numerical solutions presented in this work are all generated with n = 200 solitons, unless otherwise stated.\nSince n is finite, the n-soliton solution reduces to a sum of separated solitons in the limit |t | \u2192 \u221e. By construction, we have in the limit t \u2192 \u00b1\u221e\n\u03d5n(x, t) \u223c n\u2211\ni=1 2\u03b72i sech\n2 [ \u03b7i (x \u2212 4\u03b72i t \u2212 x\u00b1i ) ] , (A.2)\nwhere x\u00b1i are the spatial phases of the i-th soliton at t \u2192 \u00b1\u221e. We then take the spatial phase in (A.1) to be x0i = (x\u2212i + x+i )/2.\nConsider a uniform soliton gas with the DOS u(\u03b7). Let the spectral parameters \u03b7i be distributed on + with density\n\u03c6(\u03b7) = u(\u03b7) \u03ba\n, \u03ba = \u222b\n+ u(\u03b7)d\u03b7, (A.3)\nwhere the normalization by the spatial density of solitons \u03ba ensures that \u03c6(\u03b7) is normalized to 1. It was shown in Gurevich et al. (2000) that the spatial density \u03ba is obtained if the phases x0i are uniformly distributed on the interval\nIs = [ \u2212 n 2\u03bas ,+ n 2\u03bas ] , \u03bas = \u222b + \u03b7 \u03c3(\u03b7) d\u03b7, (A.4)\nwhere \u03c3(\u03b7) is the spectral scaling function in the NDRs (2.9), (2.10) (y(\u03b7) in Gurevich et al. (2000) is given here by y(\u03b7) = u(\u03b7)\u03c3 (\u03b7)/\u03b7). The derivation of (A.4) has been revisited recently in the context of generalized hydrodynamics (Bonnemain et al. 2022): it was shown that \u03bas corresponds to the density of spatial phases x0i , or equivalently x\u00b1i which are well defined asymptotically (t \u2192 \u00b1\u221e) where the solitons are \u201cnon-interacting\u201d and their position is given by xi (t) \u223c 4\u03b72i t + x\u00b1i . In the rarefied gas limit, the interaction term in the NDR (2.9) is small and therefore \u03c3(\u03b7)u(\u03b7) \u2248 \u03b7 so that we obtain \u03bas = \u03ba as expected. In the general case, though the density \u03bas of noninteracting phases is different from the \u201cphysical\u201d density \u03ba , as demonstrated with the soliton condensate examples below. In the thermodynamic limit n \u2192 \u221e, the soliton solution (A.1) represents a realization of the uniform soliton gas.\nSince the number n of solitons is finite, the n-soliton solution has a finite spatial extent. By distributing the phases x0i uniformly on the interval Is , the n-soliton solution \u03d5n(x, t = 0) approximates a realization of the uniform soliton gas for x \u2208 [\u2212 /2, /2] where = n/\u03ba; \u03d5n(x, t = 0) \u223c 0 outside of this interval. This naturally generates the box-like initial condition for the kinetic equation\nu(\u03b7; x, t = 0) \u223c \u23a7\u23aa\u23a8 \u23aa\u23a9 0, x < \u2212 /2, u(\u03b7), \u2212 /2 < x < /2, 0, /2 < x .\n(A.5)\nNote that u(\u03b7; x, t = 0) = 0 can be seen as the genus 0 condensate where the end point of the central s-band \u03bb1 \u2192 0. This limits the type of initial condition that can be implemented for the Riemann problem and we choose in practice (N\u2212 = 0, q\u2212 = 0) or (N+ = 0, q+ = 0). For convenience, we shift the x-axis by \u00b1 /2 to obtain one of the discontinuities at the position x = 0.\nThe evolution in time of the soliton gas realization is obtained by varying the parameter t . Contrarily to a direct resolution of the KdV equation, via finite difference or spectral method, the time-evolution presented here is instantaneous and does not accumulate any numerical errors since the n-soliton solution is an exact solution. For the Riemann problem, themaximal time is bounded by the finite extent of the n-soliton solution: after a sufficiently long time, the two hydrodynamic states originating from the discontinuities at x = \u2212 /2 and x = /2 start interacting. Longer times can be reached by choosing a larger number of solitons n.\nWe consider now the DOS of interest for this work:\nu(\u03b7) = Cu(N )(\u03b7; \u03bb1, . . . \u03bb2N+1), C \u2264 1, (A.6)\nwhere u(N ) is DOS of the genus N condensate defined in Sect. 3. (A.4) rewrites\n\u03bas = \u03ba(C) 1 \u2212 C , \u03ba(C) = C \u222b + u(N )(\u03b7; \u03bb1, . . . , \u03bb2N+1)d\u03b7. (A.7)\nFigure 18 shows the comparison between the spatial density of solitons \u03ba and the density of phases \u03bas for the genus 0 case where \u03ba(C) = C/\u03c0 . The phases density \u03bas\ndiverges in the condensate limit C \u2192 1, and x0i \u2019s are all equal to the same phase x0 (Is \u2192 {x0}). This limit is in agreement with the results obtained in Sect. 4.1 for genus 0 and genus 1 condensates: each realization of the condensate (C = 1) is approximated by a coherent n-soliton solution where x0i = x0 = cst, \u2200i .\nExamples of numerical realizations of soliton condensates and diluted soliton condensates are given in Sects. 4.1, 6, 7 and in Appendix B. Figures 2, 4 and 20 show that numerical approximations of a condensate via the n-soliton solution are not exactly uniform; the realizations become more uniform near the center of the interval [\u2212 , ] as the number of soliton n increases.\nThe realization at t = 0 in Figs. 7, 8, 10 and 12 also displays the \u201cborder effects\u201d observed at the discontinuities of the Riemann problem initial condition (located at x = 0). These border effects, manifesting as overshoots of the realization, persist regardless of the number of solitons n as shown by the comparison between the 100-soliton and 200-soliton solutions in Fig. 19. However, because of their finite size, the observed border effects seem to have no effect on the asymptotic dynamics of the condensate as demonstrated by the very good agreement between the theory and the numerical solution in Sect. 6.\nA.2 Generation of Spectral Parameters i\nThe spectral parameters of the n-soliton solution are distributed with probability density \u03c6(\u03b7), cf. (A.3). This can be achieved by choosing the solutions of the nonlinear\nequation \u222b \u03b7i 0 \u03c6(\u03bc)d\u03bc = i n , i = 1, . . . , n. (A.8)\nFor genus 0 condensate whose DOS is given by (4.1), this equation reduces to\n1 \u2212 \u221a 1 \u2212 \u03b7 2 i\n\u03bb21 = i n . (A.9)\nFor genus 1 condensate with DOS (4.6), this equation reads\nU (\u03b7i ) U (\u03bb3) = i n , where: U (\u03b7) = \u222b \u03b7 0 u(1)(\u03bc; \u03bb1, \u03bb2, \u03bb3)d\u03bc. (A.10)\nWe have\nU (\u03b7) = \u222b \u03b7 0 i(\u03bc2 \u2212 w2) 2\u03c0 \u221a R(\u03bc) d(\u03bc2) = \u222b \u03b72 0 i(x \u2212 w2) 2\u03c0 \u221a (x \u2212 \u03bb21)(x \u2212 \u03bb22)(x \u2212 \u03bb23) dx, (A.11)\nwhich yields\nU (\u03b7) = U0\n+ \u23a7\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a8 \u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a9 \u2212 1 \u03c0 \u23a1 \u23a3 \u221a\u221a\u221a\u221a (\u03bb23 \u2212 \u03b72)(\u03bb21 \u2212 \u03b72) \u03bb22 \u2212 \u03b72 \u2212 \u03bb 2 1 \u2212 w2\u221a \u03bb23 \u2212 \u03bb21 F(\u03b2, q) \u2212 \u221a \u03bb23 \u2212 \u03bb21E(\u03b2, q) \u23a4 \u23a6 , 0 < \u03b7 < \u03bb1, 0, \u03bb1 < \u03b7 < \u03bb2, 1 \u03c0 \u23a1 \u23a3 \u03bb21 \u2212 w2\u221a\n\u03bb23 \u2212 \u03bb21 F(\u03ba, q) + \u03bb 2 2 \u2212 \u03bb21\u221a \u03bb23 \u2212 \u03bb21 (q, \u03ba, q)\n\u23a4 \u23a6 , \u03bb2 < \u03b7 < \u03bb3,\n(A.12)\nwhere\n\u03b2 = sin\u22121 (\u221a\n\u03bb21 \u2212 \u03b72 \u03bb22 \u2212 \u03b72\n) , \u03b20 = sin\u22121 ( \u03bb1\n\u03bb2\n) , (A.13)\n\u03ba = sin\u22121 (\u221a\n(\u03bb23 \u2212 \u03bb21)(\u03b72 \u2212 \u03bb22) (\u03bb23 \u2212 \u03bb22)(\u03b72 \u2212 \u03bb21)\n) , (A.14)\nq = \u03bb 2 3 \u2212 \u03bb22\n\u03bb23 \u2212 \u03bb21 , (A.15)\nU0= 1 \u03c0\n\u23a1 \u23a3 \u221a \u03bb23\u03bb 2 1\n\u03bb22 \u2212 \u03bb 2 1 \u2212 w2\u221a \u03bb23\u2212\u03bb21\nF(\u03b20, q)\u2212 \u221a \u03bb23 \u2212 \u03bb21E(\u03b20, q) \u23a4 \u23a6 . (A.16)\nA.3 Algorithm for the n-soliton Solution\nThe algorithm generating the exact n-soliton (A.1), originally developed in Huang (1992), relies on the Darboux transformation. This scheme is subject to roundoff errors during summation of exponentially small and large values for a large number of solitons n. We improve it following Gelash and Agafontsev (2018), with the implementation of high-precision arithmetic routine to overcome the numerical accuracy problems and generate solutions with a number of solitons n 10.\nIn order to simplify the algorithm, it is suggested to consider simultaneously the KdV equation (2.1) and its equivalent form\n\u03d5t \u2212 6\u03d5\u03d5x + \u03d5xxx = 0 (A.17)\nobtained from (2.1) by the reflection \u03d5 \u2192 \u2212\u03d5. The Darboux transformation presented here relates the Jost solution associated with the (n\u22121)-soliton solution of one equation, to the n-soliton solution of the other equation.\nConsidering the direct scattering problem for the Lax pair in the matrix form\nx = (\n\u03b7 \u22131 \u03d5 \u2212\u03b7\n) , (A.18)\nwith \u22121 corresponding to (2.1) and +1 to (A.17), the Jost solutions J , J\u0303 \u2208 R2\u00d72 are defined recursively by the Darboux transformations D(\u03b7) and D\u0303(\u03b7) such that:\nJn(\u03b7) = Dn(\u03b7)Jn\u22121(\u03b7), with: Dn(\u03b7) = I + 2\u03b7n \u03b7 \u2212 \u03b7n Pn, (A.19) J\u0303n(\u03b7) = D\u0303n(\u03b7) J\u0303n\u22121(\u03b7), with: D\u0303n(\u03b7) = I \u2212 2\u03b7n \u03b7 + \u03b7n P\u0303n . (A.20)\nPn(x, t) and P\u0303n(x, t) are independent of \u03b7 and have the form:\nPn = \u03c32 P\u0303Tn \u03c32 = Jn\u22121 (\u2212\u03b7n)\n(\u2212bn 1 ) ( bn 1 ) J\u0303\u22121n\u22121 (\u03b7n)\n( bn 1 ) J\u0303\u22121n\u22121 (\u03b7n) Jn\u22121 (\u2212\u03b7n) (\u2212bn 1 ) , (A.21)\nwith the real constants bn depending on the spatial phases\nbn = (\u22121)n exp ( 2\u03b7nx 0 n ) . (A.22)\nThe Jost solutions for the initial seed solution \u03d50 = 0 are given by:\nJ0(\u03b7) = J\u03030(\u03b7) = ( exp [ \u03b7x \u2212 4\u03b73t] \u2212 exp [\u2212\u03b7x + 4\u03b73t] 0 \u22122\u03b7 exp [\u2212\u03b7x + 4\u03b73t] ) , (A.23)\nand one can show that at each recursion step\n\u03d5n = \u03d5n\u22121 + 4\u03b7n (Pn)21 , (A.24)\nwhere \u03d5n is the n-soliton solution of (2.1) for n even and solution of (A.17) for n odd. Recently, a more efficient and accurate algorithm has been proposed in Prins and Wahls (2021) to generate the n-soliton KdV solution employing a 2-fold Crum transform."
        },
        {
            "heading": "B Genus 2 Condensate",
            "text": "In Fig. 20, a realization of the genus 2 soliton condensate is compared with the twophase KdV solution associated with the same spectral surface and equipped with an appropriately chosen initial phase vector. The two-phase solution has been computed numerically using the so-called trace formula (Novikov et al. 1984):\n\u03d5(x, t) = \u03bb21 \u2212 2 2\u2211 j=1\n( \u03bc2j (x, t) \u2212 \u03bb22 j + \u03bb22 j+1 2 ) , (B.1)\nwhere the auxiliary spectra \u03bc j (x, t) satisfy Dubrovin\u2019s ordinary differential equations:\n\u2202(\u03bc2j )\n\u2202x = 2\u03c3 j R\n( \u03bc j )\n\u220f2 j =k ( \u03bc2j \u2212 \u03bc2k ) , j = 1, 2, (B.2)\nwith \u03c3 = \u00b11 and\nR(\u03bc) = \u221a( \u03bc2 \u2212 \u03bb21 ) ( \u03bc2 \u2212 \u03bb22 ) ( \u03bc2 \u2212 \u03bb23 ) ( \u03bc2 \u2212 \u03bb24 ) ( \u03bc2 \u2212 \u03bb25 ) . (B.3)\nEach \u03bc j oscillates in the corresponding s-gap [\u03bb2 j\u22121, \u03bb2 j ] so that the sign of \u03c3 j changes every time\u03bc j changes the direction ofmotion at the gap end point.Weobserve that, to compute the KdV finite-gap solution corresponding to a given realization soliton condensate, all the initial phases \u03bc j (x0, t) must be placed at the edges of the corresponding s-gaps, while the choice of the gap\u2019s edge (right/left) is determined by the number of discrete eigenvalues (odd/even) that are located within the s-band [\u03bb2 j , \u03bb2 j+1] in the numerical construction of the condensate."
        }
    ],
    "title": "Dispersive Hydrodynamics of Soliton Condensates for the Korteweg\u2013de Vries Equation",
    "year": 2023
}