{
    "abstractText": "Model predictive control (MPC) based on long prediction horizons can address the inherent non-minimum phase (NMP) behavior issue of DC/DC boost converters. However, the response time of the controller will increase since the long prediction horizons result in a high computational burden. To solve this problem, a non-minimum phase behavior improving (NPI) MPC with a single prediction horizon is proposed in this paper. Firstly, the actual cause behind the NMP behavior is analyzed. Afterward, the difference equation is modified according to the analysis and then used in the NPI-MPC. In addition, a fixed switching frequency is generated based on the value of the duty cycle, which is realized in the NPI-MPC algorithm and a modulation. Moreover, a weighting factorsdesign guideline based on the stability criterion of a Jacobian matrix is provided. It effectively reflects the impact and sensitivity of different weighting factors on stability. Finally, we conclude this paper by validating the proposed NPI-MPC method and the weighting factors-design guidelines with the results obtained under experimental conditions.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yuan Li"
        },
        {
            "affiliations": [],
            "name": "Subham Sahoo"
        },
        {
            "affiliations": [],
            "name": "Yichao Zhang"
        }
    ],
    "id": "SP:9fc9f4c76d116112f9c0742b05adef7716e8af1d",
    "references": [
        {
            "authors": [
                "J.M. Guerrero",
                "J.C. Vasquez",
                "J. Matas",
                "et.al"
            ],
            "title": "Hierarchical control of droop-controlled ac and dc microgrids\u2014a general approach toward standardization,",
            "venue": "IEEE Trans Ind. Electron.,",
            "year": 2011
        },
        {
            "authors": [
                "T. Dragi\u010devi\u0107",
                "X. Lu",
                "J.C. Vasquez",
                "et.al"
            ],
            "title": "DC microgrids\u2014Part I: A review of control strategies and stabilization techniques,",
            "venue": "IEEE Trans Power Electron.,",
            "year": 2016
        },
        {
            "authors": [
                "Z. Karami",
                "Q. Shafiee",
                "S. Sahoo"
            ],
            "title": "Hybrid model predictive control of DC-DC boost converters with constant power load,",
            "venue": "IEEE Trans. Energy Convers.,",
            "year": 2021
        },
        {
            "authors": [
                "T. Dragi\u010devi\u0107",
                "S. Vazquez",
                "P. Wheeler"
            ],
            "title": "Advanced control methods for power converters in DG systems and microgrids,",
            "venue": "IEEE Trans Ind. Electron.,",
            "year": 2021
        },
        {
            "authors": [
                "V. Paduvalli",
                "R.J. Taylor",
                "P.T. Balsara"
            ],
            "title": "Analysis of zeros in a boost DC-DC converter: state diagram approach",
            "venue": "IEEE Trans. Circuits Syst., II, Exp. Briefs, vol. 64, no. 5, pp. 550\u2013554, May 2017.",
            "year": 2017
        },
        {
            "authors": [
                "R.J. Wai",
                "L.C. Shih"
            ],
            "title": "Design of voltage tacking control for DC- DC boost converter via total sliding-mode technique",
            "venue": "IEEE Trans Ind. Electron., vol. 58, no. 6, pp. 2502\u20132511, Jun. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Kouro",
                "P. Cortes",
                "R. Vargas",
                "et.al"
            ],
            "title": "Model predictive control: A simple and powerful method to control power converters",
            "venue": "IEEE Trans. Ind., vol. 56, no. 6, pp. 1826-1838, Jun. 2009.",
            "year": 1826
        },
        {
            "authors": [
                "S. Vazquez",
                "J. Rodriguez",
                "M. Rivera",
                "et.al"
            ],
            "title": "Model predictive control for power converters and drives: Advances and trends,",
            "venue": "IEEE Trans. Ind.,",
            "year": 2017
        },
        {
            "authors": [
                "T. Dragi\u010devi\u0107"
            ],
            "title": "Dynamic stabilization of DC microgrids with predictive control of point of load converters",
            "venue": "IEEE Trans Power Electron., vol. 33, no. 12, pp. 10872\u201310884, Dec. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "O. Andr\u00e9s-Mart\u0131\u0301nez",
                "A. Flores-Tlacuahuac",
                "O.F. Ruiz-Martinez et.al"
            ],
            "title": "Nonlinear model predictive stabilization of DC\u2013DC boost converters with constant power loads,",
            "venue": "Journ. Emerg. Sel. Topics Power Electron.,",
            "year": 2021
        },
        {
            "authors": [
                "P. Karamanakos",
                "T. Geyer",
                "S. Manias"
            ],
            "title": "Direct voltage control of DC- DC boost converters using enumeration-based model predictive control,",
            "venue": "IEEE Trans Power Electron.,",
            "year": 2014
        },
        {
            "authors": [
                "A. Ayad",
                "P. Karamanakos",
                "R. Kennel"
            ],
            "title": "Direct model predictive current control strategy of quasi-Z-source inverters,",
            "venue": "IEEE Trans Power Electron.,",
            "year": 2017
        },
        {
            "authors": [
                "P. Karamanakos",
                "T. Geyer",
                "R.P. Aguilera"
            ],
            "title": "Long-horizon direct model predictive control: modified sphere decoding for transient operation",
            "venue": "IEEE Trans. Ind. Appl., vol. 54, no. 6, pp. 6060\u20136070, Nov.-Dec. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "E. Zafra",
                "S. Vazquez",
                "C. Regalo"
            ],
            "title": "Parallel sphere decoding algorithm for long-prediction-horizon FCS-MPC,",
            "venue": "IEEE Trans Power Electron.,",
            "year": 2022
        },
        {
            "authors": [
                "F.A. Villarroel",
                "J.R. Espinoza",
                "M.A. P\u00e9rez"
            ],
            "title": "Stable shortest horizon FCS-MPC output voltage control in non-minimum phase boosttype converters Based on Input-State Linearization,",
            "venue": "IEEE Trans. Energy Convers.,",
            "year": 2021
        },
        {
            "authors": [
                "N. Guler",
                "S. Biricik",
                "S. Bayhan",
                "H. Komurcugil"
            ],
            "title": "Model predictive control of DC-DC SEPIC converters with auto-tuning weighting factor",
            "venue": "IEEE Trans. Ind., vol. 68, no. 10, pp. 9433\u20139443, Oct. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Novak",
                "U.M. Nyman",
                "T. Dragicevic",
                "et.al"
            ],
            "title": "Analytical design and performance validation of finite set MPC regulated power converters,",
            "venue": "IEEE Trans. Ind., vol. 66,",
            "year": 2019
        },
        {
            "authors": [
                "P. Cortes",
                "G. Ortiz",
                "J.I. Yuz",
                "et.al"
            ],
            "title": "Model predictive control of an inverter with output LC filter for UPS applications",
            "venue": "IEEE Trans. Ind., vol. 56, no. 6, pp. 1875\u20131883, Jun. 2009.",
            "year": 1875
        },
        {
            "authors": [
                "F. Villarroel",
                "J.R. Espinoza",
                "C.A. Rojas",
                "et.al"
            ],
            "title": "Multiobjective switching state selector for finite-states model predictive control based on fuzzy decision making in a matrix converter",
            "venue": "IEEE Trans. Ind., vol. 60, no. 2, pp. 589\u2013599, Feb. 2013.",
            "year": 2013
        },
        {
            "authors": [
                "J. Rodriguez",
                "P. Cortes"
            ],
            "title": "Predictive control of power converters and electrical drives",
            "venue": "Hoboken, NJ, USA: Wiley,",
            "year": 2012
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Model predictive control; non-minimum phase behavior; boost converter; fixed switching frequency; weighting factors.\nI. INTRODUCTION\nW ITH the increased renewable energy generation, es-pecially photovoltaics (PV), and energy storage modules, DC microgrids are gaining more attention [1]-[4]. Since DC/DC boost converters can provide a higher output voltage to be integrated into a standardized system, they act as one of the most common interfaces in DC microgrids [5].\nBecause the inherent non-minimum phase (NMP) behavior in the boost converter, it poses challenges in the design of the controller. Compared with the traditional PI controller [6]- [7], non-linear controllers can describe the nonlinear nature of the converters and exhibit better dynamic performance [8]- [10]. Among these control methods, the conventional slidingmode control utilizes the inductor current control scheme for the boost converter, which performs good robustness. However, it will make the control signal calculation complex and suffer from the chattering issue [8]-[9]. Considering fuzzy controllers, they show better nonlinear representation ability and cope well with the NMP issue. However, the number of fuzzy rules is designed empirically which can not apply to different conditions [10]. Moreover, if the fuzzy rules increase, the control performance is better but with a heavy computational burden. Recently, the model predictive control (MPC) has extended its applications in power converters with fast response, explicit control constraints, and easy implementation, which attracts more attention [11]-[13].\nTo address the NMP problem in a boost converter, previous studies prefer to utilize long prediction horizons based MPC [14]-[16], resulting in high computational complexity and long control response time. To arrange for a short computation time, it can be carried out from the decoding aspect and the control aspect. For the decoding aspect, the sphere decoding algorithm is incorporated into the MPC [17]-[19], which avoids traversing all candidates. However, the digital controller needs to be designed to realize the decoding algorithm [19]. From the control aspect, the direct solution is to adopt the single prediction horizon [20]-[22]. An input state linearization is used to solve the NMP behavior for the boost converter [20]. In addition, only inductor current controlled based MPC with a single prediction horizon is presented to weaken the influence of NMP behavior [21]. However, an observer should be adopted to compensate for the dynamic performance\u2019s degradation resulting from the lack of capture for the output voltage varying. A PI generated current reference based MPC is proposed to perform an accurate control [22]. Nevertheless, the dynamic response speed will deteriorate with the introduction of the PI module. Therefore, an efficient and simply designed MPC is urgent.\nAnother problem in conventional MPC is the inherent variable switching frequency. When the switching frequency varies during the operation, it will lead to non-uniform inductor current ripples and may lead to a saturation boundary which complicates the design of inductance and in general increases the maximum ripple in the inductor current. Besides, when the frequency changes, the converter may change from the current continuous conduct mode to the discontinuous conduct mode, which brings challenges to the predictive model of MPC [21], [22]. Hence, to generate a fixed switching frequency, the modulation is commonly used in MPC which is regarded as the continuous control set (CCS)-MPC [21]. The switching frequency is decided by the frequency of the carrier wave. Another modulation free MPC is provided for the DC/DC SEPIC converter [22]. By introducing the inductor current variation into the cost function, it achieves control of the fixed switching frequency. However, the switching frequency will fluctuate during the variation of the system\u2019s parameters.\nAlthough the MPC algorithm is widely used for power converters, weighting factors design issues that are closely related to its performance have not been fully addressed [23]. Hence, some methods for coping with the weighting factors design issues are produced [24]-[27]. For instance, to avoid utilizing the weighting factors, the cost function is designed as the error between the single predicted value and\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n2 its reference [24]. Nevertheless, it cannot be realized with multi-objective optimization issues. Another approach utilizes a fuzzy multi-criteria decision making method controlling the direct matrix converter [25]. Instead of the weighting factors, the membership functions are adopted, which are defined as the relationship between the predicted value, and the maximum, and minimum values of the state variables. Finally, the optimal control switching state is decided by the value of the membership function with all candidates. However, it still needs priority coefficients for control objectives to be chosen.\nNormally, the selection of weighting factors are empirical, which lacks of design guidelines. With the mature of the artificial intelligence (AI) techniques, another solution gets more attentions. The AI-based solution is with numerous simulations and concluds with an optimal combination of weighting factors [12], [27]. Ref [27] utilizes an ANN-based algorithm to select the weighting factors, which costs less time than the numerous simulations-based method. In summary, the existing weighting factors design methods are mostly dependent on large numbers of data, where the design process is based on a data-driven model instead of a system model. Thus, it is necessary to find a design framework, which can reveal the essence of the effects of the weighting factors.\nTo address the above mentioned challenges, this paper proposes a non-minimum phase behavior improving (NPI)MPC algorithm for a boost converter with a single prediction horizon. The main contributions are listed as:\n1) A modified difference equation for the inductor current is proposed after analyzing the actual cause behind the NMP behavior. Based on this, an NPI-MPC with a single prediction horizon is proposed, where the NMP behavior has substantially less influence in the system. Moreover, this paper derives the optimal duty cycle from the proposed MPC and then generates a fixed switching frequency, which acts as a fundamental requirement for further modeling and stability analysis.\n2) The model of the NPI-MPC controlled boost converter is presented. Based on the model, this paper proposes a weighing factor selection method which utilizes a Jacobian matrix to assess the stability. Finally, by calculating the eigenvalues of the Jacobian matrix, the selection of the weighting factors and the design of the parameters are provided to guarantee stability.\nThe rest of the paper is organized as follows. Section II illustrates the discrete model of the boost converter. Section III proposes the NPI-MPC algorithm. Section IV presents the model of the proposed method and gives the guideline for selecting weighting factors. Experiments are supplemented in Section V. Section VI concludes the paper."
        },
        {
            "heading": "II. DC-DC BOOST CONVERTER DESCRIPTION",
            "text": "The studied system is shown in Fig. 1. The equivalent diagram of the boost converter in different switching periods is demonstrated in Fig. 2. According to the operating principle, the following equation can be obtained:\ndVo dt = 1\u2212 d C iL(k)\u2212 1 RC Vo(k) (1)\ndiL dt = 1 L Vg \u2212 1\u2212 d L Vo(k) (2)\nwhere d is the duty cycle. Assuming that the sampling frequency is relatively high, the state variables dVo/dt in (1) can be transformed into a discrete-time equation with the classical forward Euler approximation method. It is expressed as:\nVo(k + 1) = Vo(k) + 1\u2212 d C iL(k)Ts \u2212 1 RC Vo(k)Ts (3)\nSimilarly, the difference equation of the inductor current can be derived as:\niL(k + 1) = iL(k)\u2212 1\u2212 d L Vo(k)Ts + 1 L VgTs (4)\nBased on (3) and eq. (4), the output voltage and inductor current in the next sampling time can be predicted which also provide the control objectives of MPC."
        },
        {
            "heading": "III. PROPOSED NPI-MPC ALGORITHM",
            "text": "This section explains the design process of the proposed NPI-MPC algorithm in the following steps. Firstly, the NMP behavior with direct voltage/current MPC is presented and the actual cause of this instability is analyzed. Based on the analysis, the proposed NPI-MPC is implemented."
        },
        {
            "heading": "A. Analysis of Direct Voltage/Current MPC",
            "text": "Usually, the control purpose of the converter is to provide a stable and tightly regulated output voltage for the load. Thus, the most direct cost function is to control the output voltage. Then, we can obtain:\nJ = N\u2211 i=1 (Vo(k + i)\u2212 V \u2217o )2 (5)\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n3 0.1 Time (s) 0.20 0.3 0.4 60 80 V o (V ) 100 50 110 70 90\nFig. 3. Output voltage fails to track the reference at 0.1 s in the boost converter with a single prediction horizon.\nwhere N is the prediction horizon. However, as Fig. 3 shows, when the MPC algorithm adopts a single prediction horizon (from N=3 to N=1) at 0.1 s, the output voltage falls and fails to track the voltage reference which is 100 V, and finally stays at 57 V. Although the long prediction based MPC can improve this instability, the computation burden will further increase. Fig. 4 shows the stages with different prediction horizons based on MPC. As seen, with the increase of the prediction horizon, the cost function contains more predicted values, which are obtained by the prediction model in a stepwise manner. Hence, it is obvious that the computation process with a single prediction horizon is with less time consumption and computation burden as compared to long prediction horizons. Another approach used widely is the direct inductor current MPC, which is based on the following prediction model [21]- [22]:\nJ = (iL(k + i)\u2212 i\u2217L)2 (6)\nHowever, without compensating the inductor current reference, a stationary error still exists as Case II in Fig.5 shows. Therefore, the MPC algorithm based on the above cost functions cannot regulate a preset output voltage."
        },
        {
            "heading": "B. Analysis of the Non-minimum Phase Dynamics",
            "text": "To address the above problem without consuming a long prediction horizon, the reason behind the NMP behavior should be studied first. The following equation shows the relationship between the duty cycle and the output voltage transfer function of the boost converter in the s-domain [10]:\nGvd(s) = Vg 1\u2212D1 (1\u2212D1)2R\u2212 Ls [LCRs2 + Ls+ 1\u2212D1)2R] (7)\nHere, D1 is the stable state value of the duty cycle, and s represents the s-domain variable. Since the zero in (7) which equals (1 \u2212 D1)2R/L lies in the right half-plane, the boost converter is an NMP system. Due to the conventional unconstrained one short horizon, MPC behaves as an input-output linearizing controller [28]. When using the single prediction horizon cost function in (5), it will lead to instability because of the unstable zero dynamics that exists in the NMP system [20].\nAlthough the NMP behavior exists in (7), when we consider the relationship between the duty cycle and the inductor current transfer function of a boost converter in the s-domain, we obtain:\nGid(s) = Vg 1\u2212D1 CRs+ 2 [LCRs2 + Ls+R(1\u2212D1)2] (8)\nAs evident from (8), the zero is in the left half-plane, which means if only the inductor current is introduced in the control\nloop to generate the control signal, the system is stable. It seems that the output voltage is not necessary for this cost function and the NMP behavior can be avoided. However, when considering the difference equation in (4), it is intuitive that the output voltage is also adopted to generate the duty cycle. Hence, without modifying the prediction differential equation, the NMP behavior will still severely influence the system."
        },
        {
            "heading": "C. Design of the Proposed NPI-MPC",
            "text": "Usually, in the conventional PI control method, through the design of the compensation network and parameters whose essence is to cancel the pole-zero placement in the right-half plane, the influence of the unstable behavior will be reduced. Inspired by this, the design of the prediction differential equation can also be realized to weaken the influence of NMP behavior. Besides, the dynamic response across the converter output should not be sacrificed. To this end, this paper proposes a difference equation for the inductor current. According to the power balance, the total input power equals the output power neglecting the power conversion losses, we obtain:\nVgiL(k) = Vo(k)io(k) (9)\nwhere io(k) is the output current in the real system. And the difference equation can be transformed as:{\niL(k + 1) = iL(k)\u2212 ( 1\u2212dL \u221a iL(k)Vg Vo(k) io(k) + 1LVg)Ts Vo(k + 1) = Vo(k) + ( 1\u2212d C iL(k)\u2212 io(k) C )Ts\n(10) As seen, (10) avoids only using the output voltage Vo(k) at k instant when predicting the inductor current iL(k + 1) in the next sampling time. The item Vo(k)/io(k) in (10) equals the load resistance and it will not introduce instability into the system. Besides, to avoid the sluggish dynamic performance when the output voltage reference or load is changed, the output voltage Vo(k + 1) is also predicted. Hence, based on the proposed prediction model, it can not only weaken the NMP behavior accompanying the boost converter but can also ensure the dynamic performance of the system.\nThe cost function is established based on the predicted values and the desired reference. Thus, the cost function J contains the predicted value from (10) and uses the quadratic error as:\nJ =(iL(k)\u2212 1\u2212 d L\n\u221a iL(k)Vg Vo(k)\nio(k) Ts +\n1 L VgTs \u2212 i\u2217L)2\n+ (Vo(k) + 1\u2212 d C iL(k)Ts \u2212 io(k) C Ts \u2212 V \u2217o )2\n(11) where, the output voltage reference V\u2217o is predefined and the inductor current reference i\u2217L is determined as V \u2217 oio/Vg . As seen, the studied system contains two control objectives. To compensate for the difference in the natural characteristics of different control objectives and ensure control performance,\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n4 k k+1 k+2 k+3 Vo(k) Vo(k+1) dopt(k+1) Vo(k+2) sample modulation\nPrediction horizon\nmin J1\nSingle prediction horizon\n...\n* 2\n1\n2 * 2\n2\n1\n3 * 2\n3\n1\n( ( 1) )\n( ( ) )\n( ( ) ) ...\no o\no o\ni\no o\ni\nJ V k V\nJ V k i V\nJ V k i V\n=\n=\n= + \u2212\n= + \u2212\n= + \u2212\n\n\n...\nprediction\ndopt(k+1)\nmin J2prediction\nmodulation dopt(k+1)\ndopt(k+1)min J3prediction\nmodulation dopt(k+1)\nVo(k+1)\nFig. 4. Computation process with different prediction horizons.\nTABLE I SYSTEM PARAMETERS.\nParameters Symbols Values Input voltage Vg 50 V\nOutput voltage Vo 100 V Inductance L 1 mH Capacitor C 2000 \u00b5F\nSwitching cycle Ts 50 \u00b5s Output power P 200 W\nReference inductor current i\u2217L V \u2217 oio(k)/Vg\nReference output voltage V\u2217o 100 V\nthe weighting factors are introduced to the cost function. It can be expressed as:\nJ =\u03bb1(iL(k)\u2212 1\u2212 d L\n\u221a iL(k)Vg Vo(k)\nio(k) Ts +\n1 L VgTs \u2212 i\u2217L)2\n+ \u03bb2(Vo(k) + 1\u2212 d C iL(k)Ts \u2212 io(k) C Ts \u2212 V \u2217o )2\n(12) where \u03bb1 denotes the weighting factor for the inductor current objective and \u03bb2 denotes the weighting factor for the output voltage objective. The selection of the weighting factor will be discussed in the following part.\nTo make a comparison between the proposed NPI-MPC and only the inductor current control (ICC) based MPC in (6) and (11), Fig. 5 shows the output voltage and uses the parameters in Table I. As seen, although the MPC algorithm with the cost function in (6), which only controls the inductor current can weaken the influence of the NMP behavior, it still cannot guarantee the control accuracy of the output voltage within one prediction horizon. When adopting the proposed control algorithm, it shows a good tracking ability for the output voltage. Another comparison will be discussed between the algorithm used in [22] which utilizes a PI controller to generate the current reference i\u2217L. With the introduction of the PI controller, it compensates for the NMP behavior, the output voltage can track the reference well. However, it will reduce the dynamic response speed. The comparison between this PI generated current reference method and the proposed one will be provided in the experiments part.\n0 0.20.1\n120\n80\nV o (V\n)\n100\nZoom\n99.6\nICC-MPC\nNPI-MPC\n99.5\nTime (s)\nZoom\n94.3\n94.4\n0.10020.1001 0.1\n0.10020.1001 0.1\nFig. 5. Output voltage of the NPI-MPC method and the inductor current control based MPC (ICC-MPC) method."
        },
        {
            "heading": "IV. STABILITY ANALYSIS",
            "text": "To guarantee the stable operation of the proposed NPI-MPC, a stability analysis is necessary. However, due to the strong non-linear characteristics which the optimization process performs, the modeling of the NPI-MPC is challenging. In this part, the model of the NPI-MPC controlled boost converter is established through the process of deriving the optimal control variable. After building the entire model, the weighting factors are designed according to its model-based stability."
        },
        {
            "heading": "A. Modeling of the proposed NPI-MPC",
            "text": "The modeling process of the controller is to find the relation between its input and output. In the proposed NPI-MPC, the optimal control variable can be obtained by calculating the derivative of the cost function with respect to duty cycle d which then equals zero and is expressed as:\n\u2202[\u03bb1(iL(k + 1)\u2212 i\u2217L)2 + \u03bb2(Vo(k + 1)\u2212 V \u2217o )2] \u2202d = 0 (13)\nCombining (10) with (13), d can be derived as:\nd = (iL(k)\u2212m1 + 1LVgTs \u2212 i \u2217 L)m1\n\u2212m21 \u2212m22\n\u2212 (Vo(k)(1\u2212 io(k)Vo(k)CTs +m2 \u2212 V \u2217 o ))m2\n\u2212m21 \u2212m22\n(14)\nwhere m1 = \u221a\niL(k)VgVo(k)/io(k)Ts/L, m2 = iL(k)Ts/C. To clarify whether the cost function J equals its minimum\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n5\nvalue when adopting the optimal variable d, the second derivative is utilized as follows:\n\u22022J \u2202d2 = 2 d L2 iL(k)Vg io(k) Vo(k) T 2s + 2 d C2 iL(k) 2T 2s > 0 (15)\nwhere d lies within (0, 1). According to (15), the secondorder derivative of the cost function with respect to control variable d is positive. Hence, the cost function will achieve its minimum value when adopting the derived optimal variable d."
        },
        {
            "heading": "B. Stability analysis with different weighting factors",
            "text": "The flowchart of the proposed NPI-MPC is provided in Fig. 6 and the calculation process is presented in Table II. Based on this, the closed-loop transfer function can be obtained by introducing a small signal disturbance. However, the strong nonlinear calculation process in (14) makes it difficult to derive the transfer function without solving high order equations. Therefore, the Jacobian matrix is employed in this paper for the stability analysis method which avoids solving complicated nonlinear equations. The essence of the Jacobian matrix is to fit as close as possible to the desired function near the stable operating point. For the studied system, the function near the stable state point can be expressed as:[\niL(k + 1) Vo(k + 1)\n] = [ F [iL(k), Vo(k)] G[iL(k), Vo(k)] ] \u2248 [ F (IL, Vo) G(IL, Vo) ] + Jm [ F (iL(k), Vo(k)) G(iL(k), Vo(k))\n] (16) where F and G are the difference equations of the inductor current and output voltage in eq. (10). Jm is the Jacobian matrix. According to the expression of the differential equations in (10), the expression of the Jacobian matrix is expressed as follows:\nJm = [ Jm11 Jm12 Jm21 Jm22 ] = [ \u2202iL(k+1) \u2202iL(k) \u2202iL(k+1) \u2202Vo(k)\n\u2202Vo(k+1) \u2202iL(k) \u2202Vo(k+1) \u2202Vo(k)\n] (17)\nJm11 - Jm22 are derived as: Jm11 = 1\u2212 (1\u2212d)Ts \u221a Vg Vo(k) io(k) 2L \u221a iL(k) + \u2202d\u2202iL(k) \u221a iL(k)Vg Vo(k) io(k) Ts Jm12 = \u2202d \u2202Vo(k) \u221a iL(k)Vg Vo(k) io(k) Ts Jm13 = 1 CTs \u2212 iL C Ts \u2202d \u2202iL(k)\n\u2212 dCTs Jm14 = 1\u2212 iL(k)C \u2202d \u2202Vo(k)\nTs \u2212 io(k)Vo(k)CTs (18)\nNoticing that the derivative of the inductor current iL(k) and the output voltage Vo(k) at the k th instant with respect to the optimal control variable d can be derived from (14) as:{\n\u2202d \u2202iL(k) = 1g2 ( \u2202f \u2202iL(k) g \u2212 \u2202g\u2202iL(k)f)\n\u2202d \u2202Vo(k) = 1g2 ( \u2202f \u2202Vo(k) g \u2212 \u2202g\u2202Vo(k)f)\n(19)\nwhere f and g are the numerator and denominator of d in (14) respectively, and the derivatives in (19) are expressed in (20). \u2202f \u2202iL(k) = \u03bb1( 3 2m1 \u2212m 2 1 + ( m21 2 \u2212 i\u2217LTs 2L ) \u221a Vg Vo(k) io(k) iL(k) \u2212\u03bb2( 1CVo(k)Ts +m 2 2 \u2212 io(k) Vo(k)C2 Vo(k)T 2 s \u2212 V \u2217o C Ts) \u2202f \u2202Vo(k) = \u2212\u03bb2(m2 \u2212 io(k)Vo(k)C2iL(k)T 2 s ) \u2202g \u2202iL(k) = \u2212\u03bb2 2C2 iL(k)T 2 s \u2212 \u03bb1m21\n\u2202g \u2202Vo(k)\n= 0 (20)\nReplacing the sampling values iL(k) and Vo(k) with stable state values IL and Vo, four parameters Jm11 - Jm12 can be obtained. The stability criterion is satisfied when the eigenvalues are in the unit circle. Otherwise, it is unstable. Fig. 7(a) provides the eigenvalue e1 derived from the Jacobian matrix in (17). To simplify the calculation, we determine that \u03bb2 equals\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n6 the unit value. When the ratio of the weighting factors \u03bb1 and \u03bb2 changes from 0 to 10 (\u03bb1 changes from 0 to 10), the amplitudes of the eigenvalue e1 are always lower than the unit value, so it will not influence the system\u2019s stability. Taking eigenvalue e2 into consideration in Fig. 7(b), it is evident that the amplitude of the eigenvalue will exceed the unit value with the \u03bb1 ratio smaller than 0.25.\nThe trend can be described as: with the growth of the weighting factor ratio \u03bb1 to \u03bb2, the amplitude of the eigenvalue e2decreases, while the amplitude of the eigenvalue e2 increases when the ratio decreases. This phenomenon can be explained according to equations (7), (8), and (12). The weighting factor \u03bb1 determines the weight for the control of the inductor current control in the cost function where it will not lead to instability when operating. However, the weighting factor \u03bb2 denotes the weight for the output voltage control in the cost function. It will lead to instability when operating because of the unstable behavior existing in the control of the output transfer function in (7). Hence, when it increases, the system tends to be unstable.\nFig. 8 shows the output voltage based NPI-MPC with different weighting factors in the stable state and unstable state, respectively. It can be seen when the \u03bb1 is larger than 0.25 and equals 6.67, the system can track the output voltage reference stably and accurately. However, when the \u03bb1 is smaller than 0.25 which equals 0.15, the output cannot track the reference well.\nC. Inductance and Capacitor Design\nIn the design process, the selection of passive components is important which closely influences the system\u2019s performance. In this part, the stability of the various inductances and capacitors with different weighting factors are assessed to compare the stable boundary. As seen in Fig. 9(a), the colored region presents the stable region, and the blank part presents\n120\n80\nV o (V\n)\n100\n\u03bb1 =6.67 \u03bb2=1\n\u03bb1 =0.15 \u03bb2=1\n93.9\n0.10010.1 0.1\n0 0.20.1 Time (s)\nZoom\nZoom\n0.10020.10010.1 99.5\n99.6\n93.8\nFig. 8. The output voltage of NPI-MPC controlled boost converter using different weighting factors.\nthe unstable region with various inductances. When \u03bb1 is larger than 0.4, it shows that the system will be stable if the inductance changes from 500 \u00b5H to 1.5 mH. When \u03bb1 is smaller than 0.4, with the increase of the inductances the stability region is decreased. Similarly, in Fig. 9 (b), the\ncolored region presents the stable region, and the blank part shows the unstable region with various capacitors. When \u03bb1 changes from 0.2 to 2, it shows that the stable region will increase if the capacitor increases from 500 \u00b5F to 2.5 mF. Fig. 10 shows the output voltage with the same weighting factors, \u03bb1 = 0.3 and \u03bb2 = 1, and different inductance L = 500 \u00b5H and L = 1.5 mH which are from stable and unstable regions in Fig. 10 (a) respectively. It shows that the output voltage is well tracked when using the inductance L = 500 \u00b5H. Fig. 10 (b) shows the output voltage with the same weighting factors, \u03bb1 = 0.6 and \u03bb2 = 1, and different capacitors C = 1 mF and C = 500 \u00b5F which are from stable and unstable regions in Fig. 10(b) respectively. It shows that the output voltage reference is well tracked when using the capacitor C = 1 mF.\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n7 120\n80\nV o (V\n)\n100\n0 Time (s)\n0.20.1\nL=1.5mF L=500\u03bcH\n95.2\n95.1\nZoom\nZoom\n99.6\n99.5\n0.10020.10010.10.10020.10010.1\n(a) Output voltage with inductance L = 500 \u00b5H and L = 1.5 mH with \u03bb1 = 0.3, \u03bb2 = 1.\n0 Time (s) 0.20.1\n120\n80\nV o (V\n)\n100\nC=1mF C=500\u03bcF\n0.10020.1 0.10010.1\n90.5 99.6\nZoom\nZoom\n0.1002 90.3\n99.5 0.1001\n(b) Output voltage with capacitor C = 1 mF and C = 500 \u00b5F with \u03bb1 = 0.6, \u03bb2 = 1."
        },
        {
            "heading": "V. EXPERIMENTS",
            "text": "To verify the proposed NPI-MPC algorithm and the above analysis, a boost converter with 50 V input and 100 V output was built in the lab. The DC source is supported by a Delta Elektronika SM 600-10 dc power supply. The dSPACE DS1202 board is used to implement the NPI-MPC algorithm. Besides, a PWM Generation is used to generate a 20-kHz symmetrical sawtooth for generating the desired PWM. Fig. 11 shows the experimental prototype. Table I shows the system\u2019s parameters and the control parameters.\ndSPACE 1202\nInductance\nLEM box\nConverter\nPWM\nDC source\nScope\nControl desk\nElectronic\nload\nOscilloscope\nFig. 11. Experimental set up."
        },
        {
            "heading": "A. Case Study 1: Comparison between proposed NPI-MPC and conventional MPC algorithm",
            "text": "This case makes a comparison between the proposed NPIMPC algorithm and the conventional MPC based on (5) of the boost converter. According to the results in Fig. 12 (a), when adopting the conventional MPC, the output voltage cannot track its reference. When replacing with the proposed NPIMPC in Fig. 12 (b), the output voltage tracks the reference.\nVo :(50 V/div)\niL:(500 mA/div)\nTime:(40 \u03bcs/div)\nVo :(50 V/div)\niL:(2 A/div)\nTime:(20 ms/div) 60 V\n60 V 100 V\nNPI-MPC enabled\n(a) Conventional MPC. (b) Change from the conventional MPC to the NPIMPC.\nFig. 12. Behavior of the conventional MPC and the proposed NPI-MPC.\nAs seen, the NPI-MPC can prevent the tracking failure of the output voltage caused by the NMP behavior."
        },
        {
            "heading": "B. Case Study 2: The NPI-MPC controlled Boost converter with input and output step",
            "text": "Fig. 14. Output voltage Vo and inductor current iL with the proposed NPIMPC during voltage reference steps.\nVo :(25 V/div)\niL:(2 A/div)\nTime:(200 ms/div)\nVo :(25 V/div)\niL:(2 A/div)\nTime:(200 ms/div)Vg :(25 V/div) Vg :(25 V/div)\n(a) Input voltage steps from 50 V to 40 V. (b) Input voltage steps from 40 V to 50 V.\nFig. 15. Output voltage Vo and inductor current iL with the proposed NPIMPC during input voltage steps.\nThe second case provides a load step, output voltage reference step, and input voltage change with the NPI-MPC and weighting factors \u03bb1 = 2, \u03bb2 = 1. The output power of the load steps from 100 W to 200 W and 200 W to 100 W in Fig. 13. According to the results, when the output power changes, it only takes a few switching cycles, which is approximately 450 \u00b5s and 500 \u00b5s to adjust the inductor current into the\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n8 stable state without obvious overshoot concerns. Besides, the average frequency can be evaluated as 1/(449.5 \u00b5s/9) = 20 kHz, 1/(505.5 \u00b5s/10) = 19.8 kHz and they are approximately equal to the desired 20 kHz. Fig. 14 presents the dynamic process when the output voltage reference changes from 70 V to 120 V and 120 V to 70 V with the same weighting factors. As seen, with the NPI-MPC, the system can track the output voltage reference accurately. Fig.15 studies the behavior of output voltage when input voltage steps from 50 V to 40\nV and 40 V to 50 V. As observed, the output voltage can maintain its reference value without any overshoot concerns, which shows a good adjusting ability."
        },
        {
            "heading": "C. Case Study 3: Comparison study",
            "text": "Given to the methods in [20] and [21] employ a complicated design process, it is not necessary to compare because the proposed one is easier to implement. Hence, this case compares the method in [22] which used the PI to generate a current reference and established a tunable switching frequency. The parameter of the PI module is selected as Kp = 0.1, Ki = 10. The comparison study will be carried out with frequency changes and dynamic process.\nFig.16 shows a tunable frequency change with the proposed method. The frequency can transit smoothly from 20 kHz to 12.5 kHz or 12.5 kHz to 20 kHz respectively. It proves the proposed NPI-MPC can easily change the switching frequency to a desired value.\nFig. 17 shows the dynamic process with the proposed algorithm when the load changes. Comparably, Fig. 18 shows the dynamic process of PI generated current reference based MPC algorithm with the same load change. It is obvious the proposed algorithm performs a better adjusting ability with fast response speed which is approximately 500 \u00b5s as well as less overshoot. However, the PI combined MPC algorithm takes approximately 300 ms to reach the new stable state during the dynamic process and has an overshoot of 20 V.\nVo :(25 V/div)\niL:(2 A/div)\nTime:(400 ms/div)\nVo :(25 V/div)\niL:(2 A/div)\nTime:(400 ms/div)\n(a) Load steps from 50 W to 100 W. (b) Load steps from 100 W to 50 W.\nFig. 18. Output voltage Vo and inductor current iL with the PI combined MPC during load steps."
        },
        {
            "heading": "D. Case Study 4: Stability validation of the NPI-MPC algorithm with different weighting factors",
            "text": "This case investigates the effects of different weighting factors on the NPI-MPC algorithm. According to the above analysis presented in Fig. 19, four groups of weighting factors are tested. As seen from the results, when adopting the first group of weighting factors \u03bb1 = 0.25, \u03bb2 = 1 in the unstable region, the system occurs the loss of regulation in output voltage. When adopting the second group of weighting factors \u03bb1 = 2, \u03bb2 = 1 in the stable region, the system can track the output voltage well and the switching frequency remains constant. Next, when adopting the third and fourth groups of weighting factors \u03bb1 = 0.2, \u03bb2 = 1 in the unstable region, and \u03bb1 = 3, \u03bb2 = 1 in the stable region. It can be seen that the tracking failure occurs when adopting \u03bb1 = 0.2, and \u03bb2 = 1. Hence, the control performance relies heavily on the weighting factors in the cost function. And the stable region gives a guideline for selecting the weighting factors for the cost function to ensure the tracking ability."
        },
        {
            "heading": "E. Case Study 5: The proposed NPI-MPC with the mismatch of parameters",
            "text": "In a real application, the inductance may vary due to the current level and the capacitor will degrade with the age. Therefore, it is necessary to test the robustness of the proposed method when the parameters mismatch between the real values and that used in the MPC. This case presents the robustness of the proposed method with the mismatch of the parameters. The value of the parameters is changed by the control desk. In order to provide the waveforms of output voltage and inductance\n\u00a9 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Danmarks Tekniske Informationscenter. Downloaded on March 28,2023 at 13:05:09 UTC from IEEE Xplore. Restrictions apply.\n9\nTABLE III COMPARISON OF DIFFERENT CONTROL METHODS WITH PROPOSED NPI-MPC.\nDescription [20] [21] [22] NPI-MPC\nComplexity Complicated due tothe use of input linearization\nComplicated due to the use of observer and the design of\nthe dynamic inductor current value Simple Simple\nSwitching frequency fs Control of fs is not studied But it is time-varying Fixed Approximately fixed But varying during\nthe dynamic process Fixed\nDynamic response Short Short Moderate Short\nParameters design requirements\nInput linearization Weighting factor design\nis not studied but is needed\nObserver and N\u2217 which is related to the dynamic inductor current\nvalue need to be designed\nPI controller, possible weighting factor design\nwith more control objectives Weighitng factor\nRobustness Not robust\nAdditional error compensated action is needed\nNot robust Not robust\nBut the effect of parameter mismatch is acceptable\nRobust\nFinally, to summarize the comparison of the proposed methods and other typical methods, Table III is presented to illustrate in detail."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "This paper proposes an NPI-MPC algorithm for the boost converter. Firstly, the actual cause behind the NMP behavior\nin conventional MPC controlled boost converter is analyzed. And then a modified inductor difference equation is proposed. Besides, to generate a fixed switching frequency, the optimal value of the duty cycle is derived and then modulated.\nIt is proved that for the boost converter, the proposed NPIMPC improves the NPM behavior. The output voltage can track its reference only with a single prediction horizon which avoids long computation time. And the switching frequency remains fixed equaling the frequency of the sawtooth. Moreover, the model of the proposed NPI-MPC is established. And the Jacobian matrix is carried out for the stability assessment with different parameters. From the stability analysis results, it can be concluded that when designing weighting factors, the larger ratio between \u03bb1 and \u03bb2 is prone to be stable. When designing inductances and capacitors for the system, the smaller inductance and larger capacitors are prone to be stable with the proposed NPI-MPC controlled boost converter. In the end, the experimental results prove the effectiveness of the proposed NPI-MPC algorithm which ensures stable operation, fast dynamic response as well as robustness."
        }
    ],
    "title": "Stability Oriented Design of Model Predictive Control for DC/DC Boost Converter",
    "year": 2023
}