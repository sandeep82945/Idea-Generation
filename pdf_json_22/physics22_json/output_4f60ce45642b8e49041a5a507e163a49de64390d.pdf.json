{
    "abstractText": "Hawkes process is one of the most commonly used models for investigating the self-exciting nature of earthquake occurrences. However, seismicity patterns have complicated characteristics due to heterogeneous geology and stresses, for which existing methods with Hawkes process cannot fully capture. This study introduces novel nonparametric Hawkes process models that are flexible in three distinct ways. First, we incorporate the spatial inhomogeneity of the self-excitation earthquake productivity. Second, we consider the anisotropy in aftershock occurrences. Third, we reflect the space-time interactions between aftershocks with a non-separable spatio-temporal triggering structure. For model estimation, we extend the model-independent stochastic declustering (MISD) algorithm and suggest substituting its histogrambased estimators with kernel methods. We demonstrate the utility of the proposed methods by applying them to the seismicity data in regions with active seismic activities.",
    "authors": [
        {
            "affiliations": [],
            "name": "Junhyeon Kwon"
        },
        {
            "affiliations": [],
            "name": "Yingcai Zheng"
        },
        {
            "affiliations": [],
            "name": "Mikyoung Jun"
        },
        {
            "affiliations": [],
            "name": "Mikyoung Juna"
        }
    ],
    "id": "SP:833452fd898cea3cc9878111d2e72dcae333bbc8",
    "references": [
        {
            "authors": [
                "I.S. Abramson"
            ],
            "title": "On bandwidth variation in kernel estimates-a square root law",
            "venue": "The Annals of Statistics , 1217\u20131223URL: https://www.jstor",
            "year": 1982
        },
        {
            "authors": [
                "P. Bird"
            ],
            "title": "An updated digital model of plate boundaries. Geochemistry, Geophysics, Geosystems 4. doi:https://doi.org/10.1029/ 2001GC000252",
            "year": 2003
        },
        {
            "authors": [
                "R. Browning",
                "D. Sulem",
                "K. Mengersen",
                "V. Rivoirard",
                "J. Rousseau"
            ],
            "title": "Simple discrete-time self-exciting models can describe complex dynamic processes: A case study of covid-19",
            "venue": "PloS one 16,",
            "year": 2021
        },
        {
            "authors": [
                "D.J. Daley",
                "D Vere-Jones"
            ],
            "title": "An introduction to the theory of point processes: volume I: elementary theory and methods",
            "year": 2003
        },
        {
            "authors": [
                "T.M. Davies",
                "A. Baddeley"
            ],
            "title": "Fast computation of spatially adaptive kernel estimates",
            "venue": "Statistics and Computing",
            "year": 2018
        },
        {
            "authors": [
                "T.M. Davies",
                "J.C. Marshall",
                "M.L. Hazelton"
            ],
            "title": "Tutorial on kernel estimation of continuous spatial and spatiotemporal relative risk. Statistics in medicine",
            "year": 2018
        },
        {
            "authors": [
                "P.J. Diggle"
            ],
            "title": "Statistical analysis of spatial and spatio-temporal point patterns",
            "venue": "CRC press",
            "year": 2013
        },
        {
            "authors": [
                "A.M. Dziewonski",
                "T.A. Chou",
                "J.H. Woodhouse"
            ],
            "title": "Determination of earthquake source parameters from waveform data for studies of global and regional seismicity",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 1981
        },
        {
            "authors": [
                "G. Ekstr\u00f6m",
                "M. Nettles",
                "A. Dziewo\u0144ski"
            ],
            "title": "The global cmt project 2004\u20132010: Centroid-moment tensors for 13,017 earthquakes",
            "venue": "Physics of the Earth and Planetary Interiors",
            "year": 2012
        },
        {
            "authors": [
                "N.J. van der Elst",
                "E.E. Brodsky"
            ],
            "title": "Connecting near-field and far-field earthquake triggering to dynamic strain",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2010
        },
        {
            "authors": [
                "E.W. Fox",
                "F.P. Schoenberg",
                "J.S. Gordon"
            ],
            "title": "Spatially inhomogeneous background rate estimators and uncertainty quantification for nonparametric hawkes point process models of earthquake occurrences",
            "year": 2016
        },
        {
            "authors": [
                "J.A. Gonz\u00e1lez",
                "P. Moraga"
            ],
            "title": "An adaptive kernel estimator for the intensity function of spatio-temporal point processes",
            "venue": "arXiv preprint arXiv:2208.12026",
            "year": 2022
        },
        {
            "authors": [
                "J.S. Gordon",
                "E.W. Fox",
                "F.P. Schoenberg"
            ],
            "title": "A nonparametric hawkes model for forecasting california seismicity",
            "venue": "Bulletin of the Seismological Society of America",
            "year": 2021
        },
        {
            "authors": [
                "Y. Guo",
                "J. Zhuang",
                "S. Zhou"
            ],
            "title": "An improved space-time etas model for inverting the rupture geometry from seismicity triggering",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2015
        },
        {
            "authors": [
                "B. Gutenberg",
                "C. Richter"
            ],
            "title": "Seismicity of the Earth",
            "venue": "Geological Society of America",
            "year": 1941
        },
        {
            "authors": [
                "S. Hainzl",
                "A. Christophersen",
                "B. Enescu"
            ],
            "title": "Impact of earthquake rupture extensions on parameter estimations of point-process models",
            "venue": "Bulletin of the Seismological Society of America",
            "year": 2008
        },
        {
            "authors": [
                "J.A. Hanley",
                "McNeil",
                "B.J"
            ],
            "title": "A method of comparing the areas under receiver operating characteristic curves derived from the same cases",
            "year": 1983
        },
        {
            "authors": [
                "D. Harte"
            ],
            "title": "An etas model with varying productivity rates",
            "venue": "Geophysical Journal International 198,",
            "year": 2014
        },
        {
            "authors": [
                "D. Hill"
            ],
            "title": "Dynamic stresses, coulomb failure, and remote triggering",
            "venue": "Bulletin of the Seismological Society of America",
            "year": 2009
        },
        {
            "authors": [
                "M. Jun",
                "S. Cook"
            ],
            "title": "Flexible multivariate spatio-temporal hawkes process models of terrorism",
            "venue": "arXiv preprint arXiv:2202.12346 URL: https: //doi.org/10.48550/arXiv.2202.12346",
            "year": 2022
        },
        {
            "authors": [
                "H. Kanamori",
                "E.E. Brodsky"
            ],
            "title": "The physics of earthquakes",
            "venue": "Reports on Progress in Physics",
            "year": 2004
        },
        {
            "authors": [
                "T. Lay",
                "T.C. Wallace"
            ],
            "title": "Modern global seismology",
            "year": 1995
        },
        {
            "authors": [
                "J. Li",
                "Y. Zheng",
                "L. Thomsen",
                "T.J. Lapen",
                "X. Fang"
            ],
            "title": "Deep earthquakes in subducting slabs hosted in highly anisotropic rock fabric",
            "venue": "Nature Geoscience",
            "year": 2018
        },
        {
            "authors": [
                "D. Marsan",
                "O. Lenglin\u00e9"
            ],
            "title": "Extending earthquakes\u2019 reach through cascading",
            "venue": "Science 319,",
            "year": 2008
        },
        {
            "authors": [
                "D. Marsan",
                "O. Lenglin\u00e9"
            ],
            "title": "A new estimation of the decay of aftershock density with distance to the mainshock",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2010
        },
        {
            "authors": [
                "G.O. Mohler",
                "M.B. Short",
                "P.J. Brantingham",
                "F.P. Schoenberg",
                "G.E. Tita"
            ],
            "title": "Self-exciting point process modeling of crime",
            "venue": "Journal of the American Statistical Association",
            "year": 2011
        },
        {
            "authors": [
                "Y. Ogata"
            ],
            "title": "Statistical models for earthquake occurrences and residual analysis for point processes",
            "venue": "Journal of the American Statistical association",
            "year": 1988
        },
        {
            "authors": [
                "Y. Ogata"
            ],
            "title": "Space-time point-process models for earthquake occurrences",
            "venue": "Annals of the Institute of Statistical Mathematics 50,",
            "year": 1998
        },
        {
            "authors": [
                "Y. Ogata"
            ],
            "title": "Space-time model for regional seismicity and detection of crustal stress changes",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2004
        },
        {
            "authors": [
                "Y. Ogata"
            ],
            "title": "Significant improvements of the space-time etas model for forecasting of accurate baseline seismicity",
            "venue": "Earth, planets and space",
            "year": 2011
        },
        {
            "authors": [
                "A. Reinhart"
            ],
            "title": "A review of self-exciting spatio-temporal point processes and their applications",
            "venue": "Statistical Science",
            "year": 2018
        },
        {
            "authors": [
                "X. Robin",
                "N. Turck",
                "A. Hainard",
                "N. Tiberti",
                "F. Lisacek",
                "J.C. Sanchez",
                "M. M\u00fcller"
            ],
            "title": "proc: an open-source package for r and s+ to analyze and compare roc curves",
            "venue": "BMC bioinformatics",
            "year": 2011
        },
        {
            "authors": [
                "B.W. Silverman"
            ],
            "title": "Algorithm as 176: Kernel density estimation using the fast fourier transform",
            "venue": "Journal of the Royal Statistical Society. Series C (Applied Statistics)",
            "year": 1982
        },
        {
            "authors": [
                "S. Toda",
                "R.S. Stein",
                "G.C. Beroza",
                "D. Marsan"
            ],
            "title": "Aftershocks halted by static stress shadows",
            "venue": "Nature Geoscience",
            "year": 2012
        },
        {
            "authors": [
                "T. Utsu"
            ],
            "title": "Magnitudes of earthquakes and occurrence of their aftershocks",
            "venue": "Zisin, Ser",
            "year": 1957
        },
        {
            "authors": [
                "T. Utsu"
            ],
            "title": "Aftershocks and earthquake statistics (1): Some parameters which characterize an aftershock sequence and their interrelations",
            "venue": "Journal of the Faculty of Science, Hokkaido University. Series 7, Geophysics",
            "year": 1970
        },
        {
            "authors": [
                "T. Utsu",
                "Y Ogata"
            ],
            "title": "The centenary of the omori formula for a decay law of aftershock activity",
            "venue": "Journal of Physics of the Earth 43,",
            "year": 1995
        },
        {
            "authors": [
                "T. Utsu",
                "A. Seki"
            ],
            "title": "A relation between the area of after-shock region",
            "year": 1955
        },
        {
            "authors": [
                "A. Veen",
                "F.P. Schoenberg"
            ],
            "title": "Estimation of space\u2013time branching process models in seismology using an em\u2013type algorithm",
            "venue": "Journal of the American Statistical Association 103,",
            "year": 2008
        },
        {
            "authors": [
                "M. Wand"
            ],
            "title": "Fast computation of multivariate kernel estimators",
            "venue": "Journal of Computational and Graphical Statistics",
            "year": 1994
        },
        {
            "authors": [
                "B. Yuan",
                "H. Li",
                "A.L. Bertozzi",
                "P.J. Brantingham",
                "M.A. Porter"
            ],
            "title": "Multivariate spatiotemporal hawkes processes and network reconstruction",
            "venue": "SIAM Journal on Mathematics of Data Science",
            "year": 2019
        },
        {
            "authors": [
                "Y. Zheng",
                "T. Lay"
            ],
            "title": "Low vp/vs ratios in the crust and upper mantle beneath the sea of okhotsk inferred from teleseismic pmp, smp, and sms underside reflections from the moho",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2006
        },
        {
            "authors": [
                "S. Zhu",
                "Y. Xie"
            ],
            "title": "Spatiotemporal-textual point processes for crime linkage detection",
            "venue": "The Annals of Applied Statistics",
            "year": 2022
        },
        {
            "authors": [
                "J. Zhuang"
            ],
            "title": "Weighted likelihood estimators for point processes",
            "venue": "Spatial Statistics",
            "year": 2015
        },
        {
            "authors": [
                "J. Zhuang",
                "J. Mateu"
            ],
            "title": "A semiparametric spatiotemporal hawkes-type",
            "year": 2019
        },
        {
            "authors": [
                "J. Zhuang",
                "Y. Ogata",
                "D. Vere-Jones"
            ],
            "title": "Stochastic declustering of spacetime earthquake occurrences",
            "venue": "Journal of the American Statistical Association",
            "year": 2002
        },
        {
            "authors": [
                "J. Zhuang",
                "Y. Ogata",
                "D. Vere-Jones"
            ],
            "title": "Analyzing earthquake clustering features by using stochastic reconstruction",
            "venue": "Journal of Geophysical Research: Solid Earth",
            "year": 2004
        }
    ],
    "sections": [
        {
            "text": "Hawkes process is one of the most commonly used models for investigating the self-exciting nature of earthquake occurrences. However, seismicity patterns have complicated characteristics due to heterogeneous geology and stresses, for which existing methods with Hawkes process cannot fully capture. This study introduces novel nonparametric Hawkes process models that are flexible in three distinct ways. First, we incorporate the spatial inhomogeneity of the self-excitation earthquake productivity. Second, we consider the anisotropy in aftershock occurrences. Third, we reflect the space-time interactions between aftershocks with a non-separable spatio-temporal triggering structure. For model estimation, we extend the model-independent stochastic declustering (MISD) algorithm and suggest substituting its histogrambased estimators with kernel methods. We demonstrate the utility of the proposed methods by applying them to the seismicity data in regions with active seismic activities. Keywords: Anisotropy, Earthquake, Hawkes Process, Inhomogeneous\n\u2217Corresponding author Email address: mjun@central.uh.edu (Mikyoung Jun)\nPreprint submitted to Spatial Statistics February 15, 2023\nmodel, Spatio-Temporal Nonseparability, Spatio-Temporal Point Process"
        },
        {
            "heading": "1. Introduction",
            "text": "Earthquakes are well-known phenomena in nature with self-exciting properties in space and time (van der Elst and Brodsky, 2010). The stress changes by an earthquake can cause and trigger additional earthquakes in the nearby region. These \u201ctriggered\u201d earthquakes can then trigger more earthquakes, and this process leads to space-time clusters with a branching structure. In this paper, we refer to a triggering event and its triggered events as the \u2018mainshock\u2019 and \u2018aftershocks,\u2019 respectively. It is worth noting that in this definition a small-magnitude earthquake can trigger a larger-magnitude aftershock.\nThis paper models the earthquake occurrences with the Hawkes process models that are useful to explore data with self-exciting properties. One simple form of the Hawkes processes is their temporal version. Assume that we observe events at time points t1, t2, t3, \u00b7 \u00b7 \u00b7 that have self-exciting properties. Conditional on the past events up to time t, Ht, it models the event occurrence rate as\n\u03bb(t|Ht) = \u00b5(t) + \u2211 j:tj<t g(t\u2212 tj), (1)\nwhere \u00b5(t) \u2265 0 is the so-called background rate from the background process. The temporal triggering function, g(\u2206t), is a function of the time lag \u2206t > 0. A commonly used form of g is a \u00b7 exp(\u2212\u2206t/b) for positive constants a and b. Figure 1 illustrates the changes in \u03bb(t) in the time interval [0, 10] as the events occur at t = 1, 3, 3.2, 3.3, 5, 7, with a = b = 1. Events become more likely to occur as the triggering effects of the previous events accumulates.\nWe can also observe that the triggering effect is diminishing as time passes due to the structure assumed for g.\nHawkes processes have a wide range of applications including crime occurrences (Mohler et al., 2011; Zhu and Xie, 2022), terrorism (Jun and Cook, 2022), social media (Yuan et al., 2019), and infectious disease such as COVID19 (Browning et al., 2021). For earthquakes applications, Ogata (1988) suggested the Epidemic-Type Aftershock Sequence (ETAS) model, which is a temporal Hawkes process for earthquake occurrences. It assumes that the earthquake productivity can be attributed to the background process for the mainshocks plus the aftershocks triggered by previously occurred events. Later, Ogata (1998) suggested a spatio-temporal ETAS model. It models the mainshocks by the spatio-temporal Poisson point process, and the triggering effect by \u03ba(m)g(\u2206x,\u2206y,\u2206t). Here, \u03ba(m) is the aftershock productivity (the expected number of the triggered aftershocks) for the earthquake with\nmagnitude m, and g(\u2206x,\u2206y,\u2206t) is a spatio-temporal triggering density with respect to the lags in longitude, latitude, and time.\nIt is helpful to visualize the earthquake occurrences to build a model that reflects the nature of earthquake occurrences. Figure 2 illustrates the spatial and spatio-temporal patterns of the earthquake occurrences of magnitude 5.0 or greater in South America during a one-year period, beginning in June 2015. The asterisk symbol represents the epicenter and occurrence time of the magnitude 8.3 earthquake that struck Chile on September 16, 2015. We can observe a distinct spatial cluster of earthquakes around the mainshock in Figure 2a, and spatio-temporal cluster in Figure 2b. These clusters suggest that a large earthquake in September 2015 triggers more aftershocks compared to the occurrences of smaller earthquakes. Furthermore, the number of triggered aftershocks appears to vary depending on both the location and the magnitude. For example, there was an earthquake with magnitude 7.6 at latitude around L = \u221210\u25e6 in November 2015, and another with magnitude 7.8 at latitude around L = 0\u25e6 in April 2016. Considering the small difference in their magnitudes, these two events in November 2015 have much fewer subsequent earthquakes compared to the one in April 2016. In addition to the aftershock productivity and its resulting cluster structure, earthquake activity can be seen mainly on the western coast of South America, known for its active tectonic plate subduction. This example illustrates the need for a flexible Hawkes process model with spatially inhomogeneous background rate, space-time triggering density whose decay rate accounts for complex cluster structure, and aftershock productivity which depends both on the magnitude and location of the mainshock.\nWe consider nonparametric ETAS models, as it may be restrictive to assume a certain parametric form for a complex process such as earthquake occurrences. Existing works on nonparametric approaches (Marsan and Lengline\u0301, 2008; Fox et al., 2016; Gordon et al., 2021) used histogram estimators to describe the triggering function. For example, a triggering function g(\u2206t) in (1) is estimated in the form\ng\u0302(\u2206t) = B\u2211 b=1 \u03b3bI[\u03c4b,\u03c4b+1)(\u2206t),\nwhere the temporal lag is partitioned into B bins with edge points: \u03c41 < \u03c42 < \u00b7 \u00b7 \u00b7 < \u03c4B+1, \u03b3b > 0 is the height of the histogram in the bin [\u03c4b, \u03c4b+1), and I is an indicator function such that I[\u03c4b,\u03c4b+1)(\u2206t) = 1 if \u2206t \u2208 [\u03c4b, \u03c4b+1)\nand 0 otherwise. However, these existing nonparametric ETAS models have limited flexibility due to the assumption of a locally constant estimator. Furthermore, these methods may not be flexible enough to deal with location dependence and space-time interactions of aftershocks.\nIn this paper, we propose a new class of kernel-based nonparametric ETAS models to study aftershock dynamics, focusing on three aspects. First, we allow the model to have different aftershock productivity depending on the spatial location of each event as well as its magnitude. Second, to account for the anisotropy in the aftershock distribution, we use the Mahalanobis distance to reflect geological characteristics such as fault direction in the spatial domain. Third, we estimate the triggering density function for the triggering dynamics in a nonseparable manner to explain the possible spacetime interaction dynamics.\nThroughout the paper, we use the earthquake data from Advanced National Seismic System (ANSS) Comprehensive Catalog (ComCat) , and this can be accessed by the US Geological Survey website (https://earthquake. usgs.gov/earthquakes/search/). The plate boundary information was downloaded from GitHub repository of Hugo Ahlenius (https://github. com/fraxen/tectonicplates) in the GeoJSON format, which is an enhanced conversion of the data originated from Bird (2003).\nThe rest of the paper is organized in the following way. Section 2 reviews the spatio-temporal ETAS models both for parametric and nonparametric approaches. In Section 3, we propose new kernel-based ETAS models with flexible triggering functions. Earthquake data is analyzed for multiple regions and time periods in Section 4. Various models are compared based\non forecast accuracy, and changes in mainshock activity are investigated before and after some major earthquakes. Section 5 summarizes the proposed model\u2019s contributions and discusses the possibility of further extension as future research topics."
        },
        {
            "heading": "2. Background",
            "text": "In this section, we review existing spatio-temporal ETAS models, both\nparametric and nonparametric methods."
        },
        {
            "heading": "2.1. Parametric ETAS models",
            "text": "Let (x, y) denote the longitude and latitude of the location of earthquake (epicenter), t denote the time of occurrence, and m denote the earthquake magnitude. Here we use the moment magnitude which is defined as a continuous value Mw = (1.5) \u22121 log10M0 \u2212 6.07 for a seismic moment M0 in N\u00b7m (Kanamori and Brodsky, 2004). We then consider the collection of N earthquake occurrences sorted in time\n{(xj, yj, tj,mj) : (xj, yj) \u2208 D, tj \u2212 tj\u22121 \u2265 0, t0 = 0, tN \u2264 T, 1 \u2264 j \u2264 N}\non a spatial domain D over a period of length T , in the unit of days. The earthquake occurrences can be modeled as a spatio-temporal point process. It is described by the (first-order) intensity function\n\u03bb(x, y, t,m) = lim \u2206s,\u2206t,\u2206m\u21920 E [N{B(s,\u2206s)\u00d7 [t, t+ \u2206t)\u00d7 [m,m+ \u2206m)}] |B(s,\u2206s)|\u2206t\u2206m ,\n(2)\nwhere N(\u00b7) is a counting measure of events, B(s,\u2206s) is a ball centered at s = (x, y) with radius \u2206s. We write a conditional intensity \u03bb(x, y, t,m|Ht)\nby replacing the numerator of (2) with the expectation conditional on the history Ht = {(xj, yj, tj,mj) : tj < t}, and this can be used to define a spatio-temporal point process (Diggle, 2013).\nIn the spatio-temporal ETAS models, earthquake magnitudes are com-\nmonly considered in a separable manner for the conditional intensity as\n\u03bb(x, y, t,m|Ht) = J(m)\u03bb0(x, y, t|Ht),\nwhere J(m) is a density of earthquake magnitudes independent from the past events, and \u03bb0(x, y, t|Ht) is a conditional intensity only for location and time (Ogata, 1998; Zhuang et al., 2002; Marsan and Lengline\u0301, 2008; Fox et al., 2016). In our study, we similarly regard the magnitude component as separable as above and focus on estimating the remaining part. For simplicity, we drop the subscript in \u03bb0 for the rest of this paper. As in the introduction of spatio-temporal ETAS models by Ogata (1998), the reduced conditional intensity function is commonly written as\n\u03bb(x, y, t|Ht) = \u00b5(x, y) + \u2211 {j:tj<t} \u03bd(x\u2212 xj, y \u2212 yj, t\u2212 tj;mj)\nwhere \u00b5(x, y) is a background rate for the mainshock at the location (x, y), and \u03bd(x \u2212 xj, y \u2212 yj, t \u2212 tj;mj) represents the triggering effect at location (x, y) and time t from the event occurred at epicenter (xj, yj) and time point tj with magnitude mj. The triggering function \u03bd is further divided as\n\u03bd(x\u2212 xj, y \u2212 yj, t\u2212 tj;mj) = \u03ba(mj)g(x\u2212 xj, y \u2212 yj, t\u2212 tj;mj),\nwhere \u03ba(mj) is the number of aftershocks that would be triggered on average by an event of magnitude mj, and g(x \u2212 xj, y \u2212 yj, t \u2212 tj;mj) is a density\nfunction which explains how the aftershocks of the j-th event would be scattered both spatially and temporally centered on the epicenter (xj, yj) and the time of occurrence tj. Spatial lags x\u2212xj and y\u2212 yj in the triggering density are sometimes scaled based on the magnitude mj because a large-magnitude earthquake triggers aftershocks in a wider area (Utsu and Seki, 1955; Utsu, 1970). As time passes and as it becomes farther away from the epicenter, the triggering function decays to 0 and the conditional intensity \u03bb(x, y, t|Ht) converges to the background rate \u00b5(x, y).\nParametric ETAS models (Ogata, 1998; Zhuang et al., 2002; Veen and Schoenberg, 2008; Ogata, 2011) use the results from the empirical study or make physical hypotheses to assume specific mathematical forms for \u03ba and g. The aftershock productivity function \u03ba(m) is commonly assumed to be in an exponential form as \u03ba(m) = a0 exp(a \u00b7 m), for positive constants a0 and a. The triggering density is usually separated into spatial and temporal components as\ng(\u2206x,\u2206y,\u2206t;m) = g1(\u2206x,\u2206y;m)g2(\u2206t), (3)\nwhere g1 explains the aftershock occurrences spatially with respect to the lag of longitude \u2206x and the lag of latitude \u2206y, and g2 explains the aftershocks occurrences temporally with respect to the temporal lag \u2206t. The temporal triggering function g2 is usually assumed to follow the modified Omori formula, g2(\u2206t) \u221d (1 + \u2206t/c)\u2212p, with p > 1 a decay rate and c a positive constant (Utsu, 1957; Utsu et al., 1995). Spatial triggering function g1(\u2206x,\u2206y;m) takes various forms depending on the decay rate or the scaling of spatial lag. In Ogata (1998), two widely used decay rates were considered.\nThe first one is Gaussian (\u2206s = \u221a \u2206x2 + \u2206y2),\ng1(\u2206x,\u2206y;m) \u221d exp ( \u2212 1\n2d\n\u2206s2\n\u03c3(m)\n) ,\nand the other is the inverse power law g1(\u2206x,\u2206y;m) \u221d ( 1 + \u2206s2\nd\u03c3(m)\n)\u2212q ,\nwhere d > 0 and q > 1 are the parameters to be estimated, and \u03c3(m) is a spatial lag scaling factor that is either \u03c3(m) = 1 or \u03c3(m) = exp(\u03b2m) for a constant \u03b2 > 0.\nFor the estimation of \u00b5 and other parameters in \u03ba, g1, and g2, one can\nmaximize the log-likelihood\n`(\u0398) = N\u2211 i=1 log \u03bb(xi, yi, ti|Hti)\u2212 \u222b T 0 \u222b \u222b D \u03bb(x, y, t|Ht)dxdydt\nfor the set of parameters \u0398 = {\u00b51, \u00b52, \u00b7 \u00b7 \u00b7 , \u00b5k, a0, a, \u03b2, d, q, c, p} (Daley et al., 2003; Reinhart, 2018). Here, (\u00b51, \u00b52, \u00b7 \u00b7 \u00b7 , \u00b5k) are the heights of a 2-dimensional histogram or the coefficients of splines. One of the most well-known attempts is the so-called stochastic declustering method in Zhuang et al. (2002). By assigning the probability for an earthquake being a mainshock, it stochastically splits the entire earthquake population into mainshocks and aftershocks. Initially, it assumes that \u00b5(x, y) is constant and maximizes the likelihood to estimate \u03ba(m), g1(\u2206x,\u2206y;m), and g2(\u2206t). Given these estimates, the probability that the i-th event is a mainshock can be calculated by \u03c1i = \u00b5(xi, yi)/\u03bb(xi, yi, ti|Hti). Then one can update the estimate of the\nbackground rate by \u00b5\u0302(x, y) = T\u22121 \u2211N\ni=1 \u03c1iG(x\u2212xi, y\u2212yi), whereG is a (Gaus-\nsian) kernel with an appropriate bandwidth. Now the stochastic declustering\nmethod iterates between the estimation of (\u03ba, g1, g2) and \u00b5 until convergence. Veen and Schoenberg (2008) proposed an EM-type algorithm that also estimates the ETAS models using the stochastic branching structure. This framework is general in that it is also used to estimate the nonparametric ETAS models from which our method is derived. As a result, we suspend the algorithm explanation for the time being and discuss it later.\nThe underlying mechanism of earthquake occurrences may vary from location to location due to factors we could not account for in the model. Hence, a natural extension of ETAS models would be able to incorporate location dependence property. Ogata (2004) suggested a penalized likelihood estimation method of parametric model that every earthquake has its own parameters. He interpolated the value of each parameter based on Delaunay triangulation tessellated by the epicenters. Harte (2014) proposed a model which used space-time closeness between the events to allow the parameters to vary both spatially and temporally. Zhuang (2015) proposed weighted likelihood estimators based on residual analysis to estimate the spatially varying parameters in ETAS models.\nAnother extension considered in our work is the anisotropy in the spatial pattern of the aftershocks. Earthquakes occur as relative slip on pre-existing fault planes. We use strike and dip angles to describe the fault plane orientation. The slip angle describes the relative movement on the fault plane, during an earthquake rupture, between the two blocks. The strike measures the direction of the intersection line between the Earth\u2019s surface and the fault plane, and the dip is the angle between the fault plane and the surface. As a result, we expect the epicenters of earthquakes around the same fault to be\nscattered in an elliptic shape, with eccentricity determined by the strike, dip, and slip. For this reason, since the introduction of space-time ETAS models, many previous works have made efforts to reflect the shape of the aftershock pattern better. Ogata (1998) suggested finding a centroid of aftershock epicenters by magnitude-based clustering and fitting a bivariate normal density to define the Mahalanobis distance for the spatial lags between the events. Hainzl et al. (2008) pointed out that considering earthquakes to have point sources can lead to overestimation of aftershock occurrences. They instead assumed that earthquakes have line sources by using rupture geometry. In a similar context, Guo et al. (2015) accounted for anisotropy by overlapping the circular triggering density."
        },
        {
            "heading": "2.2. Nonparametric ETAS models",
            "text": "Although there have been many efforts with the parametric forms, the physical mechanism behind the earthquake occurrences is still not well understood, and the state of the rock stress is uncertain too. Therefore, nonparametric modeling can be a good alternative. A noteworthy example of such is the work by Marsan and Lengline\u0301 (2008). They suggested a modelindependent stochastic declustering (MISD) method which assumed a constant background rate \u00b5(x, y) = \u00b5. Fox et al. (2016) extended the method by allowing the background rate to vary spatially. Both Marsan and Lengline\u0301 (2008) and Fox et al. (2016) assumed that the triggering function is spacetime separable and did not use a spatial lag scaling factor. Each of the functions \u03ba, g1, and g2 does not assume a specific model except that it has the shape of a histogram. The function\u2019s domain is partitioned into multiple bins, and MISD method estimates the histogram heights of these bins.\nTo determine the histogram heights of the bins, we need to introduce\nindicating variables\n\u03c7ij = 1, if the i-th event was triggered by the j-th event0, otherwise, for 1 \u2264 i, j \u2264 N . Note that \u03c7ii = 1 implies that the i-th event is a mainshock because it triggered itself, and \u03c7ij = 0 for i < j because an event cannot affect the past. If we assume that all these indicating variables can be observed, the complete log-likelihood of the ETAS model becomes\n`c(\u0398) = N\u2211 i=1 \u03c7ii log \u00b5(xi, yi) + N\u2211 i=1 N\u2211 j=1 \u03c7ij log \u03bd(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj;mj)\n\u2212 \u222b T\n0 \u222b \u222b D \u00b5(x, y)dxdydt\n\u2212 N\u2211 j=1 \u222b T 0 \u222b \u222b D \u03bd(x\u2212 xj, y \u2212 yj, t\u2212 tj;mj)dxdydt,\nwhere \u0398 consists of the heights of the bins in the histograms for \u00b5, \u03ba, and g. Since we do not know the actual triggering relationship that can be represented by the indicating variables, both Marsan and Lengline\u0301 (2008) and Fox et al. (2016) used an EM-type algorithm of Veen and Schoenberg (2008) for the estimation. In the E step, we calculate the expectation of the complete log-likelihood. Since \u03c7ij and \u03c7ii are indicating variables, their expectations are the triggering probabilities of the corresponding pairs of earthquakes, and they can be calculated as\npij = \u03bd(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj;mj) \u00b5(xi, yi) + \u2211 {j:tj<ti} \u03bd(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj;mj)\nif i > j, pij = 0 if i < j, and\npii = \u00b5(xi, yi) \u00b5(xi, yi) + \u2211 {j:tj<ti} \u03bd(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj;mj) .\nNow we can make a lower-triangular N\u00d7N triggering probability matrix P = (pij)1\u2264i,j\u2264N . It is useful in the M step to find the spatially inhomogeneous pattern of the background rate \u00b5(x, y) and determine the height of each bin in the histogram estimators for \u03ba(m), g1(\u2206x,\u2206y), and g2(\u2206t). Note that we can give arbitrary numbers as initial values for the triggering probability matrix P (Marsan and Lengline\u0301, 2010; Fox et al., 2016), and iterate the E step and the M step until convergence.\n\u2022 Background rate\nIn the triggering probability matrix P , its diagonal element pii is a probability that the i-th event is a mainshock. Hence, one can estimate the spatially varying background rate in the spatial domain D by a weighted kernel estimator\n\u00b5\u0302(x, y) = 1\nqh1(x, y|D) \u00b7 T N\u2211 i=1 piiGh1(x\u2212 xi, y \u2212 yi), (4)\nwhere Gh1(\u2206x,\u2206y) = h \u22122 1 \u00b7 G(\u2206x/h1,\u2206y/h1) is a (Gaussian) kernel with appropriate bandwidth h1, and qh1(x, y|D) = \u222b \u222b D Gh1(x \u2032\u2212x, y\u2032\u2212 y)dx\u2032dy\u2032 is a constant to remedy the edge effect near the boundary of D. Our approach to edge correction is detailed in section 1.3 of Diggle (2013) and Davies et al. (2018).\n\u2022 Aftershock productivity\nFor each event, we can get the expected number of aftershocks through\nthe column-wise summation of P without the diagonal element. So, what we need to do is finding a function \u03ba(m) which best explains the relationship between the magnitude mj and the event-wise productiv-\nity \u2211N\ni=j+1 pij. For a given bin [\u03c91, \u03c92) in the magnitude domain, we\nestimate the height of the histogram by\n\u03ba\u0302(m) =\n\u2211 {j:\u03c91\u2264mj<\u03c92} \u2211N i=j+1 pij\u2211\n{j:\u03c91\u2264mj<\u03c92} 1\nwhen m in on a bin [\u03c91, \u03c92).\n\u2022 Triggering density\nSpatial triggering density g1 is assumed to be isotropic, which makes it expressed as (\u2206s = \u221a \u2206x2 + \u2206y2)\ng1(\u2206x,\u2206y) = g01(\u2206s)\n2\u03c0\u2206s ,\nby a change-of-variable to the polar coordinate and integrating out the angular variable. Now we can obtain the histogram estimators for g01 and g2 in a similar manner. For example, let us assume that we want to find the heights on the bins of the histogram which is estimating g2. Then, we have\ng\u03022(\u2206t) =\n\u2211 {(i,j):\u03c41\u2264tj\u2212ti<\u03c42} pij\n(\u03c42 \u2212 \u03c41) \u2211N\u22121\nj=1 \u2211N i=j+1 pij\nwhen \u2206t is on a bin [\u03c41, \u03c42).\nAs an extension, we consider a nonparametric ETAS model whose aftershock productivity depends both on magnitude and location of the mainshock. Schoenberg (2022) suggested a nonparametric method that estimates\nthe aftershock productivity for each event by deriving an analytic form and maximizing the likelihood. But, Schoenberg (2022) smoothed the aftershock productivities only in a magnitude domain without considering their spatial variability. Furthermore, it requires the invertibility of an (N \u2212 1)\u00d7 (N \u2212 1) possibly ill-conditioned lower-triangular matrix G whose (i, j)-th element Gij is g(xi+1 \u2212 xj, yi+1 \u2212 yj, ti+1 \u2212 tj) if i \u2265 j, and 0 otherwise.\nNonparametric ETAS model with anisotropic triggering structure was first suggested by Gordon et al. (2021). It estimates the fault direction of each earthquake and assumes that aftershocks occur at varying angles to the estimated direction. As a result, the spatial triggering density is a function of both the relative angle and the spatial lag \u2206s. Gordon et al. (2021) estimated this bivariate function using a histogram estimator. However, its locally constant form can lead to undesired bumps depending on how partition was done. This problem can be alleviated by kernel methods. Mohler et al. (2011) used the kernel smoothing method to estimate the Hawkes process models. Zhuang and Mateu (2019) estimated periodic background rate by introducing so-called relaxation parameters and using kernel-based residual analysis. In this paper, we adopt the kernel smoothing approaches of Mohler et al. (2011) and Fox et al. (2016). We estimate the aftershock productivity and the triggering density as in (4)."
        },
        {
            "heading": "3. Flexible Hawkes Process Models",
            "text": "This section proposes a new kernel-based nonparametric ETAS model, which has three new attributes for flexibility. It can be expressed by a fol-\nlowing conditional intensity function \u03bb(x, y, t|Ht) = \u00b5(x, y)+ \u2211 {j:tj<t} \u03b1(xj, yj)\u03ba(mj)g(x\u2212xj, y\u2212yj, t\u2212tj; \u03b7, \u03b8). (5) Here, \u03b1(x, y) is for the first new attribute. It is a multiplicative correction term which allows the aftershock productivity to change over space. Second, our proposed triggering density g(\u2206x,\u2206y,\u2206t; \u03b7, \u03b8) has two new parameters to reflect the anisotropy in the aftershock spatial pattern. Parameters \u03b7 \u2265 1 and \u03b8 determine the eccentricity and the major axis direction of the elliptic spatial pattern of aftershocks, respectively (see (8)). Third, we also assume space-time non-separability for the possible interaction between spatial and temporal lags.\nFor the estimation of \u00b5, \u03b1, \u03ba, and g in (5), we use the kernel methods to allow the estimates to vary smoothly over space, time, or magnitude. Smooth estimator is more advantageous for the global aftershock productivity \u03ba(m) than the other components. According to Gutenberg\u2013Richter law, the frequency of earthquakes decreases exponentially as the magnitude increases (Gutenberg and Richter, 1941). Therefore, earthquakes with large magnitudes are relatively less frequent compared to those with smaller magnitudes. In histogram based methods, one may account for this by assigning wide bins for large magnitudes. However, the aftershock productivity is expected to increase faster as magnitude gets larger. This implies that the constant productivity may be inappropriate especially on the wide bins with large magnitudes. Hence, we propose to estimate aftershock productivity by kernel smoothing of event-wise productivity:\n\u03ba\u0302(m) =\n\u2211N\u22121 j=1 ( \u2211N i=j+1 pij)Gh2(m\u2212mj)\u2211N\u22121\nj=1 Gh2(m\u2212mj) ,\nwhere Gh2(\u2206m) = h \u22121 2 G(\u2206m/h2) is a (Gaussian) kernel with appropriate bandwidth h2.\nThe rest of this section illustrates how three new attributes are estimated nonparametrically by dividing them into three subsections. A new MISD algorithm that incorporates these new features can be found in the Appendix A."
        },
        {
            "heading": "3.1. Spatially varying aftershock productivity",
            "text": "This subsection contains our new work, in which we propose a nonparametric ETAS model which can explain the aftershock productivity with location as well as magnitude. Our approach is in common with Schoenberg (2022) in the point that \u03ba(m) is obtained by smoothing the eventwise productivity, but we do not need the invertibility of matrix G. To allow spatially varying features, we introduce a regional aftershock productivity correction factor \u03b1(x, y) and multiply it to the global productivity function \u03ba(m). To this end, we focus on the discrepancy between the magnitude-based global aftershock productivity \u03ba(mj) and the eventwise aftershock productiv-\nity \u2211N\ni=j+1 pij for j = 1, 2, \u00b7 \u00b7 \u00b7 , N \u2212 1. Since we are using a kernel smoothing of \u2211N\u22121\ni=j+1 pij in the magnitude domain to get \u03ba(mj), the estimated number\nof triggered events can be obtained by summing up either of them for the entire events in the catalog. Therefore, the ratio\nA\u2217 =\n\u2211N\u22121 j=1 \u2211N i=j+1 pij\u2211N\u22121\nj=1 \u03ba(mj)\nwould have a value close to unity. Note that it is hard to have the equation A\u2217 = 1 hold because \u03ba(m) is estimated with a kernel method.\nHowever, on a local spatial neighborhood, this ratio will fluctuate from the constant A\u2217 if there is a tendency that \u03ba(m) overestimates (or underestimates) the aftershock productivity compared to the eventwise productivity. Let J denote such a region (or a set of event indexes occurring on that region) on which the actual aftershock productivity is underestimated by \u03ba(m).\nThen the ratio A\u2217J = \u2211 j\u2208J \u2211N i=j+1 pij/ \u2211 j\u2208J \u03ba(mj) which is restricted on the region J becomes substantially larger than A\u2217. So, if AJ = A\u2217J /A\u2217 > 1, it would mean that the earthquakes occurring on the region J have higher aftershock productivity compared to the rest part on average. If AJ < 1, it would mean the opposite. Furthermore, if we define AD\\J similarly as we did for AJ on the region other than J in the spatial domain D, we have\u2211N\u22121 j=1 \u2211N i=j+1 pij\u2211\nj\u2208J AJ\u03ba(mj) + \u2211 j\u2208D\\J AD\\J\u03ba(mj) = A\u2217,\nand this implies that we can understand AJ as a regional productivity correction factor which reflects the geological characteristics implicitly on the region J .\nNow there remains the problem of distinguishing the region J from the other parts. In reality, however, the aftershock productivity can vary gradually over space as a result of many and sometimes unknown factors such as different tectonic, geological, and stress states. Fortunately, we can bypass this problem of uncovering the underlying structure by not partitioning the space one from the other but instead calculating the productivity correction factor on each point (x, y).\nTo this end, we consider local averages of the eventwise aftershock productivity \u2211N\ni=j+1 pij and the global aftershock productivity \u03ba(mj) based on\nthe same (Gaussian) kernel Gh3(\u2206x,\u2206y) = h \u22122 3 \u00b7 Gh3(\u2206x/h3,\u2206y/h3) with\nappropriate bandwidth h3. Then we can calculate a spatially varying ratio as a function of longitude x and latitude y,\n\u03b1\u2217(x, y) =\n\u2211N\u22121 j=1 ( \u2211N i=j+1 pij)Gh3(x\u2212 xj, y \u2212 yj)\u2211N\u22121\nj=1 \u03ba(mj)Gh3(x\u2212 xj, y \u2212 yj) . (6)\nThe aftershock productivity correction factor can then be obtained on each point by\n\u03b1(x, y) = \u03b1\u2217(x, y)/A\u2217, (7)\nand this is multiplied to the value of \u03ba of an event at the corresponding location.\nEstimation of \u03b1(x, y) can be incorporated in the iterative nonparametric method in Section 2. Once the estimate of \u03ba(m) is obtained, we can estimate \u03b1(x, y) using Equations (6) and (7). After that, we can update the triggering probability matrix P by\npij = \u03b1(xj, yj)\u03ba(mj)g(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj) \u00b5(xi, yi) + \u2211 {j:tj<ti} \u03b1(xj, yj)\u03ba(mj)g(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj)\nfor i > j, and\npii = \u00b5(xi, yi) \u00b5(xi, yi) + \u2211 {j:tj<ti} \u03b1(xj, yj)\u03ba(mj)g(xi \u2212 xj, yi \u2212 yj, ti \u2212 tj) .\nIn this way, we obtain new estimates of \u03ba(m) and \u03b1(x, y) based on these probabilities, and the algorithm iterates until the convergence of the triggering probability matrix."
        },
        {
            "heading": "3.2. Anisotropic spatial triggering mechanism",
            "text": "We also propose a nonparametric ETAS model whose triggering density can account for the elliptic feature similarly as in Ogata (1998). We assume\nthat the aftershocks are equally likely to occur if their Mahalanobis distances\u221a (\u2206x \u2206y)S\u22121\u03b7\u03b8 (\u2206x \u2206y) T are the same for a matrix\nS\u03b7\u03b8 = cos \u03b8 \u2212 sin \u03b8 sin \u03b8 cos \u03b8 \u03b7 1 1 1/\u03b7  cos \u03b8 sin \u03b8 \u2212 sin \u03b8 cos \u03b8  . (8) The parameter \u03b7 \u2265 1 represents the ratio between the major and minor axes of the ellipse, and \u03b8 denotes the angle between the major axis and a virtual horizontal line. So, the triggering density can reflect the anisotropy by adding the parameters \u03b7 and \u03b8 as\ng(\u2206x,\u2206y,\u2206t; \u03b7, \u03b8) = g1(\u2206x,\u2206y; \u03b7, \u03b8)g2(\u2206t),\nand measuring the spatial lags with the Mahalanobis distance.\nAs in many other cases of point process data, it may be challenging to find out the underlying geometry of the aftershock triggering mechanism. Even if the ETAS model fits the data very well, we get O(N2) pairs of probabilistic relationships. As a result, this paper makes use of the fact that most of the earthquakes are caused by the relative motion of planar fault surfaces (Lay and Wallace, 1995; Li et al., 2018). Since dominant fault strikes tend to follow the direction of the nearby major plate boundary, we can approximate the fault strikes with a straight line if we confine the spatial domain small enough. Figure 3a illustrates the approximated subducting boundary in the Chile region with dotted line. The black box depicts the region of our interest, the red line is the portion of the subducting plate boundary, and the dashed gray lines are non-subducting boundaries. The slope of the dotted line can be easily calculated because boundary information is given in a piecewise linear form. We perform a linear regression with a midpoint on each segment with\ncorresponding segment length as a weight. As a result, we get \u03b8 = 75.64\u25e6 as a slope angle with respect to the horizontal direction (or the East direction). On the other hand, Figure 3b shows three ellipses of\n(\u2206x \u2206y)S\u22121\u03b7\u03b8 (\u2206x \u2206y) T = 1.\nThese ellipses share the same direction \u03b8 = 75.64\u25e6, but have different axial ratios \u03b7 = 2, 3, 4 represented by solid, dashed, and dotted curves, respectively. This implies that a larger value of \u03b7 is required if the aftershocks are more likely to concentrate along the line of direction \u03b8. However, the degree of the anisotropy \u03b7 is difficult to determine directly. Therefore, we suggest fitting the ETAS model with a range of \u03b7 values and then choosing the one that produces the most accurate forecasts."
        },
        {
            "heading": "3.3. Space-time interaction in aftershocks",
            "text": "A common assumption on the triggering density g(\u2206x,\u2206y,\u2206t) is that it can be decomposed separately into spatial and temporal components as in (3). However, space-time separability can reflect the space-time interaction in the aftershock occurrences. In other words, it makes the triggering effect of a mainshock have the same temporal decay rate at two locations with different spatial lags. For this reason, we propose to use space-time non-separability.\nThe triggering density can be expressed as a bivariate function\ng0(\u2206s,\u2206t) = 2\u03c0\u2206s g(\u2206x,\u2206y,\u2206t).\nFor fast computation, a binned kernel estimator (Silverman, 1982; Wand, 1994) is used by dividing the domain of g0 into an equally-spaced grid. However, we are more interested in the region of small \u2206s and \u2206t because aftershocks are more likely to occur when they are close to the location and time\nof the triggering mainshock. Before using the binned kernel estimator, we log-transform and standardize these spatial and temporal lags as\n\u2206s\u2217ij = log(\u2206sij + 1)/\u03c3s, \u2206t \u2217 ij = log(\u2206tij + 1)/\u03c3t,\nwhere \u2206sij and \u2206tij are the spatial and the temporal lags of the i-th and the j-th events when the latter precedes the former (1 \u2264 j < i \u2264 N), and \u03c3s and \u03c3t are standard deviations of log(\u2206sij + 1) and log(\u2206tij + 1), respectively. For each of these lags, there is a weight pij which tells whether the lag is for a pair of events that are actually in a mainshock-aftershock relationship. As\na result, we use a weighted kernel density estimator\ng\u0302\u22170(\u2206s \u2217,\u2206t\u2217) =\n\u2211 i>j pijGh4(\u2206s\n\u2217 \u2212\u2206s\u2217ij,\u2206t\u2217 \u2212\u2206t\u2217ij) qh4(\u2206s \u2217,\u2206t\u2217|R+ \u00d7 R+) \u2211 i>j pij \u2211 i>j 1 ,\nwhere Gh4(\u00b7, \u00b7) = h\u221224 \u00b7 G(\u00b7/h4, \u00b7/h4) is a bivariate (Gaussian) kernel with appropriate bandwidth h4, and qh4(\u2206s \u2217,\u2206t\u2217|R+\u00d7R+) = \u222b \u222b R+\u00d7R+ Gh4(\u2206s \u2032\u2212 \u2206s\u2217,\u2206t\u2032 \u2212 \u2206t\u2217)d\u2206s\u2032d\u2206t\u2032 is a constant to remedy the edge effect near the boundary as in (4). By change-of-variable, we can revert this back to original unit as\ng\u03020(\u2206s,\u2206t) = g\u0302\u22170(\u2206s \u2217,\u2206t\u2217)\n\u03c3s\u03c3t exp(\u03c3s\u2206s\u2217 + \u03c3t\u2206t\u2217) ."
        },
        {
            "heading": "4. Application to Earthquake Data",
            "text": "We now apply our newly proposed approaches to multiple earthquake catalogs (with major earthquake activities). Catalogs from five time periods in two different regions are investigated, and several variants of kernel-based ETAS models are evaluated. Fitted results from the best model for each case are then compared to those from the ETAS model, which does not assume spatially varying productivity, anisotropy, and space-time interaction in aftershock occurrences. Finally, we compare how the estimated background rate changes before and after major earthquakes."
        },
        {
            "heading": "4.1. Data specification",
            "text": "We examine the proposed approaches on earthquake data from Chile and Japan regions. Tectonic plates subduct under the ocean near these countries to drive the seismic activities, and we determine the spatial domains so that the majority of the earthquakes are located away from the boundary in order\nto reduce the problem of edge effect. The spatial domain near Chile is selected as {(L, l) : L \u2208 [\u221239\u25e6,\u221225\u25e6], l \u2208 [\u221276\u25e6,\u221270\u25e6]} (Figure 4), where L and l denote the latitude and longitude, respectively. In this area, the Nazca plate in the Pacific Ocean subducts eastward under South America. The spatial domain near Japan is {(L, l) : L \u2208 [35\u25e6, 41\u25e6], l \u2208 [139.5\u25e6, 145.5\u25e6]} (Figure 5), where the western part of the Pacific plate subducts under Japan.\nFor the temporal domains, we choose three observation periods for the Chile region and two for the Japan region before and after the recent large earthquakes. An earthquake of magnitude 8.8 occurred near Chile on February 27, 2010, and another of magnitude 8.3 occurred on September 16, 2015. In the Japan region, an earthquake of magnitude 9.1 occurred on March 11, 2011. Table 1 summarizes the earthquake data catalogs analyzed in this paper, which excludes the deep earthquakes whose focal depths are over 100km and cuts off the small earthquakes with magnitudes less than 4.0. Each of the five catalogs lasts approximately six years, with the last year of each as a forecast period for evaluating the flexible ETAS models. Catalogs from the Chile region are labeled as \u2018Chile A,\u2019 \u2018Chile B,\u2019 and \u2018Chile C\u2019 in chronological order, and similarly for the Japan region as \u2018Japan A\u2019 and \u2018Japan B.\u2019 Figures 4 and 5 illustrate the scaled spatial intensities T\u22121 \u00b7 \u03bb(x, y) for all earthquakes (which do not distinguish the mainshocks and the aftershocks) in the catalogs from Chile and Japan, respectively. Note that the length of training period, T , is divided to get comparable values for different catalogs."
        },
        {
            "heading": "4.2. Model estimation",
            "text": "We use prefixes to name the models considered. For the aftershock productivity, V stands for spatially varying \u03b1(x, y) and C for constant (i.e.\nChile A 01/01/2001 - 12/31/2005 (1273 events) 01/01/2006 - 12/31/2006 (296 events) Chile B 02/27/2010 - 09/15/2014 (2882 events) 09/16/2014 - 09/15/2015 (228 events) Chile C 09/16/2015 - 09/15/2020 (2291 events) 09/16/2020 - 09/15/2021 (261 events) Japan A 01/01/2003 - 12/31/2007 (875 events) 01/01/2008 - 12/31/2008 (452 events) Japan B 03/11/2011 - 03/10/2016 (7001 events) 03/11/2016 - 03/10/2017 (419 events)\n\u03b1(x, y) = 1). For the triggering function, N stands for space-time nonseparable g, and S for separable g. Regarding the degree of anisotropy, we compare the values \u03b7 = 1, 2, 3, 4, \u00b7 \u00b7 \u00b7 for each catalog. These are appended after the prefixes as VN-1:1, VN-2:1, VN-3:1, and so forth. For the direction of the anisotropy pattern, we orient the major axis to approximate the plate boundary in each region. We use the coordinates of the boundary and apply a weighted linear regression as described in subsection 3.2 to determine the local plate boundary orientation. The angle of the estimated regression line can be expressed as a counterclockwise angle from the horizontal line (the east direction). We have obtained \u03b8 = 75.64\u25e6 for three catalogs from Chile and \u03b8 = 65.78\u25e6 for two catalogs from Japan. But, we have to note that the degree of anisotropy \u03b7 can be different for two catalogs with same spatial domain because the region of active seismic activity may vary over time from period to period, shown in Figure 4.\nFor the estimation of \u00b5(x, y) and \u03b1(x, y), a kernel method with fixed bandwidth has its limitation due to the clustering structure of epicenters.\nA small bandwidth results in a noisy estimate of the region with few earthquakes, while a large bandwidth blurs out the patterns in the seismically active region. To alleviate this problem, we adjust the kernel bandwidth by adopting the square root rule of Abramson (1982), which is used for the intensity function estimation due to its small bias (Davies and Baddeley, 2018; Gonza\u0301lez and Moraga, 2022). We first estimate the weighted kernel density f0 with a Gaussian kernel with bandwidth h0 = 0.5 \u25e6. Then we adjust the\nbandwidth on each epicenter (xi, yi) to be hi = h0f0(xi, yi) \u22121/2\u03b3\u22121, where \u03b3 is the geometric mean of f(xi, yi) \u22121/2. This allows the kernels centered on the region of sparse earthquakes to have wider bandwidths, while the kernels centered on the densely observed region to have narrower bandwidths. Since the aftershock productivity function \u03ba(m) is neither density nor intensity, we use the k-th nearest epicenter to select the kernel bandwidth. Here, we determine the value of k by using the leave-one-out cross validation with a least-squares criterion. However, the triggering density g\u22170(\u2206s \u2217,\u2206t\u2217) is estimated with a Gaussian kernel with a fixed bandwidth 0.2\u25e6 to avoid the computational burden resulting from O(N2) pairs of spatial and temporal lags when there are N earthquakes."
        },
        {
            "heading": "4.3. Model comparison",
            "text": "The results of all the models considered are compared based on their daily forecast accuracy. We first fit the ETAS models to the historical events that occurred during the training period of each catalog. We then evaluate the conditional intensity (5) on the midpoints of 0.1\u25e6\u00d7 0.1\u25e6 cells over the spatial domain at the beginning of every day during the forecast period. Now we produce forecast based on a threshold value for the conditional intensity. If the conditional intensity exceeds a certain threshold, we forecast that one or more earthquakes might occur in the cell within 24 hours following the midnight. Otherwise, we forecast that no earthquakes would occur in the cell in that day. Hence, more space-time cells are forecasted to have one or more earthquakes if the threshold is low and the opposite case is true if the threshold is high. To remediate the effect of an arbitrary threshold, we measure the forecast accuracy based on the area under the curve (AUC) of the receiver operating characteristic (ROC) curve. To be more precise, we calculate the partial AUC by limiting the region of interest for specificity (true negative rate) in the ROC space. This region may vary depending on the circumstances or some expert advice, but we limit the specificity to 50-100% because sensitivity (true positive rate) reaches nearly 100% as specificity drops to 50%. This allows for a better comparison of the models by excluding cases of too low thresholds, which typically result in the increase of false positive forecasts.\nTables 2 and 3 summarize the forecast results of the ETAS models from Chile and Japan, respectively. The highest partial AUC from each catalog is bold-faced, and it may be contrasted with a value from CS-1:1 to determine\nhow much the forecast improvement can be achieved by incorporating spatially varying productivity, anisotropy, and space-time interaction in aftershock occurrences. For the catalogs from Chile, models with spatially varying productivity have higher forecast accuracy. The highest partial AUCs are obtained by the models VN-2:1, VN-1:1, and VS-4:1 for the catalogs Chile A, B, and C, respectively. The improvement is highlighted by the partial ROC curves in Figure 6. For the catalog Chile A, VN-2:1 model makes nearly 5 percent points less false negative forecast compared to CS-1:1 to achieve the sensitivity of 90%. For the catalog Chile B, VN-1:1 model improves the sensitivity by nearly 10 percent points compared to CS-1:1 when the specificity is around 90%. On the other hand, partial AUCs from the catalogs of Japan show relatively little improvement compared to the model CS-1:1. However, we note that small differences in partial AUCs can be actually significant due to the correlation of the ROC curves since we are using the same spacetime grid for each catalog. Robin et al. (2011) addressed this problem and modified the work of Hanley et al. (1983) to implement a bootstrap-based significance test. The test statistic has the form, Z = (A1\u2212A2)/sd(A1\u2212A2), where A1 and A2 are (partial) AUCs, and it approximately follows a standard\nnormal distribution. For the calculation, we obtain sd(A1 \u2212 A2) by a stratified bootstrapping of the conditional intensities over the space-time grid. We generate 2000 bootstrap samples with the same size as in the original one and calculate the AUCs for each case. One-sided tests against the model CS-1:1 give the p-values 1.45\u00d710\u22123, 5.77\u00d710\u22124, 2.31\u00d710\u22124, 4.41\u00d710\u22121, and 5.62\u00d7 10\u22122 in the order of the catalogs from Chile A, B, C and Japan A & B, respectively. This suggests that there is substantial evidence that flexible models forecast significantly better for the Chile region. It is also notable for the catalog Japan B that the p-value is quite small considering small absolute difference between VN-1:1 and CS-1:1. This is resulting from small variability in the difference between two partial AUCs, which suggests that the proposed method performs better than the existing one in the majority of the cells of the space-time grid."
        },
        {
            "heading": "4.4. Result analysis",
            "text": "Now we examine the changes in background rates \u00b5(x, y) before and after the major earthquakes. Figures 7 and 8 show the estimated background rates\n\u00b5(x, y) for Chile and Japan regions, respectively. Note that we do not need to scale \u00b5(x, y) with the length of training period, T , because of its definition (4). The plots in the top row show the estimation results from the most restrictive model, CS-1:1, while the plots in the bottom row are from the models that provide the best forecast accuracy. When utilizing the CS-1:1 model, the estimated background rate for Chile B is the lowest compared to the other two catalogs in Chile. Allowing model flexibility, on the other hand, has the opposite result, and Chile B becomes the period of the most intense mainshock activity. In the Japan region, using flexible models noticeably increases the background rate for the catalog Japan B while leaving the estimate for Japan A practically unchanged. Another distinctive feature of the flexible models is the change in the overall shape of the background rate distribution, particularly for catalogs from the Chile region. Northward shift is observed for the peaks of the estimated background rate as we allow for spatial variation in aftershock productivity.\nOne of the reasons which attribute to these phenomena is spatially varying productivity, which is assumed in all the flexible models with the highest forecast accuracy. Figures 9 and 10 illustrate the estimates of aftershock\nproductivities for the earthquakes at the cutoff magnitude, \u03b1(x, y)\u03ba(4.0), for the best model of each catalog in Chile and Japan, respectively. By observing these figures, we can identify the region with active aftershock occurrences compared to other region. So, the estimated background rate becomes lower in the corresponding area as we assume the spatial variability in aftershock productivity. On the contrary, a region of low aftershock productivity yields relatively more mainshocks compared to the models that assume \u03b1(x, y) = 1. Regarding the catalogs of our interest, Chile B has a dramatic change in the aftershock productivity at latitude L = \u221233\u25e6 (Figure 9b) making the corresponding period have vigorous mainshock activity, and Japan B shows its lowest aftershock productivity along the coast around the latitude L = 39\u25e6 (Figure 10b) making the original peak of background rate even higher. On the other hand, catalogs Chile A and C have high aftershock productivity between the latitudes L = \u221230\u25e6 and L = \u221234\u25e6 while Chile B has high values between L = \u221233\u25e6 and L = \u221239\u25e6. These portions of spatial domain coincides with the ones where the estimated background rates from CS-1:1 model become lower as we allow model flexibility for better forecast. Finally, catalog Japan A has \u03b1(x, y) \u2248 1 on the portion of spatial domain where there are many earthquake occurrences (Figure 10a), and this can be a reason why we cannot achieve a significant improvement in forecast accuracy via spatially varying aftershock productivity.\nNote that we do not present the estimated aftershock productivity at the cutoff magnitude for the location where there is no earthquakes nearby in Figures 9 and 10. Although \u03b1(x, y) can be obtained for every point in the spatial domain, its definition (6) as a ratio of two local averages can\ngive unstable and misleading results for the portion where there are little observation. Instead, we divide the spatial domain into 0.2\u25e6 \u00d7 0.2\u25e6 cells and use the average of the estimated \u03b1(x, y) for better visual representation."
        },
        {
            "heading": "5. Discussion",
            "text": "We propose a new spatio-temporal flexible Hawkes model on earthquake occurrences which builds on the previous works on ETAS models to focus on understanding the aftershock dynamics. To the best of our knowledge, this is the first attempt to use nonparametric ETAS models to allow aftershock productivity to vary based on the spatial location as well as magnitude. We achieve further flexibility by considering seismicity anisotropy\nand space-time interaction (via non-separable structure) in aftershock occurrences. All of these new properties are incorporated into the fully kernelbased ETAS model, in which we have extended the histogram-based ones to obtain smoothly varying estimates. Stability of the model estimation is demonstrated in the Appendix B by using the synthetic earthquake catalogs simulated from a parametric ETAS model with inhomogeneous background rate and spatially constant aftershock productivity, \u03b1(x, y) = 1. The results confirm that spatially varying \u03b1-function (thus more flexible than true) is not causing instability in terms of the model estimation and forecast accuracy. By applying various combinations of the proposed approaches to earthquake data from Chile and Japan, we have demonstrated improved forecast accuracy. We have also investigated possible new explanations for the change in\nmainshock activity before and after major earthquakes.\nThe research presented in this study is a step towards our goal to build an earthquake forecast model that reflects the nature of their occurrences more flexibly. We plan to test our eventual model in the CSEP (Collaboratory for the Study of Earthquake Predictability) to see how it compares to other forecast models and to look into the prospect of further progress. The kernel bandwidth selection is one of the challenges that our model encounters, which is inherent for nonparametric models in general. Cross validation is a commonly adopted solution to select the kernel bandwidth. However, the proposed model (5) has four components that needs bandwidth selection: \u00b5, \u03b1, \u03ba, and g. Furthermore, iterative estimation algorithm changes the weights in the kernel estimators for every iteration. This implies that the bandwidth selection needs to be conducted more than once. Though we set them to appropriate values for all catalogs and focus on changing the features of interest, an objective method for bandwidth selection needs to be established for more precise analysis.\nOn the other hand, we plan to allow the triggering density g(\u2206x,\u2206y,\u2206t; \u03b7, \u03b8)\nto have spatially varying anisotropy parameters (also including the depth direction beyond the 2\u2013D seismicity considered here) as future research. Approximating the fault plane orientation with a plate boundary is a crude and oversimplified approach. Depending on the spatial domain of a given catalog, there may be a number of faults that are not parallel to the plate boundary. Fortunately, the fault plane (despite an ambiguous auxiliary plane) can be estimated based on the first motion of seismic waves. The Global CentroidMoment-Tensor (GlobalCMT) Project inverts and provides the fault-plane\nsolutions, available online at their website (Dziewonski et al., 1981; Ekstro\u0308m et al., 2012). We may be able to build a more accurate ETAS model if we could model \u03b7 and \u03b8 based on the seismologically estimated strike, dip, and slip, as well as the associated stress change at the aftershock location due to the mainshocks (Hill, 2009; Toda et al., 2012). However, only earthquakes with magnitudes 5.0 or greater are available in GlobalCMT.\nOther than the topics mentioned above, future research areas for the nonparmetric ETAS models include modeling of the earthquake occurrences considering their focal depths. We can also develop a nonparametric ETAS model which accounts for the Utsu-Seki law by scaling the spatial lags. The law says that the spatial range of aftershocks is related with the mainshock magnitude in an exponential fashion.\nDeclaration of Interest\nNone"
        },
        {
            "heading": "Acknowledgements",
            "text": "Mikyoung Jun acknowledges support by NSF DMS-1925119 and DMS-\n2123247."
        },
        {
            "heading": "Appendix A: Modified MISD algorithm",
            "text": "1. Initialize the triggering probability matrix P (0) = (p (0) ij )1\u2264i,j\u2264N as\np (0) ij = 1/i for j = 1, 2, \u00b7 \u00b7 \u00b7 , i.\n2. Iterate for ` = 1, 2, \u00b7 \u00b7 \u00b7 , until maxi,j |p(`)ij \u2212 p (`\u22121) ij | becomes smaller than\nthe convergence criterion > 0.\na. Estimate the background rate\n\u00b5(`)(x, y)\u2190 1 qh1(x, y|D) \u00b7 T N\u2211 i=1 p (`\u22121) ii Gh1(x\u2212 xi, y \u2212 yi),\nwhere T is a length of the temporal domain, D is a spatial domain, and qh1(x, y|D) is an edge-correction factor at (x, y).\nb. Estimate the productivity function\n\u03ba(`)(m)\u2190 \u2211N\u22121 j=1 ( \u2211N i=j+1 p (`\u22121) ij )Gh2(m\u2212mj)\u2211N\u22121\nj=1 Gh2(m\u2212mj) .\nc. Estimate the regional productivity correction factor\n\u03b1(`)(x, y)\u2190 1 A\u2217\n\u2211N\u22121 j=1 ( \u2211N i=j+1 p\n(`\u22121) ij )Gh3(x\u2212 xj, y \u2212 yj)\u2211N\u22121\nj=1 \u03ba (`)(mj)Gh3(x\u2212 xj, y \u2212 yj)\n,\nwhere A\u2217 = \u2211N\u22121\nj=1 \u2211N i=j+1 p (`\u22121) ij / \u2211N\u22121 j=1 \u03ba (`)(mj).\nd. Estimate the triggering density\ng \u2217(`) 0 (\u2206s\n\u2217,\u2206t\u2217)\u2190 \u2211 i>j p (`\u22121) ij Gh4(\u2206s \u2217 \u2212\u2206s\u2217ij,\u2206t\u2217 \u2212\u2206t\u2217ij)\nqh4(\u2206s \u2217,\u2206t\u2217|R+ \u00d7 R+) \u2211 i>j p (`\u22121) ij \u2211 i>j 1 ,\ng (`) 0 (\u2206s,\u2206t)\u2190\ng \u2217(`) 0 (\u2206s \u2217,\u2206t\u2217)\n\u03c3s\u03c3t exp(\u03c3s\u2206s\u2217 + \u03c3t\u2206t\u2217) ,\nwhere \u2206s\u2217ij = log(\u2206sij + 1)/\u03c3s, \u2206t \u2217 ij = log(\u2206tij + 1)/\u03c3t, \u2206sij =\u221a\n(xi \u2212 xj)2 + (yi \u2212 yj)2, \u2206tij = ti\u2212 tj, \u03c3s is a standard deviation of log(\u2206sij + 1), \u03c3t is a standard deviation of log(\u2206tij + 1), and qh4(\u2206s \u2217,\u2206t\u2217|R+ \u00d7R+) is an edge-correction factor at (\u2206s\u2217,\u2206t\u2217).\ne. Update the triggering probability matrix P (`) as\np (`) ii \u2190\n\u00b5(`)(xi, yi) \u00b5(`)(xi, yi) + \u2211\nj:tj<ti \u03b1(`)(xj, yj)\u03ba(`)(mj)g (`) 0 (\u2206sij,\u2206tij)/(2\u03c0\u2206sij)\n,\np (`) ij \u2190\n\u03b1(`)(xj, yj)\u03ba (`)(mj)g (`) 0 (\u2206sij,\u2206tij)/(2\u03c0\u2206sij) \u00b5(`)(xi, yi) + \u2211\nj:tj<ti \u03b1(`)(xj, yj)\u03ba(`)(mj)g (`) 0 (\u2206sij,\u2206tij)/(2\u03c0\u2206sij)\n."
        },
        {
            "heading": "Appendix B: Stability of the model estimation",
            "text": "We illustrate the stability of the proposed model by using synthetic earthquake data. We generate a synthetic earthquake catalog from a parametric ETAS model with an inhomogeneous background rate and a spatially constant aftershock productivity function, i.e. \u03b1(x, y) = 1. The forecast accuracy and the estimated background rate are then compared between two models, VS-1:1 and CS-1:1, which share the assumptions of spatial isotropy and space-time separability in the aftershock occurrences but differ in whether \u03b1(x, y) varies over the spatial domain or not.\nFor the simulation, we produce 200 synthetic earthquake catalogs over a square shape spatial domain {(x, y) : 0\u25e6 \u2264 x, y \u2264 6\u25e6} for 4400 days utilizing the branching structure of the Hawkes processes (Zhuang et al., 2004). For each catalog, we discard the observations in the first 2000 days to use the data in a steady state. The observations from the next 2000 days are then used to fit the ETAS models, while the remaining observations from the last 400 days are used to measure forecast accuracy. Assumed parametric ETAS model for the data generation has the form\n\u03bb(x, y, t|Ht) = \u00b5(x, y) + \u2211 {j:tj<t} \u03ba(mj)g1(x\u2212 xj, y \u2212 yj)g2(t\u2212 tj),\nwhere \u00b5(x, y) = 0.0125 \u00b7 I{(x,y):1\u2264x,y\u22645}(x, y) + 0.05 \u00b7 I{(x,y):3\u2264x\u22645,1\u2264y\u22645}(x, y), \u03ba(m) = 0.2 exp(1.7(m \u2212 4)), g1(\u2206x,\u2206y) = 0.6680.00204\u03c0 (1 + \u2206x2+\u2206y2 0.00204 )\u22121.668, and g2(\u2206t) = 0.0947 0.0327 (1 + \u2206t 0.0327 )\u22121.0947. Note that the background rate is nonzero only in the middle of the spatial domain to reduce the edge effect in the estimation, and the spatial and temporal triggering densities are using the estimation results in Ogata (1998) as their parameters. In terms of mag-\nnitude distribution, we suppose that it is determined independently of past occurrences using an exponential distribution with rate log 10, i.e. J(m) \u223c 4 + Exp(log 10).\nNow we fit the two models VS-1:1 and CS-1:1 to each of 200 synthetic earthquake catalogs and compare the results. Our result confirms that there is no instability in our results. First, estimated values of \u03b1 function of the model with spatially varying \u03b1 are around 1 over the entire spatial domain. Second, background rates are estimated almost identically by both models. Figure 11 illustrates the pixelwise average and standard deviation of the background rate estimation results by the two models for 200 synthetic earthquake catalogs, and both of them match closely with the assumed background rate. Lastly, we compare the forecast accuracy of the two models in a same manner as in the section 4. The average partial AUCs for forecast accuracy are 0.36840 and 0.36836 for both models, respectively, and the pairwise differences of them are very small."
        }
    ],
    "title": "Flexible Spatio-Temporal Hawkes Process Models for Earthquake Occurrences",
    "year": 2023
}