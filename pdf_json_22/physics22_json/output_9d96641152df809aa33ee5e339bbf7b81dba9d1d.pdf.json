{
    "abstractText": "a School of Mathematics, University of Edinburgh, The King\u2019s Buildings, UK b Centro de Matem\u00e1tica e Aplica\u00e7\u00f5es (CMA), FCT, UNL, Portugal 28 March, 2023 (01h47) Abstract We consider in this work the convergence of a split-step Euler type scheme (SSM) for the numerical simulation of interacting particle Stochastic Differential Equation (SDE) systems and McKean-Vlasov Stochastic Differential Equations (MV-SDEs) with full super-linear growth in the spatial and the interaction component in the drift, and non-constant Lipschitz diffusion coefficient. The super-linear growth in the interaction (or measure) component stems from convolution operations with super-linear growth functions allowing in particular application to the granular media equation with multi-well confining potentials. From a methodological point of view, we avoid altogether functional inequality arguments (as we allow for non-constant non-bounded diffusion maps). The scheme attains, in stepsize, a near-optimal classical (path-space) root mean-square error rate of 1/2 \u2212 \u03b5 for \u03b5 > 0 and an optimal rate 1/2 in the non-path-space mean-square error metric. All findings are illustrated by numerical examples. In particular, the testing raises doubts if taming is a suitable methodology for this type of problem (with convolution terms and nonconstant diffusion coefficients).",
    "authors": [
        {
            "affiliations": [],
            "name": "Xingyuan Chena"
        },
        {
            "affiliations": [],
            "name": "Gon\u00e7alo dos Reisa"
        }
    ],
    "id": "SP:e4db7194ff1835d6b7b1744f5b80c455b1245e41",
    "references": [
        {
            "authors": [
                "D. Adams",
                "G. dos Reis",
                "R. Ravaille",
                "W. Salkeld"
            ],
            "title": "Tugaut. Large deviations and exittimes for reflected McKean-Vlasov equations with self-stabilising terms and superlinear drifts",
            "venue": "Stochastic Process. Appl.,",
            "year": 2022
        },
        {
            "authors": [
                "D. Adams",
                "M.H. Duong",
                "G. dos Reis"
            ],
            "title": "Entropic regularisation of non-gradient systems",
            "venue": "SIAM Journal on Mathematical Analysis,",
            "year": 2022
        },
        {
            "authors": [
                "D. Adams",
                "M.H. Duong",
                "G. dos Reis"
            ],
            "title": "Operator-splitting schemes for degenerate, non-local, conservative-dissipative systems",
            "venue": "Discrete and Continuous Dynamical Systems,",
            "year": 2022
        },
        {
            "authors": [
                "A. Agarwal",
                "S. Pagliarani"
            ],
            "title": "A Fourier-based Picard-iteration approach for a class of McKean",
            "venue": "Vlasov SDEs with Le\u0301vy jumps. Stochastics,",
            "year": 2021
        },
        {
            "authors": [
                "J. Baladron",
                "D. Fasoli",
                "O. Faugeras",
                "J. Touboul"
            ],
            "title": "Mean-field description and propagation of chaos in networks of Hodgkin-Huxley and FitzHugh-Nagumo neurons",
            "venue": "J. Math. Neurosci.,",
            "year": 2012
        },
        {
            "authors": [
                "C. Beck",
                "M. Hutzenthaler",
                "A. Jentzen",
                "E. Magnani"
            ],
            "title": "Full history recursive multilevel Picard approximations for ordinary differential equations with expectations",
            "venue": "arXiv e-prints, pages arXiv\u20132103,",
            "year": 2021
        },
        {
            "authors": [
                "D. Belomestny",
                "V. Pilipauskait\u0117",
                "M. Podolskij"
            ],
            "title": "Semiparametric estimation of McKean- Vlasov SDEs",
            "venue": "arXiv preprint arXiv:2107.00539,",
            "year": 2021
        },
        {
            "authors": [
                "D. Belomestny",
                "J. Schoenmakers"
            ],
            "title": "Projected particle methods for solving McKean-Vlasov stochastic differential equations",
            "venue": "SIAM J. Numer. Anal.,",
            "year": 2018
        },
        {
            "authors": [
                "W.-J. Beyn",
                "E. Isaak",
                "R. Kruse"
            ],
            "title": "Stochastic C-stability and B-consistency of explicit and implicit Euler-type schemes",
            "venue": "J. Sci. Comput.,",
            "year": 2016
        },
        {
            "authors": [
                "F. Bolley",
                "J.A. Ca\u00f1izo",
                "J.A. Carrillo"
            ],
            "title": "Stochastic mean-field limit: non-Lipschitz forces and swarming",
            "venue": "Math. Models Methods Appl. Sci.,",
            "year": 2011
        },
        {
            "authors": [
                "M. Bossy",
                "O. Faugeras",
                "D. Talay"
            ],
            "title": "Clarification and complement to \u201cMean-field description and propagation of chaos in networks of Hodgkin-Huxley and FitzHugh-Nagumo neurons",
            "venue": "J. Math. Neurosci.,",
            "year": 2015
        },
        {
            "authors": [
                "M. Bossy",
                "D. Talay"
            ],
            "title": "A stochastic particle method for the McKean-Vlasov and the Burgers equation",
            "venue": "Math. Comp.,",
            "year": 1997
        },
        {
            "authors": [
                "J.A. Carrillo",
                "Y.-P. Choi",
                "O. Tse"
            ],
            "title": "Convergence to equilibrium in Wasserstein distance for damped Euler equations with interaction forces",
            "venue": "Comm. Math. Phys.,",
            "year": 2019
        },
        {
            "authors": [
                "J.A. Carrillo",
                "M. Fornasier",
                "G. Toscani",
                "F. Vecil"
            ],
            "title": "Particle, kinetic, and hydrodynamic models of swarming",
            "venue": "sciences, Model. Simul. Sci. Eng. Technol.,",
            "year": 2010
        },
        {
            "authors": [
                "P. Cattiaux",
                "A. Guillin",
                "F. Malrieu"
            ],
            "title": "Probabilistic approach for granular media equations in the non-uniformly convex case",
            "venue": "Probab. Theory Related Fields,",
            "year": 2008
        },
        {
            "authors": [
                "L.-P. Chaintron",
                "A. Diez"
            ],
            "title": "Propagation of chaos: a review of models, methods and applications",
            "venue": "arXiv preprint arXiv:2106.14812,",
            "year": 2021
        },
        {
            "authors": [
                "X. Chen",
                "G. dos Reis"
            ],
            "title": "A flexible split-step scheme for solving McKean-Vlasov stochastic differential equations",
            "venue": "Appl. Math. Comput., 427:Paper No. 127180,",
            "year": 2022
        },
        {
            "authors": [
                "F. Comte",
                "V. Genon-Catalot"
            ],
            "title": "Nonparametric adaptive estimation for interacting particle systems",
            "venue": "HAL Id: hal-03696877,",
            "year": 2022
        },
        {
            "authors": [
                "D. Crisan",
                "E. McMurray"
            ],
            "title": "Cubature on Wiener space for McKean-Vlasov SDEs with smooth scalar interaction",
            "venue": "Ann. Appl. Probab.,",
            "year": 2019
        },
        {
            "authors": [
                "F. Delarue",
                "D. Lacker",
                "K. Ramanan"
            ],
            "title": "From the master equation to mean field game limit theory: a central limit theorem",
            "venue": "Electron. J. Probab.,",
            "year": 2019
        },
        {
            "authors": [
                "G. dos Reis",
                "S. Engelhardt",
                "G. Smith"
            ],
            "title": "Simulation of McKean-Vlasov SDEs with super-linear growth",
            "venue": "IMA J. Numer. Anal.,",
            "year": 2022
        },
        {
            "authors": [
                "G. dos Reis",
                "W. Salkeld"
            ],
            "title": "Tugaut. Freidlin-Wentzell LDP in path space for McKean-Vlasov equations and the functional iterated logarithm law",
            "venue": "Ann. Appl. Probab.,",
            "year": 2019
        },
        {
            "authors": [
                "G. dos Reis",
                "G. Smith",
                "P. Tankov"
            ],
            "title": "Importance sampling for McKean-Vlasov SDEs",
            "venue": "arXiv preprint arXiv:1803.09320,",
            "year": 2018
        },
        {
            "authors": [
                "W. Dreyer",
                "M. Gaber\u0161\u010dek",
                "C. Guhlke",
                "R. Huth",
                "J. Jamnik"
            ],
            "title": "Phase transition in a rechargeable lithium battery",
            "venue": "European J. Appl. Math.,",
            "year": 2011
        },
        {
            "authors": [
                "N. Fournier",
                "M. Hauray",
                "S. Mischler"
            ],
            "title": "Propagation of chaos for the 2D viscous vortex model",
            "venue": "J. Eur. Math. Soc. (JEMS),",
            "year": 2014
        },
        {
            "authors": [
                "V. Genon-Catalot",
                "C. Lar\u00e9do"
            ],
            "title": "Probabilistic properties and parametric inference of small variance nonlinear self-stabilizing stochastic differential equations",
            "venue": "Stochastic Process. Appl.,",
            "year": 2021
        },
        {
            "authors": [
                "K. Giesecke",
                "G. Schwenkler",
                "J.A. Sirignano"
            ],
            "title": "Inference for large financial systems",
            "venue": "Mathematical Finance,",
            "year": 2020
        },
        {
            "authors": [
                "E. Gobet",
                "S. Pagliarani"
            ],
            "title": "Analytical approximations of non-linear SDEs of McKean-Vlasov type",
            "venue": "J. Math. Anal. Appl.,",
            "year": 2018
        },
        {
            "authors": [
                "C. Guhlke",
                "P. Gajewski",
                "M. Maurelli",
                "P.K. Friz",
                "W. Dreyer"
            ],
            "title": "Stochastic many-particle model for LFP electrodes",
            "venue": "Contin. Mech. Thermodyn.,",
            "year": 2018
        },
        {
            "authors": [
                "F. Harang",
                "A. Mayorcas"
            ],
            "title": "Pathwise regularisation of singular interacting particle systems and their mean field limits",
            "venue": "arXiv preprint arXiv:2010.15517,",
            "year": 2020
        },
        {
            "authors": [
                "S. Herrmann",
                "P. Imkeller"
            ],
            "title": "Peithmann. Large deviations and a Kramers\u2019 type law for self-stabilizing diffusions",
            "venue": "Ann. Appl. Probab.,",
            "year": 2008
        },
        {
            "authors": [
                "S. Herrmann",
                "J. Tugaut"
            ],
            "title": "Self-stabilizing processes: uniqueness problem for stationary measures and convergence rate in the small-noise limit",
            "venue": "ESAIM Probab. Stat.,",
            "year": 2012
        },
        {
            "authors": [
                "D.D. Holm",
                "V. Putkaradze"
            ],
            "title": "Formation of clumps and patches in self-aggregation of finitesize particles",
            "venue": "Phys. D,",
            "year": 2006
        },
        {
            "authors": [
                "X. Huang",
                "P. Ren",
                "F.-Y. Wang"
            ],
            "title": "Distribution dependent stochastic differential equations",
            "venue": "Front. Math. China,",
            "year": 2021
        },
        {
            "authors": [
                "M. Hutzenthaler",
                "A. Jentzen"
            ],
            "title": "Numerical approximations of stochastic differential equations with non-globally Lipschitz continuous coefficients",
            "venue": "Mem. Amer. Math. Soc.,",
            "year": 2015
        },
        {
            "authors": [
                "M. Hutzenthaler",
                "T. Kruse",
                "T.A. Nguyen"
            ],
            "title": "Multilevel Picard approximations for McKean- Vlasov stochastic differential equations",
            "venue": "J. Math. Anal. Appl., 507(1):Paper No. 125761,",
            "year": 2022
        },
        {
            "authors": [
                "S. Jin",
                "L. Li",
                "J.-G. Liu"
            ],
            "title": "Random batch methods (RBM) for interacting particle systems",
            "venue": "J. Comput. Phys., 400:108877,",
            "year": 2020
        },
        {
            "authors": [
                "T. Kolokolnikov",
                "J.A. Carrillo",
                "A. Bertozzi",
                "R. Fetecau",
                "M. Lewis"
            ],
            "title": "Emergent behaviour in multi-particle systems with non-local interactions [Editorial",
            "venue": "Phys. D,",
            "year": 2013
        },
        {
            "authors": [
                "C. Kumar",
                "Neelima"
            ],
            "title": "On explicit Milstein-type scheme for McKean-Vlasov stochastic differential equations with super-linear drift coefficient",
            "venue": "Electron. J. Probab., 26:Paper No. 111,",
            "year": 2021
        },
        {
            "authors": [
                "D. Lacker"
            ],
            "title": "On a strong form of propagation of chaos for McKean-Vlasov equations",
            "venue": "Electron. Commun. Probab., 23:Paper No. 45,",
            "year": 2018
        },
        {
            "authors": [
                "D. Lacker"
            ],
            "title": "Hierarchies, entropy, and quantitative propagation of chaos for mean field diffusions",
            "venue": "arXiv e-prints, pages arXiv\u20132105,",
            "year": 2021
        },
        {
            "authors": [
                "D.-H. Li",
                "W. Cheng"
            ],
            "title": "Recent progress in the global convergence of quasi-Newton methods for nonlinear equations",
            "venue": "Hokkaido Math. J.,",
            "year": 2007
        },
        {
            "authors": [
                "L. Li",
                "J.-G. Liu",
                "P. Yu"
            ],
            "title": "On the mean field limit for Brownian particles with Coulomb interaction in 3D",
            "venue": "J. Math. Phys., 60(11):111501,",
            "year": 2019
        },
        {
            "authors": [
                "A. Lionnet",
                "G. dos Reis",
                "L. Szpruch"
            ],
            "title": "Time discretization of FBSDE with polynomial growth drivers and reaction-diffusion PDEs",
            "venue": "Ann. Appl. Probab.,",
            "year": 2015
        },
        {
            "authors": [
                "F. Malrieu"
            ],
            "title": "Convergence to equilibrium for granular media equations and their Euler schemes",
            "venue": "Ann. Appl. Probab.,",
            "year": 2003
        },
        {
            "authors": [
                "F. Malrieu",
                "D. Talay"
            ],
            "title": "Concentration inequalities for Euler schemes. In Monte Carlo and quasi-Monte Carlo methods 2004, pages 355\u2013371",
            "year": 2006
        },
        {
            "authors": [
                "C. Marchioro",
                "M. Pulvirenti"
            ],
            "title": "Mathematical theory of incompressible nonviscous fluids, volume 96 of Applied Mathematical Sciences",
            "year": 1994
        },
        {
            "authors": [
                "M. J"
            ],
            "title": "Mart\u0131nez. Practical quasi-Newton methods for solving nonlinear systems",
            "venue": "Journal of computational and Applied Mathematics,",
            "year": 2000
        },
        {
            "authors": [
                "H.P. McKean",
                "Jr."
            ],
            "title": "A class of Markov processes associated with nonlinear parabolic equations",
            "venue": "Proc. Nat. Acad. Sci. U.S.A.,",
            "year": 1966
        },
        {
            "authors": [
                "H.G. Othmer",
                "A. Stevens"
            ],
            "title": "Aggregation, blowup, and collapse: the ABCs of taxis in reinforced random walks",
            "venue": "SIAM J. Appl. Math.,",
            "year": 1997
        },
        {
            "authors": [
                "C. Reisinger",
                "W. Stockinger"
            ],
            "title": "An adaptive Euler-Maruyama scheme for McKean-Vlasov SDEs with super-linear growth and application to the mean-field FitzHugh-Nagumo model",
            "venue": "J. Comput. Appl. Math., 400:Paper No. 113725,",
            "year": 2022
        },
        {
            "authors": [
                "M.V. Solodov",
                "B.F. Svaiter"
            ],
            "title": "A globally convergent inexact Newton method for systems of monotone equations. In Reformulation: nonsmooth, piecewise smooth, semismooth and smoothing methods (Lausanne, 1997), volume 22 of Appl. Optim., pages 355\u2013369",
            "venue": "Kluwer Acad. Publ., Dordrecht,",
            "year": 1999
        },
        {
            "authors": [
                "E. S\u00fcli",
                "D.F. Mayers"
            ],
            "title": "An introduction to numerical analysis",
            "year": 2003
        },
        {
            "authors": [
                "X. Mao"
            ],
            "title": "Stochastic differential equations and applications",
            "venue": "Horwood Publishing Limited, Chichester, second edition,",
            "year": 2008
        },
        {
            "authors": [
                "A.-S. Sznitman"
            ],
            "title": "Topics in propagation of chaos",
            "venue": "Ecole d\u2019Ete\u0301 de Probabilite\u0301s de Saint-Flour XIX \u2014",
            "year": 1989
        },
        {
            "authors": [
                "D. Talay",
                "O. Vaillant"
            ],
            "title": "A stochastic particle method with random weights for the computation of statistical solutions of McKean-Vlasov equations",
            "venue": "Ann. Appl. Probab.,",
            "year": 2003
        },
        {
            "authors": [
                "J. Tugaut"
            ],
            "title": "Convergence to the equilibria for self-stabilizing processes in double-well landscape",
            "venue": "Ann. Probab.,",
            "year": 2013
        }
    ],
    "sections": [
        {
            "text": "numerical simulation of interacting particle Stochastic Differential Equation (SDE) systems and McKean-Vlasov Stochastic Differential Equations (MV-SDEs) with full super-linear growth in the spatial and the interaction component in the drift, and non-constant Lipschitz diffusion coefficient.\nThe super-linear growth in the interaction (or measure) component stems from convolution operations with super-linear growth functions allowing in particular application to the granular media equation with multi-well confining potentials. From a methodological point of view, we avoid altogether functional inequality arguments (as we allow for non-constant non-bounded diffusion maps).\nThe scheme attains, in stepsize, a near-optimal classical (path-space) root mean-square error rate of 1/2 \u2212 \u03b5 for \u03b5 > 0 and an optimal rate 1/2 in the non-path-space mean-square error metric. All findings are illustrated by numerical examples. In particular, the testing raises doubts if taming is a suitable methodology for this type of problem (with convolution terms and nonconstant diffusion coefficients).\nKeywords: stochastic interacting particle systems, McKean-Vlasov equations, split-step Euler methods, superlinear growth in measure, superlinear growth in space 2000 MSC: 65C05, 65C30, 65C35\nContents 1 Introduction 2\n2 The split-step method for MV-SDEs and interacting particle systems 5 2.1 Notation and Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 2.2 Framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 2.3 The scheme for the interacting particle system and main results . . . . . . . . . . . . . . . . . . . . . . . . 9\n3 Examples of interest 11 3.1 Example: the granular media equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 3.2 Example: Double-well model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 3.3 Example: 2d Van der Pol (VdP) oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 3.4 Numerical complexity, discussion and various opens questions . . . . . . . . . . . . . . . . . . . . . . . . . 15\n*G.d.R. acknowledges support from the Funda\u00e7a\u0303o para a Cie\u0302ncia e a Tecnologia (Portuguese Foundation for Science and Technology) through the project UIDB/00297/2020 and UIDP/00297/2020 (Centro de Matem\u00e1tica e Aplica\u00e7o\u0303es CMA/FCT/UNL).\nar X\niv :2\n20 8.\n12 77\n2v 2\n[ m\nat h.\nPR ]\n2 7\nM ar\n2 02\n4 Proof of split-step method (SSM) for MV-SDEs and interacting particle systems: convergence and stability 17 4.1 Some properties of the scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 4.2 Proof of the pointwise convergence result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 4.3 Proof of the moment bound result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 4.4 Proof of Theorem 2.11, the uniform convergence result in path-space . . . . . . . . . . . . . . . . . . . . . 27 4.5 Discussion on the granular media type equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\nA Well-posedness of the particle system and the PoC \u2013 Proposition 2.5 32\nB Solving the implicit equation of the SSM and a deployment of Newton\u2019s method 34 B.1 Approximation scheme to the SSM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 B.2 Deploying Newton\u2019s method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36"
        },
        {
            "heading": "1 Introduction",
            "text": "Interactions of organisms, humans, and objects are common phenomena seen easily in collective behaviour within natural and social sciences. Models for interacting particle systems (IPS) and their mesoscopic limits, as the number of particles grows to infinity, receive presently enormous attention given their applicability in areas such as finance, mathematical neuroscience, biology, machine learning, and physics: animal swarming, cell movement induced by chemotaxis, opinion dynamics, particle movement in porous media, electrical battery modelling, self-assembly of particles (see for example [5, 10, 11, 13, 14, 24, 27, 29, 33, 37, 38, 43, 47, 50] and references). In this work, we address the numerical approximation of interacting particle systems given by stochastic differential equations (SDE) and their mesoscopic limit equations (or a class thereof) called McKean\u2013Vlasov Stochastic Differential Equations (MV-SDE) that follow as the scaling limit of an infinite number of particles.\nWe understand the IPS as an N -dimensional system of Rd-valued interacting particles where each particle is governed by a Stochastic Differential Equation (SDE). Let i = 1, \u00b7 \u00b7 \u00b7 , N and consider N particles (Xi,Nt )t\u2208[0,T ] with independent and identically distributed X i,N 0 = X i 0 (the initial condition is random, but independent of other particles) and satisfying the (Rd)N -valued SDE (1.1) dXi,Nt = ( v(Xi,Nt , \u00b5 X,N t ) + b(t,X i,N t , \u00b5 X,N t ) ) dt+ \u03c3(t,Xi,Nt , \u00b5 X,N t )dW i t , X i,N 0 = X i 0 \u2208 Lm0 (Rd),\n(1.1)\nfor v(Xi,Nt , \u00b5 X,N t ) = ( 1 N N\u2211 j=1 f(Xi,Nt \u2212X j,N t ) ) + u(Xi,Nt , \u00b5 X,N t ) with \u00b5 X,N t (dx) := 1 N N\u2211 j=1 \u03b4 Xj,Nt (dx),\n(1.2)\nwhere \u03b4 Xj,Nt is the Dirac measure at point Xj,Nt , {W i}i=1,\u00b7\u00b7\u00b7 ,N are independent Brownian motions and Lm0 (Rd) denotes the usual mth-moment integrable space of Rd random variables.\nFor the IPS class (1.1), the limiting class as N \u2192 \u221e are called McKean-Vlasov SDEs and the passage to the limit operation is known as \u201cPropagation of Chaos\u201d. This class was first described by McKean [49], where he introduced the convolution type interaction (the v in (1.2)). This is a class of Markov processes associated with nonlinear parabolic equations where the map v in (1.2) is also called \u201cself-stabilizing\u201d. The IPS underpinning our work (1.1)-(1.2) has been studied widely, from a variety of points of view and as early as [55] (for a general survey under global Lipschitz conditions and boundedness).\nMcKean-Vlasov Stochastic Differential Equations (MV-SDEs) with convolution type drifts have general dynamics given by\ndXt = ( v(Xt, \u00b5 X t ) + b(t,Xt, \u00b5 X t ) ) dt+ \u03c3(t,Xt, \u00b5 X t )dWt, X0 \u2208 Lm0 (Rd), (1.3)\nwhere v(x, \u00b5) = \u222b Rd f(x\u2212 y)\u00b5(dy) + u(x, \u00b5) with \u00b5Xt = Law(Xt), (1.4)\nwhere \u00b5Xt denotes the law of the solution process X at time t, W is a Brownian motion in Rd, v, f, u, b, \u03c3 are measurable maps along with a sufficiently integrable initial condition X0.\nAn embodiment (among many) for this typology of models is particle motion modelling that encapsulates three sources of forcing. Namely, the particle moves through a multi-well landscape potential gradient (the map u and b), the trajectories are affected by a Brownian motion (and associated diffusion coefficient \u03c3), and the convolution self-stabilisation forcing characterises the influence of a large population of identical particles (under the same laws of motion v and f) on the particle. In effect, v acts on the particle as an average attractive/repulsive force exerted on the said particle by a population of similar particles (through the potential f), see [1, 57] and further examples in [37]. For instance, under certain constraints on f the map v adds inertia to the particle\u2019s motion, which in turn delays exit times from the domain of attraction and alters exit locations [1, 22, 31]. The self-stabilisation term in the system induces in the corresponding Fokker-Plank equation a nonlinear term of the form \u2207[\u03c1.\u2207(f ? \u03c1)] (where \u03c1 stands for the processes density while \u2018?\u2019 is the usual convolution operator) [13, 14, 37]. The granular media Fokker-Plank equation from biochemistry is a good example of an equation featuring this kind of structure [1, 15, 46]. The literature on MV-SDE is growing explosively with many contributions addressing wellposedness, regularity, ergodicity, nonlinear Fokker-Planck equations, large deviations [2, 3, 22, 34]. The convolution framework has been given particular attention as it underpins many settings of interest [15, 30, 46, 57]. The literature is even richer under the restriction to a constant diffusion term, \u03c3 = const, as it gives access to methodologies based on Langevin-type dynamics but also to the machinery of Functional inequalities (e.g., log-Sobolev and Poincare inequalities). We point to [30] for a nice overview on several open problems of interest where f is a singular kernel (and \u03c3 is a constant): including Coulomb interaction f(x) = x/|x|d, Bio-Savart law f(x) = x\u22a5/|x|d; CuckerSmale models f(x) = (1 + |x|2)\u2212\u03b1 for \u03b1 > 0; crystallisation f(x) = |x|\u22122p\u2212 2|x|\u2212p and take p\u2192\u221e; 2D viscous vortex model with f(x) = x/|x|2 [25].\nSuper-linear interaction forces. For the IPS (1.1)-(1.2) or the MV-SDE (1.3)-(1.4), we focus on the class where the involved functions are not (necessarily) globally Lipschitz functions. Concretely, the map v is a super-linear growth function in both space and measure component \u2014 we assume that f and u in (1.4) behave like a general polynomial but also satisfy a one-sided Lipschitz condition to control for radial growth (the specific details are given in Assumption 2.1 below); the maps b and \u03c3 are assumed globally Lipschitz functions.\nFrom the theoretical point of view, this class is presently well understood. Well-posedness was generally established in [1]; [32] investigate different properties of the invariant measures for particles in double-well confining potential and later [57] investigate the convergence to stationary states. Large deviations and exit times for such self-stabilising diffusions are established in [1, 31]. The study of probabilistic properties and parametric inference (under constant diffusion) for this class is given in [26]. Two recent studies on parametric inference [7, 18] include numerical studies for the particle interaction ([26] does not) but do not tackle super-linear growth in the interaction component ([26] does).\nTo the best of our knowledge and except for [45], no numerical methods exists for this class as no general method allows for super-linear growth interaction kernels. For emphasis, standard\nSDE results for super-linear growth drifts do not yield convergence results independent of the number of particles N . In other words, by treating the interacting particle system (1.1) as an (Rd)N - dimensional SDE known results from SDE numerics with coefficients with super-linear growth can be applied directly. However, all estimates would depend on the system\u2019s dimension, Nd, and hence \u201cexplode\u201d as N tends to infinity. In this work, we introduce new technical elements to overcome this difficulty, which, to the best of our knowledge, are new. It\u2019s noteworthy to observe that the direct numerical discretization of the IPS system (1.1)-(1.2) leads to a costly computational cost of O(N2) and hence care is needed.\nMany of the current numerical methods in the literature of MV-SDEs rely on the particle approximation given by the IPS, and the known quantified rate for the propagation of chaos [1, 16, 40, 41]: taming [21, 39], time-adaptive [51], early Split-Step Methods (SSM) methods [17] \u2013 all these contributions allow for super-linear growth in space only. Further noteworthy contributions include [4, 6, 8, 12, 19, 23, 28, 36, 56]. Within the existing literature, no method can deal with a super-linear growth f component; all cited works make the assumption of a Lipschitz behaviour in \u00b5 7\u2192 v(\u00b7, \u00b5) (which, in essence, entail that \u2207f is bounded).\nOur contribution. The results of this manuscript provide for both the numerical approximation of interacting particle SDE systems (1.1)-(1.2), and McKean\u2013Vlasov SDEs (1.3)-(1.4).\nThe main contribution of this work is the numerical scheme and its convergence analysis. We present a particle approximation SSM algorithm inspired in [17] for the numerical approximation of MV-SDEs and associated particle systems with drifts featuring super-linear growth in space and measure, and where the diffusion coefficient satisfies a general Lipschitz condition. The well-posedness result (Theorem 2.3 below) and Propagation of Chaos (Proposition 2.5 below) follow from known literature [1] \u2013 in fact, our Proposition 2.5 establishes the well-posedness of the particle system hence closing the small gap present in [1, Theorem 3.14]. The only existing work tackling this involved setting via a fully implicit scheme is [45]. They rely on (Bakry-Emery) functional inequalities methodologies under specific structural assumptions (constant elliptic diffusion, u = b = 0 and differentiability) that we do not make.\nThe scheme we propose is a split-step scheme inspired in [17] (see Definition 2.6 below) that first solves an implicit equation given by the SDE\u2019s drift component only then takes that outcome and feeds it to the remaining dynamics of the SDE via a standard Euler step. The idea is that the implicit step deals with the problematic super-linear growth part, and the elements passed to the Euler step are better behaved. In [17], there is only super-linear growth in the space variables, and the measure component is assumed Lipschitz; here both space and measure component have super-linear growth. From a practical point of view, the implicit step in [17] for a particle i only depended on the elements of particle i (the measure being fixed to the previous time step); hence one solves N decoupled equations in Rd. In this manuscript, the implicit step for particle i involves the whole system of particles entailing that one needs to solve one-single system but in (Rd)N and the solution depends on all terms. This change in the scheme makes it much harder to obtain moment estimates for the scheme. For the setting of [17] there were already several competitive schemes present in the literature, e.g., taming [21, 39] and time-adaptive [51] and the numerical study there was comparative. For this work, no alternative numerical scheme exists \u2013 see below for further discussion regarding the implementation of taming for this class.\nResults-wise, we provide two convergence results in the strong-error1 sense. For the classical (path-space) root mean-square error, see Theorem 2.11, we achieve a nearly-optimal convergence\n1We understand a \u201cstrong\u201d error metric as a metric that depends on the joint distribution of the true solution and the numerical approximation. In contrast to the weak error where one needs only the marginals separately. Theorem 2.9 and 2.11 showcase two \u201cstrong\u201d but different error metrics.\nrate of 1/2 \u2212 \u03b5 with \u03b5 > 0. The main difficulty, also where one of our main contributions lie, is in establishing higher-order moment bounds for the numerical scheme in a way that is compatible with the convolution component in (1.2) or (1.4) and It\u00f4-type arguments \u2013 see Theorem 2.10. We provide a second strong (non-path-space) mean-square error criteria, see Theorem 2.10, that attains the optimal rate 1/2. This 2nd result requires only the higher moments of the IPS\u2019 solution process and the 2nd-moments of the numerical approximation [9] (which are easier to obtain). We emphasise that this 2nd notion of strong convergence (see Theorem 2.10) is also standard (albeit less) within Monte Carlo literature. It also controls the variance of the approximation error (simply not in path-space). Hence, it is sufficient for the many uses one can give to the simulation output \u2013 as one would do given any other Monte Carlo estimators (e.g., confidence intervals). Lastly, we show that with a constant diffusion coefficient, one attains the higher convergence rate of 1.0 (see Theorem 2.13).\nWe illustrate our findings with extended numerical tests showing agreement with the theoretical results and discussing other properties for schemes: periodicity in phase-space, the impact of the number of particles and numerical rate of Propagation of Chaos, and complexity versus runtime. For comparison, we implement the taming algorithm [21] for the setting (without proof) and find that in the example with constant diffusion, taming performs similarly to the SSM. In the non-constant diffusion example, it performs very poorly. This latter finding raises questions (for future research) if taming is a suitable methodology for this class.\nOrganisation of the paper. In Section 2 we set the notation and framework. In Section 2.3, we state the SSM scheme and the two main convergence results. Section 3 provides numerical illustrations (for the granular media model and a double-well model with non-constant diffusion). All proofs are given in Section 4."
        },
        {
            "heading": "2 The split-step method for MV-SDEs and interacting particle systems",
            "text": "We follow the notation and framework set in [1, 17]."
        },
        {
            "heading": "2.1 Notation and Spaces",
            "text": "Let N be the set of natural numbers starting at 0, R denotes the real numbers. For a, b \u2208 N with a \u2264 b, define Ja, bK := [a, b] \u2229 N = {a, \u00b7 \u00b7 \u00b7 , b}. For x, y \u2208 Rd denote the scalar product of vectors by x \u00b7 y; and |x| = ( \u2211d j=1 x 2 j )\n1/2 the Euclidean distance. The 0 denotes the origin in Rd. Let 1A be the indicator function of set A \u2282 Rd. For a matrix A \u2208 Rd\u00d7n we denote by A\u1d40 its transpose and its Frobenius norm by |A| = Trace{AA\u1d40}1/2. Let Id : Rd \u2192 Rd be the identity map. For collections of vectors, let the upper indices denote the distinct vectors, whereas the lower index is a vector component, i.e., xlj denote the j-th component of l-th vector. \u2207 denotes the vector differential operator, \u2202 denotes the partial differential operator.\nWe introduce over Rd the space of probability measures P(Rd) and its subset P2(Rd) of those with finite second moment. The space P2(Rd) is Polish under the Wasserstein distance\nW (2)(\u00b5, \u03bd) = inf \u03c0\u2208\u03a0(\u00b5,\u03bd) (\u222b Rd\u00d7Rd |x\u2212 y|2\u03c0(dx,dy) ) 1 2 , \u00b5, \u03bd \u2208 P2(Rd). (2.1)\nwhere \u03a0(\u00b5, \u03bd) is the set of couplings for \u00b5 and \u03bd such that \u03c0 \u2208 \u03a0(\u00b5, \u03bd) is a probability measure on Rd \u00d7 Rd such that \u03c0(\u00b7 \u00d7 Rd) = \u00b5 and \u03c0(Rd \u00d7 \u00b7) = \u03bd.\nLet our probability space be a completion of (\u2126,F,F ,P) with F = (Ft)t\u22650 carrying an Rl-valued Brownian motion W = (W 1, \u00b7 \u00b7 \u00b7 ,W l) and generating the probability space\u2019s filtration, augmented\nby all P-null sets, and with an additionally sufficiently rich sub \u03c3-algebra F0 independent of W . We denote by E[\u00b7] = EP[\u00b7] the usual expectation operator with respect to P.\nWe consider some finite terminal time T < \u221e and use the following notation for spaces (standard in the (McKean-Vlasov) SDE literature [17, 21]). For 0 \u2264 t \u2264 T , let Lpt ( Rd )\ndefine the space of Rd-valued, Ft-measurable random variables X, that satisfy E [|X|p]1/p <\u221e. Define Sm([0, T ]) to be, for m > 1, the space of Rd -valued, F\u00b7-adapted processes Z, that satisfy E [ sup06t6T |Zt|m ]1/m <\u221e.\nThroughout the text, C denotes a generic constant positive real number that may depend on the problem\u2019s data, may change from line to line but is always independent of the constants h,M,N (associated with the numerical scheme and specified below) but possibly depend on the terminal time T (and other fixed problem data)."
        },
        {
            "heading": "2.2 Framework",
            "text": "Let W be an l-dimensional Brownian motion and take the measurable maps v : Rd \u00d7 P2(Rd)\u2192 Rd, f : Rd \u2192 Rd, b : [0, T ]\u00d7Rd\u00d7P2(Rd)\u2192 Rd and \u03c3 : [0, T ]\u00d7Rd\u00d7P2(Rd)\u2192 Rd\u00d7l. The MV-SDE of interest for this work is Equation (1.3) (for some m \u2265 1), where \u00b5Xt denotes the law of the process X at time t, i.e., \u00b5Xt = P \u25e6X\u22121t . We make the following assumptions on the coefficients.\nAssumption 2.1. Let b and \u03c3 1/2-H\u00f6lder continuous in time, uniformly in x \u2208 Rd and \u00b5 \u2208 P2(Rd). Assume that b, \u03c3 are uniformly Lipschitz in the sense that there exists Lb, L\u03c3 \u2265 0 such that for all t \u2208 [0, T ] and all x, x\u2032 \u2208 Rd and \u2200\u00b5, \u00b5\u2032 \u2208 P2(Rd) we have that\n(Ab) |b(t, x, \u00b5)\u2212 b(t, x\u2032, \u00b5\u2032)|2 \u2264 Lb ( |x\u2212 x\u2032|2 +W (2)(\u00b5, \u00b5\u2032)2 ) ,\n(A\u03c3) |\u03c3(t, x, \u00b5)\u2212 \u03c3(t, x\u2032, \u00b5\u2032)|2 \u2264 L\u03c3 ( |x\u2212 x\u2032|2 +W (2)(\u00b5, \u00b5\u2032)2 ) .\n(Au) Let u satisfy: there exist Lu \u2208 R, Lu\u0302 > 0, Lu\u0303 \u2265 0, q1 > 0 such that for all t \u2208 [0, T ], x, x\u2032 \u2208 Rd and \u2200\u00b5, \u00b5\u2032 \u2208 P2(Rd), it holds that\n\u3008x\u2212 x\u2032, u(x, \u00b5)\u2212 u(x\u2032, \u00b5)\u3009 \u2264 Lu|x\u2212 x\u2032|2 (One-sided Lipschitz in space), |u(x, \u00b5)\u2212 u(x\u2032, \u00b5)| \u2264 Lu\u0302(1 + |x|q1 + |x\u2032|q1)|x\u2212 x\u2032| (Locally Lipschitz in space), |u(x, \u00b5)\u2212 u(x, \u00b5\u2032)|2 \u2264 Lu\u0303W (2)(\u00b5, \u00b5\u2032)2 (Lipschitz in measure).\n(Af ) Let f satisfy: there exist Lf \u2208 R, Lf\u0302 > 0, q2 > 0 such that for all t \u2208 [0, T ], x, x \u2032 \u2208 Rd, it\nholds that\n\u3008x\u2212 x\u2032, f(x)\u2212 f(x\u2032)\u3009 \u2264 Lf |x\u2212 x\u2032|2 (One-sided Lipschitz), |f(x)\u2212 f(x\u2032)| \u2264 Lf\u0302 (1 + |x| q2 + |x\u2032|q2)|x\u2212 x\u2032| (Locally Lipschitz),\nf(x) = \u2212f(\u2212x), (Odd function).\nAssume the normalisation2 f(0) = 0. Lastly, and for convenience, we set q = max{q1, q2} (and we have q > 0).\nThe benefits of choosing drift=v + b with b being uniformly Lipschitz are discussed below in Remark 2.7 (see also [17]). Certain useful properties can be derived from these assumptions.\n2This constraint is a soft as the framework allows to easily redefine f as f\u0302(x) := f(x)\u2212 f(0) with f(0) merged into b.\nRemark 2.2 (Implied properties). Under Assumption 2.1, take some C > 0. Then for all t \u2208 [0, T ], x, x\u2032, z \u2208 Rd and \u00b5 \u2208 P2(Rd), since f is a normalised odd function (i.e., f(0) = 0), we have\n\u3008x, f(x)\u3009 = \u3008x\u2212 0, f(x)\u2212 f(0)\u3009+ \u3008x, f(0)\u3009 \u2264 Lf |x|2 + |x||f(0)| = Lf |x|2.\nAlso, for the function u, define L\u0302u = Lu + 1/2, Cu = |u(0, \u03b40)|2, and thus by Young\u2019s inequality\n\u3008x, u(x, \u00b5)\u3009 \u2264 Cu + L\u0302u|x|2 + Lu\u0303W (2)(\u00b5, \u03b40)2, \u3008x\u2212 x\u2032, u(x, \u00b5)\u2212 u(x\u2032, \u00b5\u2032)\u3009 \u2264 L\u0302u|x\u2212 x\u2032|2 + Lu\u0303 2 W (2)(\u00b5, \u03b40) 2.\nUsing the properties of the convolution, v of (1.3) also satisfies a one-sided Lipschitz condition in space \u3008x\u2212 x\u2032, v(x, \u00b5)\u2212 v(x\u2032, \u00b5)\u3009 \u2264 \u222b Rd Lf |x\u2212 x\u2032|2\u00b5(dz) + Lu|x\u2212 x\u2032|2 = (Lf + Lu)|x\u2212 x\u2032|2.\nMoreover, for \u03c8 \u2208 {b, \u03c3}, by Young\u2019s inequality, we have\n\u3008x, \u03c8(t, x, \u00b5)\u3009 \u2264 C(1 + |x|2 +W (2)(\u00b5, \u03b40)2) and |\u03c8(t, x, \u00b5)|2 \u2264 C(1 + |x|2 +W (2)(\u00b5, \u03b40)2).\nWe first recall a result from [1] establishing well-posedness of the MV-SDE (1.3)-(1.4).\nTheorem 2.3 (Theorem 3.5 in [1]). Let Assumption 2.1 hold and assume for some m > 2(q + 1), X0 \u2208 Lm0 (Rd). Then, there exists a unique solution X to MV-SDE (1.3) in Sm([0, T ]). For some constant C > 0 (depending on T and m) we have\nE [\nsup 0\u2264t\u2264T\n|Xt|m\u0302 ] \u2264 C ( 1 + E [ |X0|m\u0302 ]) eCT , for any m\u0302 \u2208 [2,m].\nProof. Our Assumption 2.1 is a particularisation of [1, Assumption 3.4] and hence our theorem follows directly from [1, Theorem 3.5].\nThe interacting particle system (1.1). As mentioned earlier, the numerical approximation results of this work apply directly if either one\u2019s starting point is the interacting particle system (1.1) or if one\u2019s starting point is the MV-SDE (1.3). On the latter, one can approximate the MV-SDE (1.3) (driven by the Brownian motion W ) by the N -dimensional system Rd-valued interacting particle system given in (1.1) and approximate it numerically with the gap closed by the Propagation of Chaos [17, 21, 51].\nFor completeness we recall the setup of (1.1). Let i \u2208 J1, NK and considerN particles (Xi,N )t\u2208[0,T ] with independent and identically distributed (i.i.d.) initial conditions Xi,N0 = X i 0 and satisfying the (Rd)N -valued SDE (1.1) (with v given in (1.4))\ndXi,Nt = ( v(Xi,Nt , \u00b5 X,N t ) + b(t,X i,N t , \u00b5 X,N t ) ) dt+ \u03c3(t,Xi,Nt , \u00b5 X,N t )dW i t , X i,N 0 = X i 0,\nwhere \u00b5X,Nt (dx) := 1 N \u2211N j=1 \u03b4Xj,Nt (dx) with \u03b4 Xj,Nt being the Dirac measure at point Xj,Nt , and W i, i \u2208 J1, NK being independent Brownian motions (also independent of the BM W appearing in (1.3); with a slight abuse of notation to avoid re-defining the probability space\u2019s filtration).\nRemark 2.4 (The system through the lens of RNd). We introduce the map V to interpret (1.1) as one system of equations in RNd instead of N dependent equations each in Rd. Namely, we define for v given by (1.4),\nV = (V1, \u00b7 \u00b7 \u00b7 , VN ) : (Rd)N \u2192 (Rd)N where for i \u2208 J1, NK Vi : (Rd)N \u2192 Rd, Vi(XN ) = v(Xi,N , \u00b5X,N ), (2.2)\nand XN = (X1,N , \u00b7 \u00b7 \u00b7 , XN,N ) \u2208 RNd where each Xi,N solves (1.1), \u00b5X,N (dx) := 1N \u2211N\nj=1 \u03b4Xj,N (dx). For XN , Y N \u2208 RNd with corresponding measure \u00b5X,N , \u00b5Y,N and letting Assumption 2.1 hold, the\nfunction V also satisfies a one-sided Lipschitz condition\n\u3008XN \u2212 Y N , V (XN )\u2212 V (Y N )\u3009\n= 1\n2N N\u2211 i=1 N\u2211 j=1 \u2329 (Xi,N \u2212Xj,N )\u2212 (Y i,N \u2212 Y j,N ), f(Xi,N \u2212Xj,N )\u2212 f(Y i,N \u2212 Y j,N ) \u232a\n+ N\u2211 i=1 \u2329 Xi,N \u2212 Y i,N , u(Xi,N , \u00b5X,N )\u2212 u(Y i,N , \u00b5X,N ) + u(Y i,N , \u00b5X,N )\u2212 u(Y i,N , \u00b5Y,N ) \u232a \u2264 (2L+f + Lu + 1 2 + Lu\u0303 2 )|XN \u2212 Y N |2, L+f = max{0, Lf}.\nIn the last second step we changed the order of summation and used that f is odd.\nPropagation of chaos (PoC). In order to show that the particle approximation (1.1) is of effective use to approximate the MV-SDE (1.3), we provide a pathwise propagation of chaos result (convergence as the number of particles increases and with rate). We introduce the auxiliary system of non interacting particles\ndXit = ( v(Xit , \u00b5 Xi t ) + b(t,X i t , \u00b5 Xi t ) ) dt+ \u03c3(t,Xit , \u00b5 Xi t )dW i t , X i 0 = X i 0 , t \u2208 [0, T ] , (2.3)\nwhich are just (decoupled) MV-SDEs with i.i.d. initial conditions Xi0. Since the X is are independent, \u00b5X i\nt = \u00b5 X t for all i (and \u00b5 X t the law of the solution to (1.3) with v given as (1.4)).\nThe Propagation of chaos result (2.5) follows from [1, Theorem 3.14] under the assumption that the interacting particle system (1.1) is well-posed. The first statement of Proposition 2.5 establishes the well-posedness of the particle system hence closing the small gap left in [1, Theorem 3.14].\nProposition 2.5. Let the assumptions of Theorem 2.3 hold for some m > 2(q + 1). Then, for all i \u2208 J1, NK there exists a unique solution Xi,N to (1.1) in Sm([0, T ]) and for any 1 \u2264 p \u2264 m there exists C > 0 independent of N (but depending on T and m) such that\nsup t\u2208[0,T ] sup i\u2208J1,NK\nE [ |Xi,Nt |p ] \u2264 C ( 1 + E [ |X \u00b70|p ]) . (2.4)\nFor i \u2208 J1, NK, let Xi \u2208 Sm([0, T ]) be the solution to (2.3), ensured by Theorem 2.3. Suppose additionally that m > max{2(q + 1), 4}. Then, there exists a constant C > 0 independent of N (but depending on T and m) such that\nsup i\u2208J1,NK sup 0\u2264t\u2264T\nE [ |Xit \u2212X i,N t |2 ] \u2264 C  N\u22121/2, d < 4 N\u22121/2 logN, d = 4\nN \u22122 d+4 , d > 4\n. (2.5)\nThe proof and further details are presented in Appendix A. This result shows that the particle scheme will converge to the MV-SDE with a given quantified rate. Therefore, to show convergence between our numerical scheme and the MV-SDE, we only need to show that the numerical version of the particle scheme converges to the \u201ctrue\u201d particle scheme in a way that is independent of N . We note that the PoC rate can be optimised for the case of constant diffusion [17, Remark 2.5]."
        },
        {
            "heading": "2.3 The scheme for the interacting particle system and main results",
            "text": "The split-step method (SSM) here is inspired by that of [17] and re-cast accordingly to the setup here. The critical difficulty arises from the convolution component in v (1.3). This term is the main hindrance in proving moment bounds. Before continuing recall the definition of V in Remark 2.4. We now introduce the SSM numerical scheme.\nDefinition 2.6 (Definition of the SSM). Let Assumption 2.1 hold. Define the uniform partition of [0, T ] as \u03c0 := {tn := nh : n \u2208 J0,MK, h := T/M} for a prescribed M \u2208 N \\ {0}. Define recursively the SSM approximating (1.1) as: set X\u0302i,N0 = X i 0 for i \u2208 J1, NK; iteratively over n \u2208 J0,M \u2212 1K for all i \u2208 J1, NK (recall Remark 2.4 and the definition of the map V in (2.2))\nY ?,Nn = X\u0302 N n + hV (Y ?,N n ), X\u0302 N n = (\u00b7 \u00b7 \u00b7 , X\u0302i,Nn , \u00b7 \u00b7 \u00b7 ), Y ?,Nn = (\u00b7 \u00b7 \u00b7 , Y i,?,Nn , \u00b7 \u00b7 \u00b7 ), (2.6)\nwhere Y i,?,Nn = X\u0302 i,N n + hv(Y i,?,N n , \u00b5\u0302 Y,N n ), \u00b5\u0302 Y,N n (dx) :=\n1\nN N\u2211 j=1 \u03b4 Y j,?,Nn (dx), (2.7)\nX\u0302i,Nn+1 = Y i,?,N n + b(tn, Y i,?,N n , \u00b5\u0302 Y,N n )h+ \u03c3(tn, Y i,?,N n , \u00b5\u0302 Y,N n )\u2206W i n, \u2206W i n = W i tn+1 \u2212W i tn . (2.8)\nThe stepsize h is chosen as to belong to the interval (this constraint is soft in the sense of Remark 2.7)\nh \u2208 ( 0,min { 1, 1\n\u03b6\n}) for \u03b6 defined as \u03b6 = max { 2(Lf + Lu) , 4L + f + 2Lu + 2Lu\u0303 + 1 , 0 } . (2.9)\nIn some cases where the original functions f, u might cause trouble to find a suitable choice of h, and by the Remark below, we can use the addition and subtraction trick to bypass the constraint, see Remark 4.1 and [17, Section 3.4] for more discussion.\nRemark 2.7 (The constraint on h in (2.9) is soft). Our framework allows to change f, u, b in such a way as to have \u03b6 = 0 in (2.9) via addition and subtraction of linear terms to f, u and b. Concretely, take \u03b8, \u03b3 \u2208 R and redefine f, u, b into f\u0302 , u\u0302, b\u0302 as follows: for any t \u2208 [0,\u221e), x \u2208 Rd, \u00b5 \u2208 P2(Rd)\nf\u0302(x) = f(x)\u2212 \u03b8x, u\u0302(x, \u00b5) = u(x, \u00b5)\u2212 \u03b3x\u2212 \u03b8 \u222b Rd z\u00b5(dz), and b\u0302(t, x, \u00b5) = b(t, x, \u00b5) + (\u03b3 + \u03b8)x.\nFor judicious choices of \u03b8, \u03b3 it is easy to see that \u03b6 can be set to be zero (we invite the reader to carry out the calculations). We remark that this operation increases the Lipschitz constant of b\u0302.\nRecall that the function V satisfies a one-sided Lipschitz condition in X \u2208 RNd (Remark 2.4), and hence (under (2.9)) a unique solution Y ?,Nn to (2.6) as a function of X\u0302Nn exists (details in Lemma 4.2). After introducing the discrete scheme, we define its continuous extension and provide the main convergence results.\nDefinition 2.8 (Continuous extension of the SSM). Under the same choice of h and assumptions in Definition 2.6, for all t \u2208 [tn, tn+1], n \u2208 J0,M \u2212 1K , i \u2208 J1, NK, X\u0302i,N0 = Xi0 \u2208 Lm0 (Rd), the continuous extension of the SSM is\ndX\u0302i,Nt = ( v(Y i,?,N\u03ba(t) , \u00b5\u0302 Y,N \u03ba(t) ) + b(\u03ba(t), Y i,?,N \u03ba(t) , \u00b5\u0302 Y,N \u03ba(t) ) ) dt+ \u03c3(\u03ba(t), Y i,?,N\u03ba(t) , \u00b5\u0302 Y,N \u03ba(t) )dW i t , (2.10)\n\u00b5\u0302Y,Nn (dx) : = 1\nN N\u2211 j=1 \u03b4 Y j,?,Nn (dx), \u03ba(t) = sup { tn : tn \u2264 t, n \u2208 J0,M \u2212 1K } , \u00b5\u0302Y,Ntn = \u00b5\u0302 Y,N n .\nThe next result states our first strong convergence finding. It is a \u201cstrong\u201d pointwise (non-pathspace) convergence result that is not in the classical mean-square error form.\nTheorem 2.9 (Non-path-space mean-square convergence). Let Assumption 2.1 hold and choose h as in (2.9). Let i \u2208 J1, NK, take Xi,N as the solution to (1.1) and let X\u0302i,N be the continuous-time extension of the SSM given by (2.10). If m \u2265 4q + 4 > max{2(q + 1), 4}, where Xi0 \u2208 Lm0 (Rd) and q is as defined in Assumption 2.1, then there exists a constant C > 0 independent of h,N,M (but depending on T and m) such that\nsup i\u2208J1,NK sup 0\u2264t\u2264T\nE [ |Xi,Nt \u2212 X\u0302 i,N t |2 ] \u2264 Ch. (2.11)\nThe proof is presented in Section 4.2. This result does not need Lp-moment bounds of the scheme for p > 2. It needs only Lp-moments of the solution process of (1.1) and L2-moments for the scheme [9]. The proof takes advantage of the elegant structure induced by the SSM where Proposition 4.3 and 4.4 are the crucial intermediate results to deal with the convolution term.\nThe next moment bound result is necessary for the subsequent uniform convergence result.\nTheorem 2.10 (Moment bounds). Let the setting of Theorem 2.9 hold. Letm \u2265 2 whereXi0 \u2208 Lm0 (Rd) for all i \u2208 J1, NK and let X\u0302i,N be the continuous-time extension of the SSM given by (2.10). Let 2p \u2208 [2,m], then there exists a constant C > 0 independent of h,N,M (but depending on T and m) such that\nsup i\u2208J1,NK sup 0\u2264t\u2264T\nE [ |X\u0302i,Nt |2p ] \u2264 C ( 1 + E [ |X\u0302 \u00b70|2p ]) <\u221e. (2.12)\nThe proof is presented in Section 4.3 and builds around auxiliary Theorem 4.7. There, we expand (4.35) and (4.36), and leverage the properties of the SSM scheme stated in Proposition 4.3 and 4.4 to deal with the difficult convolution terms.\nNext we state the classic mean-square error convergence result.\nTheorem 2.11 (Classical path-space mean-square convergence). Let the setting of Theorem 2.9 hold. Assume there exists some \u03b5 \u2208 (0, 1) such that m \u2265 max{4q + 4, 2 + q + q/\u03b5} > max{2(q + 1), 4} with Xi0 \u2208 Lm0 (Rd) for i \u2208 J1, NK and q given as in Assumption 2.1. Then there exists a constant C > 0 independent of h,N,M (but depending on T and m) such that\nsup i\u2208J1,NK\nE [\nsup 0\u2264t\u2264T\n|Xi,Nt \u2212 X\u0302 i,N t |2\n] \u2264 Ch1\u2212\u03b5. (2.13)\nThe proof is presented in Section 4.4. For this result we need both the Lp-moments of the scheme and solution process. This in contrast to the proof methodology of Theorem 2.9 and the reason we introduce Theorem 2.10 as a main result. The nearly optimal error rate of (1\u2212\u03b5) is a consequence of the estimation of (4.46) (product of three unbounded random variables). The expectation is taken after the supremum and then we use Theorem 2.9 and 2.10 \u2013 this forces an \u03b5 sacrifice of the rate. The nearly optimal error rate of (1\u2212 \u03b5) is also the present best one available even for higher-order differences p > 2 (although we do not present these calculations). It is still open how to prove (2.12) with the supt inside the expectation \u2014 the difficulty to be overcome relates to establishing (4.3) of Proposition 4.4 under higher moments p > 2 in a way that aligns with carr\u00e9-du-champs type arguments and the convolution term (within the style of proof we provide, otherwise new arguments need be found). It remains an open problem to show (2.13) when \u03b5 = 0."
        },
        {
            "heading": "A particular result for granular media equation type models",
            "text": "We recast the earlier results to granular media type models where the diffusion coefficient is constant and higher convergence rates can be established.\nAssumption 2.12. Consider the following MV-SDE\ndXt = v(Xt, \u00b5 X t )dt+ \u03c3dWt, X0 \u2208 Lm0 (Rd), v(x, \u00b5) = \u222b Rd f(x\u2212 y)\u00b5(dy). (2.14)\nLet f : Rd \u2192 Rd be continuously differentiable satisfying (Af ) of Assumption 2.1. There exist Lf \u2032 , Lf \u2032\u2032 > 0, q \u2208 N and q > 1, with q the same as in (Af ), such that for all x, x\u2032 \u2208 Rd\n|\u2207f(x)| \u2264 Lf \u2032(1 + |x|q), |\u2207f(x)\u2212\u2207f(x\u2032)| \u2264 Lf \u2032\u2032(1 + |x|q\u22121 + |x\u2032|q\u22121)|x\u2212 x\u2032|. (2.15)\nThe function \u03c3 : [0, T ]\u00d7 Rd \u00d7 P2(Rd)\u2192 Rd\u00d7l is a constant matrix.\nIn the language of the granular media equation, MV-SDE (2.15) corresponds to the Fokker-Plank PDE \u2202t\u03c1 = \u2207 \u00b7 [\u2207\u03c1+ \u03c1\u2207W \u2217 \u03c1] where \u2207W = f and \u03c1 is the probability measure [45]. We have the following results.\nTheorem 2.13. Let Assumption 2.12 hold and choose h as in (2.9). Let i \u2208 J1, NK, take Xi,N to be the solution to (1.1), let X\u0302i,N be the continuous-time extension of the SSM given by (2.10) and Xi0 \u2208 Lm0 (Rd). Let m \u2265 max{8q, 4q + 4} > max{2(q + 1), 4} with q as defined in Assumption 2.12. Then there exist a constant C > 0 independent of h,N,M (but depending on T and m) such that\nsup i\u2208J1,NK sup 0\u2264t\u2264T\nE [ |Xi,Nt \u2212 X\u0302 i,N t |2 ] \u2264 Ch2. (2.16)\nThis result is proved in Section 4.5. Supporting simulation results are presented in Section 3.1 and confirm the strong root mean square error rate of 1.0.\nWe note that one can use a proof methodology similar to that used for Theorem 2.11 to obtain (2.16) with the supt inside the expectation. This would deliver a rate of h\n2\u2212\u03b5, the key steps are similar to (4.47)-(4.48)."
        },
        {
            "heading": "3 Examples of interest",
            "text": "We illustrate the SSM on three numerical examples.3 The \u201ctrue\u201d solution in each case is unknown and the convergence rates for these examples are calculated in reference to a proxy solution given by the approximating scheme at a smaller timestep h and higher number of particles N (particular details are given below). The strong error between the proxy-true solution XT and approximation X\u0302T is as follows\nroot Mean-square error (Strong error) = ( E [ |XT \u2212 X\u0302T |2 ]) 12 \u2248 ( 1 N N\u2211 j=1 |XjT \u2212 X\u0302 j T | 2 ) 1 2 .\nWe also consider the path strong error define as follows, for Mh = T , tn = nh,\nStrong error (Path) = ( E [\nsup 0\u2264t\u2264T\n|Xt \u2212 X\u0302t|2 ]) 12 \u2248 ( 1\nN N\u2211 j=1 sup n\u2208J0,MK |Xjtn \u2212 X\u0302 j tn | 2 ) 1 2 .\n3Implementation code in Python is available in https://github.com/AnandaChen/Simulation-of-super-measure\nThe propagation of chaos (PoC) rate between different particle systems {X\u0302i,NlT }i,l where i denotes the i-th particle and Nl denotes the size of the system,\nPropagation of chaos error (PoC error) \u2248 ( 1 Nl Nl\u2211 j=1 |X\u0302j,NlT \u2212X j T | 2 ) 1 2 .\nRemark 3.1 (\u2018Taming\u2019 algorithm). For comparative purposes we implement the \u2018Taming\u2019 algorithm [17, 21] \u2013 any convergence analysis of the taming algorithm to the framework of this manuscript is an open question. Of the many variants of Taming possible, set the terminal time T with Mh = T , we implement as follows: \u222b Rd f(\u00b7\u2212y)\u00b5(dy) is replaced by \u222b Rd f(\u00b7\u2212y)\u00b5(dy)/(1+M \u2212\u03b1| \u222b Rd f(\u00b7\u2212y)\u00b5(dy)|), and u is replaced by u/(1 +M\u2212\u03b1|u|) with the choice of \u03b1 = 1/2 for non-constant diffusion and \u03b1 = 1 for constant diffusion.\nWithin each example, the error rates of Taming and SSM are computed using the same Brownian motion paths.\nMoreover, for the simulation study below, we fix the algorithmic parameters as follows:\n1. For the strong error, the proxy-true solution is calculated with h = 10\u22124 and the approximations are calculated with h \u2208 {10\u22123, 2 \u00d7 10\u22123, . . . , 10\u22121} with N = 1000 at T = 1 and using the same Brownian motion paths. We compare SSM and Taming with the proxy-true solutions provided by the same algorithm (SSM and Taming) respectively.\n2. For the PoC error, the proxy-true solution is calculated with N = 2560 and the approximations are calculated with N \u2208 {40, 80, . . . , 1280}, with h = 0.001 at T = 1 and using the same Brownian motion paths.\n3. The implicit step (2.6) of the SSM algorithm is solved, in our examples, via a Newton method iteration. We point the reader to Appendix B for a full discussion. In practice, 2 to 4 Newton iterations are sufficient to ensure that the difference between two consecutive Newton iterates are not larger than \u221a h in \u2016 \u00b7 \u2016\u221e-norm (in RNd).\nLastly, the symbols N (\u03b1, \u03b2) denote the normal distribution with mean \u03b1 \u2208 R and variance \u03b2 \u2208 (0,\u221e)."
        },
        {
            "heading": "3.1 Example: the granular media equation",
            "text": "The first example is the granular media Fokker-Plank equation taking the form \u2202t\u03c1 = \u2207 \u00b7 [\u2207\u03c1+ \u03c1\u2207W \u2217 \u03c1] with W (x) = 13 |x|\n3 and \u03c1 is the correspondent probability density [15, 45]. In MV-SDE form we have\ndXt = v(Xt, \u00b5 X t )dt+ \u221a 2 dWt, X0 \u2208 Lm0 (Rd), v(x, \u00b5) = \u222b Rd ( \u2212 sign(x\u2212 y)|x\u2212 y|2 ) \u00b5(dy),\n(3.1)\nwhere sign(\u00b7) is the standard sign function, \u00b5Xt is the law of the solution process X at time t. This granular media model has been well studied in [15, 45] and is a reference model to showcase the numerical approximation. For this specific case, starting from a normal distribution, the particles concentrate and move around its initial mean value (also its steady state). In Figure 3.1 (a) and (b) one sees the evolution of the density map across time T \u2208 {1, 3, 10} for two initial initial distributions N (0, 1) and N (2, 4) respectively, and h = 0.01. For this case, both methods approximate well the solution without any apparent leading difference between Taming and SSM.\nFigure 3.1 (c) shows strong error of both methods, computed at T = 1 across h \u2208 {10\u22123, 2 \u00d7 10\u22123, . . . , 10\u22121}. The proxy-true solution for each method is taken at h = 10\u22124 and the baseline slopes for the \u201corder 1\u201d and \u201corder 0.5\u201d convergence rate are provided for comparison. The estimated rate of both method is 1.0 in accordance to Theorem 2.13 (under constant diffusion coefficient). Figure 3.1 (d) shows strong error v.s algorithm runtime of both methods under the same set up as in (c). The SSM perform slightly better than the Taming method.\nFigure 3.1 (e) shows the path type strong error of both method, compare to the results in (c), the SSM preserve the error rate of near 1.0 and perform better than the Taming method. Figure 3.1 (f) shows the PoC error of both methods. The two results coincide since the differences between two methods are within 0.001. The PoC rates are near 0.5 which is better than the theoretical result of 1/4 after we take square root in Proposition 2.5. This result is similar to [51, Example 4.1], and is explained theoretically by [20, Lemma 5.1] but under stronger assumptions than ours."
        },
        {
            "heading": "3.2 Example: Double-well model",
            "text": "We consider a limit model of particles under a symmetric double-well confinement. We test a variant of the model studied in [57] but change its diffusion coefficient to a non-constant one (in opposition to the previous example). Concretely, we study the following McKean-Vlasov equation\ndXt = ( v(Xt, \u00b5 X t ) +Xt ) dt+XtdWt, v(x, \u00b5) = \u2212 1\n4 x3 + \u222b Rd \u2212 ( x\u2212 y )3 \u00b5(dy). (3.2)\nThe corresponding Fokker-Plank equation is \u2202t\u03c1 = \u2207\u00b7 [ \u2207(\u03c1|x| 2 2 ) +\u03c1\u2207V +\u03c1\u2207W \u2217\u03c1] with W = 1 4 |x|\n4, V = 116 |x| 4 \u2212 12 |x| 2, \u03c1 is the corresponding density map. There are three stable states {\u22122, 0, 2} for\nthis model [57].\nThe example of Section 3.1 was a relatively mild with additive noise and where both methods performed well. For this double-well model of (3.2), the drift includes super-linear growth components in both space and measure and a non-constant unbounded diffusion coefficient.\nIn Figure 3.2 (a) and (b), Taming (blue, left) fails to produce acceptable results of any type \u2013 Figure 3.2 (c) shows the simulated paths of both methods where it is noteworthy to see that Taming become unstable while the SSM paths remain stable. In respect to Figure 3.2 (a) and (b), the SSM (orange, right) depicts the distribution\u2019s evolution to one of the expected stable states (x = 2) as time evolves. It is interesting to find out that for the SSM in (a), where X0 \u223c N (0, 1), the particles shift from the zero (unstable) steady state to the positive stable steady state x = 2. However, in (b) with X0 \u223c N (3, 9), we find that the particles remain within the basin of attraction of the stable state x = 2. Figure 3.2 (d) displays under the same parameter choice for h, T as for the granular media example of Section 3.1 with X0 \u223c N (2, 4) the estimated rate of convergence for the schemes. It shows the taming method fails to converge (but does not explode). The strong error rate of the SSM is the expected 1/2 in-line with Theorem 2.9 (and Theorem 2.11).\nThe \u201corder 1\u201d and \u201corder 0.5\u201d lines are baselines corresponding to the slope of 1 and 0.5 rate of convergence.\nFigure 3.2 (e) shows that, to reach the same strong error level Taming shall takes far more (over 100 times) runtime than the SSM."
        },
        {
            "heading": "3.3 Example: 2d Van der Pol (VdP) oscillator",
            "text": "We consider the Van der Pol (VdP) model described in [35, Section 4.2 and 4.3], with added super-linearity in measure and non-constant unbounded diffusion. We study the following MV-SDE dynamics: set x = (x1, x2) \u2208 R2, for (1.3) define the functions f, u, b, \u03c3 as\nf(x) = \u2212x|x|2, u(x) = [ \u221243x 3 1\n0\n] , b(x) = [ 4(x1 \u2212 x2)\n1 4x1\n] , \u03c3(x) = [ x1 0 0 x2 ] , (3.3)\nwhich satisfy the assumptions of this work. Figure 3.3 (a) shows the strong error of both methods, the \u201corder 1\u201d and \u201corder 0.5\u201d lines are baselines with the slope of 1 and 0.5 for comparison. The estimated rate of the SSM is near 0.5 while Taming failed to converge. Figure 3.3 (b) shows the PoC error of both methods, Taming failed to converge while the estimated rate of the SSM is near 0.5 (see discussion of previous Section 3.1).\nFigure 3.3 (c) shows the system\u2019s phase-space portraits (i.e., the parametric plot of t 7\u2192 (X1,t, X2,t) and t 7\u2192 (E[X1,t],E[X2,t]) over t \u2208 [0, 20]) of the SSM with respect to different choices of N \u2208 {30, 100, 500, 1000}. The impact of N on the quality of simulation is apparent as is the ability of the SSM to capture the periodic behaviour of the true dynamics. Figure 3.3 (d)-(e)-(f)-(g) shows the expectation\u2019s fluctuation (of Figure 3.3 (c)) and the system\u2019s phase-space path portraits of the SSM for different choices of N . The trajectory becomes smoother as N becomes larger and the paths are similar for N \u2265 500."
        },
        {
            "heading": "3.4 Numerical complexity, discussion and various opens questions",
            "text": "Across the three examples the SSM converged and all examples recovered the theoretical convergence rate (of 1/2 in general, and 1 for the additive noise case). In the latter two examples,\nTaming failed to converge while on the first example the SSM and taming are mostly similar. The main difference between examples is the diffusion coefficient.\nThe SSM is robust in respect to small choices of h and N . In all three examples, the SSM remains convergent for all choices of h (even for h = 0.1) while taming fails to converge at all. In the Van der Pol (VdP) oscillator example of Section 3.3, when comparing across different particle sizes N , the SSM provides a good approximation for all choices of N (even for N = 30) and the PoC result is as expected. In general, we found that the runtime of the SSM is nearly the double of Taming for the same choices of h, but on the other hand, Taming takes over 100-times more runtime to reach the same accuracy as the SSM (if one considers the strong error against runtime).\nComputational costs and open questions for future research\nIn the context of (1.1), assume one wants to simulate an N -particle system over a discretised finite time-domain withM time points. Since we deal with convolution type operator, the interaction term need to be computed for every single particle and thus, a standard explicit Euler scheme incurs a computational cost of O(N2M). Without the convolution component, the cost is simply O(NM). For the SSM scheme in Definition 2.6, since it is has an implicit component there is an additional cost attached to it (more below).\nAt this level, two strategies can be thought to reduce the complexity. The first is by controlling the cost of computing the interaction itself, these have been proposed for example in the projected particle method [8] or the Random Batch Method (RBM) [37]. To date there is no general proof of these outside Lipschitz conditions (and constant diffusion coefficient in the RBM case) for the efficacy of the method, also, it is not clear how to use these methods in combination with Newton to solve the SSM\u2019s implicit equation (more below). The second is to better address the competition between the number of particles N , as dictated by the PoC result Proposition 2.5, and the time-step parameter M (or 1/h). Our experimental work estimating the Propagation of chaos rate points to a convergence rate of order 1/2 instead of the upper bound rate 1/4 guaranteed by (2.5) in Theorem 2.5. This result is not surprising in view of the theoretical result [20, Lemma 5.1]; and numerically in [51, Example 4.1]. To the best of our knowledge, no known PoC rate result covers the examples presented here and Theorem 2.5 is presently the best known general result.\nSolving the implicit step in SSM - Newton\u2019s method\nThe SSM scheme contains an implicit Equation (2.6) that needs be solved at each timestep. It is left to the user to choose the most suitable method for given data and, in all generality, one needs an approximation scheme to solve (2.6). Proposition B.2 below shows that as long as said approximation is uniformly controlled within a ball of radius Ch of the true solution, then the SSM\u2019s convergence rate of Theorem 2.9 is preserved.\nAs mentioned in the initial part of Section 3, we use Newton\u2019s method (assuming extra differentiability of the involved maps) \u2013 see Appendix B for details where [53, Section 4.3] is used to guarantee convergence. The computation cost raises from O(N2M) to O(\u03baN2M), where \u03ba denotes the leading term cost of Newton after \u03ba iterations. In practice, we found that within 2 to 4 iterations (i.e., \u03ba \u2264 4) two consecutive Newton iteration are sufficiently close for the purposes of the scheme\u2019s accuracy: denoting Newton\u2019s jth-iteration by yj \u2208 RNd, then \u2016y\u03ba\u2212 y\u03ba\u22121\u2016\u221e < \u221a h (which is the stop criteria used, see Appendix B). Interacting particle systems like (1.1) induce a certain structure to the associated Jacobian matrix when seen through the lens of (Rd)N . The closed form expressions provided in Appendix B.2 point to a very sparse Jacobian matrix with a very specific block structure. For instance, the \u0393 matrix\n(see Appendix B.2) is a symmetric one and is multiplied by h/N making its entries very small: it stands to reason that \u0393 can be removed from the Jacobian matrix as one solves the system (provided its entries can be controlled) and thus suggests that an inexact or quasi-Newton method might be computationally more efficient. In [42, Section 3] the authors review [52] who address the case of using inexact Newton methods when the equation of interest (2.6) is a monotone map, which is indeed our case. The usage of Newton method is not a primary element of discussion and, as does [42], we point the reader to the comprehensive review [48] on practical quasi-Newton methods for nonlinear equations. In conclusion, it remains to explore how different versions of Newton method for sparse systems can be used as way to reduce its computational cost but, in light of our study, we found Newton method very fast and efficient even comparatively with the Explicit Euler taming method in Section 3.1."
        },
        {
            "heading": "4 Proof of split-step method (SSM) for MV-SDEs and interacting particle systems: convergence and stability",
            "text": "The proof appearing in Section 4.2 depends in no way on Theorem 2.10 or its proof (in Section 4.3). Nonetheless, Section 4.3 has a strong complementary effect to fully understanding the proof in Section 4.2."
        },
        {
            "heading": "4.1 Some properties of the scheme",
            "text": "Recall the SSM scheme of Definition 2.6. In this section we clarify further the choice of h and then introduce two critical results arising from the SSM\u2019s structure. Note that throughout C > 0 is a constant always independent of h,N,M .\nRemark 4.1 (Choice of h). Let Assumption 2.1 hold, the constraint on h in (2.9) comes from (4.2), (4.3) and (4.19) below, where Lf , Lu \u2208 R and Lu\u0303 \u2265 0. Following the notation of those inequalities, under (2.9) for \u03b6 > 0, there exists \u03be \u2208 (0, 1) such that h < \u03be/\u03b6 and\nmax\n{ 1\n1\u2212 2(Lf + Lu)h ,\n1\n1\u2212 (4L+f + 2Lu + 2Lu\u0303 + 1)h ,\n1\n1\u2212 (4L+f + 2Lu + Lu\u0303 + 1)h\n} < 1\n1\u2212 \u03be .\nFor \u03b6 = 0, the result is trivial and we conclude that there exist constants C1, C2 independent of h\nmax\n{ 1\n1\u2212 2(Lf + Lu)h ,\n1\n1\u2212 (4L+f + 2Lu + 2Lu\u0303 + 1)h ,\n1\n1\u2212 (4L+f + 2Lu + Lu\u0303 + 1)h\n} \u2264 C1 \u2264 1 + C2h."
        },
        {
            "heading": "As argued in Remark 2.7 the constraint on h can be lifted.",
            "text": "Lemma 4.2. Choose h as in (2.9). Then, given any X \u2208 RNd there exists a unique solution Y \u2208 RNd to\nY = X + hV (Y ). (4.1)\nThe solution Y is a measurable map of X.\nProof. Recall Remark 2.4. The proof is an adaptation of the proof [17, Lemma 4.1] to the RNd case.\nProposition 4.3 (Differences relationship). Let Assumption 2.1 hold and choose h as in (2.9). For any n \u2208 J0,MK and Y \u2217,Nn in (2.6), there exists some constant C > 0 such that for all i, j \u2208 J1, NK,\n|Y i,?,Nn \u2212 Y j,?,Nn |2 \u2264 |X\u0302i,Nn \u2212 X\u0302j,Nn |2 1\n1\u2212 2(Lf + Lu)h \u2264 (1 + Ch)|X\u0302i,Nn \u2212 X\u0302j,Nn |2. (4.2)\nProof. Take n \u2208 J0,MK, i, j \u2208 J1, NK. Using Remark 2.2 and Young\u2019s inequality we have |Y i,?,Nn \u2212 Y j,?,Nn |2\n= \u2329 Y i,?,Nn \u2212 Y j,?,Nn , X\u0302i,Nn \u2212 X\u0302j,Nn \u232a + \u2329 Y i,?,Nn \u2212 Y j,?,Nn , v ( Y i,?,Nn , \u00b5\u0302 Y,N n ) \u2212 v ( Y j,?,Nn , \u00b5\u0302 Y,N n ) \u232a h\n\u2264 1 2 |Y i,?,Nn \u2212 Y j,?,Nn |2 + 1 2 |X\u0302i,Nn \u2212 X\u0302j,Nn |2 + (Lf + Lu)|Y i,?,Nn \u2212 Y j,?,Nn |2h.\nThe argument regarding the uniformity of the constant C in regards to the parameters h,N,M follows from Remark 4.1.\nProposition 4.4 (Summation relationship). Let Assumption 2.1 hold. Choose h as in (2.9). For the process in (2.7) there exists a constant C > 0 (independent of h,N,M) such that, for all i \u2208 J1, NK, n \u2208 J0,MK,\n1\nN N\u2211 i=1 |Y i,?,Nn |2 \u2264 Ch+ (1 + Ch) 1 N N\u2211 i=1 |X\u0302i,Nn |2. (4.3)\nProof. From (2.8) we have\n1\nN N\u2211 i=1 |Y i,?,Nn |2 = 1 N N\u2211 i=1 {\u2329 Y i,?,Nn , X\u0302 i,N n \u232a + \u2329 Y i,?,Nn , v(Y i,?,N n , \u00b5\u0302 Y,N n ) \u232a h }\n\u2264 1 N N\u2211 i=1 { 1 2 |Y i,?,Nn |2 + 1 2 |X\u0302i,Nn |2 + \u2329 Y i,?,Nn , u(Y i,?,N n , \u00b5\u0302 Y,N n ) \u232a h+ h N N\u2211 j=1 \u2329 Y i,?,Nn , f(Y i,?,N n \u2212 Y j,?,Nn ) \u232a} .\n(4.4)\nBy Assumption 2.1 and Young\u2019s inequality, we have\n1\nN2 N\u2211 i=1 N\u2211 j=1 \u2329 Y i,?,Nn , f(Y i,?,N n \u2212 Y j,?,Nn ) \u232a = 1 2N2 N\u2211 i=1 N\u2211 j=1 \u2329 Y i,?,Nn \u2212 Y j,?,Nn , f(Y i,?,Nn \u2212 Y j,?,Nn ) \u232a\n\u2264 1 2N2 N\u2211 i=1 N\u2211 j=1 Lf |Y i,?,Nn \u2212 Y j,?,Nn |2 \u2264 2L+f N N\u2211 i=1 |Y i,?,Nn |2, L+f = max{Lf , 0}.\nPlugging this into (4.4) and using Remark 2.2 with \u039b = 4L+f + 2Lu + 2Lu\u0303 + 1, we have\n1\nN N\u2211 i=1 |Y i,?,Nn |2 \u2264 1 N N\u2211 i=1 { |X\u0302i,Nn |2 + 2h ( 2L+f |Y i,?,N n |2 + Cu + L\u0302u|Y i,?,Nn |2 + Lu\u0303W (2)(\u00b5\u0302Y,Nn , \u03b40)2 )}\n\u2264 1 N N\u2211 i=1 { |X\u0302i,Nn |2 + 2h ( 2L+f |Y i,?,N n |2 + Cu + L\u0302u|Y i,?,Nn |2 + Lu\u0303 N N\u2211 j=1 |Y j,?,Nn |2 )}\n\u2264 1 1\u2212 \u039bh 1 N N\u2211 i=1 { |X\u0302i,Nn |2 + 2Cuh } = 1 N N\u2211 i=1 { |X\u0302i,Nn |2(1 + h \u039b 1\u2212 \u039bh ) + 2Cuh 1\u2212 \u039bh } .\nRemark 4.1 yields the argument.\nFrom Lemma 4.2 we know a unique solution, Y ?,Nn , to (2.6) as a function of X\u0302Nn exists. We next show that the scheme we proposed in (2.6)-(2.8) is square integrable.\nProposition 4.5 (Second moment bounds of SSM). Let the setting of Theorem 2.9 hold. Let m \u2265 2 where X\u0302i,N0 \u2208 Lm0 (Rd) for all i \u2208 J1, NK, then there exists a constant C > 0 independent of h,N,M (but depending on T ) such that\nsup i\u2208J1,NK sup n\u2208J0,MK\nE [ |X\u0302i,Nn |2 ] + sup i\u2208J1,NK sup n\u2208J0,M\u22121K E [ |Y i,?,Nn |2 ] \u2264 C ( 1 + E [ |X\u0302 \u00b7,N0 | 2 ]) <\u221e.\nProof. Let i \u2208 J1, NK, n \u2208 J0,M\u22121K, by Assumption 2.1, from (2.6)-(2.8) and Proposition 4.4, since the particles are identically distributed, we have\nE [ 1 + |Y i,?,Nn |2| ] \u2264 E [ 1 + |X\u0302i,Nn |2 ] (1 + Ch).\nSimilar to [17, Proposition 4.5], we have\n|X\u0302i,Nn+1| 2 \u2264 |X\u0302i,Nn |2 + C ( 1 + |Y i,?,Nn |2 + 1\nN N\u2211 j=1 |Y j,?,Nn |2 ) (h+ |\u2206W in|2) + 2 \u2329 Y i,?,Nn , \u03c3(tn, Y i,?,N n , \u00b5\u0302 Y,N n )\u2206W i n \u232a .\nTaking expectations and summing 1 to both sides, Young\u2019s inequality yields\nE [ 1 + |X\u0302i,Nn+1| 2 ] \u2264 E [ 1 + |X\u0302i,Nn |2 ] (1 + Ch).\nBy induction and using that the particles are identically distributed, we conclude that\nsup i\u2208J1,NK sup n\u2208J0,MK\nE [ 1 + |X\u0302i,Nn |2 ] \u2264 sup i\u2208J1,NK E [ 1 + |X\u0302i,N0 | 2 ] (1 + Ch)M \u2264 (1 + E [ |X\u0302 \u00b7,N0 | 2 ] )eCT <\u221e,\n(4.5)\nwhere we used Mh = T and that the {X\u0302i,N0 }i are i.i.d. The inequality for supi\u2208J1,NK supn\u2208J0,M\u22121K E [ |Y i,?,Nn |2 ] follows using similar argument.\nWe provide the following auxiliary proposition to deal with the cross products terms in the later proofs.\nProposition 4.6. Take N \u2208 N, for all i \u2208 J1, NK, for any given p \u2208 N, sequences { {ai}i : \u2211N i=1 ai =\np, ai \u2208 N } and any collection of identically distributed Lp-integrable random variables {Xi}i we have\nE [ N\u220f i=1 |Xi|ai ] \u2264 E [ |X1|p ] .\nProof. Using the notation above, by Young\u2019s inequality, for any i, j \u2208 J1, NK we have\n|Xi|ai |Xj |aj \u2264 ai\nai + aj |Xi|ai+aj + aj ai + aj |Xj |ai+aj .\nThus, by induction and using that the {Xi}i are identically distributed, the result follows."
        },
        {
            "heading": "4.2 Proof of Theorem 2.9: the pointwise mean-square convergence result",
            "text": "We provide here the proof of Theorem 2.9. Throughout this section, we follow the notation introduced in Theorem 2.9 and let Assumption 2.1 hold, h is chosen as in (2.9), m \u2265 4q + 4, where m is defined in (1.3) and q is defined in Assumption 2.1. Note that throughout C > 0 is a constant always independent of h,N,M but possibly depending on T and m.\nProof. Let i \u2208 J1, NK, n \u2208 J0,M \u2212 1K, s \u2208 [0, h], tn = nh and p \u2265 2 with m \u2265 4q + 4, using same notation as in (1.1), define the following auxiliary process\nXi,Nn = X i,N tn , \u2206X i tn+s = X i,N tn+s \u2212 X\u0302 i,N tn+s, tn = nh, \u2206W i n,s = W i tn+s \u2212W i tn ,\nY i,X,Nn = X i,N n + hv(Y i,X,N n , \u00b5 Y,X,N n ), \u00b5 Y,X,N n (dx) :=\n1\nN N\u2211 j=1 \u03b4 Y j,X,Nn (dx).\nFor all n \u2208 J0,M \u2212 1K, i \u2208 J1, NK, r \u2208 [0, h], from (2.10), we have\n|\u2206Xitn+r| 2 = \u2223\u2223\u2223\u2206Xitn + \u222b tn+r tn ( v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,X,Nn , \u00b5Y,X,Nn ) ) ds\n+ \u222b tn+r tn ( v(Y i,X,Nn , \u00b5 Y,X,N n )\u2212 v ( Y i,?,Nn , \u00b5\u0302 Y,N n ) ) ds+ \u222b tn+r tn ( b(s,Xi,Ns , \u00b5 X,N s )\u2212 b(tn, Y i,X,Nn , \u00b5Y,X,Nn ) ) ds\n+ \u222b tn+r tn ( b(tn, Y i,X,N n , \u00b5 Y,X,N n )\u2212 b(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ) ) ds\n+ \u222b tn+r tn ( \u03c3(s,Xi,Ns , \u00b5 X,N s )\u2212 \u03c3(tn, Y i,X,Nn , \u00b5Y,X,Nn ) ) dW is\n+ \u222b tn+r tn ( \u03c3(tn, Y i,X,N n , \u00b5 Y,X,N n )\u2212 \u03c3(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ) ) dW is \u2223\u2223\u22232. Taking expectations on both side, using Jensen\u2019s inequality and It\u00f4\u2019s isometry, we have\nE [ |\u2206Xitn+r| 2 ] \u2264 (1 + h)I1 + (1 + 1\nh )I2 + 2I3 + 2I4, (4.6)\nwhere the terms I1, I2, I3, I4 are defines as follows\nI1 = E [\u2223\u2223\u2223\u2206Xitn + \u222b tn+r\ntn\n( v(Y i,X,Nn , \u00b5 Y,X,N n )\u2212 v ( Y i,?,Nn , \u00b5\u0302 Y,N n ) ) ds (4.7)\n+ \u222b tn+r tn ( b(tn, Y i,X,N n , \u00b5 Y,X,N n )\u2212 b(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ) ) ds \u2223\u2223\u22232], (4.8)\nI2 = E [\u2223\u2223\u2223 \u222b tn+r\ntn\n( v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,X,Nn , \u00b5Y,X,Nn ) ) ds (4.9)\n+ \u222b tn+r tn ( b(s,Xi,Ns , \u00b5 X,N s )\u2212 b(tn, Y i,X,Nn , \u00b5Y,X,Nn ) ) ds \u2223\u2223\u22232], (4.10)\nI3 =E [\u2223\u2223\u2223 \u222b tn+r\ntn\n( \u03c3(s,Xi,Ns , \u00b5 X,N s )\u2212 \u03c3(tn, Y i,X,Nn , \u00b5Y,X,Nn ) ) dW is \u2223\u2223\u22232], (4.11)\nI4 =E [\u2223\u2223\u2223 \u222b tn+r\ntn\n( \u03c3(tn, Y i,X,N n , \u00b5 Y,X,N n )\u2212 \u03c3(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ) ) dW is \u2223\u2223\u22232]. (4.12) For I1, Young\u2019s inequality yields\nI1 = E [\u2223\u2223\u2223Xi,Nn + (V Y,in + b(tn, Y i,X,Nn , \u00b5Y,X,Nn ))r \u2212 X\u0302i,Nn \u2212 (V \u2217,in + b(tn, Y i,?,,Nn , \u00b5\u0302Y,Nn ))r\u2223\u2223\u22232]\n\u2264 E [\u2223\u2223\u2223Xi,Nn \u2212 X\u0302i,Nn + (V Y,in \u2212 V \u2217,in )r\u2223\u2223\u22232](1 + h2 ) + E[\u2223\u2223\u2223b(tn, Y i,X,Nn , \u00b5Y,X,Nn )\u2212 b(tn, Y i,?,,Nn , \u00b5\u0302Y,Nn )\u2223\u2223\u22232](h2 + h),\n(4.13)\nwhere V Y,in and V \u2217,i n stand for V Y,i n = v(Y i,X,N n , \u00b5 Y,X,N n ) and V \u2217,i n = v(Y i,?,N n , \u00b5\u0302 Y,N n ) respectively.\nFor the first term of (4.13), recall the SSM defined in (2.7). We have E [\u2223\u2223\u2223Xi,Nn \u2212 X\u0302i,Nn +(V Y,in \u2212 V \u2217,in )r\u2223\u2223\u22232]\n=E [\u2329 Xi,Nn \u2212 X\u0302i,Nn + ( V Y,in \u2212 V \u2217,in ) r, Y i,X,Nn \u2212 Y i,?,Nn + ( V Y,in \u2212 V \u2217,in ) (r \u2212 h) \u232a] =E [\u2329 Xi,Nn \u2212 X\u0302i,Nn , Y i,X,Nn \u2212 Y i,?,Nn \u232a] + E [\u2329 Xi,Nn \u2212 X\u0302i,Nn , ( V Y,in \u2212 V \u2217,in )\u232a] (r \u2212 h)\n+ E [\u2329 Y i,X,Nn \u2212 Y i,?,Nn , ( V Y,in \u2212 V \u2217,in )\u232a] r \u2212 r(h\u2212 r)E [\u2223\u2223\u2223V Y,in \u2212 V \u2217,in \u2223\u2223\u22232]. Using the relationship that (2.7) induces, we have\nV Y,in \u2212 V \u2217,in = Y i,X,Nn \u2212Xi,Nn + Y i,?,Nn \u2212 X\u0302i,Nn\nh .\nWe first deduce that E [\u2223\u2223\u2223Xi,Nn \u2212 X\u0302i,Nn + (V Y,in \u2212 V \u2217,in )r\u2223\u2223\u22232] = E[|Xi,Nn \u2212 X\u0302i,Nn |2]+ E[\u2329Xi,Nn \u2212 X\u0302i,Nn , V Y,in \u2212 V \u2217,in \u232a]2r\n+ E [\u2329 (Y i,X,Nn \u2212 Y i,?,Nn )\u2212 (Xi,Nn \u2212 X\u0302i,Nn ), V Y,in \u2212 V \u2217,in \u232a]r2\nh = E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] (1\u2212 Ch,r) + E [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] Ch,r + E [\u2329 Y i,X,Nn \u2212 Y i,?,Nn , V Y,in \u2212 V \u2217,in \u232a]r2 h .\n(4.14)\nWhere Ch,r = (2hr \u2212 r2)/2h2. Also, for the second term of (4.13), using Assumption 2.1 and that the particles are identically distributed\nE [\u2223\u2223\u2223b(tn, Y i,X,Nn , \u00b5Y,X,Nn )\u2212 b(tn, Y i,?,Nn , \u00b5\u0302Y,Nn )\u2223\u2223\u22232]\n\u2264CE [ |Y i,X,Nn \u2212 Y i,?,Nn |2 +W (2)(\u00b5Y,X,Nn , \u00b5\u0302Y,Nn ) ] \u2264CE [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] + CE [ 1 N N\u2211 j=1 |Y j,X,Nn \u2212 Y j,?,Nn |2 ] \u2264 CE [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] .\n(4.15)\nBy Assumption 2.1 and using Young\u2019s inequality once again E [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] \u2264 E [\u2329 Y i,X,Nn \u2212 Y i,?,Nn , Xi,Nn \u2212 X\u0302i,Nn + V Y,in \u2212 V \u2217,in \u232a] h (4.16)\n\u2264 E [1\n2 |Y i,X,Nn \u2212 Y i,?,Nn |2 +\n1 2 |Xi,Nn \u2212 X\u0302i,Nn |2\n] + E [\u2329 Y i,X,Nn \u2212 Y i,?,Nn , V Y,in \u2212 V \u2217,in \u232a] h.\n(4.17)\nFor the last term (4.17), since the particles are identically distributed, Assumption 2.1 and Remark 2.4 yield\nE [\u2329 Y i,X,Nn \u2212 Y i,?,Nn , V Y,in \u2212 V \u2217,in \u232a] \u2264 E [ 1 N N\u2211 j=1 \u2329 Y j,X,Nn \u2212 Y j,?,Nn , V Y,jn \u2212 V \u2217,jn \u232a] \u2264 (\n2L+f + Lu + 1 2 + Lu\u0303 2\n) E [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] . (4.18)\nThus, injecting (4.18) back into (4.17) and (4.16), set \u03932 = 4L+f + 2Lu + Lu\u0303 + 1, then by Remark 4.1,\nE [ |Y i,X,Nn \u2212 Y i,?,Nn |2 ] \u2264 1 1\u2212 \u03932h E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] \u2264 E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] (1 + Ch). (4.19)\nPlug (4.19) and (4.18) back into (4.14), (4.15) and (4.13). We then conclude that\nI1 \u2264 E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] (1 + Ch). (4.20)\nFor I2, by Young\u2019s and Jensen\u2019s inequality, we have\nI2 \u2264 h E [ \u222b tn+h\ntn \u2223\u2223\u2223v(Xi,Ns , \u00b5X,Ns )\u2212 v(Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232ds (4.21) +\n\u222b tn+h tn \u2223\u2223\u2223b(s,Xi,Ns , \u00b5X,Ns )\u2212 b(tn, Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232ds]. (4.22) For (4.21), from Assumption 2.1, using Young\u2019s, Jensen\u2019s, and Cauchy-Schwarz inequality E [\u2223\u2223\u2223v(Xi,Ns , \u00b5X,Ns )\u2212 v(Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232] \u2264 CE\n[\u2223\u2223\u2223u(Xi,Ns , \u00b5X,Ns )\u2212 u(Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232 + 1N N\u2211 j=1 \u2223\u2223\u2223f(Xi,Ns \u2212Xj,Ns )\u2212 f(Y i,X,Nn \u2212 Y j,X,Nn )\u2223\u2223\u22232] (4.23)\n\u2264 C N N\u2211 j=1 E [\u2223\u2223\u2223(1 + |Xi,Ns \u2212Xj,Ns |q + |Y i,X,Nn \u2212 Y j,X,Nn |q)|Xi,Ns \u2212 Y i,X,Nn \u2212 (Xj,Ns \u2212 Y j,X,Nn )|\u2223\u2223\u22232]\n+ CE [ (1 + |Xi,Ns |2q + |Y i,X,Nn |2q)(|Xi,Ns \u2212 Y i,X,Nn |2) + 1\nN N\u2211 j=1 |Xj,Ns \u2212 Y j,X,Nn |2 ]\n\u2264 C \u221a E [ 1 + |Xi,Ns |4q + |Y i,X,Nn |4q ] E [ |Xi,Ns \u2212 Y i,X,Nn |4 ] + E [ 1 N N\u2211 j=1 |Xj,Ns \u2212 Y j,X,Nn |2 ]\n(4.24)\n+ C\nN N\u2211 j=1 \u221a E [ 1 + |Xi,Ns \u2212Xj,Ns |4q + |Y i,X,Nn \u2212 Y j,X,Nn |4q ] E [ |Xi,Ns \u2212 Y i,X,Nn |4 + |Xj,Ns \u2212 Y j,X,Nn |4 ] .\n(4.25)\nUsing the structure of the SSM, Young\u2019s and Jensen\u2019s inequality, and Proposition 4.3 we have\n|Xi,Ns \u2212 Y i,X,Nn |2 \u2264 2|Xi,Ns \u2212Xi,Nn |2 + 2|Xi,Nn \u2212 Y i,X,Nn |2, (4.26)\n|Xi,Nn \u2212 Y i,X,Nn |2 = \u2223\u2223\u2223v(Y i,X,Nn , \u00b5Y,X,Nn )h\u2223\u2223\u22232 \u2264 2\u2223\u2223\u2223u(Y i,X,Nn , \u00b5Y,X,Nn )h\u2223\u2223\u22232 + 2h2N N\u2211 j=1 \u2223\u2223\u2223f(Y i,X,Nn \u2212 Y j,X,Nn )\u2223\u2223\u22232 \u2264 C ( 1 + |Y i,X,Nn |2q+2 + 1\nN N\u2211 j=1 |Y j,X,Nn |2 ) h2 + Ch2 N N\u2211 j=1 ( 1 + |Y i,X,Nn \u2212 Y j,X,Nn |2q+2 )\n\u2264 C ( 1 + |Y i,X,Nn |2q+2 + 1\nN N\u2211 j=1 |Y j,X,Nn |2 ) h2 + Ch2 N N\u2211 j=1 ( 1 + |Xi,Nn \u2212Xj,Nn |2q+2 ) .\nSimilarly, we have\n|Xi,Ns \u2212 Y i,X,Nn |4 \u2264 16|Xi,Ns \u2212Xi,Nn |4 + 16|Xi,Nn \u2212 Y i,X,Nn |4, (4.27)\n|Xi,Nn \u2212 Y i,X,Nn |4 \u2264 C ( 1 + |Y i,X,Nn |4q+4 + 1\nN N\u2211 j=1 |Y j,X,Nn |4 ) h4 + Ch4 N N\u2211 j=1 ( 1 + |Xi,Nn \u2212Xj,Nn |4q+4 ) .\nFrom (1.1) and using (2.4) (since m \u2265 4q + 4) alongside Young\u2019s inequality and It\u00f4\u2019s isometry, we have E [ |Xi,Ns \u2212Xi,Nn |2 ] \u2264 E [\u2223\u2223\u2223 \u222b s tn v(Xi,Nu , \u00b5 X,N u ) + b(u,X i,N u , \u00b5 X,N u )du+ \u222b s tn \u03c3(u,Xi,Nu , \u00b5 X,N u )dW i u\n\u2223\u2223\u22232] \u2264 Ch, E [ |Xi,Ns \u2212Xi,Nn |4 ] \u2264 E [\u2223\u2223\u2223 \u222b s tn v(Xi,Nu , \u00b5 X,N u ) + b(u,X i,N u , \u00b5 X,N u )du+ \u222b s tn \u03c3(u,Xi,Nu , \u00b5 X,N u )dW i u\n\u2223\u2223\u22234] \u2264 Ch2. Also, using (2.4), Jensen\u2019s and Young\u2019s inequality (since m \u2265 4q + 4) we have E [Ch2 N N\u2211 j=1 ( 1 + |Xi,Nt \u2212X j,N t |2q+2 )] \u2264Ch2 and E [\u2223\u2223\u2223Ch2 N N\u2211 j=1 ( 1 + |Xi,Nt \u2212X j,N t |2q+2\n)\u2223\u2223\u22232] \u2264 Ch4. This next argument uses steps similar to those used in (4.35) and (4.36) (appearing in the proof of Theorem 4.7). Since X \u00b7,N has bounded moments via (2.4) (this refers to the true interacting particle system), we have for any m \u2265 p \u2265 2 that\nE [ |Y i,X,Nn |p ] \u2264 ( 4pE [ 1 N N\u2211 j=1 |Xi,Nn \u2212Xj,Nn |p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |Xj,Nn |2) \u2223\u2223\u2223p/2]+ 1)(1 + Ch) \u2264 C.\nCollecting all the terms above, using that the particles are identically distributed, we have E [ |Xi,Ns \u2212 Y i,X,Nn |2 ] \u2264 Ch, E [ |Xi,Ns \u2212 Y i,X,Nn |4 ] \u2264 Ch2, E [ |Y i,X,Nn |p ] \u2264 C, (4.28)\nE [\u2223\u2223\u2223W (2)(\u00b5X,Ns , \u00b5Y,X,Nn )\u2223\u2223\u22232] \u2264 E[ 1N N\u2211 j=1 |Xj,Ns \u2212 Y j,X,Nn |2 ] \u2264 Ch. (4.29)\nPlugging all the above inequalities back into (4.24) and (4.25), we conclude that E [\u2223\u2223\u2223v(Xi,Ns , \u00b5X,Ns )\u2212 v(Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232] \u2264 Ch. (4.30)\nWe now consider term (4.22) of I2. By Assumption 2.1, using (4.28) and (4.29)\nE [\u2223\u2223\u2223b(s,Xi,Ns , \u00b5X,Ns )\u2212 b(tn, Y i,X,Nn , \u00b5Y,X,Nn )\u2223\u2223\u22232] \u2264 CE[h+ |Xi,Ns \u2212 Y i,X,Nn |2 + \u2223\u2223\u2223W (2)(\u00b5X,Ns , \u00b5Y,X,Nn )\u2223\u2223\u22232] \u2264 Ch.\n(4.31)\nThus, plugging (4.30), (4.31) back into (4.21) and (4.22), we have\nI2 \u2264 Ch3. (4.32)\nFor I3, by It\u00f4\u2019s isometry, the results in (4.28) and (4.29), and using similar argument as in (4.31) we have\nI3 =E [\u2223\u2223\u2223 \u222b tn+r\ntn\n( \u03c3(s,Xi,Ns , \u00b5 X,N s )\u2212 \u03c3(tn, Y i,X,Nn , \u00b5Y,X,Nn ) ) dW is \u2223\u2223\u22232] \u2264E [ \u222b tn+h\ntn \u2223\u2223\u2223(\u03c3(s,Xi,Ns , \u00b5X,Ns )\u2212 \u03c3(tn, Y i,X,Nn , \u00b5Y,X,Nn ))\u2223\u2223\u22232 ds] \u2264 Ch2. (4.33) Similarly for I4, by It\u00f4\u2019s isometry, Proposition 4.5, Equation (4.19) and using similar argument in (4.15)\nI4 =E [\u2223\u2223\u2223 \u222b tn+r\ntn\n( \u03c3(tn, Y i,X,N n , \u00b5 Y,X,N n )\u2212 \u03c3(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ) ) dW is \u2223\u2223\u22232] \u2264E [ \u222b tn+h\ntn \u2223\u2223\u2223(\u03c3(tn, Y i,X,Nn , \u00b5Y,X,Nn )\u2212 \u03c3(tn, Y i,?,Nn , \u00b5\u0302Y,Nn ))\u2223\u2223\u22232 ds] \u2264 E[|Xi,Nn \u2212 X\u0302i,Nn |2]Ch. (4.34) Plugging (4.20), (4.32) (4.33) and (4.34) back to (4.6), we have, for all n \u2208 J0,M \u2212 1K, i \u2208 J1, NK and r \u2208 [0, h]\nE [ |\u2206Xitn+r| 2 ] \u2264 (1 + h)E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] (1 + Ch) + (1 + 1\nh )Ch3 + Ch2 + E\n[ |Xi,Nn \u2212 X\u0302i,Nn |2 ] Ch\n\u2264 E [ |Xi,Nn \u2212 X\u0302i,Nn |2 ] (1 + Ch) + Ch2.\nBy backward induction, the discrete Gr\u00f6nwall\u2019s lemma delivers the result of (2.11)."
        },
        {
            "heading": "4.3 Proof of Theorem 2.10: the moment bound result",
            "text": "In this section prove Theorem 2.10. Throughout this section we follow the notation introduced in Theorem 2.10 and let: Assumption 2.1 hold, h is chosen as in (2.9) and m \u2265 2p with m as defined in (1.3).\nWe first prove a moment bounds result across the timegrid then extend it to the continues process as stated in Theorem 2.10.\nTheorem 4.7 (Moment bounds of SSM). Let the setting of Theorem 2.9 hold. Let m \u2265 2 where X\u0302i,N0 \u2208 Lm0 (Rd) for all i \u2208 J1, NK and let X\u0302i,N be the continuous-time extension of the SSM given by (2.10). Let 2p \u2208 [2,m], then there exists a constant C > 0 independent of h,N,M (but depending on T and m) such that\nsup i\u2208J1,NK sup n\u2208J0,MK\nE [ |X\u0302i,Nn |2p ] + sup i\u2208J1,NK sup n\u2208J0,M\u22121K E [ |Y i,?,Nn |2p ] \u2264 C ( 1 + sup i\u2208J1,NK E [ |X\u0302i,N0 | 2p ]) <\u221e.\nProof. The next inequality introduces the quantities HX,pn and H Y,p n . For any i \u2208 J1, NK, n \u2208 J0,MK, by Young\u2019s and Jensen\u2019s inequality\nE [ |X\u0302i,Nn |2p ] = E [\u2223\u2223\u2223 1 N N\u2211 j=1 (X\u0302i,Nn \u2212 X\u0302j,Nn ) + 1 N N\u2211 j=1 X\u0302j,Nn \u2223\u2223\u22232p]\n\u2264 4pE [ 1 N N\u2211 j=1 |X\u0302i,Nn \u2212 X\u0302j,Nn |2p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |X\u0302j,Nn |2) \u2223\u2223\u2223p]+ 1 = HX,pn , (4.35)\nE [ |Y i,?,Nn |2p ] \u2264 4pE [ 1 N N\u2211 j=1 |Y i,?,Nn \u2212 Y j,?,Nn |2p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |Y j,?,Nn |2) \u2223\u2223\u2223p]+ 1 = HY,pn .\n(4.36)\nUsing the following inequalities from Proposition 4.3 and 4.4, we have HY,pn \u2264 HX,pn (1 + Ch),\n|Y i,?,Nn \u2212 Y j,?,Nn |2 \u2264 |X\u0302i,Nn \u2212 X\u0302j,Nn |2(1 + Ch) and 1\nN N\u2211 j=1 (1 + |Y j,?,Nn |2) \u2264 [ 1 N N\u2211 j=1 (1 + |X\u0302j,Nn |2) ] (1 + Ch).\nWe now prove that HX,pn+1 \u2264 H Y,p n (1 + Ch). For the first element composing H X,p n+1 we have\nE [ 1 N N\u2211 j=1 |X\u0302i,Nn+1 \u2212 X\u0302 j,N n+1| 2p ] =E [ 1 N N\u2211 j=1 \u2223\u2223\u2223(Y i,?,Nn + b(tn, Y i,?,Nn , \u00b5\u0302Y,Nn )h+ \u03c3(tn, Y i,?,Nn , \u00b5\u0302Y,Nn )\u2206W in) \u2212 ( Y j,?,Nn + b(tn, Y j,?,N n , \u00b5\u0302 Y,N n )h+ \u03c3(tn, Y j,?,N n , \u00b5\u0302 Y,N n )\u2206W j n\n)\u2223\u2223\u22232p]. (4.37)\nIntroduce the extra (local) notation for Gi,j,n1 , G i,j,n 2 and G i,j,n 3 as\nGi,j,n1 = Y i,?,N n \u2212 Y j,?,Nn , G i,j,n 2 = b(tn, Y i,?,N n , \u00b5\u0302 Y,N n )h\u2212 b(tn, Y j,?,Nn , \u00b5\u0302Y,Nn )h, Gi,j,n3 = \u03c3(tn, Y i,?,N n , \u00b5\u0302 Y,N n )\u2206W i n \u2212 \u03c3(tn, Y j,?,Nn , \u00b5\u0302Y,Nn )\u2206W jn.\nFor a + b + c = 2p, a < 2p, a, b, c \u2208 N, by Assumption 2.1, Young\u2019s inequality, Jensen\u2019s inequality, Proposition 4.6 and the fact that the Brownian increments are independent, the particles are conditionally independent and identically distributed, for (4.37), we have\nE [C N N\u2211 j=1 |Gi,j,n1 | a|Gi,j,n2 | b|Gi,j,n3 | c ] \u2264 E [ |Y i,?,Nn |2p ] Ch \u2264 HY,pn Ch.\nThus, for the first term of HX,pn+1, we conclude that\n4pE [ 1 N N\u2211 j=1 |X\u0302i,Nn+1 \u2212 X\u0302 j,N n+1| 2p ] \u2264 4pE [ 1 N N\u2211 j=1 |Y i,?,Nn \u2212 Y j,?,Nn |2p ] +HY,pn Ch. (4.38)\nFor the second term of HX,pn+1 we have E [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |X\u0302j,Nn+1| 2) \u2223\u2223\u2223p] = E[\u2223\u2223\u2223 1 N N\u2211 j=1 [ 1 + ( Y j,?,Nn + b(tn, Y j,?,N n , \u00b5\u0302 Y,N n )h+ \u03c3(tn, Y j,?,N n , \u00b5\u0302 Y,N n )\u2206W j n )2]\u2223\u2223\u2223p].\nSet the following (extra local) notation\nGn4 = 1\nN N\u2211 j=1 (1 + |Y j,?,Nn |2), Gn5 = 1 N N\u2211 j=1 \u2329 2Y j,?,Nn + \u03c3(tn, Y j,?,N n , \u00b5\u0302 Y,N n )\u2206W j n, \u03c3(tn, Y j,?,N n , \u00b5\u0302 Y,N n )\u2206W j n \u232a ,\nGn6 = 1\nN N\u2211 j=1 \u2329 2Y j,?,Nn + b(tn, Y j,?,N n , \u00b5\u0302 Y,N n )h+ 2\u03c3(tn, Y j,?,N n , \u00b5\u0302 Y,N n )\u2206W j n, b(tn, Y j,?,N n , \u00b5\u0302 Y,N n )h \u232a .\nWe have once again using similar arguments as before, by Young\u2019s inequality, Jensen\u2019s inequality, Proposition 4.6, that the particles are conditionally independent and identically distributed, the independence property of the Brownian increments, the Lipschitz property for b and \u03c3, and using the fact that for l1 > l2 > 1, |x|l2 \u2264 1 + |x|l1 we have\nE [ |Gn4 |a|Gn5 |b|Gn6 |c ] \u2264 E [ |Y i,?,Nn |2p + 1 ] Ch \u2264 HY,pn Ch.\nThus, for the second term of HX,pn+1, we conclude that\n4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |X\u0302j,Nn+1| 2) \u2223\u2223\u2223p] \u2264 4pE[\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |Y j,?,Nn |2) \u2223\u2223\u2223p]+HY,pn Ch. (4.39)\nPlug (4.38) and (4.39) into HX,pn+1 we have HX,pn+1 = 4 pE [ 1 N N\u2211 j=1 |X\u0302i,Nn+1 \u2212 X\u0302 j,N n+1| 2p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |X\u0302j,Nn+1| 2) \u2223\u2223\u2223p]+ 1\n\u2264 4pE [ 1 N N\u2211 j=1 |Y i,?,Nn \u2212 Y j,?,Nn |2p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 (1 + |Y j,?,Nn |2) \u2223\u2223\u2223p]+ 1 +HY,pn Ch \u2264 HY,pn (1 + Ch).\nThus finally, for all n \u2208 J0,M\u22121K, i \u2208 J1, NK, by backward induction collecting all the results above, since m \u2265 2p, where m is defined in (1.3), we have (for some C > 0 independent of h,N,M)\nE [ |X\u0302i,Nn+1| 2p ] \u2264 HX,pn+1 \u2264 H Y,p n (1 + Ch) \u2264 HX,pn (1 + Ch)2 \u2264 \u00b7 \u00b7 \u00b7 \u2264 H X,p 0 e CT \u2264 CE [ |X\u0302i,N0 | 2p ] + C <\u221e.\nSimilar argument yields the result for E [ |Y i,?,Nn |2p ] .\nProof of the Theorem 2.10\nProof of the Theorem 2.10. Under the same assumptions and notations of Theorem 4.7, one can apply arguments similar to those used in [17, Proposition 4.6] to obtain the result.\nThe final result of this section concerns the incremental (in time) moment bounds of X\u0302i,N . This result is in preparation for the next section.\nProposition 4.8. Under same assumptions and notations of Theorem 2.10, there exists a constant C > 0 independent of h,N,M (but depending on T andm) such that for any p \u2265 2 satisfym \u2265 (q+1)p, where m is defined in (1.3), q is defined in Assumption 2.1, we have\nsup i\u2208J1,NK sup 0\u2264t\u2264T\nE [ |X\u0302i,Nt \u2212 X\u0302 i,N \u03ba(t)| p ] \u2264 Ch p 2 . (4.40)\nProof. Under Assumption 2.1, and carefully applying Young\u2019s and Jensen\u2019s inequality, one can argue similarly as to [17, Proposition 4.7] and obtain the result (we omit further details)."
        },
        {
            "heading": "4.4 Proof of Theorem 2.11, the uniform convergence result in path-space",
            "text": "We now prove Theorem 2.11.\nProof of Theorem 2.11. Let Assumption 2.1 hold. Let i \u2208 J1, NK, t \u2208 [0, T ], suppose m \u2265 max{4q + 4, 2 + q + q/\u03b5}, where Xi0 \u2208 Lm0 (Rd), q is as given in Assumption 2.1. From (2.4) and (2.12), both process Xi,N and X\u0302i,N have sufficient bounded moments for the following proof. Define \u2206Xi := Xi,N \u2212 X\u0302i,N . It\u00f4\u2019s formula applied to |Xi,Nt \u2212 X\u0302 i,N t |2 = |\u2206Xit |2 yields\n|\u2206Xit |2 =2 \u222b t\n0\n\u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds (4.41)\n+ 2 \u222b t 0 \u2329 b(s,Xi,Ns , \u00b5 X,N s )\u2212 b(\u03ba(s), Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds (4.42)\n+ \u222b t 0 \u2223\u2223\u2223\u03c3(s,Xi,Ns , \u00b5X,Ns )\u2212 \u03c3(\u03ba(s), Y i,?,N\u03ba(s) , \u00b5\u0302Y,N\u03ba(s))\u2223\u2223\u22232ds (4.43) + 2\n\u222b t 0 \u2329 \u2206Xis, ( \u03c3(s,Xi,Ns , \u00b5 X,N s )\u2212 \u03c3(\u03ba(s), Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)) ) dW is \u232a . (4.44)\nWe analyse the above terms one by one and will take supremum over time with expectation. For (4.41),\u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s\n\u232a = \u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a + \u2329 v(X\u0302i,Ns , \u00b5\u0302 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a .\n(4.45)\nFor the first term above, by Assumption 2.1 and using Remark 2.2\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a ds ]\n\u2264E [ \u222b T\n0\nC\nN N\u2211 j=1 \u2223\u2223\u2223f(Xi,Ns \u2212Xj,Ns )\u2212 f(X\u0302i,Ns \u2212 X\u0302j,Ns )\u2223\u2223\u2223|\u2206Xis|ds] + E [ sup\n0\u2264t\u2264T \u222b t 0 \u2329 u(Xi,Ns , \u00b5 X,N s )\u2212 u(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a ds ]\n\u2264E [ \u222b T\n0\nC\nN N\u2211 j=1 {( 1 + |Xi,Ns \u2212Xj,Ns |q + |X\u0302i,Ns \u2212 X\u0302j,Ns |q ) |\u2206Xis \u2212\u2206Xjs ||\u2206Xis| } ds ] (4.46)\n+ E [ \u222b T\n0\n( L\u0302u|\u2206Xis|2 +\nLu\u0303 2N N\u2211 j=1 |\u2206Xjs |2 ) ds ] .\nTo deal with (4.46), using the following notations, for all i, j \u2208 J1, NK,\nGi,j,s7 = ( 1 + |Xi,Ns \u2212Xj,Ns |q + |X\u0302i,Ns \u2212 X\u0302j,Ns |q ) and Gi,j,s8 = |\u2206X i s \u2212\u2206Xjs ||\u2206Xis|.\nThe combination of Gi,j,s7 and G i,j,s 8 makes it difficult to obtain a domination via |\u2206Xis|2, we overcome this by applying Chebyshev\u2019s inequality as follows. The indicator function is denoted as 1{\u2126}.\nRecall the moment bound results on X, X\u0302 in (2.4) and (2.12) respectively. Now, using Theorem 2.9, Proposition 4.6 and Young\u2019s inequality, we have E [ Gi,j,s7 G i,j,s 8 ] = E [ Gi,j,s7 G\ni,j,s 8 (1{Gi,j,s7 <M\u03b5}\n) ] + E [ Gi,j,s7 G\ni,j,s 8 (1{Gi,j,s7 \u2265M\u03b5}\n) ]\n(4.47)\n\u2264 E [ M \u03b5Gi,j,s8 ] + E [ |Gi,j,s7 |1/\u03b5 M Gi,j,s7 G i,j,s 8 ] \u2264 2E [ M \u03b5|\u2206Xis|2 ] + hE [ |Gi,j,s7 | 1/\u03b5Gi,j,s7 G i,j,s 8 ] \u2264 Ch1\u2212\u03b5 + hC ( 1 + E [ |Xi,Ns |2+q+q/\u03b5 + |X\u0302i,Ns |2+q+q/\u03b5 ]) \u2264 Ch1\u2212\u03b5, (4.48)\nwhere for the last inequality, we used that the particles are identically distributed and there are sufficiently high bounded moments available for the process since m \u2265 2 + q + q/\u03b5.\nThus, for the first term in (4.45) and using that the particles are identically distributed, we conclude that\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a ds ] \u2264 CE [ \u222b T 0 |\u2206Xis|2ds ] + Ch1\u2212\u03b5. (4.49)\nFor the second term in (4.45), under Assumption 2.1, using Young\u2019s inequality, Jensen\u2019s inequality, and Proposition 4.8 we have\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 v(X\u0302i,Ns , \u00b5\u0302 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds ]\n(4.50)\n=E [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 u(X\u0302i,Ns , \u00b5\u0302 X,N s )\u2212 u(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds ]\n(4.51)\n+ E [\nsup 0\u2264t\u2264T \u222b t 0 1 N N\u2211 j=1 \u3008f(X\u0302i,Ns \u2212 X\u0302j,Ns )\u2212 f(Y i,?,N \u03ba(s) \u2212 Y j,?,N \u03ba(s) ),\u2206X i s \u232a ds ]\n(4.52)\n\u2264E [ \u222b T\n0 |\u2206Xis|2ds\n] + I2 + I3.\nFor I2 (given by the domination of (4.51)), by Assumption 2.1, Young\u2019s inequality and CauchySchwarz inequality\nI2 =Lu\u0302E [ \u222b T\n0\n( 1 + |X\u0302i,Ns |q + |Y i,?,N \u03ba(s) | q )2 |X\u0302i,Ns \u2212 Y i,?,N \u03ba(s) | 2 ] ds\n\u2264C \u222b T\n0\n\u221a E [( 1 + |X\u0302i,Ns |2q + |Y i,?,N\u03ba(s) |2q )2] E [ |X\u0302j,Ns \u2212 Y j,?,N\u03ba(s) |4 ] ds.\nFor I3 (given by the domination of (4.52) after extracting the |\u2206Xi| term), by Assumption 2.1, Young\u2019s inequality and Cauchy-Schwarz inequality\nI3 = CLf\u0302 N N\u2211 j=1 E [ \u222b T 0 ( 1 + |X\u0302i,Ns \u2212 X\u0302j,Ns |q + |Y i,?,N \u03ba(s) \u2212 Y j,?,N \u03ba(s) | q )2 \u2223\u2223(X\u0302i,Ns \u2212 X\u0302j,Ns )\u2212 (Y i,?,N\u03ba(s) \u2212 Y j,?,N\u03ba(s) )\u2223\u22232]ds\n\u2264C N N\u2211 j=1 \u222b T 0 \u221a E [( 1 + |X\u0302j,Ns |2q + |X\u0302i,Ns |2q + |Y i,?,N\u03ba(s) |2q + |Y j,?,N \u03ba(s) |2q )2] E [ |X\u0302j,Ns \u2212 Y j,?,N\u03ba(s) |4 ] ds.\nBy (2.7), Assumption 2.1, Young\u2019s inequality, Jensen\u2019s inequality, since m \u2265 4q+ 4, and by Theorem 4.7, we have\nE [ |X\u0302i,N\u03ba(s) \u2212 Y i,?,N \u03ba(s) | 4 ] = E [ |hv(Y i,?,N\u03ba(s) , \u00b5\u0302 Y,N \u03ba (s))|4 ] \u2264 Ch4E [ |u(Y i,?,N\u03ba(s) , \u00b5\u0302 Y,N \u03ba (s))|4 ] + Ch4\nN N\u2211 j=1 E [ |f(Y i,?,N\u03ba(s) \u2212 Y j,?,N \u03ba(s) )| 4 ]\n\u2264 Ch4E [ 1 + |Y i,?,N\u03ba(s) | 4q+4 + 1\nN N\u2211 j=1 |Y j,?,N\u03ba(s) | 4 ] + Ch4 N N\u2211 j=1 E [ (1 + |Y i,?,N\u03ba(s) \u2212 Y j,?,N \u03ba(s) | 4q)|Y i,?,N\u03ba(s) \u2212 Y j,?,N \u03ba(s) | 4 ]\n\u2264 Ch 4\nN N\u2211 j=1 E [ 1 + |Y j,?,N\u03ba(s) | 4q+4 ] \u2264 Ch4.\nUsing this inequality in combination with Proposition 4.8 allows us to conclude that E [ |X\u0302j,Ns \u2212 Y j,?,N \u03ba(s) | 4 ] \u2264 CE [ |X\u0302j,Ns \u2212 X\u0302 j,N \u03ba(s)| 4 + |X\u0302j,N\u03ba(s) \u2212 Y j,?,N \u03ba(s) | 4 ] \u2264 Ch2. (4.53)\nThus, for (4.45) injected back in (4.41), take supremum and expectation, and collecting all the necessary results above, we reach\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 v(Xi,Ns , \u00b5 N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds ] \u2264 CE [ \u222b T 0 |\u2206Xis|2ds ] + Ch1\u2212\u03b5. (4.54)\nFor the second term (4.42), the calculation is similar as in [17, Proof of Proposition 4.9], we conclude that\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 b(s,Xi,Ns , \u00b5 X,N s )\u2212 b(\u03ba(s), Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a ds ] \u2264 Ch+ CE [ \u222b T 0 |\u2206Xis|2ds ] .\n(4.55)\nSimilarly, for the third term (4.43) (these are just Lipschitz terms), we have E [\nsup 0\u2264t\u2264T \u222b t 0 \u2223\u2223\u2223\u03c3(s,Xi,Ns , \u00b5X,Ns )\u2212 \u03c3(\u03ba(s), Y i,?,N\u03ba(s) , \u00b5\u0302Y,N\u03ba(s))\u2223\u2223\u22232ds] \u2264 Ch+ CE[ \u222b T 0 |\u2206Xis|2ds ] . (4.56)\nConsider the last term (4.44) \u2013 this is a Lipschitz term and dealt with similarly to [17, Proof of Proposition 4.9]. Using the Burkholder-Davis-Gundy\u2019s, Jensen\u2019s and Cauchy-Schwarz inequality, and the above results,\nE [\nsup 0\u2264t\u2264T \u222b t 0 \u2329 \u2206Xis, ( \u03c3(s,Xi,Ns , \u00b5 X,N s )\u2212 \u03c3(\u03ba(s), Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)) ) dW is \u232a ] (4.57)\n\u2264 1 4 E [ sup 0\u2264t\u2264T |\u2206Xit |2 ] + E [ \u222b T 0 \u2223\u2223\u2223\u03c3(s,Xi,Ns , \u00b5X,Ns )\u2212 \u03c3(\u03ba(s), Y i,?,N\u03ba(s) , \u00b5\u0302Y,N\u03ba(s))\u2223\u2223\u22232ds ]. Again, gathering all the above results (4.54), (4.55), (4.56), and (4.57), plugging them back into (4.41), after taking supremum over t \u2208 [0, T ] and expectation, for all i \u2208 J1, NK we have\nE [\nsup 0\u2264t\u2264T\n|\u2206Xit |2 ] \u2264 Ch1\u2212\u03b5 + CE [ \u222b T 0 sup 0\u2264u\u2264s |\u2206Xiu|2ds ] + 1 2 E [ sup 0\u2264t\u2264T |\u2206Xit |2 ]\n\u2264 Ch1\u2212\u03b5 + C \u222b T 0 E [ sup 0\u2264u\u2264s |\u2206Xiu|2 ] ds.\nGr\u00f6nwall\u2019s lemma delivers the final result after taking supremum over i \u2208 J1, NK."
        },
        {
            "heading": "4.5 Discussion on the granular media type equation",
            "text": "Throughout C > 0 denotes a constant always independent of h,N,M but possibly depending on T and m.\nProof of Proposition 2.5. Recall the proof of (4.41) in Section 4.4. Under Assumption 2.12, for all i \u2208 J1, NK, t \u2208 [0, T ], and using arguments similar to those of (4.45) we have\n\u2206Xit = X i,N t \u2212 X\u0302 i,N t = \u222b t 0 v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)) ds,\n\u21d2 E [ |\u2206Xit |2 ] \u2264 2 \u222b t 0 E [\u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a] ds (4.58)\n+ 2 \u222b t 0 E [\u2329 v(X\u0302i,Ns , \u00b5\u0302 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a] ds. (4.59)\nFor (4.58), arguing as in (4.18), Remark 2.4 and using that the particles are identically distributed, we have\nE [\u2329 v(Xi,Ns , \u00b5 X,N s )\u2212 v(X\u0302i,Ns , \u00b5\u0302X,Ns ),\u2206Xis \u232a] \u2264 2L+f E [ |\u2206Xis|2 ] . (4.60)\nFor (4.59), it is similar to the above, we have\n2 \u222b t 0 E [\u2329 v(X\u0302i,Ns , \u00b5\u0302 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)),\u2206X i s \u232a] ds = 2 N N\u2211 j=1 \u222b t 0 E [\u2329 f(\u2206X,i,js )\u2212 f(\u2206 Y,i,j \u03ba(s) ),\u2206X i s \u232a] ds,\n(4.61)\nwhere we introduce the following handy notation (recall (2.7) and (2.10))\n\u2206X,i,jt = X\u0302 i,N s \u2212 X\u0302j,Ns , \u2206 Y,i,j \u03ba(s) = Y i,?,N \u03ba(s) \u2212 Y j,?,N \u03ba(s) , \u2206X,i,js = \u2206 X,i,j \u03ba(s) +G i,j,s 9 (s\u2212 \u03ba(s)) +G i,j,s 10 , \u2206 Y,i,j \u03ba(s) = \u2206 X,i,j \u03ba(s) +G i,j,s 9 h,\nGi,j,s9 = ( v(Y i,?,N\u03ba(s) , \u00b5\u0302 Y,N \u03ba(s))\u2212 v(Y j,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)) ) and Gi,j,s10 = \u03c3 ( (W is \u2212W i\u03ba(s))\u2212 (W j s \u2212W j \u03ba(s)) ) .\n(4.62)\nWe now proceed to estimate (4.61). By the mean value theorem under Assumption 2.12, for (4.61), there exist \u03c11, \u03c12 \u2208 [0, 1] such that\nf(\u2206X,i,js ) =f(\u2206 X,i,j \u03ba(s) ) +\u2207f(\u2206 X,i,j \u03ba(s) ) ( Gi,j,s9 (s\u2212 \u03ba(s)) +G i,j,s 10 ) + \u222b \u2206X,i,js \u2206X,i,j \u03ba(s) ( \u2207f(u)\u2212\u2207f(\u2206X,i,j\u03ba(s) ) ) du\n=f(\u2206X,i,j\u03ba(s) ) +\u2207f(\u2206 X,i,j \u03ba(s) ) ( Gi,j,s9 (s\u2212 \u03ba(s)) +G i,j,s 10 ) + ( \u2207f ( \u2206X,i,j\u03ba(s) + \u03c11(G i,j,s 9 (s\u2212 \u03ba(s)) +G i,j,s 10 ) ) \u2212\u2207f(\u2206X,i,j\u03ba(s) ) )( \u2206X,i,js \u2212\u2206 X,i,j \u03ba(s) ) ,\nf(\u2206Y,i,j\u03ba(s) ) =f(\u2206 X,i,j \u03ba(s) ) +\u2207f(\u2206 X,i,j \u03ba(s) ) ( Gi,j,s9 h ) + ( \u2207f ( \u2206X,i,j\u03ba(s) + \u03c12(G i,j,s 10 h) ) \u2212\u2207f(\u2206X,i,j\u03ba(s) ) )( \u2206Y,i,j\u03ba(s) \u2212\u2206 X,i,j \u03ba(s) ) .\nNote that only G10 contains the Brownian increments. From the above, there exists \u03c11,s, \u03c12,s \u2208\n[0, 1] for all s \u2208 [0, T ], and by Young\u2019s inequality, we have\u222b t 0 E [\u2329 f(\u2206X,i,js )\u2212 f(\u2206 Y,i,j \u03ba(s) ),\u2206X i s \u232a] ds (4.63)\n\u2264 \u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) ( Gi,j,s9 (s\u2212 h\u2212 \u03ba(s)) +G i,j,s 10 ) ,\u2206Xis \u232a] ds+ C \u222b t 0 E [ |\u2206Xis|2 ] ds (4.64)\n+ C \u222b t 0 E [\u2223\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) + \u03c11,s(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 ))\u2212\u2207f(\u2206X,i,j\u03ba(s) )\u2223\u2223\u22232\u2223\u2223\u2223\u2206X,i,js \u2212\u2206X,i,j\u03ba(s) \u2223\u2223\u22232]ds\n(4.65)\n+ C \u222b t 0 E [\u2223\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) + \u03c12,s(Gi,j,s9 h))\u2212\u2207f(\u2206X,i,j\u03ba(s) )\u2223\u2223\u22232\u2223\u2223\u2223\u2206Y,i,j\u03ba(s) \u2212\u2206X,i,j\u03ba(s) \u2223\u2223\u22232]ds. (4.66)\nFor the first term of (4.64), by Young\u2019s inequality\u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) ( Gi,j,s9 (s\u2212 h\u2212 \u03ba(s)) +G i,j,s 10 ) ,\u2206Xis \u232a] ds (4.67)\n\u2264 C \u222b t 0 E [ |\u2206Xis|2 ] ds+ C \u222b t 0 E [\u2223\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) )Gi,j,s9 (s\u2212 h\u2212 \u03ba(s))\u2223\u2223\u22232]ds (4.68)\n+ \u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) G i,j,s 10 ,\u2206X i s \u2212\u2206Xi\u03ba(s) \u232a] ds+ \u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) G i,j,s 10 ,\u2206X i \u03ba(s) \u232a] ds.\n(4.69)\nFor the second term of (4.68), since m \u2265 4q + 2, by Assumption 2.12 and Theorem 2.10, using calculations similar to those in (4.23) and Proposition 4.6, we have\nC \u222b t 0 E [\u2223\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) )Gi,j,s9 (s\u2212 h\u2212 \u03ba(s))\u2223\u2223\u22232]ds \u2264 Ch2 \u222b t 0 E [ 1 + |X\u0302i,N\u03ba(s)| 4q+2 + |Y i,?,N\u03ba(s) | 4q+2 ] ds \u2264 Ch2.\nBy Jensen\u2019s inequality and calculations close to those for I3 in (4.52), since m \u2265 4q + 2, we have\nE [ |\u2206Xit \u2212\u2206Xi\u03ba(t)| 2 ] = E [\u2223\u2223\u2223 \u222b t\n\u03ba(t)\n( v(Xi,Ns , \u00b5 X,N s )\u2212 v(Y i,?,N \u03ba(s) , \u00b5\u0302 Y,N \u03ba(s)) ) ds \u2223\u2223\u22232] (4.70)\n\u2264h \u222b t \u03ba(t) 1 N N\u2211 j=1 E [\u2223\u2223\u2223f(Xi,Ns \u2212Xi,Ns )\u2212 f(Y i,?,N\u03ba(s) \u2212 Y i,?,N\u03ba(s) )\u2223\u2223\u22232] ds \u2264 Ch3. (4.71)\nThus, for the first term of (4.69), by Cauchy-Schwarz inequality and the properties of the Brownian increment\u222b t\n0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) G i,j,s 10 ,\u2206X i s \u2212\u2206Xi\u03ba(s) \u232a] ds \u2264 \u222b t 0 \u221a E [\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) ) Gi,j,s10 \u2223\u22232]\u221aE[\u2223\u2223\u2206Xis \u2212\u2206Xi\u03ba(s)\u2223\u22232]ds \u2264 Ch2.\nFor the second term of (4.69), since Gi,j,s10 of (4.62) is conditionally independent of \u2206 X,i,j \u03ba(s) and \u2206Xi\u03ba(s) (and contains the Brownian increments), the tower property yields\u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) G i,j,s 10 ,\u2206X i \u03ba(s) \u232a] ds = 0. (4.72)\nThus, plugging the above results back into (4.64), we conclude that\u222b t 0 E [\u2329 \u2207f(\u2206X,i,j\u03ba(s) ) ( Gi,j,s9 (s\u2212 h\u2212 \u03ba(s)) +G i,j,s 10 ) ,\u2206Xis \u232a] ds \u2264 Ch2. (4.73)\nFor (4.65), by Assumption 2.12, Cauchy-Schwarz inequality and the properties of the Brownian increment, and the condition m \u2265 max{8q, 4q + 4}\nE [\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) + \u03c11,s(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 ))\u2212\u2207f(\u2206X,i,j\u03ba(s) )\u2223\u22234] \u2264 CE\n[\u2223\u2223(1 + \u2223\u2223\u2206X,i,j\u03ba(s) + \u03c11,s(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 )\u2223\u2223q\u22121 + \u2223\u2223\u2206X,i,j\u03ba(s) \u2223\u2223q\u22121)\u2223\u2223\u03c11,s(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 )\u2223\u22234] \u2264 Ch2, and\nE [\u2223\u2223\u2206X,i,js \u2212\u2206X,i,j\u03ba(s) \u2223\u22234] \u2264 CE[\u2223\u2223(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 )\u2223\u22234] \u2264 Ch2.\nThus, using Cauchy-Schwarz inequality again and the results above we conclude that\u222b t 0 E [\u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) + \u03c11,s(Gi,j,s9 (s\u2212 \u03ba(s)) +Gi,j,s10 ))\u2212\u2207f(\u2206X,i,j\u03ba(s) )\u2223\u22232\u2223\u2223\u2206X,i,js \u2212\u2206X,i,j\u03ba(s) \u2223\u22232]ds \u2264 Ch2.\n(4.74)\nFor (4.66), recall (4.62). Similarly to above, by assumption m \u2265 4q + 2 and hence\u222b t 0 E [ \u2223\u2223\u2207f(\u2206X,i,j\u03ba(s) + \u03c12,sGi,j,s9 h)\u2212\u2207f(\u2206X,i,j\u03ba(s) )\u2223\u22232 \u2223\u2223Gi,j,s9 h\u2223\u22232 ]ds \u2264 Ch2. (4.75)\nThus, plugging (4.73), (4.74) and (4.75) back into (4.63), yields\u222b t 0 E [\u2329 f(\u2206X,i,js )\u2212 f(\u2206 Y,i,j \u03ba(s) ),\u2206X i s \u232a] ds \u2264 Ch2 + C \u222b t 0 E [ |\u2206Xis|2 ] ds. (4.76)\nPlug the above result and (4.60) back to (4.58), we conclude that, for all i \u2208 J1, NK, t \u2208 [0, T ]\nE [ |\u2206Xit |2 ] \u2264C \u222b t 0 E [ |\u2206Xis|2 ] ds+ Ch2. (4.77)\nGr\u00f6nwall\u2019s lemma delivers the final result after taking supremum over i \u2208 J1, NK."
        },
        {
            "heading": "A Well-posedness of the particle system and the PoC \u2013 Proposition 2.5",
            "text": "The Propagation of chaos result (2.5) follows directly from [1, Theorem 3.14]. The gap we close is the well-posedness result for the interacting particle system and the moment bound result. Note that throughout C > 0 is a constant always independent of h,N,M but possibly depending on T and m.\nProof of Proposition 2.5. We start by interpreting the interacting particle system (1.1) as a single SDE in RNd. In Remark 2.4 we show that, as a system in RNd, the function V (see (2.2) and (1.4)) satisfies a one-sided Lipschitz condition (as a map in RNd). Thus: (i) the drift term of the whole system also satisfies one-sided Lipschitz condition as b satisfies a uniformly Lipschitz condition by (Ab); (ii) the diffusion coefficient satisfies a Lipschitz condition (by (A\u03c3)). In conclusion, the\nwell-posedness of the interacting particle SDE RNd-system is ensured by standard SDE results [54, Theorem 3.5 (p.58)].\nThe moment bound result of the RNd-system that follows from [54, Theorem 3.5 (p.58)] does not lead to (2.4) as the constant appearing on the right-hand side depends on N and explode as N \u2197 \u221e. Nonetheless, with well-posedness at hand, we are able to improve the bound and show (2.4).\nThe strategy of the proof is the same as that in Section 4.3. For all m \u2265 2p \u2265 2, i \u2208 J1, NK, t \u2208 [0, T ], we have\nE [ |Xi,Nt |2p ] = E [\u2223\u2223\u2223 1 N N\u2211 j=1 ( Xi,Nt \u2212X j,N t ) + 1 N N\u2211 j=1 Xj,Nt \u2223\u2223\u22232p]\n\u2264 4pE [ 1 N N\u2211 j=1 |Xi,Nt \u2212X j,N t |2p ] + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Nt |2 \u2223\u2223\u2223p]\n\u2264 4pE [ |Xi,Nt \u2212X j,N t |2p ] i 6=j + 4pE [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Nt |2 \u2223\u2223\u2223p]. (A.1)\nFor the first term in (A.1), by It\u00f4\u2019s formula, for i, j \u2208 J1, NK, i 6= j,\n|Xi,Nt \u2212X j,N t |2p = |X i,N 0 \u2212X j,N 0 | 2p\n+ 2p \u222b t 0 |Xi,Ns \u2212Xj,Ns |2p\u22122 \u2329 Xi,Ns \u2212Xj,Ns , v(Xi,Ns , \u00b5X,Ns )\u2212 v(Xj,Ns , \u00b5X,Ns ) \u232a ds\n+ 2p \u222b t 0 |Xi,Ns \u2212Xj,Ns |2p\u22122 \u2329 Xi,Ns \u2212Xj,Ns , b(s,Xi,Ns , \u00b5X,Ns )\u2212 b(s,Xj,Ns , \u00b5X,Ns ) \u232a ds\n+ 2p \u222b t 0 |Xi,Ns \u2212Xj,Ns |2p\u22122 \u2329 Xi,Ns \u2212Xj,Ns , \u03c3(s,Xi,Ns , \u00b5X,Ns )dW is \u2212 \u03c3(s,Xj,Ns , \u00b5X,Ns )dW js \u232a +\n2p(2p\u2212 1) 2 \u222b t 0 |Xi,Ns \u2212Xj,Ns |2p\u22122 ( |\u03c3(s,Xi,Ns , \u00b5X,Ns )|2 + |\u03c3(s,Xj,Ns , \u00b5X,Ns )|2 ) ds.\nBy Assumption 2.1, Remark 2.2, Jensen\u2019s inequality, Proposition 4.6, take expectation on both side, by the particles are identically distributed and Burkholder-Davis-Gundy (BDG) inequality, we have\nE [ |Xi,Nt \u2212X j,N t |2p ] \u2264 E [ |Xi,N0 \u2212X j,N 0 | 2p ] + C \u222b t 0 E [ |Xi,Ns \u2212Xj,Ns |2p ] ds+ C \u222b t 0 E [ |Xi,Ns |2p ] ds.\nFor the second term in (A.1), similarly, and notice that,\n1\nN N\u2211 j=1 |Xj,Nt |2 = 1 N N\u2211 j=1 |Xj,N0 | 2 + 1 N N\u2211 j=1 \u222b t 0 \u2329 Xj,Ns , v(X j,N s , \u00b5 X,N s ) \u232a ds+ 1 2N N\u2211 j=1 \u222b t 0 |\u03c3(s,Xj,Ns , \u00b5X,Ns )|2ds\n+ 1\nN N\u2211 j=1 \u222b t 0 \u2329 Xj,Ns , b(s,X j,N s , \u00b5 X,N s ) \u232a ds+ 1 N N\u2211 j=1 \u222b t 0 \u2329 Xj,Ns , \u03c3(s,X j,N s , \u00b5 X,N s )dW j s \u232a\n\u2264 1 N N\u2211 j=1 ( |Xj,N0 | 2 + \u222b t 0 |Xj,Ns |2ds+ \u222b t 0 \u2329 Xj,Ns , \u03c3(s,X j,N s , \u00b5 X,N s )dW j s \u232a) + C N2 N\u2211 i=1 N\u2211 j=1 \u222b t 0 |Xi,Ns \u2212Xj,Ns |2ds.\nTake power of p on both side and expectations. By Jensen\u2019s inequality, BDG inequality, Proposition 4.6, Assumption 2.1, the Lipschitz properties on \u03c3, we can conclude with the highest order up to 2p, we have E [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Nt |2 \u2223\u2223\u2223p] \u2264 C + CE[ 1 N N\u2211 j=1 |Xj,N0 | 2p ] + C \u222b t 0 E[|Xi,Ns |2p]ds+ C \u222b t 0 E [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Ns |2 \u2223\u2223\u2223p]ds,\nwhere we used that the particles are identically distributed to deal with the third term on the righhand side.\nCollecting all the above results and using (A.1) again, we have\nE [ |Xi,Nt |2p ] \u2264 E [ |Xi,Nt \u2212X j,N t |2p ] + E [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Nt |2 \u2223\u2223\u2223p]\n\u2264 E [ |Xi,N0 \u2212X j,N 0 | 2p ] + CE [ |Xi,N0 | 2p ] + C \u222b t 0 ( E [ |Xi,Ns \u2212Xj,Ns |2p ] i 6=j + E [\u2223\u2223\u2223 1 N N\u2211 j=1 |Xj,Ns |2 \u2223\u2223\u2223p])ds.\nGr\u00f6nwall\u2019s lemma delivers the final result after taking supremum over i \u2208 J1, NK and t \u2208 [0, T ]."
        },
        {
            "heading": "B Solving the implicit equation of the SSM and a deployment of Newton\u2019s method",
            "text": "In this section we address solving the implicit Equation (2.6) in the SSM. We first present a general result stating the level of precision on needs to solve (2.6) such that the final convergence rate of the SSM method is preserved (e.g., Theorem 2.9 and 2.11). Proposition B.2 is understood as a requirement of an adequate approximation method. In the subsequent section, we describe a deployment of Newton\u2019s method as one such method (among many) with the simulation results in Section 3 showing its efficiency.\nB.1 Approximation scheme to the SSM\nRecall the SSM from Definition 2.6. For any timestep n \u2208 J0,M \u2212 1K, for any particle i \u2208 J1, NK, define \u03a8\u0302i : Rd \u00d7 RNd \u00d7 [0, T ] \u2192 Rd be the measurable map associating the unique solution Y i,?,Nn of (2.6) to its data X\u0302i,Nn , X\u0302Nn and h, i.e.,\n\u03a8\u0302i(X\u0302 i,N n , X\u0302 N n , h) = Y i,?,N n , \u03a8\u0302 = (\u03a8\u03021, . . . , \u03a8\u0302N ). (B.1)\nThe existence of such a map \u03a8\u0302 is guaranteed by Lemma 4.2 (see also Proposition 4.3 and 4.4 for some of its good properties). We next introduce a version SSM of Definition 2.6 where the implicit equation is solved approximately only.\nDefinition B.1 (Approximation scheme to the SSM). We follow the notation of Definition 2.6 hold. Denote the approximation mapping at each SSM step (2.6) as a measurable map \u03a8i : Rd \u00d7 RNd \u00d7\n[0, T ]\u2192 Rd. The SSM variant is then, corresponding to (2.6)-(2.7): set Xi,N0 = Xi0 for i \u2208 J1, NK; then for all i \u2208 J1, NK and n \u2208 J0,M \u2212 1K\nY i,?,N n = \u03a8i(X i,N n , X N n , h), X N n = (X 1,N n , . . . , X N,N n ), \u00b5 Y,N n (dx) :=\n1\nN N\u2211 j=1 \u03b4 Y j,?,N n (dx),\n(B.2)\nX i,N n+1 = Y i,?,N n + b(tn, Y i,?,N n , \u00b5 Y,N n )h+ \u03c3(tn, Y i,?,N n , \u00b5 Y,N n )\u2206W i n, \u2206W i n = W i tn+1 \u2212W i tn , (B.3)\nwhere for any i the map \u03a8i is an approximation to \u03a8\u0302i solving (B.1).\nWe emphasise that at this point, our assumption is that the maps \u03a8i can be found. We discuss how to find them in the next section.\nProposition B.2. Let the assumptions of Theorem 2.10 hold. Recall the notation of Definition 2.6 and (B.1). For the \u03a8\u0302i and \u03a8i defined in (B.1) and (B.2) respectively, if supi E[|\u03a8\u0302i(xi, x, h)\u2212\u03a8i(xi, x, h)|2] \u2264 Ch for all x = (x1, . . . , xN ) \u2208 L20(RNd) and some constant C (independent of h,N,M but depending on T ), then\nsup n\u2208J1,MK sup i\u2208J1,NK\nE [ |X\u0302i,Nn \u2212X i,N n |2 ] \u2264 Ch. (B.4)\nThe main interpretation is that as long as the implicit Equation (2.6) is solved approximately up to an accuracy of size h (the time-step increment) in L2-norm, then the final order of convergence of the numerical scheme is preserved.\nProof. We proceed by induction since for all i \u2208 J1, NK, by definition, we have X\u0302i,N0 = X i,N 0 = X i 0. Step: The initial case. We prove that supi\u2208J1,NK E [ |X\u0302i,N1 \u2212 X i,N 1 |2 ] \u2264 Ch. By the assumptions of Proposition B.2 we have\nsup i\u2208J1,NK\nE [ |Y i,?,N0 \u2212 Y i,?,N 1 |2 ] \u2264 sup i\u2208J1,NK E [ |\u03a8\u0302i(Xi0, X0, h)\u2212\u03a8i(Xi0, X0, h)|2 ] \u2264 Ch.\nFor all i \u2208 J1, NK, since function b and \u03c3 are Lipschitz, by similar arguments in (4.31),\nsup i\u2208J1,NK\nE [ |X\u0302i,N1 \u2212X i,N 1 |2 ] \u2264 C sup i\u2208J1,NK E [ |Y i,?,N0 \u2212 Y i,?,N 1 |2 + \u2223\u2223W (2)(\u00b5Y,N0 , \u00b5\u0302Y,N0 )\u2223\u22232h] \u2264 sup\ni\u2208J1,NK E [ |Y i,?,N0 \u2212 Y i,?,N 1 |2 ] \u2264 Ch. (B.5)\nStep: The inductive case. For n \u2208 J1,M \u2212 1K, given supi\u2208J1,NK E [ |X\u0302i,Nn \u2212 X i,N n |2 ] \u2264 Ch, we need to\nproof supi\u2208J1,NK E [ |X\u0302i,Nn+1 \u2212X i,N n+1|2 ] \u2264 Ch, similarly, we first proof the result for the first step, from the assumption of Proposition B.2,\nsup i\u2208J1,NK\nE [ |Y i,?,Nn \u2212 Y i,?,N n |2 ] = sup i\u2208J1,NK E [ |\u03a8\u0302i(X\u0302in, X\u0302n, h)\u2212\u03a8(X i n, Xn, h)|2 ] \u2264 2 sup\ni\u2208J1,NK E [ |\u03a8\u0302i(X\u0302in, X\u0302n, h)\u2212 \u03a8\u0302i(X i n, Xn, h)|2 ] + 2 sup i\u2208J1,NK E [ |\u03a8\u0302i(X i n, Xn, h)\u2212\u03a8i(X i n, Xn, h)|2 ] \u2264 2 sup\ni\u2208J1,NK E [ |\u03a8\u0302i(X\u0302in, X\u0302n, h)\u2212 \u03a8\u0302i(X i n, Xn, h)|2 ] + 2h. (B.6)\nRecall the results in Section 4.2, the arguments in (4.19) are satisfied for all i \u2208 J1, NK, thus,\nsup i\u2208J1,NK\nE [ |\u03a8\u0302i(X\u0302in, X\u0302n, h)\u2212 \u03a8\u0302i(X i n, Xn, h)|2 \u2264 sup i\u2208J1,NK E [ |X\u0302in \u2212X i n|2(1 + Ch) \u2264 Ch.\nPlug the result above into (B.6) to conclude\nsup i\u2208J1,NK\nE [ |Y i,?,Nn \u2212 Y i,?,N n |2 ] \u2264 Ch.\nAnd, by similar argument in (B.5), we have\nsup i\u2208J1,NK\nE [ |X\u0302i,Nn+1 \u2212X i,N n+1|2 ] \u2264 Ch.\nB.2 Deploying Newton\u2019s method\nWe now provide a discussion on using Newton\u2019s method to solve (2.6) in the scope of the SSM. We first introduce Newton\u2019s method for high dimensions. Recall the functions V, u, f in (1.4), (2.2), and the SSM in Definition 2.6.\nFor simplicity of presentation, we assume that the function u only depends on the space-components (this is inline with the numerical examples section) and f has continuous second order derivative. Fix x \u2208 RNd, for y = (y1, y2, . . . , yN ) \u2208 (Rd)N , for the functions V, F : RNd \u2192 RNd and u, f : Rd \u2192 Rd, we want to find a solution of y 7\u2192 F (y) (given by (2.6)) defined as\nRNd 3 y 7\u2192 F (y) = y \u2212 x\u2212 hV (y) = 0, V = (V1, V2, . . . , VN ) and Vi(y) = u(yi) + 1\nN N\u2211 j=1 f(yi \u2212 yj).\nFor a fixed x \u2208 RNd, Lemma 4.2 ensures that a unique y? exists satisfying F (y?) = 0. Setting as initial guess of y0 = x, we denote the \u03bath-iteration of the Newton method by y\u03ba and define it as\ny0 = x, y\u03ba+1 = y\u03ba \u2212 [\u2207F ]\u22121(y\u03ba)F (y\u03ba),\nwhere \u2207F stands for the Jacobian matrix of F . Denoting INd as the identity matrix in Nd-dimensions, we express the Jacobian of F in closed form as\n[\u2207F ](y) = INd \u2212 hA(y) + h\nN \u0393(y) where for y = (y1, y2, . . . , yN ) \u2208 (Rd)N we have\nA(y) = \u2207u(y1) \u00b7 \u00b7 \u00b7 0... . . . ... 0 \u00b7 \u00b7 \u00b7 \u2207u(yN ) +  1 N \u2211N j=1\u2207f(y1 \u2212 yj) \u00b7 \u00b7 \u00b7 0 ... . . . ... 0 \u00b7 \u00b7 \u00b7 1N \u2211N j=1\u2207f(yN \u2212 yj) \n\u0393(y) = \u2207f(y1 \u2212 y1) \u00b7 \u00b7 \u00b7 \u2207f(y1 \u2212 yn)... . . . ... \u2207f(yn \u2212 y1) \u00b7 \u00b7 \u00b7 \u2207f(yn \u2212 yn)  . The matrix A(y) is a block diagonal matrix, and \u0393 is a symmetric matrix since f is odd and its main diagonal is equal to \u2207f(0). We stop the Newton\u2019s iteration at step \u03ba when the error tolerance rule\n\u2016y\u03ba\u2212 y\u03ba\u22121\u2016\u221e < \u221a h is satisfied. We note that since \u0393(\u00b7) is a symmetric matrix weighted by hN which is an order 1/N smaller that INd and hA(\u00b7) one can think of ignoring it in favour of an approximate Newton\u2019s method.\nTheoretical foundation for methodological choices. As mentioned, Lemma 4.2 ensures a unique y? exists solving F (y?) = 0. Proposition 4.3 and 4.4 ensure continuous dependence of y? on x, and hence assuming h small enough the choice of y0 = x as the initial guess for y? in the Newton method is justified. From [53, Theorem 4.4], under the extra assumption that F is twice differentiable with continuous derivatives, we have that the Newton iteration converges quadratically to the unique solution y?. In fact, given h small enough and complementing with the trick highlighted in Remark 2.7 one can show that V in (2.2) has a strictly negative one-sided Lipschitz constant and hence \u2207V is strict negative definite matrix (see [44]) and hence so is\u2207F \u2013 this ensures that\u2207F is nonsingular (also at y?) and thus [53, Theorem 4.4] applies guaranteeing convergence.\nIn the scope of the examples presented in Section 3, with the choices above, we found that the condition \u2016y\u03ba \u2212 y\u03ba\u22121\u2016\u221e < \u221a h is attained within two to four Newton method iterations, i.e., with \u03ba \u2264 4."
        }
    ],
    "title": "Euler simulation of interacting particle systems and McKean-Vlasov SDEs with fully superlinear growth drifts in space and interaction",
    "year": 2023
}