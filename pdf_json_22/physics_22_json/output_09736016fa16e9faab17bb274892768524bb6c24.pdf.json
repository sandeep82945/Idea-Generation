{
    "abstractText": "We address the problem of testing the quantumness of two\u2010dimensional systems in the prepare\u2010and\u2010 measure (PM) scenario, using a large number of preparations and a large number of measurement settings, with binary outcome measurements. In this scenario, we introduce constants, which we relate to the Grothendieck constant of order 3. We associate them with the white noise resistance of the prepared qubits and to the critical detection efficiency of the measurements performed. Large\u2010 scale numerical tools are used to bound the constants. This allows us to obtain new bounds on the minimum detection efficiency that a setup with 70 preparations and 70 measurement settings can tolerate.",
    "authors": [
        {
            "affiliations": [],
            "name": "P\u00e9ter Divi\u00e1nszky"
        }
    ],
    "id": "SP:1c646b1799ef887d23700b46a09cc207ab800ce5",
    "references": [
        {
            "authors": [
                "J.S. Bell"
            ],
            "title": "On the Einstein-Poldolsky-Rosen paradox. Physics 1, 195\u2013200",
            "venue": "https:// doi. org/",
            "year": 1964
        },
        {
            "authors": [
                "H.M. Wiseman",
                "S.J. Jones",
                "A.C. Doherty"
            ],
            "title": "Steering, entanglement, nonlocality, and the Einstein-Podolsky-Rosen paradox",
            "venue": "Phys. Rev. Lett",
            "year": 2007
        },
        {
            "authors": [
                "J. Bowles",
                "T. V\u00e9rtesi",
                "M.T. Quintino",
                "N. Brunner"
            ],
            "title": "One-way Einstein-Podolsky-Rosen steering",
            "venue": "Phys. Rev. Lett. 112,",
            "year": 2004
        },
        {
            "authors": [
                "S. Jevtic",
                "M.J.W. Hall",
                "M.R. Anderson",
                "M. Zwierz",
                "H.M. Wiseman"
            ],
            "title": "Einstein-Podolsky-Rosen steering and the steering ellipsoid",
            "venue": "JOSA B",
            "year": 2015
        },
        {
            "authors": [
                "R. Gallego",
                "N. Brunner",
                "C. Hadley",
                "A. Ac\u00edn"
            ],
            "title": "Device-independent tests of classical and quantum dimensions",
            "venue": "Phys. Rev. Lett",
            "year": 2010
        },
        {
            "authors": [
                "H. Buhrman",
                "R. Cleve",
                "S. Massar",
                "R. de Wolf"
            ],
            "title": "Nonlocality and communication",
            "venue": "complexity. Rev. Mod. Phys",
            "year": 2010
        },
        {
            "authors": [
                "J. Ahrens",
                "P. Badziag",
                "A. Cabello",
                "M. Bourennane"
            ],
            "title": "Experimental device-independent tests of classical and quantum dimensions",
            "venue": "Nat. Phys",
            "year": 2012
        },
        {
            "authors": [
                "M Hendrych"
            ],
            "title": "Experimental estimation of the dimension of classical and quantum systems",
            "venue": "Nat. Phys",
            "year": 2012
        },
        {
            "authors": [
                "J. Ahrens",
                "P. Badzi\u0105g",
                "M. Paw\u0142owski",
                "M. \u017bukowski",
                "M. Bourennane"
            ],
            "title": "Experimental tests of classical and quantum dimensionality",
            "venue": "Phys. Rev. Lett",
            "year": 2014
        },
        {
            "authors": [
                "D. Poderini",
                "S. Brito",
                "R. Nery",
                "F. Sciarrino",
                "R. Chaves"
            ],
            "title": "Criteria for nonclassicality in the prepare-and-measure scenario",
            "venue": "Phys. Rev. Res",
            "year": 2020
        },
        {
            "authors": [
                "C de Gois"
            ],
            "title": "General method for classicality certification in the prepare and measure scenario",
            "venue": "PRX Quantum",
            "year": 2021
        },
        {
            "authors": [
                "G. Dr\u00f3tos",
                "K.F. P\u00e1l",
                "T. V\u00e9rtesi"
            ],
            "title": "Self-testing of semisymmetric informationally complete measurements in a qubit prepare-andmeasure scenario. arXiv https:// doi",
            "year": 2023
        },
        {
            "authors": [
                "A. Ambainis",
                "A. Nayak",
                "A. Ta-Shma",
                "U. Vazirani"
            ],
            "title": "Dense quantum coding and quantum finite automata",
            "venue": "J. ACM",
            "year": 2002
        },
        {
            "authors": [
                "V. Mannalath",
                "A. Pathak"
            ],
            "title": "Bounds on semi-device-independent quantum random-number expansion capabilities",
            "venue": "Phys. Rev. A",
            "year": 2022
        },
        {
            "authors": [
                "Li",
                "H.-W",
                "M. Paw\u0142owski",
                "Yin",
                "Z.-Q",
                "Guo",
                "G.-C",
                "Han",
                "Z.-F"
            ],
            "title": "Semi-device-independent randomness certification using n \u2192 1 quantum random access",
            "venue": "codes. Phys. Rev. A",
            "year": 2012
        },
        {
            "authors": [
                "M Vaisakh"
            ],
            "title": "Mutually unbiased balanced functions and generalized random access codes",
            "venue": "Phys. Rev. A",
            "year": 2021
        },
        {
            "authors": [
                "R Krishna Patra"
            ],
            "title": "Classical analogue of quantum superdense coding and communication advantage of a single quantum",
            "venue": "arXiv https:// doi. org/",
            "year": 2022
        },
        {
            "authors": [
                "J.F. Doriguello",
                "A. Montanaro"
            ],
            "title": "Quantum random access codes for Boolean functions. Quantum 5, 402",
            "venue": "https:// doi. org/",
            "year": 2021
        },
        {
            "authors": [
                "G.P. Alves",
                "N. Gigena",
                "J. Kaniewski"
            ],
            "title": "Biased random access codes. arXiv https:// doi",
            "year": 2023
        },
        {
            "authors": [
                "S. Khot",
                "A. Naor"
            ],
            "title": "Grothendieck-type inequalities in combinatorial optimization",
            "venue": "Commun. Pure Appl. Math",
            "year": 2012
        },
        {
            "authors": [
                "B.S. Tsirelson"
            ],
            "title": "Some results and problems on quantum Bell-type inequalities",
            "venue": "Hadronic J. Suppl",
            "year": 1993
        },
        {
            "authors": [
                "A. Ac\u00edn",
                "N. Gisin",
                "B. Toner"
            ],
            "title": "Grothendieck\u2019s constant and local models for noisy entangled quantum states",
            "venue": "Phys. Rev. A",
            "year": 2006
        },
        {
            "authors": [
                "J. Krivine"
            ],
            "title": "Constantes de Grothendieck et fonctions de type positif sur les spheres",
            "venue": "Adv. Math",
            "year": 1979
        },
        {
            "authors": [
                "N. Gisin",
                "B. Gisin"
            ],
            "title": "A local hidden variable model of quantum correlation exploiting the detection loophole",
            "venue": "Phys. Lett. A",
            "year": 1999
        },
        {
            "authors": [
                "M. Navascu\u00e9s",
                "T. V\u00e9rtesi"
            ],
            "title": "Bounding the set of finite dimensional quantum correlations",
            "venue": "Phys. Rev. Lett. 115,",
            "year": 2050
        },
        {
            "authors": [
                "A. Tavakoli",
                "J. Kaniewski",
                "T. V\u00e9rtesi",
                "D. Rosset",
                "N. Brunner"
            ],
            "title": "Self-testing quantum states and measurements in the prepare-andmeasure scenario",
            "venue": "Phys. Rev. A",
            "year": 2018
        },
        {
            "authors": [
                "G. Pisier"
            ],
            "title": "Grothendieck\u2019s Theorem, past and present",
            "venue": "Bull. Amer. Math. Soc. 49,",
            "year": 2012
        },
        {
            "authors": [
                "Hua",
                "B. et al. Towards Grothendieck constants",
                "LHV models in quantum mechanics. J. Phys. A"
            ],
            "title": "Math",
            "venue": "Theor. 48, 065302. https:// doi. org/ 10. 1088/ 1751- 8113/ 48/6/ 065302",
            "year": 2015
        },
        {
            "authors": [
                "S Designolle"
            ],
            "title": "Improved local models and new Bell inequalities via Frank-Wolfe algorithms. arXiv https:// doi",
            "year": 2023
        },
        {
            "authors": [
                "P. Divi\u00e1nszky",
                "E. Bene",
                "T. V\u00e9rtesi"
            ],
            "title": "Qutrit witness from the Grothendieck constant of order four",
            "venue": "Phys. Rev. A",
            "year": 2017
        },
        {
            "authors": [
                "S.R. Finch"
            ],
            "title": "Mathematical constants",
            "venue": "http:// www. cambr idge. org/ catal ogue/ catal ogue. asp? isbn=",
            "year": 2003
        },
        {
            "authors": [
                "S. Brierley",
                "M. Navascues",
                "T. Vertesi"
            ],
            "title": "Convex separation from convex optimization for large-scale problems",
            "venue": "Preprint at https:// arXiv. org/ quant-",
            "year": 2016
        },
        {
            "authors": [
                "J.F. Clauser",
                "M.A. Horne",
                "A. Shimony",
                "R.A. Holt"
            ],
            "title": "Proposed experiment to test local hidden-variable theories",
            "venue": "Phys. Rev. Lett",
            "year": 1969
        },
        {
            "authors": [
                "E.G. Gilbert"
            ],
            "title": "An iterative procedure for computing the minimum of a quadratic form on a convex set",
            "venue": "SIAM J. Control",
            "year": 1966
        },
        {
            "authors": [
                "T. V\u00e9rtesi"
            ],
            "title": "More efficient Bell inequalities for Werner states",
            "venue": "Phys. Rev. A",
            "year": 2008
        },
        {
            "authors": [
                "R.F. Werner"
            ],
            "title": "Quantum states with Einstein-Podolsky-Rosen correlations admitting a hidden-variable model",
            "venue": "Phys. Rev. A",
            "year": 1989
        },
        {
            "authors": [
                "J. Bowles",
                "N. Brunner",
                "M. Pawlowski"
            ],
            "title": "Testing dimension and nonclassicality in communication networks",
            "venue": "Phys. Rev. A",
            "year": 2015
        },
        {
            "authors": [
                "Larsson",
                "J.A. Loopholes in Bell inequality tests of local realism. J. Phys. A"
            ],
            "title": "Math",
            "venue": "Theor. 47, 424003. https:// doi. org/ 10. 1088/ 17518113/ 47/ 42/ 424003 (2014). 19 Vol.:(0123456789) Scientific Reports |",
            "year": 2023
        },
        {
            "authors": [
                "M. Dall\u2019Arno",
                "E. Passaro",
                "R. Gallego",
                "A. Acin"
            ],
            "title": "Robustness of device-independent dimension witnesses",
            "venue": "Phys. Rev. A",
            "year": 2012
        },
        {
            "authors": [
                "Li",
                "H.-W",
                "Yin",
                "Z.-Q",
                "M. Paw\u0142owski",
                "Guo",
                "G.-C",
                "Han",
                "Z.-F"
            ],
            "title": "Detection efficiency and noise in a semi-device-independent randomness-extraction protocol",
            "venue": "Phys. Rev. A",
            "year": 2015
        },
        {
            "authors": [
                "N. Brunner",
                "M. Navascu\u00e9s",
                "T. V\u00e9rtesi"
            ],
            "title": "Dimension witnesses and quantum state discrimination",
            "venue": "Phys. Rev. Lett",
            "year": 2013
        },
        {
            "authors": [
                "P. Raghavendra",
                "D. Steurer"
            ],
            "title": "Towards computing the Grothendieck constant,",
            "venue": "In Proceedings of the Twentieth Annual ACM-SIAM Symposium on Discrete Algorithms,",
            "year": 2009
        },
        {
            "authors": [
                "T. V\u00e9rtesi",
                "K.F. P\u00e1l"
            ],
            "title": "Generalized Clauser-Horne-Shimony-Holt inequalities maximally violated by higher-dimensional systems",
            "venue": "Phys. Rev. A",
            "year": 2008
        },
        {
            "authors": [
                "M. Epping",
                "H. Kampermann",
                "D. Bru\u00df"
            ],
            "title": "Designing Bell inequalities from a Tsirelson",
            "venue": "bound. Phys. Rev. Lett",
            "year": 2013
        },
        {
            "authors": [
                "M. Epping",
                "H. Kampermann",
                "D. Bru\u00df"
            ],
            "title": "Optimization of Bell inequalities with invariant Tsirelson bound",
            "venue": "J. Phys. A",
            "year": 2014
        },
        {
            "authors": [
                "A. Frieze",
                "R. Kannan"
            ],
            "title": "Quick approximation to matrices and applications",
            "venue": "https:// doi. org/ 10",
            "year": 1997
        },
        {
            "authors": [
                "C. Borgs",
                "J.T. Chayes",
                "L. Lov\u00e1sz",
                "V.T. S\u00f3s",
                "K. Vesztergombi"
            ],
            "title": "Convergent sequences of dense graphs. I. Subgraph frequencies, metric properties and testing",
            "venue": "Adv. Math",
            "year": 2008
        },
        {
            "authors": [
                "N. Alon",
                "A. Naor"
            ],
            "title": "Approximating the cut-norm via Grothendieck\u2019s inequality",
            "venue": "In Proceedings of the Thirty-Sixth Annual ACM Symposium on Theory of Computinghttps:// doi. org/",
            "year": 2004
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nwww.nature.com/scientificreports"
        },
        {
            "heading": "Certification of qubits",
            "text": "in the prepare\u2011and\u2011measure scenario with large input alphabet and connections with the Grothendieck constant"
        },
        {
            "heading": "P\u00e9ter Divi\u00e1nszky , Istv\u00e1n M\u00e1rton , Erika Bene & Tam\u00e1s V\u00e9rtesi *",
            "text": "We address the problem of testing the quantumness of two\u2011dimensional systems in the prepare\u2011and\u2011 measure (PM) scenario, using a large number of preparations and a large number of measurement settings, with binary outcome measurements. In this scenario, we introduce constants, which we relate to the Grothendieck constant of order 3. We associate them with the white noise resistance of the prepared qubits and to the critical detection efficiency of the measurements performed. Large\u2011 scale numerical tools are used to bound the constants. This allows us to obtain new bounds on the minimum detection efficiency that a setup with 70 preparations and 70 measurement settings can tolerate.\nQuantum theory reveals interesting and counter-intuitive phenomena in even the simplest physical systems. Paradigmatic examples are Bell nonlocality1,2 and Einstein-Podolsky-Rosen (EPR) steering3\u20136. These nonlocal phenomena appear as strong correlations between the outcomes of spatially separated measurements performed by independent observers. These correlations enable us to distinguish the classical and quantum origins of the experiments. Recently, a similar split between classical and quantum features was found in a setup closely related to quantum communication tasks, the so-called prepare-and-measure (PM) scenario7. This scenario can be viewed as a communication game8 between two parties, Alice (the sender) and Bob (the receiver), where the dimension of the classical (versus quantum) system communicated from Alice to Bob is bounded from above.\nThe PM game is described as follows (see panel (a) of Fig.\u00a01). Upon receiving an input x = (1, . . . , n) , a preparation device (controlled by Alice) emits a physical system in a quantum state \u03c1x . We assume \u03c1x \u2208 L(Cd) for a given d \u2265 2 . In the following, however, we will focus explicitly on d = 2 , that is, we assume that two-dimensional quantum systems (qubits) or classical systems (bits) are transmitted from Alice to Bob. The state \u03c1x is passed to a measurement device which, upon receiving an input y = (1, . . . ,m) performs a measurement and obtains an outcome b = (1, . . . , o) . In this paper we will focus on the smallest, nontrivial case of o = 2 , i.e., measurements with two outcomes, in which case we denote the outcomes by b = \u00b11.\nOur goal in this scenario is to compare and quantify the performance of qubits with that of classical bits. This scenario has been discussed to some extent for a small number of preparations n and measurements m (see e.g. Refs.7,9\u201314. Note also that the emblematic protocol, the so-called quantum random access code15 (QRAC), is a special instance of the PM game. See Ref.8 for more references on communication protocols related to QRAC. These games have also found applications in randomness generation (see Refs.16,17). More recent notable generalizations of QRAC protocols have been considered in Refs.18\u201321.\nHowever, in this paper we would like to turn our attention to the case of large n and m (i.e. in the range of 70). We will see that the main bottleneck of the study is the computation of the relevant quantities associated with the classical bit case for which we develop large scale numerical tools in this paper. We first concentrate on the qubit case, and then we will elaborate on the classical bit case. In the qubit case we define q(M), whereas in the classical bit case we define the quantities S(M) and L2(M) . These quantities in turn define the ratios q(M)/L2(M) and (q(M)\u2212 S(M))/(L2(M)\u2212 S(M)) , which upper-bound our new constants KPM and K D , respectively. These\nOPEN"
        },
        {
            "heading": "MTA Atomki Lend\u00fclet Quantum Correlations Research Group, Institute for Nuclear Research, P.O. Box 51,",
            "text": "Debrecen H-4001, Hungary. *email: tvertesi@atomki.hu\n2 Vol:.(1234567890) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nconstants have the physical meaning of defining the respective critical white noise tolerance and critical detection efficiency of the binary-outcome measurements in the qubit prepare-and-measure scenario.\nIn this paper, we relate these two introduced constants to the purely mathematical Grothendieck constant, KG 22. More generally, Grothendieck\u2019s problem has implications for many areas of mathematics. It first had a major impact on the theory of Banach spaces and then on C\u2217-algebras. More recently, it has influenced graph theory and computer science (see e.g. Ref.23). Furthermore, a connection of the Grothendieck problem to Bell nonlocality was noticed by Tsirelson24. Subsequently, Acin et\u00a0al.25, based on the work of Tsirelson, exploited this connection to show that the critical visibility of the Bell nonlocal two-qubit Werner state is given by 1/KG(3) , where KG(3) is a refined version of Grothendieck\u2019s constant26. Relating the local bound of correlation Bell scenarios to the classical bit bound of PM communication scenarios, we find in this paper that the new constant KPM is equal to KG(3) . We also introduce the constant K D , which we relate to the critical detection efficiency \u03b7crit of binary-outcome measurements in the qubit PM scenario. In particular, we find in our model for finite detection efficiency that \u03b7crit = 1/K D . Armed with our efficient numerical tools, we bound the constant K D from below, which implies an upper bound of 0.6377 on \u03b7crit.\nQubit case: In the qubit binary outcome ( o = 2 ) case, the measurement is described by two positive operators { b|y} , b = \u00b11 acting on C2 which sum to the identity b=+1|y + b=\u22121|y = 1 for each y, where 1 denotes the 2\u00d7 2 identity matrix. The statistics of the experiment are then given by the formula\nIt is important to note that both the preparations and the measurements are unknown to the observer, up to the fact that the dimension of the transmitted system is two. Since we have binary outcomes b = {+1,\u22121} it becomes convenient to use expectation values\n(1)P(b|x, y) = Tr(\u03c1x\ufffdb|y).\n(2)Ex,y = P(b = +1|x, y)\u2212 P(b = \u22121|x, y).\nFigure\u00a01. The prepare-and-measure setup for (a) qubit communication and (b) a classical model using one bit of communication. In (a) upon receiving the input settings a and b , Alice sends to Bob a qubit in the quantum state \u03c1 a . Then Bob performs a projective measurement Mb|\ufffdb = (1 + b\ufffdb \u00b7 \u03c3)/2 , where the two outcomes are labelled by b = \u00b11 . As a result, the expectation value of Bob\u2019s \u00b11 outcome becomes E(\ufffda, \ufffdb) = \ufffda \u00b7 \ufffdb (see Eq.\u00a0(5)). In (b) the classical one bit Gisin-Gisin protocol27 is as follows. The shared randomness is distributed between the two parties, where the unit vector \ufffd \u2208 S2 is chosen uniformly at random from the sphere. After obtaining the settings a and b , Alice communicates to Bob the classical binary message c = sgn(\ufffda \u00b7 \ufffd ) . Then Bob outputs b = sgn(c\ufffdb \u00b7 \ufffd ) with probability |\ufffdb \u00b7 \ufffd | , and b = 0 with probability 1\u2212 |\ufffdb \u00b7 \ufffd | . Finally, Bob performs a coarse graining on his outputs by grouping b = 0 with b = 1 and identifying both of them with outcome b = 1 . As a result, as it is shown in Section\u00a0\"Adapting the Gisin-Gisin model to the PM scenario\", the expectation value of Bob\u2019s b = \u00b11 outcome becomes E(\ufffda, \ufffdb) = (\ufffda \u00b7 \ufffdb+ 1)/2.\n3 Vol.:(0123456789) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nNote that Ex,y can take up the values in [\u22121,+1] for all x,\u00a0y. However, if the Hilbert space dimension of the communicated particle is bounded, then in general not all expectation values Ex,y in [\u22121,+1] become possible. The simplest scenario that shows this effect appears already for n = 3 , m = 2 and o = 2 (see Ref.7 for an example).\nWith respect to the measurement operators Mb|y , one case, namely the set of projective rank-1 measurements, is of particular interest to us. In this case, we have\nwhere \ufffdby \u2208 S2 , b = \u00b11 and \ufffd\u03c3 = (\u03c3x , \u03c3y , \u03c3z) is the vector of Hermitian 2\u00d7 2 Pauli matrices. On the other hand, let us set\nwhere \ufffdax \u2208 S2 . This density matrix corresponds to a pure state with Bloch vector ax . Note that in this case, the above equations give us\nwhere \ufffdax , \ufffdby \u2208 S2. Limits on the set of possible distributions in dimension two can be captured by the following expression\nwhere Mx,y are coefficients of a real witness matrix M of dimension n\u00d7m . Let us then define the quantity\nwhere Ex,y is of the form (2), and where we maximize the expression over Bob\u2019s measurements {Mb|y} and the qubit state \u03c1x in Eq.\u00a0(1). Thus, Q(M) is the value that is achievable with the most general two-dimensional quantum resources in our PM setup. We further define the quantity\nwhere Ex,y = \ufffdax \u00b7 \ufffdby and we maximize over the unit vectors ax and by in the three-dimensional Euclidean space. It turns out that Q(M) can be obtained with pure qubit states and projective measurements11. However, the optimal projective measurements are in general not of rank-1, they can be of rank-0 or\u00a0rank-2 as well. Indeed, there are example matrices M (even in the simple n = m = 3 , o = 2 case) for which Q(M) > q(M) . Note that q(M) corresponds to projective qubit measurements of rank 1, in which case Ex,y = \ufffdax \u00b7 \ufffdby (see Eq.\u00a0(5)). Yet, as we will see, the set {Ex,y}x,y obtained by rank-1 projective measurements is a significant subset of the set {Ex,y}x,y corresponding to the most general qubit measurements. The tools for computing the value Q(M) can be found in Refs.28,29.\nImportantly, the value of Q(M) can serve as a dimension witness in the prepare-and-measure scenario7. Indeed, if W > Q(M) for some M (where the witness W is defined by Eq.\u00a0(6)), this implies that the set of states {\u03c1x}nx=1 transmitted to Bob must have contained at least one state \u03c1x=x\u2032 of at least three dimensions (that is qutrit).\nClassical bit versus qubit case\u2014It turns out that the witness W can also serve as a quantumness witness. To this end, let us discuss the classical bit case. That is, we want to bound the expression\u00a0(6) if Alice can only prepare classical two-dimensional systems (i.e. bits). Let us denote the bound on (6) by L2(M) , which corresponds to this situation. If W > L2(M) , this certifies that some of the measurements performed by Bob are true (incompatible) quantum measurements acting on true qubit states7,30. Mathematically, the classical bit case is equivalent to the qubit case discussed above, with the restriction that all qubits are sent in the same basis, and all measurements of Bob are carried out in the very same basis. That is, if we want to maximize (6) for correlations Ex,y arising from classical two-dimensional systems, the maximum can be attained with pure states\nwhere ax = \u00b11 , and observables By = 0|y \u2212 1|y which have the form\nwhere \u03c3z is the standard Pauli matrix\n(3)\ufffdb|y = 12 + b\ufffdby \u00b7 \ufffd\u03c3\n2 ,\n(4)\u03c1x = 12 + \ufffdax \u00b7 \ufffd\u03c3\n2 ,\n(5)Ex,y = \ufffdax \u00b7 \ufffdby ,\n(6)W = n \u2211\nx=1\nm \u2211\ny=1 Mx,yEx,y ,\n(7)Q(M) = max n \u2211\nx=1\nm \u2211\ny=1 Mx,yEx,y ,\n(8)q(M) = max n \u2211\nx=1\nm \u2211\ny=1 Mx,yEx,y ,\n(9)\u03c1x = 12 + ax \u00b7 \u03c3z\n2 ,\n(10)By = b+y |0\ufffd\ufffd0| + b\u2212y |1\ufffd\ufffd1|,\n\u03c3z = (\n1 0 0 \u22121\n)\n4 Vol:.(1234567890) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nand both b+y , b\u2212y are \u00b11 variables. Inserting these values into (2) we obtain\nSince we have binary variables ax = \u00b11 , they translate to Ex,y = b+y if ax = 1 and Ex,y = b\u2212y if ax = \u22121 . Then the classical one-bit bound L2(M) is given by\nwhere Ex,y is defined by (11) and we maximize over all binary variables ax , b+y , b\u2212y \u2208 {\u22121,+1} . In words, the expression\u00a0(11) corresponds to the following deterministic protocol. Alice, depending on x, prepares a bit ax = \u00b11 , which she sends to Bob, who outputs b = \u00b11 depending on the value of ax and the measurement setting y. That is, Bob\u2019s output is a deterministic function b = f (ax , y) , where the output assumes b = \u00b11 . We can write\nwhere the maximum is taken over all binary ax , b+y and b\u2212y variables \u00b11 . We can eliminate the variables b+y and b\u2212y from the above expression and get the following formula for L2(M):\nwhich only consists of maximization over the binary variables ax = \u00b11 . In the above formula, Mx denotes the xth row of the real n\u00d7m matrix M, where \u2016v\u20161 denotes the Manhattan norm of the real vector v, i.e., \ufffdv\ufffd1 = \u2211\nx |vx | . We prove several interesting properties of L2(M) in the Methods Section\u00a0\"Properties of the L2 and Lk, k>2 norm\". In particular, L2 is proven to be a matrix norm. Let us recall that L2(M) is a key quantity in our study, as it enables witnessing both quantumness of preparations and quantumness of measurements. Indeed, W > L2(M) , where W is defined in equation\u00a0(6), certifies incompatible quantum measurements acting on true qubit states. That is, not all the performed measurements and not all prepared states originate from the same basis7. In Section\u00a0\"Properties of the L2 and Lk, k>2 norm\" we do not restrict our study to the properties of the L2 norm but generalize L2(M) to Lk(M) for any k > 2 and prove that Lk is a norm as well, moreover Lk(M) is a monotonic increasing function of k. Furthermore, in Section\u00a0\"Programming tips for the efficient implementation of the L2 and Lk codes\" we give tips for an efficient implementation of the branch-and-bound algorithm31 for computing the Lk(M) bound for k = 2 and for k > 2 as well.\nIntroducing the constants KPM and KD : We define two quantities KPM and KD which are related to L2(M) and q(M), and are defined as follows. Let us first introduce KPM , in which case we ask for the maximum ratio between q(M) and L2(M) . That is, we are interested in the value\nwhere the maximization is taken over all possible real n\u00d7m matrices M, where q(M) is defined by (8) and L2(M) is defined by\u00a0(12).\nLet us now recall the Grothendieck constant of order 322,25,26,32,33, which is given by\nwhere the maximization is taken over real matrices M of arbitrary dimensions n\u00d7m , q(M) is defined by (8) and L(M) is defined as follows\nwhere the maximum is taken over all ax , by \u2208 {\u22121,+1} . The value of KG(3) in (16), according to the recent work of Designolle et\u00a0al.34, is bounded by\nwhere the lower bound is an improved version of that given in Ref.35 and the upper bound is an improved version of that given in Refs.36,37. See Ref.38 for some historical data on the best lower and upper bounds for KG(d) . We prove that KPM = KG(3) , which will be given in the Results Section\u00a0\"Proof of the relation KPM=KG(3)\". We are interested in KD as well, a quantity similar to KPM . We define this quantity as follows\n(11)Ex,y = (1+ ax)b+y + (1\u2212 ax)b\u2212y\n2 .\n(12)L2(M) = max n \u2211\nx=1\nm \u2211\ny=1 Mx,yEx,y ,\n(13)L2(M) = max\n\n\n\ufffd\nx:ax=+1\nm \ufffd\ny=1 Mxyb\n+ y + \ufffd\nx:ax=\u22121\nm \ufffd\ny=1 Mxyb\n\u2212 y\n\n,\n(14)L2(M) = max ax=\u00b11\n\n\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\nx:ax=+1 Mx\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n1\n+\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\nx:ax=\u22121 Mx\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n1\n\n,\n(15)KPM = max M\nq(M)\nL2(M) ,\n(16)KG(3) = max M\nq(M) L(M) ,\n(17)L(M) = max n \u2211\nx=1\nm \u2211\ny=1 Mx,yaxby ,\n(18)1.4367 \u2264 KG(3) \u2264 1.4546,\n5 Vol.:(0123456789) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nwhere\nNote the relation\nwhenever L2(M) > S(M) (also note that q(M) \u2265 L2(M) ), therefore we have KD \u2265 KPM = KG(3) . From this we immediately obtain the lower bound KD \u2265 1.4367 . In this paper, we give efficient large-scale numerical methods to obtain even better lower bounds on the above quantity. Namely, we prove the lower bound KD \u2265 1.5682 . We also prove an upper bound of 2 on this quantity, so putting all together we have the following interval\nfor the constant KD . It is an open problem to close or at least reduce the gap between the lower and upper limits. We next present the Results section, which contains our main findings in three subsections."
        },
        {
            "heading": "Results",
            "text": ""
        },
        {
            "heading": "Proof of the relation K",
            "text": "PM = K G (3). To prove our claim, we relate L(M \u2032) to L2(M \u2032) , where M \u2032 is given by\nthe following matrix (see also\u00a0(67))\nwhere M is a real n\u00d7m matrix. Denote by Mx the x-th row of the matrix M. Note that according to the above definition M \u2032 has size 2n\u00d7m and M \u2032 has rows such that M \u2032x = Mx and M \u2032x+n = \u2212Mx for all x = 1, . . . , n . Then the following lemma holds.\nLemma 2.1 L2(M \u2032) = L(M \u2032) = 2L(M) for any matrix M \u2032 of the form (23), where L2 is the L2 norm given by the definition (12) and L is the local bound given by (17), (40).\nThe proof of this lemma is given in Methods Section\u00a0\"L-norm and L2-norm are the same for a special family of matrices M\u2019\u00a0\". Then we need to prove the following lemma.\nLemma 2.2 KPM \u2264 KG(3).\nFor an arbitrary matrix M, we have L2(M) \u2265 L(M) . This has been proved in Methods Section\u00a0\"Properties of the L2 and Lk, k>2 norm\". Then the lemma follows from the definitions\u00a0(16) and (15). Our next lemma reads\nLemma 2.3 KPM \u2265 KG(3).\nProof To prove this, it suffices to show that for an arbitrary real matrix M, there exists the matrix M \u2032 defined by (23) such that q(M \u2032) = 2q(M) and L2(M \u2032) = 2L(M) . The first relation follows from the special structure of M \u2032 . The second relation has been shown in Lemma\u00a02.1. Therefore, KPM cannot be less than KG(3) , which proves our claim.\nCorollary 2.4 As a corollary of the above Lemmas\u00a02.2 and\u00a02.3 we obtain KPM = KG(3).\nHence we have the same bounds 1.4367 \u2264 KPM \u2264 1.4546 as for KG(3) (see (18)). From the corollary above, we have a matrix M \u2032 of size 48\u00d7 24 with q(M \u2032)/L2(M \u2032) > \u221a 2 . Indeed, the construction is based on a matrix M\nof size 24\u00d7 24 , which provides q(M)/L(M) > \u221a 239. To the best of our knowledge, this is the smallest M matrix that has the property q(M)/L(M) > \u221a 2 . Then the 48-by-24 matrix M \u2032 follows from\u00a0(23). On the other hand, q(M)/L(M) = \u221a 2 is already attained with a 2\u00d7 2 matrix M in the CHSH-form40:\nIt remains an open question to show that KPM > \u221a 2 with a matrix size smaller than 48\u00d7 24 , which might use a different construction than the one above.\n(19)KD = max M q(M)\u2212 S(M) L2(M)\u2212 S(M) ,\n(20)S(M) = n \u2211\nx=1\nm \u2211\ny=1 Mx,y .\n(21) q(M)\u2212 S(M) L2(M)\u2212 S(M) \u2265 q(M) L2(M) ,\n(22)1.5682 \u2264 KD \u2264 2,\n(23)M \u2032 = (\nM \u2212M\n)\nM = (\n1 1 1 \u22121\n)\n.\n6 Vol:.(1234567890) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nProof of the bounds 1.5682 \u2264 K D \u2264 2. Upper bound: We first prove the upper bound. Translating the Gisin-Gisin model27 from the Bell nonlocality1,2 to the PM scenario7, we find that the following statistics can be obtained in the PM scenario with 1 bit of classical communication:\nwhere \ufffda \u2208 S2 denotes the preparation vector and \ufffdb \u2208 S2 denotes the measurement Bloch vector. We give the proof of this formula in the Methods Section\u00a0\"Adapting the Gisin-Gisin model to the PM scenario\" and we show panel (b) in Fig.\u00a01 for the description of the classical one-bit model. On one hand, due to the above Gisin-Gisin one-bit model, we have for an arbitrary n\u00d7m matrix M:\nwhere Ex,y has the form\u00a0(24) and we maximized over the unit vectors ax and by in the three-dimensional Euclidean space. On the other hand, substituting Ex,y := E(\ufffdax , \ufffdby) in the formula\u00a0(24) into (25) we find\nwhere maximization is over the unit vectors ax and by in the three-dimensional Euclidean space, and we also used the definition of q(M) in (8) and the definition of S(M) in (20). Comparing the right-hand side of (25) with (26), we have\nwhere the left-hand side of (19) is just KD , which proves the upper bound KD \u2264 2 . Lower bound: In the following, we prove the lower bound using large-scale numerical tools. Note, however,\nthat the resulting bound is rigorous and in particular the final result is due to exact computations. The steps are as follows.\nGiven a fixed setup with Alice\u2019s Bloch vectors ax , x = (1, . . . , n) and Bob\u2019s Bloch vectors by , y = (1, . . . ,m) the method is the following. We define the (n\u00d7m)-dimensional one-parameter family of matrices Exy(\u03b7) with entries\nwhere Ex,y = \ufffdax \u00b7 \ufffdby . We wish to show that for some \u03b7 \u2208 [0, 1] , the distribution\u00a0(28) in the PM scenario cannot be simulated with one bit of classical communication. In fact, due to the expectation value\u00a0(24) of the GisinGisin model, it is enough to consider the interval \u03b7 \u2208 [1/2, 1] . To show quantumness, we therefore need to find a matrix M of certain size n\u00d7m and a given \u03b7 \u2208 [1/2, 1] such that\nfor Exy(\u03b7) defined by (28), and L2(M) is defined by (12). The above problem, i.e., finding a suitable M with the smallest possible \u03b7 in (29), can be solved by a modified version39 of the original Gilbert algorithm41, a popular collision detection method used, for example, in the video game industry.\nThe algorithm is iterative, and the procedure adapted to our problem is given in Section\u00a0\"The modified Gilbert algorithm adapted to the PM scenario\". Indeed, using the algorithm of Gilbert, we find the value\nand a corresponding 70\u00d7 70 matrix M and Exy(\u03b7\u2217) in the form\u00a0(28) which satisfies inequality\u00a0(29). We will give more technical details of the input parameters and the implementation of the algorithm in Section\u00a0\"Parameters and implementation of Gilbert algorithm\". Then, rearranging (29) and making use of equation\u00a0(28), we find the bound\nwhere due to the definitions\u00a0(8), (19) the lower bound\non KD follows.\n(24)E(\ufffda, \ufffdb) = \ufffda \u00b7 \ufffdb+ 1 2 ,\n(25)max n \u2211\nx=1\nm \u2211 y=1 Mx,yEx,y \u2264 L2(M),\n(26) max\nn \u2211\nx=1\nm \u2211 y=1 Mx,yEx,y =\nmax \u2211\nxy Mxy\n( \ufffdax \u00b7 \ufffdby + 1 )\n2\n= q(M)+ S(M) 2 ,\n(27) q(M)\u2212 S(M) L2(M)\u2212 S(M) \u2264 2,\n(28)Ex,y(\u03b7) = \u03b7Ex,y + (1\u2212 \u03b7),\n(29) n \u2211 x=1 m \u2211 y=1 MxyExy(\u03b7) > L2(M)\n(30)\u03b7\u2217 = 0.6377\n(31) \u2211 xy MxyExy \u2212 S(M) L2(M)\u2212 S(M) > 1 \u03b7\u2217 ,\n(32)KD > (1/\u03b7\u2217) \u2243 1.5682\n7 Vol.:(0123456789) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0"
        },
        {
            "heading": "Physical meaning of the constants K",
            "text": "PM and K D . The role of KPM in the PM scenario: The value of KPM is interesting from a physical point of view as well, since it is related to the critical noise resistance of the experimental setup if the transmitted \u03c1x goes through a noisy, fully depolarizing channel. That is, 1\u2212 pcrit = 1\u2212 (1/KPM) gives the amount (1\u2212 pcrit) of critical white noise 1/2 that the PM experiment with rank-1 projective qubit measurements can maximally tolerate while still being able to detect quantumness. Namely, for a fully depolarizing channel with visibility parameter p the qubits \u03c1x emitted by Alice turn into p\u03c1x + (1\u2212 p)1/2 , and the expectation value\u00a0(5) becomes\nwhere {\ufffdax}x are the Bloch vectors of Alice\u2019s qubits, whereas {\ufffdby}y are the Bloch vectors of Bob\u2019s measurements. To witness quantumness, there must exist expectation values Exy in (33) and a matrix M of arbitrary size such that\nInserting (33) into (34) and making use of (8), we obtain\nfor the critical noise tolerance. In fact, the value of KG(3) appears in the studies25,36,42 of the Bell nonlocality of two-qubit Werner states43. Note that a recent approach in Ref.44, based on the simulability of Werner states with local models, yields the same relation\u00a0(35) between pcrit and 1/KG(3) .\nFrom the upper and lower bounds on KPM , the following bounds on the amount (1\u2212 pcrit) of critical white noise follow:\nThe role of KD in the PM scenario: In Section\u00a0\"Proof of the bounds 1.5682\u2264KD\u22642\" we proved the lower bound of KD \u2265 1.5682 . Below we prove that this bound is related to the finite detection efficiency threshold of Bob\u2019s measurements. To this end, we assume that Bob\u2019s detectors are not perfect and only fire with probability \u03b7 . Assume that when the measurement y fails to detect, Bob outputs by = 1 (due to possible relabelings there is no loss of generality). Assume further that the probability of detection \u03b7 is the same for all y. This is the problem of symmetric detection efficiency. A review of this problem in the Bell scenario can be found in Ref.45. On the other hand, the same problem in the PM scenario has been elaborated in Refs.46,47 and the upper bound of 1/ \u221a 2\non the critical value of the symmetric detection efficiency was found. Since \u03b7 does not depend on y, the expectation value Ex,y becomes Ex,y(\u03b7) = \u03b7Ex,y + (1\u2212 \u03b7) for all x and y. Hence, the witness matrix M detects quantumness with finite detection efficiency \u03b7 (assuming optimal preparation states and measurements) whenever we have\nRecalling S(M) = \u2211x,y Mx,y , solving the above relation for \u03b7 , and optimizing over all M witness matrices, we obtain the critical detection efficiency \u03b7crit:\nwhere KD is defined by (19). In particular using the lower bound value KD \u2265 1.5682 , we obtain the improved upper bound 0.6377 on \u03b7crit.\nIt should be noted, however, that the above is not the most general detection efficiency model. Rather than outputting by = 1 , Bob can output a third result, which could potentially give a lower detection efficiency threshold. An open problem is whether this third outcome can lower the detection efficiency threshold. In the above, we also assumed that Bob\u2019s qubit measurements are rank-1 projectors that can achieve q(M). However, it is known that the true qubit maximum Q(M) (in\u00a0(7)) can be larger than q(M) (in\u00a0(8)) for a given M. Hence, we can say that the most general symmetric detection efficiency threshold is upper bounded by 1/KD , and it is an open problem whether this upper bound is tight or not.\nLet us mention that in the two-outcome scenario a different type of modelling of the loss event due to the finite detection efficiency can also be imagined. Namely, let us assume that Bob associates the outcomes +1 and \u22121 to the no-detection event with equal probability. In this case, the expectation value Ex,y(\u03b7) = \u03b7Ex,y + (1\u2212 \u03b7) when outcome +1 is assigned to the no-detection event becomes \u03b7Ex,y . This leads to the modified inequality \u03b7q(M) > L2(M) in Eq.\u00a0(37) and the modified critical detection efficiency, \u03b7crit = minM (L2(M)/q(M)) = 1/KPM . Therefore, using Bob\u2019s non-deterministic assignment of the \u00b11 outcomes for the no-detection event, the critical detection efficiency can be linked to KG(3) = KPM , i.e., the Grothendieck constant of order 3. Note, however, that due to our finding that KG(3) < KD , the critical detection efficiency in this non-deterministic modelling of the no-detection event will be suboptimal compared to the deterministic assignment model, when we associate the no-detection event with a given outcome.\n(33)Exy = p\ufffdax \u00b7 \ufffdby ,\n(34) \u2211\nxy\nMxyExy > L2(M).\n(35)pcrit = min M\nL2(M) q(M) = 1 KPM = 1 KG(3)\n(36)0.3039 \u2264 (1\u2212 pcrit) \u2264 0.3125.\n(37)\u03b7q(M)+ (1\u2212 \u03b7) \u2211\nx,y\nMx,y > L2(M).\n(38)\u03b7crit = min M L2(M)\u2212 S(M) q(M)\u2212 S(M) = 1 KD ,\n8 Vol:.(1234567890) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0"
        },
        {
            "heading": "Methods",
            "text": "Properties of the L\n2 and L k , k > 2 norm. Notations: We first introduce notation used throughout this\nsubsection. Let An, n = 0, 1, 2, . . . be the set of n dimensional vectors over the set A . Let vi denote the ith element of v \u2208 An ( i = 1, 2, . . . , n ). Let _; _ : An \u00d7 Am \u2192 An+m denote the concatenation of vectors. Let () the singleton element of A0 . Further let (a) \u2208 A1 if a \u2208 A . The parenthesis may be omitted so (1); (2); (3) = 1; 2; 3 \u2208 R3 , for example. Let an = a; a; ...; a \u2208 An where a \u2208 A . We write a instead of an if n can be inferred from the context. We define Mn,m as the set of real n\u00d7m matrices. Matrices are represented as vectors of their row vectors, i.e.\u00a0Mn,m = (Rm)n . Let M\u22a4 \u2208 Mm,n be the transposition of M \u2208 Mn,m and let Im \u2208 Mm,m denote the m\u00d7m identity matrix. Further, it is convenient to define by Wn,k = {Ikj | j = 1, 2, . . . , k}n \u2282 Mn,k the set of matrices whose rows are all 0s, but exactly one is 1. Let Pn \u2282 Mn,n denote the set of permutation matrices. Let \ufffdM\ufffd1 = \u2211n i=1 \ufffdMi\ufffd1 denote the Manhattan norm of the matrix M \u2208 Mn,m.\nDefinition of Lk.\u2014We first give the definition of Lk . Let k \u2208 N+.\nNote that W is defined above in Notations and W\u22a4 denotes the transposed matrix of W. We prove below that Eq.\u00a0(39) corresponds to Eq.\u00a0(14) in the case of k = 2 . The proof is as follows\nProperties of Lk.\u2014We prove several interesting properties of Lk . Note that our focus in the main text is on k = 2 . However, the general case k \u2265 2 is of interest for its own sake. Moreover, it is also motivated physically, corresponding to classical communication beyond bits7,48. First we prove that Lk is a norm for any k \u2265 2 . To this end, we prove its homogeneity, positive definiteness and subadditivity properties.\nLemma 3.1 Lk is a norm.\nHomogeneity:\nwhere |t| denotes the absolute value of the scalar t and Lk is defined by (39). Positive definiteness:\n(39) Lk : Mn,m \u2192 R Lk(M) = max\nW\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225 1 .\nmax ax\u2208{\u00b11}\n\n\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\nx:ax=+1 Mx\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n1\n+\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\nx:ax=\u22121 Mx\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n\ufffd\n1\n\n\n= max W\u2208Wn,2\n\ufffd\ufffd\n\ufffd \ufffdW\u22a41 M \ufffd \ufffd \ufffd\n1 +\n\ufffd\n\ufffd \ufffdW\u22a42 M \ufffd \ufffd \ufffd\n1\n\ufffd\n= max W\u2208Wn,2\n\ufffd\n\ufffd \ufffd W\u22a4M\n\ufffd\n\ufffd\n\ufffd\n1\n= L2(M).\nLk(tM) = max W\u2208Wn,k\n\u2225\n\u2225 \u2225W\u22a4(tM) \u2225 \u2225 \u2225\n1\n= max W\u2208Wn,k\n|t| \u2225 \u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1\n= |t| max W\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225\n1\n= |t|Lk(M),\nLk(M) = 0 \u21d2 max\nW\u2208Wn,k\n\u2225\n\u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1 = 0\n\u21d2 \u2200W \u2208 Wn,k : \u2225 \u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1 = 0\n\u21d2 \u2200W \u2208 Wn,k : W\u22a4M = 0 \u21d2 \u2200i : Mi = 0 \u21d2 M = 0.\n9 Vol.:(0123456789) Scientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nTriangle inequality:\nLet us define L(M) as follows\nThe above definition is consistent with the one given in\u00a0(17). L(M) is the local or classical bound of correlation Bell inequalities24 defined by the correlation matrix M in\u00a0(40). The L(M) quantity also appears in computer science literature under the name of Km,n-quadratic programming49. Let us note that recently an efficient computation of L(M) has been proposed in Ref.35 along with the code50.\nFirst we prove the basic property that L2(M) \u2265 L(M) for any M. Next we prove that Lk(M) \u2264 Lk+1(M) for k \u2265 2 . Then we bound Lk(M) from above by the value of L(M) multiplied by k. However, we do not know whether the bound can be saturated or not. The lemma stating our first claim is as follows\nLemma 3.2\nwhere the proof is given as the following chain of equations plus a single inequality invoked in the fourth line\nOur next lemma proves that Lk(M) is monotone increasing with k.\nLemma 3.3\nThe proof is given below as the following chain:\nLk(M + N) = max W\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4(M + N)\n\u2225\n\u2225\n\u2225\n1\n\u2264 max W\u2208Wn,k\n(\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225 1 +\n\u2225\n\u2225 \u2225 W\u22a4N\n\u2225\n\u2225\n\u2225\n1\n)\n\u2264 max W\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225 1 + max\nW\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4N\n\u2225\n\u2225\n\u2225\n1\n= Lk(M)+ Lk(N).\n(40)L(M) = maxv\u2208{\u22121,+1}n \ufffdvM\ufffd1.\n(41)L(M) \u2264 L2(M),\nL(M) = max v\u2208{\u22121,+1}n \ufffdvM\ufffd1\n= max v\u2208{\u22121,+1}n\n\u2225\n\u2225\n\u2225\n\u2225\n1 2 (1+ v)M \u2212 1 2 (1\u2212 v)M\n\u2225\n\u2225\n\u2225\n\u2225\n1\n= max W\u2208Wn,2\n\u2225\n\u2225 \u2225W\u22a41 M \u2212W\u22a42 M \u2225 \u2225 \u2225\n1\n\u2264 max W\u2208Wn,2 (\n\u2225\n\u2225 \u2225W\u22a41 M \u2225 \u2225 \u2225\n1 +\n\u2225\n\u2225 \u2225W\u22a42 M \u2225 \u2225 \u2225\n1 )\n= max W\u2208Wn,2\n\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225\n1\n= L2(M).\n(42)Lk(M) \u2264 Lk+1(M).\nLk(M) = max W\u2208Wn,k\n\u2225\n\u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1\n= max W\u2208Wn,k\nk \u2211\ni=1\n\u2225\n\u2225\n\u2225\n( W\u22a4M )\ni\n\u2225\n\u2225\n\u2225\n1\n= max W\u2208Wn,k\n(\nk \u2211\ni=1\n\u2225\n\u2225\n\u2225\n( W\u22a4M )\ni\n\u2225\n\u2225\n\u2225 1 +\n\u2225 \u22250M \u2225 \u2225\n1\n)\n= max W\u2208Wn,k\nk+1 \u2211\ni=1\n\u2225\n\u2225\n\u2225\n(( W\u22a4; 0 ) M )\ni\n\u2225\n\u2225\n\u2225\n1\n= max W\u2208Wn,k\n\u2225\n\u2225\n\u2225\n( W\u22a4; 0 ) M \u2225 \u2225\n\u2225\n1\n\u2264 max W\u2208Wk+1,n\n\u2225\n\u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1\n= Lk+1(M).\n10\nVol:.(1234567890)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nFinally, we prove an upper bound on Lk(M) . Our lemma reads as follows\nLemma 3.4"
        },
        {
            "heading": "Proof",
            "text": "To arrive at the sixth line, we invoked the definition\u00a0(40).\nIt is an open question whether Lemma\u00a03.4 is tight or not. However, we can find a family of matrices M(k) , k \u2265 2 such that the ratio Lk(M(k))/L(M(k)) tends to infinity with increasing k. More formally we have\nLemma 3.5 For all \u03b5 > 0 there exists a matrix M and k > 1 such that\nThe proof is based on an explicit construction of matrices Mk , k = (2, . . . ,\u221e) defined in Ref.51. See also Refs.52,53.\nProof Let Mk \u2208 Mk,2k\u22121 , k = (1, 2, . . . ,\u221e) be a family of matrices such that51\nFor example,\nNow by explicit calculations we find\n(43)Lk(M) \u2264 kL(M)\nLk(M) = max W\u2208Wn,k\n\u2225\n\u2225 \u2225W\u22a4M \u2225 \u2225 \u2225\n1\n= max W\u2208Wn,k\nk \u2211\ni=1\n\u2225\n\u2225 \u2225(W\u22a4M)i \u2225 \u2225 \u2225\n1\n= max W\u2208Wn,k\nk \u2211\ni=1\n\u2225\n\u2225 \u2225W\u22a4i M \u2225 \u2225 \u2225\n1\n= max W\u2208Wn,k\nk \u2211\ni=1\n1\n2\n\u2225\n\u2225\n\u2225\n( 2W\u22a4i \u2212 1 ) M + 1M \u2225 \u2225 \u2225\n1\n\u2264 max W\u2208Wn,k\nk \u2211\ni=1\n1\n2\n(\u2225\n\u2225 \u2225(2W\u22a4i \u2212 1)M \u2225 \u2225 \u2225\n1 +\n\u2225 \u22251M \u2225 \u2225\n1\n)\n\u2264 max W\u2208Wn,k\nk \u2211\ni=1\n1 2 (L(M)+ L(M))\n= max W\u2208Wn,k\nk \u2211\ni=1 L(M)\n= max W\u2208Wn,k kL(M)\n= kL(M).\n(44) L(M)\nLk(M) < \u03b5.\n(45)Mki,j = (\u22121) \u230a j 2k\u2212i\u22121 \u230b .\n(46)M4 =\n\n\n 1 1 1 1 1 1 1 1 1 1 1 1 \u2212 1 \u2212 1 \u2212 1 \u2212 1 1 1 \u2212 1 \u2212 1 1 1 \u2212 1 \u2212 1 1 \u2212 1 1 \u2212 1 1 \u2212 1 1 \u2212 1\n\n  .\n(47)L(Mk) Lk(Mk)\n= k\n( k \u2212 1 \u230a k\u221212 \u230b )\nk2k\u22121 \u223c\n\u221a\n2\n\u03c0k .\n11\nVol.:(0123456789)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nNote that in the particular case of k = 2 the matrix M(k) is the CHSH expression40, in which case L(M(2)) = 2 and L2(M(2)) = 4 . Hence, for k = 2 the upper bound in Lemma\u00a03.4 is tight. We conjecture that the bound is not tight for greater values of k.\nFinally, we show how L2 and in general Lk behaves with the concatenation (A;\u00a0B) of two matrices A and B, where we defined\nLemma 3.6 Let A \u2208 Mi,m, B \u2208 Mj,m . Then we have"
        },
        {
            "heading": "Proof",
            "text": "Note that Lk(A) \u2264 Lk(A;B) does not hold in general. For example, let us have\nand\nThen by explicit calculation we obtain\nFinally, it is shown that Lk relates to the cut norm C, a matrix norm introduced by Frieze and Kannan in Ref.54 (see also55 for several applications in graph theory). This norm is defined as follows:\nwhere the maximum is taken over all ax , by \u2208 {0, 1} . Note the similarity in the definition with the L(M) norm\u00a0(17) which is equivalent to (40). It has been shown that C(M) is related to L(M) as follows54,56:\nUsing the above relation\u00a0(54) along with Lemma\u00a03.4, we find that\nand for the special case of L2 we have the following lower and upper bounds:\nGeneralization of the Lk norm: Below we generalize the norm Lk(M) to FM , which extension will prove to be a key property in the Branch-and-Bound31 implementation of the Lk algorithm. To do so, first we define the following function\nDefinition 3.7\n(48)(A;B) = [\nA B\n]\n.\n(49)Lk(A;B) \u2264 Lk(A)+ Lk(B).\nLk(A;B) = max W\u2208Wi+j,k\n\u2225\n\u2225 \u2225W\u22a4(A;B) \u2225 \u2225 \u2225\n1\n= max S\u2208Wi,k max T\u2208Wj,k\n\u2225\n\u2225 \u2225(S;T)\u22a4(A;B) \u2225 \u2225 \u2225\n1\n= max S\u2208Wi,k max T\u2208Wj,k\n\u2225\n\u2225 \u2225S\u22a4A+ T\u22a4B \u2225 \u2225 \u2225\n1\n\u2264 max S\u2208Wi,k max T\u2208Wj,k\n(\u2225\n\u2225 \u2225S\u22a4A \u2225 \u2225 \u2225\n1 +\n\u2225\n\u2225 \u2225T\u22a4B \u2225 \u2225 \u2225\n1\n)\n\u2264 max S\u2208Wi,k\n\u2225\n\u2225 \u2225 S\u22a4A\n\u2225\n\u2225\n\u2225 1 + max\nT\u2208Wj,k\n\u2225\n\u2225 \u2225 T\u22a4B\n\u2225\n\u2225\n\u2225\n1\n= Lk(A)+ Lk(B).\n(50)A = (\n1 1 1 \u2212 1\n)\n(51)B = (\u22121 0 ).\n(52)4=L2(A) > L2(A;B)=3.\n(53)C(M) = max n \u2211\nx=1\nm \u2211\ny=1 Mx,yaxby ,\n(54)C(M) \u2264 L(M) \u2264 4C(M).\n(55)C(M) \u2264 Lk(M) \u2264 4kC(M),\n(56)C(M) \u2264 L2(M) \u2264 8C(M).\n12\nVol:.(1234567890)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nwhere \u00a0 i = (0, 1, 2, . . . , n)\u00a0 and\u00a0 M \u2208 Mn,m.\nIn other words, FM(P) is the maximum of \u2225 \u2225W\u22a4M \u2225 \u2225 1 where W \u2208 Wk,n and the prefix of W is P. FM can be considered as a generalization of Lk(M) . The following lemma introduces a key property which is made use of in the Branch-and-Bound method.\nLemma 3.8"
        },
        {
            "heading": "Proof",
            "text": "Let us now give the following definition further generalizing FM(P):\nDefinition 3.9\nThe computation of fM can be optimized such that for big enough c values fM(P)(c) returns c without computing FM(P) . This is expressed by the following lemma.\nLemma 3.10\nThe proof given below is split into three cases. Case 1: If P \u2208 Wn,k , then\nCase 2:\nCase 3:\n(57) FM : Wi,k \u2192 R FM(P) = max\nW\u2208Wn\u2212i,k\n\u2225\n\u2225 \u2225 (P;W)\u22a4M\n\u2225\n\u2225\n\u2225\n1\n(58)FA;B(P) \u2264 \u2225 \u2225 \u2225 P\u22a4M \u2225 \u2225 \u2225\n1 + Lk(B)\nFA;B(P) = max W\u2208Wn\u2212i,k\n\u2225\n\u2225 \u2225(P;W)\u22a4(A;B) \u2225 \u2225 \u2225\n1\n= max W\u2208Wn\u2212i,k\n\u2225\n\u2225 \u2225(P\u22a4A+W\u22a4B) \u2225 \u2225 \u2225\n1\n\u2264 max W\u2208Wn\u2212i,k\n(\u2225\n\u2225 \u2225P\u22a4A \u2225 \u2225 \u2225\n1 +\n\u2225\n\u2225 \u2225W\u22a4B \u2225 \u2225 \u2225\n1\n)\n= \u2225 \u2225 \u2225P\u22a4A \u2225 \u2225 \u2225\n1 + max\nW\u2208Wn\u2212i,k\n\u2225\n\u2225 \u2225W\u22a4B \u2225 \u2225 \u2225\n1\n= \u2225 \u2225 \u2225 P\u22a4A \u2225 \u2225 \u2225\n1 + Lk(B).\n(59)fM(P)(c) = max(FM(P), c)\n(60)fM(P)(c) =\n\n\n\nmax \ufffd\ufffd \ufffdP\u22a4M \ufffd \ufffd 1 , c \ufffd if P \u2208 Wn,k , c if \ufffd \ufffdP\u22a4A \ufffd \ufffd\n1 + Lk(B) \u2264 c, A;B = M,\n(fM(P; Ik0) \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 fM(P; Ikk))(c) otherwise\nfM(P)(c) = max (\nmax W\u2208Wn\u2212n,k\n\u2225\n\u2225 \u2225(P;W)\u22a4M \u2225 \u2225 \u2225\n1 , c\n)\nby (57) and (59)\n= max (\u2225 \u2225 \u2225(P; ())\u22a4M \u2225 \u2225 \u2225 1 , c ) = max (\u2225 \u2225 \u2225 P \u22a4 M \u2225 \u2225 \u2225\n1 , c ) .\n\u2225\n\u2225 \u2225 P\u22a4A\n\u2225\n\u2225\n\u2225 1 + Lk(B) \u2264 c\n\u21d2 FM(P) \u2264 c by (58) \u21d2 max(FM(P), c) = c \u21d2 fM(P)(c) = c by (59)\n13\nVol.:(0123456789)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nOur last lemma in this subsection reads\nLemma 3.11\nand it can be proved as follows:\nProgramming tips for the efficient implementation of the L 2 and L k codes. In this subsection, we give programming tips for the branch-and-bound31 implementation of the exact computation of Lk(M) for any k \u2265 2 . For k = 2 and k = 3 our algorithms are even faster than the Lk solver for general k due to specialization which we detail below. First, we remind the reader of the notation defined in Section\u00a0\"Properties of the L2 and Lk, k>2 norm\". The Haskell code can be downloaded from Github57. Instructions installing and using the code (including parallel execution and using guessed results) can also be found there.\nBranch-and-bound calculation of Lk : The norm Lk(M) for k \u2265 2 can be calculated using the following definition and the following lemma.\nDefinition 3.12 For all M \u2208 Mn,m, 0 \u2264 i \u2264 n let\nThe function fM recursively calls itself with larger and larger P prefixes until the prefix size reaches n. The middle case is a conditional exit from the recursion, which speeds up the computation crucially.\nLemma 3.13\nReducing cost by sharing sub-calculations.\u2014In the definition\u00a03.12, the most expensive calculations are Lk(B) , \u2225 \u2225P\u22a4M \u2225 \u2225\n1 and\n\u2225 \u2225P\u22a4A \u2225 \u2225\n1 . We show how to reduce the cost of these calculations. The cost of Lk(B) can be reduced\nby memoizing the previously computed Lk values in a table. If M = (v1; v2; v3; . . . ; vn) then Lk(M) depends on Lk(vi; vi+1; . . . ; vn) , where i = 2, 3, 4, . . . , n . Note that Lk(vi; vi+1; . . . ; vn) itself depends on Lk(vj; vj+1; . . . ; vn) , where j = i + 1, i + 2, . . . , n . If we take into account all dependencies, the correct order of calculating Lk values is Lk(vn) , Lk(vn\u22121, vn) , Lk(vn\u22122, vn\u22121, vn) , ..., Lk(v2, v3, . . . , vn).\nThere is an option to skip the \u2225 \u2225P\u22a4A \u2225 \u2225 1 + Lk(B) \u2264 c test for large B matrices. This means that Lk(B) should not be calculated, and the trade-off is that we miss opportunities for exiting recursion. In our experience, skipping the test for B \u2208 Mk,m, k \u2265 (3n/4) results in about 2\u00d7 speedup.\nThe cost of calculating \u2225 \u2225P\u22a4A \u2225 \u2225 1 is O(km) if A \u2208 Mk,m . Note that\nfM(P)(c) = max (\nmax W\u2208Wn\u2212i,k\n\u2225\n\u2225 \u2225 (P;W)\u22a4M\n\u2225\n\u2225\n\u2225 1 , c\n)\nby (57, 59)\n= max (\nmax S\u2208W1,k ,W\u2208Wn\u2212i\u22121,k\n\u2225\n\u2225 \u2225 (P; S;W)\u22a4M\n\u2225\n\u2225\n\u2225 1 , c\n)\n= max (\nmax j max W\u2208Wn\u2212i\u22121,k\n\u2225\n\u2225 \u2225 (P; Ikj ;W)\u22a4M\n\u2225\n\u2225\n\u2225 1 , c\n)\n= max(max j FM(P; Ikj ), c)\n= max(FM(P; Ik0), max(FM(P; Ik1), max(..., c))) = (fM(P; Ik0) \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 fM(P; Ikk))(c).\n(61)Lk(M) = fM(())(0)\nfM(())(0)\n= max (\nmax W\u2208Wn,k\n\u2225\n\u2225 \u2225(();W)\u22a4M \u2225 \u2225 \u2225\n1 , 0\n)\nby (57, 59)\n= max W\u2208Wn,k\n\u2225\n\u2225 \u2225 W\u22a4M\n\u2225\n\u2225\n\u2225\n1\n= Lk(M)\n(62)\nfM : Wi,k \u2192 (R \u2192 R)\nfM(P)(c) =\n\n\n\nmax( \ufffd \ufffdP\u22a4M \ufffd \ufffd 1 , c) if P \u2208 Wn,k , c if \ufffd \ufffdP\u22a4A \ufffd \ufffd\n1 + Lk(B) \u2264 c, A;B = M,\n(fM(P; Ik0) \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 fM(P; Ikk))(c) otherwise.\n(63)Lk(M) = fM(())(0).\n(64)(P;Q)\u22a4(A;B) = P\u22a4A+ Q\u22a4B.\n14\nVol:.(1234567890)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nP\u22a4A is already computed by the time when (P; Iki )\u22a4(A; v) is needed, so the cost of \u2225 \u2225P\u22a4A \u2225 \u2225 1 can be reduced to O(m) by (64). The cost of P\u22a4M can be reduced in the same way. This implies a considerable speedup; for example, for M \u2208 M70,70 the calculation of L2(M) can be made nearly 70 times faster by this optimization.\nThe cost of \u2225 \u2225P\u22a4A \u2225 \u2225\n1 can be further reduced by caching the previously calculated Manhattan norms of the\nrows of the matrix P\u22a4A. Reducing cost by symmetries.\u2014For all S \u2208 Pk permutation matrices\nThe cost of L2 can be halved by (65) as follows. Let\nFrom \u2225 \u2225(I22;W)\u22a4M \u2225 \u2225 1 = \u2225 \u2225(I21;WS)\u22a4M \u2225 \u2225 1 it follows that fM(I22, c) = fM(I21, c) . This means that we can skip the calculation of fM(I22, c) for all c, thus L2(M) = fM((I21), 0) , i.e., we start the calculation with a non-empty prefix which saves work.\nHarnessing (65) in the general Lk case is a bit more complex. First we define the set of canonical prefixes. A prefix P = Iki1 ; Iki2 ; . . . Ikij is canonical if the first occurrences of the numbers in the indices i1, i2, . . . , ij is the sequence 1, 2, 3, . . . . For example, the prefix Ik1; Ik2; Ik1; Ik3 is canonical but Ik1; Ik3; Ik1; Ik2 is non-canonical. For each prefix P, there exists a permutation S such that PS is canonical, so that, fM(P, c) = fM(PS, c) , which means that it is enough to examine only the canonical prefixes to compute Lk.\nParallel and concurrent execution.\u2014For parallel execution one can use the following equation:\nWe used Eq.\u00a0(66) for P \u2208 Wi,k , i < d , where d is a \u201cparallel depth\u201d for fine-tuning the execution for different architectures. Higher depth is better for more cores.\nParallel execution may miss opportunities of exiting recursion because there is no communication between threads about the best known Lk values at a certain point of time. Therefore we implemented concurrent execution where threads share the best known Lk values.\nReducing cost by guessed Lk values.\u2014Optionally, the computation can be sped up by providing a guessed Lk(M) value by the user. This value will be used instead of 0 in Eq.\u00a0(63). The guessed value may be lower than Lk(M) . Higher guessed values are better, unless the guessed value is higher than Lk(M) , in which case fM returns the guessed value. We compared the result of fM with the witness W of the maximal \u2225 \u2225W\u22a4M \u2225 \u2225\n1 value, to be able to\ndetect whether the guessed value was too high or not.\nL\u2011norm and L 2 \u2011norm are the same for a special family of matrices M\u2032. We relate L(M \u2032) to L2(M \u2032) , where M \u2032 is given by the following matrix\nwhere M is a matrix of size n\u00d7m with arbitrary real entries. Note that M \u2032 has size 2n\u00d7m and M \u2032 has rows such that M \u2032x = Mx and M \u2032x+m = \u2212Mx for all x = 1, . . . ,m . Then the following lemma holds.\nLemma 3.14 L2(M \u2032) = L(M \u2032) = 2L(M) for any matrix M \u2032 of the form (67), where L2 is the L2 norm given by the definition\u00a0(14) and L is the local bound given by\u00a0(40). Note that Lk is defined by\u00a0(39), where the case k = 2 corresponds to the definition of L2 in (14).\nProof We fix a matrix M of dimension n\u00d7m which specifies M \u2032 by the virtue of (67). Let ax \u2208 {\u22121, 1} , x = 1, . . . , n and by \u2208 {\u22121, 1} , y = 1, . . . ,m be the optimal vectors giving L(M) in (40). Note that these values are not unique in general, different optimal configurations may exist, however, we choose one such optimal vectors ax and by . We then choose ax+n = \u2212ax for x = 1, . . . , n , and b+y = b\u2212y = by for y = 1, . . . ,m . With these values, we obtain the lower bound L2(M \u2032) \u2265 2L(M) on L2(M \u2032) in (12). Now we show the upper bound L2(M \u2032) \u2264 2L(M) , which implies L2(M \u2032) = 2L(M).\nAs a contradiction of the lemma, assume that L2(M \u2032) > 2L(M) . Then, not all ax vectors corresponding to the L2(M \u2032) value have the property ax+m = \u2212ax for each x. That is, there exists at least one x, call it x\u2032 , for which a\u2032x = ax\u2032+n . Suppose that there is one such an x\u2032 (the proof for multiple x\u2032 indices for which a\u2032x = ax\u2032+n is very similar). Then in the formula\u00a0(14) for L2(M \u2032) the two rows x\u2032 and x\u2032 + n in question will appear within the same norm (either in the first or second norm, depending on whether a\u2032x = ax\u2032+n takes the value +1 or \u22121 ). However, in both cases they cancel each other from the norm in question. As a result, two rows of M \u2032 in (67) are eliminated, one from the matrix M and one from the matrix \u2212M . However, any matrix \u00b1M from which one row has been eliminated cannot have a local bound greater than L(M). The same applies to a matrix \u00b1M from which we have removed several rows. Therefore, L2(M \u2032) > 2L(M) cannot be true either. Thus we arrived at a contradiction.\n(65) \u2225 \u2225 \u2225 W\u22a4M \u2225 \u2225 \u2225\n1 =\n\u2225\n\u2225 \u2225 (WS)\u22a4M\n\u2225\n\u2225\n\u2225 1 .\nS = (\n0 1 1 0\n)\n\u2208 P2.\n(66)fM(P)(c) = max i\u2208{1,...,k} fM(P; Iki )(c) .\n(67)M \u2032 = (\nM \u2212 M\n)\n,\n15\nVol.:(0123456789)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nAdapting the Gisin\u2011Gisin model to the PM scenario. We now adapt the LHV model of Ref.27 which exploits the finite efficiency of the detectors to reproduce the quantum correlations of the singlet state exactly. We show that the LHV model in Ref.27 can be adapted to the PM communication scenario to produce the expectation value:\nwhere \ufffda \u2208 S2 denotes the preparation Bloch vector and \ufffdb \u2208 S2 denotes the measurement Bloch vector. First we show that the outcomes b = \u00b11 giving the expectation value\ncan be obtained with probability 1/2 and b = 0 outcome with probability 1/2. Then by coarse-graining the above distribution by grouping b = 0 outcome with b = +1 , we obtain the expectation value\u00a0(68).\nThe classical model, using one bit of classical communication from Alice to Bob, is as follows. Protocol: Alice and Bob share a classical variable, which is in the form of a unit vector , chosen uniformly\nat random from the unit sphere S2.\n\u2022 Alice: Alice sends a binary message c = sgn(\ufffda \u00b7 \ufffd ) to Bob. That is, c = +1 if \ufffda \u00b7 \ufffd \u2264 0 and c = \u22121 if \ufffda \u00b7 \ufffd > 0. \u2022 Bob: Bob outputs b = sgn(c\ufffdb \u00b7 \ufffd ) with probability |\ufffdb \u00b7 \ufffd | (corresponding to the detection event b = \u00b11 ) and\nBob outputs b = 0 with probability 1\u2212 |\ufffdb \u00b7 \ufffd | (corresponding to the non-detection event).\nOur claim is as follows. The above protocol yields the correlations E(\ufffda, \ufffdb) = \ufffda \u00b7 \ufffdb , that is, it reproduces the correlations in Eq.\u00a0(69) with probability 1/2 and returns b = 0 in the other cases.\nProof.\u2014We need to calculate the expectation value E(\ufffda, \ufffdb) = P(b = +1|\ufffda, \ufffdb)\u2212 P(b = \u22121|\ufffda, \ufffdb) which according to the above protocol in the detection events b = \u00b11 is given by27\nwhere q(\ufffd |b = \u00b11) is the conditional density probability distribution of choosing given a detection event (either output b = +1 or b = \u22121 ). This function can be calculated from\nwhere the detection efficiency is \u03b7 = p(b = \u00b11) and the probability of detection failure is 1\u2212 \u03b7 = p(b = 0) . The value of \u03b7 is given by\nas stated and the protocol gives the density probability distribution q( and b = \u00b11) = (\ufffdb \u00b7 \ufffd )/(4\u03c0) . Inserting these values into (71) gives q( |b = \u00b11) = (\ufffdb \u00b7 \ufffd )/(2\u03c0) , which in turn is inserted into (70) to obtain the integral27:\nThe above integral can be calculated using spherical symmetries. In particular, one can choose w.l.o.g. the vectors\nas in Ref.27, and then obtain\nwith probability 1/2, which we wanted to prove.\nThe modified Gilbert algorithm adapted to the PM scenario. For a given \u03b7 \u2208 [1/2, 1] and correlation matrix E(\u03b7) defined by (28), the algorithm yields the following matrix M satisfying\n(68)E(\ufffda, \ufffdb) = P(b = +1|\ufffda, \ufffdb)\u2212 P(b = \u22121|\ufffda, \ufffdb) = \ufffda \u00b7 \ufffdb+ 1 2 ,\n(69)E(\ufffda, \ufffdb) = P(b = +1|\ufffda, \ufffdb)\u2212 P(b = \u22121|\ufffda, \ufffdb) = \ufffda \u00b7 \ufffdb\n(70)E(\ufffda, \ufffdb) = \u222b\nS2 d\ufffd q(\ufffd |b = \u00b11)sgn(\ufffda \u00b7 \ufffd )sgn(\ufffdb \u00b7 \ufffd ),\n(71)q(\ufffd |b = \u00b11) = q( \ufffd and b = \u00b11) p(b = \u00b11) ,\n(72)\u03b7 = p(b = \u00b11) = \u222b\nS2\nd\ufffd 4\u03c0 |\ufffdb \u00b7 | = 1 2 ,\n(73)E(\ufffda, \ufffdb) = 1\n2\u03c0\n\u222b\nS2 d\ufffd (\ufffdb \u00b7 \ufffd )sgn(\ufffda \u00b7 \ufffd ).\n\ufffda = (0, 0, 1) \ufffdb = (sin \u03b1, 0, cos\u03b1)\n(74)E(\ufffda, \ufffdb) = cos\u03b1 = \ufffda \u00b7 \ufffdb\n(75) n \u2211 x=1 m \u2211 y=1 MxyExy(\u03b7) > L2(M).\n16\nVol:.(1234567890)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0"
        },
        {
            "heading": "Algorithm:",
            "text": "Input: The number of preparations n and the number of measurement settings m that define the setup. The unit vectors {\ufffdax}nx=1 (i.e., the Bloch vectors of Alice\u2019s prepared states) and { \ufffdby}my=1 (i.e., the Bloch vectors of Bob\u2019s projective rank-1 measurements). The (n\u00d7m)-dimensional matrix E(\u03b7) given by the entries Exy(\u03b7) in (28). The values of \u01eb and imax that define the stopping criteria.\nOutput: The matrix M of size n\u00d7m .\n1. Set i = 0 and set E(i) the n\u00d7m zero matrix. 2. Given a matrix E(i) and the matrix E(\u03b7) , run a heuristic oracle that maximizes the overlap\n\u2211 xy(Exy(\u03b7)\u2212 E (i) xy )E det xy over all deterministic one-bit correlations Edetxy in (11). The description of this heuristic (see-saw) oracle is given in Section\u00a0\"Lower bound to L2(M) using the see-saw iterative algorithm\". Denote the point Edetxy returned by the oracle by Edet,ixy .\n3. Find the convex combination E(i+1) of E(i) and Edet,ixy that minimizes the distance \u221a \u2211 xy ( Exy(\u03b7)\u2212 E(i)xy )2 .\nLet us denote this distance by dist(i). 4. Let i = i + 1 and go to Step 2 until dist(i) \u2264 \u01eb or i = imax. 5. Return the matrix M with coordinates Mxy = Exy(\u03b7)\u2212 E(i)xy.\nNote that dist(i) is a decreasing function of i. Since maximizing the overlap of \u2211 xy(Exy(\u03b7)\u2212 E (i) xy )E det xy over all deterministic one-bit correlations vectors is an NP-hard problem, in Step 2 we use a heuristic method to do it, which we describe in Section\u00a0\"Lower bound to L2(M) using the see-saw iterative algorithm\". On the other hand, the description of an exact branch-and-bound type algorithm can be found in Section\u00a0\"Programming tips for the efficient implementation of the L2 and Lk codes\". We use the exact method, which is generally more timeconsuming than the see-saw method to check that the output matrix M satisfies the condition\u00a0(75) with the chosen parameter \u03b7 . If this is true, then it implies the lower bound KD \u2265 (1/\u03b7) , as proved in Section\u00a0\"Proof of the bounds 1.5682\u2264KD\u22642\". It should also be noted that the branch-and-bound-type algorithm is much faster than the brute force algorithm (the implemented algorithm using parallelism can be found in57). On a multicore desktop computer, it can solve problems in range n = m = 70 in a day, while the brute force algorithm is limited to about n = m = 40 settings.\nParameters and implementation of Gilbert algorithm. Here we specify the explicit parameters that are used to obtain the lower bound KD \u2264 1.5682 . On the three-dimensional unit sphere, we choose the vectors {\ufffdax}nx=1 and {\ufffdby}my=1 to be equal to each other, \ufffdvi = \ufffdai = \ufffdbi for i = 1, . . . , n , where n = m = 70 . The 70 unit vectors chosen define the optimal packing configuration in the Grassmannian space which can be downloaded from Neil Sloane\u2019s database58. The advantage of this type of packing is that the points and their antipodal points are located as far apart as possible on the three-dimensional unit sphere.\nWe implemented the modified Gilbert algorithm (of Section\u00a0\"The modified Gilbert algorithm adapted to the PM scenario\") in Matlab with and without a memory buffer (see more details on the memory buffer in Ref.39). In the case of using memory buffer, the step 3 is modified in the algorithm so that instead of calculating the convex combination of the points E(i) and Edet,ixy (see section\u00a0\"The modified Gilbert algorithm adapted to the PM scenario\"), we compute the convex combination of E(i) and the points Edet,i-jxy , j = 0, . . . ,m\u2212 1 , where m is the size of the memory buffer. In our explicit computations, we use a buffer size m = 40 and a stopping condition of k = 2\u00d7 105 with \u03b7 = 0.665 . Details on the performance of this modification can be found in Ref.39. In step 2 of the Gilbert algorithm, the oracle uses the see-saw heuristic described in Section\u00a0\"Lower bound to L2(M) using the see-saw iterative algorithm\" to obtain a good (typically tight) lower bound to L2(M) . On the other hand, we used the branch-and-bound-type algorithm described in Section\u00a0\"Programming tips for the efficient implementation of the L2 and Lk codes\" to calculate L2(M) exactly for integer M. The algorithm was implemented in Haskell. See the GitHub site57 for the downloadable version.\nThe Matlab file eta_70.m, which can also be downloaded from GitHub57 (located in the subdirectory L2_eta_70) gives detailed results on the input parameters. In particular, it gives the unit vectors \ufffdai = \ufffdbi = \ufffdvi , the lower bound \u2211\nxy Mxy\ufffdax \u00b7 \ufffdby = \u2211 xy Mxy\ufffdvx \u00b7 \ufffdvy to q(M) and the value L2(M) . The input matrix M is placed in subdirectory L2_eta_70 under the name W70i.txt. The running time of the Gilbert algorithm (in Section\u00a0\"The modified Gilbert algorithm adapted to the PM scenario\") implemented in Matlab was about one week. Note, however, that most of the computation time was spent on the oracle (the see-saw part) described in Section\u00a0\"Lower bound to L2(M) using the see-saw iterative algorithm\". On the other hand, the Haskell code to compute the exact L2(M) value of the 70\u00d7 70 witness matrix M took about 8 hours to run on a HP Z8 workstation using 56 physical cores. The memory usage of the computation was negligible.\nThe Matlab eta_70.m routine defines the 70\u00d7 70 matrix M, and gives the \ufffdvi := \ufffdai = \ufffdbi the unit vectors from Sloane\u2019s database58 for all i = 1, . . . , 70 . Note that M is integer (by multiplying the output M matrix in the Gilbert algorithm by 1000 and truncating the non-integer part). This calculation yields S(M) = \u2211x,y Mx,y = 194369 and Q(M) = \u2211x,y Mx,y\ufffdax \u00b7 \ufffdby \u2243 5.3672235\u00d7 105 . On the other hand, the branch-and-bound-type Haskell code57 gives the exact value L2(M) = 412667 , which is matched by the see-saw search (in Section\u00a0\"Lower bound to L2(M) using the see-saw iterative algorithm\"). From these numbers we then obtain\n17\nVol.:(0123456789)\nScientific Reports | (2023) 13:13200 | https://doi.org/10.1038/s41598-023-39529-0\nand 1/KD = 0.6377\u2212 \u03b5\u2032 is the upper bound to the critical detection efficiency \u03b7crit , where \u03b5 and \u03b5\u2032 are small positive numbers.\nLower bound to L 2 (M) using the see\u2011saw iterative algorithm. Below we give an iterative algorithm based on see-saw heuristics to compute L2(M) . This algorithm forms the oracle part of step 2 of the Gilbert algorithm, which is described in Section\u00a0\"The modified Gilbert algorithm adapted to the PM scenario\".\nAlgorithm: Input: Integer matrix M of size n\u00d7m. Output: Lower bound l2(M) to L2(M) defined by formula\u00a0(12).\n1. Let l2 = 0. 2. Choose random assignments ax = \u00b11 : That is, ax are (random) elements of a vector a of size n. Its elements\nare binary having value +1 or -1 only. 3. Set b+ = sgn(aM),\u00a0where sgn denotes the (modified) sign function: sgn(x) = +1 if x \u2265 0 and \u22121 otherwise.\nLet us transpose b+. 4. Set b\u2212 = sgn(aM) . Let us transpose b\u2212. 5. Form the column vector s+ = Mb+ of size n. 6. Form the column vector s\u2212 = Mb\u2212 of size n. 7. Form the column vector s = max(s+, s\u2212) of size n. That is, sx = max(s+x , s\u2212x ) for all x = 1, . . . , n. 8. Form the \u00b11-valued column vector a as follows: Let ax = +1 if s+x \u2265 s\u2212x , otherwise let ax = \u22121 for all\nx = 1, . . . , n. 9. Let l2 = \u2211n x=1 sx.\n10. With the new vector a, return to point 3. Repeat the algorithm until two values of l2 are equal in two consecutive iterations.\nNote that at each iteration step, objective value l2(M) is guaranteed not to decrease. Therefore, the output of the algorithm is a heuristic lower bound on the exact value of L2(M)."
        },
        {
            "heading": "Discussion",
            "text": "We have tested the quantumness of two-dimensional systems in the prepare-and-measure (PM) scenario, with n preparations and m binary-outcome measurement settings, where n and m fall well into the range of 70. In the one-qubit PM scenario, a two-level system is transmitted from the sender to the receiver. In this setup, a real n\u00d7m matrix M defines the coefficients of a linear witness. We denote by L2(M) the exact value of the one-bit bound associated with matrix M. We found efficient numerical algorithms for computing L2(M) . If this bound is exceeded, we can detect both the quantumness of the prepared qubits and the quantumness (i.e. incompatibility) of the measurements.\nWe introduced new constants KM and K D which are related to the Grothendieck constant of order 3. Our large-scale tools are crucial for the efficient bounding of L2(M) and hence for bounding of the constants KM and K D . We further relate these new constants to the white noise resistance of the prepared qubits and the critical detection efficiency of the measurements performed.\nFor large M matrices, we have given two algorithms for computing L2(M) : a simple iterative see-saw-type algorithm and a branch-and-bound-type algorithm. The former is a heuristic algorithm that usually gives a tight lower bound on L2(M) . However, sometimes it fails to find the exact value of L2(M) . This happens more and more often as the size of the matrix M gets larger and larger. In contrast, the latter branch-and-bound-type algorithm gives the exact value of L2(M) and can be used to compute L2(M) for matrix sizes as large as 70\u00d7 70 . As an application of the algorithms, we established the bounds 1.5682 \u2264 K D \u2264 2 on the new constant and an upper bound of \u03b7crit \u2264 0.6377 on the critical detection efficiency of qubit measurements in the PM scenario."
        },
        {
            "heading": "Data availability",
            "text": "The dataset (the 70\u00d7 70 matrix M) used to prove the lower bound (22) on KD is available in Github57."
        },
        {
            "heading": "Code availability",
            "text": "The Haskell and MATLAB codes used to prove the lower bound (22) on KD is available in Github57.\nReceived: 6 November 2022; Accepted: 26 July 2023"
        },
        {
            "heading": "Acknowledgements",
            "text": "We thank M\u00e1ty\u00e1s Barczy, Emmanuel Zambrini Cruzeiro and Armin Tavakoli for valuable discussions. We are particularly indebted to M\u00e1ty\u00e1s Barczy for pointers to the literature regarding the cut norm. T. V. acknowledges the support of the EU (QuantERA eDICT) and the National Research, Development and Innovation Office NKFIH (No. 2019-2.1.7-ERA-NET-2020-00003)."
        },
        {
            "heading": "Author contributions",
            "text": "All authors contributed equally to this work."
        },
        {
            "heading": "Funding",
            "text": "Open access funding provided by ELKH Institute for Nuclear Research."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Correspondence and requests for materials should be addressed to T.V.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2023"
        }
    ],
    "title": "Certification of qubits in the prepare-and-measure scenario with large input alphabet and connections with the Grothendieck constant",
    "year": 2023
}