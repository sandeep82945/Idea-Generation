{
    "abstractText": "Driven by the critical needs of biomanufacturing 4.0, we introduce a probabilistic knowledge graph hybrid model characterizing the riskand science-based understanding of bioprocess mechanisms. It can faithfully capture the important properties, including nonlinear reactions, partially observed state, and nonstationary dynamics. Given very limited real process observations, we derive a posterior distribution quantifying model estimation uncertainty. To avoid the evaluation of intractable likelihoods, Approximate Bayesian Computation sampling with Sequential Monte Carlo (ABCSMC) is utilized to approximate the posterior distribution. Under high stochastic and model uncertainties, it is computationally expensive to match output trajectories. Therefore, we create a linear Gaussian dynamic Bayesian network (LG-DBN) auxiliary likelihood-based ABC-SMC approach. Through matching the summary statistics driven through LG-DBN likelihood that can capture critical interactions and variations, the proposed algorithm can accelerate hybrid model inference, support latent state monitoring, and facilitate mechanism learning and robust control.",
    "authors": [
        {
            "affiliations": [],
            "name": "Wei Xie"
        },
        {
            "affiliations": [],
            "name": "Keqi Wang"
        },
        {
            "affiliations": [],
            "name": "Hua Zheng"
        },
        {
            "affiliations": [],
            "name": "Ben Feng"
        }
    ],
    "id": "SP:254456b985d33d272ff84133f0bf4630534cff46",
    "references": [
        {
            "authors": [
                "Linas Mockus",
                "John J Peterson",
                "Jose Miguel Lainez",
                "Gintaras V Reklaitis"
            ],
            "title": "Batch-to-batch variation: A key component for modeling chemical manufacturing processes",
            "venue": "Organic Process Research & Development,",
            "year": 2015
        },
        {
            "authors": [
                "Wei Xie",
                "Bo Wang",
                "Cheng Li",
                "Dongming Xie",
                "Jared Auclair"
            ],
            "title": "Interpretable biomanufacturing process risk and sensitivity analyses for quality-by-design and stability control",
            "venue": "Naval Research Logistics,",
            "year": 2022
        },
        {
            "authors": [
                "Hua Zheng",
                "Wei Xie",
                "Ilya O Ryzhov",
                "Dongming Xie"
            ],
            "title": "Policy optimization in bayesian network hybrid models of biomanufacturing processes",
            "venue": "arXiv preprint arXiv:2105.06543,",
            "year": 2021
        },
        {
            "authors": [
                "Hua Zheng",
                "Wei Xie",
                "Keqi Wang",
                "Zheng Li"
            ],
            "title": "Opportunities of hybrid model-based reinforcement learning for cell therapy manufacturing process development and control",
            "venue": "arXiv preprint arXiv:2201.03116,",
            "year": 2022
        },
        {
            "authors": [
                "Alexander Gleim",
                "Christian Pigorsch"
            ],
            "title": "Approximate bayesian computation with indirect summary statistics",
            "year": 2013
        },
        {
            "authors": [
                "Gael M Martin",
                "Brendan PM McCabe",
                "David T Frazier",
                "Worapree Maneesoonthorn",
                "Christian P Robert"
            ],
            "title": "Auxiliary likelihood-based approximate bayesian computation in state space models",
            "venue": "Journal of Computational and Graphical Statistics,",
            "year": 2019
        },
        {
            "authors": [
                "Scott A Sisson",
                "Yanan Fan",
                "Mark Beaumont"
            ],
            "title": "Handbook of Approximate Bayesian Computation",
            "year": 2018
        },
        {
            "authors": [
                "Conor M O\u2019Brien",
                "Qi Zhang",
                "Prodromos Daoutidis",
                "Wei-Shou Hu"
            ],
            "title": "A hybrid mechanistic-empirical model for in silico mammalian cell bioprocess simulation",
            "venue": "Metabolic Engineering,",
            "year": 2021
        },
        {
            "authors": [
                "Tina Toni",
                "David Welch",
                "Natalja Strelkowa",
                "Andreas Ipsen",
                "Michael PH Stumpf"
            ],
            "title": "Approximate bayesian computation scheme for parameter inference and model selection in dynamical systems",
            "venue": "Journal of the Royal Society Interface,",
            "year": 2009
        },
        {
            "authors": [
                "Mark A Beaumont",
                "Jean-Marie Cornuet",
                "Jean-Michel Marin",
                "Christian P Robert"
            ],
            "title": "Adaptive approximate bayesian computation",
            "year": 2009
        },
        {
            "authors": [
                "Maxime Lenormand",
                "Franck Jabot",
                "Guillaume Deffuant"
            ],
            "title": "Adaptive approximate bayesian computation for complex models",
            "venue": "Computational Statistics,",
            "year": 2013
        },
        {
            "authors": [
                "Pierre Del Moral",
                "Arnaud Doucet",
                "Ajay Jasra"
            ],
            "title": "Sequential monte carlo samplers",
            "venue": "Journal of the Royal Statistical Society: Series B (Statistical Methodology),",
            "year": 2006
        },
        {
            "authors": [
                "Kevin P Murphy"
            ],
            "title": "Machine Learning: A Probabilistic Perspective",
            "year": 2012
        },
        {
            "authors": [
                "Wayne A Fuller",
                "JNK Rao"
            ],
            "title": "Estimation for a linear regression model with unknown diagonal covariance matrix",
            "venue": "The Annals of Statistics,",
            "year": 1978
        },
        {
            "authors": [
                "Katie E Glen",
                "Elizabeth A Cheeseman",
                "Adrian J Stacey",
                "Robert J Thomas"
            ],
            "title": "A mechanistic model of erythroblast growth inhibition providing a framework for optimisation of cell therapy manufacturing",
            "venue": "Biochemical Engineering Journal,",
            "year": 2018
        },
        {
            "authors": [
                "Lam Si Tung Ho",
                "Binh T Nguyen",
                "Vu Dinh",
                "Duy Nguyen"
            ],
            "title": "Posterior concentration and fast convergence rates for generalized bayesian learning",
            "venue": "Information Sciences,",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Keywords Approximate Bayesian Computation, Auxiliary Likelihood-based Summary Statistics, Cell therapy manufacturing, Bioprocess hybrid model, Latent State"
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "The biopharmaceutical manufacturing industry is growing rapidly and it plays a critical role to ensure public health and support economy. However, biomanufacturing often faces critical challenges, including high complexity, high variability, and very limited process observations. As new biotherapeutics (e.g., cell and gene therapies) become more and more personalized, it requires more advanced manufacturing protocols. For example, the seed cells, extracted from individual patients or donors, can have different optimal culture policies. Therefore, the production process involves a complex stochastic decision process (SDP) with output trajectory dynamics and variations influenced by biological/physical/chemical (a.k.a. biophysicochemical) reactions occurring at molecular, cellular, and system levels.\nIn general, there are two main categories of biomanufacturing process modeling methodologies in the existing literature: mechanistic and data-driven approaches. The ordinary/partial differential equations (ODE/PDE) mechanistic models are developed based on biophysicochemical mechanisms. They have good interpretability and show generally higher extrapolation power than data-driven models. However, existing mechanistic models often fail to rigorously account for uncertainties, i.e., inherent stochasticity and model estimation uncertainty. For example, batch-to-batch variation, known as a major source of bioprocess uncertainty [1], is ignored in deterministic mechanistic models. Therefore, mechanistic models may not fit well to the observations collected from real systems in many situations, which also limits their power in terms of mechanism learning, process monitoring, and robust control to support flexible on-demand manufacturing. On the other hand, data-driven approaches often use general statistical or machine learning approaches to capture process patterns observed in data. The prediction accuracy of these models largely depends on the the size of process data and their interpretability is limited.\nDriven by the critical challenges of biomanufacturing and limitations of existing process modeling approaches, we developed a probabilistic knowledge graph (KG) hybrid (\u201cmechanistic and statistical\u201d) model characterizing the risk\u2217Corresponding author: w.xie@northeastern.edu\nar X\niv :2\n20 5.\n02 41\n0v 4\n[ st\nat .M\nL ]\n3 0\nSe p\nand science-based understanding of biophysicochemical reactions and bioprocess spatiotemporal causal interdependiences [2, 3, 4]. It can leverage the information from existing mechanistic models within and between operation units, and facilitate mechanism learning from heterogeneous online and offline measurements. [3] introduced KG-based reinforcement learning (RL) to guide customized decision making. Since the proposed model-based RL scheme on the Bayesian KG, accounting for both stochastic and model uncertainties, can provide an insightful prediction on how the effect of inputs propagates through mechanism pathways, impacting on the output trajectory dynamics and variations, it can find optimal process control policies that are interpretable and robust against model uncertainty, and overcome the key challenges of biopharmaceutical manufacturing.\n[4] further generalized this KG hybrid model to capture the important properties of integrated biomanufacturing processes, including nonlinear reactions, partially observed state, and nonstationary dynamics. It can faithfully represent and advance the understanding of underlying bioprocessing mechanisms. This model allows us to inference unobservable latent states and critical pathways to support process monitoring and control; for example it enables the estimation of metabolic states and cell response to environmental perturbations. Since the hybrid model involves latent state variables, nonlinear reactions, and time-varying kinetic coefficients with uncertainty (such as cell growth rate and molecular reaction rates), it is challenging to evaluate the likelihood function and derive a posterior distribution.\nApproximate Bayesian Computation (ABC) is introduced in the literature to approximate posterior distributions for process models with intractable likelihoods. It bypasses the evaluation of likelihoods by simulating model parameters, generating synthetic data sets, and only accepting posterior samples when the sampled process outputs are \u201cclose\u201d enough to real observations. For complex biomanufacturing processes with high stochastic and model uncertainties, the accept rate is very low and it is computationally challenging to generate sample trajectories close to real-world observations. Recently, there has been much interest in formalizing an auxiliary likelihood based ABC, which uses a simpler and related model to derive summary statistics as distance measure [5, 6, 7].\nFollowing the spirit of the auxiliary likelihood-based ABC [6], we utilize a linear Gaussian dynamic Bayesian network (LG-DBN) auxiliary model to derive summary statistics as a distance measure for ABC-SMC that can support dimensional reduction and accelerate online inference on hybrid models with high fidelity characterizing complex bioprocessing mechanisms. The proposed ABC approach in conjunction with sequential importance sampling can efficiently approximate hybrid model posterior distribution. Therefore, the key contributions of this paper is: given very limited real-world data, we propose a LG-DBN auxiliary likelihood based ABC-SMC sampling approach to generate posterior samples of bioprocess hybrid model parameters quantifying model uncertainty. This simple LG-DBN auxiliary model can capture the critical dynamics and variations of bioprocess trajectory, ensure computational efficiency, and enable the inference on model and latent state, which can facilitate mechanism online learning and support robust process control. The empirical study shows that our approach can outperform the original ABC-SMC approach especially given tight computational budget.\nThe remainder of the paper is organized as follows. We provide the problem description and summarize the proposed framework in Section 2. Then, we present a probabilistic KG hybrid model capturing the important properties of biomanufacturing processes and describe ABC for approximating the posterior distribution of model parameters in Section 3. We derive the LG-DBN auxiliary likelihood based summary statistics to accelerate Bayesian inference on the hybrid models with high fidelity in Section 4. We conduct the empirical study on cell therapy manufacturing in Section 5 and conclude the paper in Section 6."
        },
        {
            "heading": "2 PROBLEM DESCRIPTION AND PROPOSED FRAMEWORK",
            "text": "Driven by the needs of biomanufacturing process online learning, monitoring, and control, we create a probabilistic KG hybrid model characterizing underlying mechanisms and causal interdependencies between critical process parameters (CPPs) and critical quality attributes (CQAs). It models how the effect of state and action at any time t, denoted by {st ,at}, propagates through mechanism pathways impacting on the output trajectory dynamics and variations. Here we use cell culture process for illustration. The process state transition model is denoted by p(st+1|st ,at ;\u03b8 ) where st \u2208S \u2282Rd denotes the partially observable bioprocess state (i.e., extra- and intra-cellular enzymes, proteins, metabolites, media), at \u2208 A denotes action (i.e., agitation rate, oxygen/nutrient feeding rates), A is a finite set of actions, and t \u2208H \u2261 {1,2, . . . ,H + 1} denotes the discrete time index. At any time t, the agent partially observes the state st and takes an action at . Thus, given model parameters \u03b8 , the joint distribution of process trajectory \u03c4 = (s1,a1, . . . ,sH ,aH ,sH+1) becomes,\np(\u03c4 |\u03b8 ) = p(s1) H\n\u220f t=1 p(st+1|st ,at ;\u03b8 )p(at).\nDue to the nature of biopharmaceutical manufacturing, the state transition model p(st+1|st ,at ;\u03b8 ) is highly complex, non-linear, and nonstationary. The state transition p(st+1|st ,at ;\u03b8 ) is modeled by a hybrid (\u201cmechanistic + statistical\u201d) model. Its structure takes existing mechanistic models as prior. For example, since the key factors influencing process dynamics and variability in the cell culture process are induced by cellular metabolisms [8], the probabilistic state transition of this KG hybrid model can incorporate cell metabolic/gene regulatory networks and account for cell-to-cell variations. Therefore, there are key properties in biomanufacturing process, specially for personalized cell/gene therapies, including (1) partially observed state (st ) that means only limited proportion of state observable; (2) stochastic state transition model p(st+1|st ,at ;\u03b8 ) involves high inherent stochasticity; and (3) very limited and heterogeneous online and offline measurement data.\nGiven limited historical observations, we focus on hybrid model Bayesian inference to support online mechanism learning, monitoring, and reliable interpretable prediction, accounting for both inherent stochasticity and model uncertainty. The posterior distribution will be derived to quantify model uncertainty."
        },
        {
            "heading": "2.1 Hybrid Modeling for Bioprocess with Partially Observed State",
            "text": "At any time t, the process state is composed of observable and latent state variables, i.e., st = (xt ,zt) with xt \u2208Sx and latent variables zt \u2208Sz, where Sx \u2282 Rdx and Sz \u2282 Rdz with S = Sx\u00d7Sz and d = dx +dz. Denote the partially observed state trajectory as \u03c4 x \u2261 (x1,a1, . . . ,xH ,aH ,xH+1). Given model parameters \u03b8 , by integrating out latent variables (z1, . . . ,zH+1), the likelihood evaluation of any observation \u03c4 x, i.e.,\np(\u03c4 x|\u03b8 ) = \u222b \u00b7 \u00b7 \u00b7 \u222b p(\u03c4 |\u03b8 )dz1 \u00b7 \u00b7 \u00b7dzH+1,\nis intractable especially when the dimensions of model parameters and latent states are high. This hybrid model characterizes the risk- and science-based understanding of underlying bioprocess mechanisms and quantifies spatial-temporal causal interdependencies of CPPs/CQAs. It can connect heterogeneous online and offline measures to infer unobservable state (such as metabolic state determining cell product functional behaviors and critical quality attributes), support process monitoring, and facilitate real-time release.\nWe model the bioprocess state transition with a hybrid (\u201cmechanistic and statistical\u201d) model. Given the existing ODE-based mechanistic model, ds/dt = f (s,a;\u03c6 ) , by using the finite difference approximation for derivatives, i.e., ds \u2248 \u2206st = st+1\u2212st , and dt \u2248 \u2206t, we construct the hybrid model for state transition,\nxt+1 = xt +\u2206t \u00b7 f x(xt ,zt ,at ;\u03c6 )+ext+1 and zt+1 = zt +\u2206t \u00b7 f z(xt ,zt ,at ;\u03c6 )+ezt+1,\nwith unknown kinetic coefficients \u03c6 \u2208Rd\u03c6 (e.g., cell growth and inhibition rates). The function structures of f x(\u00b7) and f z(\u00b7) are the parts of f (\u00b7) associated to the observable state output xt+1 and the latent state output zt+1. By applying the central limit theorem, the residual terms, accounting for inherent stochasticity and other factors, are modeled by multivariate Gaussian distributions ext+1 \u223cN (0,V x) and e z t+1 \u223cN (0,V z) with zero means and covariance matrices V x and V z. Then, the state transition distribution becomes,\nxt+1|xt ,zt ,at \u223cN ( xt +\u2206t \u00b7 f x(xt ,zt ,at),V xt+1 ) and zt+1|xt ,zt ,at \u223cN ( zt +\u2206t \u00b7 f z(xt ,zt ,at),V zt+1 ) .\nThus, the stochastic state transition model, specified by parameters \u03b8 = (\u03c6 ,V x,V z)>, characterizes the bioprocess inherent stochasticity, dynamics, and mechanisms (such as biophysicochemical reactions)."
        },
        {
            "heading": "2.2 Challenges of Hybrid Model Inference Under High Stochasticity and Limited Data",
            "text": "Given limited real-world data with size m, denoted by D = {\u03c4 (i)x : i = 1,2, . . . ,m}, the model uncertainty is quantified by a posterior distribution derived through applying the Bayes\u2019 rule,\np(\u03b8 |D) \u221d p(\u03b8 )p(D |\u03b8 ) = p(\u03b8 ) m\n\u220f i=1\np ( \u03c4 (i)x \u2223\u2223\u2223\u03b8) , (1)\nwhere p(\u03b8 ) represents the prior distribution. It is challenging to directly derive or computationally assess the posterior distribution p(\u03b8 |D) in eq. (1). First, there often exist large-dimensional latent state variables zt , especially for multiscale bioprocess model characterizing the scientific understanding of individual cell response to micro-environmental perturbation and accounting for cell-to-cell variation in metabolic/gene networks. It is computationally expensive to assess the likelihood for each observation, p(\u03c4 (i)x |\u03b8 ) = \u222b \u00b7 \u00b7 \u00b7 \u222b\np(\u03c4 (i)|\u03b8 )dz1 \u00b7 \u00b7 \u00b7dzH+1 with i = 1,2, . . . ,m, especially for bioprocess with optical sensor online monitoring (that means the value of H is large). Second, the mechanistic model\nf (s,a;\u03c6 ) can be a nonlinear function of state s and parameters \u03c6 . The random kinetic coefficients often have batchto-batch variations. For example, the kinetic coefficients (such as cell growth rate, oxygen/nutrient uptake rates, and metabolic waste excretion rate) can depend on the gene expression of seed cells and cell culture environments. Third, the amount of real-world process observations can be very limited (especially for personalized bio-drug manufacturing) even though inherent stochasticity and model uncertainty are high.\nThus, in Section 3, ABC approach is considered to approximate the posterior distribution of KG hybrid model with high fidelity that can capture the key features of biomanufacturing processes. Since it is computationally expensive especially under the situations with high stochastic and model uncertainties, LG-DBN auxiliary ABC-SMC is created to facilitate the Bayesian inference. Based on Taylor series approximation of the hybrid model, this linear auxiliary model can be accurate for biomanufacturing process with optical sensor (e.g., fluorescent probe and Raman sensors) online monitoring."
        },
        {
            "heading": "3 SEQUENTIAL IMPORTANCE SAMPLING FOR BAYESIAN INFERENCE",
            "text": "When the evaluation of likelihood for each observation is computationally intractable, i.e., p(\u03c4 (i)x |\u03b8 ) =\u222b \u00b7 \u00b7 \u00b7 \u222b\np(\u03c4 (i)|\u03b8 )dz1 \u00b7 \u00b7 \u00b7dzH+1 for i= 1,2, . . . ,m, the ABC approach is recommended to approximate the posterior distribution [7]. In the naive ABC implementation, we draw a candidate sample from the prior \u03b8 \u223c p(\u03b8 ) and then generate a simulation dataset D? from the hybrid model. If the simulated dataset D? is \u201cclose\u201d to the observed real-world observations D , we accept the sample \u03b8 ; otherwise reject it. Thus, we approximate the posterior distribution p(\u03b8 |D) with p(\u03b8 |d (D ,D?) \u2264 h), where d(\u00b7) is a distance metric (e.g., Euclidean distance, likelihood distance) and h is an approximation tolerance level.\nHowever, for any given small tolerance level h, we often face very low accept rate for complex biomanufacturing processes with high stochastic and model uncertainties. The random discrepancy between process trajectories D and D? can be large even when the parameter sample \u03b8 equals to \u03b8 c. In addition, given very limited real-world data for the complex hybrid model, the dimension of model parameters \u03b8 is large and the model uncertainty can be high.\nTo increase the accept rate and ensure the computational efficient generation of samples \u03b8 with good approximation on the critical features occurring in the real-world data, we will design the distance measure d(\u00b7) based on designed lower dimensional summary statistics, denoted by \u03b7(D), in Section 4. It means that we accept samples \u03b8 which lead to the summary statistics of simulated data, denoted by \u03b7? = \u03b7(D?), close to that of observations \u03b7obs = \u03b7(D). Thus, the standard ABC framework [7] becomes\npABC(\u03b8 |\u03b7obs) \u221d \u222b 1(d(\u03b7?,\u03b7obs)\u2264 h)p(\u03b7?|\u03b8 )p(\u03b8 )d\u03b7?. (2)\nAs the distance tolerance h gradually decreases, we have\nlim h\u21920\npABC(\u03b8 |\u03b7obs) \u221d \u222b \u03b4\u03b7obs(\u03b7 ?)p(\u03b7?|\u03b8 )p(\u03b8 )d\u03b7? = p(\u03b7obs|\u03b8 )p(\u03b8 ) \u221d p(\u03b8 |\u03b7obs),\nwhere \u03b4X (x) denotes the Dirac measure, defined as \u03b4X (x) = 1 if x = X and \u03b4X (x) = 0 otherwise.\nA good design of ABC summary statistics \u03b7 should balance complexity v.s. informativeness. If the summary statistics \u03b7 are sufficient for \u03b8 , then p(\u03b8 |\u03b7obs) will be equivalent to p(\u03b8 |D). With small threshold h, the ABC approximate pABC(\u03b8 |\u03b7obs) in (2) can provide a good approximation of the true posterior. However, in the most situations, it is challenging to specify sufficient statistics since the KG hybrid model is built based on mechanistic models and it accounts for the key features including (1) partially observed state; (2) heterogeneous offline and online measures; (3) nonlinear mechanisms and dynamics; and (4) batch-to-batch variations on mechanistic coefficients. Therefore, in Section 4, we project the bioprocess KG hybrid model into linear Gaussian dynamic Bayesian Network (LG-DBN) auxiliary model space that has tractable likelihood. It can capture first two moments of bioprocess dynamics and variations to support robust and optimal control. We will use the LG-DBN likelihood to derive summary statistics accelerating the generation of critical samples \u03b8 . Our study also shows that complex KG hybrid models will asymptotically converge to a LG-DBN model as time interval \u2206t becomes \u201csmaller and smaller\u201d by applying Taylor approximation [3]. Thus, this LG-DBN approximation holds well for many cases with online sensor monitoring and bioprocess (e.g., biological state of cells) that does not change quickly.\nThe basic ABC generates candidate samples from the prior p(\u03b8 ) and uses the accept/reject approach to retain those samples satisfying the approximation threshold requirement. This can be extremely ineffective especially for the situations using noninformative prior that has a wide sampling space. The ABC-sequential Monte Carlo (ABC-SMC) methods derived from the sequential importance sampling [9, 10] can improve the sampling efficiency through generating candidate samples from updated posterior approximates. In specific, let g denote the index of ABC iterations\nused to improve the approximation of the posterior distribution p(\u03b8 |D). We select a sequence of intermediate target distribution, denoted by {\u03c0g} for g = 1,2, . . . ,G, converging to p(\u03b8 |D) as we gradually reduce the tolerance level hg,\n\u03c0g(\u03b8 ) = p(\u03b8 )1(d(\u03b7?,\u03b7obs)\u2264 hg) . (3)\nDirect sampling from p(\u03b8 ) and having the accept/reject based on the condition 1(d(\u03b7?,\u03b7obs)\u2264 hg) in (3) is not simulation efficient. The accept rate can be low as hg becomes smaller and smaller.\nThus, we use the sequential importance sampling (SIS) and select a sequence of proposal distribution, denoted by {\u03b6g} for g = 1,2, . . . ,G, to improve the sampling efficiency, i.e.,\n\u03b6g(\u03b8 ) = 1(\u03c0g(\u03b8 )> 0) \u222b \u03c0g\u22121(\u03b8 \u2032)K(\u03b8 \u2032,\u03b8 )d\u03b8 \u2032, (4)\nwhere K(\u03b8 \u2032,\u03b8 ) is a Markov kernel. The proposal distribution \u03b6g(\u03b8 ) is defined as the perturbed previous intermediate distribution \u03c0g\u22121 through the perturbation kernel K. After generating N sample particles from the proposal distribution \u03b8 n \u223c \u03b6g(\u03b8 ) for n = 1,2, . . . ,N, we weight it by w(g)n = \u03c0g(\u03b8 n)/\u03b6g(\u03b8 n). The condition, 1(\u03c0g(\u03b8 ) > 0), in (4) is used to satisfy the importance sampling condition, i.e., {\u03b8 : \u03c0g(\u03b8 ) > 0} \u2282 {\u03b8 : \u03b6g(\u03b8 ) > 0}. This can avoid the weight becoming infinite, which will lead to high variance on the SIS estimator. We set the first proposal distribution to be the prior distribution, i.e., \u03b61(\u03b8 ) = p(\u03b8 ).\nAlgorithm 1: DBN auxiliary based ABC-SMC for hybrid model Bayesian inference.\nInput: the prior distribution p(\u03b8 ); the number of particles N; process observations D = {\u03c4 (i)x }mi=1; the perturbation kernel function K(\u00b7); the number of particles to keep at each iteration N\u03b1 = b\u03b1Nc with \u03b1 \u2208 [0,1]; and the minimal acceptance rate paccmin . Output: posterior distribution approximate p\u0302(\u03b8 |D). for n = 1, . . . ,N do\n1. Sample \u03b8 (0)n \u223c p(\u03b8 ); 2. Generate m\u00d7L predicted trajectories D? = {\u03c4 ?(i)x }mLi=1 using \u03b8 (0) n ; 3. Set q(0)n = d(\u03b7(D),\u03b7(D?)) and w (0) n = 1;\n4. Let h1 be the first \u03b1-quantile of q(0) = {q(0)n }Nn=1; 5. Let {(\u03b8 (1)n ,w(1)n ,q(1)n )}= {(\u03b8 (0)n ,w(0)n ,q(0)n )|q(0)n \u2264 h1,1\u2264 n\u2264 N}, pacc = 1 and g = 2; while pacc > paccmin do\nfor n = N\u03b1 +1, . . . ,N do\n6. Sample \u03b8 ?n from \u03b8 (g\u22121) k with probability w(g\u22121)k \u2211N\u03b1j=1 w (g\u22121) j , 1\u2264 k \u2264 N\u03b1 ; 7. Perturb the particle to obtain \u03b8 (g\u22121)n \u223c K(\u03b8 |\u03b8 ?n) = N (\u03b8 ?n,\u2211); 8. Generate m\u00d7L predicted trajectories D? = {\u03c4 ?(i)x }mLi=1 using \u03b8 (g\u22121) n : 9. Set q(g\u22121)n = d(\u03b7(D),\u03b7(D?)); 10. Set w(g\u22121)n = p(\u03b8 (g\u22121)n )1(d(\u03b7(D),\u03b7(D?))\u2264hg\u22121)\n\u2211N\u03b1j=1 w(g\u22121)j\n\u2211N\u03b1k=1 w (g\u22121) k\nK(\u03b8 (g\u22121)n |\u03b8 (g\u22121) j )\n;\n11. Set pacc = 1N\u2212N\u03b1 \u2211 N k=N\u03b1+11(q (g\u22121) k \u2264 hg\u22121); 12. Let hg be the first \u03b1-quantile of q(g\u22121) = {q(g\u22121)n }Nn=1; 13. Let {(\u03b8 (g)n ,w(g)n ,q(g)n )}= {(\u03b8 (g\u22121)n ,w(g\u22121)n ,q(g\u22121)n )|q(g\u22121)n \u2264 hg,1\u2264 n\u2264 N} and g = g+1;\n14. Return the approximated posterior distribution, p\u0302(\u03b8 |D) = 1 \u2211N\u03b1n\u2032=1 w (g\u22121) n\u2032 \u2211N\u03b1n=1 w (g\u22121) n \u03b4\u03b8 (g\u22121)n (\u03b8 ).\nThe proposed LG-DBN auxiliary likelihood-based ABC-SMC sampling procedure is summarized in Algorithm 1. It incorporates an adaptive selection approach on the threshold hg from [9, 11, 12]. The initial set of parameter samples {\u03b8 (0)n }Nn=1 is generated from the prior distribution p(\u03b8 ) in Step 1. The associated weights {w (0) n }Nn=1 and distances {q(0)n }Nn=1 are calculated in Steps 2-3. Considering the impact from stochastic uncertainty, we generate mL predicted trajectories denoted by D? = {\u03c4 ?(i)x }mLi=1, compute the LG-DBN auxiliary based summary statistics \u03b7(D?), and then\ncalculate the distance q(0)n . The tolerance level hg in any g-th iteration is determined online as the \u03b1-quantile of the {q(g)n }Nn=1. The particles, satisfying this tolerance denoted by {\u03b8 n} N\u03b1 n=1, constitute the weighted empirical distribution to approximate the posterior distribution in Steps 5 and 13, where N\u03b1 = b\u03b1Nc. The approximation accuracy is measured by the corresponding distances {qn}N\u03b1n=1. Then, N\u2212N\u03b1 new particles are drawn from the proposal distribution \u03b6g(\u03b8 ) in Steps 6-7. The associated weights and distances are calculated in Steps 8-10. The tolerance level hg and the posterior distribution approximate \u03c0g(\u03b8 ) are updated in Steps 12-13. We repeat Steps 6-13 until the proportion of particles satisfying the tolerance level hg\u22121 among the N \u2212N\u03b1 new particles is below the pre-specified threshold paccmin . Finally, the ABC-SMC algorithm returns the weighted empirical distribution, denoted by p\u0302(\u03b8 |D), as posterior distribution approximate in Step 14."
        },
        {
            "heading": "4 LG-DBN AUXILIARY LIKELIHOOD-BASED SUMMARY STATISTICS",
            "text": "Motivated by the studies [6, 5], in this section, we derive LG-DBN auxiliary likelihood-based summary statistics for ABC-SMC to capture the crucial features of the bioprocess trajectory on dynamics and variations. Given a set of observations D = {\u03c4 (i)x : i = 1,2, . . . ,m}, we derive the MLE of LG-DBN auxiliary model, i.e., maximizing the loglikelihood \u03b2\u0302 (D) = argmax\u03b2 `(\u03b2 |D). Then we use it as the summary statistics \u03b7 , \u03b2\u0302 to calculate the distance measure q \u2261 d(\u03b2\u0302 ,\u03b2\u0302 ? ), where \u03b2\u0302 ? is the summary statistics of simulated data. In the following, we first develop the LG-DBN model with only observable state transition in Section 4.1 and then discuss the parameter estimation in Section 4.2."
        },
        {
            "heading": "4.1 The development of LG-DBN Auxiliary Model",
            "text": "Let xk1 \u223cN (\u00b5 x,k 1 ,(v x,k 1 ) 2) with k = 1,2 . . . ,d model the variation in the k-th initial observed state. In practice, to ensure product quality, CPPs are strictly regulated by the specifications of ranges of values. Thus, we model at as a random variable, i.e., akt \u223c N (\u03bb x,k t ,(\u03c3 x,k t )\n2) with k = 1,2 . . . ,da and t = 1,2 . . . ,H. At any time t, the LG-DBN auxiliary model has the state transition model,\nxt+1 = \u00b5 xt+1 +\u03c8 x t (xt \u2212\u00b5 xt )+\u03c8 at (at \u2212\u00b5 at )+(V xt+1) 1 2 \u03c9 , (5)\nwhere \u00b5 xt = (\u00b51t , . . . ,\u00b5 dx t ), \u00b5 at = (\u03bb 1t , . . . ,\u03bb da t ), \u03c9 is an dx-dimensional standard normal random vector, and V xt+1 = diag((vx,kt+1) 2) is a diagonal covariance matrix. The coefficients \u03c8 xt and \u03c8 at measure the main effects of current observed state xt and action at on the next observed state xt+1. Let \u03c3 t = (\u03c31t , . . . ,\u03c3 da t ) and vxt = (v x,1 t , . . . ,v x,dx t ). Thus, the LGDBN model, specified by parameters \u03b2 = (\u00b5 x,\u00b5 a,\u03c8 x,\u03c8 a,\u03c3 ,vx) = {(\u00b5 xt ,\u00b5 at ,\u03c8 xt ,\u03c8 at ,\u03c3 t ,vxt )|1 \u2264 t \u2264 H}, has the joint distribution of bioprocess trajectory: p(\u03c4 x) = p(x1,a1, . . . ,xH ,aH ,xH+1) = p(x1)\u220fHt=1 p(xt+1|xt ,at)p(at).\nLet \u00b5 \u03c4 = [\u00b5 x1,\u00b5 a 1, . . . ,\u00b5 x H ,\u00b5 aH ,\u00b5 xH+1] >. Following [13], we rewrite (5) in the following form \u03c4 x\u2212\u00b5 \u03c4 = B(\u03c4 x\u2212\u00b5 \u03c4)+\u03a3 1 2 \u03c4 \u03c9 \u03c4 (6) where \u03c9 \u03c4 is an ((H +1)dx +Hda)-dimensional standard normal random vector, \u03a3 1 2 \u03c4 = diag(vx1,\u03c3 1, . . . ,v x H ,\u03c3 H ,vxH+1) is the diagonal matrix of the conditional standard deviations of observed state and actions, and the coefficient matrix of observed trajectory is written as\nB =  0 0 0 0 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 0 0 0 0 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 \u03c8 x1 \u03c8 a 1 0 0 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 0 0 0 0 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 0 0 \u03c8 x2 \u03c8 a 2 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 0 0 0 0 0 0 \u00b7 \u00b7 \u00b7 0 0 0 0 ... ... ... ... ... ... ... ... ... ... ...\n0 0 0 0 0 0 \u00b7 \u00b7 \u00b7 \u03c8 xH \u03c8 aH 0 0\n .\nThus, by rearranging (6) and letting \u03c4 x\u2212\u00b5 \u03c4 = (I\u2212B)\u22121\u03a3 1 2 \u03c4 \u03c9 \u03c4 , we have \u03c4 x \u223cN (\u00b5 \u03c4 ,(I\u2212B)\u22121\u03a3\u03c4(I\u2212B)\u2212>) with mean E[\u03c4 x] = \u00b5 \u03c4 and covariance matrix Cov(\u03c4 x\u2212\u00b5 \u03c4) = (I\u2212B)\u22121\u03a3\u03c4(I\u2212B)\u2212>."
        },
        {
            "heading": "4.2 Linear Gaussian Dynamic Bayesian Network based Summary Statistics",
            "text": "Let \u03c4\u0303 x \u2261 (x\u03031,a\u03031, . . . ,x\u0303H ,a\u0303H ,x\u0303H+1) = \u03c4 x\u2212\u00b5 \u03c4 , where x\u0303t and a\u0303t denote centered observable state and decision. Given m observations D = {\u03c4 (i)x }mi=1, the unbiased estimator \u00b5\u0302 \u03c4 = 1 m \u2211 m i=1 \u03c4 (i) x can be easily obtained by using the fact E[\u03c4 x] =\n\u00b5 \u03c4 . The log-likelihood of the centered trajectory observations {\u03c4\u0303 (i)x }mi=1 becomes,\nmax \u03c8 x,\u03c8 a,V\n` ( \u03c4\u0303 (1)x , . . . , \u03c4\u0303 (m) x ;\u03c8 x,\u03c8 a,V ) = max\n\u03c8 x,\u03c8 a,V log\nm\n\u220f i=1\np ( \u03c4\u0303 (i)x )\n= max V1\nm\n\u2211 i=1 log p(x\u0303(i)1 )\n[ H\n\u2211 t=1 max \u03c3t\nm\n\u2211 i=1\nlog p(a\u0303(i)t )\n][ H\n\u2211 t=1 max \u03c8 xt ,\u03c8 at ,vxt+1\nm\n\u2211 i=1 log p(x\u0303(i)t+1|x\u0303 (i) t ,a\u0303 (i) t )\n] .\nSince both initial state x\u03031 and actions a\u0303t for t = 1, . . . ,H are normally distributed with mean zero, the MLEs of their variance are sample covariances: v\u0302x,k1 = 1 m \u2211 m i=1(x\u0303 k(i) 1 ) 2 with k = 1,2, . . . ,dx and \u03c3\u0302 kt = 1m \u2211 m i=1(a\u0303 k(i) t ) 2 with k = 1,2, . . . ,da. In addition, at any time t, we have the log-likelihood of a sample \u03c4\u0303 (i) x\nlog p(x\u0303(i)t+1|x\u0303 (i) t ,a\u0303 (i) t ) \u221d\u2212 m 2 log |V xt+1|\u2212 1 2 ( x\u0303(i)t+1\u2212\u03c8 x t x\u0303 (i) t \u2212\u03c8 at a\u0303 (i) t )> V xt+1 ( x\u0303(i)t+1\u2212\u03c8 x t x\u0303 (i) t \u2212\u03c8 at a\u0303 (i) t ) .\nLet x\u0303(i)t+1 and (x\u0303 (i) t ,a\u0303 (i) t ) denote the i-th rows of output matrix Y and input matrix X . Let Bt = (\u03c8 xt ,\u03c8 at ) > denote the coefficient vector. As a result, the MLEs of \u03c8 xt and \u03c8 at are\n(\u03c8\u0302 xt ,\u03c8\u0302 a t ) > = B\u0302t = argmax Bt \u22121 2 (Y \u2212XBt)> (V xt+1)\u22121 (Y \u2212XBt) = (X>(V xt+1)\u22121X)\u22121X>(V xt+1)\u22121Y.\nThe MLE of each standard deviation can be computed by v\u0302x,kt = \u221a 1 m \u2211 m i=1 ( x\u0303k(i)t )2 [14]. In sum, given observations\nD , the MLE of LG-DBN auxiliary model is \u03b2\u0302 = (\u00b5\u0302 x, \u00b5\u0302 a,\u03c8\u0302 x,\u03c8\u0302 a,\u03c3\u0302 ,v\u0302x)."
        },
        {
            "heading": "5 EMPIRICAL STUDY",
            "text": "In this section, we use the erythroblast cell therapy manufacturing example presented in [15] to assess the performance of the proposed LG-DBN auxiliary likelihood-based ABC-SMC approach."
        },
        {
            "heading": "5.1 Hybrid Modeling for Cell Therapy Manufacturing Process",
            "text": "The cell culture process of erythroblast exhibits two phases: a relatively uninhibited growth phase followed by an inhibited phase. [15] identified that this reversible inhibition is caused by an unknown cell-driven factor rather than commonly known mass transfer or metabolic limitations. They developed an ODE-based mechanistic model describing the dynamics of an unidentified autocrine growth inhibitor accumulation and its impact on the erythroblast cell production process, i.e.,\nd\u03c1t dt = rg\u03c1t\n( 1\u2212 ( 1+ eks(kc\u2212It ) )\u22121)\nand dIt dt = d\u03c1t dt \u2212 rdIt ,\nwhere \u03c1t and It represent the cell density and the inhibitor concentration (i.e., latent state) at time t. The kinetic coefficients \u03c6 = {rg,ks,kc,rd} denote the cell growth rate, the inhibitor sensitivity, the inhibitor threshold, and the inhibitor decay. Then, we construct the hybrid model, i.e.,\n\u03c1t+1 = \u03c1t +\u2206t \u00b7 rg\u03c1t ( 1\u2212 ( 1+ eks(kc\u2212It ) )\u22121) + e\u03c1t and It+1 = It +\u2206t \u00b7 ( \u03c1t+1\u2212\u03c1t\n\u2206t \u2212 rdIt\n) + eIt , (7)\nwhere the residuals follow the normal distributions e\u03c1t \u223cN (0,v2\u03c1) and eIt \u223cN (0,v2I ) by applying CLT. Therefore, the hybrid model is specified by parameters \u03b8 = (rg,ks,kc,rd ,v\u03c1 ,vI). The prediction is made on the interval of three hours \u2206t = 3 from 0 to 30 hours (corresponding to time step t = 1,2, . . . ,11).\nWe denote the \u201ctrue\u201d hybrid model with underlying parameters \u03b8 c. Following [15], we specify the true mechanistic parameter values as \u03c6 c = {rg,ks,kc,rd} = {0.057,3.4,2.6,0.005}. We set the bioprocess noise level v = v\u03c1 = vI , the initial cell density 3 \u00d7106 cells/mL (i.e., \u03c11 = 3), and no initial inhibition (i.e., I1 = 0). Based on the simulation data generated by the true hybrid model, we assess the performance of the proposed LG-DBN auxiliary ABC-SMC algorithm under different levels of bioprocess noise v = {0.1,0.2} and model uncertainty induced with the different data size, i.e., m = 3,6,20 batches."
        },
        {
            "heading": "5.2 LG-DBN Auxiliary Sequential Importance Sampling Performance Assessment",
            "text": "We compare the performance of LG-DBN auxiliary ABC-SMC with naive ABC-SMC in terms of: (1) prediction accuracy, (2) computation time, and (3) posterior concentration. The distance metrics of naive ABC-SMC is d (D ,D?). The results are estimated based 30 macro-replications. We set the number of particles N = 400, the ratio \u03b1 = 0.5, the number of replications L = 60, and the minimal accept rate Paccmin = 0.15. The prior distributions of model parameters are set as: rg \u223cU(0,0.5), ks \u223cU(0,5), kc \u223cU(0,5), rd \u223cU(0,0.05), v\u03c1 \u223cU(0,0.2), and vI \u223cU(0,0.2). One of the major benefits induced by the LG-DBN auxiliary likelihood is that it provides an efficient way to measure the distance between simulated and observed samples, which quickly leads to posterior samples fitting well on dynamics and variations. To show the advantage of LG-DBN auxiliary ABC-SMC, we first study its computational efficiency. For each r-th macro replication, let T (r)w and T (r) wo represent the computation cost of the ABC-SMC algorithm with and without LG-DBN auxiliary. The computational efficiency improvement is evaluated as the time consuming ratio defined as C(r) = T (r)wo /T (r) w . We record the 95% confidence interval (CI) for improvement, denoted by C\u0304\u00b11.96\u00d7SC/ \u221a 30, where C\u0304 = 130 \u2211 30 r=1 T (r) wo /T (r) w and SC = [\u221130r=1(T (r) wo /T (r) w \u2212C\u0304)2/29]1/2; see the results in Table 1. With the LG-DBN auxiliary, the ABC-SMC algorithm shows significant improvement in computational efficiency. In all different settings, the mean computation cost of naive ABC-SMC is higher than the LG-DBN auxiliary based ABC-SMC by 27% (at low variance and small sample size) to 163% (at high variance and relative larger sample size).\nThen, we compare the prediction accuracy of the posterior predictive distribution obtained from ABC-SMC with and without LGDBN auxiliary. We estimate the parameters \u03b8 = (rg,ks,kc,rd ,v\u03c1 ,vI). Specifically, in each macro replication, we generate posterior sam-\nples { \u03b8 (i) }N\u03b1\ni=1 by LG-DBN auxiliary and naive\nABC-SMC approaches to approximate the posterior predictive distribution,\np(\u03c1t , It |\u03c11, I1,D) = \u222b p(\u03c1t , It |\u03b8 ,\u03c11, I1)p(\u03b8 |D)d\u03b8 = 1\nN\u03b1\nN\u03b1 \u2211 i=1\np ( \u03c1t , It |\u03c11, I1,\u03b8 (i) ) ,\nwhere the probability density p(\u03c1t , It |\u03c11, I1,\u03b8 (i)) is computed by the hybrid model (7) for i = 1,2, . . . ,N\u03b1 . Given the \u201ctrue\u201d model parameters \u03b8 c, we can also construct the predictive distribution p(\u03c1t , It |\u03c11, I1,\u03b8 c) from the model (7). Figure 1 shows posterior predictive distributions of cell density and inhibitor concentration at the 30-th hour or timestep t = 11 given a fixed initial state (\u03c11, I1) = (3,0). The black dashed line represents the predictive distribution of \u201ctrue\u201d model p(\u03c111, I11|\u03c11, I1,\u03b8 c).\nBy comparing Figure 1(a)-(b) to Figure 1(c)-(d), we observe that LG-DBN auxiliary ABC-SMC shows more robust performance across macro-replications and the posterior predictive distributions are generally closer to the \u201ctrue\u201d predictive distribution than naive ABC-SMC. We further investigate Panel (a) and (c). In low noise level v = 0.1, the auxiliary based ABC-SMC tends to overestimate the variance v\u03c1 causing the estimated posterior predictive distributions more flat than the \u201ctrue\u201d predictive distribution. However, in high noise level, the posterior predictive distribution of LG-DBN auxiliary ABC-SMC is more accurate than that from naive ABC-SMC which consistently underestimates the variance v\u03c1 . The LG-DBN auxiliary ABC-SMC consistently shows better prediction on inhibitor concentration; see Figure 1(b) and 1(d).\nWe further use the Kolmogorov\u2013Smirnov(K-S) statistics to assess the performance of LG-DBN auxiliary ABC-SMC and naive ABC-SMC. The K-S statistics quantifies the distance between posterior predictive distribution and predictive\ndistribution of \u201ctrue\u201d model. The K-S statistics is D= sups |Fc(s)\u2212F p(s)| for s\u2208{\u03c1, I}, where Fc(s) and F p(s) are the empirical distribution functions of the samples from predictive distribution of \u201ctrue\u201d model and posterior predictive distribution respectively. The smaller value of K-S statistic means better approximation performance of posterior predictive distribution. The number of samples used to construct the empirical distribution is K = 2000 in each macroreplication. We summarize 95% CIs of distances for both cell density and inhibitor accumulation at the 30-th hour, denoted by D\u0304\u00b11.96\u00d7SD/ \u221a 30 in Table 2, where D\u0304 = 130 \u2211 30 r=1 D\n(r) and SD = [\u221130r=1(D(r)\u2212 D\u0304)2/29]1/2. As shown in Table 2, the LG-DBN auxiliary ABC-SMC algorithm has better performance in inhibitor concentration prediction \u2013 latent state estimation \u2013 at all levels of model estimation uncertainty and stochastic uncertainty. It also provides better prediction on cell density under high stochastic uncertainty. The results are consistent with the observations obtained from Figure 1. The performance improvement can be further observed from the estimated posterior distribution of hybrid model parameters; see the representative plots of cell growth rate rg and inhibitor decay rate rd in Figure 2. The posterior distribution estimated by the LG-DBN auxiliary ABC-SMC has better concentration, defined as the posterior mass around the true parameter [16], than naive ABC-SMC in all noise levels and sample sizes.\nNotice that due to the structure of the kinetic model in (7) and a small value rcd = 0.005, the observable state \u03c1t is not so sensitive to the changes in the inhibitor decay rate rd and the inhibitor concentration It . Even thought it is more challenging to estimate the latent state It and its mechanistic model parameter rd , the LG-DBN auxiliary ABC-SMC tends to perform better.\nIn sum, compared with naive ABC-SMC, the proposed LG-DBN auxiliary ABC-SMC algorithm tends to have better prediction accuracy and computational efficiency especially under the situations with high stochastic and model uncertainties. This can benefit bioprocess mechanism learning and robust control.\n."
        },
        {
            "heading": "6 CONCLUSION",
            "text": "To leverage the information from existing mechanistic models and facilitate learning from real-world data, we develop a probabilistic knowledge graph (KG) hybrid model that can faithfully capture the important properties of bioprocesses, including nonlinear reactions, partially observed state, and nonstationary dynamics. Since the likelihood is intractable, approximate Bayesian computation (ABC) sampling strategy is used to generate samples to approximate the posterior distribution. For complex biomanufacturing processes with high stochastic and model uncertainties, it is computationally challenging to generate simulated trajectories close to real-world observations. Therefore, in this paper, we utilize a simple linear Gaussian dynamic Bayesian network (LG-DBN) auxiliary model to design summary statistics for ABC-SMC, which can accelerate Bayesian inference on the probabilistic KG hybrid model with high fidelity characterizing complex bioprocessing mechanisms. The empirical study demonstrates that the proposed LGDBN auxiliary ABC-SMC can improve computational efficiency and prediction accuracy. In the future research, we will extend this research to multi-scale bioprocess hybrid model in order to facilitate underlying mechanism learning, support process monitoring, and guide robust control at both cellular and system levels."
        }
    ],
    "title": "SEQUENTIAL IMPORTANCE SAMPLING FOR HYBRID MODEL BAYESIAN INFERENCE TO SUPPORT BIOPROCESS MECHANISM LEARNING AND ROBUST CONTROL",
    "year": 2022
}