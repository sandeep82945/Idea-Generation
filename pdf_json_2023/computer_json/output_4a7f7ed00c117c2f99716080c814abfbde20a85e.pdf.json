{
    "abstractText": "\u00a92023 IEEE. This work has been accepted for publication at the 62nd IEEE Conference on Decision and Control (CDC), Singapore, 2023. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works. Abstract\u2014 Inexact methods for model predictive control (MPC), such as real-time iterative schemes or time-distributed optimization, alleviate the computational burden of exact MPC by providing suboptimal solutions. While the asymptotic stability of such algorithms is well studied, their finite-time performance has not received much attention. In this work, we quantify the performance of suboptimal linear model predictive control in terms of the additional closed-loop cost incurred due to performing only a finite number of optimization iterations. Leveraging this novel analysis framework, we propose a novel suboptimal MPC algorithm with a diminishing horizon length and finite-time closed-loop performance guarantees. This analysis allows the designer to plan a limited computational power budget distribution to achieve a desired performance level. We provide numerical examples to illustrate the algorithm\u2019s transient behavior and computational complexity.",
    "authors": [
        {
            "affiliations": [],
            "name": "Aren Karapetyan"
        },
        {
            "affiliations": [],
            "name": "Efe C. Balta"
        },
        {
            "affiliations": [],
            "name": "Andrea Iannelli"
        },
        {
            "affiliations": [],
            "name": "John Lygeros"
        }
    ],
    "id": "SP:2db749c5c839ab0973b03ff6d9c381edc8684bcf",
    "references": [
        {
            "authors": [
                "B. Kouvaritakis",
                "M. Cannon"
            ],
            "title": "Model predictive control",
            "venue": "Switzerland: Springer International Publishing, vol. 38, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "M.N. Zeilinger",
                "C.N. Jones",
                "M. Morari"
            ],
            "title": "Real-time suboptimal model predictive control using a combination of explicit MPC and online optimization",
            "venue": "IEEE Transactions on Automatic Control, vol. 56, no. 7, pp. 1524\u20131534, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Richter",
                "C.N. Jones",
                "M. Morari"
            ],
            "title": "Computational complexity certification for real-time MPC with input constraints based on the fast gradient method",
            "venue": "IEEE Transactions on Automatic Control, vol. 57, no. 6, pp. 1391\u20131403, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "P.O. Scokaert",
                "D.Q. Mayne",
                "J.B. Rawlings"
            ],
            "title": "Suboptimal model predictive control (feasibility implies stability)",
            "venue": "IEEE Transactions on Automatic Control, vol. 44, no. 3, pp. 648\u2013654, 1999.",
            "year": 1999
        },
        {
            "authors": [
                "L.K. McGovern",
                "E. Feron"
            ],
            "title": "Closed-loop stability of systems driven by real-time, dynamic optimization algorithms",
            "venue": "Proceedings of the 38th IEEE Conference on Decision and Control (Cat. No. 99CH36304), vol. 4, pp. 3690\u20133696, IEEE, 1999.",
            "year": 1999
        },
        {
            "authors": [
                "K. Graichen",
                "A. Kugi"
            ],
            "title": "Stability and incremental improvement of suboptimal MPC without terminal constraints",
            "venue": "IEEE Transactions on Automatic Control, vol. 55, no. 11, pp. 2576\u20132580, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "M. Rubagotti",
                "P. Patrinos",
                "A. Bemporad"
            ],
            "title": "Stabilizing linear model predictive control under inexact numerical optimization",
            "venue": "IEEE Transactions on Automatic Control, vol. 59, no. 6, pp. 1660\u20131666, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "D. Liao-McPherson",
                "M.M. Nicotra",
                "I. Kolmanovsky"
            ],
            "title": "Timedistributed optimization for real-time model predictive control: Stability, robustness, and constraint satisfaction",
            "venue": "Automatica, vol. 117, p. 108973, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "D. Liao-McPherson",
                "T. Skibik",
                "J. Leung",
                "I. Kolmanovsky",
                "M.M. Nicotra"
            ],
            "title": "An analysis of closed-loop stability for linear model predictive control based on time-distributed optimization",
            "venue": "IEEE Transactions on Automatic Control, vol. 67, no. 5, pp. 2618\u20132625, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Diehl",
                "R. Findeisen",
                "F. Allg\u00f6wer",
                "H.G. Bock",
                "J.P. Schl\u00f6der"
            ],
            "title": "Nominal stability of real-time iteration scheme for nonlinear model predictive control",
            "venue": "IEE Proceedings-Control Theory and Applications, vol. 152, no. 3, pp. 296\u2013308, 2005.",
            "year": 2005
        },
        {
            "authors": [
                "A. Zanelli",
                "Q.T. Dinh",
                "M. Diehl"
            ],
            "title": "A lyapunov function for the combined system-optimizer dynamics in nonlinear model predictive control",
            "venue": "arXiv preprint arXiv:2004.08578, 2020.",
            "year": 2004
        },
        {
            "authors": [
                "J. Leung",
                "D. Liao-McPherson",
                "I.V. Kolmanovsky"
            ],
            "title": "A computable plant-optimizer region of attraction estimate for time-distributed linear model predictive control",
            "venue": "2021 American Control Conference (ACC), pp. 3384\u20133391, IEEE, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "D.Q. Mayne",
                "J.B. Rawlings",
                "C.V. Rao",
                "P.O. Scokaert"
            ],
            "title": "Constrained model predictive control: Stability and optimality",
            "venue": "Automatica, vol. 36, no. 6, pp. 789\u2013814, 2000.",
            "year": 2000
        },
        {
            "authors": [
                "A. Bemporad",
                "M. Morari",
                "V. Dua",
                "E.N. Pistikopoulos"
            ],
            "title": "The explicit linear quadratic regulator for constrained systems",
            "venue": "Automatica, vol. 38, no. 1, pp. 3\u201320, 2002.",
            "year": 2002
        },
        {
            "authors": [
                "D. Lim\u00f3n",
                "T. Alamo",
                "F. Salas",
                "E.F. Camacho"
            ],
            "title": "On the stability of constrained MPC without terminal constraint",
            "venue": "IEEE transactions on automatic control, vol. 51, no. 5, pp. 832\u2013836, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "W.M. Haddad",
                "V. Chellaboina"
            ],
            "title": "Nonlinear dynamical systems and control",
            "venue": "Nonlinear Dynamical Systems and Control, Princeton university press, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "A.B. Taylor",
                "J.M. Hendrickx",
                "F. Glineur"
            ],
            "title": "Exact worst-case convergence rates of the proximal gradient method for composite convex minimization",
            "venue": "Journal of Optimization Theory and Applications, vol. 178, no. 2, pp. 455\u2013476, 2018.",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n30 5.\n10 08\n5v 2\n[ ee\nss .S\nY ]\n2 0\nN ov\n2 02\n3\n\u00a92023 IEEE. This work has been accepted for publication at the 62nd IEEE Conference on Decision and Control (CDC), Singapore, 2023. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.\nI. INTRODUCTION\nModel Predictive Control (MPC) is one of the most ubiquitous optimal control methods thanks to its capability of handling state and input constraints and providing closedloop performance guarantees [1]. The MPC algorithm relies on solving a constrained optimization problem at each sample time and hence requires a fast enough computational unit to handle it. In many practical examples, a short sampling time, combined with a large-scale optimization problem, can make the method infeasible to operate. This limitation has motivated the development of suboptimal MPC schemes for applications with limited computational capacity, e.g. [2], [3]. With suboptimal methods, at each time step, the optimization problem is solved approximately but continues to conform to certain performance requirements. While many works study the closed-loop stability of such methods, the characterization of transient performance in terms of the incurred cost has not been completely addressed. Such an analysis can be beneficial not only for certifying suboptimality bounds given a limited computational budget but also, as we show here, for designing time-varying MPC schemes, that allocate computational budget adaptively.\nThe closed-loop stability of suboptimal MPC is well studied, e.g. in [2], [4]\u2013[7]. Asymptotic stability is usually\nThis work has been supported by the Swiss National Science Foundation under NCCR Automation (grant agreement 51NF40 180545).\nA. Karapetyan and J. Lygeros are with the Automatic Control Laboratory, ETH Zu\u0308rich, 8092 Zu\u0308rich, Switzerland (E-mails: {akarapetyan, lygeros}@control.ee.ethz.ch).\nE. C. Balta is with Inspire AG, 8005 Zu\u0308rich, Switzerland (E-mail: efe.balta@inspire.ch).\nA. Iannelli is with the Institute for Systems Theory and Automatic Control, University of Stuttgart, Stuttgart 70569, Germany (E-mail: andrea.iannelli@ist.uni-stuttgart.de).\ntion. In [3], the authors derive a lower bound on the number of optimization iterations of a fast gradient method to achieve a certain suboptimality level of the MPC cost, however, the closed-loop stability is not analyzed. Time-distributed optimization [8], [9] or real-time iterative algorithms [10], [11] are examples of another approach that considers the combined system-optimizer dynamics. These methods perform only a finite number of iterations of an optimization problem at each timestep. The asymptotic stability of timedistributed MPC (TD-MPC) is studied in [8] for discretetime non-linear models with state and input constraints, and an explicit form for a Lyapunov function is derived in [11] for the same setting. Discrete-time linear models with a quadratic cost objective (LQMPC) are studied in [9] and a region of attraction (ROA) estimate is derived in [12].\nIn this work, we consider the transient performance of the suboptimal time-distributed optimization for LQMPC. In particular, our contribution is threefold. Firstly, we propose scheduling the number of iterative optimization steps, \u2113k, in advance, and allowing them to be time-varying based on the available computational budget. Building on [11], [12] we derive an explicit form for the rate of decay of the exponentially stable suboptimal dynamics under certain conditions on \u2113k-s. Secondly, we study the transient performance of this scheme by quantifying its incurred suboptimality, which we define as the additional incurred closed-loop cost due to the approximate solution of the optimization problem. Finally, using our new analysis, we propose a diminishing horizon suboptimal MPC algorithm, called Dim-SuMPC, and quantify its finite-time performance. The proposed algorithm maintains the recursive feasibility and stability properties of TD-MPC while decreasing the prediction horizon length at certain switching times. This decrease reduces the problem size and, hence, the time complexity. We provide numerical examples to illustrate the performance of the proposed scheme in terms of both cost and computational time.\nNotation: The set of positive real numbers is denoted by R+, and the set of non-negative integers by N. For a given vector x, its Euclidean norm is denoted by \u2016x\u2016, and the twonorm weighted by some matrix Q \u227b 0 by \u2016x\u2016Q = \u221a\nx\u22a4Qx. For a matrix W \u227b 0 the spectral radius and the spectral norm are denoted by \u03c1(W ), and \u2016W\u2016, respectively. Given M \u227b 0, the \u03bb\u2212M (W ) and \u03bb + M (W ) denote the minimum and maximum eigenvalues of M\u2212 1 2WM\u2212 1 2 , and recall that for any vector x, they satisfy \u03bb\u2212M (W )\u2016x\u20162M \u2264 \u2016x\u20162W \u2264 \u03bb+M (W )\u2016x\u20162M . The projection of a vector x on a nonempty, closed convex set A is denoted by \u03a0A[x] := argminy\u2208A \u2016x\u2212 y\u2016."
        },
        {
            "heading": "II. PROBLEM FORMULATION AND PRELIMINARIES",
            "text": "We consider discrete-time linear time-invariant systems\nxk+1 = Axk +Buk,\nwhere xk \u2208 Rn and uk \u2208 Rm denote the state and control input at time k, respectively, A \u2208 Rn\u00d7n, and B \u2208 Rn\u00d7m. Given an initial state x0, the control objective is to find the sequence of control inputs u = [u\u22a40 . . . u \u22a4 T\u22121] \u22a4 that minimizes the finite-time cost\nJT (x0,u) = \u2016xT \u20162P + T\u22121\u2211\nk=0\n\u2016xk\u20162Q + \u2016uk\u20162R,\nwhere Q \u2208 Rn\u00d7n and R \u2208 Rm\u00d7m are design matrices and P is taken to be the solution of the discrete Algebraic Riccati Equation (DARE), P = Q+K\u22a4RK + (A\u2212BK)\u22a4P (A\u2212 BK), with K = (R + B\u22a4PB)\u22121(B\u22a4PA). In addition to the above optimality requirement, control inputs must satisfy uk \u2208 U for all k > 0 where U \u2286 Rm is a constraint set. We assume the following standard assumptions hold; these ensure that the problem is well posed, similar to [13].\nAssumption 1: (Well-posed problem)\ni. The pair (A,B) is stabilizable, Q \u227b 0, R \u227b 0. ii. The input constraint set U is closed, convex, and con-\ntains the origin.\nAt each timestep 0 \u2264 k < T , the model predictive controller solves the following parametric optimal control problem (POCP)\n\u00b5\u22c6(xk) := argmin \u03bd JN (\u03be0,\u03bd)\ns.t. \u03bei+1 = A\u03bei +B\u03bdi, i=0, . . . , N \u2212 1, \u03be0 = xk, \u03bdi \u2208 U , i=0, . . . , N \u2212 1, (1)\nwhere N is the prediction horizon length, and \u03bd = [\u03bd\u22a40 . . . \u03bd \u22a4 N\u22121] \u22a4 denotes the predicted input vector. The solution to (1) for a given initial state (parameter) x \u2208 Rn, \u00b5\u22c6(x) : Rn \u2192 RNm, is referred to as the optimal mapping. The optimal cost attained by this mapping is denoted by VN (x) := JN (x, \u00b5 \u22c6(x)), and serves as an approximate value function for the problem1.\nFor each k, the first element of \u00b5\u22c6(xk) is applied to the system and the process is repeated in a receding horizon fashion. The optimal state evolution under this optimal MPC policy, starting from some x\u22c60 := x0, is then given by\nx\u22c6k+1 = Ax \u22c6 k +B\u00b5 \u22c6(x\u22c6k) := f(x \u22c6 k), \u2200k \u2265 0, (2)\nwhere , S := [Im\u00d7m 0 . . . 0] \u2208 Rm\u00d7Nm and B := BS. Problem (1) is a parametric quadratic program, and, given a x \u2208 Rn, can be represented in an equivalent condensed form V (x) = min\u03bd\u2208N \u2016(x,\u03bd)\u20162M , with N = UN \u2286 RNm\nM =\n[ W G\u22a4\nG H\n]\n, (3)\nwith H \u2208 RNm\u00d7Nm, W \u2208 RNm\u00d7Nm and, G \u2208 RNm\u00d7n defined in Appendix A.\n1When clear from the context, we drop the explicit dependence of VN (x) on N and use V (x).\nAs computing \u00b5\u22c6(x) may be prohibitive, one can consider suboptimal solutions computed by using a fixed number of optimization iterations. Specifically, given x \u2208 Rn and an input vector \u03bd \u2208 RNm, consider the operator that performs one step of the projected gradient method (PGM)\nT (x,\u03bd) := \u03a0N [\u03bd \u2212 \u03b1\u2207\u03bdJN (x,\u03bd)], (4) where \u03b1 \u2208 R is a step size. Applying (4) iteratively for some \u2113k \u2208 N times, provides an approximation for the optimal input, and hence the optimal policy. The combined dynamics of the system and the optimizer are given by2\nzk = T \u2113k(xk, zk\u22121), (5a) xk+1 = Axk +Bzk, (5b)\nwhere for some l \u2208 N, x \u2208 Rn and \u03bd \u2208 RNm, we define T l(x,\u03bd) = T (x, T l\u22121(x,\u03bd)),\nstarting with T 0(x,\u03bd) = \u03bd. The suboptimal state evolution (5b) is equivalently described by\nxk+1 = Axk +B\u00b5 \u22c6(xk)\n\ufe38 \ufe37\ufe37 \ufe38\nf(xk)\n+Bd(zk, xk), (6)\nwhere d(z, x) := z \u2212 \u00b5\u22c6(x), z \u2208 RNm, x \u2208 Rn, is thought of as a disturbance acting on the optimal dynamics (2), introduced due to suboptimality. We denote the combined system-optimizer state sk := [x \u22a4 k z \u22a4 k ]\n\u22a4 for all k \u2265 0. In this work, we are interested in the transient performance of the closed-loop suboptimal dynamics (6). This is captured in terms of the algorithm\u2019s incurred additional cost due to its approximations, i.e. the incurred suboptimality, defined as\nR(x0; \u2113[0,...,T\u22121]) := JT (x0,u\u2113)\u2212 JT (x0,u\u22c6), (7) where, u\u2113 := [z\u22a40 . . . z \u22a4 T\u22121] \u22a4 denotes the sequence of inputs generated by the suboptimal policy on the suboptimal trajectory generated by (6), and u\u22c6 := [\u00b5\u22c6\u22a4(x0) . . . \u00b5 \u22c6\u22a4 T\u22121(x \u22c6 T\u22121)] \u22a4 the equivalent for the optimal policy and the optimal trajectory generated by (2). Note that R is a function of \u2113k-s which are the main parameters indicating the level of approximation in the policy. Quantifying the transient accumulated suboptimality as a comparative metric due to suboptimal choices with respect to a more powerful benchmark is inspired by online learning, where a similar notion of regret is used, and the suboptimality is due to some uncertainty in the problem rather than limited computational budget. Although the system to be controlled is linear time-invariant, the closed loop systems of interest, (2) and (5), under the optimal and suboptimal policies, respectively, are nonlinear. Hence, our results make use of the standard notion of local exponential stability.\nDefinition 1: Consider a nonlinear autonomous system xk+1 = f(xk) for all k \u2208 N, with f : Rn \u2192 Rn having an equilibrium point x\u0302 = 0. The system is said to be locally exponentially stable with a decay rate of \u03bb \u2208 (0, 1) if there exist \u03b3, c \u2208 R+, such that for all k \u2265 0\n\u2016xk\u2016 \u2264 \u03b3\u2016x0\u2016\u03bbk, \u2200 \u2016x0\u2016 \u2264 c. 2The subscript of \u2113k is dropped when it is taken to be a constant."
        },
        {
            "heading": "III. CLOSED-LOOP PROPERTIES OF MPC",
            "text": ""
        },
        {
            "heading": "A. Optimal MPC",
            "text": "In this subsection we review the properties of the optimal mapping \u00b5\u22c6(x), which are then used for the analysis of the \u201cperturbed\u201d suboptimal dynamics (6). We start with the regularity properties of the optimal mapping.\nLemma 1: [9, Corollary 2] For any x, y \u2208 Rn, the optimal solution mapping, \u00b5\u22c6(x), satisfies\n\u2016\u00b5\u22c6(x) \u2212 \u00b5\u22c6(y)\u2016 \u2264 \u2016H\u2212 12 \u2016\u2016G(x\u2212 y)\u2016H\u22121 \u2264 L\u2016x\u2212 y\u2016, \u3008\u00b5\u22c6(x) \u2212 \u00b5\u22c6(y), G(x\u2212 y)\u3009 \u2264 \u2212\u2016\u00b5\u22c6(x)\u2212 \u00b5\u22c6(y)\u20162H ,\nwith a Lipschitz constant L := \u2016H\u2212 12 \u2016 \u00b7 \u2016H\u2212 12G\u2016. The proof follows from the parametric quadratic program structure of the MPC problem and can be found in [9] or [14] with an explicit MPC point of view.\nAs shown in [12], [15], system (2) is asymptotically stable\nwith the ROA estimate\n\u0393N := {x \u2208 Rn | \u03c8(x) \u2264 rN}, where \u03c8(x) := \u221a\nV (x), d = c \u00b7 \u03bb\u2212(Q)/\u03bb+(P ), rN =\u221a Nd+ c and c > 0 is such that the following set is nonempty\n\u2126 = {x \u2208 Rn | \u2016x\u20162P \u2264 c,\u2212Kx \u2208 U}. Lemma 2: The value function V , is a local Lyapunov function for the optimal closed-loop system (2) with a ROA estimate \u0393N , satisfying\n\u2016x\u20162P \u2264 V (x) \u2264 \u2016x\u20162W (8) V (f(x)) \u2264 \u03b22V (x), (9)\nwith \u03b2 = \u221a\n1\u2212 \u03bb\u2212W (Q) \u2208 (0, 1) . System (2) is then locally exponentially stable in \u0393N with a rate of decay \u03b2.\nProof: The value function of the constrained MPC problem will necessarily attain a cost no less than the optimal infinite horizon unconstrained problem, i.e, for all x \u2208 \u0393N \u2016x\u20162P \u2264 V (x). Using the condensed form of (1)\nV (x) = \u2016x\u20162W + 2\u3008\u00b5\u22c6(x), Gx\u3009 + \u2016\u00b5\u22c6(x)\u20162H \u2264 \u2016x\u20162W \u2212 \u2016\u00b5\u22c6(x)\u20162H \u2264 \u2016x\u20162W ,\nwhere the inequality follows from Lemma 1. For all x \u2208 \u0393N V (f(x))\u2212 V (x) \u2264 \u2212\u2016x\u20162Q \u2264 \u2212\u03bb\u2212W (Q)\u2016x\u20162W ,\ngiven the terminal cost matrix P and quadratic stage costs [13]. Using the upper bound in (8),\nV (f(x)) \u2264 (1\u2212 \u03bb\u2212W (Q))V (x) = \u03b22V (x), where \u03bb\u2212W (Q) \u2208 (0, 1), as W \u227b Q from the structure of the matrices in Appendix A. The function V is then a Lyapunov function with a fixed rate of decay. Hence, by Lyapunov\u2019s direct method, f(x) is locally exponentially stable [16]. In particular, for all x0 \u2208 \u0393N , given (8)\n\u2016x\u22c6k\u2016P \u2264 \u03c8(x\u22c6k) \u2264 \u03b2k\u03c8(x0) =\u21d2\n\u2016x\u22c6k\u2016 \u2264 \u03b2k\u03c8(x0) \u221a \u03bb\u2212(P ) \u2264 \u2016x0\u2016W\u221a \u03bb\u2212(P ) \u00b7 \u03b2k,\nshowing the desired exponential decay rate."
        },
        {
            "heading": "B. Suboptimal MPC",
            "text": "To analyze the suboptimal closed-loop system (6), we look at the combined system-optimizer dynamics (5). The following theorem characterizes the linear convergence rate of PGM.\nTheorem 1: [17, Theorem 3.1] For any x \u2208 Rn, \u03bd \u2208 R\nNm, \u2113 \u2208 N, and for \u03b1 = 1 \u03bb+(H)+\u03bb\u2212(H)\n\u2225 \u2225T \u2113(x,\u03bd)\u2212 \u00b5\u22c6(x) \u2225 \u2225 \u2264 \u03b7\u2113\u2016\u03bd \u2212 \u00b5\u22c6(x)\u2016,\nwhere \u03b7 = (\u03bb+(H)\u2212 \u03bb\u2212(H))/(\u03bb+(H) + \u03bb\u2212(H)). Remark 1: We take the initial \u03bd = 0. The stability of (5) is assessed by analysing the evolution of the suboptimality disturbance d(zk, xk) and \u03c8(xk) over time.\nLemma 3: Given the dynamics (5), for all k \u2265 0, xk \u2208 \u0393N and zk \u2208 N , the following holds\n\u03c8(xk+1) \u2264 \u03b2\u03c8(xk) + \u03c3\u2016d(zk, xk)\u2016, \u2016d(zk+1, xk+1)\u2016 \u2264 \u03b7\u2113k\u03ba\u03c8(xk) + \u03b7\u2113k\u03c9\u2016d(zk, xk)\u2016,\nwhere \u03c9 = 1 + \u2016H\u2212 12 \u2016\u2016H\u221212GB\u2016, \u03c3 = \u2016W 12B\u2016, and \u03ba = \u2016H\u2212 12 \u2016\u2016H\u221212G(A\u2212 I)P\u2212 12 \u2016\n+ \u2016H\u2212 12 \u2016 \u221a\n\u03bb+H(GB)(\u03bb + P (W )\u2212 1).\nThe lemma is a slightly modified version of [12, Lemma 7] with time-varying \u2113k-s. The proof follows directly from the one found in [12]. The following shows the existence of a Lyapunov function for the augmented state sk. Theorem 2: If \u2113k > \u2113 \u22c6 for all k \u2265 0, where\n\u2113\u22c6 = log(1\u2212 \u03b2)\u2212 log(\u03c3\u03ba+ \u03c9(1\u2212 \u03b2))\nlog(\u03b7) ,\nthen the system-optimizer dynamics (5) are asymptotically stable in the forward invariant ROA estimate\n\u03a3N =\n{\n(x, z)\u2208\u0393N\u00d7N | \u03c8(x)\u2264rN ,\n\u2016z \u2212 \u00b5\u22c6(x)\u2016 \u2264 (1\u2212 \u03b2)rN \u03c3\n}\n.\nThe function\nL(x, z) := \u03c8(x) + \u03c4\u2016z \u2212 \u00b5\u22c6(x)\u2016 (10) is a local Lyapunov function for (5), defined in \u03a3N , given \u03c4 satisfies the following inequalities for all k \u2265 0\n(\u03b2 \u2212 1) + \u03c4\u03b7\u2113k\u03ba < 0, \u03c3 + (\u03b7\u2113k\u03c9 \u2212 1)\u03c4 < 0,\n\u03c4 > 0.\n(11)\nFor time-invariant \u2113, the proof for the general case can be found in [11] and for the LQMPC in [12]; the extension to time varying \u2113k-s follows directly. Remark 2: We note that the terms \u03b2, \u03c9, \u03ba, \u03c3 and \u2113\u22c6 depend on N implicitly. We will make this dependence explicit, when unclear from the context.\nThe following result provides a guaranteed rate of decay for the Lyapunov function (10), hence proving exponential stability of the combined dynamics (5).\nTheorem 3: Given the dynamics (5), for all s0 \u2208 \u03a3N , k \u2265 0 and \u2113k > \u2113\u22c6\nL(xk+1, zk+1) \u2264 \u03b5kL(xk, zk), L(x0, z0) \u2264 h0 \u00b7 \u2016x0\u2016W ,\nwith \u03b5k := max{\u03b2 + \u03c4\u03ba\u03b7\u2113k , \u03c3+\u03c4\u03b7 \u2113k\u03c9 \u03c4 } \u2208 (0, 1), \u03b5\u22121 := 1 and h0 = 1 + \u03c4\u03b7 \u21130L\u2016W\u2212 12 \u2016.\nProof: Recalling (10)\nL(xk+1,zk+1) = \u03c8(xk+1)+\u03c4\u2016d(zk+1, xk+1)\u2016\n\u2264(\u03b2+\u03c4\u03b7\u2113k\u03ba) \ufe38 \ufe37\ufe37 \ufe38\n\u03b2k\n\u03c8(xk)+\u03c4\n( \u03c3 + \u03c4\u03b7\u2113k\u03c9\n\u03c4\n)\n\ufe38 \ufe37\ufe37 \ufe38\n\u03b5k\n\u2016d(zk, xk)\u2016\n\u2264 max{\u03b2k, \u03b5k} \ufe38 \ufe37\ufe37 \ufe38\n:=\u03b5k\n(\u03c8(xk) + \u03c4\u2016d(zk, xk)\u2016)\n= max{\u03b2k, \u03b5k}L(xk, zk), where the equalities follow from the definition of the Lyapunov function and the first inequality follows from Lemma 3. Note that \u03b5k \u2208 (0, 1) as \u03c4 satisfies (11) for all k \u2265 0. For the second bound, consider\nL(x0, z0) = \u03c8(x0) + \u03c4\u2016z0 \u2212 \u00b5\u22c6(x0)\u2016 \u2264 \u2016x0\u2016W + \u03c4\u2016T \u21130(x0,0)\u2212 \u00b5\u22c6(x0)\u2016 \u2264 \u2016x0\u2016W + \u03c4\u03b7\u21130\u2016\u00b5\u22c6(x0)\u2016 \u2264 \u2016x0\u2016W ( 1 + \u03c4\u03b7\u21130L\u2016W\u2212 12 \u2016 ) ,\nwhere the first inequality follows from Lemma 2 and (5a), the second from Theorem 1 and the third from Lemma 1.\nThe following corollary follows directly from the above theorem for a fixed \u2113 > \u2113\u22c6. Corollary 1: Given the dynamics (5), for all \u2113 > \u2113\u22c6, s0 \u2208 \u03a3N and k \u2265 0 L(xk+1, zk+1) \u2264 \u03b5L(xk, zk),\nwhere L is defined in (10) and \u03b5 := max{\u03b2 + \u03c4\u03ba\u03b7\u2113, \u03c3+\u03c4\u03b7\n\u2113\u03c9 \u03c4 } \u2208 (0, 1).\nWhile the exponential stability of suboptimal MPC has been pointed out in [11], its rate of decay has not been explicitly derived. The above results define this rate, which becomes the main tool used for the finite-time analysis of the algorithm in the next section."
        },
        {
            "heading": "IV. FINITE-TIME ANALYSIS",
            "text": "The exponential stability of the combined dynamics (5) allows one to study the finite-time performance of the suboptimal LQMPC. In this section, we quantify the incurred suboptimality (7) of suboptimal dynamics (5) both for varying and for fixed number of optimization iterations \u2113. Before proceeding with the suboptimality analysis we introduce some auxiliary lemmas.\nLemma 4: Given the dynamics (5), for all s0 \u2208 \u03a3N , k \u2265 0 and \u2113k > \u2113 \u22c6\n\u2016\u2206\u00b5k\u2016 := \u2016zk\u2212\u00b5\u22c6(x\u22c6k)\u2016 \u2264 b0\u2016x0\u2016W k\u22121\u220f\ni=\u22121\n\u03b5i+ c\u2016x0\u2016W\u03b2k,\nwhere c = max{\u03c4\u22121, \u2016H\u2212 12 \u2016\u2016H\u2212 12GP\u2212 12 \u2016}, b0=c\u00b7h0 and h0 is defined as in Theorem 3.\nProof: The proof follows by showing that \u2016\u2206\u00b5k\u2016 is upper bounded by the the sum of two Lyapunov functions and enjoys the same rate of decay as those. In particular, for any k \u2265 0 and sk \u2208 \u03a3N \u2016\u2206\u00b5k\u2016 = \u2016zk \u2212 \u00b5\u22c6(xk) + \u00b5\u22c6(xk)\u2212 \u00b5\u22c6(x\u22c6k)\u2016\n\u2264 \u2016zk \u2212 \u00b5\u22c6(xk)\u2016 + \u2016\u00b5\u22c6(xk)\u2212 \u00b5\u22c6(x\u22c6k)\u2016 \u2264 \u03c4\u22121\u03c4\u2016d(zk, xk)\u2016 + \u2016H\u2212 1 2 \u2016\u2016H\u2212 12G(xk \u2212 x\u22c6k)\u2016 \u2264 \u03c4\u22121\u03c4\u2016d(zk, xk)\u2016 + \u2016H\u2212 12 \u2016\u2016H\u2212 12GP\u2212 12 \u2016(\u2016xk\u2016P + \u2016x\u22c6k\u2016P )\n\u2264 c\n\n \u03c4\u2016d(zk, xk)\u2016+ \u2016xk\u2016P \ufe38 \ufe37\ufe37 \ufe38\n:=l(xk,zk)\n+ \u2016x\u22c6k\u2016P \ufe38 \ufe37\ufe37 \ufe38\n:=g(x\u22c6 k )\n\n  ,\nwhere the first and third inequalities make use of the triangle inequality, and the second one follows from Lemma 1. From Lemma 2 and (10), we note that l(xk, zk) \u2264 L(xk, zk) and g(x\u22c6k) \u2264 \u03c8(x\u22c6k), and it holds that\n\u2016\u2206\u00b5k\u2016 \u2264 c (L(xk, zk) + \u03c8(x\u22c6k)) . The result follows by a repeated application of (9) and (12).\nFor a fixed \u2113 > \u2113\u22c6 the following corollary follows. Corollary 2: Given the dynamics (5), for all \u2113 > \u2113\u22c6, s0 \u2208\n\u03a3N and k \u2265 0 \u2016\u2206\u00b5k\u2016 \u2264 b\u2016x0\u2016W \u03b5k + c\u2016x0\u2016W\u03b2k,\nwhere h = 1 + \u03c4\u03b7\u2113L\u2016W\u2212 12 \u2016 and b = c \u00b7 h. Next, we show that the exponential stability of the combined system-optimizer dynamics (5) implies the same rate for the state, xk , in the ROA estimate \u0393N . Lemma 5: Given the dynamics (5), for all s0 \u2208 \u03a3N , k \u2265 0 and \u2113k > \u2113 \u22c6\n\u2016xk\u2016 \u2264 h0\u2016P\u2212 1 2 \u2016 \u00b7 \u2016x0\u2016W\nk\u220f\ni=\u22121\n\u03b5i,\nwhere h0 is defined as in Theorem 3. Proof: From Theorem 2, \u03a3N is a forward invariant ROA estimate for the suboptimal dynamics. Hence from Lemma 2 we have that for all s0 \u2208 \u03a3N \u2016xk\u2016P \u2264 \u03c8(xk) + \u03c4\u2016zk \u2212 \u00b5\u22c6(xk)\u2016 = L(xk, zk),\nand\n\u2016xk\u2016 \u2264 \u2016P\u2212 1 2 \u2016L(x0, z0)\nk\u220f\ni=\u22121\n\u03b5i\u2264 h0\u2016P\u2212 1 2 \u2016\u2016x0\u2016W\nk\u220f\ni=\u22121\n\u03b5i,\nwhere we use the submultiplicative property of norms and Theorem 3.\nCorollary 3: Given the dynamics (5), for all \u2113 > \u2113\u22c6, s0 \u2208 \u03a3N and k \u2265 0\n\u2016xk\u2016 \u2264 h\u2016P\u2212 1 2 \u2016 \u00b7 \u2016x0\u2016W \u00b7 \u03b5k,\nwhere h is defined as in Corollary 2.\nA. Incurred Suboptimality\nThe incurred suboptimality of the suboptimal dynamics\n(5) can be bounded using the bounds in Lemmas 4 and 5.\nTheorem 4: Given the dynamics (5), for all s0 \u2208 \u03a3N , k \u2265 0 and \u2113k > \u2113\u22c6, its incurred suboptimality is bounded by\nR(x0; \u2113[0,...,T\u22121]) \u2264 c\u2016x0\u20162W \u00b7 T\u2211\nk=0\nk\u220f\ni=0\n\u03b52i\u22121 \u2264 c\u2016x0\u20162W 1\u2212 \u03b52 ,\nwhere\nc = max{\u2016R\u2016 (b0 + c) ( (b0 + c) + 2L \u221a\n\u03bb\u2212(P )\n)\n,\n\u2016Q\u2016 \u00b7 ( \u2016P\u2212 12 \u20162h20 + 1\n\u03bb\u2212(P )\n)\n},\nR = S\u22a4RS, \u2016Q\u2016 = max{\u2016Q\u2016, \u2016P\u2016} and \u03b5 := max{\u03b2 + \u03c4\u03b7\u2113\u03ba, \u03c3+\u03c4\u03b7\n\u2113\u03c9 \u03c4 } with \u2113 = mink{\u2113k}T\u22121k=0 .\nProof: Using the quadratic form of the cost, expanding the squares, collecting the terms, and using the submultiplicative property of the norms, it can be shown that the incurred suboptimality (7) attains the following upper bound\nR(x0, \u2113[0,...,T\u22121]) \u2264 T\u2211\nk=0\n\u2016xk\u20162Q + \u2016x \u22c6 k\u20162Q\n\ufe38 \ufe37\ufe37 \ufe38 :=s1\n+ T\u22121\u2211\nk=0\n\u2016\u2206\u00b5k\u20162R + 2\u2016\u2206\u00b5k\u2016\u2016\u00b5 \u22c6(x\u22c6k)\u2016\u00b7\u2016R\u2016\n\ufe38 \ufe37\ufe37 \ufe38 :=s2\n,\nwhere \u2206\u00b5k is defined as in Lemma 4. First, we bound the term due to the input difference\ns2 \u2264 \u2016R\u2016 T\u22121\u2211\nk=0\n\u2016 ( \u2206\u00b5k\u20162 + 2L\u2016\u2206\u00b5k\u2016\u2016x\u22c6k\u2016 )\n\u2264 \u2016R\u2016 T\u22121\u2211\nk=0\n(\n\u2016\u2206\u00b5k\u20162 + 2 L\u03b2k\u2016x0\u2016W \u221a\n\u03bb\u2212(P ) \u2016\u2206\u00b5k\u2016\n)\n\u2264 \u2016R\u2016\u2016x0\u20162W\n(\n(b0 + c) 2 + 2L (b0 + c) \u221a\n\u03bb\u2212(P )\n)\n\u00b7 T\u2211\nk=0\nk\u22121\u220f\ni=\u22121\n\u03b52i ,\nwhere the first inequality follows from Lemma 1, the second from Lemma 2 and the third from Lemma 4, and the fact that \u03b2 < \u03b5k for all k \u2265 0. Using the latter fact and the bounds in Lemmas 2 and 5, it follows that\ns1 \u2264 \u2016Q\u2016 \u00b7 \u2016x0\u20162W ( \u2016P\u2212 12 \u20162h20 + 1\n\u03bb\u2212(P )\n) T\u2211\nk=0\nk\u22121\u220f\ni=\u22121\n\u03b52i .\nThe intermediate bound follows by combining the above two bounds for s1 and s2. The finite upper bound follows from geometric series with the appropriate definition of \u03b5.\nFor a constant number of optimization iterations per\ntimestep, the following corollary follows.\nCorollary 4: Given the dynamics (6), for all \u2113 > \u2113\u22c6, s0 \u2208 \u03a3N and k \u2265 0, its incurred suboptimality is bounded by\nR(x0; \u2113) < c\u2016x0\u20162W 1\u2212 \u03b52 ,\nwhere c is given in Theorem 4 and \u03b5 := max{\u03b2 + \u03c4\u03ba\u03b7\u2113, \u03c3+\u03c4\u03b7\n\u2113\u03c9 \u03c4 } \u2208 (0, 1).\nTo the best of our knowledge this is the first analysis that explicitly characterises the incurred suboptimality of suboptimal LQMPC in terms of the closed-loop cost. While the bounds are conservative due to the lack of further assumptions on the system, these results can motivate the design of time-varying suboptimal MPC schemes for applications with limited computational budget. In the next section, we present an example of such an algorithm."
        },
        {
            "heading": "V. DIM-SUMPC",
            "text": "The finite-time analysis in the previous section motivates the development of a novel MPC algorithm with a diminishing horizon length. The aim of the proposed method is to maintain the asymptotic and finite-time properties of existing suboptimal MPC methods while reducing the time required to solve the problem. In particular, the novel algorithm reduces the prediction horizon length N of the suboptimal LQMPC a pre-defined p \u2208 N number of times. This is a design parameter which can be set depending on the available computational budget. For each p, we define a sequence {Nj}pj=0, such that, N0 := N defined in Section II and Nj\u22121 > Nj for all 1 \u2264 j \u2264 p. The following lemma provides the number of timesteps required to transition from a forward invariant ROA estimate defined for Nj\u22121 to a smaller one, defined for Nj .\nLemma 6: Given the dynamics (5), if for any 1 \u2264 j \u2264 p, it holds that Nj\u22121 > Nj and \u2113 > \u2113\n\u22c6(Nj), then for all s0 \u2208 \u03a3Nj\u22121 and k \u2265 kj , where kj= log ( \u03bb\u2212Wj\u22121 (P ) (Njd+ c) ) \u2212 2 log ( h(Nj)\u2016x0\u2016Wj\u22121 )\n2 log(\u03b5) ,\n(13)\nand Wj :=W (Nj), the following holds\nVNj (xk) \u2264 Njd+ c. (14) Proof: As \u03a3Nj\u22121 is a forward invariant region for the\nsuboptimal dynamics (5), it follows from Lemma 2 that\nVNj\u22121(xk) \u2264 \u2016xk\u20162Wj\u22121 .\nThen, from Corollary 3 \u221a\n\u03bb\u2212Wj\u22121 (P )\u2016xk\u2016Wj\u22121 \u2264 \u2016xk\u2016P \u2264 \u03b5 kh(Nj\u22121)\u2016x0\u2016Wj\u22121 .\nBy noting from the principle of optimality that VNj (xk) \u2264 VNj\u22121(xk), the following is then sufficient to have the inequality in (14) hold for all 1 \u2264 j \u2264 p\n\u03b5k \u00b7 h(Nj\u22121) \u00b7 \u2016x0\u2016Wj\u22121\u221a \u03bb\u2212Wj\u22121 (P ) \u2264 \u221a Njd+ c.\nThis is equivalent to the condition k \u2265 log ( \u03bb\u2212Wj\u22121 (P ) (Njd+ c) ) \u22122 log ( h(Nj\u22121)\u2016x0\u2016Wj\u22121 )\n2 log(\u03b5) .\nFrom the above lemma, it follows that, for example, after k = k1 steps of suboptimal dynamics evolution with \u2113 > \u2113\u22c6(N0) updates, the state xk1 will be in a new ROA estimate, \u0393N1 = {x \u2208 Rn : VN1(x) \u2264 N1d + c}. At this point, the MPC problem (1) can be redefined with the new horizon length N1 < N0 and it can be solved to optimality from that point on if the computational power allows so. This can then be repeated for all j. Note that the computational effort to solve for \u00b5\u22c6Nj is strictly less than that for the original optimal problem since N > Nj for all j. In this new region, the redefined MPC with the reduced horizon length can be solved also suboptimally. In particular, it follows from Theorem 2 and Corollary 1 that for each j = 1, . . . , p and Nj if \u2113 > \u2113\u22c6(Nj), the suboptimal dynamics are exponentially stable in the corresponding ROA estimate \u03a3Nj . This motivates our proposed diminishing horizon suboptimal MPC scheme, Dim-SuMPC, outlined in Algorithm 1.\nDimSuMPC maintains the recursive feasibility property of TD-MPC since the updates on the prediction horizon, from some Nj\u22121 to Nj are such that the state always remains within a corresponding ROA estimate \u0393Nj . Thus, while the regulation/tracking performance of the two schemes is expected to be comparable, the computational time of DimSuMPC is expected to be lower, as demonstrated on a numerical example in the next section.\nAlgorithm 1 Dim-SuMPC\n1: Fix the sequence {Nj}pj=0 and set j = 0 2: Calculate {kj}pj=1, according to (13) 3: Take any s0 = [x \u22a4 0 z \u22a4 0 ]\n\u22a4 \u2208 \u03a3N0 4: for k = 0, . . . , T \u2212 1 do 5: if k \u2265 kj+1 then 6: j \u2190 j + 1 7: end if 8: Set \u2113k > \u2113 \u22c6(Nj) and compute zk according to (5a)\n9: Apply uk = Szk and get xk+1 according to (5b) 10: end for\nGuidelines on how to choose a valid initial point in step 2 of the algorithm are outlined in [12]. The parameter p and the horizon length sequence are design parameters and can be chosen in advance based on the capacity of the available budget. The incurred suboptimality of the algorithm is bounded in the following theorem.\nTheorem 5: The incurred suboptimality of the Dim-\nSuMPC algorithm is bounded by\nR(x0, \u2113[0,...,T ]) \u2264 cm\u2016x0\u20162W0 1\u2212 \u03b5 \u00b7 p \u2211\nj=0\n\u03b5 2kj kj\nj \u220f\ni=1\ndi,\nwhere k0 = 0, di := h 2(Ni)\u03bb +(Wi)\u2016P\u2212 1 2 \u20162, cm := maxj c(Nj), h := maxj h(Nj) and \u03b5 := maxj \u03b5kj . Proof: It follows from the result in Theorem 4\nR(x0, \u2113[0,...,T ]) \u2264 cm\n1\u2212 \u03b5\np \u2211\nj=0\n\u2016xkj\u20162Wj .\nThen, using the bound in Corollary 3, for all j = 1, . . . , p\n\u2016xkj\u20162Wj \u2264 h2(Nj)\u03bb +(Wj)\u2016P\u2212 1 2 \u20162\u2016xkj\u22121\u20162Wj\u22121\u03b5 2(kj\u2212kj\u22121) kj .\nThe result follows by repeated application of the above.\nNote that the above bound is finite since p is finite and the state remains in a forward invariant ROA set at all times."
        },
        {
            "heading": "VI. NUMERICAL EXAMPLES",
            "text": "In this section, we consider the following linearised,\ncontinuous-time model of an inverted pendulum from [12]\nAc = [ 0 1 3g 2L 0 ] , Bc = [ 0 3 mbL2 ] ,\nwhere the state is x = [\u03b8, \u03b8\u0307]\u22a4, \u03b8 is the angle relative to the unstable equilibrium position and the control input is the applied torque. The parameters are taken to be the same as in [12] with L = 1, mb = 0.1 and g = 9.81. We consider the control of the discretized model of the plant with a sampling time of Ts = 0.1. The input constraint set is taken to be U = [\u22121, 1], the cost matrices are Q = I2, and R = 1 and the initial state is x0 = [\u2212\u03c0/4 \u03c0/5]\u22a4. We demonstrate the performance of DimSuMPC for this setting, over a control horizon of length T = 150. In the first example, we perform p = 3 switches at times k1 = 15, k2 = 25 and k3 = 40, sequentially decreasing the prediction horizon length from the initial N = 15 to, respectively, N1 = 10, N2 = 8 and N3 = 2. We let the number of optimization iterations to be fixed at \u2113 = 5000 (for both TD-MPC and DimSuMPC) to assess the effect of the diminishing horizon length. Note that \u2113\u22c6(N) and the switching times kj-s from Lemma 6 are overconservative in practice, and we use smaller values in the examples. Figure 1 compares the closed-loop performance of the optimal MPC with that of TD-MPC and DimSuMPC. As can be seen in the bottom left plot, the proposed scheme\nshows a comparable convergence performance to TD-MPC and even suffers a lower incurred suboptimality. As the problem size becomes smaller, the decrease in computational time of DimSuMPC can be clearly observed at the switching times, marked by gray vertical lines on the right side figure. This saved time allows one to perform more iterative updates \u2113. To demonstrate this, consider a second example where only a finite computational budget is available that allows the execution of TD-MPC with N = 15 and \u2113 = 5000. Figure 2 demonstrates how DimSuMPC can achieve better convergence using (roughly) the same computational power by changing at k1 to new parameters N1 = 2 and \u2113 = 6500. In other words, decreasing N allows for an increase in \u2113 resulting in a potentially improved performance while staying within the same computational budget. In both examples, the computation time is measured by taking the average of 200 runs of the same experiment using the tic/toc command in MATLAB."
        },
        {
            "heading": "VII. CONCLUSIONS",
            "text": "We establish an explicit expression for the rate of convergence of a closed-loop system under a suboptimal implementation of the LQMPC algorithm subject to input constraints, where only a finite number of iterative optimization steps are performed using the projected gradient descent method. The bound is used to provide finite-time performance guarantees of the scheme in terms of the additional cost incurred due to suboptimality. A novel diminishing horizon suboptimal MPC algorithm is then proposed that operates by decreasing the prediction horizon length at certain switching times and thus reduces computational complexity. Possible directions for future research include a deeper analysis of the proposed suboptimal scheme and the derivation of less conservative bounds for the incurred suboptimality by exploring the properties of optimal MPC.\nAPPENDIX"
        },
        {
            "heading": "A. System Matrices for the POCP Problem",
            "text": "As also shown in [9], the matrices in (3) are given by H = B\u0302\u22a4H\u0302B\u0302+(IN \u2297R), G = B\u0302\u22a4H\u0302A\u0302,W = Q+ A\u0302\u22a4H\u0302A\u0302,\nH\u0302 =\n[ (IN \u2297Q) 0\n0 P\n]\n,\nB\u0302 =\n\n   \n0 0 0 B 0 0 ... . . . ... AN\u22121B \u00b7 \u00b7 \u00b7 B\n\n    , and A\u0302 =\n\n    I A ...\nAN\n\n    ."
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "The authors thank Dominic Liao-McPherson for fruitful\ninsights and discussions on the topic."
        }
    ],
    "title": "On the Finite-Time Behavior of Suboptimal Linear Model Predictive Control",
    "year": 2023
}