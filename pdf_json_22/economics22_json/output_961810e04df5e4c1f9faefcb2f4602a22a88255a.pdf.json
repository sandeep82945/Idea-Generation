{
    "abstractText": "Correlations between socioeconomic factors and poverty in regression models do not reflect actual relationships, especially when data exhibit patterns of spatial heterogeneity. Spatial regression models can estimate the relationships between socioeconomic factors and poverty in defined geographical areas, explaining the imbalanced distribution of poverty, but the relationships between these factors and poverty are not always linear however, and conventional simple linear local regression models do not accurately capture these nonlinear relationships. To fill this gap, we used a local regression method, geographically weighted random forest regression (GW-RFR), that integrates a spatial weight matrix (SWM) and random forest (RF). The GW-RFR evaluates the spatial variations in the nonlinear relationships between variables. A county-level poverty data set of China was employed to estimate the performance of the GW-RFR against the random forest (RF). In this poverty application, the value of R was 0.128 higher than that of the RF, the NRMSE value was 1.6% lower than the RF, and the MAE value was 0.295 lower than the RF. These results showed that the relationship between poverty factors and poverty varies with space at the county level in China, and the GW-RFR was suitable for dealing with nonlinear relationships in local regression analysis.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yaowen Luo1 \u00b7 Jianguo Yan"
        },
        {
            "affiliations": [],
            "name": "Stephen C. McClure2 \u00b7 Fei Li"
        }
    ],
    "id": "SP:302eebbd3099bc673026dec190de19db531670a8",
    "references": [
        {
            "authors": [
                "O. Akcay",
                "Avsar",
                "E. O"
            ],
            "title": "Assessment of segmentation",
            "year": 2018
        },
        {
            "authors": [
                "M.M. Ardestani",
                "X Zhang"
            ],
            "title": "Human lower extremity",
            "venue": "1016/J. CSDA",
            "year": 2007
        },
        {
            "authors": [
                "EB Barbier",
                "JP Hochard"
            ],
            "title": "Poverty, rural population distribution",
            "venue": "doi. org/ 10. 1016/J. ESWA",
            "year": 2013
        },
        {
            "authors": [
                "G. Cai",
                "H Ren"
            ],
            "title": "Detailed urban land use land cover",
            "year": 1996
        },
        {
            "authors": [
                "H. Cai",
                "Lam",
                "N.S. N"
            ],
            "title": "A synthesis of disaster resilience",
            "year": 2018
        },
        {
            "authors": [
                "IJDRR."
            ],
            "title": "07",
            "venue": "015",
            "year": 2018
        },
        {
            "authors": [
                "K Decancq",
                "M Fleurbaey"
            ],
            "title": "Multidimensional poverty measurement with individual preferences",
            "venue": "Journal of Economic Inequality",
            "year": 2019
        },
        {
            "authors": [
                "P.R.L. Dutilleul"
            ],
            "title": "Spatio-temporal heterogeneity: concepts and analyses",
            "year": 2011
        },
        {
            "authors": [
                "A.S. Fotheringham",
                "C Brunsdon"
            ],
            "title": "Geographically weighted regression: the analysis of spatially varying relationships",
            "year": 2002
        },
        {
            "authors": [
                "A. Galli",
                "J Kitzes"
            ],
            "title": "Assessing the global environmental consequences of economic growth through the ecological footprint: a focus on China and India",
            "venue": "ecological indicators,",
            "year": 2012
        },
        {
            "authors": [
                "S. Georganos",
                "T Grippa"
            ],
            "title": "Geographical random forests: a spatial extension of the random forest algorithm to address spatial heterogeneity in remote sensing and population",
            "venue": "modelling. geocarto international,",
            "year": 2019
        },
        {
            "authors": [
                "X. Hu",
                "Waller",
                "L. A"
            ],
            "title": "Estimating ground-level PM(sub",
            "year": 2014
        },
        {
            "authors": [
                "J. Huang",
                "Y Huang"
            ],
            "title": "Geographically weighted regres",
            "year": 2015
        },
        {
            "authors": [
                "AMAN."
            ],
            "title": "10",
            "venue": "007 Ishwaran, H. (2007). Variable importance in binary regression trees and",
            "year": 2014
        },
        {
            "authors": [
                "K. Kaczmarczyk",
                "A Wit"
            ],
            "title": "Gait classification",
            "year": 2009
        },
        {
            "authors": [
                "S. 010 Ke",
                "X.U. Zhongmin"
            ],
            "title": "The impacts of human driving",
            "year": 2016
        },
        {
            "authors": [
                "P. Kontschieder",
                "Bulo",
                "S. R"
            ],
            "title": "Structured class-labels in random forests for semantic image labelling",
            "venue": "Paper presented at the International Conference on Computer Vision",
            "year": 2011
        },
        {
            "authors": [
                "L. Li",
                "S Chen"
            ],
            "title": "Prediction of plant transpiration from environmental parameters and relative leaf area index using the random forest regression algorithm. journal of cleaner production, 261",
            "venue": "doi:https:// doi. org/ 10. 1016/J. JCLEP RO",
            "year": 2020
        },
        {
            "authors": [
                "T. Li",
                "X Cao"
            ],
            "title": "Exploring the spatial determinants of rural poverty in the interprovincial border areas of the loess plateau in China: a village-level analysis using geographically weighted regression. isprs international journal of geo information, 9(6)",
            "venue": "doi:https:// doi",
            "year": 2020
        },
        {
            "authors": [
                "Y Li",
                "B Su"
            ],
            "title": "Realizing targeted poverty alleviation in China: people\u2019s voices, implementation challenges and policy implications. China Agricultural Economic Review 8(3):443\u2013454",
            "venue": "https:// doi",
            "year": 2016
        },
        {
            "authors": [
                "Y. Li",
                "C Zou"
            ],
            "title": "Random forest regression for online capacity estimation of lithium-ion batteries",
            "venue": "applied energy,",
            "year": 2018
        },
        {
            "authors": [
                "D. Liu",
                "Z Fan"
            ],
            "title": "Random forest regression evaluation model of regional flood disaster resilience based on the whale optimization algorithm. journal of cleaner production, 250. doi:https:// doi",
            "venue": "org/ 10. 1016/J. JCLEP RO",
            "year": 2020
        },
        {
            "authors": [
                "M Liu",
                "S Hu"
            ],
            "title": "Using multiple linear regression and random forests to identify spatial poverty determinants in rural China. Spatial Statistics 42:100461",
            "venue": "https:// doi. org/ 10. 1016/j. spasta",
            "year": 2020
        },
        {
            "authors": [
                "Y. Liu",
                "Shih",
                "S.-M"
            ],
            "title": "Lower extremity joint torque predicted by using artificial neural network during vertical jump",
            "venue": "journal of biomechanics,",
            "year": 2009
        },
        {
            "authors": [
                "Y Liu",
                "Y Xu"
            ],
            "title": "2016) A geographic identification of multidimensional poverty in rural China under the framework of sustainable livelihoods analysis",
            "venue": "Appl Geogr 73:62\u201376. https:// doi. org/ 10",
            "year": 2016
        },
        {
            "authors": [
                "Y Liu",
                "Y Zhou"
            ],
            "title": "Regional differentiation characteristics of rural poverty and targeted poverty alleviation strategy in China",
            "year": 2016
        },
        {
            "authors": [
                "Y Luo",
                "J Yan"
            ],
            "title": "Distribution of the environmental and socioeconomic risk factors on COVID-19 death rate across continental USA: a spatial nonlinear analysis",
            "venue": "Environ Sci Pollut Res",
            "year": 2021
        },
        {
            "authors": [
                "A. Maiti",
                "Q Zhang"
            ],
            "title": "Exploring spatiotemporal effects of the driving factors on COVID-19 incidences in the contiguous United States",
            "year": 2021
        },
        {
            "authors": [
                "H.J. Miller"
            ],
            "title": "Tobler's first Law and spatial analysis. annals of the association of american geographers",
            "venue": "doi:https:// doi. org/",
            "year": 2004
        },
        {
            "authors": [
                "L.L. Nathans",
                "Oswald",
                "F. L"
            ],
            "title": "Interpreting multiple linear regression: a guidebook of variable importance",
            "venue": "practical assessment research and evaluation,",
            "year": 2012
        },
        {
            "authors": [
                "T Niu",
                "Y Chen"
            ],
            "title": "Measuring urban poverty using multisource data and a random forest algorithm: a case study in Guangzhou",
            "venue": "Sustain Cities Soc 54:102014",
            "year": 2020
        },
        {
            "authors": [
                "M.H. 102014 Pesaran"
            ],
            "title": "Time series and panel",
            "year": 2015
        },
        {
            "authors": [
                "J. 1\u201313. Sheng",
                "X Han"
            ],
            "title": "Spatially varying patterns of affor",
            "year": 2017
        },
        {
            "authors": [
                "RO."
            ],
            "title": "06",
            "venue": "055 Strobl, C., Boulesteix, A.-L., et al. (2008). Conditional variable impor-",
            "year": 2016
        },
        {
            "authors": [
                "C. Strobl",
                "Boulesteix",
                "A.-L"
            ],
            "title": "Bias in random forest",
            "venue": "doi:https:// doi",
            "year": 2007
        },
        {
            "authors": [
                "A. Sumner",
                "C Hoy"
            ],
            "title": "Estimates of the Impact of COVID",
            "year": 2020
        },
        {
            "authors": [
                "Y. Research. Tian",
                "Z Wang"
            ],
            "title": "A geographical analysis of the poverty",
            "year": 2018
        },
        {
            "authors": [
                "R. W"
            ],
            "title": "A computer movie simulating urban growth",
            "venue": "doi:https:// doi",
            "year": 1970
        },
        {
            "authors": [
                "X Tong",
                "JH Kim"
            ],
            "title": "Concentration or diffusion? Exploring the emerging spatial dynamics of poverty distribution in Southern California. Cities 85:15\u201324",
            "year": 2019
        },
        {
            "authors": [
                "Vries",
                "W.H.K. d",
                "Veeger",
                "H.E. J"
            ],
            "title": "Can shoulder joint",
            "year": 2016
        },
        {
            "authors": [
                "ECH."
            ],
            "title": "11",
            "venue": "019 Wang, W.-c., Chau, K.-w., et al. (2015). Improving forecasting accu-",
            "year": 2015
        },
        {
            "authors": [
                "Y. Wang",
                "L Kang"
            ],
            "title": "Estimating The environmental",
            "venue": "doi:https:// doi. org/ 10. 1016/J. ENVRES",
            "year": 2015
        },
        {
            "authors": [
                "RO."
            ],
            "title": "121089 Yaseen, Z",
            "venue": "M., Sulaiman, S. O., et al. (2019). An enhanced extreme",
            "year": 2020
        },
        {
            "authors": [
                "OL."
            ],
            "title": "11",
            "venue": "069 Yu, F. W., Ho, W. T., et al. (2017). Critique of operating variables importance on chiller energy performance using random forest. energy and buildings, 139, 653\u2013664. doi:https://",
            "year": 2018
        },
        {
            "authors": [
                "R. zandi",
                "M Zanganeh"
            ],
            "title": "Zoning and spatial analysis of poverty in urban areas (Case Study: Sabzevar City-Iran)",
            "venue": "Journal of Urban Management 8(3):342\u2013354. https:// doi. org/",
            "year": 2019
        },
        {
            "authors": [
                "W. Zhang",
                "L Jiang"
            ],
            "title": "Effects of urbanization on airport CO2 emissions: a geographically weighted approach using nighttime light data in China. resources conservation and recycling, 150. doi:https:// doi",
            "venue": "org/ 10. 1016/J. RESCO NREC",
            "year": 2019
        },
        {
            "authors": [
                "Y Zhou",
                "YR Li"
            ],
            "title": "The nexus between regional eco-environmental degradation and rural impoverishment in China. Habitat Int 96:15",
            "venue": "https:// doi. org/ 10. 1016/j. habit atint",
            "year": 2020
        },
        {
            "authors": [
                "Y. Zhu",
                "W Xu"
            ],
            "title": "Random forest enhancement using improved artificial fish swarm for the medial knee contact force prediction. artificial intelligence",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Vol.:(0123456789)\nKeywords Poverty\u00a0\u00b7 Spatial variation\u00a0\u00b7 Nonlinear\u00a0\u00b7 Variable importance\u00a0\u00b7 Random forest"
        },
        {
            "heading": "Introduction",
            "text": "Eradicating poverty is one of the sustainable development goals (SDG) of the United Nations. More than 700 million people (ten percent of the world\u2019s population) live in extreme poverty by now. The COVID-19 crisis posed a huge challenge to global economic and social development, especially for developing countries, which could push half a billion people into poverty (Sumner et\u00a0al. 2020). Previous studies (M. Liu et\u00a0al. 2020; Tong et\u00a0al. 2019; Zandi\net\u00a0al. 2019) showed the spatial distribution of poverty and its driver factors including environmental and socio-economic factors, etc. are uneven. Thus, the spatial visualization of poverty and the geographical difference in the relationship between poverty and multidimensional factors are helpful to understand the spatial distribution pattern of poverty, so as to help policy-makers to formulate precise poverty alleviation measures.\nA sorting of independent (predictor) variables according to their degree of correlation with the dependent (response) variable reveals variable importance, relevant in many research fields, such as medical genetics, ecology, and the humanities. The results from variable importance analysis support research related to prediction, theory testing, and explanation (Tonidandel et\u00a0al. 2011). Estimating the variable importance of poverty factors can reflect the relative importance of these factors to poverty, which is important for a better understanding of the nature of poverty. Some statistical models are frequently used to estimate variable importance in the social sciences (Nathans et\u00a0al. 2012), such as multivariate linear regression (MLR) analysis and principal component regression (PCR). In scenarios with a limited Responsible editor Philippe Garrigues. * Jianguo Yan jgyan@whu.edu.cn * Fei Li fli@whu.edu.cn 1 Chinese Antarctic Center of\u00a0Surveying and\u00a0Mapping, Wuhan University, Wuhan\u00a0430070, China\n2 State Key Laboratory of\u00a0Information Engineering in\u00a0Surveying, Mapping and\u00a0Remote Sensing, Wuhan University, Wuhan\u00a0430070, China\n1 3\nset of independent variables, the selection of variables and setting their weights is easier but often complicated by nonlinear relationships between the independent variables and a dependent variable. Thus the conventional regression models that often perform well in dealing with linear regression are not suitable when nonlinear relationships exist between independent and dependent variables.\nMany methods, such as machine learning (ML), have been developed in recent years to solve both linear and nonlinear problem in regression analysis. A set of ML methods can be used for regression analysis to generalize a nonlinear relationship between variables and is applied in data mining in regression (Vries et\u00a0al. 2016) and classification (Kaczmarczyk et\u00a0al. 2009; Liu et\u00a0al. 2009) tasks. Given a set of independent and dependent variables, a trained model will generalize the interactions between the variables and predict the associated dependent variables using a new set of independent variables (Zhu et\u00a0al. 2020). One of the ML is artificial neural networks (ANN) which are widely used to model complex relationships between inputs and outputs (Ardestani et\u00a0al. 2014; Bataineh et\u00a0al. 2016; Liu et\u00a0al. 2009). However, an ANN often overfit the data, and the capability to generalize weakens when dealing with small data samples (Ardestani et\u00a0al. 2014). Ensemble approaches usually deliver relatively accurate results because of their fast and robust responsiveness to noise in the data (Kontschieder et\u00a0al. 2011). We focused on one of the most widely used ensemble machine-learning methods, the random forest (RF) method that combines a large number of decision trees. The RF proposed by Breiman is nonparametric and one of the most popular supervised machine-learning algorithms (Breiman 2001). A RF combines hundreds of weak decision trees into one strong forest. Each decision tree performs a regression or classification, and the algorithm selects the outcome with the most votes as the result of the RF model. The accuracy of the model is improved by the overall decision as complemented by weak decision trees. The RF method has been widely used in image classification (Akcay et\u00a0al. 2018; G. Cai et\u00a0al. 2019). It is also suitable for regression analysis to identify nonlinear relationships between the variables even in highdimension settings with complex interactions; it ranks the variables and determines the impact of each variable on the result (Breiman 2015). The RF model is not easily susceptible to overfitting and has higher stability than an artificial neural network (ANN) (W.-c. Wang et\u00a0al. 2015). The RF model is more tolerant to noise and outliers in data and has a higher fitting accuracy than a support vector machine (SVM) (Yaseen et\u00a0al. 2019). In addition, the RF model has fewer adjustment parameters and is easier to operate relative to other methods such as particle swarm optimization (PSO) (D. Liu et\u00a0al. 2020). The RF model has been widely used in variable importance studies by researchers from various fields (Li et\u00a0al. 2020a, 2020b; Yi Li et\u00a0al. 2018; D. Liu\net\u00a0al. 2020; Yu et\u00a0al. 2017)and considered one of the most accurate model for regression and classification (Ardestani et\u00a0al. 2014). Niu et\u00a0al. (2020) used RF to construct the index of urban poverty in Guangzhou. Nevertheless, a RF model is a global model when used as a spatial statistics method, which assumes that the relationship between independent and dependent variables is globally stable. The RF does not account for the importance of variables across geographies and thus cannot reflect the imbalanced space distribution of the variables. In the real world, the distribution of multiple things is uneven, so the relationship between independent variables also varied over space. Therefore, it is necessary to consider the spatial variation when estimating the relationship between variables.\nThe exploratory and confirmatory nature of spatial data analysis aroused the attention of researchers as the availability of large spatial data sets and the capabilities to visualize, rapidly retrieve, and manipulate data in geographic information systems (GIS) expanded (Anselin 1988, 1990). Technologies focused on the spatial aspect of data developed rapidly (Anselin 2010, 2019; Anselin et\u00a0al. 1992). Spatial heterogeneity and correlation often coexist, because the spatial distribution of natural resources and socioeconomic factors is imbalanced (Y. Wang et\u00a0al. 2013). Georganos et\u00a0al. (Georganos et\u00a0al. 2019) used geographical random forests in remote sensing image classification, but did not focus on regression analysis. The study of the relationship between variables incorporating spatial factors more accurately reflects the distribution of things in the real world. Although the spatial error model (SEM) and spatial lag model (SLM) do consider spatial factors, they focus more on the analysis of spatial correlation and do not pay attention to analyzing spatial heterogeneity and the spatial variation of the relationships between variables (Wu 2020). Furthermore, spatial heterogeneity also encompasses unbalanced distributions of events, traits, and their relationship across a region (Anselin 2010; Dutilleul 2011). Therefore, it is impossible to explain a situation in different local areas using global parameters. Geographically weighted regression model (GWR) as proposed by Brunsdon et\u00a0al. (Brunsdon et\u00a0al. 2010) and further developed by Fotheringham et\u00a0al. (Fotheringham et\u00a0al. 2002) considers spatial heterogeneity and extends the ordinary least square (OLS) method by using a spatial weight to estimate local parameters. Because the GWR model can accurately generate a local spatial variation coefficient in regression (Ke et\u00a0al. 2016), it has been widely used in ecological (Galli et\u00a0al. 2012; Sheng et\u00a0al. 2017; Wu 2020), atmospheric (Hu et\u00a0al. 2014; Zhang et\u00a0al. 2019), and water resource evaluations (Huang et\u00a0al. 2015). As the GWR is based on multiple local linear regression models, it is not suitable in scenarios featuring nonlinear relationships between independent and dependent variables.\nIn this study, we used an approach that can measure the variable importance in each local area, called geographically weighted random forest regression (GW-RFR). The GW-RFR combines a spatial weight matrix (SWM) and random forest (RF), suitable for dealing with local highdimensional variables, and can identify nonlinear relationships between variables. This method was used to estimate the spatial variation of the relationship between the geographical and socioeconomic factors and poverty in China at the county level. In general, poverty can be classified into absolute poverty and relative poverty. In our work, we focus on the per capita savings, one of the most important indicators of the poverty, which is also highly related to the absolute poverty. The absolute poverty indicates that people are unable to meet the basic physical or material needs, which was commonly used in the developing countries. We stress that the per capita savings, which was selected as the target object of this work, is not exactly equal to poverty, but it can represent one important aspect of absolute poverty in China.\nThis paper is organized as follows: In Sect.\u00a02, a realworld poverty dataset, the methods including the SWM, RF, the proposed GW-RFR, the parameter settings, and the evaluation metrics are introduced. In Sect.\u00a03, GWRFR is demonstrated in a real-world poverty scenario. We employ data set from 2056 counties of China to validate our model. Finally, conclusions and future research are discussed in Sect.\u00a04."
        },
        {
            "heading": "Data and\u00a0method",
            "text": "In order to estimate the spatial variation of the nonlinear relationship between poverty factors and poverty, the local model GW-RFR was used in a poverty dataset and compared with the global model RF. In this section, we introduce the data (Sect.\u00a02.1) and describe the proposed GW-RFR method. The first step of GW-RFR is to make a SWM for each local area using the spatial information of the data. The process for constructing the SWM is introduced in Sect.\u00a02.2. The local RF is applied to each local area. The RF and the variable importance measurement (VIM) of the RF are discussed in Sect.\u00a02.3. The process for constructing the proposed GW-RFR model is described in Sect.\u00a0 2.4. The parameter settings are introduced in Sect.\u00a02.5, and the evaluation metrics in Sect.\u00a02.6."
        },
        {
            "heading": "Data",
            "text": "The distribution of poverty in China is extremely imbalanced (T. Li et\u00a0al. 2020a, 2020b; Yansui Liu et\u00a0al. 2016), and the factors affecting poverty including environmental factors and socioeconomic factors also have spatial characteristics. As poverty data for some counties were not available, we selected 2056 counties of China as the study area (see Fig.\u00a01) in this study. The selected 2,056 counties as study areas accounted for 93% of the total area\nof the Chinese mainland. Each county had a geographical location attribute. The location information for each county came from the National Geomatics Center of China.\nIn this study, we used the per capita savings which is one of the most related indicators with poverty as the target object and took the indicator of per capita savings (average value of resident savings) as the dependent variable (Y) for the regression model. The factors that lead to poverty can be broadly divided into two categories: geographical and socioeconomic (Barbier et\u00a0al. 2018; Decancq et\u00a0al. 2019; Zhou et\u00a0al.\n2020). We selected 28 poverty indicators (Table\u00a01) according to the previous study as independent variables (X, (X = X1, X2,\u22ef , X28)). Elevation and slope image data at 30-m resolution were obtained from Google Earth Engine. Data of railway, highway, and river networks were obtained from the National Geomatics Center of China. X6, X7,\u22ef , X28 are socioeconomic data and were extracted from the China County Statistical Yearbook (2016).\nThe units of these 28 poverty indicators are different; thus, the poverty indicators must be normalized before\n1 3\nregression to eliminate the influence of variation in the units of measurement of the poverty indicators as follows:\nwhere Xki represents the normalized value of the k th poverty indicator in the i th county, Xki represents the original value of the k th poverty indicator in the i th county,Xk represents the average value of the k th poverty indicator, and k represents the standard deviation of k th poverty index.\nThe dataset was divided into two parts, 70% of it was defined as training data set, and 30% of it was defined as validation data set. All the regression models including RF and GW-RF were implemented using the R software (version 3.5.3, http:// cran.r- proje ct. org), and the results were mapped in ArcGIS 10.5 (https:// www. esri. com/ zh- cn/ home)."
        },
        {
            "heading": "Spatial weight matrix (SWM)",
            "text": "Tobler\u2019s first law of geography notes that \u201ceverything is related to everything else, but near things are more related than distant things (Decancq et\u00a0al. 2019; Tobler 1970)\u201d. Therefore, the closer things are in space, the smaller the difference in their attributes. In spatial analysis, spatial samples closed to the target sample at location i are generally considered to have a greater impact on the parameter estimates of the sample at location i than those far from it. Nearness refers to a central organizing principle of geographic space, but there is no standard definition for it (Miller 2004; Zhou et\u00a0al. 2020). Here, we introduce two choices for the weight matrix of the county at location i , which are distance-based and adjacent with common edges. Setting the weight on county j to 1 if county j is a \u201cneighbor\u201d of county i , otherwise 0. Based on Q counties from a study area, the distance-based and common edge\u2013based spatial weight matrix at location i is expressed as W(L)j(i) and W(E)j(i):\nwhere L is the distance threshold and dij is the distance between county i and county j . If the distance between county i and county j is less than L , the county j is considered to be a neighbor of the county i:\nwhere determining whether j is a neighbor of i is based on whether there is a common edge between i and j.\n(1)Xki = Xki \u2212 Xk\nk (i \u2208 1, 2,\u22ef 2056;k \u2208 1, 2,\u22ef , 28)\n(2)W(L)j(i) = { 1, ifdij \u2264 L, j = 1, 2,\u22ef ,Q\n0, ifdij > L.\n(3)\nW(E)j(i) =\n{ 1, ifcountyiandcountyjhavecommenedges, j = 1,2,\u22ef ,Q\n0, ifcountyiandcountyjhavenocommonedge."
        },
        {
            "heading": "Random forest for\u00a0variable importance",
            "text": ""
        },
        {
            "heading": "Random forest (RF)",
            "text": "The RF proposed by Breiman (Breiman 2001; G. Cai et\u00a0al. 2019) is a machine learning method ensembled with multiple decision trees for regression and classification. The RF is nonparametric and can easily learn nonlinear relationships between multiple variables without explicitly modeling them and works well when estimating the variable importance of each variable (Gr\u00f6mping 2009). The algorithm flow of the RF is as follows:\n(1) The n sub-data sets D 1 ,D 2 ,\u22ef ,Dn are randomly\nextracted from the whole data set D , and n decision trees H\n1 ,H 2 ,\u22ef ,Hn are generated according to n sub-\ndata sets. (2) Each decision tree has q variables, m(m < q ) variables\nwere randomly selected for a node of the tree, and each node of the decision tree is split by the optimal segmentation criterion. Each decision tree can grow to its largest extent without pruning, until all the nodes cannot be split.\nWhen constructing decision trees, about 36.8% of the data counties were not used. These counties are the out-of-bag (OOB) data for the decision tree. The accuracy of the RF model is estimated from the OOB data as in Eq.\u00a0(4):\nwhere N is the number of counties of OBB data, yi is the actual value of the dependent variable of the i th county, and y\u0302i is the average prediction for the dependent variable of the i th county from all trees in the RF."
        },
        {
            "heading": "The variable importance measurement (VIM)",
            "text": "Average impurity reduction (Gini importance) and mean squared error (MSE) reduction are two methods used to estimate the variable importance in a RF, but variable importance by impurity reduction is biased (Miller 2004; Strobl et\u00a0al. 2007). The MSE reduction method is suggested when permuting the variables (Gr\u00f6mping 2009; Ishwaran 2007; Strobl et\u00a0al. 2008, 2007). The MSE reduction method estimates the variable importance using the MSE value from the OOB data (H. Cai et\u00a0al. 2018; Strobl et\u00a0al. 2008). It is determined as follows:\n(1) Calculate the MSE of the OBB data for each decision tree. The MSE of OOB data of the decision tree t is calculated by Eq.\u00a0(5):\n(4)MSE = 1 N N\u2211 i=1 ( yi \u2212 y\u0302i )2\n1 3\nwhere Nt is the number of counties of the OBB data in the tree t and y\u0302i,t is the prediction of the dependent variable of the i th county for the tree t.\n(2) The target variable l is randomly replaced, and then the corresponding value of the MSE for the new tree t is calculated by Eq.\u00a0(6):\nwhere y\u0302i,t(l) is the prediction of the dependent variable for the i th county of the new tree t with the target variable l randomly replaced.\n(3) Calculate the MSE reduction between MSEt and MSEt(l) . The variable importance for variable l of the decision tree t can be obtained from the MSE reduction. The variable importance of variable l of the RF is the average over MSE reduction of all n trees as expressed in Eq.\u00a0(7):\nGeographically weighted random forest regression (GW\u2011RFR)\nIn this section, we introduced the GW-RFR, a local nonlinear machine learning method. The GW-RF was proposed by Luo et\u00a0al. (2021) and was applied in many studies especially in the spatial analysis about COVID-19 epidemic (Maiti et\u00a0al. 2021; Qui\u00f1ones et\u00a0al. 2021). The GW-RFR integrates the SWM and RF into a local regression model. The GW-RFR is a variation of the RF, which is applicable to local systems. It can estimate the nonlinear relationship between the high-dimensional variables even for high correlated variables (Archer et\u00a0al. 2008). The variable importance for each county can be obtained from the GW-RFR. The process of the GW-RFR model is as follows:\n(1) The SWM for each county of the whole data set should be made according to a specified spatial weight rule such as a distance-based or common edge-based spatial weight rule. The SWM for the whole study area with p spatial counties can be expressed as in Eq.\u00a0(8):\n(5)MSEt = 1\nNt Nt\u2211 i=1 ( yi \u2212 y\u0302i,t )2\n(6)MSEt(l) = 1\nNt Nt\u2211 i=1 ( yi \u2212 y\u0302i,t(l) )2\n(7) VIM(l) = MSE(l) = 1\nn n\u2211 t=1 ( MSEt \u2212MSEt(l) )\nBecause the local random forest for a county needs to consider the county itself, the value of wii is set to 1 ( wii = 1 ). According to the pre-set spatial weight rule, for county i , if the county j ( j \u2208 (1, 2,\u22ef , p) \u2227 i \u2260 j ) is a \u201cneighbor\u201d of the county i , the value of spatial weight wij between them is set to 1. While county j is not a \u201cneighbor\u201d of county i , wij = 0.\n(2) Select all the \u201cneighbors\u201d of each spatial county according to the SWM. For county i , the \u201cneighbors\u201d of it can be obtained from the SWM W where wij \u2260 0, (j \u2208 (1, 2,\u22ef , p) \u2227 i \u2260 j). (3) The county i and its \u201cneighbors\u201d are as the inputs of a local RF for county i (RF ( i)). Then the variable importance for spatial county i can be abtained from the RF ( i). (4) Repeat steps (2) and (3) to construct the local RF for each spatial county in the whole study area. The local variable importance for each county can be estimated from the local RF."
        },
        {
            "heading": "Parameter settings",
            "text": "The poverty data set were employed in the RF and GWRFR. In the implementation of the GW-RFR, the SWM is the key to implement GW-RFR model. The SWM of each county was generated by a distance-based rule, k-nearest neighbors (KNN). The neighbors of the target county are defined as the K counties closest to the target county using KNN. We set K=125 according to the test of the performance of multiple GW-RFR models with a different number of the local samples (Table\u00a0S4); that is, the value of L in Eq.\u00a0(2) is defined as the distance between the target county and the 125th closest county.\nIn the implementation of the GW-RFR, the number of decision trees n tree and the number of candidate split variables of the tree node m try are the two main parameters that influence the performance of the model. Referring to the relevant research about the RF (G. Cai et\u00a0al. 2019) and experimental tuning of the GW-RFR, the parameters for each local RF of the whole GW-RFR were set as follows: the number of decision trees n tree = 500 and the number of candidate split variables of the tree node m try = 10.\n(8)W = \u23a1 \u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3 W(1) W(2) \u22ee W(i) \u22ee W(p) \u23a4 \u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 = \u23a1 \u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3 w 11 w 12 \u22efw 1p w 21 w 22 \u22efw 2p \u22ee\u22ee\u22ee\u22ee wi1wi2 \u22efwip \u22ee\u22ee\u22ee\u22ee\nwp1wp2 \u22efwpp\n\u23a4 \u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 i \u2208 (1, 2,\u22ef , p)"
        },
        {
            "heading": "Evaluation metrics",
            "text": "We used three metrics to evaluate the performance of the GW-RFR. For the dependent variable y , we computed the coefficient of determination ( R2):\nthe normalized root mean square error ( NRMSE),\nand the mean absolute error ( MAE):\nwhere y\u0302i denotes the predicted dependent variable by a regression model, yi is the actual value of the denpendent variable,y is the mean value of yi , N is the total number of the counties, ymax is the maximum value of the actual dependent variable, and ymin is the minimum value of the actual dependent variable."
        },
        {
            "heading": "Results and\u00a0analysis",
            "text": "China is the largest developing country with a large area and uneven economic development among different regions. The distribution of poverty and poverty factors in China varies in space. On a large spatial scale, China has 14 concentrated contiguous zones of extreme poverty. At the small and medium scale, the poverty and poverty factors at the county level in China are also uneven. To explore the spatial variation characteristics of county poverty, the GW-RFR and RF were used to explore the causes of poverty from the socio-economic and geographical perspectives at county level in China. A strong correlation between the independent variables may cause multicollinearity during the regression analysis. Multicollinearity occurs when there are several high linear relationships between regressors, leading to the statistically insignificant outcomes for the individual t test (Ishwaran 2007; Pesaran 2015). Thus, before performing regression analysis, the Pearson correlation coefficient was used to evaluate the correlation between independent variables and the correlation between X and Y. A Pearson correlation coefficient value greater than 0.8 indicates a significant correlation between variables. Table\u00a0S1 shows the Pearson correlation coefficient values between the poverty indicators (independent variables). The value of the Pearson\n(9)R2 = 1 \u2212 \u2211N i=1 (yi \u2212 y\u0302i) 2\n\u2211N i=1 (\u0302yi \u2212 y) 2\n(10)NRMSE =\n\ufffd 1\nN\n\u2211N i=1 \ufffd y\u0302i \u2212 yi \ufffd2 ymax \u2212 ymin\n(11)MAE = 1\nN\n\u2211N i=1 ||\u0302yi \u2212 yi||\ncorrelation coefficient between X11, X12, X20, and X21 is greater than 0.8, indicating that there is a significantly strong correlation between them. Therefore, they cannot be put together as input independent variables into the regression analysis. Table\u00a0S2 shows the Pearson correlation coefficient values between each poverty indicator and Y. The higher the value of the Pearson correlation coefficient between a poverty indicator and Y, the stronger its correlation with poverty. To avoid the multicollinearity, X12, X20, and X21 cannot be selected for the regression analysis according to the analysis result from Table\u00a0S1 and Table\u00a0S2. The independent variables including X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X13, X14, X15, X16, X17, X18, X19, X22, X23, X24, X25, X26, X27, and X28 were the variables input to the RF and the GW-RFR.\nThe selected 25 poverty indicators were used as independent variables and per capita savings as dependent variables, and they were used to conduct regression analysis in GW-RFR and RF, respectively. We used three metrics introduced in Sect.\u00a02.6 including R2 , NRMSE, and MAE to measure the performance of the GW-RFR and RF. Table\u00a02 provides the evaluation of the RF and GW-RFR with the evaluation metrics R2 , NRMSE, and MAE.\nAs shown in Table\u00a0 2, the value R2 of the GW-RFR was 0.918 and 0.16 higher than the RF. Compared with global regression, the goodness of fit of local regression is improved obviously. The value of the NRMSE was 2.0%, and MAE was 0.312, they were both lower than the RF. This indicates that the performance of GW-RFR in regression analysis was improved compared with the RF. Table\u00a02 shows the overall performance of the model, but the performance of the GW-RFR was not consistent in space. To show the local fitting performance of GW-RFR, we mapped the local R2 of GW-RFR through Arcgis 10.7. Figure\u00a02 shows the spatial distribution of local R2 of the GW-RFR.\nIn Fig.\u00a02, we visualized the value of local R2 in five ranges (\u2264 0.2, (0.2, 04], (0.4, 06], (0.6, 08], > 0.8), and we calculated the percentage of counties in these five ranges (Table\u00a03). The values of local R2 were high in the majority counties, especially the counties in the southwest, eastern coastal areas and the western areas. The percentage of counties where local R2 was higher than 0.6 was 70.0% and higher than 0.4 was 94.65%. Only a few counties in the central and south central areas had lower values of"
        },
        {
            "heading": "RF 0.758 4.0% 0.612",
            "text": "1 3\nR2 . This indicates the proposed local model GW-RFR obtained an accurate result in most of the local regions at a finer scale.\nTo estimate the correlation between each poverty indicator and poverty, we estimated the variable importance and did a significance test for each poverty indicator in both RF and GW-RFR model. We ranked the poverty indicators based on the variable importance marked them as vip i ( i \u2208 (1, 2,\u22ef , 25) ). Table\u00a04 shows poverty indicators of the RF and the variable importance and the P value.\nAs shown in Table\u00a04, the per loan amount (X13), per capita GDP (X9), elevation (X1), proportion of landline subscribers (X10), proportion of secondary industry employees (X7), and per capita beds of various social welfare receiving units (X28) had a significant correlation with poverty with a P value lower than 0.05. According to the RF regression analysis, in the whole study area, the poverty indicator with the strongest correlation with poverty (vip1) was per loan amount (X13), followed by per capita\nTable 3 The statistic of local R2 of the GW-RFR, we calculated the average value of local R2 and the percentage of counties in five local R2 range (\u2264 0.2, (0.2, 04], (0.4, 06], (0.6, 08], > 0.8)\nThe value of local R 2 Percentage of counties\n\u2264 0.2 0.73% (0.2, 04] 4.62% (0.4, 06] 24.66% (0.6, 08] 46.06% > 0.8 23.93%\nGDP (X9) and elevation (X1). The variable importance and the P value of each poverty indicators from the GW-RFR were shown in Table\u00a0S3 in the online supplementary file. The relationship between each poverty indicator and poverty was different from the overall relationship obtained by RF. The variable importance of each poverty indicator varies from region to region, which was consistent with the spatial heterogeneity characteristics of poverty factors found in previous studies. The three poverty indicators with the highest local average variable importance are per loan amount (X13), per capita GDP (X9), and proportion of landline subscribers (X10). The poverty indicators that are most correlated with each county were also different. Figure\u00a03 provides a detailed spatial distribution of the poverty indicators with the most correlated poverty indicator (the poverty indicator with the highest value of variable importance (vip1)) in each county.\nIn Fig.\u00a03, among the poverty indicators of vip1 in the GW-RF, per loan amount (X13) accounts for the largest proportion, followed by per capita GDP (X9), proportion of landline subscribers (X10), and per capita hospital beds (X27). The poverty indicator that had the strongest correlation with poverty was not the same in different counties. The per loan amount (X13) was the primary poverty indicator in most of the eastern areas, the western part such as Xinjiang Province, the west of Xizang Province, Qinghai Province, and Gansu Province, and in the norther part such as Inner Mongolia Province, and the southeastern part such as Yunnan Province. The per capita GDP (X9) was the primary poverty indicator in the center of Xizang Province, the north\nof Sichuan Province, Chongqing Province, and the west of Guangxi Province. The proportion of landline subscribers X10 has the strongest correlation with the poverty in the southeastern of Tibet, the south of Chongqing Province, and the south of Jilin Province. The per capita hospital beds X27 was the primary poverty indicator in the northeastern part such as Heilongjiang Province. To explore the distribution of the variable importance of each poverty indicator, Fig.\u00a04 displays a detailed spatial distribution of the value of variable importance for the first three relatively important poverty indicators per loan amount (X13), per capita GDP (X9), and proportion of landline subscribers (X10).\nAs shown in Fig.\u00a04, each poverty indicator had a different level of correlation with poverty in different regions. The geographical distribution of the per loan amount, per capita GDP, and proportion of landline subscribers is concentrated and extensive. In the western region, these three poverty indicators show strong correlation with poverty. But the distribution of these three factors of poverty was different in other regions. This may be explained by the various geographical environment and socioeconomic development patterns of local regions, leading to the different impact of each poverty factor on poverty in local regions. The poverty indicator of per loan amount (X13) had a greater correlation with poverty in the northwestern regions and eastern areas, but it has a smaller impact in the northeastern regions. The variable importance of per capita GDP and proportion of landline subscribers shows a distribution pattern of \u201chigh in the west and low in the east\u201d on the whole, which is similar to the distribution of poor counties in China (H. Cai et\u00a0al.\n1 3\n1 3\n2018; Yanhua Liu et\u00a0al. 2016). The per capita GDP (X9) had a greater impact on poverty in the western and central regions especially in Sichuan Province, Chongqing Province, and Hubei Province. The proportion of landline subscribers (X10) was an influential poverty in Jiangsu Province, Sichuan Province, the west of Xinjiang Province, and the west of Tibet. Policy-makers should pay attention to the variation of these poverty indicators over space to tailor measures for different regions."
        },
        {
            "heading": "Discussion and\u00a0Conclusion",
            "text": "The distribution of poverty in space is not balanced. Thus, the variables (poverty and multidimensional factors) and their relationships varied across geographical locations. The relationship between poverty and its factors is not always linear in real-world data sets. The RF is a machine learning model, which can explain the nonlinear relationship between variables, but its results are consistent in the global research area and cannot explain the geospatial differences of variables in the local area. In order to explore the nonlinear relationships between variables at various spatial locations, it is necessary to deal with nonlinearity in local regression models. Thus, we used a local regression model GW-RFR to handle nonlinear relationships between poverty and multiple factors across various locations.\nIn this paper, the method GW-RFR and RF (G. Cai et\u00a0al. 2019) were employed to analyze a real-world poverty data set of China. In the poverty application example, the value of R2 was 0.128 higher than that of the RF, the NRMSE value was 1.6% lower than the RF, and the MAE value was 0.295 lower than the RF. It indicates that the proposed local model GW-RFR can conduct a more accurate regression analysis of the poverty dataset compared with the global model RF. Our results showed that per loan amount, per capita GDP, and proportion of landline subscribers and per capita hospital beds are the main poverty factors in most areas of China. And the relative importance of these factors to poverty varied over space. The result was consistent with the other research findings on poverty in China (Yuheng Li et\u00a0al. 2016; Yanhua Liu et\u00a0al. 2016; Pesaran 2015; Tian et\u00a0al. 2018). The value of local R2 of the GW-RF was imbalanced in the study area, high in the majority of the counties, but low in a few of them. Previous studies found that the RF performed effectively in a global regression when dealing with nonlinear systems. Our results show, however, that the GW-RFR method inherits the merits of RF and can analyze the nonlinear regression at different locations in space.\nAlthough the proposed GW-RFR can effectively deal with the nonlinearity at various locations in a regression analysis, it also has limitations. The R2 , NRMSE, and MAE\nmetrics indicate that the local GW-RFR model outperformed a global model RF, but the local performance was imbalanced across the whole study area. While the GW-RFR performed effectively in a majority local areas, a few local areas were outliers. In the future work, we will improve the performance of the GW-RFR by increasing the number of local samples. In order to highlight the local features of each sample in the improved GW-RFR with increased local sample size, we will assign different weights to the neighbors of the target local sample according to their distance from the target, for example, setting the weights using an inverse distance weighted rule.\nIn this paper, a local nonlinear regression method GWRFR is used, which consists of several local RFs. Through the space weight matrix, the GW-RFR will find adjacent space units for each space unit, thus constructing a local RF for each space unit. The GW-RFR improves the goodness of fit of RF by local analysis. This method also provides the correlation between independent variables and the dependent variable for each local spatial unit, as well as the prediction of local dependent variables. We used the GW-RFR to estimate the spatial variation of the relationships between poverty and socioeconomic factors. The result showed that the relationship between each factor and poverty presented a unique spatial pattern. In addition to being applied to the analysis of spatial poverty, this improved GW-RFR could also help users select the most important factors and predict processes affected by complex multiple factors at a finer scale.\nSupplementary Information The online version contains supplementary material available at https:// doi. org/ 10. 1007/ s11356- 021- 17513-3.\nAcknowledgements This research is supported by a grant provided by the National Scientific Foundation of China (Grant No. U41874010\u00a0and 42030110), Pre-research Project on CivilAerospace Technologies (No. D020103), and the fundamental research funds for the central universities (2042018KF0231).\nAuthor contribution Conceptualization, Yaowen Luo and Jianguo Yan; methodology, Yaowen Luo; software, Yaowen Luo; validation, Jianguo Yan and Yaowen Luo; formal analysis, Yaowen Luo; investigation, Yaowen Luo; resources, Yaowen Luo; data curation, Yaowen Luo; writing\u2014original draft preparation, Yaowen Luo; writing\u2014review and editing, Jianguo Yan and Stephen C. McClure; visualization, Yaowen Luo; supervision, Jianguo Yan and Fei Li; project administration, Jianguo Yan and Fei Li; funding acquisition, Jianguo Yan. All authors have read and agreed to the published version of the manuscript.\nFunding National Scientific Foundation of China (Grant No.\u00a0 41874010 and 42030110), Pre-research Project on CivilAerospace Technologies (No. D020103), and the fundamental research funds for the central universities (2042018KF0231).\nData availability The data we used in this study was obtained from Google Earth Engine, the National Geomatics Center of China, and the China County Statistical Yearbook (2016).\n1 3"
        },
        {
            "heading": "Declarations",
            "text": "Ethics approval Not applicable.\nConsent to participate Not applicable.\nConsent for publication All the co-authors consent to the publication of this work.\nCompeting interests The authors declare no competing interests."
        }
    ],
    "title": "Socioeconomic and environmental factors of poverty in China using geographically weighted random forest regression model",
    "year": 2022
}