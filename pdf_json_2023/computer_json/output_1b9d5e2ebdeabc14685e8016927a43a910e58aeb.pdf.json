{
    "abstractText": "Zinat Behdad, \u00d6zlem Tu\u011ffe Demir, Ki Won Sung, Emil Bj\u00f6rnson, and Cicek Cavdar Abstract This paper studies an integrated sensing and communication (ISAC) system for single-target detection in a cloud radio access network architecture. The system considers downlink communication and multi-static sensing approach, where ISAC transmit access points (APs) jointly serve the user equipments (UEs) and optionally steer a beam toward the target. A centralized operation of cell-free massive MIMO (multiple-input multiple-output) is considered for communication and sensing purposes. A maximum a posteriori ratio test detector is developed to detect the target in the presence of clutter, socalled target-free signals. Moreover, a power allocation algorithm is proposed to maximize the sensing signal-to-interference-plus-noise ratio (SINR) while ensuring a minimum communication SINR value for each UE and meeting per-AP power constraints. Two ISAC setups are studied: i) using only existing communication beams for sensing and ii) using additional sensing beams. The proposed algorithm\u2019s efficiency is investigated in both realistic and idealistic scenarios, corresponding to the presence and absence of the target-free channels, respectively. Although detection probability degrades in the presence of target-free channels that act as interference, the proposed algorithm significantly outperforms the interference-unaware benchmark by exploiting the statistics of the clutter. It has also been shown that the proposed algorithm outperforms the fully communication-centric algorithm, both in the presence and absence of clutter. Moreover, using an additional sensing beam improves the detection performance for a target with lower radar cross-section variances compared to the case without sensing beams.",
    "authors": [
        {
            "affiliations": [],
            "name": "Zinat Behdad"
        },
        {
            "affiliations": [],
            "name": "\u00d6zlem Tu\u011ffe Demir"
        },
        {
            "affiliations": [],
            "name": "Ki Won Sung"
        },
        {
            "affiliations": [],
            "name": "Emil Bj\u00f6rnson"
        },
        {
            "affiliations": [],
            "name": "Cicek Cavdar"
        }
    ],
    "id": "SP:fe4dc4aa1e7cdad56c2043c76399f814be5ac724",
    "references": [
        {
            "authors": [
                "F. Liu",
                "Y. Cui",
                "C. Masouros",
                "J. Xu",
                "T.X. Han",
                "Y.C. Eldar",
                "S. Buzzi"
            ],
            "title": "Integrated sensing and communications: Towards dual-functional wireless networks for 6G and beyond",
            "venue": "IEEE J. Sel. Areas Commun., 2022.",
            "year": 2022
        },
        {
            "authors": [
                "A. Behravan",
                "V. Yajnanarayana",
                "M.F. Keskin"
            ],
            "title": "Positioning and sensing in 6G: Gaps, challenges, and opportunities",
            "venue": "IEEE Veh. Technol. Mag., vol. 18, no. 1, pp. 40\u201348, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "A. Liu",
                "Z. Huang",
                "M. Li"
            ],
            "title": "A survey on fundamental limits of integrated sensing and communication",
            "venue": "IEEE Commun. Surv. Tutor., vol. 24, no. 2, pp. 994\u20131034, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "J.A. Zhang",
                "M.L. Rahman",
                "K. Wu",
                "X. Huang",
                "Y.J. Guo",
                "S. Chen",
                "J. Yuan"
            ],
            "title": "Enabling joint communication and radar sensing in mobile networks\u2013A survey",
            "venue": "IEEE Commun. Surv. Tutor., vol. 24, no. 1, pp. 306\u2013345, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "T. Wild",
                "V. Braun",
                "H. Viswanathan"
            ],
            "title": "Joint design of communication and sensing for beyond 5G and 6G systems",
            "venue": "IEEE Access, vol. 9, pp. 30 845\u201330 857, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "F. Liu",
                "L. Zheng",
                "Y. Cui",
                "C. Masouros",
                "A.P. Petropulu",
                "H. Griffiths",
                "Y.C. Eldar"
            ],
            "title": "Seventy years of radar and communications: The road from separation to integration",
            "venue": "arXiv preprint arXiv:2210.00446, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "X. Liu",
                "T. Huang",
                "N. Shlezinger",
                "Y. Liu",
                "J. Zhou",
                "Y.C. Eldar"
            ],
            "title": "Joint transmit beamforming for multiuser MIMO communications and MIMO radar",
            "venue": "IEEE Trans. Signal Process., vol. 68, pp. 3929\u20133944, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J. Mu",
                "Y. Gong",
                "F. Zhang",
                "Y. Cui",
                "F. Zheng",
                "X. Jing"
            ],
            "title": "Integrated sensing and communication-enabled predictive beamforming with deep learning in vehicular networks",
            "venue": "IEEE Commun. Lett., vol. 25, no. 10, pp. 3301\u20133304, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "J. Pritzker",
                "J. Ward",
                "Y.C. Eldar"
            ],
            "title": "Transmit precoder design approaches for dual-function radar-communication systems",
            "venue": "arXiv preprint arXiv:2203.09571, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "R. Thom\u00e4",
                "T. Dallmann",
                "S. Jovanoska",
                "P. Knott",
                "A. Schmeink"
            ],
            "title": "Joint communication and radar sensing: An overview",
            "venue": "15th European Conference on Antennas and Propagation (EuCAP), 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Huang",
                "Y. Fang",
                "X. Li",
                "J. Xu"
            ],
            "title": "Coordinated power control for network integrated sensing and communication",
            "venue": "IEEE Trans. Veh. Technol., vol. 71, no. 12, pp. 13 361\u201313 365, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "A. Zhang",
                "M.L. Rahman",
                "X. Huang",
                "Y.J. Guo",
                "S. Chen",
                "R.W. Heath"
            ],
            "title": "Perceptive mobile networks: Cellular networks with radio vision via joint communication and radar sensing",
            "venue": "IEEE Veh. Technol. Mag., vol. 16, no. 2, pp. 20\u201330, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "S. Buzzi",
                "C. D\u2019Andrea",
                "M. Lops"
            ],
            "title": "Using massive MIMO arrays for joint communication and sensing",
            "venue": "53rd Asilomar Conference on Signals, Systems, and Computers, 2019, pp. 5\u20139.",
            "year": 2019
        },
        {
            "authors": [
                "H. Hua",
                "J. Xu",
                "T.X. Han"
            ],
            "title": "Transmit beamforming optimization for integrated sensing and communication",
            "venue": "IEEE Global Communications Conference (GLOBECOM), 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Ye",
                "W. Hu",
                "Y. Zhao",
                "L. Huang",
                "Z. Shi"
            ],
            "title": "Beamforming design for OFDM joint sensing and communication system",
            "venue": "Journal of Internet Technology, vol. 23, no. 7, pp. 1449\u20131459, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Z. Liu",
                "S. Aditya",
                "H. Li",
                "B. Clerckx"
            ],
            "title": "Joint transmit and receive beamforming design in full-duplex integrated sensing and communications",
            "venue": "arXiv preprint arXiv:2210.10904, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Y. He",
                "Y. Cai",
                "G. Yu",
                "K.-K. Wong"
            ],
            "title": "Joint transceiver design for dual-functional full-duplex relay aided radarcommunication systems",
            "venue": "IEEE Trans. Commun., vol. 70, no. 12, pp. 8355\u20138369, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "J. Li",
                "G. Zhou",
                "T. Gong",
                "N. Liu"
            ],
            "title": "A framework for mutual information-based MIMO integrated sensing and communication beamforming design",
            "venue": "arXiv preprint arXiv:2211.07887, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "J. Li",
                "N. Liu"
            ],
            "title": "Integrated sensing and communication beamforming design based on mutual information",
            "venue": "2022 IEEE/CIC International Conference on Communications in China (ICCC Workshops). IEEE, 2022, pp. 383\u2013388.",
            "year": 2022
        },
        {
            "authors": [
                "S. Shi",
                "Z. Cheng",
                "L. Wu",
                "Z. He",
                "B. Shankar"
            ],
            "title": "Distributed 5G NR-based integrated sensing and communication systems: Frame structure and performance analysis",
            "venue": "EUSIPCO, 2022, pp. 1062\u20131066. May 23, 2023 DRAFT 30",
            "year": 2022
        },
        {
            "authors": [
                "F. Liu",
                "W. Yuan",
                "C. Masouros",
                "J. Yuan"
            ],
            "title": "Radar-assisted predictive beamforming for vehicular links: Communication served by sensing",
            "venue": "IEEE Trans. Wirel. Commun., vol. 19, no. 11, pp. 7704\u20137719, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Bazzi",
                "M. Chafii"
            ],
            "title": "On outage-based beamforming design for dual-functional radar-communication 6G systems",
            "venue": "IEEE Trans. Wirel. Commun., 2023.",
            "year": 2023
        },
        {
            "authors": [
                "\u00d6.T. Demir",
                "E. Bj\u00f6rnson",
                "L. Sanguinetti"
            ],
            "title": "Foundations of user-centric cell-free massive MIMO",
            "venue": "Foundations and Trends\u00ae in Signal Processing, vol. 14, no. 3-4, pp. 162\u2013472, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "\u00d6.T. Demir",
                "M. Masoudi",
                "E. Bj\u00f6rnson",
                "C. Cavdar"
            ],
            "title": "Cell-free massive MIMO in O-RAN: Energy-aware joint orchestration of cloud, fronthaul, and radio resources",
            "venue": "arXiv preprint arXiv:2301.06166, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "Z. Behdad",
                "\u00d6.T. Demir",
                "K.W. Sung",
                "E. Bj\u00f6rnson",
                "C. Cavdar"
            ],
            "title": "Power allocation for joint communication and sensing in cell-free massive MIMO",
            "venue": "IEEE Global Communications Conference (GLOBECOM), 2022, pp. 4081\u20134086.",
            "year": 2022
        },
        {
            "authors": [
                "S. Buzzi",
                "C. D\u2019Andrea",
                "M. Lops"
            ],
            "title": "Transmit power allocation for joint communication and sensing through massive MIMO arrays",
            "venue": "WSA 2020; 24th International ITG Workshop on Smart Antennas, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Sakhnini",
                "M. Guenach",
                "A. Bourdoux",
                "H. Sahli",
                "S. Pollin"
            ],
            "title": "A target detection analysis in cell-free massive MIMO joint communication and radar systems",
            "venue": "IEEE International Conference on Communications, 2022, pp. 2567\u20132572.",
            "year": 2022
        },
        {
            "authors": [
                "U. Demirhan",
                "A. Alkhateeb"
            ],
            "title": "Cell-free ISAC MIMO systems: Joint sensing and communication beamforming",
            "venue": "arXiv preprint arXiv:2301.11328, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "Y. Guo",
                "C. Li",
                "C. Zhang",
                "Y. Yao",
                "B. Xia"
            ],
            "title": "Performance analysis of the full-duplex communicating-radar convergence system",
            "venue": "arXiv preprint arXiv:2210.12358, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Z. Zhang",
                "Q. Chang",
                "S. Yang",
                "J. Xing"
            ],
            "title": "Sensing-communication bandwidth allocation in vehicular links based on reinforcement learning",
            "venue": "IEEE Wireless Communications Letters, vol. 12, no. 1, pp. 11\u201315, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "G. Cheng",
                "J. Xu"
            ],
            "title": "Coordinated transmit beamforming for multi-antenna network integrated sensing and communication",
            "venue": "arXiv preprint arXiv:2211.01085, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "M.A. Richards",
                "J. Scheer",
                "W.A. Holm"
            ],
            "title": "Principles of Modern Radar: Basic Principles",
            "year": 2010
        },
        {
            "authors": [
                "E. Bj\u00f6rnson",
                "J. Hoydis",
                "L. Sanguinetti"
            ],
            "title": "Massive MIMO networks: Spectral, energy, and hardware efficiency",
            "venue": "Foundations and Trends\u00ae in Signal Processing, vol. 11, no. 3-4, pp. 154\u2013655, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "D. Shiu",
                "G. Foschini",
                "M. Gans",
                "J. Kahn"
            ],
            "title": "Fading correlation and its effect on the capacity of multielement antenna systems",
            "venue": "IEEE Trans. Commun., vol. 48, no. 3, pp. 502\u2013513, 2000.",
            "year": 2000
        },
        {
            "authors": [
                "S. Guruacharya",
                "B.K. Chalise",
                "B. Himed"
            ],
            "title": "MAP ratio test detector for radar system",
            "venue": "IEEE Trans. Signal Process., vol. 69, pp. 573\u2013588, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "H.P. Benson"
            ],
            "title": "Fractional programming with convex quadratic forms and functions",
            "venue": "European Journal of Operational Research, vol. 173, no. 2, pp. 351\u2013369, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "G. Lanckriet",
                "B.K. Sriperumbudur"
            ],
            "title": "On the convergence of the concave-convex procedure",
            "venue": "Adv. in Neur. Inf. Proc. Sys., vol. 22, 2009.",
            "year": 2009
        },
        {
            "authors": [
                "3GPP"
            ],
            "title": "Further advancements for E-UTRA physical layer aspects (release 9)",
            "venue": "TS 36.814, 2017. DRAFT May 23, 2023",
            "year": 2017
        }
    ],
    "sections": [
        {
            "text": "1 Multi-Static Target Detection and Power\nAllocation for Integrated Sensing and\nCommunication in Cell-Free Massive MIMO\nZinat Behdad, O\u0308zlem Tug\u0306fe Demir, Ki Won Sung,\nEmil Bjo\u0308rnson, and Cicek Cavdar Abstract\nThis paper studies an integrated sensing and communication (ISAC) system for single-target detection in a cloud radio access network architecture. The system considers downlink communication and multi-static sensing approach, where ISAC transmit access points (APs) jointly serve the user equipments (UEs) and optionally steer a beam toward the target. A centralized operation of cell-free massive MIMO (multiple-input multiple-output) is considered for communication and sensing purposes. A maximum a posteriori ratio test detector is developed to detect the target in the presence of clutter, socalled target-free signals. Moreover, a power allocation algorithm is proposed to maximize the sensing signal-to-interference-plus-noise ratio (SINR) while ensuring a minimum communication SINR value for each UE and meeting per-AP power constraints. Two ISAC setups are studied: i) using only existing communication beams for sensing and ii) using additional sensing beams. The proposed algorithm\u2019s efficiency is investigated in both realistic and idealistic scenarios, corresponding to the presence and absence of the target-free channels, respectively. Although detection probability degrades in the presence of target-free channels that act as interference, the proposed algorithm significantly outperforms the interference-unaware benchmark by exploiting the statistics of the clutter. It has also been shown that the proposed algorithm outperforms the fully communication-centric algorithm, both in the presence and absence of clutter. Moreover, using an additional sensing beam improves the detection performance for a target with lower radar cross-section variances compared to the case without sensing beams.\nIndex Terms\nIntegrated sensing and communication (ISAC), cell-free massive MIMO, C-RAN, power allocation,\nmulti-static sensing.\nZ. Behdad, K. W. Sung, E. Bjo\u0308rnson, and C. Cavdar are with the Department of Computer Science, KTH Royal Institute of Technology, Kista, Sweden ({zinatb, sungkw, emilbjo, cavdar}@kth.se). O\u0308. T. Demir is with the Department of Electrical and Electronics Engineering, TOBB University of Economics and Technology, Ankara, Turkey (ozlemtugfedemir@etu.edu.tr). Results incorporated in this paper received funding from the ECSEL Joint Undertaking (JU) under grant agreement No 876124. The JU receives support from the EU Horizon 2020 research and innovation programme and Vinnova in Sweden.\nMay 23, 2023 DRAFT\nar X\niv :2\n30 5.\n12 52\n3v 1\n[ cs\n.I T\n] 2\n1 M\nay 2\n02 3\n2 I. INTRODUCTION\nRadio-based positioning and sensing have gained considerable attention as one of the key enablers in beyond 5G and 6G wireless networks. It is envisioned that integrated sensing and communication (ISAC), also known as joint sensing and communication (JSAC), will become a promising technology in future wireless systems, providing many sensing applications [1] [2]. It is expected to support various use cases, including remote healthcare, remote monitoring of weather conditions, asset tracking, gesture recognition, autonomous vehicles, and augmented reality (AR). The main idea of such a system is to share infrastructure, resources, and signals between communications and sensing to improve the spectral efficiency and sensing performance while lowering the hardware and deployment costs [2]\u2013[7]. The communication performance could also be enhanced by exploiting the sensing information to estimate the channel and optimize the network steering [8]. ISAC benefits from current developments in wireless systems, i.e., denser access point (AP) deployment and wider bandwidths [2]\u2013[4].\nFrom the network-level perspective, ISAC is expected to provide a ubiquitous radar perception system [9]\u2013[11], also known as a perceptive mobile network [12]. The focus of the research on ISAC has been mainly on waveform design and signal processing (see [7]\u2013[9], [13]\u2013[22]), in which ISAC is mostly considered in single-cell scenarios with mono-static sensing, which refers to a co-located transmitter and receiver for sensing. Bi-static sensing, involving a non-co-located transmitter and receiver, can be employed to dispense with the full-duplex capability requirement in mono-static sensing. Multi-static sensing, which uses multi non-co-located transmitters and receivers, can also be preferable since it provides a diversity gain due to multiple uncorrelated sensing observations at distributed sensing receivers. Furthermore, multi-static sensing offers an additional performance gain as it achieves increased joint transmit/receive beamforming gain by using multiple transmitters/receivers in the network.\nTo implement multi-static sensing in an existing communication system, cell-free massive MIMO (cell-free massive multiple-input multiple-output) is a promising infrastructure [23], which motivates our work. To fully realize the advantages of cell-free massive MIMO, it is preferred to use phase-coherent centralized joint processing. This involves implementing transmit/receive processing by utilizing all the channel estimates obtained from each access point (AP) and processing them in a central processing unit. The cloud radio access network (CRAN) architecture facilitates centralization and synchronization among the distributed APs [24]. This architecture has recently gained interest in ISAC systems [11].\nDRAFT May 23, 2023\n3 There is usually a trade-off between sensing and communication performance due to the shared resources (e.g., time, frequency, power, and space). This trade-off can be balanced by exploiting the existing communication signals for sensing purposes or integrating sensing signals by guaranteeing a specific communication performance. Despite the progress made in this area, there is still a need for new processing and resource allocation schemes that can effectively address both communication and sensing requirements. This becomes even more challenging in cell-free ISAC with joint transmission/reception.\nThis work studies the detection of a single target in a cell-free ISAC system in the presence of clutter and imperfect channel state information (CSI). The clutter refers to the undesired received signals such as reflections from non-target objects. It can be treated as interference for sensing and will affect the performance of target detection. In this paper, the clutter is characterized by the unknown components of the channels between the ISAC transmitter and sensing receiver APs. However, the communication symbols contribute to sensing by the reflected paths toward the target. Therefore, these reflections are not considered as interference. This is why we design the precoding vectors so that we null the interference only for UEs. A power allocation algorithm is proposed to effectively maximize the sensing performance while ensuring that the communication performance remains satisfactory. The preliminary results for a simple channel model with perfect CSI for the communication and sensing channels, without considering clutter, have been published in [25]."
        },
        {
            "heading": "A. Related Work",
            "text": "Table I presents an overview of some of the research conducted on ISAC.1 The table highlights that a few papers have investigated the benefits of power control, with notable examples including [26] and [11]. Specifically, [26] proposes a power allocation strategy for a mono-static sensing scheme in a single-cell ISAC massive MIMO system. In contrast, [11] utilizes distributed radar sensing to estimate the target\u2019s location by jointly processing the received signals in a central unit. It also proposes a coordinated power allocation approach where a set of distributed transmitter\n1The acronyms in the table are given as OFDM (orthogonal frequency-division multiplexing), BF (beamforming), SE (spectral efficiency), BER (bit error rate), FD (full-duplex), TX (transmitter), RX (receiver), UL (uplink), DL (downlink), DFRC (dualfunctional radar and communications), AF (amplify-and-forward), SINR (signal-to-interference-and-noise ratio), w/w.o (with and without), mMIMO (massive MIMO), SIR (signal-to-interference ratio), V2I (vehicle-to-infrastructure), EKF (extended Kalman filtering), RMSE (root-mean-square error), ESA (effective sensing area), BS (base station), BW (bandwidth), and RL (reinforcement learning).\nMay 23, 2023 DRAFT\n4 APs individually serve their corresponding user equipments (UEs) in a cellular-type network. The proposed power allocation approach aims at minimizing the total transmit power while ensuring a minimum signal-to-interference-plus-noise ratio (SINR) for each UE and meeting the required Crame\u0301r-Rao lower bound to estimate the location of the target.\nTo the best of our knowledge, there is limited research on ISAC in cell-free massive MIMO systems. A recent study in [27] provides valuable insights into target detection analysis and the number of required antennas to achieve a certain detection probability. In contrast to our work, this study considers uplink communication and a distributed bi-static sensing scheme with a single transmitter AP. It proposes a protocol using two sensing modes: i) uplink channel estimation and ii) data payload segment of the communication frame. However, the study does not incorporate any power control mechanism. Joint sensing and communication beamforming (BF) design is proposed for a cell-free MIMO system in [28]. The proposed BF design is based on a max-min fairness formulation and is compared with two baseline approaches: i) communication-prioritized sensing BF and ii) sensing-prioritized communication BF. The results in [28] show that the joint design can achieve the communication SINR close to the SINR of the communication-prioritized approach and almost the same sensing SNR achieved by the sensing-prioritized approach. In this work, the authors assume perfect CSI and do not consider the derivation of the target detector. Moreover, the works [27] and [28] neglect the clutter\u2019s influence. However, clutter is unavoidable in practical scenarios and acts as interference for sensing which reduces the SINR and degrades the accuracy of target detection. Therefore, further research is necessary to evaluate the performance of ISAC in more practical scenarios."
        },
        {
            "heading": "B. Contributions",
            "text": "Unlike previous works, this paper considers target detection for ISAC in downlink cell-free massive MIMO systems using a multi-static sensing scheme. Two sensing scenarios are analyzed: i) only the downlink communication beams are utilized for sensing; or ii) additional sensing beams with a certain allocated power are jointly transmitted with the communication beams. In the second scenario, we aim to improve the sensing performance by dedicating some resources to sensing.\nThe communication performance is characterized by the minimum attained SINR by the UEs, and detection probability under a certain false alarm probability is used as the sensing performance metric. False alarm probability is the probability of that the system detects a target when the actual target is not present. A power allocation strategy is developed to optimize the\nDRAFT May 23, 2023\n5\nsensing performance while satisfying SINR constraints for communication UEs, and per-AP transmit power constraints.\nTo improve sensing performance, we aim to maximize the sensing SINR under the condition that the target is present.2 As discussed in [32, Chap. 3 and 15], given a fixed false alarm probability, detection probability increases with a higher signal-to-noise ratio (SNR). The main contributions of this paper are: \u2022 A system model is proposed to consider the joint impact of unknown sensing channel\ncoefficients and clutter. The latter is characterized by the target-free channels between transmitter APs and receiver APs. The channel estimation error is considered for the AP-UE channels, and a new SE expression is obtained by accounting for the interference created\n2The optimal design approach would involve optimizing the transmit power coefficients to maximize the probability of detection. However, such an approach poses a significant challenge due to the strong coupling between the test statistics and the power coefficients.\nMay 23, 2023 DRAFT\n6 by the additional sensing beams.\n\u2022 To maximize the sensing SINR while satisfying specific communication SINR constraints,\nwhich are equivalent to the SE constraints, a concave-convex programming (CCP)-based power allocation algorithm is proposed. To evaluate the effectiveness of the proposed power allocation algorithm, a communication-centric approach, called comm.-centric, is used as the baseline algorithm. The objective of the baseline algorithm is to minimize the total power consumption subject to the same constraints as the proposed algorithm. Conversely, the proposed algorithm maximizes the sensing SINR. Three algorithms are compared numerically: i) the communication-centric (comm.-centric); ii) the proposed ISAC power allocation algorithm ii.a) without additional sensing beams (ISAC) and ii.b) with dedicated additional sensing beams (ISAC+S). \u2022 We derive the maximum a posteriori ratio test (MAPRT) detector for target detection. The\ndetector optimally fuses received signals from the receiver APs during multiple time slots in a centralized manner to detect a target with a known location within a hotspot area. The detector takes into account the presence of clutter, which is not completely canceled out, and the target\u2019s unknown radar cross-section (RCS) values. Moreover, we take into account the potential correlation between different arrival and departure directions to/from the target. The new target detector requires more advanced processing compared to the one proposed in our previous work [25], which neglected the existence of clutter. We verify numerically that the proposed advanced processing scheme offers significantly improved detection probability. The rest of the paper is organized as follows. Section II describes the system model, including the scenario, channel model, and signal model for communication and sensing. Uplink channel estimation and transmit ISAC precoding vectors are presented in Section III, while the downlink communication and SE are provided in Section IV. Sections V and VI are devoted to the multistatic sensing algorithm and deriving the MAPRT detector, respectively. The proposed power allocation algorithm is described in Section VII. The numerical results are discussed in Section VIII. Finally, Section IX concludes the paper."
        },
        {
            "heading": "C. Notations",
            "text": "The following mathematical notations are used throughout the paper. Scalars, vectors, and matrices are denoted by regular font, boldface lowercase, and boldface uppercase letters, respectively. The superscript T shows the transpose operation. Complex conjugate and Hermitian\nDRAFT May 23, 2023\n7\ntranspose are illustrated by the superscripts \u2217, and H , respectively. The operation of the vectorization of a matrix is represented by vec(\u00b7) and the block diagonalization operation is denoted by blkdiag(\u00b7). The determinant, trace, and real parts of a matrix are represented by det(\u00b7), Tr(\u00b7), and <(\u00b7), respectively. A \u2297 B represents the Kronecker product between matrix A and B. The absolute value of a scalar is denoted by | \u00b7 | while \u2016 \u00b7 \u2016 shows the Euclidean norm of a vector."
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": "We consider an ISAC system with downlink communication and multi-static sensing in a C-RAN architecture, as illustrated in Fig. 1. In this system, each AP either serves as an ISAC transmitter or a sensing receiver. The number of transmitter and receiver APs are denoted by Ntx and Nrx at a given instant, respectively. Each AP is equipped with M isotropic antennas deployed as a uniform linear array (ULA).\nAll APs are connected via fronthaul links to the edge cloud and fully synchronized. We consider the centralized implementation of cell-free massive MIMO [23] for both communication and sensing-related processing. The Ntx ISAC transmitter APs jointly serve the Nue UEs by transmitting centrally precoded signals. Optionally, an additional sequence of sensing symbols can be integrated into the transmission that shares the same waveform and time-frequency resources with the communication symbols. When this is the case, the transmitter APs jointly steer a centralized beam toward a potential target with a known location within a hotspot area. On the other hand, the Nrx APs operate as sensing receivers by simultaneously sensing the location of the target to determine whether there is a target or not. All processing is done at the edge cloud in a centralized manner.\nFor simplicity, we assume there is a line-of-sight (LOS) connection between the target location and each transmitter/receiver AP, and the NLOS connections are neglected. Assuming\nMay 23, 2023 DRAFT\n8 the antennas at the APs are half-wavelength-spaced, the antenna array response vector for the azimuth angle \u03d5 and elevation angle \u03d1, denoted by a(\u03d5, \u03d1) \u2208 CM , is [33]\na(\u03d5, \u03d1) = [ 1 ej\u03c0 sin(\u03d5) cos(\u03d1) . . . ej(M\u22121)\u03c0 sin(\u03d5) cos(\u03d1) ]T . (1)\nIn this system model, si represents the zero-mean downlink communication symbol for UE i with unit power, i.e., E{|si|2} = 1. The sensing signal, denoted by s0, is also assumed to have zero mean and unit power, i.e., E{|s0|2} = 1. We assume that the sensing signal is independent of the UEs\u2019 data signals to simplify the analysis and power allocation algorithm3. In accordance with [13], the transmitted signal xk[m] \u2208 CM from transmitter AP k at time instance m can be written as xk[m] =\nNue\u2211 i=0 \u221a \u03c1iwi,ksi[m] = WkDs[m]\u03c1, (2)\nfor k = 1, . . . , Ntx, where wi,k \u2208 CM and w0,k \u2208 CM are the transmit precoding vectors for transmitter AP k corresponding to UE i and the sensing signal, respectively. In (2), Wk =[ w0,k w1,k \u00b7 \u00b7 \u00b7 wNue,k ] , Ds[m] = diag (s0[m], s1[m], . . . , sNue [m]) is the diagonal matrix containing the sensing and communication symbols, and \u03c1 = [ \u221a \u03c10 . . . \u221a \u03c1Nue ] T .\nIn line with the C-RAN architecture and the centralized operation of cell-free massive MIMO [23], the precoding vectors for each UE and the target are jointly selected based on the CSI from all the NtxM distributed transmit antennas. Hence, the precoding vectors for each transmitter AP are extracted from the concatenated centralized precoding vectors given as\nwi = [ wTi,1 wTi,2 . . . wTi,Ntx ]T \u2208 CNtxM , (3)\nfor i = 0, 1, . . . , Nue. As seen in (2), there is a common power control coefficient for each UE, \u03c1i \u2265 0, and for the target, \u03c10 \u2265 0, since the precoding is centralized. The rationale is to preserve the direction of the centralized precoding vectors in (3) and, hence, not to destroy its favorable characteristics constructed based on the overall channel from NtxM antennas. Using the independence of the data and sensing signals, the average transmit power for transmitter AP k is given as\nPk = E { \u2016xk[m]\u20162 } = Nue\u2211 i=0 \u03c1iE { \u2016wi,k\u20162 } , k = 1, . . . , Ntx. (4)\nEach of the average transmit powers should satisfy the maximum power limit Ptx, i.e., Pk \u2264 Ptx.\nWe consider block fading communication channels where we have constant and independent channel realizations in each time-frequency coherence block. We let hi,k \u2208 CM denote the\n3The sensing signal can instead be selected as a linear combination of UEs\u2019 data signals to potentially improve the\ncommunication performance for the UEs nearby the hotspot area. We leave the analysis for this case to future work.\nDRAFT May 23, 2023\n9 channel from transmitter AP k to UE i. We assume a correlated Rayleigh fading distribution\nfor which hi,k \u223c CN (0,Ri,k) where Ri,k = E { hi,khHi,k } is the spatial correlation matrix that includes the combined effect of geometric path loss, shadowing, and spatial correlation among the antennas for the channel realizations. We define the communication channel from all the NtxM\ntransmit antennas to UE i in the network as hi = [ hTi,1 . . . h T i,Ntx ]T \u2208 CNtxM . Similarly, the concatenated array response vector from all the NtxM transmit antennas to the target is given by\nh0 = [ aT (\u03d51, \u03d11) . . . aT (\u03d5Ntx , \u03d1Ntx) ]T \u2208 CNtxM using (1). Here, \u03d5k and \u03d1k are the azimuth and elevation angles from transmitter AP k to the target location, respectively.\nImperfect CSI of communication channels is considered, and the minimum mean-squared error\n(MMSE) channel estimation approach is used during the uplink channel estimation phase."
        },
        {
            "heading": "III. UPLINK CHANNEL ESTIMATION AND TRANSMIT ISAC PRECODING VECTORS",
            "text": "In this section, we will explicate the channel estimation procedure that leverages the transmitted uplink pilot symbols and elaborate on the selection of the ISAC precoding vectors based on the estimated UE channels and the location of the sensing point."
        },
        {
            "heading": "A. Uplink Channel Estimation",
            "text": "Let us define the length of the coherence blocks and the pilot sequences by \u03c4c and \u03c4p < \u03c4c, respectively. Moreover, a set of \u03c4p mutually orthogonal pilot sequences are denoted by \u03c61, . . . ,\u03c6\u03c4p \u2208 C\u03c4p , where \u2016\u03c6t\u20162 = \u03c4p, for t = 1, . . . , \u03c4p. The pilot sequences are assigned to the Nue UEs. If the number of pilot sequences is less than the number of UEs (i.e., \u03c4p < Nue), then each pilot sequence may be assigned to multiple UEs. Let ti \u2208 {1, . . . , \u03c4p} denote the index of the pilot sequence that is assigned to UE i, and we define Pi = {j \u2208 {1, . . . , Nue}|tj = ti} as the set of UEs that share the same pilot with UE i including itself. The received signal at the ISAC transmitter AP k during the entire pilot transmission is denoted by Ypk \u2208 CM\u00d7\u03c4p where\nYpk = Nue\u2211 i=1 \u221a \u03b7ihi,k\u03c6Tti + Nk, (5)\nwhere \u03b7i > 0 is the transmit power by UE i and Nk \u2208 CM\u00d7\u03c4p is the received noise at AP k with independent and identically distributed (i.i.d.) CN (0, \u03c32n) entries. We employ the standard MMSE channel estimator [23]. With respect to estimating hi,k, we form ypti,k = 1\u221a \u03c4p Ypk\u03c6\u2217ti \u2208 C M as ypti,k = \u221a \u03b7i\u03c4phi,k\ufe38 \ufe37\ufe37 \ufe38\nDesired part\n+ \u2211\nj\u2208Pi\\{i} \u221a \u03b7j\u03c4phj,k\ufe38 \ufe37\ufe37 \ufe38\nInterference part\n+ nti,k\ufe38\ufe37\ufe37\ufe38 Noise , (6)\nwhere nti,k = 1\u221a\u03c4pNk\u03c6 \u2217 ti \u223c CN (0, \u03c32nIM). By [23, Cor. 4.1], the MMSE estimate of hi,k is\nMay 23, 2023 DRAFT\n10\nh\u0302i,k = \u221a \u03b7i\u03c4pRi,k\u03a8\u22121ti,ky p ti,k , (7)\nwhere Ri,k and \u03a8ti,k are the spatial correlation matrix corresponding to channel hi,k and the correlation matrix of the received signal, respectively, is given by\nRi,k = E { hi,khHi,k } , \u03a8ti,k = E { ypti,k ( ypti,k )H} = \u2211 j\u2208Pi \u03b7j\u03c4pRj,k + \u03c32nIM . (8)\nThe channel estimation error is h\u0303i,k = hi,k\u2212h\u0302i,k where h\u0303i,k \u223c CN (0,Cik) and the error correlation matrix is Cik = E { h\u0303i,kh\u0303 H\ni,k } = Ri,k \u2212 \u03b7i\u03c4pRi,k\u03a8\u22121ti,kRi,k. (9)"
        },
        {
            "heading": "B. Transmit ISAC Precoding Vectors",
            "text": "The unit-norm regularized zero-forcing (RZF) precoding vector [23] is constructed for UE i\nas wi = w\u0304i\u2016w\u0304i\u2016 , where\nw\u0304i= ( Nue\u2211 j=1 h\u0302jh\u0302 H j + \u03bbINtxM )\u22121 h\u0302i, i = 1, . . . , Nue, (10)\nand \u03bb is the regularization parameter. Note that since the communication symbols also contribute to sensing by the reflected paths toward the target, they are not considered as interference for the sensing target. Hence, we aim at nulling the interference only for the UEs. To null the destructive interference from the sensing signal to the UEs, the sensing precoding vector w0 can be selected as the ZF precoder, i.e., by projecting h0 onto the nullspace of the subspace spanned by the UE channel vectors as in [13], i.e.,\nw0 = ( INtxM \u2212 UUH ) h0\u2225\u2225(INtxM \u2212 UUH)h0\u2225\u2225 , (11)\nwhere U is the unitary matrix with the orthogonal columns that span the column space of the matrix [ h\u03021 . . . h\u0302Nue ] ."
        },
        {
            "heading": "IV. DOWNLINK COMMUNICATION AND SPECTRAL EFFICIENCY FOR ISAC",
            "text": "The received signal at UE i is given as\nyi[m] = Ntx\u2211 k=1 hHi,kxk[m] + ni[m] = \u221a \u03c1ihHi wisi[m]\ufe38 \ufe37\ufe37 \ufe38 Desired signal\n+ Nue\u2211\nj=1,j 6=i \u221a \u03c1jhHi wjsj[m]\ufe38 \ufe37\ufe37 \ufe38\nInterference signal due to the other UEs\n+ \u221a \u03c10hHi w0s0[m]\ufe38 \ufe37\ufe37 \ufe38\nInterference signal due to the sensing +ni[m]\ufe38 \ufe37\ufe37 \ufe38 Noise , (12)\nwhere the receiver noise at the UE i is represented by ni[m] \u223c CN (0, \u03c32n). We introduce the complex conjugation on the channels hi,k for notational convenience in the downlink, as it is\nDRAFT May 23, 2023\n11\ndefined in [25]. The following lemma presents an achievable SE for each UE i, for i = 1, . . . , Nue. Lemma 1. For a C-RAN-assisted cell-free massive MIMO system with ISAC, where only E { hHi wi } is known at UE i, an achievable SE of this UE is given by\nSE (dl) i = \u03c4c \u2212 \u03c4p \u03c4c log2\n( 1 + SINR\n(dl) i\n) , (13)\nwith\nSINR (dl) i = \u03c1i \u2223\u2223E{hHi wi}\u2223\u22232\u2211Nue j=1 \u03c1jE {\u2223\u2223hHi wj\u2223\u22232}\u2212 \u03c1i \u2223\u2223E{hHi wi}\u2223\u22232 + \u03c10E{\u2223\u2223\u2223h\u0303Hi w0\u2223\u2223\u22232}+ \u03c32n , (14)\nwhere h\u0303i = [ h\u0303Ti,1 . . . h\u0303 T i,Ntx ]T \u2208 CNtxM is the concatenated channel estimation error.\nProof. See Appendix A.\nThe first two terms in the denominator of (14) is related to the interference power due to the\nother UEs in the system and self interference, while the third one, i.e., \u03c10E{|h\u0303 H i w0|2} is the interference power coming from the sensing symbols. The pre-log factor represents the fraction of the downlink data within a coherence block.\nThe SE given above is achievable when channel coding is applied over a long data sequence during many coherence blocks. In line with this requirement, we assume that we have multiple target locations in the system where sensing each of them takes a portion of the whole communication interval. This implies that the precoding vector w0 changes over time during the whole communication interval according to different locations of the targets and the channels of UEs that vary from coherence block to coherence block. Therefore, the expectation E{|h\u0303Hi w0|2} in (14) should be taken over both hi and w0 for different channel realizations and sensing locations. This can be done using Monte Carlo simulation."
        },
        {
            "heading": "V. MULTI-STATIC SENSING",
            "text": "We consider multi-static sensing where the sensing transmitters and the receivers are not co-located. Apart from the Ntx transmitter APs, the other Nrx receiver APs jointly receive the sensing signals for target detection. Each receiver AP receives both desired and undesired signals when the target is present. The former is the reflected signals from the target, while the latter is independent of the presence of the target.\nMay 23, 2023 DRAFT\n12\nApart from the noise, the undesired signal includes clutter and LOS paths between transmitter and receiver APs. Clutter is composed of two terms: i) the non-line-of-sight (NLOS) paths due to scattering/reflection by the permanent objects and ii) the NLOS paths due to the temporary obstacles in the environment. The location and shape of permanent objects such as buildings, walls, or mountains are typically fixed and can be modeled accurately. This means that the LOS and NLOS paths caused by these permanent obstacles can be estimated or measured beforehand using various techniques such as ray tracing, simulation, or empirical models. Therefore, we assume that the LOS and NLOS paths due to the permanent obstacles are known. Assuming the transmit signal xk[m] is also known at the edge cloud, the known undesired parts of the received signal at each receiver AP can be canceled. However, the unknown part corresponding to the NLOS paths caused by temporary obstacles remains.\nLet us denote the unknown NLOS channel matrix between transmitter AP k and receiver AP r by Hr,k \u2208 CM\u00d7M . These channels correspond to the reflected paths through the temporary obstacles and are henceforth referred to as target-free channels. After canceling the known undesired terms, the received signal at AP r in the presence of the target is formulated as\nyr[m] = Ntx\u2211 k=1 \u03b1r,k \u221a \u03b2r,ka(\u03c6r, \u03b8r)aT (\u03d5k, \u03d1k)xk[m]\ufe38 \ufe37\ufe37 \ufe38\n,gr,k[m]\n+ Ntx\u2211 k=1 Hr,kxk[m]\ufe38 \ufe37\ufe37 \ufe38 Interference +nr[m]. (15)\nwhere nr[m] \u223c CN (0, \u03c32nIM) is the receiver noise at the M antennas of receiver AP r. The defined vector gr,k[m] \u2208 CM in (15) is the known part of each reflected path. The vector Hr,kxk[m]\ncan be considered as the interference for the target detection. The matrix \u03b1r,k \u221a \u03b2r,ka(\u03c6r, \u03b8r)aT (\u03d5k, \u03d1k) represents the reflected path through the target where \u03c6r and \u03b8r are respectively the azimuth and elevation angles from the target location to receiver AP r. Here, \u03b1r,k is the bi-static unknown RCS of the target through the reflection path from transmitter AP k to receiver AP r. We follow the Swerling-I model for the RCS, in which the target\u2019s velocity is low compared to the total sensing duration. Hence, \u03b1r,k is constant throughout the consecutive symbols collected for sensing according to the distribution \u03b1r,k \u223c CN (0, \u03c32r,k). The \u03b2r,k is the channel gain of the path from transmitter AP k to the target and then from the target to the receiver AP r. We inject the phase-shift of this path to the unknown complex-valued RCS \u03b1r,k without loss of generality.\nLet us define dtx,k as the distance between transmitter AP k and target location and drx,r as the distance between receiver AP r and target location. Using the radar range equation for bi-static\nDRAFT May 23, 2023\n13\nsensing in [32, Chap. 2], the channel gain \u03b2r,k can be computed as\n\u03b2r,k = \u03bb2c\n(4\u03c0)3d2tx,kd 2 rx,r\n, (16)\nwhere \u03bbc is the carrier wavelength.\nEach receiver AP sends their respective signals yr[m], for r = 1, . . . , Nrx, to the edge cloud. The received signals from all the Nrx APs can be concatenated to obtain the overall sensing signal y[m] = [ yT1 [m] \u00b7 \u00b7 \u00b7 yTNrx [m] ]T \u2208 CNrxM . (17)\nWe use the correlated Rayleigh fading model for the NLOS channels Hr,k, which is modeled using the Kronecker model [34]. Let us define the random matrix Wch,(r,k) \u2208 CM\u00d7M with i.i.d. entries with CN (0, 1) distribution. The matrix Rrx,(r,k) \u2208 CM\u00d7M represents the spatial correlation matrix corresponding to receiver AP r and with respect to the direction of transmitter AP k. Similarly, Rtx,(r,k) \u2208 CM\u00d7M is the spatial correlation matrix corresponding to transmitter AP k and with respect to the direction of receiver AP r. Then, the channel Hr,k is written as\nHr,k = R 1 2 rx,(r,k)Wch,(r,k) ( R 1 2 tx,(r,k) )T , (18)\nwhere the channel gain is determined by the geometric path loss and shadowing, and is included in the spatial correlation matrices. Now, we define hr,k = vec (Hr,k) as the vectorized unknown\ntarget-free channel between receiver AP r and the transmitter AP k where hr,k \u223c CN ( 0,Rr,k ) \u2208 CM2 . Then, the channel vector hr,k can be expressed as\nhr,k = ( R 1 2 tx,(r,k) \u2297 R 1 2 rx,(r,k) ) \ufe38 \ufe37\ufe37 \ufe38\n=R 1 2 r,k\nvec ( Wch,(r,k) ) , (19)\nwhere we have used the identity vec(ABC) = (CT \u2297A)vec(B) with A = R 1 2\nrx,(r,k), B = Wch,(r,k),\nand C = R 1 2\ntx,(r,k). We also recognize the square root of the spatial correlation matrix Rr,k by noting that E { vec ( Wch,(r,k) ) vec ( Wch,(r,k) )H} = IM2 . Similarly, the interference signal for each receiver AP r can be rewritten as Ntx\u2211 k=1 Hr,kxk[m] = Ntx\u2211 k=1 ( xTk [m]\u2297 IM ) hr,k = ( xT [m]\u2297 IM ) hr, (20) where we concatenate the unknown and known parts of the interference signals, respectively as\nhr = [ hTr,1 \u00b7 \u00b7 \u00b7 hTr,Ntx ]T \u2208 CNtxM2 , x[m] = [ xT1 [m] \u00b7 \u00b7 \u00b7 xTNtx [m] ]T \u2208 CNtxM . (21)\nTo introduce a more concise notation, we concatenate the unknown sensing channel coefficients for each receiver r as \u03b1r , [\u03b1r,1 . . . \u03b1r,Ntx ]T \u2208 CNtx , then collect all \u03b1r terms in a vector as\nMay 23, 2023 DRAFT\n14\n\u03b1 = [\u03b1T1 . . . \u03b1 T Nrx ]T \u2208 CNtxNrx . Moreover, using gr,k[m] from (15), which is the known part of the received sensing signal, we define the concatenated matrix for receiver AP r and symbol m\nas Gr[m] = [ gr,1[m] \u00b7 \u00b7 \u00b7 gr,Ntx [m] ] \u2208 CM\u00d7Ntx . Then, the overall received signal in (17) can be expressed as\ny[m] = blkdiag (G1[m], . . . ,GNrx [m])\ufe38 \ufe37\ufe37 \ufe38 ,G[m]\n\u03b1 + ( INrx \u2297 ( xT [m]\u2297 IM ))\ufe38 \ufe37\ufe37 \ufe38 ,X[m] h + n[m], (22)\nwhere blkdiag(\u00b7) constructs a block diagonal matrix, h = [ hT1 \u00b7 \u00b7 \u00b7 hTNrx ]T \u2208 CNtxNrxM2 , and n[m]= [ nT1 [m] \u00b7 \u00b7 \u00b7 nTNrx [m]\n]T \u2208CNrxM is the concatenated receiver noise. Given that the channels Hr,k are independent for different r and/or k (due to sufficiently separated APs), the correlation matrix of h becomes the block diagonal matrix of the spatial correlation matrices Rr,k, i.e.,\nR =E { hhH } = blkdiag ( R1,1, \u00b7 \u00b7 \u00b7 ,R1,Ntx , \u00b7 \u00b7 \u00b7 ,RNrx,1, \u00b7 \u00b7 \u00b7 ,RNrx,Ntx ) . (23)"
        },
        {
            "heading": "VI. MAPRT DETECTOR FOR SENSING",
            "text": "In this paper, the detection probability, denoted by Pd, is utilized to evaluate the sensing performance. Pd is defined as the probability of detecting the target given that it is present. We employ the MAPRT detector for our system model and extend the derivation in [35], which considers only a single transmitter and single-antenna receivers.\nDifferent from [35], in our system, the transmitted signals are known due to the C-RAN architecture. Furthermore, the relationship between the received signals at the receiver APs and the unknown RCSs is more complex due to the direction-dependent MIMO channels from the transmitter APs to the receiver APs through the target. Our derived test statistics demonstrates not only how the detector should be implemented but also how the different signals from the receiver APs should be centrally fused in the edge cloud. The detection is applied using \u03c4 received sensing symbols for a particular target location. Let us define the vectors y\u03c4 \u2208 CMNrx\u03c4 , n\u03c4 \u2208 CMNrx\u03c4 , h\u03c4 \u2208 CMNrx\u03c4 , and g\u03c4 \u2208 CMNrx\u03c4 constructed by concatenating y[m], n[m], X[m]h, and G[m]\u03b1 in (22), respectively for \u03c4 symbols. The binary hypothesis used in the MAPRT detector is written as H0 : y\u03c4 = h\u03c4 + n\u03c4\nH1 : y\u03c4 = g\u03c4 + h\u03c4 + n\u03c4 . (24)\nThe null hypothesis H0 represents the case that there is no target in the sensing area, while the alternative hypothesis H1 represents the existence of the target. We let H \u2208 {H0,H1} be the\nDRAFT May 23, 2023\n15\nset of hypotheses. We also recall that \u03b1 and h are the vector of unknown channel gains with respect to the RCS of the target and the vector of unknown channel gains with respect to the target-free channels, respectively. The joint RCS estimation, target-free channel estimation, and hypothesis testing problem can be written as( \u03b1\u0302, h\u0302, H\u0302 ) = arg max\n\u03b1,h,H p (\u03b1,h,H|y\u03c4 ) , (25)\nwhere p (\u03b1,h,H|y\u03c4 ) is the joint probability density function of \u03b1, h, and H given the received signal vector y\u03c4 . Following the approach in [35] and [25] for our problem and assuming \u03b1 and h are independent of each other, the corresponding MAPRT detector can be expressed as\n\u039b = max \u03b1,h p (y\u03c4 |\u03b1,h,H1) p (\u03b1|H1) p (h|H1)\nmax h p (y\u03c4 |h,H0) p (h|H0)\nH1 \u2265 < H0 \u03bbd, (26)\nwhere \u03bbd is the threshold used by the detector, which is selected to achieve a desired false alarm probability and p(\u00b7) denotes the probability density function (PDF). In (26), we maximize the joint PDFs with respect to the estimation parameters in (25) under the hypothesis H1 and H0 in the numerator and the denominator, respectively. To streamline the analysis, we define the above-mentioned optimization problems by \u039bnum and \u039bden, respectively, which are expressed as\n\u039bnum = max \u03b1,h p (y\u03c4 |\u03b1,h,H1) p (\u03b1|H1) p (h|H1) , (27)\n\u039bden = max h p (y\u03c4 |h,H0) p (h|H0) . (28)\nThe solutions to these optimization problems under H0 and H1 are presented in Lemma 2.\nLemma 2. Consider the binary hypothesis defined in (24) and the overall received signal for sensing for all time instants m \u2208 {1, . . . , \u03c4} as defined in (22). Given that h \u223c CN (0,R) and \u03b1 \u223c CN (0,Rrcs), where Rrcs is the covariance matrix of the correlated RCS values, we have the following results.\nOptimization under H0: Given that the hypothesis H0 is true, the denominator of the\nlikelihood ratio in (26) is\n\u039bden = C1C2 exp\n( bHD\u22121b\u2212 F\n\u03c32n\n) , (29)\nwhere C1 = 1(\u03c0\u03c32n)MNrx\u03c4 and C2 = 1\u03c0M2NtxNrx det(R) . The matrix D, the vector b, and the scalar F are defined in (32), (31), and (33), respectively.\nMay 23, 2023 DRAFT\n16\nOptimization under H1: Given that the hypothesis H1 is true, the numerator of the likelihood\nratio in (26) is given as\n\u039bnum = C1C2C3 exp  1 \u03c32n [ aH bH ] C E EH D \u22121 a b \u2212 1 \u03c32n F  , (30) where\na = \u03c4\u2211\nm=1\nGH [m]y[m], b = \u03c4\u2211\nm=1\nXH [m]y[m], (31)\nC = \u03c4\u2211\nm=1\nGH [m]G[m] + \u03c32nR \u22121 rcs, D = \u03c4\u2211 m=1 XH [m]X[m] + \u03c32nR \u22121, (32)\nE = \u03c4\u2211\nm=1\nGH [m]X[m], F = \u03c4\u2211\nm=1\n\u2016y[m]\u20162. (33)\nProof. See Appendix B.\nBy substituting (29) and (30) into (26), the MAPRT detector is obtained as\n\u039b = C3 exp  1 \u03c32n [ aH bH ] C E EH D \u22121 \u2212 0 0 0 D\u22121 a b H1\u2265 <\nH0\n\u03bbd. (34)\nNow, let us define the test statistics T , ln(\u039b), which is given as\nT = ln(C3) + 1\n\u03c32n\n[aH bH]  C E\nEH D\n\u22121 \u2212 0 0\n0 D\u22121 a b  . (35) Finally, the decision is taken as follows\nH\u0302 = H1 if T \u2265 ln(\u03bbd),H0 if T < ln(\u03bbd). (36)"
        },
        {
            "heading": "VII. POWER ALLOCATION FOR ISAC",
            "text": "In Section VI, we have derived the MAPRT detector. It uses the already selected power allocation strategy, which is the second stage of our two-stage design approach. In this section, we maximize the sensing SINR, denoted by SINRs , under the presumption that the target is present. The optimization problem can be cast as\nmaximize \u03c1\u22650 SINRs (37a) subject to SINR(dl)i \u2265 \u03b3c, i = 1, . . . , Nue (37b)\nPk \u2264 Ptx, k = 1, . . . , Ntx (37c)\nDRAFT May 23, 2023\n17\nwhere \u03b3c is the minimum required SINR threshold to provide a certain SE to all the UEs and Ptx is the maximum transmit power per AP. The sensing SINR is given as\nSINRs = \u03c1TA\u03c1\n\u03c4MNrx\u03c32n + \u03c1 TB\u03c1\n, (38)\nwhere\nA = \u03c4\u2211\nm=1\nDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 \u221a \u03b2r,k\u03b2r,jWHk a \u2217(\u03d5k, \u03d1k)aH(\u03c6r, \u03b8r)\n\u00d7 cov (\u03b1r,j, \u03b1r,k) a(\u03c6r, \u03b8r)aT (\u03d5j, \u03d1j)Wj ) Ds[m], (39)\nand\nB = \u03c4\u2211\nm=1\nDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 tr ( Rrx,(r,k) ) WHk R T tx,(r,k)Wk ) Ds[m]. (40)\nThe derivation of (38) is given in Appendix C. The matrices A and B are Hermitian symmetric. Since the entries of \u03c1 are real valued, we have \u03c1TA\u03c1 = \u03c1T<(A)\u03c1 and \u03c1TB\u03c1 = \u03c1T<(B)\u03c1. Let us define Ar = <(A) and Br = <(B). Then, the sensing SINR can be written as\nSINRs = \u03c1TAr\u03c1\n\u03c4MNrx\u03c32n + \u03c1 TBr\u03c1\n. (41)\nIt can be shown that the optimization problem in (37) is equivalent to [36]\nmaximize \u03c1\u22650, t \u03c1TAr\u03c1 t\n(42a)\nsubject to \u03c4MNrx\u03c32n + \u03c1 TBr\u03c1 \u2264 t (42b)\nSINR (dl) i \u2265 \u03b3c, i = 1, . . . , Nue (42c)\nPk \u2264 Ptx, k = 1, . . . , Ntx. (42d)\nLet us define the objective function as f (\u03c1, t) = \u03c1 TAr\u03c1 t in terms of the optimization variable[ \u03c1T t ]T . The function f (\u03c1, t) is a convex function (the proof is given in Appendix D).\nUtilizing the convexity of the objective function and utilizing the first-order Taylor approximation around the previous iterate ( \u03c1(c\u22121), t(c\u22121) ) , where c is the iteration counter, the objective function is lower bounded as\nf (\u03c1, t) \u2265 f ( \u03c1(c\u22121), t(c\u22121) ) + \u03c1 t \u2212 \u03c1(c\u22121) t(c\u22121) T \u2207f (\u03c1(c\u22121), t(c\u22121)) . (43)\nMay 23, 2023 DRAFT\n18\nAt iteration c, instead of the actual objective function, we maximize its lower bound according to the concave-convex procedure. After removing the constant terms that are independent of the optimization variables in use, we obtain the linearized objective function to be maximized as\u03c1 t T \u2207f (\u03c1(c\u22121), t(c\u22121)) = \u03c1 t T  2Ar\u03c1(c\u22121)t(c\u22121) \u2212(\u03c1 (c\u22121)) T Ar\u03c1(c\u22121)\n(t(c\u22121)) 2  = 2\u03c1TAr\u03c1(c\u22121) t(c\u22121) \u2212 ( \u03c1(c\u22121) )T Ar\u03c1(c\u22121) (t(c\u22121)) 2 t\n= ( 2\u03c1\u2212 t\nt(c\u22121) \u03c1(c\u22121) )T (Ar\u03c1(c\u22121) t(c\u22121) ) . (44)\nNow, the optimization problem can be rewritten as\nminimize \u03c1\u22650, t\n\u2212 (\n2\u03c1\u2212 t t(c\u22121)\n\u03c1(c\u22121) )T (Ar\u03c1(c\u22121)\nt(c\u22121)\n) (45a)\nsubject to (42b), (42c), (42d). (45b)\nThe quadratic constraints in (42b) are convex and the communication SINR constraints in (42c)\ncan be rewritten as second-order cone (SOC) constraints in terms of \u03c1 = [ \u221a \u03c10 . . . \u221a \u03c1Nue ]\nT as\u2225\u2225\u2225[ai,0\u221a\u03c10 ai,1\u221a\u03c11 . . . ai,i\u221a\u03c1i . . . . . . ai,Nue\u221a\u03c1Nue \u03c3n]\u2225\u2225\u2225 \u2264 \u221a\u03c1ibi\u221a\u03b3c , i = 1, . . . , Nue, (46)\nwhere bi = \u2223\u2223E{hHi wi}\u2223\u2223 , i = 1, . . . , Nue (47) ai,0 = \u221a E {\u2223\u2223\u2223h\u0303Hi w0\u2223\u2223\u22232}, i = 1, . . . , Nue (48)\nai,j = \u221a E {\u2223\u2223hHi wj\u2223\u22232}, i = 1, . . . , Nue, j = 1, . . . , Nue, j 6= i (49)\nai,i = \u221a E {\u2223\u2223hHi wi\u2223\u22232}\u2212 b2i , i = 1, . . . , Nue (50)\nfrom (14). The third set of constraints in (42d) can also be rewritten in SOC form as \u2016Fk\u03c1\u2016 \u2264 \u221a Ptx, k = 1, . . . , Ntx (51)\nwhere Fk = diag (\u221a E {\u2016w0,k\u20162}, . . . , \u221a E {\u2016wNue,k\u20162} ) from (4). Now, the optimization problem in (45) can be expressed as a concave-convex programming problem as\nminimize \u03c1\u22650, t\n\u2212 (\n2\u03c1\u2212 t t(c\u22121)\n\u03c1(c\u22121) )T (Ar\u03c1(c\u22121)\nt(c\u22121)\n) (52a)\nsubject to (42b), (46), (51). (52b)\nDRAFT May 23, 2023\n19\nAlgorithm 1 Concave-Convex Procedure for Power Allocation 1: Initialization: Set an arbitrary initial positive \u03c1(0) and the solution accuracy > 0. Set the\niteration counter to c = 0 and t(0) = \u03c4MNrx\u03c32n + ( \u03c1(0) )T Br\u03c1(0).\n2: c\u2190 c+ 1. 3: Set \u03c1(c) and t(c) to the solution of the convex problem in (52), where the previous iterate\n\u03c1(c\u22121) and t(c\u22121) are taken as constant. 4: If ( 2 ( \u03c1(c) \u2212 \u03c1(c\u22121) ) \u2212 t(c)\u2212t(c\u22121)\nt(c\u22121) \u03c1(c\u22121) )T Ar \u03c1 (c\u22121) t(c\u22121) \u2264 , terminate the iterations. Otherwise\nreturn to Step 2.\n5: Output: The transmit power coefficients \u03c1(c).\nThis problem can be solved using the concave-convex procedure, whose steps are outlined in Algorithm 1. Under some mild conditions, this algorithm is guaranteed to converge to a stationary point of the problem [37]."
        },
        {
            "heading": "VIII. NUMERICAL RESULTS",
            "text": "In this section, we provide numerical results to quantify the tradeoff between communications and sensing using the proposed MAPRT detector and power allocation algorithm. A total area of 500 m \u00d7 500 m is considered within which UEs are randomly generated. During each sensing period, the target\u2019s location is fixed and known, but it can be anywhere within a 15 m \u00d7 15 m sensing hotspot region located in the center of the area. The interference \u03c10E{|h\u0303 H i w0|2} created by the sensing beams to the UEs in (14) is computed by averaging over 1000 target locations in this region. We assume that the Ntx +Nrx APs are also uniformly generated in the network area; however, they are fixed during the simulation. The number of transmitter APs is Ntx = 16. The Nrx = 2 closest APs to the sensing hotspot area are selected as the sensing receivers. The 2D locations of all the APs and the target are illustrated in Fig 2. In our simulation, we consider a total of Nue = 8 UEs.\nThe maximum transmit power per AP is 1 W and the uplink pilot transmission power is 0.2 W. The path loss for the communication channels and the target-free channels are modeled by the 3GPP Urban Microcell model, defined in [38, Table B.1.2.1-1], with the difference that for the latter the channel gains are multiplied by an additional scaling parameter, s \u2208 (0, 1) to suppress the known parts of the target-free channels due to LOS and permanent obstacles. Hence, the higher the value of s is, the stronger the clutter power is. On the other hand, the sensing channel\nMay 23, 2023 DRAFT\n20\ngains are computed by (16). The carrier frequency, the bandwidth, and the noise variance are set to 1.9 GHz, 20 MHz, and \u221294 dBm, respectively.\nThe spatial correlation matrices for the communication channels are generated by using the local scattering model in [23, Sec. 2.5.3], while the RCS of the target is modeled by the Swerling-I model where \u03b1r,k \u223c CN (0, \u03c32r,k). For simplicity, we assume that the RCS values are independent and have the same variance \u03c32r,k = \u03c3 2 rcs for each pair of transmitter AP k and receiver AP r.\nThe communication SINR threshold is set to 3 dB for each UE. The detection threshold, \u03bbd in (36), is determined based on the false alarm probability Pfa of either 0.1 or 0.01, which are relevant for radar applications [35] and can be improved more by using specific techniques [32]. We use the MAPRT detector with a sensing period equal to the transmission time of \u03c4 symbols out of a total of \u03c4c = 200 symbols per coherence interval with \u03c4p = 10. The sensing period, \u03c4 , is set to 10 and the scaling parameter s is set to 0.3 unless otherwise stated. Note that the number of samples used for sensing depends on several factors, such as the angular range and time interval for beam scanning in the sensing hotspot region [32]. When the sensing channel gain is lower due to the undesired atmospheric conditions or a smaller false alarm probability is required, then more symbols would be needed to achieve the same detection probability. In this paper, the parameters are selected to cover a large range of RCS and detection probability values for a comprehensive comparison between several methods. Ultimately, it is possible to enhance a given detection probability to elevated levels through the application of certain methods [32].\nThe detection probability, Pd, is computed by averaging over 100 random UE locations and channel realizations. For each set of UE locations, the expectations in (14) are obtained by taking average over 1000 random channel realizations. In each setup, 10 2\nPfa random RCS and\nDRAFT May 23, 2023\n21\n102 Pfa \u00b7 \u03c4 random noise realizations are taken into consideration for accurate estimation of Pd.\nTo evaluate the efficiency of the proposed power allocation algorithm, a communicationcentric approach is utilized as the baseline algorithm. The objective of the baseline algorithm is to minimize the total power consumption subject to the same constraints as the proposed algorithm. Conversely, the proposed algorithm aims to maximize the sensing SINR. Therefore, three algorithms are compared in this section: i) the communication-centric (comm.-centric); ii) the proposed ISAC power allocation algorithm ii.a) without additional sensing symbols (ISAC) and ii.b) with dedicated additional sensing symbols (ISAC+S). We also compare the performance of the proposed power allocation and sensing algorithms in both realistic and idealistic scenarios. The former corresponds to the described system model with target-free channels that cannot be canceled at the receiver APs, while the latter is for the case that target-free channels can be completely suppressed.\nMoreover, we investigate the performance of the algorithms in relation to the consideration of target-free channels during processing. The simple processing (SP) approach, as described in our previous work [25], represents the scenario when the target-free channels are disregarded. In contrast, the advanced processing (AP) approach considers the target-free channels in deriving the test statistics and optimizing power allocation as done in this paper. In both cases, the communication channels are estimated using the uplink pilots.\nFig. 3 shows the detection probability versus the variance of the RCS for false alarm probabilities of 0.1 and 0.01. The results demonstrate that increasing the false alarm probability leads to increased detection probability. This is because a higher false alarm probability implies a lower threshold, resulting in a higher detection probability. However, for both false alarm probabilities\nMay 23, 2023 DRAFT\n22\n0.1 and 0.01, the proposed ISAC and ISAC+S algorithms can achieve a detection probability close to 1 when the RCS variance is \u2265 10 dBsm (\u201cdBsm\u201d is the unit of RCS variance expressed in decibels relative to a square meter). In contrast, the comm-centric algorithm fails to attain a Pd above 0.8 due to not considering the sensing requirements. The detection probability also tends to increase as the RCS variance increases. In addition, the ISAC+S algorithm supports lower RCS variances, about 1 dB lower than that of ISAC, for a specific Pd.\nThe effect of the unknown target-free channels on the detection probability is investigated in Fig. 4, which illustrates the detection probability versus scaling parameter, s, for simple and advanced processing. The scaling parameter s affects the interference from the unknown part of the target-free channels. When s=1, no information about the target-free channels is available, which makes them impossible to be suppressed. As expected, reducing s leads to an improved detection probability, as the interference power for sensing signals decreases with a lower value of s. More importantly, the efficiency of advanced processing that exploits the statistics of the target-free channels in realistic scenarios has been shown since there is a significant gap between the performance of both proposed algorithms, ISAC and ISAC+S, with AP and SP. The results also show that the proposed scheme is quite robust to the power increase in the unknown part of the target-free channel.\nThe detection probability versus the sensing duration \u03c4 is depicted in Fig. 5. In general, increasing \u03c4 improves the sensing performance of all algorithms, although the proposed algorithm with additional sensing beams, ISAC+S, outperforms the two other algorithms. However, it is worth noting that the proposed algorithm without additional sensing beams (i.e., ISAC) converges to the performance of ISAC+S algorithm when \u03c4 is greater than 50.\nDRAFT May 23, 2023\n23\nFinally, the efficiency of the proposed algorithms in both realistic and idealistic scenarios, with simple and advanced processing, is investigated in terms of RCS variance in Fig. 6. The results demonstrate that SP-real. provides a lower bound, while the performance of SP-ideal. serves as an upper bound. In the realistic scenario, there is a substantial gap between the use of simple processing and advanced processing. However, for high RCS variances, simple processing can reach high performance. Moreover, the performance of simple processing would be better for lower scaling parameters (see Fig. 4). This implies that when the target has good reflectivity and the interference coming from unknown target-free channels is low, we can ignore the targetfree channels and use simple processing, which is more computationally friendly than advanced processing."
        },
        {
            "heading": "IX. CONCLUSION",
            "text": "An ISAC framework in a cell-free massive MIMO is proposed for downlink communication with imperfect CSI, as well as, multi-static target detection in the presence of clutter. A MAPRT detector is developed to detect the target with a known location but unknown RCS using centralized processing. A power allocation algorithm is proposed to maximize the sensing SINR while satisfying both communication and per-AP power constraints to improve the ISAC performance. Numerical results show that, compared to a fully communication-centric algorithm, and in the presence of clutter, a significant improvement in detection probability can be achieved by the proposed algorithm with and without additional sensing beams. However, the use of additional sensing beams further supports lower RCS variances. Moreover, a significant gap has been observed between the performance of the proposed algorithms, which exploit the statistics of the target-free channels, and the one in which these channels are ignored in the processing. However, this gap becomes smaller when the clutter power reduces, and the RCS variance is relatively high facilitating computationally simpler target detection."
        },
        {
            "heading": "APPENDIX A",
            "text": "PROOF OF LEMMA 1 By noting that only the effective channel E { hHi wi } is known at UE i, Equation (12) can be\nrewritten as\nyi[m] = \u221a \u03c1iE { hHi wi } si[m]\ufe38 \ufe37\ufe37 \ufe38\nDesired signal\n+ \u03bdi[m]\ufe38 \ufe37\ufe37 \ufe38 Interference +ni[m]\ufe38 \ufe37\ufe37 \ufe38 Noise , (53)\nwhere\nMay 23, 2023 DRAFT\n24\n\u03bdi[m] = \u221a \u03c1i ( hHi wi \u2212 E { hHi wi }) si[m]\ufe38 \ufe37\ufe37 \ufe38\nSelf-interference signal due to the unknown part of the channel\n+ Nue\u2211\nj=1,j 6=i \u221a \u03c1jhHi wjsj[m]\ufe38 \ufe37\ufe37 \ufe38\nInterference signal due to the other UEs\n+ \u221a \u03c10hHi w0s0[m]\ufe38 \ufe37\ufe37 \ufe38\nInterference signal due to the sensing\n. (54)\nThe interference signal \u03bdi[m] has zero mean since si and s0 have zero means. Moreover, it is uncorrelated with the desired symbol si[m] since\nE {\u03bdi[m]s\u2217i [m]} = \u221a \u03c1i E { hHi wi \u2212 E { hHi wi }}\ufe38 \ufe37\ufe37 \ufe38 =0 E { |si[m]|2 } = 0. (55)\nFollowing Lemma 3.3 and Theorem 6.1 in [23], the achievable SE of UE i can be obtained as in (13). Note that w0 is designed in the nullspace of the estimated channel vectors, and, thus, h\u0302 H\ni w0 = 0, for i = 1, . . . , Nue. Therefore, the interference power due to the sensing signal is\nonly coming from the channel estimation error, h\u0303i, i.e., E {\u2223\u2223hHi w0\u2223\u22232} = E{\u2223\u2223\u2223h\u0303Hi w0\u2223\u2223\u22232} . (56)"
        },
        {
            "heading": "APPENDIX B",
            "text": "PROOF OF LEMMA 2"
        },
        {
            "heading": "A. Optimization under H0",
            "text": "Given that the hypothesis H0 is true, we have y\u03c4 = h\u03c4 +n\u03c4 . In order to solve the optimization problem under H0, we first derive the conditional PDF of y\u03c4 given the target-free channel vector h and the hypothesis H0 and PDF of h in (28) as\np (y\u03c4 |h,H0) = p (n\u03c4 = y\u03c4 \u2212 h\u03c4 |h) = 1\n(\u03c0\u03c32n) MNrx\u03c4\ufe38 \ufe37\ufe37 \ufe38\n,C1\nexp ( \u2212\n\u03c4\u2211 m=1 \u2016y[m]\u2212 X[m]h\u20162 \u03c32n\n) , (57)\np (h|H0) = p (h) = 1\n\u03c0M2NtxNrx det (R)\ufe38 \ufe37\ufe37 \ufe38 ,C2\nexp ( \u2212hHR\u22121h ) , (58)\nrespectively, where we have defined C1 = 1(\u03c0\u03c32n)MNrx\u03c4 and C2 = 1\u03c0M2NtxNrx det(R) . Note that h is independent of the hypothesis H0. Now, the optimization under H0 can be rewritten as\n\u039bden = max h C1C2 exp\n( \u2212\n\u03c4\u2211 m=1 \u2016y[m]\u2212 X[m]h\u20162 \u03c32n \u2212 hHR\u22121h\n) , (59)\nwhich is equivalent to\nDRAFT May 23, 2023\n25\n\u039bden = C1C2 exp ( \u2212 1 \u03c32n min h fH0(h) ) , (60)\nwhere\nfH0(h) =h H  \u03c4\u2211\nm=1\nXH [m]X[m] + \u03c32nR \u22121\n\ufe38 \ufe37\ufe37 \ufe38 =D\nh\u2212 2< hH \u03c4\u2211 m=1\nXH [m]y[m]\ufe38 \ufe37\ufe37 \ufe38 =b\n+ \u03c4\u2211\nm=1 \u2016y[m]\u20162\ufe38 \ufe37\ufe37 \ufe38 =F\n=hHDh\u2212 hHb\u2212 bHh + F, (61)\nwhere D, b, and F are given in (32), (31), and (33), respectively. Then, the estimate of the vectorized target-free channel h that minimizes the quadratic convex objective function fH0(h) in (60) is obtained as h\u0302 = D\u22121b. Finally, substituting the optimally estimated h\u0302 into fH0(h) in (60), we obtain the denominator of the likelihood ratio in (26) as in (29)."
        },
        {
            "heading": "B. Optimization under H1",
            "text": "Given that the hypothesis H1 is true, we have y\u03c4 = g\u03c4 + h\u03c4 + n\u03c4 . Then, the conditional PDF of y\u03c4 given \u03b1, h and the hypothesis H1 is obtained as\np(y\u03c4 |\u03b1,h,H1)=p(n\u03c4 =y\u03c4\u2212g\u03c4\u2212h\u03c4 |\u03b1,h)=C1exp\n( \u2212\n\u03c4\u2211 m=1 \u2016y[m]\u2212G[m]\u03b1\u2212 X[m]h\u20162 \u03c32n\n) . (62)\nNote that h and \u03b1 are independent of the hypothesis H1. Therefore, p (h|H1) = p (h) which is given in (58) and the conditional PDF of \u03b1 given the hypothesis H1 is equal to its PDF given as\np (\u03b1|H1) = p (\u03b1) = C3 exp ( \u2212\u03b1HR\u22121rcs\u03b1 ) , (63)\nwhere C3 = 1\u03c0NtxNrx det(Rrcs) . Now, we can rewrite (27) as\n\u039bnum = C1C2C3 exp ( \u2212 1 \u03c32n min \u03b1,h fH1(\u03b1,h) ) , (64)\nwhere fH1(\u03b1,h) = \u03c4\u2211\nm=1\n\u2016y[m]\u2212G[m]\u03b1\u2212 X[m]h\u20162 + \u03b1H\u03c32nR\u22121rcs\u03b1 + hH\u03c32nR\u22121h\n= \u03c4\u2211\nm=1 \u2016y[m]\u20162\ufe38 \ufe37\ufe37 \ufe38 F \u22122<\n\u03b1H \u03c4\u2211\nm=1 GH [m]y[m]\ufe38 \ufe37\ufe37 \ufe38 a\n\u2212 2< hH \u03c4\u2211 m=1\nXH [m]y[m]\ufe38 \ufe37\ufe37 \ufe38 b\n\nMay 23, 2023 DRAFT\n26\n+ \u03b1H  \u03c4\u2211\nm=1 GH [m]G[m] + \u03c32nR \u22121 rcs\ufe38 \ufe37\ufe37 \ufe38\nC\n\u03b1 + hH  \u03c4\u2211 m=1 XH [m]X[m] + \u03c32nR \u22121\n\ufe38 \ufe37\ufe37 \ufe38 D\nh\n+ 2< \u03b1H \u03c4\u2211\nm=1 GH [m]X[m]\ufe38 \ufe37\ufe37 \ufe38 E h  . (65) In (65), the vectors a and b, the matrices C, D, and E, and the scalar F are given in (31), (32), and (33), respectively. The objective function in (65) can be rewritten as\nfH1(\u03b1,h) = [ \u03b1H hH ] C E EH D \u03b1 h \u2212 2< [\u03b1H hH] a b + F. (66) Equating the first derivative of fH1(\u03b1,h) with respect to \u03b1 H and hH to zero, the estimated \u03b1 and h are obtained as \u03b1\u0302 h\u0302  =  C E EH D \u22121 a b\n . (67) Substituting (67) in (66), we have\nmin \u03b1,h\nfH1(\u03b1,h) =\u2212 [ aH bH ] C E EH D \u22121 a b + F. (68) Then, the numerator of the likelihood ratio in (26) is derived by inserting (68) into (64) and given in (30)."
        },
        {
            "heading": "APPENDIX C",
            "text": "PROOF OF SENSING SINR\nThe sensing SINR for the received vector signal in (24) is given as\nSINRs = E {\u2016g\u03c4\u20162}\nE {\u2016n\u03c4\u20162}+ E {\u2016h\u03c4\u20162} =\n\u2211\u03c4 m=1 E {\u2016G[m]\u03b1\u20162}\n\u03c4MNrx\u03c32n + \u2211\u03c4 m=1 E {\u2016X[m]h\u20162} . (69)\nUsing (15), the expectation E {\u2016G[m]\u03b1\u20162} in the numerator can be computed as\nE { \u2016G[m]\u03b1\u20162 } = Nrx\u2211 r=1 E  \u2225\u2225\u2225\u2225\u2225 Ntx\u2211 k=1 \u03b1r,kgr,k[m] \u2225\u2225\u2225\u2225\u2225 2  = Nrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 E { gHr,k[m]\u03b1 \u2217 r,k\u03b1r,jgr,j[m]\n} (a) =\nNrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 gHr,k[m]cov (\u03b1r,j, \u03b1r,k) gr,j[m] (b) = \u03c1TDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 \u221a \u03b2r,k\u03b2r,jWHk a \u2217(\u03d5k, \u03d1k)\n\u00d7 aH(\u03c6r, \u03b8r)cov (\u03b1r,j, \u03b1r,k) a(\u03c6r, \u03b8r)aT (\u03d5j, \u03d1j)Wj ) Ds[m]\u03c1, (70)\nDRAFT May 23, 2023\n27\nwhere in (a), we treat gr,k[m] as deterministic since the edge cloud knows xk[m]. In (b), we recalled the definition of gr,k[m] from (15) and xk[m] from (2). Defining\nA = \u03c4\u2211\nm=1\nDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 \u221a \u03b2r,k\u03b2r,jWHk a \u2217(\u03d5k, \u03d1k)aH(\u03c6r, \u03b8r)\n\u00d7 cov (\u03b1r,j, \u03b1r,k) a(\u03c6r, \u03b8r)aT (\u03d5j, \u03d1j)Wj ) Ds[m], (71)\nthe term \u2211\u03c4\nm=1 E {\u2016G[m]\u03b1\u20162} in the numerator of the sensing SINR in (69) can be written as\u2211\u03c4 m=1 E {\u2016G[m]\u03b1\u20162} = \u03c1TA\u03c1. Using (15), the expectation E {\u2016X[m]h\u20162} in the denominator of the sensing SINR in (69) can be expressed as\nE { \u2016X[m]h\u20162 } = Nrx\u2211 r=1 E  \u2225\u2225\u2225\u2225\u2225 Ntx\u2211 k=1 Hr,kxk[m] \u2225\u2225\u2225\u2225\u2225 2  (a)= Nrx\u2211 r=1 Ntx\u2211 k=1 Ntx\u2211 j=1 xHk [m]E { HHr,kHr,j } xj[m]\n(b) = Nrx\u2211 r=1 Ntx\u2211 k=1 xHk [m]E { HHr,kHr,k } xk[m] (c) = \u03c1TDHs [m] Nrx\u2211 r=1 Ntx\u2211 k=1 WHk E { HHr,kHr,k }\ufe38 \ufe37\ufe37 \ufe38\n,Rr,k\nWk Ds[m]\u03c1, (72) where we treat xk[m] as deterministic in (a) since it is known in the edge cloud. In (b), we have used that zero-mean channels Hr,k are independent for different k and in (c) we recalled the definition of xk[m] from (2). Using the correlated Rayleigh modeling of the channel Hr,k from\n(18), the defined expectation term Rr,k = E { HHr,kHr,k } can be written as\nRr,k = E {( R 1 2\ntx,(r,k)\n)\u2217 WHch,(r,k) ( R 1 2\nrx,(r,k)\n)H R 1 2 rx,(r,k)Wch,(r,k) ( R 1 2 tx,(r,k) )T} = ( R 1 2\ntx,(r,k)\n)\u2217 E { WHch,(r,k)Rrx,(r,k)Wch,(r,k) }( R 1 2\ntx,(r,k)\n)T , (73)\nwhere we used that the square root of the positive semi-definite matrix Rrx,(r,k) is Hermitian symmetric. The (m,n)th entry of the matrix E { WHch,(r,k)Rrx,(r,k)Wch,(r,k) } is\nE {[ Wch,(r,k) ]H\n:m Rrx,(r,k)\n[ Wch,(r,k) ] :n } = tr ( E {[ Wch,(r,k) ]H :m Rrx,(r,k) [ Wch,(r,k) ] :n }) =E { tr ( Rrx,(r,k) [ Wch,(r,k) ] :n [ Wch,(r,k) ]H :m )} =tr ( Rrx,(r,k)E {[ Wch,(r,k) ] :n [ Wch,(r,k) ]H :m }) (74) where we have used the trace operation and its cyclic shift property. In the above expression,\nthe expectation E {[ Wch,(r,k) ]\n:n\n[ Wch,(r,k) ]H :m } is zero if m 6= n. Otherwise, if m = n, it is equal\nto the identity matrix. So, the matrix E { WHch,(r,k)Rrx,(r,k)Wch,(r,k) } in (73) is tr ( Rrx,(r,k) ) IM . Inserting this into (73), we obtain\nRr,k = tr ( Rrx,(r,k) ) ( R 1 2\ntx,(r,k)\n)\u2217 ( R 1 2\ntx,(r,k)\n)T = tr ( Rrx,(r,k) ) RTtx,(r,k). (75)\nMay 23, 2023 DRAFT\n28\nThen, the expression in (72) becomes\nE { \u2016X[m]h\u20162 } = \u03c1TDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 tr ( Rrx,(r,k) ) WHk R T tx,(r,k)Wk ) Ds[m]\u03c1. (76)\nNow, defining\nB = \u03c4\u2211\nm=1\nDHs [m] ( Nrx\u2211 r=1 Ntx\u2211 k=1 tr ( Rrx,(r,k) ) WHk R T tx,(r,k)Wk ) Ds[m], (77)\nthe second term in the denominator in (69) can be expressed as \u03c1TB\u03c1. Then, we obtain the sensing SINR as\nSINRs = \u03b3s = \u03c1TA\u03c1\n\u03c4MNrx\u03c32n + \u03c1 TB\u03c1\n. (78)"
        },
        {
            "heading": "APPENDIX D",
            "text": "PROOF OF CONVEXITY OF f (\u03c1, t) .\nWe want to show that f (\u03c1, t) is a convex function. First, we derive the gradient vector of\nfunction f (\u03c1, t) as follows\n\u2207f (\u03c1, t) =  2Ar\u03c1t \u2212\u03c1TAr\u03c1\nt2  . (79) The Hessian matrix would be\nH (\u03c1, t) =  2Art \u22122Ar\u03c1t2 \u22122\u03c1TAr\nt2 2\u03c1TAr\u03c1 t3  . (80) By showing that the Hessian matrix is positive semi-definite, we prove that the objective function\nf (\u03c1, t) is convex. The former is equivalent to showing the non-negativity of [ \u03c1\u0304T t\u0304 ] H (\u03c1, t) \u03c1\u0304 t\u0304  for any selection of \u03c1\u0304 and t\u0304. This product can be computed as[\n\u03c1\u0304T t\u0304 ] 2Art \u22122Ar\u03c1t2 \u22122\u03c1TAr\nt2 2\u03c1TAr\u03c1 t3\n\u03c1\u0304 t\u0304  =2\u03c1\u0304TAr\u03c1\u0304 t \u2212 2\u03c1 TAr\u03c1\u0304t\u0304 t2 \u2212 2\u03c1\u0304 TAr\u03c1t\u0304 t2 + 2\u03c1TAr\u03c1t\u03042 t3\n=2\n( \u03c1\u0304\u2212 t\u0304 t \u03c1 )T Ar (\u03c1\u0304\u2212 t\u0304t\u03c1)\nt \u2265 0, (81)\nwhere we have expressed the result in a quadratic form. Since Ar is positive semi-definite, the above result is always non-negative. As a result, we can conclude that the Hessian matrix is positive semi-definite and the objective function is convex.\nDRAFT May 23, 2023\n29"
        }
    ],
    "title": "Multi-Static Target Detection and Power Allocation for Integrated Sensing and Communication in Cell-Free Massive MIMO",
    "year": 2023
}