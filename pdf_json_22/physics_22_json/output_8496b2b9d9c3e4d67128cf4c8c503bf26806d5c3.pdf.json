{
    "abstractText": "The border-collision normal form is a canonical form for two-dimensional, continuous maps comprised of two affine pieces. In this paper we provide a guide to the dynamics of this family of maps in the non-invertible case where the two pieces fold onto the same half-plane. We identify parameter regimes for the occurrence of key bifurcation structures, such as period-incrementing, period-adding, and robust chaos. We then apply the results to a classic model of a boost converter for adjusting the voltage of direct current. It is known that for one combination of circuit parameters the model exhibits a border-collision bifurcation that mimics supercritical period-doubling and is non-invertible due to the switching mechanism of the converter. We find that over a wide range of parameter values, even though the dynamics created in border-collision bifurcations is in general extremely diverse, the bifurcation in the boost converter can only mimic period-doubling, although it can be subcritical.",
    "authors": [],
    "id": "SP:957b42fedd5f25e246cdb87dcaf7e9ee4a55737b",
    "references": [
        {
            "authors": [
                "J.D. Meiss"
            ],
            "title": "Differential Dynamical Systems",
            "venue": "SIAM, Philadelphia,",
            "year": 2007
        },
        {
            "authors": [
                "M. di Bernardo"
            ],
            "title": "Normal forms of border collision in high dimensional non-smooth maps",
            "venue": "In Proceedings IEEE ISCAS, Bangkok, Thailand,",
            "year": 2003
        },
        {
            "authors": [
                "H.E. Nusse",
                "J.A. Yorke"
            ],
            "title": "Border-collision bifurcations including \u201cperiod two to period three\u201d for piecewise smooth systems",
            "venue": "Phys. D, 57:39\u201357,",
            "year": 1992
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Border-collision bifurcations in R",
            "venue": "SIAM Rev., 58(2):177\u2013226,",
            "year": 2016
        },
        {
            "authors": [
                "R. Lozi"
            ],
            "title": "Un attracteur \u00e9trange(?) du type attracteur de H\u00e9non",
            "venue": "J. Phys. (Paris), 39(C5):9\u201310,",
            "year": 1978
        },
        {
            "authors": [
                "S. Banerjee",
                "J.A. Yorke",
                "C. Grebogi"
            ],
            "title": "Robust chaos",
            "venue": "Phys. Rev. Lett., 80(14):3049\u2013 3052,",
            "year": 1998
        },
        {
            "authors": [
                "P.A. Glendinning",
                "D.J.W. Simpson"
            ],
            "title": "A constructive approach to robust chaos using invariant manifolds and expanding cones",
            "venue": "Discrete Contin. Dyn. Syst., 41(7):3367\u20133387,",
            "year": 2021
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Sequences of periodic solutions and infinitely many coexisting attractors in the border-collision normal form",
            "venue": "Int. J. Bifurcation Chaos, 24(6):1430018,",
            "year": 2014
        },
        {
            "authors": [
                "A. Pumari\u00f1o",
                "J.A. Rod\u0155\u0131guez",
                "E. Vigil"
            ],
            "title": "Renormalization of two-dimensional piecewise linear maps: Abundance of 2-D strange attractors",
            "venue": "Discrete Contin. Dyn. Syst., 38(2):941\u2013966,",
            "year": 2018
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Border-collision bifurcations from stable fixed points to any number of coexisting chaotic attractors",
            "venue": "Submitted,",
            "year": 2022
        },
        {
            "authors": [
                "S. Banerjee",
                "C. Grebogi"
            ],
            "title": "Border collision bifurcations in two-dimensional piecewise smooth maps",
            "venue": "Phys. Rev. E, 59(4):4052\u20134061,",
            "year": 1999
        },
        {
            "authors": [
                "D.J.W. Simpson",
                "J.D. Meiss"
            ],
            "title": "Neimark-Sacker bifurcations in planar, piecewisesmooth, continuous maps",
            "venue": "SIAM J. Appl. Dyn. Sys., 7(3):795\u2013824,",
            "year": 2008
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Detecting invariant expanding cones for generating word sets to identify chaos in piecewise-linear maps",
            "venue": "Submitted to: J. Difference Eq. Appl. arXiv:2010.08241,",
            "year": 2020
        },
        {
            "authors": [
                "Z.T. Zhusubaliyev",
                "E. Mosekilde",
                "S. Maity",
                "S. Mohanan",
                "S. Banerjee"
            ],
            "title": "Border collision route to quasiperiodicity: Numerical investigation and experimental confirmation",
            "venue": "Chaos, 16(2):023122,",
            "year": 2006
        },
        {
            "authors": [
                "I. Sushko",
                "L. Gardini"
            ],
            "title": "Center bifurcation for two-dimensional border-collision normal form",
            "venue": "Int. J. Bifurcation Chaos, 18(4):1029\u20131050,",
            "year": 2008
        },
        {
            "authors": [
                "C. Mira",
                "C. Rauzy",
                "Y. Maistrenko",
                "I. Sushko"
            ],
            "title": "Some properties of a two-dimensional piecewise-linear noninvertible map",
            "venue": "Int. J. Bifurcation Chaos, 6(12a):2299\u20132320,",
            "year": 1996
        },
        {
            "authors": [
                "P. Glendinning"
            ],
            "title": "Bifurcation from stable fixed point to 2D attractor in the border collision normal form",
            "venue": "IMA J. Appl. Math., 81(4):699\u2013710,",
            "year": 2016
        },
        {
            "authors": [
                "P. Kowalczyk"
            ],
            "title": "Robust chaos and border-collision bifurcations in non-invertible piecewiselinear maps",
            "venue": "Nonlinearity, 18:485\u2013504,",
            "year": 2005
        },
        {
            "authors": [
                "R. Szalai",
                "H.M. Osinga"
            ],
            "title": "Arnol\u2019d tongues arising from a grazing-sliding bifurcation",
            "venue": "SIAM J. Appl. Dyn. Sys., 8(4):1434\u20131461,",
            "year": 2009
        },
        {
            "authors": [
                "J.H.B. Deane"
            ],
            "title": "Chaos in a current-mode controlled boost dc-dc converter",
            "venue": "IEEE Trans. Circuits Systems I Fund. Theory Appl., 39(8):680\u2013683,",
            "year": 1992
        },
        {
            "authors": [
                "M. di Bernardo",
                "C.J. Budd",
                "A.R"
            ],
            "title": "Champneys. Normal form maps for grazing bifurcations in n-dimensional piecewise-smooth dynamical systems",
            "venue": "Phys. D,",
            "year": 2001
        },
        {
            "authors": [
                "J. Guckenheimer",
                "P.J. Holmes"
            ],
            "title": "Nonlinear Oscillations, Dynamical Systems, and Bifurcations of Vector Fields",
            "venue": "Springer-Verlag, New York,",
            "year": 1986
        },
        {
            "authors": [
                "Yu.A. Kuznetsov"
            ],
            "title": "Elements of Bifurcation Theory., volume",
            "venue": "Appl. Math. Sci. Springer-Verlag,",
            "year": 2004
        },
        {
            "authors": [
                "D.J.W. Simpson",
                "P.A. Glendinning"
            ],
            "title": "Inclusion of higher-order terms in the bordercollision normal form: persistence of chaos and applications to power converters",
            "venue": "Submitted to: Phys. D. arXiv:2111.12222,",
            "year": 2021
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Chaotic attractors from border-collision bifurcations: Stable border fixed points and determinant-based Lyapunov exponent bounds",
            "venue": "NZJM, 50:71\u201391,",
            "year": 2020
        },
        {
            "authors": [
                "Y. Do",
                "S.D. Kim",
                "P.S. Kim"
            ],
            "title": "Stability of fixed points placed on the border in the piecewise linear systems",
            "venue": "Chaos Solitons Fractals, 38(2):391\u2013399,",
            "year": 2008
        },
        {
            "authors": [
                "L. Gardini"
            ],
            "title": "Some global bifurcations of two-dimensional endomorphisms by use of critical lines",
            "venue": "Nonlinear Anal., 18(4):361\u2013399,",
            "year": 1992
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "The stability of fixed points on switching manifolds of piecewise-smooth continuous maps",
            "venue": "J. Dyn. Diff. Equat., 32(3):1527\u20131552,",
            "year": 2020
        },
        {
            "authors": [
                "D.J.W. Simpson",
                "J.D. Meiss"
            ],
            "title": "Resonance near border-collision bifurcations in piecewise-smooth, continuous maps",
            "venue": "Nonlinearity, 23(12):3091\u20133118,",
            "year": 2010
        },
        {
            "authors": [
                "P. Glendinning"
            ],
            "title": "Less is more I: A pessimistic view of piecewise smooth bifurcation theory",
            "venue": "A. Colombo, M. Jeffrey, J. L\u00e1zaro, and J. Olm, editors, Extended Abstracts Spring 2016, volume 8 of Trends in Mathematics, pages 71\u201375. Birkh\u00e4user, Cham,",
            "year": 2017
        },
        {
            "authors": [
                "V.I. Arnol\u2019d"
            ],
            "title": "Geometrical Methods in the Theory of Ordinary Differential Equations",
            "year": 1988
        },
        {
            "authors": [
                "Z.T. Zhusubaliyev",
                "O.O. Yanochkina",
                "E. Mosekilde",
                "S. Banerjee"
            ],
            "title": "Two-mode dynamics in pulse-modulated control systems",
            "venue": "Annual Rev. Control, 34:62\u201370,",
            "year": 2010
        },
        {
            "authors": [
                "M. Gallegati",
                "L. Gardini",
                "T. Puu",
                "I. Sushko"
            ],
            "title": "Hicks\u2019 trade cycle revisited: Cycles and bifurcations",
            "venue": "Math. Comput. Simulation, 63:505\u2013527,",
            "year": 2003
        },
        {
            "authors": [
                "J. Laugesen",
                "E. Mosekilde"
            ],
            "title": "Border-collision bifurcations in a dynamic management game",
            "venue": "Comput. Oper. Res., 33:464\u2013478,",
            "year": 2006
        },
        {
            "authors": [
                "P.H.E. Tiesinga"
            ],
            "title": "Precision and reliability of periodically and quasiperiodically driven integrate-and-fire neurons",
            "venue": "Phys. Rev. E, 65(4):041913,",
            "year": 2002
        },
        {
            "authors": [
                "D.J.W. Simpson",
                "J.D. Meiss"
            ],
            "title": "Shrinking point bifurcations of resonance tongues for piecewise-smooth, continuous maps",
            "venue": "Nonlinearity, 22(5):1123\u20131144,",
            "year": 2009
        },
        {
            "authors": [
                "J. Franks"
            ],
            "title": "Periodic points and rotation numbers for area preserving diffeomorphisms of the plane",
            "venue": "Inst. Hautes \u00c9tudes Sci. Publ. Math., 71:105\u2013120,",
            "year": 1990
        },
        {
            "authors": [
                "P. Le Calvez"
            ],
            "title": "Rotation numbers in the infinite annulus",
            "venue": "Proc. Amer. Math. Soc., 129(11):3221\u20133230,",
            "year": 2001
        },
        {
            "authors": [
                "B. Hao",
                "W. Zheng"
            ],
            "title": "Applied Symbolic Dynamics and Chaos",
            "venue": "World Scientific, Singapore, 2nd edition,",
            "year": 2018
        },
        {
            "authors": [
                "G.H. Hardy",
                "E.M. Wright"
            ],
            "title": "An Introduction to the Theory of Numbers",
            "venue": "Oxford University Press, New York, 6th edition,",
            "year": 2008
        },
        {
            "authors": [
                "A. Colombo",
                "F. Dercole"
            ],
            "title": "Discontinuity induced bifurcations of non-hyperbolic cycles in nonsmooth systems",
            "venue": "SIAM J. Appl. Dyn. Sys., 9(1):62\u201383,",
            "year": 2010
        },
        {
            "authors": [
                "D.J.W. Simpson"
            ],
            "title": "Bifurcations in Piecewise-Smooth Continuous Systems., volume 70 of Nonlinear Science",
            "venue": "World Scientific, Singapore,",
            "year": 2010
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "Periodic and non-periodic oscillations in systems of ordinary differential equations are usually analysed by constructing a return map. In classical settings, where the differential equations\nE-mail addresses: H.O. Fatoyinbo (h.fatoyinbo@massey.ac.nz), D.J.W. Simpson (d.j.w.simpson@ massey.ac.nz)\nar X\niv :2\n21 0.\n14 44\n5v 1\n[ nl\ninduce a unique smooth flow, such maps are typically smooth and invertible, at least locally [1]. However, for piecewise-smooth differential equations and hybrid systems, return maps are commonly piecewise-smooth [2].\nThe phase space of a piecewise-smooth map is characterised by the presence of one or more switching manifolds where the map is nonsmooth. This nonsmoothness causes the dynamics to change in a fundamental way at border-collision bifurcations where a fixed point collides with a switching manifold as parameters are varied. Under quite general conditions, these dynamics are captured by a piecewise-linear family known as the border-collision normal form [3, 4, 5]. In two dimensions this family can be written as\n[ x y ] 7\u2192  [ \u03c4Lx+ y + \u00b5 \u2212\u03b4Lx ] , x \u2264 0,[ \u03c4Rx+ y + \u00b5\n\u2212\u03b4Rx\n] , x \u2265 0,\n(1)\nwhere the line x = 0 is the switching manifold, the parameter \u00b5 \u2208 R controls the bordercollision bifurcation, and \u03c4L, \u03b4L, \u03c4R, \u03b4R \u2208 R are additional parameters.\nThe normal form (1) is well-studied as it arises in diverse applications, and, as an extension of the Lozi map [6], serves as a minimal model for chaotic and highly nonlinear dynamics. The dynamics of (1) is remarkably rich \u2014 it exhibits chaos robustly [7, 8], can have any number of coexisting attractors [9], of which all could be chaotic [10, 11]. Most studies of (1) have focussed on parameter regimes where (1) is invertible, i.e. \u03b4L\u03b4R > 0. For the invertible, dissipative case, a review is provided by [12]; other works that characterise parameter space in some detail include [13, 14, 15, 16].\nHowever, it is perhaps under-appreciated that return maps of piecewise-smooth dynamical systems are often, not only piecewise-smooth, but also non-invertible. This is because a switch to a different mode of operation can readily cause the flow to fold back onto itself, as illustrated below for power converters. Some analysis of (1) has been done in the non-invertible case. For example period-adding is illustrated numerically in [16], global bifurcations of a chaotic attractor in an equivalent map are described in [17], and two-dimensional attractors are identified in [18]. In this paper we provide an overview of the dynamics of (1) when it is non-invertible, specifically with \u03b4L\u03b4R < 0. For the special case \u03b4L\u03b4R = 0, where the long-term dynamics are essentially one-dimensional, refer to [19, 20].\nWe begin in \u00a72 by showing how the piecewise-linear normal form (1) applies to bordercollision bifurcations of arbitrary, two-dimensional, piecewise-smooth maps. We then study (1) subject to \u03b4R < 0 < \u03b4L, the specific signs being chosen without loss of generality. The dynamical complexity of (1) means we cannot hope to characterise all dynamics, and for this reason our approach is to chart the essential features. With \u00b5 < 0 the dominate bifurcation structures are period-adding and robust chaos, \u00a73, while with \u00b5 > 0 the map exhibits periodincrementing and robust chaos, \u00a74.\nIn \u00a75 we illustrate the results with the power converter model of Deane [21]. This model exhibits a border-collision bifurcation, and by determining the part of the parameter space of the normal form that this bifurcation corresponds to, we can use our results to characterise the bifurcation. Although in general the dynamics created in border-collision bifurcations is\nextremely diverse, it appears this bifurcation acts exclusively as a piecewise-smooth version of period-doubling. Finally \u00a76 provides concluding remarks."
        },
        {
            "heading": "2 Border-collision bifurcations and the normal form",
            "text": "A border-collision bifurcation occurs when a fixed point of a piecewise-smooth map collides with a switching manifold. Here we consider a two-dimensional map with variables u, v \u2208 R and parameter \u03b7 \u2208 R. We assume a border-collision bifurcation occurs at the origin (u, v) = (0, 0) when \u03b7 = 0, and we wish to understand the dynamics in a neighbourhood of (u, v; \u03b7) = (0, 0; 0).\nWe assume the switching manifold is smooth, at least locally, so there exists a smooth coordinate change that shifts the switching manifold to the line u = 0 [22]. Then, assuming the map is continuous and piecewise-C2, locally it has the form\n[ u v ] 7\u2192  [ aL11u+ a12v + b1\u03b7 aL21u+ a22v + b2\u03b7 ] +O ( (|u|+ |v|+ |\u03b7|)2 ) , u \u2264 0,[ aR11u+ a12v + b1\u03b7\naR21u+ a22v + b2\u03b7\n] +O ( (|u|+ |v|+ |\u03b7|)2 ) , u \u2265 0,\n(2)\nfor some aL11, a L 21, a R 11, a R 21, a12, a22, b1, b2 \u2208 R. Note that the v and \u03b7 coefficients of the two pieces of (2) are the same. This is a consequence of the assumed continuity of (2) on u = 0. Next we work to bring (2) into the normal form (1)."
        },
        {
            "heading": "2.1 A derivation of the normal form",
            "text": "By construction the origin is a fixed point of (2) when \u03b7 = 0. We now consider fixed points of (2) for small \u03b7 \u2208 R. Let c = (1\u2212 a22)b1 + a12b2 . (3) Then the left (u \u2264 0) piece of (2) has the fixed point[\nuL(\u03b7) vL(\u03b7)\n] =\n1\n(1\u2212 aL11)(1\u2212 a22)\u2212 a12aL21\n[ c\naL21b1 + ( 1\u2212 aL11 ) b2\n] \u03b7 +O ( \u03b72 ) , (4)\nassuming the denominator in (4) is non-zero. Similarly the right (u \u2265 0) piece of (2) has the fixed point[\nuR(\u03b7) vR(\u03b7)\n] =\n1\n(1\u2212 aR11)(1\u2212 a22)\u2212 a12aR21\n[ c\naR21b1 + ( 1\u2212 aR11 ) b2\n] \u03b7 +O ( \u03b72 ) , (5)\nassuming its denominator is non-zero. In a sufficiently small neighbourhood of (u, v; \u03b7) = (0, 0; 0), these are the only fixed points of (2).\nNotice we require c 6= 0 for the fixed points to move away from the switching manifold at a rate that is asymptotically proportional to \u03b7. Thus c 6= 0 is the transversality condition [23, 24] that ensures \u03b7 unfolds the border-collision bifurcation in a generic fashion.\nIn view of the switching condition in (2), ( uL, vL ) is a fixed point of (2) only if uL \u2264 0,\nin which case we say it is admissible. Similarly ( uR, vR ) is an admissible fixed point of (2)\nif uR \u2265 0. If uL < 0, the stability of ( uL, vL ) is governed by the eigenvalues of the Jacobian\nmatrix of (2) evaluated at ( uL, vL ) . This matrix is [ aL11 a12 aL21 a22 ] +O(\u03b7). To leading order its trace and determinant are\n\u03c4L = a L 11 + a22 , \u03b4L = a L 11a22 \u2212 a12aL21 . (6)\nWe similarly define\n\u03c4R = a R 11 + a22 , \u03b4R = a R 11a22 \u2212 a12aR21 , (7)\nfor the right piece of (2). By removing the nonlinear terms from each piece of (2) and applying the coordinate change\nx = u, (8)\ny = \u2212a22u+ a12v + (a22b1 \u2212 a12b2)\u03b7, (9) \u00b5 = c\u03b7, (10)\nwe arrive at the normal form (1) with \u03c4L, \u03b4L, \u03c4R, and \u03b4R given by (6) and (7). This coordinate change is invertible when c 6= 0 (discussed above) and a12 6= 0 (otherwise (2) decouples into two one-dimensional maps)."
        },
        {
            "heading": "2.2 The utility of the normal form",
            "text": "The dynamics of the normal form (1) approximates the dynamics of (2) for small values of u, v, and \u03b7. Presently there is little mathematical theory clarifying the validity of this approximation, but in practice the normal form is useful for characterising the dynamics created in border-collision bifurcations. For example, if the normal form exhibits a hyperbolic periodic solution, this solution also exists for (2) [5]. This type of persistence result has recently been extended to chaotic attractors [25].\nSince the normal form is piecewise-linear, the structure of its dynamics is independent of the magnitude of \u00b5. If \u00b5 < 0 its value can be scaled to \u22121, while if \u00b5 > 0 its value can be scaled to 1. We therefore study the normal form with \u00b5 = \u22121 to understand the dynamics on one side of the border-collision bifurcation, and with \u00b5 = 1 to understand the dynamics on the other side of the border-collision bifurcation.\nWith \u00b5 = 0 the origin is a fixed point of the normal form. If it is asymptotically stable then (2) has a local attractor on each side of the border-collision bifurcation [26]. However, the normal form is non-differentiable at the origin, so its stability can be difficult to ascertain [27, 28]. For instance in the non-invertible case the origin can be asymptotically stable even when both pieces of the map are area-expanding [29].\nIf \u03b4L\u03b4R < 0, then, in view of the substitution (x, y, \u00b5) 7\u2192 (\u2212x,\u2212y,\u2212\u00b5) that leaves the normal form invariant other than switching \u2018left\u2019 and \u2018right\u2019, we can assume \u03b4L > 0 and \u03b4R < 0. With \u03b4L > 0 and \u03b4R < 0 the normal form maps both left and right half-planes to the upper half-plane (y \u2265 0)."
        },
        {
            "heading": "2.3 An example of the dynamics of the normal form",
            "text": "Fig. 1 shows a bifurcation diagram and phase portraits of the normal form (1) with\n(\u03c4L, \u03b4L, \u03c4R, \u03b4R) = (\u22121, 2,\u22121,\u22120.2). (11)\nHere \u03b4L > 0 and \u03b4R < 0 so all invariant sets lie in the upper half-plane (y \u2265 0). For this example the border-collision bifurcation brings about a transition from a stable period-3 solution to a stable period-4 solution. As with all bounded invariant sets of the normal form, these solutions contract linearly to the origin as \u00b5\u2192 0, and this is evident in the bifurcation diagram. The period-3 solution for \u00b5 < 0 consists of one point in the left half-plane and two points in the right half-plane. Its symbolic representation is therefore LRR (or any cyclic permutation of this) and we refer to it as an LRR-cycle. Similarly the period-4 solution for \u00b5 > 0 is an LRRR-cycle. Based on symbolic representations, we can characterise the existence, admissibility, and stability of periodic solutions in a general manner [5, 30]."
        },
        {
            "heading": "3 The dynamics for \u00b5 < 0",
            "text": "Our aim here is to obtain a broad understanding of the attractors of (1) with \u00b5 < 0 and \u03b4L > 0, \u03b4R < 0, \u03c4L \u2208 R, and \u03c4R \u2208 R. As explained above, by scaling it is sufficient to consider \u00b5 = \u22121. We have found it helpful to study two-dimensional slices of parameter space defined by fixing the values of \u03b4L and \u03b4R, and study how the dynamics on these slices differs for different values of \u03b4L and \u03b4R. This is summarised by Fig. 2. In the top left this figure shows the open fourth quadrant Q4 = {(\u03b4L, \u03b4R)|\u03b4L > 0, \u03b4R < 0}, (12) and has four curves that divide Q4 into seven subsets where (\u03c4L, \u03c4R)-two-parameter bifurcation diagrams have similar features. This division is based on the existence of period-n periodicity regions for n = 1, 2, 3. Certainly one could divide Q4 further by considering more features in the bifurcation diagrams, but it is not clear that this would be helpful [31]."
        },
        {
            "heading": "3.1 Numerical methods",
            "text": "Before we describe the seven bifurcation diagrams in Fig. 2 in more detail, we first explain how they were computed. For each point in a 1000\u00d7 1000 equispaced grid of (\u03c4L, \u03c4R) values, we computed N = 104 iterates (xi, yi) of the forward orbit of a random initial point (x0, y0). If the norm of (xi, yi) exceeded 10\n6 for any i we concluded the orbit diverges and coloured this parameter point white. Otherwise we looked to see if the orbit converges to a periodic solution. If we could find a smallest 1 \u2264 p \u2264 30 for which the norm of (xN , yN)\u2212(xN\u2212p, yN\u2212p) was less than a tolerance of 10\u22126, we concluded the orbit converges to a period-p solution and coloured the point according to the colour bar. If no such period was detected the point was coloured black. In this case the orbit most likely converges to either a periodic solution with period greater than 30, a quasi-periodic attractor, or a chaotic attractor. Additional techniques were used to compute the period-3 regions in (i) and (vii). Following [5] for these we solved for the LRR-cycle exactly and checked admissibility and stability explicitly.\nBy using random initial points the bifurcation diagrams reveal areas where multiple attractors coexist and areas where attractors are not globally stable. For example the bottom three bifurcation diagrams are speckled white because the attractors are not globally attracting so some initial points give forward orbits that diverge."
        },
        {
            "heading": "3.2 Seven different two-parameter bifurcation diagrams",
            "text": "First consider (\u03b4L, \u03b4R) in subset (i). In this case any (\u03c4L, \u03c4R)-bifurcation diagram has a vertical red strip, \u2212\u03b4L \u2212 1 < \u03c4L < \u03b4L + 1, where the left half-map has a stable fixed point. As we cross the \u03c4L = \u2212\u03b4L \u2212 1 boundary of this strip, from right to left, this fixed point attains an eigenvalue of \u22121 and becomes unstable. This is not a period-doubling bifurcation as the normal form does not have the required nonlinearity, nevertheless a stable period-2 solution (LR-cycle) exists in a certain region (coloured cyan). This region is bounded below by the curve \u03c4R = (1+\u03b4L)(1+\u03b4R)\n\u03c4L , where the LR-cycle has an eigenvalue of \u22121, and bounded\nabove by \u03c4R = (\u03b4L\u22121)(1\u2212\u03b4R)\n\u03c4L , where it has an eigenvalue of 1. Fig. 2(i) also has regions where\nthere exists a stable LRR-cycle (yellow) and a stable LRRR-cycle (brown). For different values of (\u03b4L, \u03b4R) in subset (i), our numerical explorations have found that other periodicity regions can exist, particularly if |\u03b4R| is small, but the corresponding symbolic itinerary always contains exactly one L.\nTo move from subset (i) to (ii) we cross the line \u03b4L = 1 at which the vertical red strip vanishes. On the line \u03b4L = 1, and with \u22122 < \u03c4L < 2, the left half-map has purely imaginary eigenvalues. For generic families of smooth maps this signals the occurrence of a NeimarkSacker bifurcation at which an invariant circle is created. From a curve of Neimark-Sacker bifurcations there emanate Arnold tongues where the dynamics on the invariant circle includes a stable periodic solution (i.e. is mode-locked) [24, 32]. In our piecewise-linear setting, similar features arise [13]. An invariant circle is often created, as in Fig. 3(a). However, since the map is non-invertible the interior of the circle does not map to itself.\nFig. 2(ii) shows a typical bifurcation diagram for subset (ii). Stable periodic solutions exist in the coloured regions (Arnold tongues) which overlap in places resulting in coexisting attractors, Fig. 3(b) shows an example. Overall the Arnold tongues have a period-adding\nstructure as discussed below.\nTo move from subset (ii) to (iii) we cross the curve \u03b4L = \u22121 \u03b4R\n, labelled \u03b32, which is where the cyan region vanishes. This can be explained as follows. The eigenvalues that govern the stability of an admissible LR-cycle are those of the matrix ARAL [5]. The curve \u03b32 is where the determinant of this matrix is \u22121. Below \u03b32 we have det(ARAL) < \u22121 so the LR-cycle cannot be stable for any values of \u03c4L and \u03c4R.\nBy next crossing the curve \u03b4L = 1 \u03b42R , labelled \u03b33, the yellow region (for the existence of a stable LRR-cycle) vanishes for a similar reason. One could further identify additional curves for higher periods but this is complicated by the fact that for higher periods multiple symbolic representations occur.\nOur numerical explorations suggest that throughout subset (iv) the only attractors that are possible are chaotic. But unlike when the normal form is invertible \u2014 where chaotic attractors are typically quasi-one-dimensional, formed from one or more one-dimensional unstable manifolds [8] \u2014 in the non-invertible setting attractors can be two-dimensional, Fig. 4(a). Glendinning [18] proved that throughout an open subset of parameter space the normal form has a two-dimensional attractor for one sign of \u00b5 and a stable fixed point for the other sign of \u00b5. This shows that the sudden and local transition of a stable fixed point to a two-dimensional attractor can occur via a border-collision bifurcation in a generic (codimension-one) fashion. Coexisting chaotic attractors are also possible, Fig. 4(b). In fact for all n \u2265 1 there exist parameter combinations for which the normal form has n coexisting chaotic attractors [11].\nNext as we move in Q4 from (iv) into (v), then into (vi), and lastly into (vii), we again cross the curves \u03b4L = 1, \u03b32, and \u03b33, in this order. Consequently the vertical red strip reappears\n(a)\n(b)\n(fixed point), then the cyan region reappears (LR-cycle), and lastly a yellow region reappears (LRR-cycle). The difference between subsets (i) and (vii) is that the yellow region has two connected components in subset (i), but only one connected component in subset (vii). The boundary between these subsets is a curve \u03b63 derived in Appendix A."
        },
        {
            "heading": "3.3 Period-adding",
            "text": "Arnold tongues are shown in Fig. 2(ii) and more closely in the magnification, Fig. 5(a). While the precise location and shape of the Arnold tongues depends on the values of \u03b4L and \u03b4R, they have a broadly consistent two-dimensional structure. This structure is described in [16] for our non-invertible setting, in [20] for the special case \u03b4L\u03b4R = 0, and in several papers [33, 34, 35, 36] (each motivated by a different physical application) for the invertible case.\nIn the Arnold tongues only certain \u2018rotational\u2019 symbolic itineraries are possible [37]. As in the classical smooth setting [38, 39], the periodic solution can be assigned a rotation number m p \u2208 (0, 1), where p is the period and m represents the number of rotations per period. As we move left to right across Fig. 5(a), the rotation number decreases roughly monotonically. Between any two Arnold tongues of frequencies m1\np1 and m2 p2 with m1p2\u2212m2p1 = \u00b11, there\nare usually more Arnold tongues, the largest of which has frequency m1+m2 p1+p2 . Such Farey addition [40, 41] repeats indefinitely and, as in the smooth setting, explains the ordering and relative size of the Arnold tongues. One-parameter slices that cut horizontally through Fig. 5(a) consequently display periodic windows where the period of a window is often given by adding the periods of the largest windows on either side. Fig. 5(b) shows a typical example where we can see period-5 and period-6 windows, and between them a period-11 window (centred at about \u03c4L = 1.2). This structure is referred to as period-adding [2].\nHowever, unlike in the smooth setting, the Arnold tongues also exhibit structure in a second direction. As we move up Fig. 5(a) the fraction of L\u2019s in the symbolic itineraries decreases. As we cross any shrinking point, where an Arnold tongue has zero width, one L in the symbolic itinerary associated with the stable periodic solution changes to an R [37]."
        },
        {
            "heading": "4 An overview of the dynamics with \u00b5 > 0",
            "text": "We now consider \u00b5 > 0. As discussed in \u00a72 it suffices to consider \u00b5 = 1. The dynamics are summarised by Fig. 6 which shows four representative (\u03c4L, \u03c4R)-twoparameter bifurcation diagrams and shows how Q4, for the pairs (\u03b4L, \u03b4R), can be divided into different subsets based on features of the bifurcation diagrams. If \u22121 < \u03b4R < 0 the bifurcation diagram has a (red) horizontal strip \u2212\u03b4R\u2212 1 < \u03c4R < \u03b4R + 1 where the right halfmap has a stable fixed point. Otherwise the dominate periodic solutions are those whose symbolic itinerary contains exactly one R. That is, for a period-p solution the itinerary is Lp\u22121R (or a cyclic permutation of this). Its stability multipliers are the eigenvalues of Mp = ARA p\u22121 L . Notice det(Mp) = \u03b4 p\u22121 L \u03b4R < 0 (because \u03b4R < 0 < \u03b4L). So if det(Mp) > \u22121 then the Lp\u22121R-cycle is stable when\n\u2212 det(Mp)\u2212 1 < trace(Mp) < det(Mp) + 1. (13)\nRegions where Lp\u22121R-cycles are stable and admissible are coloured in Fig. 6. Roughly speaking these regions are narrow and aligned vertically. Their left boundary is where trace(Mp) = det(Mp) + 1, where Mp has an eigenvalue 1, and their right boundary is where trace(Mp) = \u2212 det(Mp) \u2212 1, where Mp has an eigenvalue \u22121. Upper boundaries are where admissibility is lost via a border-collision bifurcation where one point of the Lp\u22121R-cycle is located on the switching manifold.\nAs the pair (\u03b4L, \u03b4R) is varied, the left and right boundaries coincide, and the stability region vanishes, when det(Mp) = \u22121. That is,\n\u03b4R = \u22121 \u03b4p\u22121L . (14)\nThese are curves labelled \u03b3p in Fig. 6. As p\u2192\u221e the curves converge to \u03b4L = 1 and part of the \u03b4L-axis.\nThus with 0 < \u03b4L < 1 and \u22121 < \u03b4R < 0, for each p \u2265 2 the (\u03c4L, \u03c4R)-bifurcation diagram has a region where there exists a stable Lp\u22121R-cycle. The top-left bifurcation diagram of Fig. 6 provides a typical example. Only finitely many regions are visible because as p increases they only exist for successively larger (more negative) values of \u03c4R. By then increasing the value of \u03b4L, but keeping \u03b4R fixed, the regions vanish as we cross the curves \u03b3p for successively decreasing values of p. The top-right bifurcation diagram of Fig. 6 is for (\u03b4L, \u03b4R) between \u03b33 and \u03b34, so the period-p regions exist for p = 2 and p = 3 but no higher values of p.\nIf instead we fix \u03b4R < \u22121 and start with \u03b4L such that (\u03b4L, \u03b4R) lies to the left of \u03b32, then again the period-p region exists for all p \u2265 2 (bottom-left bifurcation diagram). But now as we increase the values of \u03b4L the regions vanish for successively increasing values of p. With \u03b4L > 1 and \u03b4R < \u22121, as in the bottom-right bifurcation diagram, stable, admissible periodic solutions cannot exist and all attractors appear to be chaotic. Here the region where an attractor exists has a similar spiked shape to the region of [29] where the origin is asymptotically stable when \u00b5 = 0. This is because asymptotic stability of the origin with \u00b5 = 0 implies the existence of a local attractor for all \u00b5 6= 0 [26].\nIn the bifurcation diagrams, just past the right boundary of a period-p region where the Lp\u22121R-cycle attains an eigenvalue of \u22121, there can exist a region where a period-2p solution is stable. For example in the brown region of the top-right bifurcation diagram of Fig. 6, there exists a stable LRRR-cycle.\nIn the black regions of the bifurcation diagrams the attractor is typically chaotic. Attractors can coexist and Fig. 7(a) shows a typical example. Here the boundary between two basins of attraction is given by the stable manifold of a saddle LRR-cycle.\nChaotic attractors undergo several global bifurcations as we move about the black regions. These are described in [17] for a one-parameter family. Fig. 7(b) shows an example of an attractor in their family (in terms of the normal for (1)). They found the attractor can be bounded by images of the switching manifold and sometimes also by one or more unstable manifolds. Bifurcations occur as the geometry of these one-dimensional objects changes."
        },
        {
            "heading": "5 Application to power converters",
            "text": "Whenever an electrical device requires the use of current with a voltage different to that of its power supply, it is necessary to alter the voltage level. This is usually achieved with a power converter. Power converters commonly employ rapid switching to minimize energy loss and allow components (such as inductors and capacitors) to be small in size.\nHere we consider the boost converter model of Deane [21]. This model has two variables: u(t) and v(t) for the current and voltage, respectively, in an inductor. To regulate the output\nvoltage the converter has a switch that closes whenever t T \u2208 Z, where t \u2208 R is time and T > 0 is the period of the converter. While the switch is closed the variables evolve according to\nu\u0307 = VI L , v\u0307 = \u2212 1 RC v, (15)\nand Deane [21] gives the following parameter values\nR = 20, L = 0.001, C = 0.000012, T = 0.0001, VI = 10. (16)\nThe switch opens whenever the value of the current u(t) reaches a threshold value Iref , and while the switch is open the variables evolve according to\nu\u0307 = VI L \u2212 1 L v, v\u0307 = 1 C u\u2212 1 RC v. (17)\nFig. 8 shows a typical time series. Notice the system evolves according to (15) (switch closed) until u(t) = Iref , then evolves according to (17) until t = nT for some n \u2208 Z. For the given parameter values the dynamics of the converter converges to a period-2T orbit.\nFig. 9 shows a bifurcation diagram obtained by varying the value of Iref . For small values of Iref solutions converge to a period-T orbit. This solution loses stability in a perioddoubling bifurcation at Iref \u2248 1.7060 (labelled PD in Fig. 9) past which solutions converge to a period-2T orbit. The period doubles again at Iref \u2248 2.3721, except this is not another period-doubling bifurcation, it is a border-collision bifurcation (labelled BCB) that mimics supercritical period-doubling. In the remainder of this section we analyse this bifurcation by\nusing the results of the previous sections and explain how it can differ for different values of the parameters (16).\nTo analyse the border-collision bifurcation, as in [21] we construct a stroboscopic map. Given values u and v for the variables at a time t = nT , where n \u2208 Z, let (u\u2032, v\u2032) = g(u, v) be the values of variables at t = (n+ 1)T . The map g is piecewise-smooth, specifically it has the form\ng(u, v) = { gL(u, v), u \u2264 Iref \u2212 VITL , gR(u, v), u \u2265 Iref \u2212 VITL ,\n(18)\nbecause the switch may or not open between the times nT and (n + 1)T . If u < Iref \u2212 VITL the switch is closed for the whole period and from the flow of (15) we obtain\ngL(u, v) =\n[ u+ VIT\nL\ne\u2212 T RC v\n] . (19)\nIf u > Iref \u2212 VITL the switch opens at t = nT + tsw where tsw = L VI (Iref \u2212 u). At this time the current and voltage are given by (19) except with tsw in place of T . By then evolving these values under the flow of (17) (readily obtainable because (17) is affine) we obtain (after much simplification)\ngR(u, v) = e \u2212kt [( Iref \u2212 VIR ) cos(\u03c9t) + 1 \u03c9L ( VI \u2212 e\u22122ktswv + kL ( Iref \u2212 VIR )) sin(\u03c9t)\n1 \u03c9C ( Iref \u2212 VIR ) sin(\u03c9t) + ( VI \u2212 e\u22122ktswv )( k \u03c9 sin(\u03c9t)\u2212 cos(\u03c9t) ) ]+ [VIR VI ] ,\n(20)\nwhere k = 1 2RC\n, \u03c9 = \u221a\n1 LC \u2212 k2, and t = T \u2212 tsw. These formulas are also given in [21].\nThe period-2T orbit described above corresponds to a period-two solution (RR-cycle) of g. The border-collision bifurcation occurs when one point of this solution collides with the switching manifold of g. Thus in a neighbourhood of this point the second iterate of g, call it f , has the form\nf(u, v) = { (gR \u25e6 gL)(u, v), u \u2264 Iref \u2212 VITL , (gR \u25e6 gR)(u, v), u \u2265 Iref \u2212 VITL .\n(21)\nWe can then bring (21) into the general form (2) via a change of variables. To end up with \u03b4R < 0 < \u03b4L (matching Sections 3 and 4) we assume this change of variables is done so that gR \u25e6 gR becomes the left piece of (2) and gR \u25e6 gL becomes the right piece of (2).\nSince we have explicit formulas for gL and gR, it is a straight-forward (although tedious) exercise to evaluate the Jacobian matrices D(gR \u25e6 gR) and D(gR \u25e6 gL) at the border-collision bifurcation. Numerically we find that with the parameter values (16), at the border-collision bifurcation the trace and determinant of D(gR \u25e6 gR) are\n\u03c4L = \u22120.2726, \u03b4L = 0.1136, (22)\nand the trace and determinant of D(gR \u25e6 gL) are\n\u03c4L = \u22121.4992, \u03b4L = \u22120.2222, (23)\nto four decimal places. With these values the border-collision normal form has a stable fixed point for \u00b5 < 0 and a stable LR-cycle for \u00b5 > 0. Specifically for \u00b5 < 0, (\u03b4L, \u03b4R) belongs to subset (vii) of Fig. 2 and (\u03c4L, \u03c4R) belongs to the red strip \u2212\u03b4L \u2212 1 < \u03c4L < \u03b4L + 1 where the left half-map has a stable fixed point. For \u00b5 > 0, (\u03b4L, \u03b4R) belongs to the top-left part of Q4 and (\u03c4L, \u03c4R) belongs to the cyan region where there exists a stable LR-cycle. In terms of the stroboscopic map g, this corresponds to a stable period-two solution bifurcating to a stable period-four solution as the value of Iref is increased to pass through the border-collision bifurcation, which confirms what we are seeing in Fig. 9.\nWe now consider parameter values different to (16). As we decrease the value of the resistance R from the value 20 and keep the other values in (16) fixed, a border-collision bifurcation still occurs but at a varying value of Iref , as shown in Fig. 10. The values of \u03c4L, \u03b4L, \u03c4R, and \u03b4R also vary with R, as shown in Fig. 11. These values belong to the same subsets and regions of Figs. 2 and 6 until atR \u2248 16.8623 we exit the cyan region for \u00b5 > 0. Specifically we cross the left boundary \u03c4R =\n(1+\u03b4L)(1+\u03b4R) \u03c4L\nwhere the LR-cycle attains an eigenvalue of 1. Beyond this boundary the border-collision normal form has no local attractor for \u00b5 > 0, and an unstable LR-cycle is created for \u00b5 < 0.\nIn terms of g, the border-collision bifurcation now mimics subcritical period-doubling because an unstable period-four solution is created and grows as the value of Iref decreases. However this solution soon becomes stable in a saddle-node bifurcation. In the two-parameter bifurcation diagram, Fig. 10, the curve of saddle-node bifurcations emanates from the curve of border-collision bifurcations with a quadratic tangency at the codimension-two point (R \u2248 16.8623) in accordance with the bifurcation theory for such points [42, 43].\nThus the power converter has a small region of bistability (between the saddle-node and border-collision bifurcations) where stable period-2T and period-4T orbits coexist. Below the codimension-two point and to the right of the border-collision bifurcation, the power converter model has a stable period-4T orbit whereas the corresponding border-collision normal form\nhas no attractor because here the period-4T orbit is a consequence of nonlinearities in g that are not captured by the normal form.\nWe explored the effect of varying the other model parameters from their values in (16) and found that the corresponding values of \u03c4L, \u03b4L, \u03c4R, and \u03b4R either remained within the subsets and regions of Figs. 2 and 6 described above, or exited the cyan region by crossing its left boundary. This suggests that over a wide range of parameter values, the border-collision bifurcation of the power converter only mimics period-doubling, but the doubling can be supercritical or subcritical depending on the parameters."
        },
        {
            "heading": "6 Discussion",
            "text": "Border-collision bifurcations occur in mathematical models of diverse physical phenomena. Subject to reasonable genericity conditions, in two dimensions the leading-order dynamics are characterised by four scalar parameters, \u03c4L, \u03c4R, \u03b4L, and \u03b4R, see \u00a72. In this paper we have attempted to provide a high-level overview of the dynamics of normal form in the noninvertible case, \u03b4L\u03b4R < 0. To grasp four-dimensional parameter space, we have considered two-dimensional slices (two-parameter bifurcation diagrams) defined by fixing the values of \u03b4L > 0 and \u03b4R < 0, and studied how the dynamics across the slices is different with different values. With instead \u03b4L < 0 and \u03b4R > 0 the same dynamical transitions occur when the sign of the border-collision bifurcation parameter \u00b5 is reversed.\nThe results are summarised by Figs. 2 and 6. The two figures correspond to different sides of the border-collision bifurcation. The intention is for these to be applied to border-collision bifurcations in models to make predictions about what dynamics are created and how the dynamics differs for different parameter values.\nWe illustrated this in \u00a75 for a classic boost converter model. The parameter values of [21] correspond a red region (stable fixed point) in Fig. 2 and a cyan region (stable LR-cycle) in Fig. 6. Thus the bifurcation in the converter affects a doubling of the period. As we vary the parameter values of the converter, we move about Figs. 2 and 6. Numerically we found we remained in the red region but could exit the cyan region by passing through a boundary where the LR-cycle loses stability. This has the effect of flipping the criticality of the period-doubling-like bifurcation in the converter."
        },
        {
            "heading": "A Existence of period-3 regions",
            "text": "Here we derive the curve \u03b63 that forms the boundary between subsets (i) and (vii) of Fig. 2. For any (\u03b4L, \u03b4R) in subset (i), the (\u03c4L, \u03c4R)-bifurcation diagram has two regions where there exists a stable LRR-cycle, Fig. 2(i). The curve \u03b63 is where the upper region, shown more clearly in Fig. 12 shrinks to a point.\nThe upper region has two boundaries. The left boundary is where the LRR-cycle loses stability by attaining an eigenvalue of \u22121. Its eigenvalues are those of M = ALA2R, so an eigenvalue of \u22121 occurs when det(M) + trace(M) + 1 = 0. By directly evaluating and rearranging this equation we find that the left boundary is given by\n\u03c4L = \u03c4R(\u03b4R + \u03b4L)\u2212 \u03b42R\u03b4L \u2212 1\n\u03c4 2R \u2212 \u03b4R . (24)\nThe right boundary is where the LRR-cycle undergoes a border-collision bifurcation and becomes virtual by having one of its points collide with the switching manifold. By direct\ncalculations, or by using the methods in [5], it is a simple exercise to show that the bifurcation occurs when det(I + AR + ARAL) = 0. By evaluating this equation we obtain the formula\n\u03c4L = \u03b4L(1\u2212 \u03b4R)\u2212 \u03c4R \u2212 1\n\u03c4R + \u03b4R , (25)\nfor the right boundary of the upper region. The two vertices of this region (the tips of the \u2018horns\u2019 of the crescent) satisfy both (24) and (25). By equating these we can eliminate \u03c4L to obtain\na\u03c4 3R + b\u03c4 2 R + c\u03c4R + d = 0, (26)\nwhere\na = 1,\nb = \u03b4L\u03b4R + \u03b4R + 1, c = \u2212\u03b4L\u03b42R + \u03b4L\u03b4R + \u03b42R \u2212 \u03b4R \u2212 1, d = \u2212\u03b4L\u03b43R \u2212 \u03b4L\u03b42R + \u03b4L\u03b4R \u2212 2\u03b4R .\nThat is, the \u03c4R-values of the vertices satisfy the cubic (26). The region vanishes when the two vertices coincide, thus when the discriminant of (26) is zero. The discriminant of (26) is\n\u2206 = 18abcd\u2212 4b3d+ b2c2 \u2212 4ac3 \u2212 27a2d2, (27)\ntherefore the curve \u03b63 is given implicitly by the two-variable polynomial equation \u2206 = 0. This curve is shown in Fig. 2. As \u03b4L is varied from 0 to 1, it appears to decrease monotonically from \u03b4R \u2248 \u22120.08238 to \u03b4R = \u22121."
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors were supported by Marsden Fund contract MAU1809, managed by Royal Society Te Apa\u0304rangi."
        }
    ],
    "year": 2022
}