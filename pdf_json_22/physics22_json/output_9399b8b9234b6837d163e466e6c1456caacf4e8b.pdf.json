{
    "abstractText": "Reduction of the circuit depth of quantum circuits is a crucial bottleneck to enabling quantum technology. This depth is inversely proportional to the number of available quantum gates that have been synthesized. Moreover, quantum gate-synthesis and control problems exhibit a vast range of external parameter dependencies, both physical and application specific. In this paper, we address the possibility of learning families of optimal-control pulses that depend adaptively on various parameters, in order to obtain a global optimal mapping from the space of potential parameter values to the control space and hence to produce continuous classes of gates. Our proposed method is tested on different experimentally relevant quantum gates and proves capable of producing high-fidelity pulses even in the presence of multiple variables or uncertain parameters with wide ranges.",
    "authors": [
        {
            "affiliations": [],
            "name": "Francesco Preti"
        },
        {
            "affiliations": [],
            "name": "Tommaso Calarco"
        },
        {
            "affiliations": [],
            "name": "Felix Motzoi"
        }
    ],
    "id": "SP:fad43e76673b6a96375c5ccee89deadaf867e98b",
    "references": [
        {
            "authors": [
                "M.A. Nielsen",
                "I.L. Chuang"
            ],
            "title": "Quantum Computation and Quantum Information: 10th Anniversary Edition",
            "year": 2010
        },
        {
            "authors": [
                "C.M. Dawson",
                "M.A. Nielsen"
            ],
            "title": "The Solovay-Kitaev algorithm",
            "venue": "Quantum Info. Comput. 6, 81 (2006). 040311-17 PRETI, CALARCO, and MOTZOI PRX QUANTUM 3, 040311 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Barenco",
                "C.H. Bennett",
                "R. Cleve",
                "D.P. DiVincenzo",
                "N. Margolus",
                "P. Shor",
                "T. Sleator",
                "J.A. Smolin",
                "H. Weinfurter"
            ],
            "title": "Elementary gates for quantum computation",
            "venue": "Phys. Rev. A 52, 3457 ",
            "year": 1995
        },
        {
            "authors": [
                "A. Peres"
            ],
            "title": "Reversible logic and quantum computers",
            "venue": "Phys. Rev. A 32, 3266 ",
            "year": 1985
        },
        {
            "authors": [
                "D. Gottesman"
            ],
            "title": "Theory of fault-tolerant quantum computation",
            "venue": "Phys. Rev. A 57, 127 ",
            "year": 1998
        },
        {
            "authors": [
                "F. Arute"
            ],
            "title": "Quantum supremacy using a programmable superconducting processor",
            "venue": "Nature 574,",
            "year": 2019
        },
        {
            "authors": [
                "T. Proctor",
                "M. Revelle",
                "E. Nielsen",
                "K. Rudinger",
                "D. Lobser",
                "P. Maunz",
                "R. Blume-Kohout",
                "K. Young"
            ],
            "title": "Detecting and tracking drift in quantum information processors",
            "venue": "Nat. Commun. 11, 5396 ",
            "year": 2020
        },
        {
            "authors": [
                "B. Foxen"
            ],
            "title": "Demonstrating a Continuous Set of Two- Qubit Gates for Near-Term",
            "venue": "Quantum Algorithms, Phys. Rev. Lett. 125,",
            "year": 2020
        },
        {
            "authors": [
                "J. Yao",
                "L. Lin",
                "M. Bukov"
            ],
            "title": "Reinforcement Learning for Many-Body Ground-State Preparation Inspired by Counterdiabatic Driving",
            "venue": "Phys. Rev. X 11, 031070 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Preskill"
            ],
            "title": "Quantum computing in the NISQ era and beyond",
            "venue": "Quantum 2, 79 ",
            "year": 2018
        },
        {
            "authors": [
                "T. Albash",
                "D.A. Lidar"
            ],
            "title": "Adiabatic quantum computation",
            "venue": "Rev. Mod. Phys. 90, 015002 ",
            "year": 2018
        },
        {
            "authors": [
                "R. Barends"
            ],
            "title": "Digitized adiabatic quantum computing with a superconducting circuit",
            "venue": "Nature 534,",
            "year": 2016
        },
        {
            "authors": [
                "B. Apolloni",
                "C. Carvalho"
            ],
            "title": "and D",
            "venue": "de Falco, Quantum stochastic optimization, Stoch. Process. Their Appl. 33, 233 ",
            "year": 1989
        },
        {
            "authors": [
                "T. Kadowaki",
                "H. Nishimori"
            ],
            "title": "Quantum annealing in the transverse Ising model",
            "venue": "Phys. Rev. E 58, 5355 ",
            "year": 1998
        },
        {
            "authors": [
                "A. Peruzzo",
                "J. McClean",
                "P. Shadbolt",
                "M.-H. Yung",
                "X.-Q. Zhou",
                "P.J. Love",
                "A. Aspuru-Guzik"
            ],
            "title": "and J",
            "venue": "L. O\u2019Brien, A variational eigenvalue solver on a photonic quantum processor, Nat. Commun. 5, 4213 ",
            "year": 2014
        },
        {
            "authors": [
                "E. Farhi",
                "J. Goldstone",
                "S. Gutmann"
            ],
            "title": "A quantum approximate optimization algorithm",
            "venue": "arXiv:1411.4028 ",
            "year": 2014
        },
        {
            "authors": [
                "T. Hospedales",
                "A. Antoniou",
                "P. Micaelli",
                "A. Storkey"
            ],
            "title": "Meta-learning in neural networks: A survey",
            "venue": "arXiv:2004.05439 ",
            "year": 2020
        },
        {
            "authors": [
                "D. Devikanniga",
                "K. Vetrivel",
                "N. Badrinath"
            ],
            "title": "Review of meta-heuristic optimization based artificial neural networks and its applications",
            "venue": "J. Phys.: Conf. Ser. 1362, 012074 ",
            "year": 2019
        },
        {
            "authors": [
                "S. Arimoto",
                "S. Kawamura",
                "F. Miyazaki"
            ],
            "title": "Bettering operation of robots by learning",
            "venue": "J. Robot. Syst. 1, 123 ",
            "year": 1984
        },
        {
            "authors": [
                "G. Tang",
                "W. Sun"
            ],
            "title": "and K",
            "venue": "Hauser, in 2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) ",
            "year": 2018
        },
        {
            "authors": [
                "N. Jetchev",
                "M. Toussaint"
            ],
            "title": "in Proceedings of the 26th Annual International Conference on Machine Learning",
            "venue": "ICML \u201909 ",
            "year": 2009
        },
        {
            "authors": [
                "S. Chen",
                "J.T. Wen"
            ],
            "title": "Neural-learning trajectory tracking control of flexible-joint robot manipulators with unknown dynamics",
            "venue": "arXiv:1908.03269 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Ozaki",
                "T. Suzuki",
                "T. Furuhashi",
                "S. Okuma",
                "Y. Uchikawa"
            ],
            "title": "Trajectory control of robotic manipulators using neural networks",
            "venue": "IEEE Trans. Ind. Electron. 38, 195 ",
            "year": 1991
        },
        {
            "authors": [
                "L. B\u00f6ttcher",
                "N. Antulov-Fantulin",
                "T. Asikis"
            ],
            "title": "AI Pontryagin or how artificial neural networks learn to control dynamical systems",
            "venue": "Nat. Commun. 13, 333 ",
            "year": 2022
        },
        {
            "authors": [
                "M. Bukov",
                "A.G. Day",
                "D. Sels",
                "P. Weinberg",
                "A. Polkovnikov",
                "P. Mehta"
            ],
            "title": "Reinforcement Learning in Different Phases of Quantum Control",
            "venue": "Phys. Rev. X 8, 031086 ",
            "year": 2018
        },
        {
            "authors": [
                "X.-C. Yang",
                "M.-H. Yung",
                "X. Wang"
            ],
            "title": "Neural-networkdesigned pulse sequences for robust control of singlettriplet qubits",
            "venue": "Phys. Rev. A 97, 042324 ",
            "year": 2018
        },
        {
            "authors": [
                "M.Y. Niu",
                "S. Boixo",
                "V.N. Smelyanskiy",
                "H. Neven"
            ],
            "title": "Universal quantum control through deep reinforcement learning",
            "venue": "npj Quantum Inf. 5, 33 ",
            "year": 2019
        },
        {
            "authors": [
                "R.-B. Wu",
                "H. Ding",
                "D. Dong",
                "X. Wang"
            ],
            "title": "Learning robust and high-precision quantum controls",
            "venue": "Phys. Rev. A 99, 042327 ",
            "year": 2019
        },
        {
            "authors": [
                "S. Lohani",
                "B.T. Kirby",
                "M. Brodsky",
                "O. Danaci",
                "R.T. Glasser"
            ],
            "title": "Machine learning assisted quantum state estimation",
            "venue": "Mach. Learn.: Sci. Technol. 1, 035007 ",
            "year": 2020
        },
        {
            "authors": [
                "J.R. Kuklinski",
                "U. Gaubatz",
                "F.T. Hioe",
                "K. Bergmann"
            ],
            "title": "Adiabatic population transfer in a three-level system driven by delayed laser pulses",
            "venue": "Phys. Rev. A 40, 6741 ",
            "year": 1989
        },
        {
            "authors": [
                "N.V. Vitanov",
                "A.A. Rangelov",
                "B.W. Shore",
                "K. Bergmann"
            ],
            "title": "Stimulated Raman adiabatic passage in physics",
            "venue": "chemistry, and beyond, Rev. Mod. Phys. 89, 015006 ",
            "year": 2017
        },
        {
            "authors": [
                "A. S\u00f8rensen",
                "K. M\u00f8lmer"
            ],
            "title": "Quantum Computation with Ions in Thermal Motion",
            "venue": "Phys. Rev. Lett. 82, 1971 ",
            "year": 1999
        },
        {
            "authors": [
                "A. S\u00f8rensen",
                "K. M\u00f8lmer"
            ],
            "title": "Entanglement and quantum computation with ions in thermal motion",
            "venue": "Phys. Rev. A 62, 022311 ",
            "year": 2000
        },
        {
            "authors": [
                "F. Motzoi",
                "J.M. Gambetta",
                "P. Rebentrost",
                "F.K. Wilhelm"
            ],
            "title": "Simple Pulses for Elimination of Leakage in Weakly Nonlinear Qubits",
            "venue": "Phys. Rev. Lett. 103, 110501 ",
            "year": 2009
        },
        {
            "authors": [
                "L.S. Theis",
                "F. Motzoi",
                "S. Machnes",
                "F.K. Wilhelm"
            ],
            "title": "Counteracting systems of diabaticities using DRAG controls: The status after 10 years",
            "venue": "EPL (Europhysics Letters) 123, 60001 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Bocharov",
                "M. Roetteler",
                "K.M. Svore"
            ],
            "title": "Efficient Synthesis of Universal Repeat-until-Success Quantum Circuits",
            "venue": "Phys. Rev. Lett. 114, 080502 ",
            "year": 2015
        },
        {
            "authors": [
                "F. Motzoi",
                "M.P. Kaicher",
                "F.K. Wilhelm"
            ],
            "title": "Linear and Logarithmic Time Compositions of Quantum Many-Body Operators",
            "venue": "Phys. Rev. Lett. 119, 160503 ",
            "year": 2017
        },
        {
            "authors": [
                "W.S. Warren",
                "H. Rabitz",
                "M. Dahleh"
            ],
            "title": "Coherent control of quantum dynamics: The dream is alive",
            "venue": "Science 259, 1581 ",
            "year": 1993
        },
        {
            "authors": [
                "R. Freeman"
            ],
            "title": "Spin Choreography (Oxford",
            "year": 1998
        },
        {
            "authors": [
                "N. Khaneja",
                "T. Reiss",
                "C. Kehlet",
                "T. Schulte-Herbr\u00fcggen",
                "S.J. Glaser"
            ],
            "title": "Optimal control of coupled spin dynamics: Design of NMR pulse sequences by gradient ascent algorithms",
            "venue": "J. Magn. Reson. 172, 296 (2005). 040311-18 CONTINUOUS QUANTUM GATE SETS AND PULSE-CLASS... PRX QUANTUM 3, 040311 ",
            "year": 2022
        },
        {
            "authors": [
                "M.H. Goerz",
                "D. Basilewitsch",
                "F. Gago-Encinas",
                "M.G. Krauss",
                "K.P. Horn",
                "D.M. Reich",
                "C.P. Koch"
            ],
            "title": "KROTOV: A Python implementation of Krotov\u2019s method for quantum optimal control",
            "venue": "SciPost Phys. 7, 80 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Caneva",
                "T. Calarco",
                "S. Montangero"
            ],
            "title": "Chopped random-basis quantum optimization",
            "venue": "Phys. Rev. A 84, 022326 ",
            "year": 2011
        },
        {
            "authors": [
                "S.J. Glaser",
                "U. Boscain",
                "T. Calarco",
                "C.P. Koch",
                "W. K\u00f6ckenberger",
                "R. Kosloff",
                "I. Kuprov",
                "B. Luy",
                "S. Schirmer",
                "T. Schulte-Herbr\u00fcggen",
                "D. Sugny",
                "F.K. Wilhelm"
            ],
            "title": "Training Schr\u00f6dinger\u2019s cat: Quantum optimal control",
            "venue": "Eur. Phys. J. D 69, 279 ",
            "year": 2015
        },
        {
            "authors": [
                "J.J. Grefenstette"
            ],
            "title": "Optimization of control parameters for genetic algorithms",
            "venue": "IEEE Trans. Syst. Man Cybern. 16, 122 ",
            "year": 1986
        },
        {
            "authors": [
                "S. Schaal",
                "C.G. Atkeson"
            ],
            "title": "Learning control in robotics",
            "venue": "IEEE Robot. Autom. Mag. 17, 20 ",
            "year": 2010
        },
        {
            "authors": [
                "C. Atkeson",
                "J. McIntyre"
            ],
            "title": "in Proceedings",
            "venue": "1986 IEEE International Conference on Robotics and Automation ",
            "year": 1986
        },
        {
            "authors": [
                "B. Li",
                "T. Calarco",
                "F. Motzoi"
            ],
            "title": "Non-perturbative analytical diagonalization of Hamiltonians with application to ZZcoupling suppression and enhancement",
            "venue": "arXiv:2112.00039 ",
            "year": 2021
        },
        {
            "authors": [
                "E.A. Martinez",
                "T. Monz",
                "D. Nigg",
                "P. Schindler",
                "R. Blatt"
            ],
            "title": "Compiling quantum algorithms for architectures with multi-qubit gates",
            "venue": "New J. Phys. 18, 063029 ",
            "year": 2016
        },
        {
            "authors": [
                "F. Frank",
                "T. Unden",
                "J. Zoller",
                "R.S. Said",
                "T. Calarco",
                "S. Montangero",
                "B. Naydenov",
                "F. Jelezko"
            ],
            "title": "Autonomous calibration of single spin qubit operations",
            "venue": "npj Quantum Inf. 3, 48 ",
            "year": 2017
        },
        {
            "authors": [
                "M. Dalgaard",
                "F. Motzoi",
                "J.H.M. Jensen",
                "J. Sherson"
            ],
            "title": "Hessian-based optimization of constrained quantum control",
            "venue": "Phys. Rev. A 102, 042612 ",
            "year": 2020
        },
        {
            "authors": [
                "C.R. de Oliveira"
            ],
            "title": "Intermediate Spectral Theory and Quantum Dynamics (Progress in Mathematical Physics",
            "year": 2008
        },
        {
            "authors": [
                "T.W. Borneman",
                "M.D. H\u00fcrlimann",
                "D.G. Cory"
            ],
            "title": "Application of optimal control to CPMG refocusing pulse design",
            "venue": "J. Magn. Reson. 207, 220 ",
            "year": 2010
        },
        {
            "authors": [
                "M. M\u00f6tt\u00f6nen"
            ],
            "title": "R",
            "venue": "de Sousa, J. Zhang, and K. B. Whaley, High-fidelity one-qubit operations under random telegraph noise, Phys. Rev. A 73, 022332 ",
            "year": 2006
        },
        {
            "authors": [
                "B. Khani",
                "S.T. Merkel",
                "F. Motzoi",
                "J.M. Gambetta",
                "F.K. Wilhelm"
            ],
            "title": "High-fidelity quantum gates in the presence of dispersion",
            "venue": "Phys. Rev. A 85, 022306 ",
            "year": 2012
        },
        {
            "authors": [
                "M.J. Biercuk",
                "H. Uys",
                "A.P. VanDevender",
                "N. Shiga",
                "W.M. Itano",
                "J.J. Bollinger"
            ],
            "title": "Optimized dynamical decoupling in a model quantum memory",
            "venue": "Nature 458, 996 ",
            "year": 2009
        },
        {
            "authors": [
                "F. Motzoi",
                "E. Halperin",
                "X. Wang",
                "K.B. Whaley",
                "S. Schirmer"
            ],
            "title": "Backaction-driven",
            "venue": "robust, steady-state longdistance qubit entanglement over lossy channels, Phys. Rev. A 94, 032313 ",
            "year": 2016
        },
        {
            "authors": [
                "S.G. Schirmer",
                "F.C. Langbein",
                "C.A. Weidner",
                "E. Jonckheere"
            ],
            "title": "Robust control performance for open quantum systems",
            "venue": "arXiv:2008.13691 ",
            "year": 2020
        },
        {
            "authors": [
                "M.M. M\u00fcller",
                "S. Gherardini",
                "F. Caruso"
            ],
            "title": "Noise-robust quantum sensing via optimal multi-probe spectroscopy",
            "venue": "Sci. Rep. 8, 14278 ",
            "year": 2018
        },
        {
            "authors": [
                "S. Wimperis"
            ],
            "title": "Broadband",
            "venue": "narrowband, and passband composite pulses for use in advanced NMR experiments, J. Magn. Reson., Ser. A 109, 221 ",
            "year": 1994
        },
        {
            "authors": [
                "H.K. Cummins",
                "J.A. Jones"
            ],
            "title": "Use of composite rotations to correct systematic errors in NMR quantum computation",
            "venue": "New J. Phys. 2, 006 ",
            "year": 2000
        },
        {
            "authors": [
                "I. Goodfellow",
                "Y. Bengio"
            ],
            "title": "and A",
            "venue": "Courville, Deep Learning ",
            "year": 2016
        },
        {
            "authors": [
                "R.S. Sutton",
                "D. McAllester",
                "S. Singh",
                "Y. Mansour"
            ],
            "title": "in Advances in Neural Information Processing Systems",
            "venue": "edited by S. Solla, T. Leen, and K. M\u00fcller ",
            "year": 1999
        },
        {
            "authors": [
                "M.A. Nielsen"
            ],
            "title": "A simple formula for the average gate fidelity of a quantum dynamical operation",
            "venue": "Phys. Lett. A 303, 249 ",
            "year": 2002
        },
        {
            "authors": [
                "J.A. Nelder",
                "R. Mead"
            ],
            "title": "A simplex method for function minimization",
            "venue": "Comput. J. 7, 308 ",
            "year": 1965
        },
        {
            "authors": [
                "D. Wierstra",
                "T. Schaul",
                "T. Glasmachers",
                "Y. Sun",
                "J. Peters",
                "J. Schmidhuber"
            ],
            "title": "Natural evolution strategies",
            "venue": "J. Mach. Learn. Res. 15, 949 ",
            "year": 2014
        },
        {
            "authors": [
                "S. Mohamed",
                "M. Rosca",
                "M. Figurnov",
                "A. Mnih"
            ],
            "title": "Monte Carlo gradient estimation in machine learning",
            "venue": "J. Mach. Learn. Res. 21, 1 ",
            "year": 2020
        },
        {
            "authors": [
                "F. Motzoi",
                "J.M. Gambetta",
                "S.T. Merkel",
                "F.K. Wilhelm"
            ],
            "title": "Optimal control methods for rapidly time-varying Hamiltonians",
            "venue": "Phys. Rev. A 84, 022307 ",
            "year": 2011
        },
        {
            "authors": [
                "J. Bradbury",
                "R. Frostig",
                "P. Hawkins",
                "M.J. Johnson",
                "C. Leary",
                "D. Maclaurin",
                "G. Necula",
                "A. Paszke",
                "J. Vander- Plas",
                "S. Wanderman-Milne",
                "Q. Zhang"
            ],
            "title": "JAX: Composable transformations of PYTHON+NumPy programs",
            "venue": "http://github.com/google/jax ",
            "year": 2018
        },
        {
            "authors": [
                "L.B. Rall"
            ],
            "title": "Automatic Differentiation",
            "venue": "Lecture Notes in Computer Science ",
            "year": 2006
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "J. Oteo",
                "J. Ros"
            ],
            "title": "The Magnus expansion and some of its applications",
            "venue": "Phys. Rep. 470, 151 ",
            "year": 2009
        },
        {
            "authors": [
                "M. Dalgaard",
                "F. Motzoi"
            ],
            "title": "Fast",
            "venue": "high precision dynamics in quantum optimal control theory, J. Phys. B: At. Mol. Opt. Phys. 55, 085501 ",
            "year": 2022
        },
        {
            "authors": [
                "D.C. Liu",
                "J. Nocedal"
            ],
            "title": "On the limited memory BFGS method for large scale optimization",
            "venue": "Math. Program. 45, 503 ",
            "year": 1989
        },
        {
            "authors": [
                "M. Kjaergaard",
                "M.E. Schwartz",
                "J. Braum\u00fcller",
                "P. Krantz",
                "J.I.-J. Wang",
                "S. Gustavsson",
                "W.D. Oliver"
            ],
            "title": "Superconducting qubits: Current state of play",
            "venue": "Annu. Rev. Condens. Matter Phys. 11, 369 ",
            "year": 2020
        },
        {
            "authors": [
                "B. Khani",
                "J.M. Gambetta",
                "F. Motzoi",
                "F.K. Wilhelm"
            ],
            "title": "Optimal generation of Fock states in a weakly nonlinear oscillator",
            "venue": "Phys. Scr. T137, 014021 ",
            "year": 2009
        },
        {
            "authors": [
                "C. Cohen-Tannoudji",
                "J. Dupont-Roc"
            ],
            "title": "and G",
            "venue": "Grynberg, Atom-Photon Interactions ",
            "year": 1998
        },
        {
            "authors": [
                "L.S. Theis",
                "F. Motzoi",
                "F.K. Wilhelm"
            ],
            "title": "Simultaneous gates in frequency-crowded multilevel systems using fast",
            "venue": "040311-19 PRETI, CALARCO, and MOTZOI PRX QUANTUM 3, 040311 (2022) robust, analytic control shapes, Phys. Rev. A 93, 012324 ",
            "year": 2016
        },
        {
            "authors": [
                "G.S. Paraoanu"
            ],
            "title": "Microwave-induced coupling of superconducting qubits",
            "venue": "Phys. Rev. B 74, 140504 ",
            "year": 2006
        },
        {
            "authors": [
                "C. Rigetti",
                "M. Devoret"
            ],
            "title": "Fully microwave-tunable universal gates in superconducting qubits with linear couplings and fixed transition frequencies",
            "venue": "Phys. Rev. B 81, 134507 ",
            "year": 2010
        },
        {
            "authors": [
                "S. Kirchhoff",
                "T. Ke\u00dfler",
                "P.J. Liebermann",
                "E. Ass\u00e9mat",
                "S. Machnes",
                "F. Motzoi",
                "F.K. Wilhelm"
            ],
            "title": "Optimized crossresonance gate for coupled transmon systems",
            "venue": "Phys. Rev. A 97, 042348 ",
            "year": 2018
        },
        {
            "authors": [
                "M. Malekakhlagh",
                "E. Magesan"
            ],
            "title": "Mitigating off-resonant error in the cross-resonance gate",
            "venue": "Phys. Rev. A 105, 012602 ",
            "year": 2022
        },
        {
            "authors": [
                "M. Malekakhlagh",
                "E. Magesan",
                "D.C. McKay"
            ],
            "title": "Firstprinciples analysis of cross-resonance gate operation",
            "venue": "Phys. Rev. A 102, 042605 ",
            "year": 2020
        },
        {
            "authors": [
                "K. Heya",
                "N. Kanazawa"
            ],
            "title": "Cross-Cross Resonance Gate",
            "venue": "PRX Quantum 2, 040336 ",
            "year": 2021
        },
        {
            "authors": [
                "P.J. Huber"
            ],
            "title": "Robust estimation of a location parameter",
            "venue": "Ann. Math. Stat. 35, 73 ",
            "year": 1964
        },
        {
            "authors": [
                "D.P. Kingma",
                "J. Ba"
            ],
            "title": "ADAM: A method for stochastic optimization",
            "venue": "CoRR abs/1412.6980 ",
            "year": 2015
        },
        {
            "authors": [
                "D.-H. Lee",
                "S. Zhang",
                "A. Fischer",
                "Y. Bengio"
            ],
            "title": "Difference target propagation",
            "venue": "arXiv:1412.7525 ",
            "year": 2014
        },
        {
            "authors": [
                "J. Heek",
                "A. Levskaya",
                "A. Oliver",
                "M. Ritter",
                "B. Rondepierre",
                "A. Steiner"
            ],
            "title": "and M",
            "venue": "van Zee, FLAX: A neural network library and ecosystem for JAX, https://github.com/google/flax ",
            "year": 2020
        },
        {
            "authors": [
                "P. de Fouquieres",
                "S. Schirmer",
                "S. Glaser"
            ],
            "title": "Kuprov, Second order gradient ascent pulse engineering",
            "venue": "J. Magn. Reson. 212,",
            "year": 2011
        },
        {
            "authors": [
                "R.H. Byrd",
                "J. Nocedal",
                "R.B. Schnabel"
            ],
            "title": "Representations of quasi-Newton matrices and their use in limited memory methods",
            "venue": "Math. Program. 63, 129 ",
            "year": 1994
        },
        {
            "authors": [
                "P. Virtanen"
            ],
            "title": "Fundamental algorithms for scientific computing in Python, Nat",
            "venue": "Methods 17,",
            "year": 2020
        },
        {
            "authors": [
                "A. Kandala",
                "K.X. Wei",
                "S. Srinivasan",
                "E. Magesan",
                "S. Carnevale",
                "G.A. Keefe",
                "D. Klaus",
                "O. Dial",
                "D.C. McKay"
            ],
            "title": "Demonstration of a High-Fidelity CNOT Gate For Fixed-Frequency Transmons With Engineered ZZ Suppression",
            "venue": "Phys. Rev. Lett. 127, 130501 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Nievergelt"
            ],
            "title": "in Proceedings of the 27th Conference on Current Trends in Theory and Practice of Informatics",
            "venue": "SOFSEM \u201900 ",
            "year": 2000
        }
    ],
    "sections": [
        {
            "text": "PRX QUANTUM 3, 040311 (2022)\nContinuous Quantum Gate Sets and Pulse-Class Meta-Optimization\nFrancesco Preti ,1,2,* Tommaso Calarco,1,2 and Felix Motzoi1,\u2020 1 Forschungszentrum J\u00fclich, Institute of Quantum Control (PGI-8), J\u00fclich D-52425, Germany\n2 Institute for Theoretical Physics, University of Cologne, K\u00f6ln, D-50937, Germany\n(Received 11 May 2022; revised 20 August 2022; accepted 6 September 2022; published 25 October 2022)\nReduction of the circuit depth of quantum circuits is a crucial bottleneck to enabling quantum technology. This depth is inversely proportional to the number of available quantum gates that have been synthesized. Moreover, quantum gate-synthesis and control problems exhibit a vast range of external parameter dependencies, both physical and application specific. In this paper, we address the possibility of learning families of optimal-control pulses that depend adaptively on various parameters, in order to obtain a global optimal mapping from the space of potential parameter values to the control space and hence to produce continuous classes of gates. Our proposed method is tested on different experimentally relevant quantum gates and proves capable of producing high-fidelity pulses even in the presence of multiple variables or uncertain parameters with wide ranges.\nDOI: 10.1103/PRXQuantum.3.040311\nI. INTRODUCTION\nThe standard view of quantum computation [1] uses the classical-computing abstraction of a subdivision into a finite set of gates, measurements, and state reset tasks. This paradigm has a number of benefits: notably, it permits formal derivation of universal computation [2,3], that is, the composition of a quantum circuit for any desired unitary operation, as well as error-correcting codes [4,5], where specific error syndromes can be measured and corrected. On the other hand, this abstraction abandons the essential analog character of quantum devices, from which they have the most to gain or lose in terms of their expressibility or fragility, respectively. That is, the power of quantum processors depends strongly on the number of usable gates available to them.\nPractically speaking, the usage of discrete gate sets falls short in at least four important respects. First, the analog character is a more complete (and therefore efficient) description of variability between different qubits, which is inevitable, for instance, in solid-state qubits [6]. The use of qubit-agnostic gate sets as the computational primitive means that each qubit must be individually optimized and calibrated to yield each such gate [6], where parametric\n*f.preti@fz-juelich.de \u2020f.motzoi@fz-juelich.de\nPublished by the American Physical Society under the terms of the Creative Commons Attribution 4.0 International license. Further distribution of this work must maintain attribution to the author(s) and the published article\u2019s title, journal citation, and DOI.\ndescription of the gates would naturally capture the variations. Second, these variations can occur for a given qubit as a function of time [7], e.g., due to time-dependent noise, and require complete recalibrations where, typically, drift involves only a single parameter. This is very taxing on the routines for error suppression, mitigation, and correction.\nThird, the complexity arising from parameter variations in space and time is exacerbated by the subsequent circuit complexity in composing useful circuits. It is well known that while discrete gate sets can be universal, the required number of discrete constituent gates can be very large even for a simple circuit [3,8,9]. Allowing for analog parameter tuning can dramatically increase the controllability of the system and thereby necessarily reduce the depth of the quantum circuit for arbitrary tasks (see, e.g., Appendix C). Since errors accrue with circuit depth (notably due to decoherence), this increase in the circuit success probability may be highly beneficial to both short-term and long-term (i.e., fault-tolerant) approaches.\nFourth, a further optimization layer is currently ubiquitous in noisy intermediate-state quantum (NISQ) algorithms [10]. Such optimizable circuits include adiabatic [11,12], annealing [13,14], and variational [15,16] quantum algorithms. The common denominator in these approaches is the circuit being treated as a black box, with a set of analog parameters acting as knobs to tune as inputs for the respective algorithm. These analog inputs act as terms in the Hamiltonian and thus may generate various quantum continuous gate sets. These cannot realistically be compiled with digital gates and, moreover, to ensure that the gate set is correctly specified requires a formal approach for their general construction.\n2691-3399/22/3(4)/040311(20) 040311-1 Published by the American Physical Society\nOur contribution, in this work, is to present a unified framework to efficiently describe and optimize continuous quantum gate sets in these scenarios. This framework allows learning of the parametric gates that can be tuned to very high fidelity across a large number and wide range of parameter values. We refer to our method as single-optimization multiple-application (SOMA) quantum gate synthesis. This kind of learning can be understood as an instance of meta-optimization [17,18] or adaptivetrajectory learning [19\u201325] and can be related to more recent uses of neural networks in quantum physics [9,26\u2013 30]. That is, we find a solution for an optimizer that itself provides solutions to specific problem instances or, with a different formulation, automatically discovers heuristics to construct solutions for a specific optimization problem. In particular, we see that our algorithms are able to synthesize heuristics for general Hamiltonians.\nWe break down the problem of generalized gate synthesis into the following components. We parametrize our quantum gate set using continuous indices that represent either physical system parameters or desired angles of a continuous Lie group. We then present two different machine-learning methods for obtaining continuous control parametrizations that generate the indexed gate set. The first is a supervised approach where traditional optimal-control theory is used to generate an operational data set from which a generalized gate-set recipe can be trained. The second is an unsupervised approach using back propagation, from which the continuous gate set can be incrementally learned over the entire training population. Finally, we show that our approaches encompass the various situations discussed above, including general solutions for gates given generic physical architectures with wide parameter ranges, noise-adaptive optimalcontrol theory, and compilation of a Lie group instead of a single element.\nThe paper is organized as follows. In Sec. II, we introduce the notation for supervised and unsupervised training of parametrized pulses. In Sec. III, we discuss the results obtained by applying these methods to single-qubit and two-qubit gates in the presence of leakage, showing that they show similarities with known analytical solution families. Furthermore, we also investigate how our methods perform compared to other existing algorithms. Finally, in Sec. IV we analyze the dependence on the parameter variability range, the training-data-set size and batch size, and the system and network size, and again compare our algorithms to other numerical robust approaches. We summarize our conclusions in Sec. V."
        },
        {
            "heading": "II. CONTINUOUS GATE-SET LEARNING",
            "text": ""
        },
        {
            "heading": "A. Definitions",
            "text": "We define a continuous gate set in terms of some continuous sets or distributions of n system parameters\ns1, s2, . . . , sn and m gate specifications \u03b81, \u03b82, . . . , \u03b8m. An element of such a gate set is a unitary transformation between two Hilbert spaces H1 and H2:\nU(s1, s2, . . . , sn, \u03b81, \u03b82, . . . , \u03b8m) : H1 \u2192 H2. (1)\nObtaining a single element of this set is a wellknown problem in quantum information. Depending on whether the unitary is synthesized from discrete or analog dynamics, its composition is referred to as circuit compilation [2,3,37,38] or optimal-control theory [39\u201344], respectively.\nIn Fig. 1(a), we see an example of a generic circuit acting on different qubits. Each qubit in space (and time) will have different values of the common system parameters {sk}. In addition, the different unitaries in the gate set {Ui}, each additionally characterized by rotation angles {\u03b8i,j }, may vary both throughout the circuit and in iterated uses of the circuit (e.g., in NISQ algorithms). For compactness, we now regroup the continuous indices into a common array of indices \u03bb = (s1, s2, . . . , sn, \u03b81, \u03b82, . . . , \u03b8m).\nSuch a generalization of the gate-synthesis problem can be framed as solving for the inverse function of the general dynamics given in Eq. (1), that is, for\ng : \u03bb \u2192 u(t), (2)\nwhere u(t) is a wave-form function in the standard case of optimal-control theory but can also be thought of as a discrete sequence of hard pulses, as in NMR applications, or of unitary gates in circuit compilation. Importantly, the optimal u(t) changes for each parametrization \u03bb of the unitary, which can be generated from, e.g., the Schr\u00f6dinger equation\nU\u0307( \u03bb, t) = \u2212iH( \u03bb, u(t))U( \u03bb, u(t)), (3)\nor other equations of motion defining the system. This task can be cast as an instance of meta-optimization [45] or trajectory learning for control [24,46,47]. We formalize the meta-optimization problem as a list of problemparameter vectors \u03bb1, . . . , \u03bbL \u2208 V\u03bb \u2282 RD with figures of merit F1(x) = F(x, \u03bb1), . . . , FL(x) = F(x, \u03bbL) and initial guess x0, the physical parameters of which vary somewhat from each other, such that \u03bbi \u223c \u03c0( \u03bb|v) for 0 \u2264 i \u2264 L and v \u2208 V\u03bb, is drawn from a parameter distribution. Throughout the paper we assume, without loss of generality, \u03c0 to be a multidimensional uniform distribution, such that \u03c0( \u03bb|v) = U( \u03bbmin, \u03bbmax), with v = ( \u03bbmin, \u03bbmax) defining the parameter space V\u03bb.\nThe objective is to find optimal parameters w\u2217,\nw\u2217 = argmin w {1 \u2212 Fi(w)| \u2200i = 1, . . . , L}, (4)\n040311-2\nwhich allow for simultaneous optimization of all the systems considered within the range of sampled parameters."
        },
        {
            "heading": "B. Analytical adaptive control",
            "text": "The most straightforward way to generate classes of solutions to quantum gates has been the development of analytical solutions for particular quantum systems.\nThey have in common the knowledge of the relevant state of the system at all times during the evolution. In particular, analytical knowledge of the eigenvalues [48] allows reverse engineering of the pulses to provide (near) exact solutions for the desired states.\nFigures 1(c)\u20131(f) shows several celebrated examples where such general classes of solutions have been found. We quickly review some of their main features. Given a trial pulse shape such as a Gaussian envelope p(t, t1, t2, \u03b8) = Ae(t\u2212t2/2+t1/2)2/\u03c3 2 , where \u03b8 denotes the area under the curve, the following dynamical solutions have been found.\nFigure 1(c) shows the stimulated-rapid-adiabaticpassage (STIRAP) solution for transfering population between disconnected states |0\u3009 and |2\u3009, while avoiding any (nonvanishing) temporary population in the intermediary connecting state |1\u3009. The pulse shaping is given\n040311-3\nby\nSTIRAP(|0\u3009 \u2192 |2\u3009) : ( 1, 2, , \u03b8 , T) \u2192 u(t), u1(t) = 1ei\u03b8p(t, T/3, T, \u03c0)ei t |0\u3009\u30081| , u2(t) = 2p(t, 0, 2T/3, \u03c0)e\u2212i t |1\u3009\u30082| , (5)\nwhere the order of the pulses u1 and u2 is famously counterintuitive [31,32].\nFigure 1(d) shows the M\u00f8lmer-S\u00f8rensen (MS) method for trapped-ion gates [33,34]. The required laser pulses are given by\nMS(\u03c3x \u2297 \u03c3x \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u03c3x) : ( 1, 2, \u03b4, \u03b81, \u03b82) \u2192 u(t), u1(t) = 1p(t, 0, T, \u03b81)ei\u03b82ei\u03b4t |g, n\u3009\u3008e, n \u2212 1| , u2(t) = 2p(t, 0, T, \u03b81)e\u2212i\u03b4t |g, n\u3009\u3008e, n + 1| , (6)\nwhere the first state index denotes the state of the relevant qubit and second index denotes the phonon occupation number. Because of the symmetry of the gate, it can in theory be used on an arbitrarily large number of qubits, i.e., it is a collective gate [38,49].\nFigure 1(e) shows the derivative-removal-for-adiabaticgate (DRAG) solution, for leakage suppression in multilevel systems [35,36]. This pulse profile is given by\nDRAG(|0\u3009 \u2194 |1\u3009) : ( 1, 2, \u03b1, \u03b4, \u03b81, \u03b82) \u2192 u(t), u1(t) = ei\u03b82ei\u03b4tp(t, 0, T, \u03b81)( 1 |0\u3009\u30081| + 2 |1\u3009\u30082|), u2(t) = iei\u03b82ei\u03b4t\u2202tp(t, 0, T, \u03b81)/\u03b1( 1 |0\u3009\u30081|\n+ 2 |1\u3009\u30082|). (7)\nWe see, with these families of solutions, the common trend that they allow for different known system parameters or for different rotation or phase angles. Naturally, this is just a representative set but where the equations of motion are integrable, such solutions are numerous in the literature.\nHowever, there are a few evident concerns about finding such analytical solutions. First, it is a labor-intensive task with no guaranteed result, where even particular solutions do not preclude the possibility hat a more systematic search would produce better results. Second, it is important to emphasize that these are solutions to idealized models and in practice the more accurate physical models are not exactly solved by these ans\u00e4tze. Finally, most physical systems have to date not been able to find general analytical solutions beyond qubits, qutrits, and highly symmetric systems, both because of the larger state space and the larger parameter space. This limits their viability for quantum computing, which requires much larger Hilbert spaces."
        },
        {
            "heading": "C. Gradient-ascent pulse engineering",
            "text": "Gradient-ascent pulse engineering (GRAPE) [41] is a method originally developed in the context of quantum chemistry for the optimization of dynamical evolution of NMR systems. The algorithm assumes the unitary dynamics U(t) = e\u2212 \u222b t t0 iH(\u03c4 )d\u03c4 , governed by a Hamiltonian of type\nH(t) = H0 + M\u2211\nm=1 um(t)Hm, (8)\nwhere H0 is a time-independent drift Hamiltonian and Hm, with m = 1, . . . , M , are different suitable control Hamiltonians with corresponding control fields um(t). In simulations, U(t) is often computed through different types of Trotterization [52]. GRAPE provides us with an efficient gradient of the merit function with respect to the controlpulse values. The merit function is usually given by the gate fidelity:\nF = 1 d2 |Tr{UG\u2020}|2, (9)\nwhere the normalization factor d corresponds to the dimension of the Hilbert space and G is a target unitary, which we would like to generate using the unitary dynamics. We assume a Trotter-like unitary evolution of the system of type\nU(T) = Nevo\u220f\ni=1 Uj (tj , tj \u22121), (10)\nwhere Uj (tj , tj \u22121) = e\u2212iHdt, with dt = T/Nevo = tj \u2212 tj \u22121 \u2200j = 1, . . . , Nevo, in which Nevo defines the number of time steps used in the Trotterization. In particular, considering Eq. (8), the unitary step Uj reads\nUj = exp { \u2212idt ( H0 + \u2211\nk\nuk( j )Hk\n)}\n. (11)\nThe gradient of the fidelity can be computed iteratively starting from the so-called propagated optimal state [41],\nOj = Uj +1 \u00b7 \u00b7 \u00b7 UNevoGU1 \u00b7 \u00b7 \u00b7 Uj \u22121, (12)\nso that the gradient approximately results in\n\u2202F \u2202uk( j ) \u2248 2 d2 Re { Tr { UG\u2020 } Tr { idtHkOj }} . (13)\nThis approach, however, cannot directly account for variations of the underlying dynamics due to, e.g., stochastic noise [53], field inhomogeneity [54], or Hamiltonian\n040311-4\nuncertainties [55] and the optimal pulses output by following the native gradient direction can prove significantly worse than expected if some of the underlying problem parameters vary. A possible way around this is to switch to a robust-control approach, in which the cost function given in Eq. (9) accounts for parameter shifts. A simple way [41] is to use an average fidelity over the parameter space sampled with quasi\u2013Monte Carlo,\nF\u0304 = 1 L\nL\u2211 l=1 F(w, \u03bbl), (14)\nwhere L is the number of samples."
        },
        {
            "heading": "D. Robust control",
            "text": "Similar to the adaptive solutions using analytical methods, solutions for controls robust to uncertainty in parameters have been found both by analytical and numerical means [27,40,53\u201359]. Since this involves only a single solution and not a family thereof, this has been the preferred method for parameter variability in quantum gate sets, as they are easier to design.\nRobust solutions are generally defined slightly differently from the adaptive solutions, using the figure of merit\nw\u2217 = argmin w\n(\n1 \u2212 1 L\nL\u2211 i=1 Fi(w)\n)\n. (15)\nThis cost function is more tractable from an optimization point of view because we can simply account for an ensemble of individual cost functions by taking the average of the cost functions as the objective of the optimization.\nRobust solutions have also been found using analytical methods. In particular, a common pulse sequence for gates with robustness to amplitude noise is the broadband 1 (BB1) sequence\nBB1(|0\u3009 \u2194 |1\u3009) : ( , , \u03b81, \u03b82) \u2192 u(t), u1(t) = p(t, 0, T/4, \u03b81)ei\u03c6 |0\u3009\u30081| , u2(t) = p(t, T/4, T/2, \u03c0)ei\u03b82+i cos\u22121(\u2212\u03b81/4\u03c0) |0\u3009\u30081| , u3(t) = p(t, T/2, 3T/4, 2\u03c0)\n\u00d7 ei\u03b82+i3 cos\u22121(\u2212\u03b81/4\u03c0) |0\u3009\u30081| , u4(t) = p(t, 3T/4, T, \u03c0)ei\u03b82+i cos\u22121(\u2212\u03b81/4\u03c0) |0\u3009\u30081| ,\n(16)\nwhich is independent of offsets in Rabi frequency up to sixth order, 1 \u2212 F = O( 6) [60].\nLikewise, when applying gates with unknown frequency offsets, the compensation for off-resonance with a pulse\nsequence (CORPSE) method [61] given by\nCORPSE(|0\u3009 \u2194 |1\u3009) : ( , , \u03b81, \u03b82) \u2192 u(t),\nu1(t) = ei\u03b82p (\nt, 0, T 3 , 2\u03c0 + \u03b81 2\n\u2212 sin\u22121 ( \u03b2\n2\n))\n|0\u3009 \u30081| ,\nu2(t) = ei\u03b82p (\nt, T 3 , 2T 3\n, 2\u03c0 \u2212 2 sin\u22121 ( \u03b2\n2\n))\n|0\u3009 \u30081| ,\nu3(t) = ei\u03b82p (\nt, 2T 3 , T, \u03b81 2 \u2212 sin\u22121\n( \u03b2\n2\n))\n|0\u3009 \u30081| , (17)\nwith \u03b2 = sin(\u03b8/2), is robust to the exact value of , for small enough .\nRobustness has found widespread use in quantum computation, where fabrication uncertainty, use of ensemble systems, and noise have made control challenging. The use of robust control is especially important where small deviations occur over time scales roughly on par with gate durations.\nNevertheless, if deviations are not small, if they are over a much longer (or much shorter) time scale, or if very high fidelity is sought after, then typically they have limited value. This is especially the case where variability occurs as a result of design uncertainty or slow parameter drift or when continuous gate sets are needed as for NISQ algorithms. To understand why maximum fidelities suffer as a result of improved robustness, note that a longer pulse sequence (with multiple pulses) will necessarily incur more decoherence. Thus while pulses such as BB1 and CORPSE will reduce drift error, the overall fidelity will not be as high as a single pulse at a fraction of the duration could have yielded. We also show this quantitatively in the following sections."
        },
        {
            "heading": "E. Supervised training method: SOMA SL",
            "text": "Rather than constructively producing such classes or relying solely on optimal-control theoretic methods, here we pursue the approach of machine learning a functional approximation to the general solutions. Function approximators are mathematical objects capable of reproducing arbitrary functions using families of functions [62]. They are normally identified with neural networks and find extensive application in machine learning, data analysis, etc.\nFor the supervised approach, which is sometimes referred to as trajectory learning in the robotic control literature [47], we employ an optimizer to find the corresponding minima for a set of problems and a regressor g : RD \u2192 RQ that maps the problem-parameter space to the space of solutions to the given problem. We refer to this approach as SOMA with supervised learning (SOMA SL). A sketch of the algorithm is provided in Fig. 2(a). Starting from a seed problem with solution x\u22170, generated\n040311-5\npreviously, for N different optimal quantum control problems parametrized by \u03bb1, . . . , , \u03bbN , we generate N solutions x\u22171, . . . , x \u2217 N . Then we train the neural network to find the best nonlinear mapping between the original parameters and the solutions. Training is performed via a standard mean-squared error (MSE) loss:\nL(w) = N\u2211\ni=1 \u2016z\u2217i \u2212 g(w, \u03bbi)\u201622, (18)\nz\u2217i = x\u2217i \u2212 x\u0304\n\u03c3x , (19)\nwhere x\u0304 is the mean value of the generated data, \u03c3x is its standard deviation, and z\u2217i are the normalized data."
        },
        {
            "heading": "F. Direct-training method with back propagation: SOMA BP",
            "text": "An adaptive trajectory is a solution that depends on a specific parameter of the physical system, which the optimizer does not control, although it can make use of it. Usually, for many robotics applications, the system does not have an analytical model, thereby preventing directlearning strategies. However, for quantum dynamics, we show how we can use the model to more directly train the function approximator. We refer to this approach as SOMA with back propagation (SOMA BP). A sketch of the algorithm is provided in Fig. 2(b).\nPrime examples of adaptive trajectories are the analytical pulses in Sec. II B. For instance, by using a frequencydependent solution, DRAG eliminates the leakage inside a qutrit. Moreover, this solution parametrized by the function approximator, g, directly depends on the physical system values and can therefore be tuned if these are shifted.\nThe cost function for an ensemble of L quantumoptimal-control (QOC) problems defined by problem parameters \u03bb1, . . . , \u03bbL is given by\nL(w) = 1 \u2212 1 L\nL\u2211 l=1 F(g(w, \u03bbl), \u03bbl), (20)\nwhere F , as before, is the figure of merit, e.g., the overlap fidelity of the operation with the target quantum gate [64].\nBy parametrizing the solution in terms of a neural network that depends on the gate parameters, gradient-based optimization algorithms can be used to train the network directly off the above cost function. In essence, the usual back propagation of neural networks matches naturally with gradient-descent optimal-control methods such as GRAPE [41]. Thus, while optimizing in the fidelity landscape of the controls, our algorithm is able to simultaneously train the network to adapt to the extraneous system and gate parameters. This method can also be used in combination with a more standard robust-GRAPE approach. In this case, those parameters the calibration and control of which proves difficult can be excluded from the network input.\n040311-6"
        },
        {
            "heading": "G. Experimental adaptation",
            "text": "Direct experimental application of SOMA is possible both for model-based and model-free implementations. For these purposes, one must have access to a controlled distribution of \u03bb values, corresponding to gate parameters, pulse parameters, and system parameters. For in situ optimization of the gates, one further requires access to an experimental cost function to ascertain (with low noise and bias) the merit of the pulse sequence. For modelfree control learning, the system parameters should still be indexed in some way, e.g., by performing characterization, by using a proxy such as other known characteristics, or by externally tuning parameters (e.g., the qubit frequency via magnetic or Stark shifts). For model-based approaches, one can vary the parameters \u03bb in software to map the solution space of the continuous gate sets. Thus, in both cases, provided that there is known variation in some parameters, then one can index them, e.g., discretely in space or (slowly varying) continuously in time, as shown in Figs. 3(a) and 3(b), respectively.\nWhichever parameters for \u03bb one chooses for the experiment, the task then becomes to learn the neural-network weights for the maximal performance on the relevant device and gate defined uniquely by \u03bb. Two different approaches are shown in Figs. 3(c) and 3(d). When an accurate model for the generators of the dynamics is known, then Fig. 3(d) is a natural choice whereby offline\n(i.e., open-loop) optimization of the simulated gates is first brought up and only once the solution class has been learned in situ (i.e., closed-loop) is control learning performed. In this secondary step, one can reoptimize either over the space of solutions (fine tuning optimal \u03bb\u2217) or over the space of physical controls (fine tuning optimal x\u2217).\nClosed-loop optimization directly on the experiment can be performed a number of ways, including numerical and parameter-shift approximations of the gradient, NelderMead [65], or evolutionary algorithms [66]. In the latter case, for example, Monte Carlo gradient sampling can be used to estimate the update direction [67]:\n\u2207xF(x) = 1 N\u0303\nN\u0303\u2211 i=1 F(x + i\u03c3) i, (21)\nwhere i \u223c N (0, IQ), i = 1, .., N\u0303 is a normally distributed stochastic variable sampled N\u0303 times, x is the network output representing the pulse, and \u03c3 is the standard deviation of the sampled pulses. This method is often referred to as natural evolution strategy [67]. Figure 3(c) shows how the experimental gradient of the cost function can be then back propagated via the optimizer (similarly to the GRAPE implementation above) in order to update the network weights w\u2217 directly, when the different \u03bb can be sampled simultaneously.\n040311-7"
        },
        {
            "heading": "III. RESULTS",
            "text": "We test our methods and compare to previous optimalcontrol theoretic approaches. For this purpose, we train our solution networks to learn how to perform continuous gate sets for both single- and two-qubit operations. As a figure of merit of the QOC problems, we choose the gate fidelity defined in Eq. (9). While the gradients of the fidelity with respect to the pulse parameters x can be computed using GRAPE [41,68] (see Sec. II C and Appendix A), in the context of these simulations the gradient can also be obtained through automatic differentiation [69,70]. To simulate the quantum system, we use a second-order Magnus propagator as derived in Refs. [71,72] and which is compatible with analytical or automatic differentiation [72]. For the optimization of all the parameters, we employ the algorithm L-BFGS-B [73]."
        },
        {
            "heading": "A. Single-qubit gates",
            "text": "Single-qubit gates are the fundamental building blocks of quantum circuits. Their most general form\u2014e.g., as they are implemented in the IBMQ compiler [74]\u2014is given by\nR(\u03b81, \u03b82, \u03b83) = [\ncos(\u03b81/2) \u2212ei\u03b82 sin(\u03b81/2) ei\u03b83 sin(\u03b81/2) ei(\u03b83+\u03b82) cos(\u03b81/2)\n]\n.\n(22)\nBy choosing the vector parameter \u03b8 appropriately, one can construct arbitrary single-qubit unitaries. Therefore, in any optimal quantum control problem, this triple can be considered as a vector of problem parameters, since they define the entire class of QOC problems, the goal of which is the optimization of arbitrary single-qubit gates.\nIn the following section, we consider an ensemble of QOC problems defined by parameters of the unitary target gate, Hamiltonian parameters, parameters of the control fields, and the evolution time T. To simplify the problem, we consider a target gate of type\nR1(\u03b8) = [\ncos(\u03b8/2) sin(\u03b8/2) sin(\u03b8/2) \u2212 cos(\u03b8/2)\n]\n(23)\nby setting \u03b81 = \u03b8 , \u03b82 = \u03c0 and \u03b83 = 0 in Eq. (22). For \u03b8 = \u03c0/2, the gate is the H gate, whereas for \u03b8 = \u03c0 it produces the X gate.\nThe second family of unitaries that we consider can be obtained by setting \u03b81 = \u03c0 and \u03b82 = \u03b83 = \u03b8 \u2212 \u03c0 in Eq. (22). The resulting family of gates,\nR2(\u03b8) = [ 0 ei(\u03b8\u2212\u03c0)\ne\u2212i(\u03b8\u2212\u03c0) 0\n]\n, (24)\ngenerates, among other unitaries, the X gate for \u03b8 = \u03c0 and the Y gate for \u03b8 = \u03c0/2. We would like to point out that a combination of single-qubit unitary gates as in Eqs.\n(24) and (23) is sufficient to generate arbitrary single-qubit unitaries [1].\nFor single-qubit simulations, we consider the Hamiltonian of a superconducting transmon qubit [75]. This system can be effectively reduced to a qutrit Hamiltonian [75,76], where the |0\u3009 and |1\u3009 levels provide the computational subspace and the |2\u3009 level represents the leakage. The drift Hamiltonian for our system [35] reads\nHd = \u03c9dn\u0302 + \u03b1\u03022, (25) \u0302j = |j \u3009 \u3008j | , (26)\nn\u0302 = \u2211\nj\nj \u0302j , (27)\nwhere \u03c9d is the qubit frequency and \u03b1 is the anharmonicity. Furthermore, we consider a control Hamiltonian of type\nHc(t) = (t)ei\u03c6+i\u03c9t\u03c3\u0302+ + (t)\u2217e\u2212i\u03c6\u2212i\u03c9t\u03c3\u0302\u2212, (28)\nwhere \u03c9 is the driving frequency and \u03c6 represents a timeindependent phase shift between the raising \u03c3\u0302+ and the lowering \u03c3\u0302\u2212 operators, which can be related to the rotatingwave approximation (RWA) [68,77] and which is, in this model, the only problem parameter influencing the control fields.\nComputing the RWA with detuning \u03b4 allows us to rewrite the drift Hamiltonian as\nHd = \u03b4\u03021 + (\u03b1 \u2212 2\u03b4)\u03022, (29)\nHc(t) = u1(t)X\u0302 (\u03c6) + u2(t)Y\u0302(\u03c6), (30)\nwhere \u03b4 = \u03c9d \u2212 \u03c9, X\u0302 (\u03c6) = ei\u03c6\u03c3\u0302+ + e\u2212i\u03c6\u03c3\u0302\u2212, and iY\u0302(\u03c6) = ei\u03c6\u03c3\u0302+ \u2212 e\u2212i\u03c6\u03c3\u0302\u2212.\nAlgorithm 1. SOMA SL.\n040311-8\nAlgorithm 2. SOMA BP.\nFor the control fields, we employ a Fourier ansatz:\nuj (t) = K\u2211\nk=1 xkj sin\n( k\u03c0 t T ) , j = 1, 2, (31)\nwith K Fourier modes. For the QOC simulations, we set the central values \u03b40 = 0 GHz and \u03b10 = \u22120.34 GHz [78]. The parameter vector of the QOC-problem class is\ngiven by\n\u03bb = (\u03b4, \u03b1, \u03c6, \u03b8 , T)T . (32) For all the single-qubit gate simulations, we consider a multidimensional rectangle centered at \u03bb0 = (\u03b40, \u03b10, \u03c60, \u03b80, T0)T and with upper bounds defined by \u00b1 \u03bbmax. We consider four methods, which allow us to optimize multiple systems simultaneously: standard GRAPE; robust GRAPE, which uses the average GRAPE gradient over an ensemble of QOC problems in Eq. (15); a supervised training method, which we refer to as SOMA SL (Algorithm 1), using both linear and nonlinear models and where GRAPE solutions are first generated and then approximated via Eq. (18); and the unsupervised method, which trains a neural-network pulse directly on the fidelity of an ensemble of QOC problems using back propagation on Eq. (20). The latter is referred to as SOMA BP (Algorithm 2).\nIn the following section, we consider a QOC problem with N = 500 time steps of a Magnus-type time integrator, which approximates the unitary temporal evolution of the quantum system [72]. Our pulses are parametrized as in\n040311-9\nEq. (28) by K = 4 Fourier components according to Eq. (31) for each one of the two control fields X\u0302 and Y\u0302. The control fields are multiplied with a scaling factor equal to 1/A0 to ensure that the pulse amplitudes do not exceed the typical experimental maximal value of 1 GHz.\nThe results are divided into four blocks of four plots each (Figs. 4, 5), representing models trained on two different sets of problem parameters, the ranges of which are given in Table I and in Table II. Here, we limit the number of different parameters to three, although larger numbers are possible depending on the parameter range taken into account, the specifics of the physical system, the size of the neural network, and the number of systems sampled (see Appendix B). The first three plots in each row show the infidelity as a function of one varying parameter, while the other parameters are kept at their original values given by \u03bb0. The fourth plot shows the average performance of the different methods as a function of the radial distance from the initial QOC problem \u03bb0. This last plot ensures that the performance of the methods is stable when different parameters are changed simultaneously across the entire range of the parameter space.\nIn Fig. 4, the problem parameters \u03b4 (the qubit-drive detuning), \u03b1 (the nonlinearity of the qutrit system), and T (the gate evolution time) and the target gates R1(\u03b8) defined by Eq. (23)\u2014first row\u2014and R2(\u03b8) defined by Eq. (24)\u2014second row\u2014are considered. The blue continuous line shows the GRAPE solution for the \u03bb0 parameter, the fidelity of which shows an exponential decay as a function of the distance from the center of the parameter space. The orange dashed line shows the performance of robust GRAPE and the brown dashed line the performance\nTABLE I. The parameter range for the optimization of the single-qubit gates R1(\u03b8) and R2(\u03b8) as given in Fig. 4. For this simulation, we do not vary the angle parameters of the gate but, rather, the physical parameters of the qutrit, such as \u03b4 and \u03b1 and the evolution time T.\n\u03b4 (MHz) \u03b1 (MHz) \u03c6 \u03b8 1/A0 T (ns)\nCenter 0 \u2212340 0 \u03c02 0.01 10 Maximum 40 \u2212240 0 \u03c02 0.01 20 Minimum \u221240 \u2212440 0 \u03c02 0.01 5\n040311-10\nof SOMA SL with a linear model, both with infidelities around 10\u22122. The pink dashed line shows the performance of SOMA SL with a neural network and the green dashed line the performance of SOMA BP. We observe that for the second gate R2(\u03b8), both methods are able to deliver an average infidelity below 10\u22124, whereas for the first one R1(\u03b8), SOMA BP clearly outperforms SOMA SL.\nIn Fig. 5, the problem parameters are as follows: drive frequency detuning \u03b4, the phase mismatch in the control fields \u03c6, and the gate angle \u03b8 , together with the target gates R1(\u03b8) defined by Eq. (23)\u2014first row\u2014and R2(\u03b8) defined\nby Eq. (24)\u2014second row. We note the same general trends as in Fig. 4. In particular, we observe that although both SOMA methods are closer in terms of performance for R1(\u03b8), with a little advantage for SOMA BP, for gate R2(\u03b8) SOMA BP clearly outperforms SOMA SL. We can again note that SOMA BP mostly outperforms all the other methods, providing pulses that are stable over a large range of parameters.\nFor simulations with single-qubit gates, we use a twolayered network with 256 components per layer and eight neurons in output\u2014the output space of the approximator has an output dimension Q = 2K ."
        },
        {
            "heading": "B. CR gate with leakage",
            "text": "The cross-resonance (CR) gate is a two-qubit gate activated by microwave fields, which drive one of the qubits (target) at the frequency of the other (control). The gate is implemented in the context of quantum computing with superconducting qubits [79\u201382]. The gate gives rise to a ZX -type interaction [79], which can then be used to generate different two-qubit entangling unitaries. The CR gate\n040311-11\ncan be embedded in a higher-dimensional system, e.g., where two qutrits are capacitively coupled together. In this case, the target gate is a two-qubit gate but the unitary generated by the Hamiltonian evolution is a two-qutrit gate; thus the fidelity is only computed with respect to the computational subspace\u2014the CR gate is constructed using the |0\u3009 and |1\u3009 levels. The Hamiltonian of a two-transmon system reads [80]\nH(t) = Hd + Hc(t),\nHd = 2\u2211\nj =1\n( \u03c9j b\u0302 \u2020 j b\u0302j + \u03b1j b\u0302j b\u0302\u2020j b\u0302\u2020j b\u0302j ) + J ( b\u03021b\u0302 \u2020 2 + b\u0302\u20201b\u03022 ) ,\nHc(t) = 2\u2211\nj =1 (t)ei\u03c9j t+i\u03c6 b\u0302\u2020j + (t)\u2217e\u2212i\u03c9j t\u2212i\u03c6 b\u0302j ,\n(33)\nwhere J is the coupling strength of the transmon-transmon interaction, bj is the lowering operator on the j th transmon, is the driving field, and a Duffing-oscillator approximation is performed [76]. A further standard RWA allows us to simplify the problem, introducing at the same time the notation from Eq. (25), such that\nHd = n\u03021 + \u03b1(\u0302(1)2 + \u0302(2)2 ) + J ( b\u03021b\u0302 \u2020 2 + b\u0302\u20201b\u03022 ) , (34)\nHc(t) = 2\u2211\nj =1\n(\nu( j )1 (t) ( ei\u03c6 b\u0302\u2020j + e\u2212i\u03c6 b\u0302j )\n+ u( j )2 (t) ( ei\u03c6 b\u0302\u2020j \u2212 e\u2212i\u03c6 b\u0302j )) , (35)\nwhere = \u03c91 \u2212 \u03c92. As control operators, we use the projectors X\u0302j (\u03c6) = e\u2212i\u03c6 b\u0302j + ei\u03c6 b\u0302\u2020j and iY\u0302j (\u03c6) = ei\u03c6 b\u0302\u2020j \u2212 e\u2212i\u03c6 b\u0302j , both on the control qutrit (j = 1) and the target qutrit (j = 2), as in Eq. (28), such that\nHc(t) = 2\u2211\nj =1 u( j )1 (t)X\u0302j (\u03c6) + u( j )2 (t)Y\u0302j (\u03c6), (36)\nwhere u(1)j (t), u (1) j (t) are the control fields on the j th qutrit (for the X\u0302j and the Y\u0302j operators, respectively). Note that all the fields operate at frequencies near-resonant to the target qubit. The Hamiltonian parameters are centered at values 0 = 0.2 GHz, \u03b10 = \u22120.34 GHz, J0 = 0.01 GHz. For each control field, we use a Fourier parametrization\n[43,81]:\n\u2200j = 1, 2, \u2200i = 1, 2 : u( j )i (t) = K\u2211\nk=1 xi,jk sin\n( k\u03c0 t T ) . (37)\nWe further assume, as in the single-qubit case\u2014see Eq. (28)\u2014that the control fields are influenced by a phase factor \u03c6, which then counts as a QOC-problem parameter in the two-qubit simulations.\nFor two-qubit gates with leakage, we present two different simulations, one for the controlled-NOT (CNOT) gate alone and one for a family of CR-like gates with the following parametrization:\nCR(\u03b8) = exp[i\u03b8(Z \u2297 X )]. (38)\nFor the two-qutrit gates, we use a two-layered neural network with 500 neurons per layer and 120 neurons in output. Here, the output of the approximator has a dimensionality Q = 4K , where K = 30 is the number of Fourier frequencies for each one of the four control fields\u2014see Eq. (37). The time evolution is given by 5000 Magnus steps.\nThe results of the pulse-class learning are shown in Fig. 6. The evolution time is chosen as T = 90 ns, an improvement of about a factor of 2 over typical experimental durations. The first row of plots shows the results for the CNOT gate, where variations of the parameters (the frequency difference between the control and target qubits), \u03b1 (the nonlinearity of the qutrits), and \u03c6 (the phase term of the control fields) are considered. The second line shows the results for the CR(\u03b8) gate as defined in Eq. (38). The maximal range for each parameter for each one of the two gates is described in Tables III and IV, respectively. We observe that, for both gates, the neural-network pulse trained with SOMA BP outperforms the other algorithms. For the CNOT gate, it can produce pulses that are robust over a very large detuning range (| max \u2212 min| = 200 MHz) by training on just 100 different systems sampled from a uniform distribution. For the CR gate, we choose a range of 100 MHz, while also taking into account the dependence on the angle \u03b8 . It is possible that a very\nTABLE III. The parameter range for the optimization of the two-qubit CNOT gate. The range of values , \u03b1, and \u03c6, as well as the evolution time T, are determined by considering typical experimental settings of state-of-the-art superconducting quantum circuits [82\u201384]. For the value of \u03c6, we assume a small phase error influencing the X\u0302 and Y\u0302 control fields both on the target and the control qubits.\n(MHz) \u03b1 (MHz) J (MHz) \u03c6 A0 T (ns)\nCenter 200 \u2212340 10 0 0.05 90 Maximum 300 \u2212330 10 0.1 0.05 90 Minimum 100 \u2212350 10 \u22120.1 0.05 90\n040311-12\nlarge amount of samples or long training times could improve the performance of SOMA SL further; however, as the size of the Hilbert space increases, the optimization of large sample numbers on classical machines can become computationally too time consuming."
        },
        {
            "heading": "IV. PERFORMANCE ANALYSIS",
            "text": "In this section, we compare the different metaoptimization methods as the size of the QOC problemparameter space increases. In particular, we vary the order of magnitude of the laser-frequency detuning \u03b4, the qubitfrequency detuning for the two-qubit gate, and the nonlinearity \u03b1 for both the single-qubit gate and the CR gate. For the sake of this analysis, we only vary the maximal range of one single parameter at a time, while the other problem parameters have a fixed maximal range of 10\u22123 GHz. As hyperparameters for the different algorithms, we use the same values that have proved to be effective in the previous simulations. For SOMA SL, we use up to 10000 sample problems optimized with GRAPE, whereas for SOMA BP we optimize the average fidelity\nwith 500 system samples for the single-qubit gate and 100 systems for the two-qubit gate.\nThe results are shown in Fig. 7. We observe that although supervised training using the minima produced by robust GRAPE (blue line) shows lower infidelities for small variations of the detuning (up to 10 MHz), it fails when this value is increased to 100 MHz, whereas the neural network trained with back propagation of the fidelity still produces valid optima of the QOC problem. In particular, we observe a crossing between 10 and 100 MHz for both types of detuning (\u03b4 and ) and for the nonlinearity \u03b1 in the two-qutrit case, where the performance of the supervised method (SOMA SL green line) worsens dramatically, whereas SOMA BP (orange line) is able to keep the fidelity at high experimentally valid values. In general, we observe that SOMA SL significantly outperforms SOMA BP for small parameter variations, where the precision of the nonlinear regression is high enough to reproduce the pulse variations perfectly (see also Sec. 7). As a consequence, SOMA SL can be a useful tool to achieve adaptive robustness against small parameter variations, where it clearly surpasses SOMA BP, whereas the latter shines when the parameter variations and the number of Fourier components are comparatively larger. Furthermore, SOMA BP is capable of handling large variations of multiple parameters at the same time, as shown in Fig. 5. In all cases, at least one neural-network approach outperforms robust GRAPE and the linear regression model significantly. We argue that sampling large amounts of problem parameters could actually lead to a better performance for SOMA SL for in situ physical systems or numerical simulations where sampling proves fast and efficient. However, as we show in Fig. 8, it seems that for SOMA SL (green line), there exist systems where its\n040311-13\nimprovement as a function of the sample size is limited, which makes SOMA BP orange line a better option, if its implementation is possible. Likewise, robust GRAPE (blue line) and the linear model (pink line) gain limited benefit from increasing sample sizes. In particular for SOMA SL, we can often observe behaviors such as branching and outliers in the training data set, which probably contribute to a loss in the quality of the approximations. One may try to increase the precision of the model by using loss functions that are sensitive to outliers, such as the Huber loss [85], or to restrict the use of SOMA SL to systems where limited parameter drifting does not prevent the regressor from learning a high-quality representation of the solution space.\nWe also study whether varying the chosen samples during training (i.e., minibatching) can affect the performance of our algorithms; in particular, for robust GRAPE and SOMA BP. Computing the gradient over a batch of samples gives rise to a batched version of the algorithms. More specifically, a batched version of robust GRAPE, called bGRAPE, has been studied in Ref. [29], where impressive robustness is achieved by combining batches of problem parameters with momentum-based stochastic gradient descent. This is, of course, a different algorithm than L-BFGS-B, i.e. the optimization algorithm employed in all simulations discussed in this paper, and it does not similarly guarantee near-quadratic convergence [73]. For SOMA SL, computation of the gradient based on the MSE loss over a batch of samples leads to standard neuralnetwork training with stochastic gradient descent. For the systems we consider, we do not observe an improvement of bGRAPE over robust GRAPE (called sGRAPE in Ref.\n[29]), neither with L-BFGS-B nor with ADAM [86]. We believe that this is due to the use of Fourier components, which allow for more controllability of the quantum system [68], and the use of curvature information granted by both algorithms. Nonetheless, exploration of the effect of varying samples during training remains an interesting perspective worthy of further studies and commitment, both in the context of adaptive and robust control.\nIn the last part of the analysis, we discuss the scaling of the network approximations as we increase the output dimension, the number of qubits, and the input dimension. Since we aim at controlling single- and two-qubit gates, the number of expected controls only scales linearly with the number of qubits; and since the weak coupling between qubits drops off roughly exponentially with distance, we also do not expect the search complexity in state space to increase dramatically. In simulations, we expect both algorithms to behave similarly to GRAPE (or a different gradient-based control algorithm, if this is implemented) as the dimension of the Hilbert space increases. This is due to the underlying time evolution, which in both cases is given by the Trotterization or, as in our case, the Magnus expansion. The approximation of the quantum propagator affects the gradient-based optimization for single QOC problems, which generates the target data for SOMA SL but also acts as an activation function for the neural network [29] in SOMA BP. As a consequence, we do expect the state space and the equations of motion to scale exponentially with number of qubits, which is a general problem for all control and compilation tasks. Just as in the general case, we expect a combination of informed state-space parametrizations (such as tensor networks and sparse algebras) and of quantum-aided optimization (as in Sec. II) largely to address this important problem. Moreover, by considering increasing numbers of qubits, the number of pulse parameters and control fields increases consequently. However, control fields acting on different qubits usually commute, which can dramatically decrease correlations between the pulse components. Therefore, one does not need, in general, to have a single neural network outputting all pulse parameters at once but, rather, several different neural networks, one for each group of control fields, which commute between each other. For SOMA SL, we need to generate a large data set of QOCproblem solutions by means of a standard quantum control algorithm, which may be slow for many-qubit systems. However, this task can be easily parallelized, since the different optimizations are independent of each other. In this case, the main obstacle is not represented by the nonlinear regression over the data but, rather, by the quality of the data generated by the quantum control algorithm for each solution in the parameter space. Since the problem is high dimensional, the solution space will probably exhibit structures such as branching and outliers that are difficult to include in the nonlinear regression. A possible option here\n040311-14\nis to employ algorithms for data reduction and clustering, in order to obtain a high-quality representation of the solution space. As for SOMA BP, one may distinguish between simulation and experimental implementation. In the former case, the evaluation of the infidelity and its gradient as a function of the time evolution represents the main bottleneck (see Table V in Appendix B), together with vanishing gradients, which are also a well-known problem for other NISQ use cases and represent one of the main obstacles to any experimental application. Vanishing gradients could also be tackled with alternatives to back propagation (see, e.g., Ref. [87]). Finally, for large output spaces and very deep networks, GPU training and stochastic gradientdescent algorithms may provide useful speedup, as it is the standard in deep learning."
        },
        {
            "heading": "V. CONCLUSIONS",
            "text": "In this work, we show how to engineer solutions of problems in quantum optimal control that depend on problem parameters located outside the optimization routine. This includes physical system parameters, other external parameters such as the pulse time or bandwidth, and gate parameters such as rotation angles.\nWe therefore propose two methods to learn large classes of quantum gate-synthesis problems, SOMA SL and SOMA BP. We show through experimentally relevant examples that these methods prove able to learn adaptive solutions to generalized QOC problems. The output gates have fidelities that remain very high over the entire continuous parametrization of the gate sets, for typically large ranges as would be encountered experimentally. These continuous gate sets provide the opportunity to be used as computational primitives in compilation tasks, in NISQ variational algorithms, and for entire arrays of qubits rather than individually optimized ones."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "We thank Michael Schilling, Boxi Li, Martino Calzavara, and Markus Schmitt for useful discussions. We acknowledge support from the German Ministry for Education and Research, under the QSolid project with\nGrant No. 13N16149, the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany\u2019s Excellence Strategy\u2014Cluster of Excellence Matter and Light for Quantum Computing (ML4Q) EXC 2004/1\u2014390534769, the J\u00fclich Supercomputing Center, and from the project AIDAS: AI, Data Analytics and Scalable Simulations, a joint virtual laboratory gathering the Forschungszentrum J\u00fclich (FZJ) and the French Alternative Energies and Atomic Energy Commission (CEA). The simulations were realized using the JAX [69] and FLAX [88] libraries."
        },
        {
            "heading": "APPENDIX A: GRADIENTS OF THE FIDELITY",
            "text": "GRAPE [41,89] is the standard open-loop gradientbased method for QOC solutions. It can be implemented together with a Magnus-based propagator\u2014see Ref. [72]. The gradient can then be used in combination with a gradient-based optimization algorithm, e.g., the L-BFGSB algorithm [73,90]. Variations of GRAPE exist that exploit the advantages of parametrizing the pulse according to a specific set of basis functions (e.g., Fourier basis) [68] or compute the higher-order derivatives of the fidelity with respect to the pulse [51,89]. In this paper, GRAPE is always used in combination with L-BFGS-B, which uses fast Hessian estimation [91].\nFor a given set of parametrized functions sk : t \u2192 sk(t), k = 1, . . . , K describing the time dynamics of the control fields uj (t) with control parameters xkj \u2014see Eqs. (28) and (37)\u2014and that can be time sliced in values ski = sk(ti), i = 0, . . . , Nevo, the gradient of the cost function with respect to the control parameters can be computed using the chain rule [68]:\n\u2202F \u2202xkj = \u2202uij \u2202xkj \u2202F \u2202uij , (A1)\nwhere the k index runs over the number of basis-function components, the i index over the time slice, and the j index over the different control operators. In a similar way, this can be applied to a neural-network parametrization g : RD \u2192 RQ, \u03bb \u2212\u2192 g( \u03bb) of the GRAPE pulse, mapping a given number of metaparameters to the pulse space, and the original formula can be rewritten to output the gradients of the fidelity with respect to the neural-network parameters (wml, bl):\n\u2202F \u2202wml = \u2202xkj \u2202wml \u2202uij \u2202xkj \u2202F \u2202uij , (A2)\n\u2202F \u2202bl = \u2202xkj \u2202bl \u2202uij \u2202xkj \u2202F \u2202uij , (A3)\nwith the same indexing as in Eq. (A1). In this case, the neural-network output values, which give the coefficients\n040311-15\nof the time-dependent basis functions, i.e., the terms xik = g( \u03bb)ik, depend on the QOC-problem parameters \u03bb."
        },
        {
            "heading": "APPENDIX B: IMPLEMENTATION DETAILS",
            "text": "For every physical system considered\u2014the single-qubit gate with leakage and the two-qubit gate with leakage, each one with different target gates and system parameters\u2014we first define an interval for each parameter. Values are sampled from a uniform distribution over the hypervolume defined by the intervals of parameters. The system together with the interval of parameters defines a family of QOC problems, which we analyze with one of three methods: robust control with GRAPE, which simply seeks for the best pulse for a set of different systems; SOMA SL, which first solves a sample of systems and then performs a regression over the sampled values\u2014for the sake of completeness, we consider here both a linear and a nonlinear approach; and SOMA BP, where the network is trained directly on the average infidelity of an ensemble of systems with back propagation.\nIn the case of robust GRAPE, we sample L systems and run the optimization with random restart, i.e., we run the optimization Nguesses = 5 times with different conditions and then choose the pulse with the smallest average infidelity.\nFor SOMA SL, we sample up to N = 10 000 points within the parameter space. For each one of these, we optimize the corresponding QOC problem with GRAPE\u2014this can be performed with any proper optimal quantum control method\u2014and then train the model to map the corresponding parameter to the optimal pulses.\nAs for SOMA BP, we sample L systems and run the neural-network training with random restart. The number of total samples required by the regression is usually larger than the one needed by the other two methods. The corresponding single-system optimization is nonetheless much faster and can be run in parallel. Therefore, we set N = 10 000 for each simulation, whereas for the sake of comparison and due to the similarity of the other two methods, we always use the same number of samples (either L = 500 for the single-qubit case or L = 100 for the two-qubit case). Both SOMA methods employ two-layered neural networks with 256 neurons per layer for the singlequbit system and 500 neurons per layer for the two-qubit system. The linear model performs multilinear regression on the same data used by SOMA SL.\nFor the random restart of SOMA methods, we run the optimization Nguesses = 5 times with different initial conditions and then test the quality of the predictions on a test set. Afterward, we choose the model with the lowest average test infidelity. For both algorithms, we use the LBFGS-B algorithm. Since the training of SOMA SL, which uses a MSE loss, is much faster than that for SOMA BP, we do not limit its maximal number of iterations. For SOMA\nBP, however, this is limited to 6000 for the single-qubit gates and to 7000 for the two-qubit gates. Here, the input parameters for both SOMA SL and SOMA BP should be rescaled to lie, e.g., within the range [0,1]. For SOMA BP, this can be avoided in certain cases, as long as the size of the pulses remains large enough. For details about the performance of the algorithms, see Table V.\nFor each system, we evaluate the performance of the neural-network pulses on the entire parameter space. In order to visualize the performance of the algorithms considered in a one-dimensional plot, we consider the normalized parameter space, where all parameter axes are rescaled to the interval [0,1]:\nf : RD \u2192 [0, 1]D, \u03bb \u2212\u2192 \u03bb \u2212 \u03bbmin\u2223\n\u2223 \u2223 \u03bbmax \u2212 \u03bbmin \u2223 \u2223 \u2223 . (B1)\nBy then considering D-dimensional spheres of radius r \u2208 [0, 1]D, we sample Ns = 1000 systems on the surfaces of such spheres and compute the average infidelity over these systems. By doing so, we can evaluate the performance over the parameter space, thereby ensuring that our methods are effective for every combination of problemparameter values. The result is then averaged over Ns samples, i.e., we plot the mean and its standard. The latter is pictured as a shady region.\nWe also want to consider how the standard deviation of the average infidelity behaves when the different algorithms are tested against a batch of quantum systems sampled according to the parameter space. In particular, the standard deviation of the infidelity for Ns test systems is bounded by the average performance of the algorithms:\n\u03c3(w)2 = 1 L\nNs\u2211 i=1 F(w, \u03bbi)2 \u2212 F2test \u2264 1 \u2212 F2test, (B2)\nwhere Ftest is the average fidelity of the trained pulses on the Ns test systems. For SOMA BP, assuming that overfitting is negligible, we have \u03c3(w)2 \u2264 1 \u2212 (1 \u2212 L(w))2, which means that the fidelity of the algorithms considered is guaranteed not to drop significantly below the average performance shown in Figs. 4, 5 and 6."
        },
        {
            "heading": "APPENDIX C: FIDELITY OF DISCRETE GATES AND THEIR PERFORMANCE",
            "text": "In this appendix, we briefly discuss how analog gates are expected to outperform equivalent-circuit decomposition with sequences of traditional discrete gates. In particular, we first consider the standard universal set of quantum gates S = {CNOT, T, S, H} used in Fig. 1. We search for decompositions to determine the correct compilation sequence for the aforementioned gates. In particular, we consider the CR gate defined in Eq. (38) for an angle of\n040311-16\n\u03b8 = \u03c0/4. The decomposition is given by the following circuit:\nThis decomposition consists of one entangling gate (the CNOT) and four local unitary operations and the representation is exact. Note that CNOT has to be implemented efficiently on the chosen quantum computing platform, which probably requires quantum control anyway. An entangling gate in the context of superconducting circuits usually requires T \u223c 150 ns [92]. This is a little bit slower than the CR gate presented here but shows the equivalency of these gate sets. Nonetheless, SOMA also allows learning of both the CR and the CNOT as part of the same continuous gate set, thereby saving the additional cost of single-qubit gates (which typically take at least T \u223c 15 ns each).\nWhere the advantage really shows up is for a gate angle that does not belong to the same entanglement class as CNOT. Here, it is clear how continuously parametrized gates and consequently SOMA can be beneficial to quantum compilation. A CR gate with an angle \u03b8 = \u03c0/8 also requires five gates to be implemented, as shown by the following circuit:\nbut its circuit contains two CNOT gates. Since the CR (\u03c0/8) can take roughly half the time of a CR(\u03c0/4), this implies that the CNOT-based circuit can be as much as 7 times slower than the continuously parametrized gate.\nFor other angles, it becomes increasingly difficult to find good circuits, with only partial approximations being\npossible at reasonably short depth. In order to test the quality of the approximation, we search for optimal discrete circuits representing a given circuit according to a given parametrization. We use exhaustive search [93] of all possible circuits (up to circuit depth 10) and stochastic descent, a special type of structured random search\u2014see the reinforcement-learning (RL) approach in Ref. [26]\u2014(up to circuit depth 20) to search for optimal decompositions of discrete gates and try to reproduce the chosen circuit with an increasing number of unitaries. The results are given in Table VI and Fig. 9 for the CR gate with angles \u03c0/ \u221a 2, \u03c0/ \u221a 3, \u03c0/ \u221a 5, and \u03c0/ \u221a 7. We see that although the fidelity of the discrete gates increases with the size of the quantum circuit, in three cases it cannot reach the value of F = 0.99 for circuits of depth smaller than 20. In the case of \u03b8 = \u03c0/\u221a7, a valid decomposition with fidelity F = 0.9999 is found. The search is performed exhaustively for lcirc < 10 and then using stochastic descent for lcirc > 10. Moreover, the decomposition of CR(\u03c0/ \u221a 7) contains two CNOT gates, which again implies a slowdown of the gate execution time. Other examples for gates with superior analog performance can be seen in, e.g., Ref. [8], with superior performance especially expected for variational circuits.\n[1] M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Information: 10th Anniversary Edition (Cambridge University Press, Cambridge, 2010). [2] C. M. Dawson and M. A. Nielsen, The Solovay-Kitaev algorithm, Quantum Info. Comput. 6, 81 (2006).\n040311-17\n[3] A. Barenco, C. H. Bennett, R. Cleve, D. P. DiVincenzo, N. Margolus, P. Shor, T. Sleator, J. A. Smolin, and H. Weinfurter, Elementary gates for quantum computation, Phys. Rev. A 52, 3457 (1995). [4] A. Peres, Reversible logic and quantum computers, Phys. Rev. A 32, 3266 (1985). [5] D. Gottesman, Theory of fault-tolerant quantum computation, Phys. Rev. A 57, 127 (1998). [6] F. Arute et al., Quantum supremacy using a programmable superconducting processor, Nature 574, 505 (2019). [7] T. Proctor, M. Revelle, E. Nielsen, K. Rudinger, D. Lobser, P. Maunz, R. Blume-Kohout, and K. Young, Detecting and tracking drift in quantum information processors, Nat. Commun. 11, 5396 (2020). [8] B. Foxen et al., Demonstrating a Continuous Set of TwoQubit Gates for Near-Term Quantum Algorithms, Phys. Rev. Lett. 125, 120504 (2020). [9] J. Yao, L. Lin, and M. Bukov, Reinforcement Learning for Many-Body Ground-State Preparation Inspired by Counterdiabatic Driving, Phys. Rev. X 11, 031070 (2021). [10] J. Preskill, Quantum computing in the NISQ era and beyond, Quantum 2, 79 (2018). [11] T. Albash and D. A. Lidar, Adiabatic quantum computation, Rev. Mod. Phys. 90, 015002 (2018). [12] R. Barends et al., Digitized adiabatic quantum computing with a superconducting circuit, Nature 534, 222 (2016). [13] B. Apolloni, C. Carvalho, and D. de Falco, Quantum stochastic optimization, Stoch. Process. Their Appl. 33, 233 (1989). [14] T. Kadowaki and H. Nishimori, Quantum annealing in the transverse Ising model, Phys. Rev. E 58, 5355 (1998). [15] A. Peruzzo, J. McClean, P. Shadbolt, M.-H. Yung, X.-Q. Zhou, P. J. Love, A. Aspuru-Guzik, and J. L. O\u2019Brien, A variational eigenvalue solver on a photonic quantum processor, Nat. Commun. 5, 4213 (2014). [16] E. Farhi, J. Goldstone, and S. Gutmann, A quantum approximate optimization algorithm, arXiv:1411.4028 (2014). [17] T. Hospedales, A. Antoniou, P. Micaelli, and A. Storkey, Meta-learning in neural networks: A survey, arXiv:2004.05439 (2020). [18] D. Devikanniga, K. Vetrivel, and N. Badrinath, Review of meta-heuristic optimization based artificial neural networks and its applications, J. Phys.: Conf. Ser. 1362, 012074 (2019). [19] S. Arimoto, S. Kawamura, and F. Miyazaki, Bettering operation of robots by learning, J. Robot. Syst. 1, 123 (1984). [20] G. Tang, W. Sun, and K. Hauser, in 2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) (IEEE, Madrid, 2018), p. 3620. [21] A. D\u2019Souza, S. Vijayakumar, and S. Schaal, in Proceedings 2001 IEEE/RSJ International Conference on Intelligent Robots and Systems. Expanding the Societal Role of Robotics in the the Next Millennium (Cat. No. 01CH37180) (IEEE, Maui, HI, USA, 2001), Vol. 1, p. 298. [22] N. Jetchev and M. Toussaint, in Proceedings of the 26th Annual International Conference on Machine Learning, ICML \u201909 (Association for Computing Machinery, New York, 2009), p. 449.\n[23] S. Chen and J. T. Wen, Neural-learning trajectory tracking control of flexible-joint robot manipulators with unknown dynamics, arXiv:1908.03269 (2019). [24] T. Ozaki, T. Suzuki, T. Furuhashi, S. Okuma, and Y. Uchikawa, Trajectory control of robotic manipulators using neural networks, IEEE Trans. Ind. Electron. 38, 195 (1991). [25] L. B\u00f6ttcher, N. Antulov-Fantulin, and T. Asikis, AI Pontryagin or how artificial neural networks learn to control dynamical systems, Nat. Commun. 13, 333 (2022). [26] M. Bukov, A. G. Day, D. Sels, P. Weinberg, A. Polkovnikov, and P. Mehta, Reinforcement Learning in Different Phases of Quantum Control, Phys. Rev. X 8, 031086 (2018). [27] X.-C. Yang, M.-H. Yung, and X. Wang, Neural-networkdesigned pulse sequences for robust control of singlettriplet qubits, Phys. Rev. A 97, 042324 (2018). [28] M. Y. Niu, S. Boixo, V. N. Smelyanskiy, and H. Neven, Universal quantum control through deep reinforcement learning, npj Quantum Inf. 5, 33 (2019). [29] R.-B. Wu, H. Ding, D. Dong, and X. Wang, Learning robust and high-precision quantum controls, Phys. Rev. A 99, 042327 (2019). [30] S. Lohani, B. T. Kirby, M. Brodsky, O. Danaci, and R. T. Glasser, Machine learning assisted quantum state estimation, Mach. Learn.: Sci. Technol. 1, 035007 (2020). [31] J. R. Kuklinski, U. Gaubatz, F. T. Hioe, and K. Bergmann, Adiabatic population transfer in a three-level system driven by delayed laser pulses, Phys. Rev. A 40, 6741 (1989). [32] N. V. Vitanov, A. A. Rangelov, B. W. Shore, and K. Bergmann, Stimulated Raman adiabatic passage in physics, chemistry, and beyond, Rev. Mod. Phys. 89, 015006 (2017). [33] A. S\u00f8rensen and K. M\u00f8lmer, Quantum Computation with Ions in Thermal Motion, Phys. Rev. Lett. 82, 1971 (1999). [34] A. S\u00f8rensen and K. M\u00f8lmer, Entanglement and quantum computation with ions in thermal motion, Phys. Rev. A 62, 022311 (2000). [35] F. Motzoi, J. M. Gambetta, P. Rebentrost, and F. K. Wilhelm, Simple Pulses for Elimination of Leakage in Weakly Nonlinear Qubits, Phys. Rev. Lett. 103, 110501 (2009). [36] L. S. Theis, F. Motzoi, S. Machnes, and F. K. Wilhelm, Counteracting systems of diabaticities using DRAG controls: The status after 10 years, EPL (Europhysics Letters) 123, 60001 (2018). [37] A. Bocharov, M. Roetteler, and K. M. Svore, Efficient Synthesis of Universal Repeat-until-Success Quantum Circuits, Phys. Rev. Lett. 114, 080502 (2015). [38] F. Motzoi, M. P. Kaicher, and F. K. Wilhelm, Linear and Logarithmic Time Compositions of Quantum Many-Body Operators, Phys. Rev. Lett. 119, 160503 (2017). [39] W. S. Warren, H. Rabitz, and M. Dahleh, Coherent control of quantum dynamics: The dream is alive, Science 259, 1581 (1993). [40] R. Freeman, Spin Choreography (Oxford University Press, Oxford, 1998). [41] N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-Herbr\u00fcggen, and S. J. Glaser, Optimal control of coupled spin dynamics: Design of NMR pulse sequences by gradient ascent algorithms, J. Magn. Reson. 172, 296 (2005).\n040311-18\n[42] M. H. Goerz, D. Basilewitsch, F. Gago-Encinas, M. G. Krauss, K. P. Horn, D. M. Reich, and C. P. Koch, KROTOV: A Python implementation of Krotov\u2019s method for quantum optimal control, SciPost Phys. 7, 80 (2019). [43] T. Caneva, T. Calarco, and S. Montangero, Chopped random-basis quantum optimization, Phys. Rev. A 84, 022326 (2011). [44] S. J. Glaser, U. Boscain, T. Calarco, C. P. Koch, W. K\u00f6ckenberger, R. Kosloff, I. Kuprov, B. Luy, S. Schirmer, T. Schulte-Herbr\u00fcggen, D. Sugny, and F. K. Wilhelm, Training Schr\u00f6dinger\u2019s cat: Quantum optimal control, Eur. Phys. J. D 69, 279 (2015). [45] J. J. Grefenstette, Optimization of control parameters for genetic algorithms, IEEE Trans. Syst. Man Cybern. 16, 122 (1986). [46] S. Schaal and C. G. Atkeson, Learning control in robotics, IEEE Robot. Autom. Mag. 17, 20 (2010). [47] C. Atkeson and J. McIntyre, in Proceedings. 1986 IEEE International Conference on Robotics and Automation (IEEE, San Francisco, CA, USA, 1986), Vol. 3, p. 1737. [48] B. Li, T. Calarco, and F. Motzoi, Non-perturbative analytical diagonalization of Hamiltonians with application to ZZcoupling suppression and enhancement, arXiv:2112.00039 (2021). [49] E. A. Martinez, T. Monz, D. Nigg, P. Schindler, and R. Blatt, Compiling quantum algorithms for architectures with multi-qubit gates, New J. Phys. 18, 063029 (2016). [50] F. Frank, T. Unden, J. Zoller, R. S. Said, T. Calarco, S. Montangero, B. Naydenov, and F. Jelezko, Autonomous calibration of single spin qubit operations, npj Quantum Inf. 3, 48 (2017). [51] M. Dalgaard, F. Motzoi, J. H. M. Jensen, and J. Sherson, Hessian-based optimization of constrained quantum control, Phys. Rev. A 102, 042612 (2020). [52] C. R. de Oliveira, Intermediate Spectral Theory and Quantum Dynamics (Progress in Mathematical Physics, 54) (Birkh\u00e4user, Basel, 2008), p. 423. [53] T. W. Borneman, M. D. H\u00fcrlimann, and D. G. Cory, Application of optimal control to CPMG refocusing pulse design, J. Magn. Reson. 207, 220 (2010). [54] M. M\u00f6tt\u00f6nen, R. de Sousa, J. Zhang, and K. B. Whaley, High-fidelity one-qubit operations under random telegraph noise, Phys. Rev. A 73, 022332 (2006). [55] B. Khani, S. T. Merkel, F. Motzoi, J. M. Gambetta, and F. K. Wilhelm, High-fidelity quantum gates in the presence of dispersion, Phys. Rev. A 85, 022306 (2012). [56] M. J. Biercuk, H. Uys, A. P. VanDevender, N. Shiga, W. M. Itano, and J. J. Bollinger, Optimized dynamical decoupling in a model quantum memory, Nature 458, 996 (2009). [57] F. Motzoi, E. Halperin, X. Wang, K. B. Whaley, and S. Schirmer, Backaction-driven, robust, steady-state longdistance qubit entanglement over lossy channels, Phys. Rev. A 94, 032313 (2016). [58] S. G. Schirmer, F. C. Langbein, C. A. Weidner, and E. Jonckheere, Robust control performance for open quantum systems, arXiv:2008.13691 (2020). [59] M. M. M\u00fcller, S. Gherardini, and F. Caruso, Noise-robust quantum sensing via optimal multi-probe spectroscopy, Sci. Rep. 8, 14278 (2018).\n[60] S. Wimperis, Broadband, narrowband, and passband composite pulses for use in advanced NMR experiments, J. Magn. Reson., Ser. A 109, 221 (1994). [61] H. K. Cummins and J. A. Jones, Use of composite rotations to correct systematic errors in NMR quantum computation, New J. Phys. 2, 006 (2000). [62] I. Goodfellow, Y. Bengio, and A. Courville, Deep Learning (The MIT Press, Cambridge, Massachusetts, 2016), http://www.deeplearningbook.org. [63] R. S. Sutton, D. McAllester, S. Singh, and Y. Mansour, in Advances in Neural Information Processing Systems, edited by S. Solla, T. Leen, and K. M\u00fcller (The MIT Press, Cambridge, Massachusetts, 1999), Vol. 12. [64] M. A. Nielsen, A simple formula for the average gate fidelity of a quantum dynamical operation, Phys. Lett. A 303, 249 (2002). [65] J. A. Nelder and R. Mead, A simplex method for function minimization, Comput. J. 7, 308 (1965). [66] D. Wierstra, T. Schaul, T. Glasmachers, Y. Sun, J. Peters, and J. Schmidhuber, Natural evolution strategies, J. Mach. Learn. Res. 15, 949 (2014). [67] S. Mohamed, M. Rosca, M. Figurnov, and A. Mnih, Monte Carlo gradient estimation in machine learning, J. Mach. Learn. Res. 21, 1 (2020). [68] F. Motzoi, J. M. Gambetta, S. T. Merkel, and F. K. Wilhelm, Optimal control methods for rapidly time-varying Hamiltonians, Phys. Rev. A 84, 022307 (2011). [69] J. Bradbury, R. Frostig, P. Hawkins, M. J. Johnson, C. Leary, D. Maclaurin, G. Necula, A. Paszke, J. VanderPlas, S. Wanderman-Milne, and Q. Zhang, JAX: Composable transformations of PYTHON+NumPy programs, http://github.com/google/jax (2018). [70] L. B. Rall, Automatic Differentiation, Lecture Notes in Computer Science (Springer, Berlin, 2006). [71] S. Blanes, F. Casas, J. Oteo, and J. Ros, The Magnus expansion and some of its applications, Phys. Rep. 470, 151 (2009). [72] M. Dalgaard and F. Motzoi, Fast, high precision dynamics in quantum optimal control theory, J. Phys. B: At. Mol. Opt. Phys. 55, 085501 (2022). [73] D. C. Liu and J. Nocedal, On the limited memory BFGS method for large scale optimization, Math. Program. 45, 503 (1989). [74] IBM, IBM Quantum Composer guide, http://quantumcomputing.ibm.com/composer/docs/iqx/guide/advanced-si ngle-qubit-gates/ (2022) [Online; accessed January 5, 2022]. [75] M. Kjaergaard, M. E. Schwartz, J. Braum\u00fcller, P. Krantz, J. I.-J. Wang, S. Gustavsson, and W. D. Oliver, Superconducting qubits: Current state of play, Annu. Rev. Condens. Matter Phys. 11, 369 (2020). [76] B. Khani, J. M. Gambetta, F. Motzoi, and F. K. Wilhelm, Optimal generation of Fock states in a weakly nonlinear oscillator, Phys. Scr. T137, 014021 (2009). [77] C. Cohen-Tannoudji, J. Dupont-Roc, and G. Grynberg, Atom-Photon Interactions (John Wiley & Sons, Nashville, Tennessee, 1998). [78] L. S. Theis, F. Motzoi, and F. K. Wilhelm, Simultaneous gates in frequency-crowded multilevel systems using fast,\n040311-19\nrobust, analytic control shapes, Phys. Rev. A 93, 012324 (2016).\n[79] G. S. Paraoanu, Microwave-induced coupling of superconducting qubits, Phys. Rev. B 74, 140504 (2006). [80] C. Rigetti and M. Devoret, Fully microwave-tunable universal gates in superconducting qubits with linear couplings and fixed transition frequencies, Phys. Rev. B 81, 134507 (2010). [81] S. Kirchhoff, T. Ke\u00dfler, P. J. Liebermann, E. Ass\u00e9mat, S. Machnes, F. Motzoi, and F. K. Wilhelm, Optimized crossresonance gate for coupled transmon systems, Phys. Rev. A 97, 042348 (2018). [82] M. Malekakhlagh and E. Magesan, Mitigating off-resonant error in the cross-resonance gate, Phys. Rev. A 105, 012602 (2022). [83] M. Malekakhlagh, E. Magesan, and D. C. McKay, Firstprinciples analysis of cross-resonance gate operation, Phys. Rev. A 102, 042605 (2020). [84] K. Heya and N. Kanazawa, Cross-Cross Resonance Gate, PRX Quantum 2, 040336 (2021). [85] P. J. Huber, Robust estimation of a location parameter, Ann. Math. Stat. 35, 73 (1964). [86] D. P. Kingma and J. Ba, ADAM: A method for stochastic optimization, CoRR abs/1412.6980 (2015).\n[87] D.-H. Lee, S. Zhang, A. Fischer, and Y. Bengio, Difference target propagation, arXiv:1412.7525 (2014). [88] J. Heek, A. Levskaya, A. Oliver, M. Ritter, B. Rondepierre, A. Steiner, and M. van Zee, FLAX: A neural network library and ecosystem for JAX, https://github.com/google/flax (2020). [89] P. de Fouquieres, S. Schirmer, S. Glaser, and I. Kuprov, Second order gradient ascent pulse engineering, J. Magn. Reson. 212, 412 (2011). [90] R. H. Byrd, J. Nocedal, and R. B. Schnabel, Representations of quasi-Newton matrices and their use in limited memory methods, Math. Program. 63, 129 (1994). [91] P. Virtanen et al., Fundamental algorithms for scientific computing in Python, Nat. Methods 17, 261 (2020). [92] A. Kandala, K. X. Wei, S. Srinivasan, E. Magesan, S. Carnevale, G. A. Keefe, D. Klaus, O. Dial, and D. C. McKay, Demonstration of a High-Fidelity CNOT Gate For Fixed-Frequency Transmons With Engineered ZZ Suppression, Phys. Rev. Lett. 127, 130501 (2021). [93] J. Nievergelt, in Proceedings of the 27th Conference on Current Trends in Theory and Practice of Informatics, SOFSEM \u201900 (Springer-Verlag, Berlin, 2000), p. 18.\n040311-20"
        }
    ],
    "title": "Continuous Quantum Gate Sets and Pulse-Class Meta-Optimization",
    "year": 2022
}