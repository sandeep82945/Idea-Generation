{
    "abstractText": "The theory of cylindric algebraswas introducedbyTarski in thefifties of the twentieth century, and its intensive study was further pursued by pioneers such as Henkin andMonk and, by the Hungarian mathematicians Andr\u00e9ka, N\u00e9meti and Sain, and many of their students; to name only a few: Madar\u00e1sz, Marx, Kurucz, Simon, Mikul\u00e1s, and S\u00e1gi and many others outside Hungary including the author of this paper. Here we introduce and investigate new notions of representability for cylindric algebras and investigate various connections between such notions. Let 2 < n \u2264 l < m \u2264 \u03c9. Let CAn denote the variety of cylindric algebras of dimension n and let RCAn denote the variety of representable CAns. We say that an atomic algebra A \u2208 CAn has the complex neat embedding property up to l and m if A \u2208 RCAn \u2229NrnCAl and CmAtA \u2208 SNrnCAm . Fixing the prarameters l at the value n, this is ameasure of howmuch the algebra is representable. The yardstick is how far can its Dedekind\u2013MacNeille completion be dilated, that is to say, counting the number of more extra dimensions its Dedekind\u2013 MacNeille completion neatly embeds into. If A,B \u2208 RCAn are atomic, CmAtB \u2208 SNrnCAl and CmAtA \u2208 SNrnCAm , then we say that A is more representable than B. When m = \u03c9, we say that A is strongly representable; this is the maximum degree of representability; the algebra in question cannot be \u2018more representable\u2019 than that. In this case the atom structure of A, namely AtA, is strongly representable in the sense of Hirsch and Hodkinson. This notion gives an infinite potential spectrum of \u2018degrees\u2019 of representability. In this connection, we exhibit various atomic algebras in RCAn \u2229 NrnCAl that do no not have the complex neat embedding property for infinitely many values of l andm. It is known that the class of Kripke frames Str(RCAn) = {F : CmF \u2208 RCAn} is not elementary. From this it follows that there is some n < m < \u03c9 such that Str(SNrnCAm) = {F : CmF \u2208 SNrnCAm} is not elementary. Replacing S by Sc (forming complete subalgebras), Sd (forming dense subalgebras) and I (forming isomorphic copies), respectively, we show that for anyO \u2208 {Sc,Sd , I}, the class of frames Str(ONrnCAn+3) = {F : CmF \u2208 ONrnCAn+3} is not elementary. Metalogical applications are given to n-variable fragments of first-order logic endowed with so-called clique guarded semantics. The last semantics capture the new notions of representations introduced and studied in this paper. B Tarek Sayed Ahmed rutahmed@gmail.com 1 Department of Mathematics, Faculty of Science, Cairo University, Giza, Egypt",
    "authors": [
        {
            "affiliations": [],
            "name": "Tarek Sayed Ahmed"
        },
        {
            "affiliations": [],
            "name": "T. Sayed Ahmed"
        }
    ],
    "id": "SP:ed9d2af83f76cbc13cc1f5117fe24fa58fbf766f",
    "references": [
        {
            "authors": [
                "H. Andr\u00e9ka",
                "I.M. Ferenczi"
            ],
            "title": "N\u00e9meti (eds.), Cylindric-Like Algebras and Algebraic Logic, Bolyai Society",
            "venue": "Mathematical Studies,",
            "year": 2012
        },
        {
            "authors": [
                "H. Andr\u00e9ka",
                "I. N\u00e9meti",
                "T. Sayed Ahmed"
            ],
            "title": "Omitting types for finite variable fragments and complete representations",
            "venue": "J. Symb. Log",
            "year": 2008
        },
        {
            "authors": [
                "B. Bir\u00f3"
            ],
            "title": "Non-finite axiomatizability results in algebraic logic",
            "venue": "J. Symb. Log. 57(3),",
            "year": 1992
        },
        {
            "authors": [
                "L. Henkin",
                "A.D. Monk"
            ],
            "title": "Tarski, Cylindric Algebras, Part 1, Part 2 (North Holland",
            "year": 1970
        },
        {
            "authors": [
                "R. Hirsch",
                "I. Hodkinson"
            ],
            "title": "Complete representations in algebraic logic",
            "venue": "J. Symb. Log. 62(3),",
            "year": 1997
        },
        {
            "authors": [
                "R. Hirsch",
                "I. Hodkinson"
            ],
            "title": "Relation Algebras by Games, Studies in Logic and the Foundations of Mathematics, vol. 147",
            "year": 2002
        },
        {
            "authors": [
                "R. Hirsch",
                "I. Hodkinson"
            ],
            "title": "Completions and complete representations, in Cylindric-Like Algebras and Algebraic Logic, vol. 22, ed",
            "year": 2012
        },
        {
            "authors": [
                "R. Hirsch",
                "T. Sayed Ahmed"
            ],
            "title": "The neat embedding problem for algebras other than cylindric algebras and for infinite dimensions",
            "venue": "J. Symb. Log",
            "year": 2014
        },
        {
            "authors": [
                "I. Hodkinson"
            ],
            "title": "Atom structures of relation and cylindric algebras. Ann",
            "venue": "Pure Appl. Log",
            "year": 1997
        },
        {
            "authors": [
                "R. Maddux"
            ],
            "title": "Non finite axiomatizability results for cylindric and relation algebras",
            "venue": "J. Symb. Log",
            "year": 1989
        },
        {
            "authors": [
                "G. Sagi"
            ],
            "title": "A note on algebras of substitutions",
            "venue": "Stud. Log. 72,",
            "year": 2002
        },
        {
            "authors": [
                "T. Sayed Ahmed"
            ],
            "title": "The class of neat reducts is not elementary",
            "venue": "Log. J. IGPL 9,",
            "year": 2001
        },
        {
            "authors": [
                "T. Sayed Ahmed"
            ],
            "title": "Neat reducts and neat embeddings in cylindric algebras, in Cylindric-Like Algebras and Algebraic Logic, vol. 22, ed",
            "year": 2012
        },
        {
            "authors": [
                "T. Sayed Ahmed"
            ],
            "title": "Completions, complete representations and omitting types, in Cylindric-Like Algebras and Algebraic Logic, vol. 22, ed",
            "year": 2012
        },
        {
            "authors": [
                "T. Sayed Ahmed"
            ],
            "title": "The class of completely representable polyadic algebras of infinite dimensions is elementary",
            "venue": "Algebra universalis 72(1),",
            "year": 2014
        },
        {
            "authors": [
                "T. Sayed Ahmed"
            ],
            "title": "On notions of representabililty for cylindric polyadic algebras and a solution to the finitizability problem for first-order logic with equality",
            "venue": "Math. Log. Q",
            "year": 2015
        },
        {
            "authors": [
                "T. SayedAhmed"
            ],
            "title": "Notions of representability for cylindric and polyadic algebras. Stud.Math. Hung",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "B Tarek Sayed Ahmed rutahmed@gmail.com\n1 Department of Mathematics, Faculty of Science, Cairo University, Giza, Egypt\nKeywords Algebraic Logic \u00b7Modal Logic \u00b7 Neat Embeddings \u00b7 Atom-canonicity\nMathematics Subject Classification 03G15 \u00b7 03B45 \u00b7 05C15"
        },
        {
            "heading": "1 Introduction",
            "text": "It is well known that every Boolean algebra (satisfying a finite set of equations) is isomorphic to a field of sets, that is to say, every Boolean algebra is representable in some concrete sense, where the Boolean meets and joins are intepreted respectively as set-theoretic intersections and unions. This result, better known in the literature as Stone\u2019s Theorem, is equivalent (in ZFC) to the completeness of propositional logic. But in the case of cylindric and polyadic algebras of various dimensions the \u2018representation problem\u2019 is somewhat more involved. For example not every cylindric algebra of dimension greater than 1 is representable as a genuine field of sets with cylindrifications interpreted as forming cylinders, and in fact, the class of representable cylindric algebras of dimension greater than 2, though a variety, cannot be axiomatized by a finite schema of equations. Nevertheless, Tarski proved that in certain significant cases the finitely many cylindric algebra axioms may be adequate and strong enough to enforce representability.\nIn this connection, Tarski proved that every locally finite-dimensional cylindric algebra of infinite dimension is representable, and this, in turn, is equivalent to the completeness theorem of first-order logic proved earlier by Malcev and Henkin (who generalized G\u00f6del\u2019s original completeness proof for only countable first-order languages using the technique of Skolem functions).Here the condition of \u2018locally finite-dimensional\u2019 is an algebraic condition reflecting the fact that the formulas considered have finite length. The condition of being locally finite-dimensional is not a first-order one, nor can it indeed be replaced equivalently by a condition that is first-order definable, because it can be quite easily shown that the ultraproduct of locally finite-dimensional cylindric algebras (of infinite dimension) may not be locally finite-dimensional.\nIn the realm of representable algebras, there are several types of representations. Ordinary representations are just isomorphisms from Boolean algebras of operators to a more concrete structure (having the same signature) whose elements are sets endowed with settheoretic operations like intersection and complementation and forming cylinders. Complete representations, on the other hand, are representations that preserve arbitrary conjunctions whenever defined. More generally, consider the following question: Given an algebra and a set of meets, is there a representation that carries this set of meets to set-theoretic intersections? A complete representation would thus be one that preserves all existing meets (finite of course and infinite). Here we are assuming that our semantics is specified by set algebras, with the concrete Boolean operation of intersection among its basic operations.\nWhen the algebra in question is countable, and we have only countablymanymeets; this is an algebraic version of an omitting types theorem; the representation omits the given setmeets or non-principal types.When the algebra in question is atomic, then a representation omitting the non-principal type consisting of co-atoms turns out to be a complete representation. This follows from the following result due to Hirsch and Hodkinson: A Boolean algebra A has a complete representation f : A\u2192 \u3008\u2118(X),\u222a,\u2229,\u223c,\u2205, X\u3009 ( f is a 1-1 homomorphism and X a set) if and only if A is atomic and \u22c3 x\u2208AtA f (x) = X , where AtA is the set of atoms of A. The notion of complete representations has been linked to the algebraic notion of atomcanonicity (a well-known persistence property in modal logic) and to the metalogical notions\nof Martin\u2019s axiom, omitting types theorems and the existence of atomic models for atomic theories in various fragments and extensions of first-order logic [14, 16].\nOn the face of it, the notion of complete representations seems to be strikingly a secondorder one. This intuition is confirmed in [5], where it is proved that the classes of completely representable cylindric algebras of dimension at least three and that of relation algebras are not elementary. These results were proved by Hirsch and Hodkinson using so-called rainbow algebras [5]; in this paper we present entirely different proofs for all such results and some more closely related ones using so-called Monk-like algebras. Our proof depends essentially on some form of an infinite combinatorial version of Ramsey\u2019s Theorem. But running to such conclusions concerning (non-)first-order definability can be reckless and far too hasty, for in other non-trivial cases the notion of complete representations turns out not to be a genuinely second-order one; it is definable in first-order logic.\nThe class of completely representable Boolean algebras is elementary; it simply coincides with the atomic ones. A far less trivial example is the class of completely representable infinite-dimensional polyadic algebras; it coincides with the class of atomic, completely additive algebras. It is not hard to show that, like atomicity, complete additivity for atomic algebras can indeed be defined in first-order logic as is explained in detail in [15]. Complete additivity of extra Boolean operations defined on atomic algebras is a notion that can be captured in first-order logic; and surprisingly quite simply [15]. It is commonly accepted that the cylindric paradigm and polyadic paradigm belong to different worlds, often exhibiting conflicting behaviour, with the last highlighted by the presence of the operations of substitutions [11] that occur in polyadic jargon under the name of transformation systems.\nThe elementary closure of the class of completely representable relation and cylindric algebras of dimension greater than 2 has been studied in somedepth byHirsch andHodkinson. This class is characterized by the so-called Lyndon conditions. For each k, there is a kth Lyndon condition, \u03c1k , which is a first-order sentence coding a winning strategy in a zero-sum k-rounded Ehrenfeucht\u2013Fra\u00efss\u00e9 game between two players \u2203 and \u2200; the \u03c1ks taken together axiomatize this class. All of the \u03c1ks are needed for the axiomatization of this class, for it is not finitely axiomatizable.\nFix a finite n > 2. Let CRCAn denote the class of completely representable CAns and LCAn = ElCRCAn be the class of algebras satisfying the Lyndon conditions. For a class K of Boolean algebras of operators, let K \u2229 At denote the class of atomic algebras in K. By modifying the games coding the Lyndon conditions allowing \u2200 to reuse the pebble pairs on the board, we will show that LCAn = ElCRCAn = ElScNrnCA\u03c9 \u2229 At. Define A \u2208 CAn to be strongly representable if A is atomic and the complex algebra of its atom structure, equivalently its Dedekind\u2013MacNeille completion, in symbols CmAtA is in RCAn . This is a strong form of representability; of course A itself will be in RCAn , because A embeds into CmAtA and RCAn is a variety, a fortiori closed under forming subalgebras. We denote the class of strongly representable atomic algebras of dimension n by SRCAn . Nevertheless, there are atomic simple countable algebras that are representable, but not strongly representable. In fact, we shall see that there is a countable simple atomic algebra in RCAn such that CmAtA /\u2208 SNrnCAn+3(\u2283 RCAn).\nSo in a way some algebras are more representable than others. In fact, the following inclusions are known to hold:\nCRCAn LCAn SRCAn RCAn \u2229 At. In this paper we delve into a new notion, that of degrees of representability. Not all algebras are representable in the same way or strength. If C \u2286 NrnD, withD \u2208 CAm for some ordinal (possibly infinite) m, we say that D is an m-dilation of C or simply a dilation if m is clear\nfrom context. Using this jargon of \u2018dilating algebras\u2019 we say that A \u2208 RCAn is strongly representable up to m > n if CmAtA \u2208 SNrnCAm . This means that, though A itself is in RCAn , the Dedekind\u2013MacNeille completion of A is not representable, but nevertheless it has some neat embedding property; it is \u2018close\u2019 to being representable. Using this jargon, A admits a dilation of a bigger dimension. The bigger the dimension of the dilation of the representable algebra the more representable the algebra is, the closer it is to being strongly representable. Later in this paper, we will investigate and make precise the notion of an algebra being more representable than another. It is known that LCAn is an elementary class, but SRCAn is not. We shall prove below that Str(ONrnCAn+3 = {F : CmF \u2208 ONrnCAn+3} is not elementary with O \u2208 Sc, Sd , I as defined in the abstract.\nLayout:After the preliminaries, we show that there exists an atomic, countable and simple A \u2208 RCAn , such that its Dedekind\u2013MacNeille completion, namely, the complex algebra of its atom structure, briefly CmAtA, is outside the variety SNrnCAn+3, cf. Theorem 3.2. For any 2 < n < l < \u03c9, we show there exists an atomic algebra B \u2208 NrnCAl \u2229 RCAn , such that its Dedekind\u2013MacNeille completion CmAtB is not representable, cf. Theorem 3.5. We show that there is an atomic algebraE \u2208 RCAn such that its Dedekind\u2013MacNeille completion CmAtE is in NrnCA\u03c9, but the algebra E itself is not even in NrnCAn+1, cf. Theorem 3.6. We show that for 2 < n < \u03c9 a version of the omitting types fails for Ln \u2018almost everywhere\u2019\u2014 a notion to be made precise. We show that, for any O \u2208 {Sc,Sd , I}, the class of frames Str(ONrnCAn+3) = {F : CmF \u2208 ONrnCAn+3} is not elementary, cf. Theorem 5.5. Our proof constructs a completely representable algebraB and an atomic representable algebra C such that AtB \u2208 AtNrnCA\u03c9, CmAtB \u2208 NrnCA\u03c9, B \u2261 C and C /\u2208 ScNrnCAn+3, cf. Theorem 5.4. We relate notions of representablity formulated for atomic algebras such as complete, strong, weak, and satisfying the Lyndon condition, to atomic algebras having special neat embedding properties, cf. Theorems 6.1, 6.3, 6.4."
        },
        {
            "heading": "2 Preliminaries",
            "text": "We follow the notation of [1] which is in conformity with the notation in the monograph [4]. In particular, for any pair of ordinals \u03b1 < \u03b2, Nr\u03b1CA\u03b2(\u2286 CA\u03b1) denotes the class of \u03b1-neat reducts of CA\u03b2s. The last class is studied extensively in the chapter [13] of [1] as a key notion in the representation theory of cylindric algebras.\nDefinition 2.1 Assume that \u03b1 < \u03b2 are ordinals andB \u2208 CA\u03b2 . Then the \u03b1-neat reduct ofB, in symbols Nr\u03b1B, is the algebra obtained from B by discarding cylindrifiers and diagonal elements whose indices are in \u03b2 \\\u03b1, and restricting the universe to the set Nr\u03b1B = {x \u2208 B : {i \u2208 \u03b2 : ci x = x} \u2286 \u03b1}.\nIt is straightforward to check that Nr\u03b1B \u2208 CA\u03b1 . Let \u03b1 < \u03b2 be ordinals. If A \u2208 CA\u03b1 and A \u2286 Nr\u03b1B, withB \u2208 CA\u03b2 , thenwe say thatA neatly embeds inB, and thatB is a \u03b2-dilation of A, or simply a dilation of A if \u03b2 is clear from the context. For K \u2286 CA\u03b2 , we write Nr\u03b1K for the class {Nr\u03b1B : B \u2208 K}.\nLet 2 < n < \u03c9. Following [4], Csn denotes the class of cylindric set algebras of dimension n, and Gsn denotes the class of generalized cylindric set algebra of dimension n; C \u2208 Gsn , if C has a top element V which is a disjoint union of cartesian squares, that is, V = \u22c3i\u2208I nUi , I is a non-empty indexing set, Ui = \u2205 and Ui \u2229 Uj = \u2205 for all i = j . The operations of C are defined like in cylindric set algebras of dimension n relativized to V . It is known that IGsn = RCAn = SNrnCA\u03c9 = \u22c2k\u2208\u03c9 SNrnCAn+k . We often identify set algebras with their\ndomain referring to an injection f : A\u2192 \u2118(V ) (A \u2208 CAn) as a complete representation of A (via f ) where V is a Gsn unit.\nDefinition 2.2 An algebra A \u2208 CAn is completely representable if there exists C \u2208 Gsn , and an isomorphism f : A \u2192 C such that, for all X \u2286 A, f (\u2211 X) = \u22c3x\u2208X f (x), whenever\u2211\nX exists in A. In this case, we say that A is completely representable via f .\nIt is known that A is completely representable via f : A \u2192 C, where C \u2208 Gsn has a top element V if A is atomic and f is atomic in the sense that f ( \u2211 AtA) = \u22c3x\u2208AtA f (x) = V [5]. We denote the class of completely representable CAns by CRCAn . To define certain deterministic games to be used in the sequel, we recall the notions of atomic networks and atomic games [6, 7]. Let i < n. For n-ary sequences x\u0304 and y\u0304 if and only if y\u0304( j) = x\u0304( j) for all j = i . Definition 2.3 Fix a finite n > 2 and assume that A \u2208 CAn is atomic. (1) Ann-dimensional atomic network onA is amap N : n \u2192 AtA, where is a non-empty\nset of nodes, denoted by nodes(N ), satisfying the following consistency conditions for all i < j < n:\n\u2022 if x\u0304 \u2208 nnodes(N ), then N (x\u0304) \u2264 di j if and only if xi = x j ; \u2022 if x\u0304, y\u0304 \u2208 nnodes(N ), i < n and x\u0304 \u2261i y\u0304, then N (x\u0304) \u2264 ci N (y\u0304).\nFor n-dimensional atomic networks M and N , we write M \u2261i N if M(y\u0304) = N (y\u0304) for all y\u0304 \u2208 n(n \u223c {i}). (2) Assume m, k \u2264 \u03c9. The atomic game Gmk (AtA), or simply Gmk , is the game played on atomic networks of A using m nodes and having k rounds [7, Definition 3.3.2], where \u2200 is offered only one move, namely, a cylindrifier move: Suppose that we are at round t > 0. Then \u2200 picks a previously played network Nt (nodes(Nt ) \u2286 m), i < n, a \u2208 AtA, x \u2208 nnodes(Nt ), such that Nt (x\u0304) \u2264 ci a. For her response, \u2203 has to deliver a network M such that nodes(M) \u2286 m, M \u2261i N , and there is y\u0304 \u2208 nnodes(M) that satisfies y\u0304 \u2261i x\u0304 and M(y\u0304) = a. We write Gk(AtA), or simply Gk , for Gmk (AtA) if m \u2265 \u03c9. (3) The \u03c9-rounded game Gm(AtA) or simply Gm is like the game Gm\u03c9 (AtA) except that \u2200 has the option to reuse the m nodes in play.\nLet 2 < n < m \u2264 \u03c9. The notion of an algebra A having signature CAn possessing an m-square representation is defined in detail in [16]. An m-square representation is only locally classic. Given 2 < l < m \u2264 \u03c9, an m-square representation is l-square but the converse may fail dramatically. An \u03c9-square representation\u2014the limiting case\u2014is an ordinary representation; such a representation is m-square for each finite m. Roughly, if we zoom in by a movable window to an m-square representation, there will come a point determined by the parameter m, were we mistake this locally classic representation for a genuine ordinary Tarskian one. However, when we zoom out, \u2018contradictions\u2019 reappear. We will return to such issues in some detail in a moment. The following lemma is proved in [17, Lemma 4.6] and [16, Lemma 5.8].\nLemma 2.4 Suppose 2 < n < m \u2264 \u03c9. 1. If A \u2208 CAn is finite and A has an m-square representation, then \u2203 has a winning strategy\nin Gm(AtA). 2. If A \u2208 ScNrnCAm, then \u2200 has a winning strategy in Gm(AtA). In our proof we use a variation on a rainbow construction; in this we follow [5, 7]. Fix 2 < n < \u03c9. Given relational structures G (the greens) and R (the reds) the rainbow atom\nstructure of a CAn consists of equivalence classes of surjective maps a : n \u2192 , where is a coloured graph. A coloured graph is a complete graph labelled by the rainbow colours, the greens g \u2208 G, reds r \u2208 R, and whites; and some n \u2212 1 tuples are labelled by \u2018shades of yellow\u2019. In coloured graphs certain triangles are not allowed, for example, all green triangles are forbidden. A red triple (ri j , r j \u2032k\u2032 , ri\u2217k\u2217) i, j, j \u2032, k\u2032, i\u2217, k\u2217 \u2208 R is not allowed, unless i = i\u2217, j = j \u2032 and k\u2032 = k\u2217, in which case we say that the red indices match, cf. [5, 4.3.3]. The equivalence relation relates two such maps if and only if they essentially define the same graph [5, 4.3.4]. We let [a] denote the equivalence class containing a. For 2 < n < \u03c9, we use the graph version of the usual atomic \u03c9-rounded game Gm\u03c9 (\u03b1) with m nodes played on atomic networks of the CAn atom structure \u03b1. The game Gm(\u03b2) where \u03b2 is a CAn atom structure is like Gm\u03c9 (AtA) except that \u2200 has the option to reuse the m nodes in play. We use the \u2018graph versions\u2019 of these games as defined in [5, 4.3.3]. The (complex) rainbow algebra based on G and R is denoted byAG, R. The dimension n will always be clear from the context.\n3 Degrees of representability\n. Recall that Sc denotes the operation of forming complete subalgebras and Sd is the oper-\nation of forming dense subalgebras. We let I denote the operation of forming isomorphic images. For any class K of BAOs, it is easy to check that IK \u2286 SdK \u2286 ScK. (It is not hard to show that if K is the class of Boolean algebras, that is to say, without extra operations, then the above two inclusions are proper.)\nDefinition 3.1 Let 2 < n \u2264 l < m \u2264 \u03c9 and O \u2208 {S,Sd ,Sc, I}. (1) An algebra A \u2208 CAn has the O neat embedding property up to m if A \u2208 ONrnCAm . If\nm = \u03c9 andO = S, we say thatA has the neat embedding property. Observe that the last condition is equivalent to A \u2208 RCAn . (2) An atomic A \u2208 CAn has the complex O neat embedding property up to m if CmAtA \u2208 ONrnCAm . The word \u2018complex\u2019 in the present context refers to involving the Dedekind\u2013 MacNeille completion obtained by forming the complex algebra of the atom structure in the definition at hand. (3) An atomic algebraA \u2208 RCAn is strongly representable up l and m ifA \u2208 RCAn \u2229NrnCAl and CmAtA \u2208 SNrnCAm . If l = n and m = \u03c9, we say that A is strongly representable. In our first two main theorems, cf. Theorems 3.2, 3.5, we use a so-called blow up and blur\nconstruction. We find it useful to give the gist of the idea to make it easier for the reader, for the idea in essence is really simple and subtle, but may be overshadowed by the details of the specific, otherwise possibly complicated, construction at hand.\nTheGeneral Idea:The idea of a blow up and blur construction in (more than in) a nutshell is the following. Let 2 < n < \u03c9.\n\u2022 Assume RCAn \u2286 K \u2286 CAn , and SK = K, that is, K is closed under forming subalgebras. The purpose is to show that K is not closed under Dedekind\u2013MacNeille completions also known as Monk-minimal completions. \u2022 One starts with an atomic algebra C \u2208 CAn (usually finite) outside K. Then one blows up and blur C, by splitting some of its atoms each to infinitely many, getting a new infinite atom structureAt. In this process a (finite) set of \u2018blurs\u2019 is involved in away to be clarified in a moment. These blurs do not blur the complex algebra CmAt, in the sense that C is \u2018there on this global level\u2019, C embeds into CmAt.\n\u2022 Thus, the algebra CmAt will not be in K because C /\u2208 K, C \u2286 CmAt and SK = K. The completeness (existence of arbitray joins) of the complex algebra plays a major role, because every splitted atom of C is mapped to the join of its splitted copies which exist in CmAt, because it is complete; the other atoms are mapped to themselves. These precarious joins prohibiting membership in K do not exist in the term algebra TmAt, the subalgebra of CmAt generated by the atoms, because it is not complete; only joins of finite or cofinite subsets of the atoms do, so that now \u2018blurs\u2019 blur C on the level of the term algebra; more succintly, C does not embed in TmAt. \u2022 In fact, it can (and will be) be arranged thatTmAtwill not only be in K, but actually it will be in (the possibly smaller) class RCAn . This is where the blurs play another crucial role. Basically including essentially non-principal ultrafilters, the blurs, together with the principal ultrafilters generated by the atoms inAtwill be used as colours to representTmAtA as an algebra of genuine n-ary relations with concrete set-theoretic operations. In the process of representation, one cannot use only principal ultrafilters, because TmAt cannot be completely representable; for else this would induce a representation of CmAtA. \u2022 Using the blurs one can actually completely represent (TmAt)+, the canonical extension ofTmAt. Concluding, we get an atom structureAt that is only weakly representable, that is to say, TmAt \u2208 RCAn , but not strongly representable, that is to say, CmAt /\u2208 RCAn . Let us get more concrete by giving some specific examples to this subtle construction that\nproves highly efficient in proving non-atom canonicity.\nTheorem 3.2 If 2 < n < \u03c9, then there exists an atomic, countable and simple A \u2208 RCAn (i.e.,A has the neat embedding property), butA does not have the complex S neat embedding property up to m for any m \u2265 n + 3. Proof The proof is divided into four parts:\n1. Blowing up and blurring a finite rainbow algebra forming a weakly representable atom structure At. Take the finite rainbow CAn ,An+1,n where the reds R is the complete irreflexive graph n, and the greens are {gi : 1 \u2264 i < n\u22121}\u222a{gi0 : 1 \u2264 i \u2264 n+1}.Wewill showAn+1,n detects that RCAn is not atom-canonical with respect to SNrnCAn+3. Denote the finite atom structure of An+1,n by At f ; so At f = At(An+1,n). One then replaces the red colours of the finite rainbow algebra of An+1,n each by infinitely many reds (getting their superscripts from \u03c9), obtaining this way a weakly representable atom structure At. The cylindric reduct of the resulting atom structure after \u2018splitting the reds\u2019, namely,At, is like the weakly (but not strongly) representable atom structure of the atomic, countable and simple algebra A as defined in [9, Definition 4.1]; the sole difference is that we have n+ 1 greens and not \u03c9 many as is the case in [9]. One then defines a larger class of coloured graphs like in [9, Definition 2.5]. Let 2 < n < \u03c9. Then the colours used are like above except that each red is \u2018split\u2019 into \u03c9 many \u2018copies\u2019 of the form rli j with i < j < n and l \u2208 \u03c9, with an additional shade of red \u03c1 such that the consistency conditions for the new reds (in addition to the usual rainbow consistency conditions) are as follows:\n\u2022 (r ijk, r ij \u2032k\u2032 , r i \u2217 j\u2217k\u2217) unless i = i \u2032 = i\u2217 and |{( j, k), ( j \u2032, k\u2032), ( j\u2217, k\u2217)}| = 3;\n\u2022 (r, \u03c1, \u03c1) and (r, r\u2217, \u03c1), where r, r\u2217 are any reds. The consistency conditions can be coded in an L\u03c9,\u03c9 theory T having signature the reds with \u03c1 together with all other colours like in [7, Definition 3.6.9]. The theory T is only a first-order theory (not an L\u03c91,\u03c9 theory) because the number of greens is finite which is not the case with [7] where the number of available greens are countably infinite coded by an infinite disjunction. One can construct an n-homogeneous modelM that is a countable limit of finite\nmodels of T using a game played between \u2203 and \u2200 like in [9, Theorem 2.16]. In the rainbow game \u2200 challenges \u2203 with cones having green tints (gi0), and \u2203 wins if she can respond to such moves. This is the only way that \u2200 can force a win. \u2203 has to respond by labelling apexes of two succesive cones having the same base played by \u2200. By the rules of the game, she has to use a red label. She resorts to \u03c1 whenever she is forced a red while using the rainbow reds will lead to an inconsistent triangle of reds; [9, Proposition 2.6, Lemma 2.7]. The number of greens make [9, Lemma 3.10] work with the same proof using only finitely many green and not infinitely many. The winning strategy implemented by \u2203 using the red label \u03c1 that comes to her rescue whenever she runs out of \u2018rainbow reds\u2019, so she can always and consistently respond with an extended coloured graph.\nWe denote the resulting term CAn , TmAt by Bb(An+1,n, r, \u03c9), a shorthand for blowing up and blurring An+1,n by splitting each red graph (atom) into \u03c9 many. It can be shown exactly like in [9] that \u2203 can win the rainbow \u03c9-rounded game and build an n-homogeneous modelM by using a shade of red \u03c1 outside the rainbow signature, when she is forced a red; [9, Proposition 2.6, Lemma 2.7]. The n-homogeneity entails that any subgraph (substructure) of M of size at most n is independent of its location in M; it is uniquely determined by its isomorphism type.\nIn the present context, after the splitting \u2018the finitelymany red colours\u2019 replacing each such red colour rkl , k < l < n by\u03c9many rikl , i \u2208 \u03c9, the rainbow signature for the resulting rainbow theory as defined in [6, Definition 3.6.9] call this theory Tra , consists of gi : 1 \u2264 i < n\u2212 1, gi0 : 1 \u2264 i \u2264 n + 1, wi : i < n \u2212 1, rtkl : k < l < n, t \u2208 \u03c9, binary relations, and (n \u2212 1)-ary relations yS , S \u2286\u03c9 n + k \u2212 2 or S = n + 1. The set algebraBb(An+1,n, r, \u03c9) of dimension n has base an n-homogeneous modelM of another theory T whose signature expands that of Tra by an additional binary relation (a shade of red) \u03c1. In this new signature T is obtained from Tra by some axioms (consistency conditions) extending Tra . Such axioms (consistency conditions) specify consistent triples involving \u03c1. We call the models of T extended coloured graphs. In particular, M is an extended coloured graph.\nTo build M, the class of coloured graphs is considered in the signature L \u222a {\u03c1} like in usual rainbow constructions as given above with the two additional forbidden triples (r, \u03c1, \u03c1) and (r, r\u2217, \u03c1), where r, r\u2217 are any reds. Let GG be the class of all models of this extended rainbow first-order theory. The extra shade of red \u03c1 will be used as a label. This modelM is constructed as a countable limit of finite models of T using a game played between \u2203 and \u2200. Here, unlike the extended L\u03c91,\u03c9 theory dealt with in [9], T is a first-order one because the number of greens used is finite.\nIn the rainbow game [5, 6] \u2200 challenges \u2203 with cones having green tints (gi0), and \u2203 wins if she can respond to such moves. This is the only way that \u2200 can force a win. \u2203 has to respond by labelling apexes of two successive cones having the same base played by \u2200. By the rules of the game, she has to use a red label. She resorts to \u03c1 whenever she is forced a red while using the rainbow reds will lead to an inconsitent triangle of reds; [9, Proposition 2.6, Lemma 2.7]. The winning strategy is implemented by \u2203 using the red label \u03c1 that comes to her rescue whenever she runs out of \u2018rainbow reds\u2019, so she can always and consistently respond with an extended coloured graph.\n2. Representing a term algebra (and its completion) as (generalized) set algebras. Having M at hand, one constructs two atomic n-dimensional set algebras based on M sharing the same atom structure and having the same top element. The atoms of each will be the set of coloured graphs, see [9]; such coloured graphs are \u2018literally indivisible\u2019. Now Ln and Ln\u221e,\u03c9 are taken in the rainbow signature (without \u03c1). Continuing like in op. cit., deleting the one available red shade, setW = {a\u0304 \u2208 nM : M | (\u2227i< j<n \u00ac\u03c1(xi , x j ))(a\u0304)},\nand for \u03c6 \u2208 Ln\u221e,\u03c9, let \u03c6W = {s \u2208 W : M | W \u03c6[s]}. Here W is the set of all n-ary assignments in nM, that have no edge labelled by \u03c1 and | W is first-order semantics with quantifiers relativized to W , cf. [9, \u00a73.2 and Definition 4.1]. We note that \u03c1 is used by \u2203 infinitely many times during the game forming a \u2018red clique\u2019 in M [9].\nLetA be the relativized set algebrawith domain {\u03d5W : \u03d5 a first-order Ln-formula} and unit W endowed with the usual concrete cylindric operations read off the connectives. Classical semantics for Ln rainbow formulas and their semantics by relativizing to W coincide [9, Proposition 3.13] but not with respect to Ln\u221e,\u03c9 rainbow formulas. Hence the set algebra A is isomorphic to a cylindric set algebra of dimension n having top element nM, so A is simple, in fact, its Df reduct is simple.\nLet E = {\u03c6W : \u03c6 \u2208 Ln\u221e,\u03c9} [9, Definition 4.1] with the operations defined like onA in the usual way. CmAt is a complete CAn and so, like in [9, Lemma 5.3], we have an isomorphism from CmAt to E defined by X \u2192 \u22c3 X . Since AtA = AtTm(AtA), which we refer to only by At, and TmAtA \u2286 A, TmAtA = TmAt is representable. The atoms of A, TmAtA and CmAtA = CmAt are the coloured graphs whose edges are not labelled by \u03c1. These atoms are uniquely determined by the interpretion in M of so-called MCA formulas in the rainbow signature of At as in [9, Definition 4.3].\n3. Embedding An+1,n into Cm(At). Let CRG f be the class of coloured graphs on At f and CRG be the class of coloured graphs onAt. We can (and will) assume that CRG f \u2286 CRG. Write Ma for the atom that is the (equivalence class of the) surjection a : n \u2192 M , M \u2208 CGR. Here we identify a with [a]; no harm will ensue. We define the (equivalence) relation \u223c on At by Mb \u223c Na , (M, N \u2208 CGR) : \u2022 a(i) = a( j) \u21d0\u21d2 b(i) = b( j), \u2022 Ma(a(i), a( j)) = rl \u21d0\u21d2 Nb(b(i), b( j)) = rk, for some l, k \u2208 \u03c9, \u2022 Ma(a(i), a( j)) = Nb(b(i), b( j)), if they are not red, \u2022 Ma(a(k0), . . . , a(kn\u22122)) = Nb(b(k0), . . . , b(kn\u22122)), whenever defined.\nWe say that Ma is a copy of Nb if Ma \u223c Nb (by symmetry, Nb is a copy of Ma .) Indeed, the relation \u2018copy of\u2019 is an equivalence relation on At. An atom Ma is called a red atom, if Ma has at least one red edge. Any red atom has \u03c9 many copies, that are cylindrically equivalent, in the sense that if Na \u223c Mb with one (equivalently both) red, with a : n \u2192 N and b : n \u2192 M , then we can assume that nodes(N ) = nodes(M) and that for all i < n, a n \u223c {i} = b n \u223c {i}. In CmAt, we write Ma for {Ma} and we denote suprema taken in CmAt, possibly finite, by \u2211 . Define the map from An+1,n = CmAt f to CmAt, by specifing first its values on At f , via Ma \u2192 \u2211 j M ( j)a where M ( j)a is a copy of Ma . So each atom maps to the suprema of its copies.\nThis map is well defined because CmAt is complete. We check that is an injective homomorphim. Injectivity is easy. We check the preservation of all the CAn extra Boolean operations.\n\u2022 Diagonal elements. If l < k < n, then Mx \u2264 (dCmAt flk ) \u21d0\u21d2 Mx \u2264 \u2211\nj\n\u22c3\nal=ak M ( j)a\n\u21d0\u21d2 Mx \u2264 \u22c3\nal=ak\n\u2211\nj\nM ( j)a\n\u21d0\u21d2 Mx = M ( j)a for some a : n \u2192 Msuch that a(l) = a(k) \u21d0\u21d2 Mx \u2208 dCmAtlk .\n\u2022 Cylindrifiers. Let i < n. By the additivity of cylindrifiers, we restrict our attention to atoms Ma \u2208 At f with a : n \u2192 M , and M \u2208 CRG f \u2286 CRG. Then\n(c CmAt f i Ma) = f (\n\u22c3\n[c]\u2261i [a] Mc) =\n\u22c3\n[c]\u2261i [a] (Mc)\n= \u22c3\n[c]\u2261i [a]\n\u2211\nj\nM ( j)c = \u2211\nj\n\u22c3\n[c]\u2261i [a] M ( j)c =\n\u2211\nj\ncCmAti M ( j) a\n= cCmAti ( \u2211\nj\nM ( j)a ) = cCmAti (Ma).\n4. \u2200 has awinning strategy in Gn+3At(An+1,n); and the required result. It is straightforward to show that \u2200 has a winning strategy first in the Ehrenfeucht\u2013Fra\u00efss\u00e9 forth private game played between \u2203 and \u2200 on the complete irreflexive graphs n(n \u2212 1)/2 + 2) and n in n(n \u2212 1)/2 + 2 rounds EFn(n\u22121)2+2n(n\u22121)+2 (n + 1, n) [7, Definition 16.2] since n(n \u2212 1)/2 + 2 is \u2018longer\u2019 than n. Using (any) p > n many pairs of pebbles available on the board \u2200 can win this game in n + 1 many rounds. For brevity let D = An+1,n . Now \u2200 lifts his winning strategy from the last private Ehrenfeucht\u2013Fra\u00efss\u00e9 forth game to the graph game on At f = At(D) [5, p. 841] forcing a win using n + 3 nodes, i.e., in the graph game \u2200 needs two exra nodes by the rainbow theorem [6]. By Lemma 2.4,D /\u2208 ScNrnCAn+3 when 2 < n < \u03c9. Since D is finite, D /\u2208 SNrnCAn+3, because D coincides with its canonical extension and for any D \u2208 CAn , D \u2208 SNrnCAm implies D+ \u2208 ScNrnCAm . But D embeds into CmAtA, hence CmAtA is outside the variety SNrnCAn+3 as well.\nThe following definition, to be used in the sequel, is taken from [2]:\nDefinition 3.3 [2, Definition 3.1] LetR be a relation algebra with non-identity atoms I and 2 < n < \u03c9. Assume that J \u2286 \u2118(I ) and E \u2286 3\u03c9. We say that (J , E) is a strong n-blur for R if (J , E) is an n-blur of R in the sense of [2, Definition 3.1], that is to say, J is a complex n-blur and E is an index blur such that the complex n-blur satisfies\n(\u2200V1, . . . Vn,W2, . . .Wn \u2208 J )(\u2200T \u2208 J )(\u22002 \u2264 i \u2264 n)safe(Vi ,Wi , T ). The following definition will be used frequently. We will first encounter it in the second\nitem of Theorem 4.4. We use the notation in [2].\nDefinition 3.4 [2, Definition 3.1] Let R be a relation algebra with non-identity atoms I . Assume J \u2286 \u2118(I ) and E \u2286 3\u03c9. 1. We say that (J , E) is an n-blur for R if J is a complex n-blur defined as follows:\n(1) each element of J is non-empty, (2) \u22c3 J = I , (3) (\u2200P \u2208 I )(\u2200W \u2208 J )(I \u2286 P;W ), (4) (\u2200V1, . . . Vn,W2, . . .Wn \u2208 J )(\u2203T \u2208 J )(\u22002 \u2264 i \u2264 n)safe(Vi ,Wi , T ), that is, there\nis for v \u2208 Vi , w \u2208 Wi and t \u2208 T , we have v;w \u2264 t , (5) (\u2200P2, . . . Pn, Q2, . . . Qn \u2208 I )(\u2200W \u2208 J )W \u2229 P2; Qn \u2229 . . . Pn; Qn = \u2205, and the tenary relation E is an index blur defined as in item (ii) of [2, Definition 3.1].\n2. We say that (J , E) is a strong n-blur, if it (J , E) is an n-blur such that the complex n-blur satisfies (4)s :\n(\u2200V1, . . . Vn,W2, . . .Wn \u2208 J )(\u2200T \u2208 J )(\u22002 \u2264 i \u2264 n)safe(Vi ,Wi , T ).\nTheorem 3.5 For any 2 < n < l < \u03c9, there is an atomic algebra B \u2208 NrnCAl \u2229 RCAn such that B is not strongly representable up to l and \u03c9. In particular, CmAtB /\u2208 RCAn, B is not completely representable, a fortioriB is not strongly representable.\nProof Let 2 < n < m \u2264 \u03c9. First we prove the conditionally the non-atom canonicity of SNrnCAm depending on the existence of certain finite relation algebrasRwith strongm blursatisfying a condition that we highlight as we go along. We use the flexible blow up and blur construction used in [2]. The idea is to useR in place of the finite Maddux algebras denoted by Ek(2, 3) on [2, p. 83]. Here k(< \u03c9) is the number of non-identity atoms and then take it from there to reach the conditions, we move backwards if you like. The required algebra witnessing non-atom canonicity will be obtained by blowing up and blurring R in place of the relation algebra Ek(2, 3) [2].\nOur exposition addresses an (abstract) finite relation algebraR having an l-blur in the sense of definition [2, Definition 3.1], with 3 \u2264 l \u2264 k < \u03c9 and k depending on l. Occasionally we use the concrete Maddux algebra Ek(2, 3) to make certain concepts more tangible. We use the notation in [2]. Let 2 < n \u2264 l < \u03c9. One starts with a finite relation algebra R that has only representations, if any, on finite sets (bases), having an l-blur (J , E) as in [2, Definition 3.1] recalled in Definition 3.4. After blowing up and bluringR, by splitting each of its atoms into infinitely many, one gets an infinite atomic representable relation algebra Bb(R, J , E) [2, p. 73], whose atom structure At is weakly but not strongly representable. The atom structure At is not strongly representable, becauseR is not blurred in CmAt. The finite relation algebraR embeds into CmAt, so that a representation of CmAt, necessarily on an infinite base, induces one ofR on the same base, which is impossible. The representability of Bb(R, J , E) depend on the properties of the l-blur, which blurs R in Bb(R, J , E). The set of blurs here, namely J , is finite. In the case of Ek(2, 3) used in [2], the set of blurs is the set of all subsets of non-identity atoms having the same size l < \u03c9, where k = f (l) \u2265 l for some recursive function f from \u03c9 \u2192 \u03c9, so that k depends recursively on l.\nOne (but not the only) way to define the index blur E \u2286 3\u03c9 is as follows [14, Theorem 3.1.1]: E(i, j, k) if (\u2203p, q, r)({p, q, r} = {i, j, k} and r \u2212 q = q \u2212 p. This is a concrete instance of an index blur as defined in [2, Definition 3.1(iii)] (recalled inDefinition 3.4 above), but defined uniformly, it does not depend on the blurs. The underlying set of At, the atom structure of Bb(R, J , E) is the following set consisting of triplets: At = {(i, P,W ) : i \u2208 \u03c9, P \u2208 AtR \u223c {Id},W \u2208 J } \u222a {Id}. When R = Ek(2, 3) (some finite k > 0), composition is defined by singling out the following (together with their Peircian transforms), as the consistent triples: (a, b, c) is consistent if and only if one of a, b, c is Id and the other two are equal, or if a = (i, P, S), b = ( j, Q, Z), c = (k, R,W ),\nS \u2229 Z \u2229W = \u2205 \u21d2 E(i, j, k)&|{P, Q, R}| = 1. (We are avoiding mononchromatic triangles). That is, if EW = {(i, P,W ) : i \u2208 \u03c9, P \u2208 W } for W \u2208 J , then\n(i, P, S); ( j, Q, Z) = \u22c3 {EW : S \u2229 Z \u2229W = \u2205}\n\u22c3 {(k, R,W ) : E(i, j, k), |{P, Q, R}| = 1}.\nMore generally, for the R as postulated in the hypothesis, composition in At is defined as follows. First the index blur E can be taken to be like above. Now the triple ((i, P, S), ( j, Q, Z), (k, R,W )) in which no two entries are equal, is consistent if either S, Z ,W are safe, briefly safe(S, Z ,W ), witness item (4) in Definition 3.4 (which vacuously holds if S \u2229 Z \u2229 W = \u2205), or E(i, j, k) and P; Q \u2264 R in R. This generalizes the above\ndefinition of composition, because in Ek(2, 3), the triple of non-identity atoms (P, Q, R) is consistent \u21d0\u21d2 they do not have the same colour \u21d0\u21d2 |{P, Q, R}| = 1. Having specified its atom structure, its timely to specfiy the relation algebra Bb(R, J , E) \u2286 CmAt. The relation algebra Bb(R, J , E) is TmAt (the term algebra). Its universe is the set {X \u2286 H \u222a {Id} : X \u2229 EW \u2208 Cof(EW ), for all W \u2208 J }, where Cof(EW ) denotes the set of co-finite subsets of EW , that is subsets of EW whose complement is infinite, with EW\nas defined above. The relation algebra operations are lifted from At in the usual way. The algebra Bb(R, J , E) is proved to be representable in [2].\nFor brevity, denote Bb(R, J , E) byR, and its domain by R. For a \u2208 At, and W \u2208 J , set Ua = {X \u2208 R : a \u2208 X} and UW = {X \u2208 R : |X \u2229 EW | \u2265 \u03c9}. Then the principal ultrafilters of R are exactly Ua , a \u2208 H and UW are non-principal ultrafilters for W \u2208 J when EW is infinite. Let J \u2032 = {W \u2208 J : |EW | \u2265 \u03c9}, and let Uf = {Ua : a \u2208 F} \u222a {UW : W \u2208 J \u2032}. Uf is the set of ultrafilters ofR which is used as colours to representR, cf. [2, pp. 75\u201377]. The representation is built from coloured graphs whose edges are labelled by elements in Uf in a fairly standard step-by-step construction. The step-by-step construction builds in the way coloured graphs, which are basically networks whose edges are labelled by ultrafilters, with non-principal ultrafilters allowed. So such coloured graphs are networks that are not atomic because not only principal ultrafilters are allowed as labels. Furthermore, we cannot restrict our attension to only atomic networks because we do not want Bb(R, J , E) to be strongly representable, least completely representable. The \u2018limit\u2019 of a sequence of atomic networks constructed in a step-by-step manner, or obtained via winning strategy for \u2203 in an \u03c9-rounded atomic game, will necessarily produce a complete representation of Bb(R, J , E). But the required representation will be extracted from a complete representation of the canonical extension of Bb(R, J , E). Nothing wrong with that. A relation algebra R is representable if and only if its canonical extension is representable. A complete representation of the canonical extension ofR induces a representation ofR, becauseR embeds into its a canonical extension, but the converse is not necessarily true. So here we are proving more than the mere representablity of Bb(R, J , E), because we are constructing a complete representation of its canonical extension, namely, the algebra CmUf , where Uf is the atom structure having domain Uf, with Uf as defined above.\nNow we show why the Dedekind\u2013MacNeille completion CmAt is not representable. For P \u2208 I , let HP = {(i, P,W ) : i \u2208 \u03c9,W \u2208 J , P \u2208 W }. Let P1 = {HP : P \u2208 I } and P2 = {EW : W \u2208 J }. These are two partitions of At . The partition P2 was used to represent, Bb(R, J , E) in the sense that the ternary relation corresponding to composition was defined on At in a such a way that the singletons generate the partition (EW : W \u2208 J ) up to \u201cfinite deviations.\" The partition P1 will now be used to show that Cm(Bb(R, J , E)) = Cm(At) is not representable. This follows by observing that composition restricted to P1 satisfies HP ; HQ = \u22c3{HZ : Z; P \u2264 Q in R}, which means that R embeds into the complex algebra CmAt prohibiting its representability, becauseR allows only representations having a finite base.\nThe construction lifts to higher dimensions expressed in CAns, 2 < n < \u03c9. Because (J , E) is an l-blur, then by [2, Theorem 3.2 9(iii)], Atca = Matl(AtBb(R, J , E)), the set of l by l basic matrices on At is an l-dimensional cylindric basis, giving an algebra Bl = Bbl(R, J , E) \u2208 RCAl . Again Atca is not strongly representable, for had it been, then a representation of CmAtca induces a representation of R on an infinite base, because RaCmAtca \u2287 CmAt \u2287 R, and the representability of CmAtca induces one of RaCmAtca , necessarily having an infinite base. For 2 < n \u2264 l < \u03c9, denote by Cl the non-representable Dedekind\u2013MacNeille completion of the algebra Bbl(R, J , E) \u2208 RCAl , that is Cl = CmAt(Bbl(R, J , E)) = CmMatl(At). If the l-blur happens to be strong, in\nthe sense of Definition 3.4 and n \u2264 m \u2264 l, then we get by [2, item (3) p. 80], that Bbm(R, J , E) \u223c= NrmBbl(R, J , E). This is proved by defining an embedding h : RdmCl \u2192 Cm via x \u2192 {M m : M \u2208 x} and showing that h NrmCl is an isomorphism onto Cm [2, p.80]. Surjectiveness uses the condition (J5)l formulated in the second item of definition 3.4 of strong l-blurness. Without this condition, that is if the l-blur (J , E) is not strong, then still Cm and Cl can be defined because by definition (J , E) is a t-blur for all m \u2264 t \u2264 l, so Matt(At) is a cylindric basis and for t < l Ct embeds into NrmCl using the same map as above, but this embedding might not be surjective. So, for every l, now replacing R by the Maddux algebra E f (l)(2, 3), the algebra Al = NrnBbl(E f (l)(2, 3)), J , E), with f (l) depending recursively on l, having strong l-blur due to the properties of the Maddux algebra E f (l)(2, 3), is as required. In other words, and more concisely, we haveAl \u2208 RCAn\u2229NrnCAl , but CmAtAl /\u2208 RCAn .\nThe flexibility of the construction in op. cit. allows one to refine the main result in [2] by varying the relation algebra R. All we need for the construction to work is that R is finite having a (strong) l-blur with n \u2264 l < \u03c9. So one can get sharper results if one requires for example that R has no infinite k-dimensional hyperbasis with n \u2264 l < k \u2264 \u03c9, k possibly finite, equivalently, R does not have a k-flat infinite representation. The equivalence here is due to the fact that R is finite. It cannot be the case that l \u2265 k (k \u2208 \u03c9), for else A = Bbn(R, J , E) \u223c= NrnBbl(R, J , E), and Bbl(R, J , E) is atomic (and finite-dimensional), so by Lemma 4.2, A will have a complete l, hence a complete k-flat representation, which is impossible because R does not have an infinite k-flat representation. Such requirements lead to negative results on atom-canonicity completely analogous to the result proved in the previous two subitems (a) and (b) of the present item, and possibly more of this kind.\nTheorem 3.6 There is an algebra E \u2208 RCAn that has the complex I neat embedding property up to m for any m \u2265 n but does not have the I neat embedding property up to n+1, a fortiori the atomic algebra E has the complex neat embedding property up to m \u2265 n + 1, but does not have the I neat embedding property for any m \u2265 n + 1. Let \u03b1 be any ordinal and let F be field of characteristic 0. Let V = {s \u2208 \u03b1F : |{i \u2208 \u03b1 : si = 0}| < \u03c9}. Note that V is a vector space over the field F. Let\nC = \u3008\u2118(V ),\u222a,\u2229, ,\u2205, V , ci ,di j \u3009i, j\u2208\u03b1. Let y denote the following \u03b1-ary relation:\ny = { s \u2208 V : s0 + 1 = \u2211\ni>0\nsi\n}\nand\nw = \u23a7 \u23a8\n\u23a9 s \u2208 V : s1 + 1 =\n\u2211 i =1 si\n\u23ab \u23ac\n\u23ad .\nFor each s \u2208 y we let ys be the singleton containing s, i.e., ys = {s}. Let E = SgC({y, ys : s \u2208 y}), A = SgC({y, w, ys : s \u2208 y}).\nClearly E and A are in RCA\u03b1 . We first show that w /\u2208 E , then we show that if E \u2208 NrnCA\u03b1+1 then w \u2208 E concluding that E /\u2208 Nr\u03b1CA\u03b1+1. Let\nPl = {{s \u2208 \u03b1F(0) : t + \u2211\n(ri si ) = 0} : {t, ri : i < \u03b1} \u2286 F}, Pl< = {p \u2208 Pl : ci p = p, for some i < \u03b1}.\nNote that for p \u2208 Pl, p = {s \u2208 \u03b1F(0) : t +\u2211i ri si = 0} say, then ci p = p (i.e., p is parallel to the i-th axis) iff ri = 0. Note too, that\n{y, w,di j : i, j \u2208 \u03b1} \u2286 Pl, y, w /\u2208 Pl<, 1 \u2208 Pl<,\nand\n{di j : i = j, i, j \u2208 \u03b1} \u2286 Pl< iff \u03b1 \u2265 3. Now let\nG = {y,\u2212y, p,\u2212p, c( ){0},\u2212c( ){0} : p \u2208 Pl< \u222a {d01} \u2286\u03c9 \u03b1, 0 \u2208 }, G\u2217 = { \u22c2\ni\u2208n gi : n \u2208 \u03c9, gi \u2208 G},\nand\nG\u2217\u2217 = { \u22c3\ni\u2208n gi : n \u2208 \u03c9, gi \u2208 G\u2217}.\nIt is easy to see that {y, ys : s \u2208 y} \u2286 G\u2217\u2217, and G\u2217\u2217 is a Boolean field of sets. We prove that w /\u2208 G\u2217\u2217 and that G\u2217\u2217 is closed under cylindrifications. To this end, we set\nL = {p \u2208 Pl< : c0 p = p} and P(0) = L \u222a {d01}. Next we define\nG1 = {g \u2208 G\u2217 : g \u2286 y} and\nG2 = {g \u2208 G\u2217 : g y and g \u2286 p for some p \u2208 P(0)}. We have G1 \u2229 G2 = \u2205. Now let\nG3 = {p1 \u2229 p2 \u2229 \u00b7 \u00b7 \u00b7 \u2229 pk : k \u2208 \u03c9, {p1, p2, . . . , pk} \u2286 G ({y} \u222a P(0))}. It is easy to see that G\u2217 = G1 \u222a G2 \u222a G3. To prove w /\u2208 G\u2217\u2217 we need the following fact: If g \u2208 G3 and 0 = g, then g \u2282 w. We prove this as follows. Assume g = p1 \u2229 p2 \u2229 \u00b7 \u00b7 \u00b7 \u2229 pk say with pi \u2208 G and pi /\u2208 ({y} \u222a P(0)) for 1 \u2264 i \u2264 k, and let z \u2208 g. Let [] be the function from Pl into F defined as follows:\n[p] = {1/r0(\u2212t \u2212 \u2211 ri zi )} if p = \u2212{s \u2208\u03b1 F(0) : t + \u2211\nri si = 0}, r0 = 0 and else\n[p] = 0. Let\nr \u2208 F (( \u22c3\n1\u2264i\u2264k [pi ]) \u222a [\u2212w])\nbe arbitrary, and let\nz0r = z {(0, z0)} \u222a {(0, r)}. Then\nz0r \u2208 g w, i.e., g w. (Here we are using that when c( ){0} \u2208 G, then 0 \u2208 .) We now proceed to show that w /\u2208 G\u2217\u2217. Assume\nx = \u22c3 {g1i : i < n1} \u222a \u22c3 {g2i : i < n2} \u222a \u22c3 {g3i : i < n3}\nwhere\n{g ji : i < n j } \u2286 G j and g ji \u2286 w for all j \u2208 {1, 2, 3}. We show that x = w. By the above, we have x \u2286 \u22c3i<n pi for some {pi : i < n} \u2286 P(0). Note that if \u03b1 > 2 then P(0) = L and P(0) = L \u222a{d01} otherwise. If \u03b1 = 2 thenw \u2286 \u2212d01 otherwise P(0) = L . Now it is enough to show that w is not contained in \u22c3 E for any finite E \u2286 L . But it can be seen by implementing easy linear-algebraic arguments that, for every n \u2208 \u03c9, and for every system\nt0 + \u2211\n(r0i xi ) = 0 ... tn + \u2211\n(rni xi ) = 0, of equations, such that for all j \u2264 n, there exists i < \u03b1, such that\nr ji = 0 and r j0 = 0, the equation\n\u2211\ni<\u03b1\nxi = 2x1 + 1\nhas a solution s in the weak space \u03b1F(0) such that s is not a solution of\nt j + \u2211\ni<\u03b1\n(r ji xi ) = 0\nfor every j \u2264 n. We have proved that w /\u2208 G\u2217\u2217. To show w /\u2208 A, we will show that G\u2217\u2217 is closed under the cylindric operations (i.e., it is the universe of a CA\u03b1. It is enough to show (since the ci \u2019s are additive), that for j \u2208 \u03b1 and g \u2208 G\u2217 arbitrary, we have c j g \u2208 G\u2217\u2217. For this purpose, put for every p \u2208 Pl\np( j |0) = c j {s \u2208 p : s j = 0} and (\u2212p)( j |0) = \u2212p( j |0). Then it is not hard to see that\np( j |0) = {s \u2208 \u03b1F(0) : t + \u2211\ni = j (ri si ) = 0},\nif\np = {s \u2208 \u03b1F0) : t + \u2211\ni<\u03b1\n(ri si ) = 0},\nand so\np( j |0) \u2208 Pl< for every p \u2208 Pl. Let j and g be as indicated above. We can assume\ng = e \u2229 p1 \u2229 \u00b7 \u00b7 \u00b7 \u2229 pn \u2229 \u2212P1 \u2229 \u00b7 \u00b7 \u00b7 \u2229 \u2212Pm \u2229 z \u2229 \u2229 \u2212 c( 1){0} \u2229 \u00b7 \u00b7 \u00b7 \u2229 \u2212c( N ){0},\nwhere\ne \u2208 {y,\u2212y, 1}, n,m, N \u2208 \u03c9 {0}, pi , Pi \u2208 Pl< \u222a {d01}, c j pi = pi , c j Pi = Pi , z \u2208 {c( ){0}, 1 : \u2208 \u2118\u03c9\u03b1, 0 \u2208 , j /\u2208 },\nand\n{ 1, . . . , n} \u2286 {x \u2208 \u2118\u03c9\u03b1 : j /\u2208 x, 0 \u2208 x}. We distinguish between 2 cases:\nCase 1.\nz = c( ){0} and j /\u2208 . Then\nc j (e \u2229 p1 . . . \u2229 pn \u2229 \u2212P1 . . . \u2229 \u2212Pm \u2229c( ){0} \u2229 \u2212c( 1){0} . . . \u2229 \u2212c( N ){0}) p1( j |0) \u2229 . . . pn( j |0) \u2229 \u2212P1( j |0) . . . \u2229 \u2212Pm( j |0) \u2229c jc( ){0} \u2229 \u2212c jc( 1){0} \u2229 \u2229 \u2212 c jc( N ){0}.\nCase 2.\nz = 1. Then\nc j (e.p1 \u2229 . . . \u2229 pn \u2229 \u2212P1 . . . \u2229 \u2212Pm \u2229 \u2212 c( 1){0} . . . \u2229 \u2212c( N ){0}) = f (e) \u2229k\u2264n ((\u2229i\u2264nc j (pk \u2229 pi ) \u2229 \u2229i\u2264mc j (pk \u2212 Pi ) \u2229i\u2264N c j (pk \u2212 c( i ){0})).\nwhere\nf (y) = ((\u2229i\u2264nc j (y \u2229 pi ) \u2229 \u2229i\u2264mc j (y \u2212 Pi ) \u2229i\u2264N c j (y \u2212 c( i ){0})), f (\u2212y) = \u2229k\u2264nc j (pk \u2212 y), f (1) = 1.\nNow for every p, q \u2208 Pl, there are p\u2032, q \u2032, p\u2032\u2032 and q \u2032\u2032 \u2208 Pl< such that c j (p \u2229 q) = p\u2032 \u2229 q \u2032, c j (p q) = p\u2032\u2032 q \u2032\u2032,\nand if j \u2208 p , then c j (p \\ c( ){0}) = \u03b1F(0) p( j |0) \u222a (p( j |0) c jc( ){0}).\nWe have proved that w /\u2208 E. Now we restrict \u03b1 > 1 to be finite and according to the widespread custom of naming ordinals, we call it n. Let B be the full set algebra with unit V = nQ. It is straightforwrad to show that AtB = AtE = {{s} : s \u2208 V }, that is to say, the atoms of both algebras coincide with the singletons. Clearly CmAtE = B, so that infcat B is the Dedekind\u2013MacNeille completion of E. Since B is a full set algebra having top element nQ and universe \u2118(nQ), A \u2208 NrnCA\u03c9. So E is an algebra that has the complex I neat embedding propery up to \u03c9, but E does not have the neat embeding property up to n+1, since E /\u2208 NrnCAn+1.\nLet 2 < n \u2264 l \u2264 m \u2264 \u03c9. Denote the class of CAns having the complexO neat embedding property up to m by CNPCAOn,m , and let RCA O n,m := CNPCAOn,m \u2229 RCAn . Denote the class of strongly representable CAns up to l and m by RCAl,mn . Call an algebra A \u2208 CAn strongly representable if A is atomic and AtA is strongly representable; that is CmAtA \u2208 RCAn . Observe that RCAn,mn = RCASn,m and that if m = \u03c9, then both classes coincide with the class of strongly representable CAns. For a class K of BAOs, K \u2229 Count denotes the class of countable algebras in K and (recall that) K \u2229 At denotes the class of atomic algebras in K. Theorem 3.7 Let 2 < n \u2264 l < m \u2264 \u03c9 and O \u2208 {S,Sc,Sd, I}. Then the following hold: 1. RCAOn,m \u2286 RCAOn,l and RCAIn,l \u2286 RCASdn,l \u2286 RCAScn,l \u2286 RCASn,l . The last inclusion is proper\nfor l \u2265 n + 3. 2. For O \u2208 {S,Sc,Sd}, CNPCAOn,l \u2286 ONrnCAl (that is the complex O neat embedding\nproperty is stronger than the O neat embedding property), and for O = S, the inclusion is proper for l \u2265 n + 3. But for O = I, CNPCAIn,l NrnCAl (so the complex I neat embedding property does not imply the I neat embedding property). 3. If A is finite, then A \u2208 CNPCAOn,l \u21d0\u21d2 A \u2208 ONrnCAl and A \u2208 RCAOn,l \u21d0\u21d2 A \u2208 RCAn \u2229 ONrnCAl . Furthermore, for any positive k, CNPCAOn,n+k+1 CNPCAOn,n+k, and finally CNPCAOn,\u03c9 RCAn . 4. (\u2203A \u2208 RCAn \u2229 At \u223c CNPCASn,l) \u21d2 SNrnCAk is not atom-canonical for all k \u2265 l. In particular, SNrnCAk is not atom-canonical for all k \u2265 n + 3. 5. If SNrnCAl is atom-canonical, then RCASn,l is first-order definable. There exists a finite k > n + 1, such that RCASn,k is not first-order definable. 6. Let 2 < n < l \u2264 \u03c9. Then RCAl,\u03c9n \u2229 Count = \u2205 \u21d0\u21d2 l < \u03c9. Proof 1. The inclusions in the first item holds by definiton. To show the strictness of the last\ninclusion, use (1) of Lemma 5.4. 2. Let O \u2208 {S, Sc,Sd}. If CmAtA \u2208 ONrnCAl , then A \u2286d CmAtA, so A \u2208 SdONrnCAl \u2286\nONrnCAl . This proves the first part. The strictness of the last inclusion follows from Theorem 3.2, since the atomic countable algebra A constructed in op. cit. is in RCAn , but CmAtA /\u2208 SNrnCAl for any l \u2265 n + 3. For the last non\u2013inclusion in item (2), we use the set algebras A and E in Theorem 3.6. 3. This follows by definition observing that if A is finite then A = CmAtA. The strictness of the first inclusion follows from the construction in [8] where it is shown that, for any positive k, there is a finite algebra A in NrnCAn+k \u223c SNrnCAn+k+1. The inclusion CNPCAOn,\u03c9 \u2286 RCAn holds because if B \u2208 CNPCAOn,\u03c9, then B \u2286 CmAtB \u2208 ONrnCA\u03c9 \u2286 RCAn . The A used in the last item of Theorem 3.2 witnesses the strictness of the last inclusion proving the last statement in this item.\n4. It follows from the definition and the construction used in Theorem 3.2. 5. It follows from the fact that SNrnCAl is canonical. So if it is atom-canonical too, then\nAt(SNrnCAl) = {F : CmF \u2208 SNrnCAl}, the former class is elementary [6, Theorem 2.84], and the last class is elementray \u21d0\u21d2 RCASn,l is elementary. Non-elementarity follows from [7, Corollary 3.7.2] where it is proved that RCASn,\u03c9 is not elementary, together with the fact that \u22c2 n<k<\u03c9 SNrnCAk = RCAn . In more detail, letAi be the sequence of strongly representable CAns with CmAtAi = Ai and A = i/UAi is not strongly representable. Hence CmAtA /\u2208 SNrnCA\u03c9 = \u22c2i\u2208\u03c9 SNrnCAn+i , so CmAtA /\u2208 SNrnKl for all l > k, for some k \u2208 \u03c9, k > n. But for each such l, Ai \u2208 SNrnCAl(\u2287 RCAn), so Ai is a sequence of algebras such that CmAtAi = Ai \u2208 SNrnCAl , but Cm(At( i/UAi )) = CmAtA /\u2208 SNrnCAl , for all l \u2265 k. That k has to be strictly greater than n + 1 follows because SNrnCAn+1 is atom-canonical. 6. \u21d0 : Let l < \u03c9. Then the required statement follows from the second part of Theorem 3.2 proving (l, \u03c9); namely, there exists a countableA \u2208 NrnCAl \u2229RCAn such that CmAtA /\u2208 RCAn . Nowwe prove \u21d2 : Suppose to the contrary that there is anA \u2208 RCA\u03c9,\u03c9n \u2229Count. Then, by definition,A \u2208 NrnCA\u03c9 soA \u2208 CRCAn . But this complete representation induces a(n ordinary) representation of CmAtA which is a contradiction."
        },
        {
            "heading": "4 Clique-guarded semantics",
            "text": "Fix 2 < n < \u03c9. The reader is referred to [6, Definitions 13.4, 13.6] for the notions of m-flat and m-square representations for relation algebras (m > 2) to be generalized next to CAns.\nDefinition 4.1 [16, \u00a75, p.14] Assume that 2 < n < m < \u03c9. LetM be the base of a relativized representation ofA \u2208 CAn witnessed by an injective homomorphism f : A\u2192 \u2118(V ), where V \u2286 nM and \u22c3s\u2208V rng(s) = M. We write M | a(s) for s \u2208 f (a). Let L(A)m be the first-order signature using m variables and one n-ary relation symbol for each element in A. Let L(A)m\u221e,\u03c9 be the infinitary extension of L(A)m allowing infinite conjunctions. Then an n-clique is a set C \u2286 M such that (a1, . . . , an\u22121) \u2208 V = 1M for distinct a1, . . . , an \u2208 C . Let Cm(M) = {s \u2208 mM : rng(s) is ann-clique}. Cm(M) is called the n-Gaifman hypergraph ofM, with the n-hyperedge relation 1M. The clique guarded semantics | c are defined inductively. We give only existential quantifiers (cylindrifiers): for s\u0304 \u2208 mM, i < m,M, s\u0304 | c \u2203xi\u03c6 if there is a t\u0304 \u2208 Cm(M), t\u0304 \u2261i s\u0304 such that M, t\u0304 | \u03c6.\nWe say that M is an m-square representation of A if for all s\u0304 \u2208 Cm(M), a \u2208 A, i < n, and injective map l : n \u2192 m, whenever M | ci a(sl(0), . . . , sl(n\u22121)), there is a t\u0304 \u2208 Cm(M) with t\u0304 \u2261i s\u0304, and M | a(tl(0), . . . , tl(n\u22121)); M is an (infinitary) m-flat representation if it is m-square and for all s\u0304 \u2208 Cm(M), for all distinct i, j < m, M | c [\u2203xi\u2203x j\u03c6 \u2194 \u2203x j\u2203xi\u03c6](s\u0304), where \u03c6 \u2208 (L(A)m\u221e,\u03c9)L(A)m . Complete representability for m-squareness and m-flatness is defined like in the classical case.\nThe main ideas used in the next theorem can be found in [6, Definitions 12.1, 12.9, 12.10, 12.25, Propositions 12.25, 12.27] adapted to the CA case. In all cases, the m-dimensional dilation stipulated in the statement of the Theorem, will have top element Cm(M), where M is the m-relativized representation of the given algebra, and the operations of the dilation are induced by the n-clique-guarded semantics.\nTheorem 4.2 [6, Theorems 13.45, 13.36]. Assume that 2 < n < m < \u03c9 and let A \u2208 CAn. Then A \u2208 SNrnCAm if and only if A has an infinitary m-flat representation if and only if A\nhas an m-flat representation. Furthermore, if A is atomic, then A has a complete infinitary m-flat representation if and only if A \u2208 ScNrn(CAm \u2229 At).\nProof We give a sketch. We start from representations to dilations. Let M be an m-flat representation of A. For \u03c6 \u2208 L(A)m , let \u03c6M = {a\u0304 \u2208 Cm(M) : M | c \u03c6(a\u0304)}, where Cm(M) is the n-Gaifman hypergraph. Let D be the algebra with universe {\u03c6M : \u03c6 \u2208 L(A)m} and with cylindric operations induced by the n-clique-guarded (flat) semantics. For r \u2208 A, and x\u0304 \u2208 Cm(M), we identify r with the formula it defines in L(A)m , and we write r(x\u0304)M if M, x\u0304 | c r .\nThen D is a set algebra with domain \u2118(Cm(M)) and with unit 1D = Cm(M). Since M is m-flat, then cylindrifiers in D commute, and so D \u2208 CAm . Now define \u03b8 : A \u2192 D via r \u2192 r(x\u0304)M. Then exactly like in the proof of [6, Theorem 13.20], \u03b8 is an injective neat embedding, that is, \u03b8(A) \u2286 NrnD. The relativized model M itself might not be infinitary m-flat, but one can build an infinitarym-flat representation ofA, whose base is an\u03c9-saturated model of the consistent first-order theory, stipulating the existence of anm-flat representation, cf. [6, Proposition 13.17, Theorem 13.46 (6) and (7)]. The inverse implication from dilations to representations is harder. One constructs from the given m-dilation an m-dimensional hyperbasis (that can be defined similarly to the RA case, cf. [6, Definition 12.11]) from which the required m-relativized representation is built. This can be done in a step-by-step manner treating the hyperbasis as a \u2018saturated set of mosaics\u2019, cf. [6, Proposition 13.37].\nFor results on complete m-flat representations, one works in Lm\u221e,\u03c9 instead of first-order logic.WithD formed like above from (the completem-flat representation)M, usingL(A)m\u221e,\u03c9 instead of Ln , let \u03c6M be a non-zero element in D. Choose a\u0304 \u2208 \u03c6M, and let \u03c4 = \u2227{\u03c8 \u2208 L(A)m\u221e,\u03c9 : M | c \u03c8(a\u0304)}. Then \u03c4 \u2208 L(A)m\u221e,\u03c9, and \u03c4M is an atom below \u03c6M. The rest is entirely analogous, cf. [6, p. 411].\n4.1 Omitting typesOTTr for the clique guarded fragments\nFix 2 < n \u2264 l < m \u2264 \u03c9. Consider the following statement (l,m): There exists a countable, complete and atomic Ln theory T (meaning that the Tarski\u2013Lindenbuam qoutient algebra FmT is atomic), such that the type consisting of co-atoms of FmT is realizable in every m-square model of T (m-representation of FmT ) but cannot be be isolated using l variables.\nLet OTTr (l,m) be by definition \u00ac (l,m), short for a restricted version of the Omitting Types Theorem holds at the parameters l and m, where by definition, we stipulate that OTTr (\u03c9, \u03c9) is just the consequence of the Omitting Types Theorem for L\u03c9,\u03c9, that says that a countable atomic theory T has a countbale atomic (prime) model. This atomic (unique up to isomorphism) model of T is the model resulting by omitting the countably many nonprincipal types (Xi : i \u2208 \u03c9), where Xi is the set of co-atoms of NriFmT . These are indeed non-principal because by definition ]NriFmT is an atomic Boolean algebra, since T is an atomic theory. Furthermore, if T is complete, then NriFmT is also a simple CAi for each i < \u03c9; i.e., NriFmT has no proper ideals (congruences).\nFor 2 < n \u2264 l < m \u2264 \u03c9 and l = m = \u03c9, we investigate the plausability of the following statement which we abbreviate by (**):\nOTTr (l,m) \u21d0\u21d2 l = m = \u03c9. In other words: OTTr holds only in the limiting case when l \u2192 \u221e and m = \u03c9 and not \u2018before\u2019. This will be proved on the \u2018paths\u2019 (l, \u03c9), n \u2264 l < \u03c9 (x axis) and (n, n + k),\nk \u2265 n+3 (y axis) using two different blow up and blur constructions, given in Theorems 3.2 and 3.5 .\nLet n < \u03c9. Then Dn(Gn) is a class of (non-commutative) set algebras having the same signature as CAn . IfA \u2208 Dn(Gn), then the top element ofA is a set V \u2286 nU (some non-empty set U ), such that if s \u2208 V , and i < j < n (\u03c4 : n \u2192 n), then s \u25e6 [i | j](s \u25e6 \u03c4) \u2208 V . It is known that both Dn and Gn are finitely axiomatizable varieties [16], such that Gsn \u2286 Gn \u2286 Dn . It can be proved similarly to Theorem 4.2, that if A satisfies all the CAn axioms with the possible exception of commutativity of cylindrifiers, then for any 2 < n < m < \u03c9, A \u2208 SNrnDm \u21d0\u21d2 A \u2208 SNrnGm \u21d0\u21d2 A has an m-square representation.\nIn the next theorem several conditions are given implying (l,m) f for various values of the parameters l and m, where (l,m) f is the formula obtained from (l,m) by replacing square by flat. In the first item of the next theorem by no infinite \u03c9-dimensional hyperbasis (basis), we understand no representation on an infinite base. By an \u03c9-flat (square) representation we mean an ordinary representation, and by a complete \u03c9-flat (square) representation we mean a complete representation.1\nWe need a lemma before embarking on the proof of the theorem.\nLemma 4.3 LetR be a relation algebra and 3 < n < \u03c9. ThenR+ has an n-dimensional infinite relational (hyper)basis if and only ifR has an infinite n-square (flat) representation.R+ has an n-dimensional infinite hyperbasis if and only ifR has an infinite n-flat representation.\nProof [6, Theorem 13.46, the equivalence (1) \u21d0\u21d2 (5) for relational basis, and the equivalence (7) \u21d0\u21d2 (11) for hyperbasis]. Theorem 4.4 Let 2 < n \u2264 l < m \u2264 \u03c9. Then every item below implies the next one. 1. There exists a finite relation algebraR with a strong l-blur and no infinite m-dimensional\nhyperbasis. 2. There is a countable atomicA \u2208 NrnCAl \u2229RCAn such that CmAtA does not have an m-flat\nrepresentation. 3. There is a countable atomic A \u2208 NrnCAl \u2229 RCAn such that CmAtA /\u2208 SNrnCAm. 4. There is a countable atomic A \u2208 NrnCAl \u2229 RCAn such that A has no complete infinitary\nm-flat representation. 5. (l \u2032,m\u2032) f is true for any l \u2032 \u2264 l and m\u2032 \u2265 m. The same implications hold upon replacing infinite m-dimensional hyperbasis by mdimensional relational basis (not necessarily infinite), m-flat by m-square and SNrnCAm by SNrnDm. Furthermore, in the new chain of implications every item implies the corresponding item in Theorem 4.4. In particular, (l,m) implies (l,m) f .\nProof (1) \u21d2 (2): We proceed similarly to Theorem 3.5. Let R be as in the hypothesis with strong l-blur (J , E). The idea is to \u2018blow up and blur\u2019 R in place of the Maddux algebra Ek(2, 3) blown up and blurred in [2, Lemma 5.1], where k < \u03c9 is the number of non-identity atoms and k depends recursively on l, giving the desired strong l-blurness, cf. [2, Lemmata 4.2, 4.3]. Let 2 < n \u2264 l < \u03c9. The relation algebra R is blown up by 1 Here we deviate from [6] in the treatment of \u03ba-square representations for an infinite cardinal \u03ba by identifying a complete \u03c9-square representation with a complete representation for an atomic algebra A \u2208 CAn . This is true in case A has countably many atoms, but may not be true in general according to [6, Definition 17.22]. If \u03c9 \u2264 \u03ba < \u03bb, an algebra having a complete \u03bb-square representation may not have a complete \u03ba-square one. The rainbow algebra of dimension n, for any 2 < n < \u03c9, A = A\u03bb,\u03ba witnesses this. Any complete \u03ba-square representation ofAwill force a \u2018\u03ba red clique\u2019 indexed by the \u03bb greens which is impossible because the indices of reds must match within the red clique.\nsplitting all of the atoms each to infinitely many giving a new infinite atom structure At denoted in [2, p. 73] by At . One proves that the blown up and blurred atomic relation algebraBb(R, J , E) (as defined in [2]) with atom structure At is representable; in fact this representation is induced by a complete representation of its canonical extension, cf. [2, Item (1) of Theorem 3.2]. Because (J , E) is a strong l-blur, then, by its definition, it is a strong j-blur for all n \u2264 j \u2264 l, so the atom structure At has a j-dimensional cylindric basis for all n \u2264 j \u2264 l, namely, Mat j (At). For all such j , there is an RCA j denoted in [2, Top of p. 9] by Bb j (R, J , E) such that TmMat j (At) \u2286 Bb j (R, J , E) \u2286 CmMat j (At) and AtBb j (R, J , E) is a weakly representable atom structure of dimension j , cf. [2, Lemma 4.3]. Now take A = Bbn(R, J , E). We claim that A is as required. Since R has a strong j-blur (J , E) for all n \u2264 j \u2264 l, then A \u223c= NrnBb j (R, J , E) for all n \u2264 j \u2264 l as proved in [2, item (3) p. 80]. In particular, taking j = l, A \u2208 RCAn \u2229 NrnCAl . We show that CmAtA does not have an m-flat representation. Assume for contradicton that CmAtA does have an m-flat representation M. Then M is infinite of course. Since R embeds into Bb(R, J , E) which in turn embeds intoRaCmAtA,R has anm-flat representation with baseM. But since R is finite, R = R+, so by Lemma 4.3, R has an infinite m-dimensional hyperbasis, a contradiction.\n(2) \u21d2 (3): By item (1) of Theorem 4.2. (3) \u21d2 (4): A complete m-flat representation of (any) B \u2208 CAn induces an m-flat representation of CmAtB which implies by Theorem 4.2 that CmAtB \u2208 SNrnCAm . To see why, assume thatB has anm-flat complete representation via f : B\u2192 D, whereD = \u2118(V ) and the base of the representationM = \u22c3s\u2208V rng(s) ism-flat. LetC = CmAtB. For c \u2208 C , let c \u2193= {a \u2208 AtC : a \u2264 c} = {a \u2208 AtB : a \u2264 c}; the last equality holds because AtB = AtC. Define, representing C, g : C\u2192 D by g(c) = \u2211x\u2208c\u2193 f (x); then g is a homomorphism into \u2118(V ) having base M.\n(4) \u21d2 (5): By [4, \u00a74.3], we can (and will) assume that A = FmT for a countable, simple and atomic theory Ln theory T . Let be the n-type consisting of co-atoms of T . Then is realizable in every m-flat model, for if M is an m-flat model omitting , then M would be the base of a complete infinitary m-flat representation of A, and so A \u2208 ScNrnCAm which is impossible. ButA \u2208 NrnCAl , so using the same (terminology and) argument as in [2, Theorem 3.1] we get that any witness isolating needs more than l-variables. In more detail, suppose to the contrary that \u03c6 is an l witness, so that T | \u03c6 \u2192 \u03b1, for all \u03b1 \u2208 , where recall that is the set of coatoms. Then sinceA is simple, we can assume without loss of generality that A is a set algebra with base M , say. Let M = (M, Ri )i\u2208\u03c9 be the corresponding model (in a relational signature) to this set algebra in the sense of [4, \u00a74.3]. Let \u03c6M denote the set of all assignments satisfying \u03c6 inM. We haveM | T and \u03c6M \u2208 A, because A \u2208 NrnCAm\u22121. But T | \u2203x\u03c6, hence \u03c6M = 0, from which it follows that \u03c6M must intersect an atom \u03b1 \u2208 A (recall that the latter is atomic). Let \u03c8 be the formula, such that \u03c8M = \u03b1. Then it cannot be the case that T | \u03c6 \u2192 \u00ac\u03c8 , hence \u03c6 is not a witness, a contradiction and we are done. We have proved (l,m). The rest follows from the definitions.\nFor squareness the proofs are essentially the same undergoing the obvious modifications (e.g., using the part on squareness in Lemma 4.3 and repacing CAn by Dn). In the first implication \u2018infinite\u2019 in the hypothesis is not needed because any finite relation algebra having an infinite m-dimensional relational basis has a finite one, cf. [6, Theorem 19.18] which is not the case with hyperbasis, cf. [6, Prop. 19.19]. Corollary 4.5 For 2 < n < \u03c9 and n \u2264 l < \u03c9, (n, n + 3) and (l, \u03c9) hold. Proof The first case follows from Theorems 3.2 and 4.4 (by taking l = n and m = n + 3). For the second case, it suffices by Theorem 4.4 (by taking m = \u03c9) to find a countable\nalgebra C \u2208 NrnCAl \u2229 RCAn such that CmAtC /\u2208 RCAn . This algebra is constructed in [2], cf. Theorem 3.5.\nIt is time that we tie a few threads together.\nDefinition 4.6 Let 2 < n < \u03c9. We say that VT fails for Ln almost everywhere if there exist positive l,m \u2265 n such that V(k, \u03c9) and V(n, t) are false for all finite k \u2265 l and all t \u2265 m. We say that VT fails for Ln everywhere if for 3 \u2264 l < m \u2264 \u03c9 and l = m = \u03c9, V(l,m) holds if and only if l = m = \u03c9, that is to say, (\u2217\u2217) above holds. From Corollary 4.5 and the implication (1) \u21d2 (6) in Theorem 4.4 (by taking l = m\u2212 1), we get\nTheorem 4.7 Let 2 < n < \u03c9. Then OTTr fails for Ln almost everywhere. Furthermore, if for each n < m < \u03c9, there exists a finite relation algebraRm having m \u2212 1 strong blur and no m-dimensional relational basis, then VT fails for Ln everywhere.\nNow we formulate an algebraic result implying that VT fails for any finite first-order definable expansion of Ln as defined in [3]. We deviate from the notation in [3] by writing RCA+n for a first-order definable expansion of RCAn .\nTheorem 4.8 Let 2 < n < \u03c9. Let RCA+n be a first-order definable expansion of RCAn such that the non-cylindric operations are first-order definable by formulas using only finitely many variables l > n. If RCA+n is completely additive, then it is not atom-canonical.\nProof Let n be the finite number of variables occuring in the first-order formulas defining the newconnectives and let l = n+1.LetAbe countable and atomic such thatA \u2208 RCAn\u2229NrnCAl andA has no complete representation; such anA exists, cf. Theorem 3.5.Without loss, we can assume thatwe have only one extra operation f definable by a first-order formula\u03c6, say, using n < k < \u03c9 variables with at most n free variables. Now \u03c6 defines a CAk term \u03c4(\u03c6) which, in turn, defines the unary operation f on A, via f (a) = \u03c4(\u03c6)B(a). This is well defined in the sense that f (a) \u2208 A, because A \u2208 NrnCAn+1 and the first-order formula \u03c6 defining f has at most n free variables. Call the expanded structure A\u2217(\u2208 RCA+n ). By complete additivity, CmAtA\u2217 is the Dedekind\u2013MacNeille completion of A\u2217. But RdcaCmAtA\u2217 = CmAtA /\u2208 RCAn , a fortiori, Cm(AtA\u2217) /\u2208 RCA+n , and we are done.\nLet 2 < n \u2264 l < m \u2264 \u03c9. In VT(l,m), while the parameter l measures how close we are to L\u03c9,\u03c9, m measures the \u2018degree\u2019 of squareness of permitted models. One can view liml\u2192\u221eVT(l, \u03c9) = VT(\u03c9, \u03c9) algebraically using ultraproducts as follows. Fix 2 < n < \u03c9. For each 2 < n \u2264 l < \u03c9, let Rl be the finite Maddux algebra E f (l)(2, 3) with strong l-blur (Jl , El) and f (l) \u2265 l as specified in [2, Lemma 5.1] (denoted by k therein). Let Rl = Bb(Rl , Jl , El) \u2208 RRA and letAl = NrnBbl(Rl , Jl , El) \u2208 RCAn . Then (AtRl : l \u2208 \u03c9 \u223c n), and (AtAl : l \u2208 \u03c9 \u223c n) are sequences of weakly representable atom structures that are not strongly representable with a completely representable ultraproduct. We immediately get\nCorollary 4.9 Assume 2 < n < \u03c9. Then the following hold:\n1. The (elementary) class LCAn of algebras satisfying the Lyndon conditions (which is ElCRCAn) is not finitely axiomatizable.\n2. [3, 10] The set of equations using only one variable that holds in each of the varieties RCAn and RRA, together with any finite first-order definable expansion of each, cannot be derived from any finite set of equations valid in the variety."
        },
        {
            "heading": "5 Non-elementary classes of algebras having a neat embedding property",
            "text": "We define an atomic k rounded (atomic) gameHk stronger than the usual k-rounded (atomic) game Gk [6, 7]. To define the game we need a few definitions:\nDefinition 5.1 A \u03bb-neat hypernetwork is roughly a network endowed with labelled hyperdeges of length different from n allowed to get arbitrarily long but with finite length, and such hyperedges get their labels from a non-empty set of labels , such that all so-called short hyperedges are constantly labelled by \u03bb \u2208 . The board of the game consists of \u03bb-neat hypernetworks:\nDefinition 5.2 For an n-dimensional atomic network N on an atomic CAn and for x, y \u2208 nodes(N ), set x \u223c y if there exists z\u0304 such that N (x, y, z\u0304) \u2264 d01. Define the equivalence relation \u223c over the set of all finite sequences over nodes(N ) by x\u0304 \u223c y\u0304 if |x\u0304 | = |y\u0304| and xi \u223c yi for all i < |x\u0304 |. (It can be easily checked that this is indeed an equivalence relation).\nA hypernetwork N = (Na, Nh) over an atomicCAn consists of an n-dimensional network Na together with a labelling function for hyperlabels Nh : <\u03c9nodes(N ) \u2192 (some arbitrary set of hyperlabels ) such that for x\u0304, y\u0304 \u2208 <\u03c9nodes(N ) if x\u0304 \u223c y\u0304 \u21d2 Nh(x\u0304) = Nh(y\u0304). If |x\u0304 | = k \u2208 N and Nh(x\u0304) = \u03bb, then we say that \u03bb is a k-ary hyperlabel. x\u0304 is referred to as a k-ary hyperedge, or simply a hyperedge.\nWemay remove the superscripts a and h if no confusion is likely to ensue.A hyperedge x\u0304 \u2208 <\u03c9nodes(N ) is short if there are y0, . . . , yn\u22121 that are nodes in N such that N (xi , y0, z\u0304) \u2264 d01 or . . . or N (xi , yn\u22121, z\u0304) \u2264 d01 for all i < |x | for some (equivalently for all) z\u0304.Otherwise, it is called long.\nThis game involves, besides the standard cylindrifiermove, two new amalgamationmoves. This game has k roundswith k \u2264 \u03c9, call itHk . Concerning hismoves, \u2200 can play a cylindrifier move like before but now played on \u03bb- neat hypernetworks (\u03bb a constant label). Also \u2200 can play a transformation move by picking a previously played \u03bb neat hypernetwork N and a partial, finite surjection \u03b8 : \u03c9 \u2192 nodes(N ); this move is denoted (N , \u03b8). \u2203\u2019s response is mandatory. She must respond with N\u03b8 . Finally, \u2200 can play an amalgamation move by picking previously played \u03bb neat hypernetworks M, N such that M nodes(M)\u2229nodes(N ) = N nodes(M)\u2229nodes(N ), and nodes(M) \u2229 nodes(N ) = \u2205. This move is denoted (M, N ). To make a legal response, \u2203 must play a \u03bb-neat hypernetwork L extending M and N , where nodes(L) = nodes(M) \u222a nodes(N ).\nGetting these preliminaries out of the way, we are now ready to start digging deeper.\nLemma 5.3 Let \u03b1 be a countable atom structure. If \u2203 has a winning strategy in H\u03c9(\u03b1), then any algebraF having atom structure\u03b1 is completely representable and there exists a complete D \u2208 RCA\u03c9 such that Cm\u03b1 \u223c= NrnD Proof Fix some a \u2208 \u03b1. The game H\u03c9 is designed so that using \u2203\u2019s winning strategy in the game H\u03c9(\u03b1) one can define a nested sequence M0 \u2286 M1 \u2286 \u00b7 \u00b7 \u00b7 of \u03bb-neat hypernetworks, where M0 is \u2203\u2019s response to the initial \u2200-move a, such that If Mr is in the sequence and Mr (x\u0304) \u2264 ci a for an atom a and some i < n, then there is s \u2265 r and d \u2208 nodes(Ms) such that Ms(y\u0304) = a, y\u0304i = d and y\u0304 \u2261i x\u0304 . In addition, if Mr is in the sequence and \u03b8 is any partial isomorphism of Mr , then there is s \u2265 r and a partial isomorphism \u03b8+ of Ms extending \u03b8 such that rng(\u03b8+) \u2287 nodes(Mr ) (This can be done using \u2203\u2019s responses to amalgamation moves). Now letMa be the limit of this sequence, that is,Ma = \u22c3 Mi , the labelling of (n\u2212 1) tuples of nodes by atoms, and hyperedges by hyperlabels done in the obvious way using the fact\nthat the Mi s are nested. Let L be the signature with one n-ary relation for each b \u2208 \u03b1, and one k-ary predicate symbol for each k-ary hyperlabel \u03bb. Now we work in L\u221e,\u03c9. For fixed fa \u2208 \u03c9nodes(Ma), let Ua = { f \u2208 \u03c9nodes(Ma) : {i < \u03c9 : g(i) = fa(i)} is finite}. We make Ua into the base of an L relativized structure Ma . We allow a clause for infinitary disjunctions. In more detail, for b \u2208 \u03b1, l0, . . . , ln\u22121, i0 . . . , ik\u22121 < \u03c9, k-ary hyperlabels \u03bb, and all L-formulas \u03c6, \u03c6i , \u03c8 , and f \u2208 Ua :\nMa, f | b(xl0 . . . , xln\u22121) \u21d0\u21d2 Ma( f (l0), . . . , f (ln\u22121)) = b, Ma, f | \u03bb(xi0 , . . . , xik\u22121) \u21d0\u21d2 Ma( f (i0), . . . , f (ik\u22121)) = \u03bb,\nMa, f | \u00ac\u03c6 \u21d0\u21d2 Ma, f | \u03c6, Ma, f | ( \u2228\ni\u2208I \u03c6i ) \u21d0\u21d2 (\u2203i \u2208 I )(Ma, f | \u03c6i ),\nMa, f | \u2203xi\u03c6 \u21d0\u21d2 Ma, f [i/m] | \u03c6, some m \u2208 nodes(Ma). We are now working with (weak) set algebras whose semantics is induced by L\u221e,\u03c9 formulas in the signature L , instead of first-order ones. For any such L-formula \u03c6, write \u03c6Ma for { f \u2208 Ua : Ma, f | \u03c6}. Let Da = {\u03c6Ma : \u03c6 is an L-formula} and Da be the weak set algebra with universe Da . Let D = Pa\u2208\u03b1Da . Then D is a generalized complete weak set algebra [4, Definition 3.1.2 (iv)]. By complete we mean that (the usual) infinite suprema exist. This is true because we chose to work with L\u221e,\u03c9 while forming the dilations Da (a \u2208 \u03b1). Each Da is complete, hence so is their product D. Let X \u2286 NrnD. Then, by the completeness of D, we get that d = \u2211D X exists. Assume that i /\u2208 n. Then ci d = ci \u2211 X = \u2211x\u2208X ci x = \u2211 X = d, because the ci s are completely additive and ci x = x, for all i /\u2208 n, since x \u2208 NrnD. We conclude that d \u2208 NrnD, hence d is an upper bound of X in NrnD. Since d = \u2211Dx\u2208X X , there can be no b \u2208 NrnD (\u2286 D) with b < d such that b is an upper bound of X for else it will be an upper bound of X in D. Thus,\n\u2211NrnD x\u2208X X = d . We\nhave shown thatNrnD is complete. Making the legitimate identificationNrnD \u2286d Cm\u03b1 by density, we get that NrnD = Cm\u03b1 (since NrnD is complete), hence Cm\u03b1 \u2208 NrnCA\u03c9. This does not mean that Tm\u03b1 \u2208 NrnCA\u03c9, witness Theorem 4.4 below. To show that an atomic algebra with atom structure \u03b1 is completely representable, we use that given two atomic algebras A,B \u2208 CAn such that AtA \u223c= AtB. Then A \u2208 CRCAn if and only if B \u2208 CRCAn . NowCm\u03b1 \u2208 SdNrnCA\u03c9(\u2286 ScNrnCA\u03c9) and \u03b1 is countable, so by [13, Theorem 5.3.6]Cm\u03b1 is completely representable, hence so is any algebra sharing the atom structure \u03b1. Alternatively to prove the last part, one can use thatH\u03c9 is plainly stronger than the usual\u03c9-rounded atomic game G (in the sense that a winning strategy for \u2203 in H\u03c9 implies a winning strategy for \u2203 in G), and then one uses [7, Theorem 3.3.3] whose more difficult implication says that a winning strategy for G(\u03b2) (hence in H(\u03b2)), \u03b2 a countable atom structure, implies that \u03b2 is completely representable. (The converse, when \u03b2 is uncountable, may not be true [17, Theorem 4.5]). Lemma 5.4 Any class K between SdNrnCA\u03c9 \u2229 CRCAn and ScNrnCAn+3 is not elementary Proof (1) \u2200 has a winning strategy in Gn+3(AtC) for a rainbow-like algebra C.\nTake a rainbow-like CAn , call it C, based on the ordered structure Z and N. The reds R is the set {ri j : i < j < \u03c9(= N)} and the green colours used constitute the set {gi : 1 \u2264 i < n \u2212 1} \u222a {gi0 : i \u2208 Z}. In complete coloured graphs the forbidden triples are like the usual rainbow constructions based on Z and N, but now the triple (gi0,g j 0, rkl) is also forbidden if {(i, k), ( j, l)} is not an order-preserving partial function from Z \u2192 N. It can be shown that \u2200 has a winning strategy in the graph version of the game Gn+3(AtC) played on\ncoloured graphs [5]. The rough idea here is that, as is the case with winning strategy\u2019s of \u2200 in rainbow constructions, \u2200 bombards \u2203 with cones having distinct green tints demanding a red label from \u2203 to appexes of succesive cones. The number of nodes are limited but \u2200 has the option to reuse them, so this process will not end after finitely many rounds. The added order-preserving condition relating two greens and a red forces \u2203 to choose red labels one of whose indices form a decreasing sequence in N. In \u03c9 many rounds \u2200 forces a win, so C /\u2208 ScNrnCAn+3. More rigorously, \u2200 plays as follows: In the initial round \u2200 plays a graph M with nodes 0, 1, . . . , n\u2212 1 such that M(i, j) = w0 for i < j < n\u2212 1 and M(i, n\u2212 1) = gi (i = 1, . . . , n\u2212 2), M(0, n\u2212 1) = g00 and M(0, 1, . . . , n\u2212 2) = yZ. This is a 0 cone. In the following move \u2200 chooses the base of the cone (0, . . . , n \u2212 2) and demands a node n with M2(i, n) = gi (i = 1, . . . , n \u2212 2), and M2(0, n) = g\u221210 . \u2203 must choose a label for the edge (n+1, n) ofM2. It must be a red atom rmk ,m, k \u2208 N. Since\u22121 < 0, by the \u2018order-preserving\u2019 condition we have m < k. In the next move \u2200 plays the face (0, . . . , n \u2212 2) and demands a node n + 1, with M3(i, n) = gi (i = 1, . . . , n \u2212 2), such that M3(0, n + 2) = g\u221220 . Then M3(n+1, n) andM3(n+1, n\u22121) both being red, the indicesmust match.M3(n+1, n) = rlk and M3(n+ 1, r \u2212 1) = rkm with l < m \u2208 N. In the next round \u2200 plays (0, 1, . . . n\u2212 2) and reuses the node 2 such that M4(0, 2) = g\u221230 . This time we have M4(n, n\u2212 1) = r jl for some j < l < m \u2208 N. Continuing in this manner leads to a decreasing sequence in N. We have proved the required statement. Since CmAtC = C and C /\u2208 ScNrnCAn+3, we are done.\n(2) \u2203 has a winning strategy in Hk(AtC) for all k < \u03c9. In [16] it is shown that for k < \u03c9, \u2203 has a winning strategy in Gk(AtCZ,N) in spite of\nthe newly forbidden triple consisting of two greens and one red, synchronized by an orderpreserving function. This plainly makes her choices more restricted. But we can go further. It can be shown with some more effort (but not much more) that, in fact, \u2203 has a winning strategy in even the stronger game Hk(AtCZ,N) for all k < \u03c9.\n(2a) Response of \u2203 in labelling \u03bb-neat hypredges. We describe \u2203\u2019s strategy in dealing with labelling hyperedges in \u03bb-neat hypernetworks, where \u03bb is a constant label kept on short hyperedges. In a play, \u2203 is required to play \u03bb-neat hypernetworks, so she has no choice about the short edges, these are labelled by \u03bb. In response to a cylindrifier move by \u2200 extending the current hypernetworkproviding a newnode k, and a previously played colouredhypernetwork M all long hyperedges not incident with k necessarily keep the hyperlabel they had in M . All long hyperedges incident with k in M are given unique hyperlabels not occurring as the hyperlabel of any other hyperedge in M . In response to an amalgamation move, which involves two hypernetworks required to be amalgamated, say (M, N ) all long hyperedges whose range is contained in nodes(M) have hyperlabel determined by M , and those whose range is contained in nodes(N ) have hyperlabels determined by N . If x\u0304 is a long hyperedge of \u2203\u2019s response, L where rng(x\u0304) nodes(M), nodes(N ), then x\u0304 is given a new hyperlabel not used in any previously played hypernetwork and not used within L as the label of any hyperedge other than x\u0304 . This completes her strategy for labelling hyperedges.\n(2b) Response of \u2203 to cylindrification moves. We show that \u2203 has a winning strategy in Gk(AtCZ,N) where 0 < k < \u03c9 is the number of rounds, the part proved in [16]. Let 0 < k < \u03c9. We proceed inductively. Let M0, M1, . . . , Mr , r < k be the coloured graphs at the start of a play of Gk just before round r + 1. Assume inductively that \u2203 computes a partial function \u03c1s : Z \u2192 N, for s \u2264 r : (i) \u03c10 \u2286 \u00b7 \u00b7 \u00b7 \u2286 \u03c1t \u2286 \u00b7 \u00b7 \u00b7 \u2286 \u03c1s is (strict) order-preserving; if i < j \u2208 dom\u03c1s then\n\u03c1s(i)\u2212\u03c1s( j) \u2265 3k\u2212r , where k\u2212r is the number of rounds remaining in the game, and\ndom(\u03c1s) = {i \u2208 Z : \u2203t \u2264 s, Mt contains an i-cone as a subgraph},\n(ii) for u, v, x0 \u2208 nodes(Ms), if Ms(u, v) = r\u03bc,k ,\u03bc, k \u2208 N, Ms(x0, u) = gi0, Ms(x0, v) = g j0, where i, j \u2208 Z are tints of two cones, with base F such that x0 is the first element in F under the induced linear order, then \u03c1s(i) = \u03bc and \u03c1s( j) = k.\nFor the base of the induction \u2203 takes M0 = \u03c10 = \u2205. Assume that Mr , r < k (k is the number of rounds) is the current coloured graph and that \u2203 has constructed \u03c1r : Z \u2192 N to be a finite order-preserving partial map such that conditions (i) and (ii) hold. We show that (i) and (ii) can be maintained in a further round. We check the most difficult case. Assume that \u03b2 \u2208 nodes(Mr ), \u03b4 /\u2208 nodes(Mr ) is chosen by \u2200 in his cylindrifier move, such that \u03b2 and \u03b4 are apexes of two cones having the same base and green tints p = q \u2208 Z. Now \u2203 adds q to dom(\u03c1r ) forming \u03c1r+1 by defining the value \u03c1r+1(p) \u2208 N in such a way as to preserve the (natural) order on dom(\u03c1r ) \u222a {q}, that is maintaining property (i). Inductively, \u03c1r is order-preserving and \u2018widely spaced\u2019 meaning that the gap between its elements is at least 3k\u2212r , so this can be maintained in a further round. Now \u2203 has to define a (complete) coloured graph Mr+1 such that nodes(Mr+1) = nodes(Mr ) \u222a {\u03b4}. In particular, she has to find a suitable red label for the edge (\u03b2, \u03b4). Having \u03c1r+1 at hand she proceeds as follows. Now that p, q \u2208 dom(\u03c1r+1), she lets \u03bc = \u03c1r+1(p), b = \u03c1r+1(q). The red label she chooses for the edge (\u03b2, \u03b4) is (*) Mr+1(\u03b2, \u03b4) = r\u03bc,b. In this way she maintains property (ii) for \u03c1r+1. Next we show that this is a winning strategy for \u2203.\nWe check the consistency of the newly created triangles proving that Mr+1 is a coloured graph completing the induction. Since \u03c1r+1 is chosen to preserve order, no new forbidden triple (involving two greens and one red) will be created. Now we check red triangles only of the form (\u03b2, y, \u03b4) in Mr+1 (y \u2208 nodes(Mr )). We can assume that y is the apex of a cone with base F in Mr and green tint t , say, and that \u03b2 is the apex of the p-cone having the same base. Then inductively by condition (ii), taking x0 to be the first element of F , and taking the nodes \u03b2, y, and the tints p, t , for u, v, i, j , respectively, we have by observing that \u03b2, y \u2208 nodes(Mr ), \u03b2, y \u2208 dom(\u03c1r ) and \u03c1r \u2286 \u03c1r+1, the following: Mr+1(\u03b2, y) = Mr (\u03b2, y) = r\u03c1r (p),\u03c1r (t) = r\u03c1r+1(p),\u03c1r+1(t). By her strategy, we have Mr+1(y, \u03b4) = r\u03c1r+1(t),\u03c1r+1(q) and we know by (*) that Mr+1(\u03b2, \u03b4) = r\u03c1r+1(p),\u03c1r+1(q). The triple (r\u03c1r+1(p),\u03c1r+1(t), r\u03c1r+1(t),\u03c1r+1(q), r\u03c1r+1(p),\u03c1r+1(q)) of reds is consistent and we are done with this case. All other edge labelling and colouring n\u2212 1 tuples in Mr+1 by yellow shades are exactly like in [5]. But we can go further. We show that \u2203 has a winning strategy in the stronger game Hk(AtC) for all k \u2208 \u03c9. \u2203\u2019s strategy dealing with \u03bb-neat hypernetworks, where \u03bb is a constant label kept on short hyperedges.\n(2c) Response of \u2203 to amalgamation moves. Now we change the board of play but only formally. We play on \u03bb-neat hypergraphs. Given a rainbow algebra A, there is a one-to-one correspondence between coloured graphs on AtA and networks on AtA [7, half of p. 76]; denote this correspondence expressed by a bijection from coloured graphs to networks by (*):\n\u2192 N , nodes( ) = nodes(N ). Now the game H can be reformulated to be played on \u03bb-neat hypergraphs on a rainbow algebra A; these are of the form ( , Nh), where is a coloured graph on AtA, \u03bb is a hyperlabel, and Nh is as before, Nh :<\u03c9 nodes( ) \u2192 , such that for x\u0304, y\u0304 \u2208 <\u03c9nodes( ), if x\u0304 \u223c y\u0304 \u21d2 Nh(x\u0304) = Nh(y\u0304).Here x\u0304 \u223c y\u0304, making the obvious translation, is the equivalence relation defined by x \u223c y if |x | = |y| and N (xi , yi , z\u0304) \u2264 d01 for all i < |x | and some z\u0304 \u2208 n\u22122nodes( ).\nAll notions earlier defined for hypernetworks, in particular, \u03bb-neat ones, translate to \u03bb-neat hypergraphs, using (*), like short hyperedges, long hyperedges, \u03bb-neat hypergraphs, etc. The\ngame is played now on \u03bb-neat hypergraphs on which the constant label \u03bb is kept on the short hyperedges in <\u03c9nodes( ). We have already dealt with the \u2018graph part\u2019 of the game. We turn to the remaining amalgamation moves. We need some notation and terminology. Every edge of any hypergraph (edge of its graph part) has an owner \u2200 or \u2203, namely, the one who coloured this edge. We call such edges \u2200 edges or \u2203 edges. Each long hyperedge x\u0304 in Nh of a hypergraph N occurring in the play has an envelope vN (x\u0304) to be defined shortly. In the initial round, if \u2200 plays a \u2208 \u03b1 and \u2203 plays N0, then all edges of N0 belong to \u2200. There are no long hyperedges in N0. If \u2200 plays a cylindrifier move requiring a new node k and \u2203 responds with M then the owner in M of an edge not incident with k is the same as in N and the envelope in M of a long hyperedge not incident with k is the same as that it was in N . All edges (l, k) for l \u2208 nodes(N ) \u223c {k} belong to \u2203 in M . If x\u0304 is any long hyperedge of M with k \u2208 rng(x\u0304), then vM (x\u0304) = nodes(M). If \u2200 plays the amalgamation move (M, N ) (of two \u03bb-neat hypergraphs) and \u2203 responds with L , then for m = n \u2208 nodes(L) the owner in L of an edge (m, n) is \u2200 if it belongs to \u2200 in either M or N , in all other cases it belongs to \u2203 in L . If x\u0304 is a long hyperedge of L , then vL(x\u0304) = vM (x\u0304) if rng(x\u0304) \u2286 nodes(M), vL(x\u0304) = vN (x\u0304) and vL(x\u0304) = nodes(M) otherwise. If in a latermove\u2200 plays the transformationmove (N , \u03b8) and\u2203 respondswith N\u03b8 , then owners and envelopes are inherited in the obvious way. This completes the definition of owners and envelopes. The next claim, basically, reduces amalgamation moves to cylindrifier moves. By induction on the number of rounds one can show the following:\nClaim: Let M, N occur in a play of Hm , 0 < m \u2208 \u03c9, in which \u2203 uses the above labelling for hyperedges. Let x\u0304 be a long hyperedge of M and let y\u0304 be a long hyperedge of N . Then for any hyperedge x\u0304 \u2032 with rng(x\u0304 \u2032) \u2286 vM (x\u0304), if M(x\u0304 \u2032) = M(x\u0304) then x\u0304 \u2032 = x\u0304 . If x\u0304 is a long hyperedge of M and y\u0304 is a long hyperedge of N , and M(x\u0304) = N (y\u0304), then there is a local isomorphism \u03b8 : vM (x\u0304) \u2192 vN (y\u0304) such that \u03b8(xi ) = yi for all i < |x |. For any x \u2208 nodes(M) \u223c vM (x\u0304) and S \u2286 vM (x\u0304), if (x, s) belong to \u2200 in M for all s \u2208 S, then |S| \u2264 2. Next, we proceed inductively with the inductive hypothesis exactly as before, except that now each Nr is a \u03bb-neat hypergraph. All that remains is the amalgamation move. With the above claim at hand, this turns out to be an easy task to implement guided by \u2203\u2019s winning strategy in the graph part. We consider an amalgamation move at round 0 < r , (Ns, Nt ) chosen by \u2200 in round r + 1, \u2203 has to deliver an amalgam Nr+1. \u2203 lets nodes(Nr+1) = nodes(Ns) \u222a nodes(Nt ), then she, for a start, has to choose a colour for each edge (i, j)where i \u2208 nodes(Ns) \u223c nodes(Nt ) and j \u2208 nodes(Nt ) \u223c nodes(Ns). Let x\u0304 enumerate nodes(Ns) \u2229 nodes(Nt ). If x\u0304 is short, then there are atmost twonodes in the intersection and this case is identical to the cylindrifiermove. If not, that is if x\u0304 is long in Ns , then by the claim there is a partial isomorphism \u03b8 : vNs (x\u0304) \u2192 vNt (x\u0304) fixing x\u0304 . We can assume that vNs (x\u0304) = nodes(Ns)\u2229nodes(Nt ) = rng(x\u0304) = vNt (x\u0304). It remains to label the edges (i, j) \u2208 Nr+1 where i \u2208 nodes(Ns) \u223c nodes(Nt ) and j \u2208 nodes(Nt ) \u223c nodes(Ns). Her strategy is now again similar to the cylindrifier move. If i and j are tints of the same cone, she chooses a red using \u03c1r+1 (constructed inductively like in the above proof), if not she chooses a white. She never chooses a green. Concerning n \u2212 1 tuples, she needs to label n \u2212 1 hyperedges by shades of yellow. For each tuple a\u0304 = a0, . . . an\u22122 \u2208 Nr+1, with no edge (ai , a j ) coloured green (we have already labelled edges), \u2203 colours a\u0304 by yS , where\nS = {i \u2208 Z : there is an i cone in Nr+1 with base a\u0304}. We have shown that \u2203 has a winning strategy in Hk(AtC) for each finite k.\n(3) Finishing the proof.All games used are deterministic. For each k < \u03c9, let \u03c3k describe the winning strategy of Hk(\u03b1). Let C = Tm\u03b1. Let D be a non-principal ultrapower of C.\nThen \u2203 has a winning strategy \u03c3 inH\u03c9(AtD)\u2014essentially she uses \u03c3k in the kth component of the ultraproduct so that, at each round of H\u03c9(AtD), \u2203 is still winning in co-finitely many components; this suffices to show she has still not lost. Now one can use an elementary chain argument to construct countable elementary subalgebras C = A0 A1 \u00b7 \u00b7 \u00b7 D in the following way. One definesAi+1 to be a countable elementary subalgebra ofD containingAi and all elements ofD that \u03c3 selects in a play ofH\u03c9(AtD) in which \u2200 only chooses elements from Ai .\nNow letB = \u22c3i<\u03c9 Ai . This is a countable elementary subalgebra ofD, hence necessarily atomic, and \u2203 has a winning strategy in H\u03c9(AtB). (cf. [7, Theorem 3.3.4 and Corollary 3.3.5] for a similar argument). So, by Lemma 5.3 (using AtB in place of \u03b1), we get that CmAtB \u2208 NrnCA\u03c9. SinceB \u2286d CmAtB,B \u2208 SdNrnCA\u03c9 and, by Lemma 5.3, we also have thatB \u2208 CRCAn . But\u2200has awinning strategy inGm(AtB), so byLemma2.4,C /\u2208 ScNrnCAm . To finalize the proof, let K be as given. Then B \u2261 C, B \u2208 K(\u2286 SdNrnCA\u03c9 \u2229 CRCAn), but C /\u2208 ScNrnCAn+3(\u2287 K) giving that K is not elementary.\nTheorem 5.5 1. There is a finite k \u2265 2, such that for all m \u2265 n + k the class of frames\nStr(SNrnCAm) = {F : CmF \u2208 SNrnCAm} is not elementary. An entirely analogous result holds for RAs. 2. Let O \u2208 {Sc,Sd , I} and k \u2265 3. Then the class of frames Kk = {F : CmF \u2208 ONrnCAn+k} is not elementary.\nProof 1. We show that Str(SNrnCAm) is not elementary for some finite m \u2265 n + 2. Let (Ai : i \u2208 \u03c9) be a sequence of (strongly) representable CAns with CmAtAi = Ai and A = i/UAi is not strongly representable with respect to any non-principal ultrafilter U on \u03c9. Such algebras exist [7]. Hence CmAtA /\u2208 SNrnCA\u03c9 = \u22c2i\u2208\u03c9 SNrnCAn+i , so CmAtA /\u2208 SNrnCAl for all l > m, for some m \u2208 \u03c9, m \u2265 n + 2. But for each such l, Ai \u2208 SNrnCAl(\u2286 RCAn), so (Ai : i \u2208 \u03c9) is a sequence of algebras such that CmAt(Ai ) \u2208 SNrnCAl (i \u2208 I ), but Cm(At( i/UAi )) = CmAt(A) /\u2208 SNrnCAl , for all l \u2265 m.\n2. We use the same construction (and notation) as above. It suffices to show that the class of algebrasKk = {A \u2208 CAn \u2229At : CmAtA \u2208 ONrnCAk} is not elementary. \u2203 has a winning strategy in H\u03c9(\u03b1) for some countable atom structure \u03b1, Tm\u03b1 \u2286d Cm\u03b1 \u2208 NrnCA\u03c9 and Tm\u03b1 \u2208 CRCAn . Since CZ,N /\u2208 ScNrnCAn+3, CZ,N = CmAtCZ,N /\u2208 Kk , CZ,N \u2261 Tm\u03b1 and Tm\u03b1 \u2208 Kk because Cm\u03b1 \u2208 NrnCA\u03c9 \u2286 SdNrnCA\u03c9 \u2286 ScNrnCA\u03c9. We have shown that CZ,N \u2208 ElKk \u223c Kk , proving the required statement.\nWe state an easy lemma towards strengthening Lemma 5.4. IfB is a Boolean algebra and b \u2208 B, then RlbB denotes the Boolean algebra with domain {x \u2208 B : x \u2264 b}, top element b, and other Boolean operations those ofB relativized to b.\nLemma 5.6 In what follows, A andD are Boolean algebras.\n1. If A is atomic and 0 = a \u2208 A, then RlaA is also atomic. If A \u2286d D, and a \u2208 A, then RlaA \u2286d RlaD, 2. If A \u2286d D then A \u2286c D. In particular, for any class K of BAOs, K \u2286 SdK \u2286 ScK. If furthermore A and D are atomic, then AtD \u2286 AtA.\nProof (1) Let b \u2208 RlaD be non-zero. Then b \u2264 a and b is non-zero in D. By the atomicity ofD there is an atom c ofD such that c \u2264 b. So c \u2264 b \u2264 a, thus c \u2208 RlaD. Also c is an atom inRlaD because if not, then it will not be an atom inD. The second part is similar.\n(2) Assume that \u2211A S = 1 and suppose to the contrary that there exists b\u2032 \u2208 D, b\u2032 < 1, such\nthat s \u2264 b\u2032 for all s \u2208 S. Let b = 1\u2212 b\u2032 then b = 0, hence by assumption (density) there exists a non-zero a \u2208 A such that a \u2264 b, i.e., a \u2264 (1\u2212 b\u2032). If a \u00b7 s = 0 for some s \u2208 S, then a is not less than b\u2032 which is impossible. So a \u00b7 s = 0 for every s \u2208 S, implying that a = 0, a contradiction. Now we prove the second part. Assume that A \u2286d D and D is atomic. Let b \u2208 D be an atom. We show that b \u2208 AtA. By density there is a non-zero a\u2032 \u2208 A, such that a\u2032 \u2264 b in D. Since A is atomic, there is an atom a \u2208 A such that a \u2264 a\u2032 \u2264 b. But b is an atom of D, and a is non-zero in D, too, so it must be the case that a = b \u2208 AtA. Thus, AtB \u2286 AtA and we are done.\nThe next lemma strengthens the main theorem in [13], and will be used later.\nLemma 5.7 Let 1 < n < \u03c9. There are two atomic cylindric algebras A and B having uncountably many atoms such that A \u2208 NrnCA\u03c9, A \u2261\u221e,\u03c9 B andB /\u2208 SdNrnCAn+1. Proof We first need to slighty modify the construction in [13, Lemma 5.1.3, Theorem 5.1.4] reformulating it as a \u2018splitting argument\u2019. The algebrasA andB constructed in op. cit. satisfy that A \u2208 NrnCA\u03c9, B /\u2208 NrnCAn+1 and A \u2261 B. As they stand, A and B are not atomic, but they can be fixed so that they give the same result by interpreting the uncountablymany tenary relations in the signature of M defined in [13, Lemma 5.1.3], which is the base of A and B to be disjoint in M, not just distinct. The construction is presented this way in [12], where (the equivalent of) M is built in a more basic step-by-step fashon. We work with 2 < n < \u03c9 instead of only n = 3. The proof presented in op. cit. lift verbatim to any such n. Let u \u2208 nn. Write 1u for \u03c7Mu (denoted by 1u (for n = 3) in [13, Theorem 5.1.4].) We denote by Au the Boolean algebra Rl1uA = {x \u2208 A : x \u2264 1u} and similarly for B, writing Bu short hand for the Boolean algebraRl1uB = {x \u2208 B : x \u2264 1u}.We show that \u2203 has awinning strategy in an Ehrenfeucht\u2013Fra\u00efss\u00e9-game over (A,B) concluding thatA \u2261\u221e B. At any stage of the game, if \u2200 places a pebble on one of A orB, \u2203 must place a matching pebble, on the other algebra. Let a\u0304 = \u3008a0, a1, . . . , an\u22121\u3009 be the position of the pebbles played so far (by either player) on A and let b\u0304 = \u3008b0, . . . , bn\u22121\u3009 be the the position of the pebbles played onB. \u2203maintains the following properties throughout the game: If x is an atom (of either algebra) with x \u00b71I d = 0, then x \u2208 ai if and only if x \u2208 bi and a\u0304 induces a finite partion of 1I d in A of 2n (possibly empty) parts pi : i < 2n and b\u0304 induces a partion of 1I d inB of parts qi : i < 2n . Furthermore, pi is finite if and only if qi is finite and, in this case, |pi | = |qi |. That such properties can be maintained is fairly easy to show. Using that M has quantifier elimination we get, using the same argument as in op. cit., that A \u2208 NrnCA\u03c9. The property that B /\u2208 NrnCAn+1 is also still maintained. To see why, consider the substitution operator ns(0, 1) (using one spare dimension) as defined in the proof of [13, Theorem 5.1.4]. Suppose to the contrary that B = NrnC, with C \u2208 CAn+1. Let u = 1, 0, 2, . . . , n \u2212 1. Then Au = Bu and so |Bu | > \u03c9. The term ns(0, 1) acts like a substitution operator corresponding to the transposition [0, 1]; it \u2018swaps\u2019 the first two coordinates. Now one can show that ns(0,1)CBu \u2286 B[0,1]\u25e6u = BI d , so |ns(0, 1)CBu | is countable becauseBI d was forced by construction to be countable. But ns(0, 1) is a Boolean automorpism with inverse ns(1, 0), so that |Bu | = |ns(0,1)CBu | > \u03c9, a contradiction.\nNow we show that the algebraB is outside SdNrnCA\u03c9 \u2229At \u2287 SdNrnCA\u03c9 \u2229CRCAn . Take \u03ba , the signature ofM, to be 22 \u03c9 and suppose to the contrary thatB \u2208 SdNrnCA\u03c9 \u2229At. Then B \u2286d NrnD for some D \u2208 CA\u03c9 and NrnD is atomic. For brevity, let C = NrnD. Then, by the first item of Lemma 5.6,RlI dB \u2286d RlI dC. Since C is atomic, by the following item of the same lemma, RlI dC is also atomic. Using the same reasoning as above, we get that\n|RlI dC| > 2\u03c9 (since C \u2208 NrnCA\u03c9.) By the choice of \u03ba , we get that |AtRlI dC| > \u03c9. By density using Lemma 5.6, AtRlI dC \u2286 AtRlI dB. But by the construction of B, we have |RlI dB| = |AtRlI dB| = \u03c9, which is a contradiction and we are done. In what follows,Up,Ur, P andH denote the operations of forming ultraproducts, ultraroots, products and homomorphic images, respectively.\nTheorem 5.8 1. Any classK such thatNrnCA\u03c9\u2229CRCAn \u2286 K \u2286 CRCAn\u2229SdNrnCA\u03c9\u2229CRCAn or any class K between CRCAn \u2229 SdNrnCA\u03c9 and ScNrnCAn+3, K is not elementary. 2. Any class K such that AtNrnCA\u03c9 \u2286 K \u2286 AtNrnCA\u03c9 is not elementary. Proof 1. Twoatomic algebrasA andB are constructed inLemma5.7 such thatA \u2208 NrnCA\u03c9,\nB /\u2208 SdNrnCAn+1 and A \u2261 B. Thus, B \u2208 El(NrnCA\u03c9 \u2229 CRCAn) \u223c SdNrnCA\u03c9. Since El(NrnCA\u03c9 \u2229CRCAn) SdNrnCA\u03c9 \u2229CRCAn , there can be no elementary class between NrnCA\u03c9\u2229CRCAn and SdNrnCA\u03c9\u2229CRCAn . Having already eliminated elementary classes between SdNrnCA\u03c9 \u2229 CRCAn and ScNrnCAn+3, we are done. 2. We prove the following: let \u03b1 be a countable atom structure. If \u2203 has a winning strategy in H\u03c9(\u03b1), then any algebra F having atom structure \u03b1 is completely representable and there exists a completeD \u2208 RCA\u03c9 such that \u03b1 \u223c= AtNrnD. In particular, Cm\u03b1 \u2208 NrnCA\u03c9 and \u03b1 \u2208 AtNrnCA\u03c9. Combined with the proof of theorem 5.4 we will be done. For this purpose, let x \u2208 D be formed as above. Then x = (xa : a \u2208 \u03b1), where xa \u2208 Da . For b \u2208 \u03b1 let \u03c0b : D \u2192 Db be the projection map defined by \u03c0b(xa : a \u2208 \u03b1) = xb. Conversely, let \u03b9a : Da \u2192 D be the embedding defined by \u03b9a(y) = (xb : b \u2208 \u03b1), where xa = y and xb = 0 for b = a. Suppose x \u2208 NrnD \\ {0}. Since x = 0, it has a non-zero component\u03c0a(x) \u2208 Da for some a \u2208 \u03b1. Assume that \u2205 = \u03c6(xi0 , . . . , xik\u22121)Da = \u03c0a(x), for some L-formula \u03c6(xi0 , . . . , xik\u22121). We have \u03c6(xi0 , . . . , xik\u22121)\nDa \u2208 NrnDa . Pick f \u2208 \u03c6(xi0 , . . . , xik\u22121)\nDa and assume thatMa, f | b(x0, . . . xn\u22121) for some b \u2208 \u03b1. We show that b(x0, x1, . . . , xn\u22121)Da \u2286 \u03c6(xi0 , . . . , xik\u22121)Da . Take any g \u2208 b(x0, x1 . . . , xn\u22121)Da , so thatMa, g | b(x0, . . . xn\u22121). Themap {( f (i), g(i)) : i < n} is a partial isomorphism ofMa . Here short hyperedges are constantly labelled by \u03bb. This map extends to a finite partial isomorphism \u03b8 of Ma whose domain includes f (i0), . . . , f (ik\u22121). Let g\u2032 \u2208Ma be defined by\ng\u2032(i) = { \u03b8(i), if i \u2208 dom(\u03b8), g(i), otherwise.\nWe have Ma, g\u2032 | \u03c6(xi0 , . . . , xik\u22121). But g\u2032(0) = \u03b8(0) = g(0) and similarly g\u2032(n \u2212 1) = g(n \u2212 1), so g is identical to g\u2032 over n and it differs from g\u2032 on only a finite set. Since \u03c6(xi0 , . . . , xik\u22121)\nDa \u2208 NrnDa , we get that Ma, g | \u03c6(xi0 , . . . , xik ), so g \u2208 \u03c6(xi0 , . . . , xik\u22121)Da (this can be provedby induction onquantifier depth of formulas). This proves that\nb(x0, x1 . . . xn\u22121)Da \u2286 \u03c6(xi0 , . . . , xik )Da = \u03c0a(x), and so\n\u03b9a(b(x0, x1, . . . xn\u22121)Da ) \u2264 \u03b9a(\u03c6(xi0 , . . . , xik\u22121)Da ) \u2264 x \u2208 Da \\ {0}. Now every non-zero element x of NrnDa is above a non-zero element of the following form: \u03b9a(b(x0, x1, . . . , xn\u22121)Da ) (for some a, b \u2208 \u03b1) and these are the atoms ofNrnDa . The map defined via b \u2192 (b(x0, x1, . . . , xn\u22121)Da : a \u2208 \u03b1) is an isomorphism of atom structures, so \u03b1 \u2208 AtNrnCA\u03c9."
        },
        {
            "heading": "6 Other notions of representability",
            "text": "Theorem 6.1 Let \u03ba be an infinite cardinal. Then there exists an atomless C \u2208 CA\u03c9 such that, for all 2 < n < \u03c9, NrnC is atomic with |At(NrnC)| = 2\u03ba , NrnC \u2208 LCAn, but NrnC is not completely representable.\nProof We use the following uncountable version of Ramsey\u2019s theorem due to Erdos and Rado: if r \u2265 2 is finite and k is an infinite cardinal, then expr (k)+ \u2192 (k+)r+1k where exp0(k) = k and inductively expr+1(k) = 2expr (k). The above partition symbol describes the following statement. If f is a coloring of the (r + 1)-element subsets of a set of cardinality expr (k)\n+ with k colors, then there is a homogeneous set of cardinality k+ (a set all whose (r+1)-element subsets get the same f -value). Let \u03ba be the given cardinal. We use a variation on the construction which is a simplified more basic version of a rainbow construction where only the two predominent colours, namely, the reds and blues are available. The algebra C will be constructed from a relation algebra possesing an \u03c9-dimensional cylindric basis. To define the relation algebra we specify its atoms and the forbidden triples of atoms. The atoms are Id, gi0 : i < 2\u03ba and r j : 1 \u2264 j < \u03ba , all symmetric. The forbidden triples of atoms are all permutations of (Id, x, y) for x = y, (r j , r j , r j ) for 1 \u2264 j < \u03ba and (gi0,gi \u2032 0 ,g i\u2217 0 ) for i, i \u2032, i\u2217 < 2\u03ba . Write g0 for {gi0 : i < 2\u03ba } and r+ for {r j : 1 \u2264 j < \u03ba}. Call this atom structure \u03b1. Consider the term algebraR defined to be the subalgebra of the complex algebra of this atom structure generated by the atoms. We claim that R, as a relation algebra, has no complete representation, hence any algebra sharing this atom structure is not completely representable either.\nSuppose to the contrary that R has a complete representation M. Let x, y be points in the representation with M | r1(x, y). For each i < 2\u03ba , there is a point zi \u2208 M such that M | gi0(x, zi ) \u2227 r1(zi , y). Let Z = {zi : i < 2\u03ba }. Within Z , each edge is labelled by one of the \u03ba atoms in r+. The Erdos\u2013Rado theorem forces the existence of three points z1, z2, z3 \u2208 Z such that M | r j (z1, z2) \u2227 r j (z2, z3) \u2227 r j (z3, z1) for some single j < \u03ba . This contradicts the definition of composition in R (since we avoided monochromatic triangles). Let S be the set of all atomic R-networks N with nodes \u03c9 such that {ri : 1 \u2264 i < \u03ba : ri is the label of an edge inN} is finite. Then it is straightforward to show that S is an amalgamation class, that is, for all M, N \u2208 S, if M \u2261i j N then there is L \u2208 S with M \u2261i L \u2261 j N , witness [6, Definition 12.8] for notation. Now let X be the set of finite R-networks N with nodes \u2286 \u03ba such that 1. each edge of N is either (a) an atom ofR or (b) a cofinite subset of r+ = {r j : 1 \u2264 j < \u03ba}\nor (c) a cofinite subset of g0 = {gi0 : i < 2\u03ba } and 2. N is \u2018triangle-closed\u2019, i.e., for all l,m, n \u2208 nodes(N )wehave N (l, n) \u2264 N (l,m); N (m, n).\nThat means if an edge (l,m) is labelled by Id then N (l, n) = N (m, n) and if N (l,m), N (m, n) \u2264 g0 then N (l, n) \u00b7 g0 = 0 and if N (l,m) = N (m, n) = r j (some 1 \u2264 j < \u03c9) then N (l, n) \u00b7 r j = 0. For N \u2208 X let N\u0302 \u2208 Ca(S) be defined by\n{L \u2208 S : L(m, n) \u2264 N (m, n) for m, n \u2208 nodes(N )}. For i \u2208 \u03c9, let N \u2212i be the subgraph of N obtained by deleting the node i . Then if N \u2208 X , i < \u03c9 then c\u0302i N = N\u0302 \u2212i . The inclusion c\u0302i N \u2286 (N\u0302 \u2212i ) is clear. Conversely, let L \u2208 (\u0302N \u2212i ). We seek M \u2261i L with M \u2208 N\u0302 . This will prove that L \u2208 c\u0302i N , as required. Since L \u2208 S, the set T = {ri /\u2208 L} is infinite. Let T be the disjoint union of two infinite sets Y \u222aY \u2032, say. To define the \u03c9-network M we must define the labels of all edges involving the node i (other labels are\ngiven by M \u2261i L). We define these labels by enumerating the edges and labeling them one at a time. So let j = i < \u03ba . Suppose j \u2208 nodes(N ). We must choose M(i, j) \u2264 N (i, j). If N (i, j) is an atom then of course M(i, j) = N (i, j). Since N is finite, this defines only finitely many labels of M . If N (i, j) is a cofinite subset of g0 then we let M(i, j) be an arbitrary atom in N (i, j). And if N (i, j) is a cofinite subset of r+ then let M(i, j) be an element of N (i, j) \u2229 Y which has not been used as the label of any edge of M which has already been chosen (possible, since at each stage only finitely many have been chosen so far). If j /\u2208 nodes(N ) then we can let M(i, j) = rk \u2208 Y some 1 \u2264 k < \u03ba such that no edge of M has already been labelled by rk . It is not hard to check that each triangle of M is consistent (we have avoided all monochromatic triangles) and clearly M \u2208 N\u0302 and M \u2261i L . The labeling avoided all but finitely many elements of Y \u2032, so M \u2208 S. So (\u0302N \u2212i ) \u2286 c\u0302i N .\nNow let X\u0302 = {N\u0302 : N \u2208 X} \u2286 Ca(S). Then the subalgebra of Ca(S) generated by X\u0302 is simply obtained from X\u0302 by closing under finite unions. Thus,R is relation algebra reduct of C \u2208 CA\u03c9 but has no complete representation. Let n > 2. LetB = NrnC. ThenB \u2208 NrnCA\u03c9, is atomic, but has no complete representation for plainly a complete representation of B induces one of R. In fact, because B is generated by its two-dimensional elements, and its dimension is at least three, its Df reduct is not completely representable. We show that the \u03c9\u2013dilation C is atomless. For any N \u2208 X , we can add an extra node extending N to M such that \u2205 M \u2032 N \u2032, so that N \u2032 cannot be an atom in C. ThenNrnC (2 < n < \u03c9) is atomic, but has no complete representation. By Lemma 2.4, \u2203 has a winning strategy in G\u03c9(AtNrnC), hence she has a winning strategy in G\u03c9(AtNrnC), a fortiori in Gk(AtNrnC) for all k \u2208 \u03c9, hence by coding the winning strategies of the Gks in first-order sentences, we get thatNrnC satisfies these first-order sentences which are precisely (by definition) the Lyndon conditions.\nBy observing from the last part of the proof of the previous theorem that NrnCA\u03c9 \u2286 LCAn(= ElCRCAn) and similarly for RAs, we have RaCA\u03c9 \u2286 LRRA = (ElCRRA), we immediately get Corollary 6.2 (Hirsch and Hodkinson) For 2 < n < \u03c9, the classes CRCAn and CRRA are not elementary.\nTheorem 6.3 For 2 < n < \u03c9 the following hold:\n1. CRCAn \u2286 ScNrn(CA\u03c9 \u2229 At) \u2229 At. At least two of the last three classes are distinct. 2. All reverse inclusions in the first item hold if atomic algebras considerered have countably\nmany atoms. 3. All classes in the first itemare closed underSc a fortioriSd ,P (products), but are not closed\nunder S nor H (homomorphic images) nor Ur (ultraroots). Their elementary closure coincides wih LCAn. 4. NrnCA\u03c9 SdNrnCA\u03c9 ScNrnCA\u03c9 \u2286 ELScNrnCA\u03c9 RCAn. Furthermore, the strictness of the inclusions can be witnessed by atomic algebras.\nProof We prove more considering infinite dimensions. To adapt to the infinite-dimensional case, we define complete representability with respect to (generalized) weak set algebras of the same infinite dimension in the sense of [4]. This coincides with the usual definition for finite dimensions for in the finite-dimensional case obviously weak set algebras are just set algebras (of the same dimension). Suppose that A has complete representation. Assume that M is the base of a complete representation of A, whose the unit is a weak generalized space, that is, 1M = \u22c3 \u03b1U (pi )i pi \u2208 \u03b1Ui , where \u03b1U (pi )i \u2229 \u03b1U (p j ) j = \u2205 for distinct i and j in some index set I , that is, we have an isomorphism t : B \u2192 C, where C \u2208 Gs\u03b1 has unit\n1M, and t preserves arbitrary meets carrying them to set-theoretic intersections. For i \u2208 I , let Ei = \u03b1U (pi )i . Take fi \u2208 \u03b1+\u03c9U (qi )i where qi \u03b1 = pi and let Wi = { f \u2208 \u03b1+\u03c9U (qi )i :|{k \u2208 \u03b1 + \u03c9 : f (k) = fi (k)}| < \u03c9}. Let Ci = \u2118(Wi ). Then Ci is atomic; indeed the atoms are the singletons. Let x \u2208 Nr\u03b1Ci , that is, ci x = x for all \u03b1 \u2264 i < \u03b1 + \u03c9. Now if f \u2208 x and g \u2208 Wi satisfy g(k) = f (k) for all k < \u03b1, then g \u2208 x . Hence Nr\u03b1Ci is atomic; its atoms are {g \u2208 Wi : {g(i) : i < \u03b1} \u2286 Ui }. Define hi : A \u2192 Nr\u03b1Ci by hi (a) = { f \u2208 Wi : \u2203a\u2032 \u2208 AtA, a\u2032 \u2264 a; ( f (i) : i < \u03b1) \u2208 t(a\u2032)}. Let D = PiCi . Let \u03c0i : D \u2192 Ci be the i th projection map. Now clearly D is atomic, because it is a product of atomic algebras, and its atoms are (\u03c0i (\u03b2) : \u03b2 \u2208 At(Ci )). Now A embeds into Nr\u03b1D via J : a \u2192 (\u03c0i (a) : i \u2208 I ). If x \u2208 Nr\u03b1D, then for each i , we have \u03c0i (x) \u2208 Nr\u03b1Ci , and if x is non-zero, then \u03c0i (x) = 0. By the atomicity of Ci , there is an \u03b1-ary tuple y, such that {g \u2208 Wi : g(k) = yk} \u2286 \u03c0i (x). It follows that there is an atom of b \u2208 A, such that x \u00b7 J (b) = 0, and so the embedding is atomic, hence complete. We have shown that A \u2208 ScNr\u03b1CA\u03b1+\u03c9 and we are done.\n(2) By [13, Theorem 5.3.6] the class CRCAn coincides with the class ScNrnCA\u03c9 on atomic algebras with countably many atoms. Then together with [7, Theorem 3.3.3] we are done.\n(3) We start with CRCAn . Closure under P is straightforward. We show that ScCRCAn = CRCAn . Assume that D \u2208 CRCAn and A \u2286c D. Identifying set algebras with their domain, let f : D \u2192 \u2118(V ) be a complete representation of A where V is a Gsn unit. We claim that g = f A establishes the required complete representation of A. Let X \u2286 A, then for x \u2208 X(\u2286 A), we have f (x) = g(x), so that\u22c3x\u2208X g(x) = \u22c3 x\u2208X f (x) = V , since it is given that f is a complete representation andwe are done. LetC be any of the two remaining classes. Closure under Sc follows from ScScC = ScC. Closure under P follows from PScC \u2286 ScPC andPNrnCA\u03c9 = NrnCA\u03c9. Non-closure under S is trivial for a subalgebra of an atomic algebra may well be non-atomic. We prove non-closure under H for all three clases in one go. Take a family (Ui i \u2208 N) of pairwise disjoint non-empty sets. Let Vi = nUi (i \u2208 N). Take the full Gsn A with universe \u2118(V ) where V = \u22c3i\u2208N Vi . Then A \u2208 CRCAn \u2286 C. Let I be the ideal of elements of A intersecting with only finitely many elements of the Vi s. Then A/I is non-atomic, and so is outside all three classes.\nNow we approach closure under ultraroots (Ur). Let C \u2208 CAn \u223c CRCAn be atomic having countable many atoms and elementary equivalent to a B \u2208 CRCAn . Such algebras exist (as shown above, see, e.g., the algebra CZ,N used in the proof of Theorems 5.4 and 5.5 , or [5]). Since all the given classes are closed under ultraproducts, it must be the case that B /\u2208 UrC of any of the given three classes C, since by the Keisler\u2013Shelah ultrapower Therorem ElK = UrUpK. Now we show the pseudo-elementarity of NrnCAm (which is known to be non-elementary [12]). If m is finite, then the pseudo-elementary class NrnCAm can be defined in two sorted theory in a fairly straightforward manner. When m = \u03c9, things are slightly (but not much more) involved. One proceeds as follows defining NrnCA\u03c9 in a three-sorted theory: Use a sort of the CAn (c), the second sort is for the Boolean reduct of the CAn (b), and the third sort is for the set odd dimensions (\u03b4). For any infinite ordinal \u03bc the defining theory of NrnCA\u03bc = NrnCA\u03c9 will include sentences requiring that the constants i\u03b4 for i < \u03c9 are distinct, and the last two sorts defines a CA\u03c9. There is a function I b from sort (c) to sort (b) and one stipulates sentences forcing that I b is injective and respects the CAn operations. For example, for all xc and i < n I b(ci xc)) = cbi (I b(xc)). One finally requires that I b maps onto the set of n-dimensional elements. This can be expressed via (*):\n\u2200yb(\u2200z\u03b4(z\u03b4 = 0\u03b4, . . . , (n \u2212 1)\u03b4 \u21d2 cb(z\u03b4, yb) = yb)) \u21d0\u21d2 \u2203xc(yb = I b(xc))).\nIn all cases it is is clear that any algebra of the right type is the first sort of a model of this theory. Conversely, a model of this theory will consist of A \u2208 CAn (sort c) and a B \u2208 CA\u03c9; the dimension of the last is the cardinality of the \u03b4-sorted elements which is \u03c9 such that by (*) A = NrnB. Thus, the three-sorted theory defines the class of neat reducts. Furthermore, it is clearly recursive. Recursive enumerability for both classes follows from [6, Theorem 9.37].\nFor the last statement we show that LCAn = ElCRCAn = ElScNrnCA\u03c9 \u2229 At. Assume A \u2208 LCAn . Then, by definition, for all k < \u03c9, \u2203 has a winning strategy in the k-rounded atomic game Gk(AtA). Using ultrapowers followed by an elementay chain argument, like in [7, Theorem 3.3.3], there exists a countable atomic B such that B \u2261 A and \u2203 has a winning strategy in the \u03c9-rounded atomic game G\u03c9(AtB). So A \u2208 ElCRCAn , because by [6, Theorem 3.3.3], B \u2208 CRCAn . One next shows that El(Sc)NrnCA\u03c9 \u2229 At) \u2286 LCAn as follows. Assume that A \u2208 ScNrnCA\u03c9 \u2229 At. Then by Lemma 2.4, \u2203 has a winning strategy in G\u03c9(AtA). Since we have infinitely many nodes, and infinitely many rounds, reusing the nodes in play, is superfluous, so \u2203 has a winning strategy in the usual \u03c9-rounded atomic game G\u03c9(AtA). This obviously implies that \u2203 has winning strategy in the k-rounded usual atomic game Gk(AtA) for all k < \u03c9. But this means, by definition, thatA satifies the Lyndon conditions.We have shown that ScNrnCA\u03c9\u2229At \u2286 LCAn . Since LCAn is elementary, it readily follows that ELScNrnCA\u03c9 \u2229 At \u2286 LCAn .\nFor the last item: The algebraE used in Theorem 3.6 witnesses thatNrnCA\u03c9 SdNrnCA\u03c9, because E /\u2208 ElNrnCA\u03c9 \u2287 NrnCA\u03c9 and E \u2286d B where B is the full CAn with unit nQ and universe \u2118(nQ). We have constructed algebras with countably many atoms in ELScNrnCA\u03c9 \u223c ScNrnCA\u03c9 like the rainbow-like algebra CZ,N . Let A \u2208 RCAn be simple, countable and atomic such that CmAtA /\u2208 RCAn . This algebra exists in [9] and even finer ones were constructed in Theorem 3.2. Then A /\u2208 LCAn , because AtA does not satisfy the Lyndon conditions, lest CmAtA \u2208 LCAn(\u2286 RCAn) which we know is not the case. Then A \u2208 RCAn \u223c El\u00a7cNrnCA\u03c9 proving the strictness of the last inclusion. Since all three algebras E,CZ,N, and A are atomic, we are done.\nFix 2 < n < \u03c9. Call an atomicA \u2208 CAn weakly (strongly) representable if AtA is weakly (strongly) representable. LetWRCAn(SRCAn)) denote the class of all such CAns, respectively. Then the class SRCAn is not elementary, and LCAn SRCAn WRCAn [7]. Recall that for a class K of atomic BAOs, K \u2229 Count denotes the class of algebras having countably many atoms.\nTheorem 6.4 If 2 < n < \u03c9, then the following hold:\n1. ScNrnCA\u03c9 \u2229 At \u2229 Count = CRCAn \u2229 Count. 2. SNrnCA\u03c9 \u2229 At = WRCAn. 3. ElScNrnCA\u03c9 \u2229 At = LCAn. 4. PElScNrnCA\u03c9 \u2229 At \u2286 SRCAn Proof The first item is already dealt with in [13, Theorem 3.6.2]. (2) follows from the definition upon noting that RCAn = SNrnCA\u03c9, and the last two items follow from LCAn \u2286 SRCAn , ElScNrnCA\u03c9 \u2229 At = LCAn , and the fact (which is straightforward to check) that SRCAn is closed under P.\nFunding Open access funding provided byTheScience, Technology&; Innovation FundingAuthority (STDF) in cooperation with The Egyptian Knowledge Bank (EKB).\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give\nappropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/."
        }
    ],
    "title": "Notions of representability for cylindric algebras: some algebras are more representable than others",
    "year": 2022
}