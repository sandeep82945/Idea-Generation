Performance forecasting is an age-old problem in economics and finance. Recently, developments in machine learning and neural networks have given rise to non-linear time series models that provide modern and promising alternatives to traditional methods of analysis. In this paper, we present an ensemble of independent and parallel long short-term memory (LSTM) neural networks for the prediction of stock price movement. LSTMs have been shown to be especially suited for time series data due to their ability to incorporate past information, while neural network ensembles have been found to reduce variability in results and improve generalization. A binary classification problem based on the median of returns is used, and the ensemble’s forecast depends on a threshold value, which is the minimum number of LSTMs required to agree upon the result. The model is applied to the constituents of the smaller, less efficient Stockholm OMX30 instead of other major market indices such as the DJIA and S&P500 commonly found in literature. With a straightforward trading strategy, comparisons with a randomly chosen portfolio and a portfolio containing all the stocks in the index show that the portfolio resulting from the LSTM ensemble provides better average daily returns and higher cumulative returns over time. Moreover, the LSTM portfolio also exhibits less volatility, leading to higher risk-return ratios. 1The LSTM portfolio also has a lower standard deviation than the all-stock portfolio, indicating that the portfolio chosen by the LSTM method may incur less risk. It is also worth noting that although the all-stock portfolio appears to have a slightly higher maximum daily return, the minimum return for the LSTM is less negative, which may suggest that the LSTM portfolio has a much less downside that that of the all-stock portfolio. For more details, Table 5 compares the average daily returns by year, where the best results are highlighted in bold. During the 2007 - 2008 financial crisis, the random portfolio provided better returns than both the LSTM and all-stock portfolios. Afterwards, however, as in the overall results in Table 4, the random portfolio is outperformed by the LSTM and all-stock portfolios. The results of these two portfolios are very close to each other, where in some years, the LSTM portfolio appears to have a higher average daily return, while in others, the all-stock portfolio does. Similar to Table 4, however, one can see that for periods of negative returns, such as for the years 2007 - 2008, 2011, and 2018, the LSTM appears to do better than the all-stock portfolio by having less negative results. Again, this implies that the LSTM portfolio is certainly a more attractive choice when losses are to be expected. To see the development of profits over time, Figure 8 graphs the cumulative returns for all three portfolios from 2007 - 2020. It can be seen that the LSTM portfolio clearly has the highest accumulated returns for the whole period. Once again, during intervals of decline, as is evident in 2008 - 2009 for example, the graph shows that the LSTM portfolio returns does not decrease as much as the all-stock portfolio. 4A comparison with the OMX30 index cannot be made directly for two reasons. First, ESSITY B was excluded due to lack of data for the period of interest. Second, the stocks examined here are fixed to be those making up the index as of February 2020, while the index constituents in practice are regularly adjusted. 4.4 portfolio risk For a more rigorous assessment of the risk, the annualized volatility, Sharpe ratio, and Sortino ratio were examined. The Sharpe ratio is a commonly used measurement of return per unit of risk and is given by the following formula:
Sharpe ratio = Rp − rf σp
(4.4.1)
where the Rp is the portfolio return, rf the risk-free return, and σp the standard deviation of the portfolio returns. On the other hand, the Sortino ratio is a variant of the Sharpe ratio that only takes into account the downside standard deviation. It is given by:
Sortino ratio = Rp − rf σd
(4.4.2)
where σd is the standard deviation of the negative portfolio returns. By only considering the negative returns, the Sortino ratio distinguishes between good and bad volatility. Regardless of
which is used, higher values are preferred for both ratios. In the calculations, the risk-free rate was taken to be the Swedish 1-month Treasury bill (accessed from https://www.riksbank.se/ en-gb/statistics/search-interest--exchange-rates/). Results are presented in Table 6. Looking at the annualized volatility columns, it is evident that the LSTM has lower volatility throughout, denoting a less risky portfolio. Comparing the Sharpe and Sortino ratios, one can see that apart from 2013 - 2016, the LSTM portfolio appears to have a higher return per unit of risk than the all-stock portfolio. Negative Sharpe and Sortino ratios in 2007 - 2008, 2011, and 2018 indicate the portfolios’ returns during these periods are less than the risk-free rate (see Table 5). Care must always be taken when comparing negative ratios as they can be misleading. For example, for the same return, a larger standard deviation, i.e., higher risk, will result in a less negative ratio, which may lead some to conclude better performance. In this case, however, the less negative ratios of the LSTM portfolio do indeed come from the combination of higher returns and lower volatility. 5 summary and conclusions In this paper, we present an approach for the prediction of stock price movement by using an ensemble of independent and parallel LSTM neural networks. A binary classification problem based on the median of returns is used and the ensemble’s forecast depends on how many of the LSTMs agree on the same output. The model is applied to the constituents of the relatively smaller and less efficient OMX30 index as opposed to the commonly used major stock market indices such as the S&P500 and DJIA. A straightforward trading strategy is then implemented based on the LSTM forecasts. Compared to a randomly chosen portfolio and a portfolio containing all the stocks in the index, the LSTM-based portfolio appears to have better average daily returns and a higher cumulative return over time. Even more remarkably, the LSTM portfolio exhibits less volatility throughout the whole period than the portfolio containing all the stocks. The combination of this lower volatility with the higher returns results in higher risk-return ratios.