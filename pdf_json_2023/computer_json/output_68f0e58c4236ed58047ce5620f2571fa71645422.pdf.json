{
    "abstractText": "Smooth and curved microstructural topologies found in nature \u2013 from soap films to trabecular bone \u2013 have inspired several mimetic design spaces for architected metamaterials and bio-scaffolds. However, the design approaches so far have been ad hoc, raising the challenge: how to systematically and efficiently inverse design such artificial microstructures with targeted topological features? Here, we explore surface curvature as a design modality and present a deep learning framework to produce topologies with as-desired curvature profiles. The inverse design framework can generalize to diverse topological features such as tubular, membranous, and particulate features. Moreover, we demonstrate successful generalization beyond both the design and data space by inverse designing topologies that mimic the curvature profile of trabecular bone, spinodoid topologies, and periodic nodal surfaces for application in bio-scaffolds and implants. Lastly, we bridge curvature and mechanics by showing how topological curvature can be designed to promote mechanically beneficial stretching-dominated deformation over bending-dominated deformation.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yaqi Guo"
        },
        {
            "affiliations": [],
            "name": "Saurav Sharma"
        },
        {
            "affiliations": [],
            "name": "Siddhant Kumar"
        }
    ],
    "id": "SP:a980845be0723934650192d09eaedb46586fef61",
    "references": [
        {
            "authors": [
                "J.E. Taylor"
            ],
            "title": "The structure of singularities in soap-bubble-like and soap-film-like minimal surfaces",
            "venue": "Annals Math. 103,",
            "year": 1976
        },
        {
            "authors": [
                "F.J. Almgren",
                "J.E. Taylor"
            ],
            "title": "The geometry of soap films and soap bubbles",
            "venue": "Sci. Am. 235,",
            "year": 1976
        },
        {
            "authors": [
                "A.M. Turing"
            ],
            "title": "The Chemical Basis of Morphogenesis",
            "venue": "Philos. Transactions Royal Soc. Lond. Ser. B",
            "year": 1952
        },
        {
            "authors": [
                "S. Kondo"
            ],
            "title": "An updated kernel-based turing model for studying the mechanisms of biological pattern formation",
            "venue": "J. Theor. Biol",
            "year": 2016
        },
        {
            "authors": [
                "S.J. Callens",
                "D.C. Tourolle n\u00e9 Betts",
                "R. M\u00fcller",
                "A.A. Zadpoor"
            ],
            "title": "The local and global geometry of trabecular bone",
            "venue": "Acta Biomater",
            "year": 2021
        },
        {
            "authors": [
                "M. Ralph"
            ],
            "title": "Hierarchical microimaging of bone structure and function",
            "venue": "Nat. reviews. Rheumatol",
            "year": 2009
        },
        {
            "authors": [
                "M. Puhka",
                "M. Joensuu",
                "H. Vihinen",
                "I. Belevich",
                "E. Jokitalo"
            ],
            "title": "Progressive sheet-to-tubule transformation is a general mechanism for endoplasmic reticulum partitioning in dividing mammalian cells",
            "venue": "Mol. Biol. Cell",
            "year": 2012
        },
        {
            "authors": [
                "S.K. Ramasamy"
            ],
            "title": "Structure and functions of blood vessels and vascular niches in bone. Stem cells",
            "year": 2017
        },
        {
            "authors": [
                "K.K. Sivaraj",
                "R.H. Adams"
            ],
            "title": "Blood vessel formation and function in bone",
            "venue": "Development 143,",
            "year": 2016
        },
        {
            "authors": [
                "J. Erlebacher",
                "M.J. Aziz",
                "A. Karma",
                "N. Dimitrov",
                "K. Sieradzki"
            ],
            "title": "Evolution of nanoporosity in dealloying",
            "venue": "Nature 410,",
            "year": 2001
        },
        {
            "authors": [
                "Portela",
                "C. M"
            ],
            "title": "Extreme mechanical resilience of self-assembled nanolabyrinthine materials",
            "venue": "Proc. Natl. Acad. Sci. 117,",
            "year": 2020
        },
        {
            "authors": [
                "J.D. Hill",
                "P.C. Millett"
            ],
            "title": "Directed self-assembly in diblock copolymer thin films for uniform hemisphere pattern formation",
            "venue": "Macromolecules 52,",
            "year": 2019
        },
        {
            "authors": [
                "Jung",
                "D. S"
            ],
            "title": "Pattern formation of metal\u2013oxide hybrid nanostructures via the self-assembly of di-block copolymer blends",
            "venue": "Nanoscale 11,",
            "year": 2019
        },
        {
            "authors": [
                "J Ren"
            ],
            "title": "Engineering the kinetics of directed self-assembly of block copolymers toward fast and defect-free assembly",
            "venue": "ACS Appl. Mater. & Interfaces",
            "year": 2018
        },
        {
            "authors": [
                "P. Castillo",
                "S. G\u00f3mez"
            ],
            "title": "An interpolatory directional splitting-local discontinuous galerkin method with application to pattern formation in 2d/3d",
            "venue": "Appl. Math. Comput",
            "year": 2021
        },
        {
            "authors": [
                "M. Jiang",
                "J. Zhang",
                "J. Zhu",
                "X. Yu",
                "L. Bevilacqua"
            ],
            "title": "Numerical simulation for clustering and pattern formation in active colloids with mass-preserving characteristic finite element method",
            "venue": "Comput. Methods Appl. Mech. Eng",
            "year": 2021
        },
        {
            "authors": [
                "R Anzaki"
            ],
            "title": "Phase prediction method for pattern formation in time-dependent ginzburg-landau dynamics for kinetic ising model without a priori assumptions of domain patterns",
            "venue": "Phys. Rev. B 103,",
            "year": 2021
        },
        {
            "authors": [
                "J. Diaz",
                "M. Pinna",
                "A.V. Zvelindovsky",
                "I. Pagonabarraga"
            ],
            "title": "Nematic ordering of anisotropic nanoparticles in block copolymers",
            "venue": "Adv. Theory Simulations",
            "year": 2021
        },
        {
            "authors": [
                "V. Ankudinov",
                "P.K. Galenko"
            ],
            "title": "Structure diagram and dynamics of formation of hexagonal boron nitride in phase-field crystal model",
            "venue": "Philos. Transactions Royal Soc. A: Math. Phys. Eng. Sci",
            "year": 2020
        },
        {
            "authors": [
                "L. Servier"
            ],
            "title": "Cancellous bone. Wikimedia Commons (2019)",
            "venue": "URL: https://commons.wikimedia.org/wiki/File: Spongy_bone_-_Trabecular_bone_-_Normal_trabecular_bone_--_Smart-Servier.png, [Online; accessed",
            "year": 2019
        },
        {
            "authors": [
                "B. Spirit"
            ],
            "title": "Photo of a soap bubble creating a catenoid",
            "venue": "Wikimedia Commons",
            "year": 2006
        },
        {
            "authors": [
                "B.I. Garten"
            ],
            "title": "Injection preparation; universum bremen",
            "venue": "Wikimedia Commons",
            "year": 2009
        },
        {
            "authors": [
                "C. Soyarslan",
                "S. Bargmann",
                "M. Pradas",
                "J. Weissm\u00fcller"
            ],
            "title": "3d stochastic bicontinuous microstructures: Generation, topology and elasticity",
            "venue": "Acta materialia 149,",
            "year": 2018
        },
        {
            "authors": [
                "Hsieh",
                "M.-T",
                "B. Endo",
                "Y. Zhang",
                "J. Bauer",
                "L. Valdevit"
            ],
            "title": "The mechanical response of cellular materials with spinodal topologies",
            "venue": "J. Mech. Phys. Solids",
            "year": 2019
        },
        {
            "authors": [
                "S. Kumar",
                "S. Tan",
                "L. Zheng",
                "D.M. Kochmann"
            ],
            "title": "Inverse-designed spinodoid metamaterials. npj Comput. Mater",
            "year": 2020
        },
        {
            "authors": [
                "Hsieh",
                "M.-T",
                "M.R. Begley",
                "L. Valdevit"
            ],
            "title": "Architected implant designs for long bones: Advantages of minimal surface-based topologies",
            "venue": "Mater. & Des",
            "year": 2021
        },
        {
            "authors": [
                "L. Zheng",
                "S. Kumar",
                "D.M. Kochmann"
            ],
            "title": "Data-driven topology optimization of spinodoid metamaterials with seamlessly tunable anisotropy",
            "venue": "Comput. Methods Appl. Mech. Eng. 383,",
            "year": 2021
        },
        {
            "authors": [
                "A.G. Izard",
                "J. Bauer",
                "C. Crook",
                "V. Turlo",
                "L. Valdevit"
            ],
            "title": "Ultrahigh energy absorption multifunctional spinodal nanoarchitectures",
            "venue": "Small 15, 1903834,",
            "year": 2019
        },
        {
            "authors": [
                "M. R\u00f6ding",
                "V.W. Sk\u00e4rstr\u00f6m",
                "N. Lor\u00e9n"
            ],
            "title": "Inverse design of anisotropic spinodoid materials with prescribed diffusivity",
            "venue": "Sci. Reports 12,",
            "year": 2022
        },
        {
            "authors": [
                "Y. Lou",
                "Rupprecht",
                "J.-F",
                "T. Hiraiwa",
                "T.E. Saunders"
            ],
            "title": "Curvature-induced cell rearrangements in biological tissues",
            "venue": "bioRxiv DOI:",
            "year": 2022
        },
        {
            "authors": [
                "M Werner"
            ],
            "title": "Surface curvature differentially regulates stem cell migration and differentiation via altered attachment morphology and nuclear deformation",
            "venue": "Adv. Sci",
            "year": 2016
        },
        {
            "authors": [
                "A.A. Zadpoor"
            ],
            "title": "Bone tissue regeneration: the role of scaffold",
            "venue": "geometry. Biomater. Sci",
            "year": 2015
        },
        {
            "authors": [
                "Y Zhang"
            ],
            "title": "In silico and in vivo studies of the effect of surface curvature on the osteoconduction of porous scaffolds",
            "venue": "Biotechnol. Bioeng",
            "year": 2022
        },
        {
            "authors": [
                "S.J. Callens",
                "R.J. Uyttendaele",
                "L.E. Fratila-Apachitei",
                "A.A. Zadpoor"
            ],
            "title": "Substrate curvature as a cue to guide spatiotemporal cell and tissue organization. Biomaterials",
            "venue": "DOI: https://doi.org/10.1016/j",
            "year": 1197
        },
        {
            "authors": [
                "Callens",
                "S.J. P"
            ],
            "title": "Emergent collective organization of bone cells in complex curvature fields",
            "venue": "Nat. Commun",
            "year": 2023
        },
        {
            "authors": [
                "A. Song"
            ],
            "title": "Generation of tubular and membranous shape textures with curvature functionals",
            "venue": "J. Math. Imaging Vis. 64,",
            "year": 2021
        },
        {
            "authors": [
                "J.W. Cahn",
                "J.E. Hilliard"
            ],
            "title": "Free energy of a nonuniform system",
            "venue": "i. interfacial free energy. The J. Chem. Phys. 28,",
            "year": 1958
        },
        {
            "authors": [
                "O. Sigmund",
                "K. Maute"
            ],
            "title": "Topology optimization approaches",
            "venue": "Struct. Multidiscip. Optim",
            "year": 2013
        },
        {
            "authors": [
                "R. Garnett"
            ],
            "title": "Bayesian Optimization (Cambridge",
            "year": 2023
        },
        {
            "authors": [
                "L.P. Cinelli",
                "M.A. Marins",
                "E.A.B. da Silva",
                "S.L. Netto"
            ],
            "title": "Variational autoencoder",
            "venue": "(Springer International Publishing,",
            "year": 2021
        },
        {
            "authors": [
                "I Goodfellow"
            ],
            "title": "Generative adversarial nets",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2014
        },
        {
            "authors": [
                "L Yang"
            ],
            "title": "Diffusion models: A comprehensive survey of methods and applications",
            "year": 2023
        },
        {
            "authors": [
                "Bastek",
                "J.-H",
                "S. Kumar",
                "B. Telgen",
                "R.N. Glaesener",
                "D.M. Kochmann"
            ],
            "title": "Inverting the structure\u2013property map of truss metamaterials by deep learning",
            "venue": "Proc. Natl. Acad. Sci. 119,",
            "year": 2021
        },
        {
            "authors": [
                "L Wang"
            ],
            "title": "Deep generative modeling for mechanistic-based learning and design of metamaterial systems",
            "venue": "Comput. Methods Appl. Mech. Eng",
            "year": 2020
        },
        {
            "authors": [
                "M.A. Bessa",
                "P. Glowacki",
                "M. Houlder"
            ],
            "title": "Bayesian machine learning in metamaterial design: Fragile becomes supercompressible",
            "venue": "Adv. Mater",
            "year": 1904
        },
        {
            "authors": [
                "N.N. Vlassis",
                "W. Sun"
            ],
            "title": "Denoising diffusion algorithm for inverse design of microstructures with fine-tuned nonlinear material properties",
            "year": 2023
        },
        {
            "authors": [
                "Y. Mao",
                "Q. He",
                "X. Zhao"
            ],
            "title": "Designing complex architectured materials with generative adversarial networks",
            "venue": "Sci. Adv",
            "year": 2020
        },
        {
            "authors": [
                "G.X. Gu",
                "Chen",
                "C.-T",
                "M.J. Buehler"
            ],
            "title": "De novo composite design based on machine learning algorithm",
            "venue": "Extrem. Mech. Lett. 18,",
            "year": 2017
        },
        {
            "authors": [
                "I Malkiel"
            ],
            "title": "Plasmonic nanostructure design and characterization via deep learning",
            "venue": "Light. Sci. & Appl",
            "year": 2018
        },
        {
            "authors": [
                "A Suwardi"
            ],
            "title": "Machine learning-driven biomaterials evolution",
            "venue": "Adv. Mater. 34,",
            "year": 2021
        },
        {
            "authors": [
                "S. Van \u2019t Sant",
                "P. Thakolkaran",
                "J. Mart\u00ednez",
                "S. Kumar"
            ],
            "title": "Inverse-designed growth-based cellular metamaterials",
            "venue": "Mech. Mater",
            "year": 2023
        },
        {
            "authors": [
                "J.N. Reddy"
            ],
            "title": "Theory and analysis of elastic plates and shells",
            "venue": "(CRC press,",
            "year": 2006
        },
        {
            "authors": [
                "A. Vidyasagar",
                "S. Kr\u00f6del",
                "D.M. Kochmann"
            ],
            "title": "Microstructural patterns with tunable mechanical anisotropy obtained by simulating anisotropic spinodal decomposition",
            "venue": "Proc. Royal Soc. A: Math. Phys. Eng. Sci. 474,",
            "year": 2018
        },
        {
            "authors": [
                "W.E. Lorensen",
                "H.E. Cline"
            ],
            "title": "Marching cubes: A high resolution 3d surface construction algorithm",
            "venue": "SIGGRAPH Comput. Graph",
            "year": 1987
        },
        {
            "authors": [
                "R. Goldman"
            ],
            "title": "Curvature formulas for implicit curves and surfaces",
            "venue": "Comput. Aided Geom. Des",
            "year": 2005
        },
        {
            "authors": [
                "S.J. Callens",
                "R.J. Uyttendaele",
                "L.E. Fratila-Apachitei",
                "A.A. Zadpoor"
            ],
            "title": "Substrate curvature as a cue to guide spatiotemporal cell and tissue organization. Biomaterials",
            "venue": "DOI: https://doi.org/10.1016/j",
            "year": 1197
        },
        {
            "authors": [
                "Y Yang"
            ],
            "title": "Gaussian curvature\u2013driven direction of cell fate toward osteogenesis with triply periodic minimal surface scaffolds",
            "venue": "Proc. Natl. Acad. Sci. 119,",
            "year": 2022
        },
        {
            "authors": [
                "G Tozzi"
            ],
            "title": "Strain uncertainties from two digital volume correlation approaches in prophylactically augmented vertebrae: Local analysis on bone and cement-bone microstructures",
            "venue": "J. mechanical behavior biomedical materials",
            "year": 2017
        },
        {
            "authors": [
                "S. Leoni"
            ],
            "title": "Applications of periodic surfaces for the study of crystal structures, first order phase transitions, force ordering, and systematic generation of novel structure models",
            "venue": "Ph.D. thesis, ETH Zurich",
            "year": 1998
        },
        {
            "authors": [
                "P.J. Gandy",
                "S. Bardhan",
                "A.L. Mackay",
                "J. Klinowski"
            ],
            "title": "Nodal surface approximations to the p,g,d and i-wp triply periodic minimal surfaces",
            "venue": "Chem. Phys. Lett. 336,",
            "year": 2001
        },
        {
            "authors": [
                "H. Karcher",
                "K. Polthier"
            ],
            "title": "Construction of triply periodic minimal surfaces",
            "venue": "Philos. Transactions Royal Soc. London. Ser. A: Math. Phys. Eng. Sci",
            "year": 1996
        },
        {
            "authors": [
                "III W.H. Meeks"
            ],
            "title": "The theory of triply periodic minimal surfaces",
            "venue": "Indiana Univ. Math. J",
            "year": 1990
        },
        {
            "authors": [
                "Yang",
                "S.-D",
                "H.G. Lee",
                "J. Kim"
            ],
            "title": "A phase-field approach for minimizing the area of triply periodic surfaces with volume constraint",
            "venue": "Comput. Phys. Commun",
            "year": 2010
        },
        {
            "authors": [
                "R. Nesper",
                "S. Leoni"
            ],
            "title": "On tilings and patterns on hyperbolic surfaces and their relation to structural chemistry",
            "venue": "ChemPhysChem",
            "year": 2001
        },
        {
            "authors": [
                "Baena-Moreno",
                "F. M"
            ],
            "title": "Stepping toward efficient microreactors for co2 methanation: 3d-printed gyroid geometry",
            "venue": "ACS Sustain. Chem. & Eng",
            "year": 2021
        },
        {
            "authors": [
                "S.C. Kapfer",
                "S.T. Hyde",
                "K. Mecke",
                "C.H. Arns",
                "G.E. Schr\u00f6der-Turk"
            ],
            "title": "Minimal surface scaffold designs for tissue",
            "venue": "engineering. Biomaterials 32,",
            "year": 2011
        },
        {
            "authors": [
                "C. Bonatti",
                "D. Mohr"
            ],
            "title": "Mechanical performance of additively-manufactured anisotropic and isotropic smooth shell-lattice materials: Simulations & experiments",
            "venue": "J. Mech. Phys. Solids 122,",
            "year": 2019
        },
        {
            "authors": [
                "M. Ross"
            ],
            "title": "Schwarz\u2019p and d surfaces are stable",
            "venue": "Differ. Geom. its Appl",
            "year": 1992
        },
        {
            "authors": [
                "X Guo"
            ],
            "title": "Enhancement in the mechanical behaviour of a schwarz primitive periodic minimal surface lattice structure design",
            "venue": "Int. J. Mech. Sci. 216,",
            "year": 2022
        },
        {
            "authors": [
                "C. Ciliberto",
                "M.M. Lopes",
                "X. Roulleau"
            ],
            "title": "On schoen surfaces",
            "venue": "Commentarii Math. Helvetici 90,",
            "year": 2015
        },
        {
            "authors": [
                "V. Shevchenko",
                "S. Balabanov",
                "M. Sychov",
                "L. Karimova"
            ],
            "title": "Prediction of cellular structure mechanical properties with the geometry of triply periodic minimal surfaces (tpms)",
            "venue": "ACS Omega",
            "year": 2023
        },
        {
            "authors": [
                "I Maskery"
            ],
            "title": "Insights into the mechanical properties of several triply periodic minimal surface lattice structures made by polymer additive manufacturing",
            "venue": "Polymer 152,",
            "year": 2018
        },
        {
            "authors": [
                "N. Qiu",
                "Y. Wan",
                "Y. Shen",
                "J. Fang"
            ],
            "title": "Experimental and numerical studies on mechanical properties of tpms structures",
            "venue": "Int. J. Mech. Sci. 108657,",
            "year": 2023
        },
        {
            "authors": [
                "Schr\u00f6der-Turk",
                "G. E"
            ],
            "title": "Minkowski tensor shape analysis of cellular, granular and porous structures",
            "venue": "Adv. Mater",
            "year": 2011
        },
        {
            "authors": [
                "A Paszke"
            ],
            "title": "Pytorch: An imperative style, high-performance deep learning library",
            "venue": "Adv. neural information processing systems",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Smooth and curved microstructural topologies found in nature \u2013 from soap films to trabecular bone \u2013 have inspired several mimetic design spaces for architected metamaterials and bio-scaffolds. However, the design approaches so far have been ad hoc, raising the challenge: how to systematically and efficiently inverse design such artificial microstructures with targeted topological features? Here, we explore surface curvature as a design modality and present a deep learning framework to produce topologies with as-desired curvature profiles. The inverse design framework can generalize to diverse topological features such as tubular, membranous, and particulate features. Moreover, we demonstrate successful generalization beyond both the design and data space by inverse designing topologies that mimic the curvature profile of trabecular bone, spinodoid topologies, and periodic nodal surfaces for application in bio-scaffolds and implants. Lastly, we bridge curvature and mechanics by showing how topological curvature can be designed to promote mechanically beneficial stretching-dominated deformation over bending-dominated deformation."
        },
        {
            "heading": "Introduction",
            "text": "Nature is replete of porous structures with unique curvature topologies \u2013 from the simplest example of soap films with constant mean curvatures (Plateau\u2019s law1, 2) to the morphogenesis-driven Turing patterns3, 4 in animal skin pigmentation; from biological systems such as trabecular bone5\u20137 and vascular networks8, 9 to non-biological systems like porous ceramics, nanoporous gold10, and block copolymers11 (see Figure 1). Driven by complex relaxation dynamics and non-equilibrium phenomena such as self-assembly12\u201314, pattern formation15\u201317, and phase ordering kinetics18, 19, both understanding and tuning such physics behind the natural emergence of complex curvature topologies opens up new avenues for advances in materials engineering.\nFor instance, mimicking the microstructural curvature topologies of nanoporous gold and phase-separated block copolymers, spinodoid metamaterials11, 24\u201326 have sparked significant interest for their potential applications in bio-implants27, lightweight structures28, energy absorption29, mass transport30, and more. The microstructure of these materials emerges from a spinodal decomposition process (i.e., rapid separation of immiscible phases) via either self-assembly11 or combination of in-silico design and 3D-printing25. In spinodal decomposition, the phase separation is governed by minimization of the bulk free energy while regulated by the interfacial energy between the phases; the latter being intricately related to the interfacial curvatures. The resulting curvature topology promotes stretching-dominated deformation, which is stronger than bending-dominated deformation; therefore, exhibits excellent mechanical resilience11, 26. However, how to (in silico) tune the physics of spinodal decomposition to obtain tailored curvature topologies for favorable mechanics remains an open question.\nA similar curvature design challenge is gaining attention in the field of bio-scaffolds and implants. Substrate curvatures play a significant role in inducing spatiotemporal growth, differentiation, and migration of biological cells and tissues31\u201336. For example, metamaterials based on triply periodic minimal surfaces (TPMS) gained popularity in the design of bone implants as they were believed to mimic the zero mean curvature of trabecular bone and in turn, enhance the long-term compatibility. However, a recent study5 has challenged this assumption, revealing that trabecular bone displays a complex curvature profile instead, with significant variations across patients and\nar X\niv :2\n30 9.\n00 16\n3v 1\n[ cs\n.C E\n] 3\n1 A\nug 2\n02 3\nanatomical sites. This highlights the need to develop porous structures with tunable curvature topologies, not only for bone implants but also for cell scaffolds that can adapt to diverse patient- and (anatomical) site-specific contexts.\nDespite a wide variety of explorations ranging from TPMS to spinodoid metamaterials, a more general and unified topology description of smooth porous microstructures remains to be investigated. In this direction, Song37 recently proposed a unifying phase-field framework to generate tubular and membranous topologies with diverse curvature profiles. Similar to the canonical spinodal decomposition model38, topologies within this framework are obtained as optimizers (subject to constant volume restriction) of energy functionals parameterized based on principal curvatures of the phase-field interface. While this approach opens up a design space to control curvature topology, key challenges persist. (i) Exploring the entire design-property space is nearly impossible because each topology requires a computationally expensive phase-field simulation. The characterization of the microstructural curvature profile by a high-dimensional probability distribution of principal curvatures further exacerbates the situation. (ii) Although the curvature profile of a given topology is unique and simple to obtain, the inverse design, i.e., identifying a microstructural topology with a targeted curvature profile remains an open challenge. This is due to the ill-posedness of the inverse problem, i.e., multiple topologies with different design parameters may display the identical or similar curvature profiles, making it difficult to identify the optimal design. In addition, traditional design approaches such as topology optimization39 are not only computationally expensive, but they may also not be applicable to design for an unconventional target property, such as the microstructural curvature profile.\nTo overcome this limitation, we introduce a machine learning (ML) framework for generating smooth porous microstructures with inverse-designed curvature profiles (see Figure 1). By analyzing vast amounts of experimental and computational data, ML algorithms can bypass inefficient trial-and-error methods and efficiently unravel hidden high-dimensional structure-property relations, leading to the design of novel materials with tailored properties. Employing a diverse array of ML techniques \u2013 from classical Bayesian optimization40 to modern approaches such as variational autoencoders41, generative adversarial networks42, and diffusion models43 \u2013 recent applications span a wide range of domains, including mechanical metamaterials26, 44\u201348, composites49, photonics50, biomaterials51, and more. In the context of metamaterials and porous materials, while mechanical properties such as stiffness, Poisson\u2019s ratio, buckling modes, diffusivity, wave propagation, etc. have been inverse-designed, microstructural curvature as a\n2/23\ndesign modality has not been explored. To this end, we enable instant identification of microstructural topologies with precise targeted curvature profiles and unlock new possibilities in design of metamaterials and porous microstructures. We achieve this by strategically using a dual deep neural network (NN) setup26, 44, 52 in tandem with a phase-field framework driven by curvaturebased energetics37 that bypasses both the aforementioned key challenges \u2013 namely, the computational bottleneck of phase-field methods and the ill-posedness in inverse design.\nWith the ability to generate tailored microstructural curvature profiles, we further investigate the interlink between curvature and mechanics. The membrane-flexural coupling appearing in the mechanics of shell/curved structures is strongly linked with their principal curvatures53, i.e., the redistribution of applied loads in the form of bending and stretching/compressive loads depends on the two principal curvatures of a curved surface. For a selection of micro-architectures with diverse curvature profiles, we study this load redistribution by decomposing the stored strain energy into membrane and bending strain energies. Since a dominance of membrane deformation over bending deformation is known to promote higher mechanical resilience, the study of ratios of membrane to bending strain energies for diverse curvature profiles can guide the design of superior mechanical metamaterials through the presented inverse design approach.\nIn the following, we first introduce the design space and discuss the phase-field approach for topology generation. Subsequently, we introduce the ML framework for inverse design. Next, we demonstrate successful inverse design generalization for target curvatures beyond those in the training domain and show application to the design of topologies that mimic trabecular bone, spinodoid surfaces, and nodal surfaces. Lastly, we present mechanical aspects of the curvature based microstructures by investigating a set of topologies with diverse curvature profiles for their distribution of membrane and bending strain energies."
        },
        {
            "heading": "Results",
            "text": "Design space from curvature-based energy functional We adopt the curvature-based phase-field framework of Song37 which makes it possible to unify topologies with spherical, tubular, and membranous features as well as their combinations with seamless transition. Briefly, for a given surface S , we consider a energy functional F based on the surface curvatures as\nF [S ] = \u222b\nS f [S]dS with f [S] = a20\u03ba21 +a11\u03ba1\u03ba2 +a02\u03ba 2 2 +a10\u03ba1 +a01\u03ba2 +a00, (1)\nwhere the integrand f [S] (i.e., surface energy density) is a second-degree polynomial of the principal curvatures \u03ba1,\u03ba2 (by convention, \u03ba1 \u2265 \u03ba2) at the point S on the surface S and parameterized by the coefficients {a20,a11,a02,a10,a01,a00}. Similar to energy functional of the canonical Cahn-Hilliard equation26, 38, 54, minimizing this energy functional represents a compromise between minimizing the bending energy vs. the surface area. The energy functional is minimized under constant volume constraint and periodic boundary conditions to yield diverse topologies. The energy minimization can be approximated by a phase-field model using a mass-preserving H\u22121 gradient flow of a two-phase system as\nu\u0307 = \u2206 \u2202F\u03b5 \u2202u (u) with m0 = 1 |\u2126| \u222b \u2126 udV, (2)\nwhere u : \u2126\u2192 [\u22121,1] denotes the phase field, i.e., a concentration field of one phase in the domain \u2126. Without loss of generality, we assume a non-dimensionalized domain \u2126 = [0,100]3 (consequently, all subsequent length dimensions are normalized relative to the domain size). We assume the phase field contains diffused interfaces with a hyperbolic tangent profile and thickness lengthscale of \u03b5 \u226a 1. F\u03b5 is the corresponding phase-field approximation of F . m0 denotes the constant volume constraint. u is initialized with random noise. After solving the gradient flow problem, the final surface S is extracted by applying the zero level set on the resulting phase field. The zero level set is not obtained exactly but rather approximated as a triangular surface mesh S\u0302 by using the marching cubes algorithm55. Figure 2a shows a schematic of the topology generation process.\n3/23\n4/23\nWithin the phase-field approximation, we speak of diffused curvatures (or curvatures of diffused interfaces). Since the phase field u has a hyperbolic tangent profile, the diffused principal curvatures correspond precisely to the respective principal curvatures56 at level sets of u. Detailed mathematical proof of phase-field approximation as well as implementation details can be found in the ref.37.\nLet \u0398 = (a20,a11,a02,a10,a01,a00,m0)\u22ba be a vector of the design parameters that uniquely characterize the gradient flow and hence, the topology generation. Note that the topologies are still stochastic due to the random initial conditions. Figure 2b shows a representative selection of diverse topologies and their corresponding curvature profiles obtained for different values of \u0398.\nFor the curvature profile to be interpretable to the NN-based design algorithm, we create an encoding of the curvature profile for a given meshed surface S\u0302 . We define the probability of S\u0302 containing the principal curvatures (\u03ba1,\u03ba2) as\np(\u03ba1,\u03ba2|S\u0302 ) = \u2211ei=1 \u03b4\n( (\u03ba1,\u03ba2),(\u03ba\u03021,i, \u03ba\u03022,i) ) a\u0302i\n\u2211ei=1 a\u0302i , (3)\nwhere \u03b4 denotes the Kronecker delta, e is the total number of elements, and a\u0302i and (\u03ba\u03021,i, \u03ba\u03022,i) denote the area and principal curvatures of the ith element in the mesh, respectively. Next, we discretize this probability distribution in \u03ba1-\u03ba2 on a uniform grid of 200\u00d7 200 bins (i.e., a two-dimensional histogram) yielding a [0,1]200\u00d7200 matrix encoding of the curvature profile. Note that this discrete probability matrix is lower-triangular due to the convention of \u03ba1 \u2265 \u03ba2. To reduce the computational cost, the lower-triangular part is serialized into a k = 20,100-dimensional encoding \u03c7 \u2208 [0,1]k, which is used in the downstream ML tasks.\nGeometric interpretation of the design space The parameters {a20,a11,a02,a10,a01,a00} in \u0398 admit a characteristic geometric interpretation that directly correlates to the curvature profile of the resulting microstructure. The surface energy density in (1) can be reformulated as a quadratic surface in the \u03ba1-\u03ba2- f space such that\nf [S] = g(\u03ba\u0303 \u22baM \u03ba\u0303 \u2212 c) with \u03ba\u0303 = (\ncos\u03b8 sin\u03b8 \u2212sin\u03b8 cos\u03b8 ) \ufe38 \ufe37\ufe37 \ufe38\nrotation\n( \u03ba1\u2212\u03bac1 \u03ba2\u2212\u03bac2 ) \ufe38 \ufe37\ufe37 \ufe38\ntranslation\nand M = (\n1 0 0 \u03b1 ) \ufe38 \ufe37\ufe37 \ufe38 aspect ratio . (4)\nHere, (\u03bac1 ,\u03ba c 2) \u22ba \u2208 R2, \u03b8 \u2208 [\u2212\u03c0/2,\u03c0/2), and \u03b1 \u2208 R represent the translation, (counter-clockwise) rotation, and aspect ratio in the \u03ba1-\u03ba2 plane, respectively. The parameters c \u2208 R and g \u2208 R+ denote a vertical translation or bias along f and scaling factor, respectively; the latter does not affect the interrelations between the individual curvature terms of the overall energy density. Supplementary Information Section 1 provides conversion formulas between the design parameters \u0398 and the equivalent geometrically interpretable ones, i.e., \u0398\u0303 = (\u03bac1 ,\u03ba c 2 ,\u03b8 ,\u03b1,c,g,m0)\n\u22ba. In the cases when \u03b1 is positive, zero, and negative, the quadratic surface is respectively an elliptic paraboloid, parabolic cylinder, and hyperbolic paraboloid, and consequently, produce elliptic, linear, and hyperbolic contours on the \u03ba1-\u03ba2 plane. Figure 3 illustrates how the combination of rotation, translation, and aspect ratios yields a rich design space of surface energy densities.\nThe geometric interpretation of the surface energy density is reflected in the curvature profiles as the density plots are aligned with the contours of the quadratic surface of the surface energy density (see Figure 3 for representative examples). This is expected as the hot spots in the density plots qualitatively correspond to the regions of low surface energy density with respect to the principal curvatures."
        },
        {
            "heading": "Data-driven inverse design",
            "text": "In light of the above relation between the design parameters and the curvature profile, we aim to invert this designproperty space, i.e., identify the optimal \u0398 to achieve a target curvature profile. However, as discussed earlier, there are two key challenges: (i) the phase-field approach for topology generation is computationally expensive and therefore, a trial-and-error approach to inverse design is intractable; (ii) the inverse design problem is ill-posed as\n5/23\n6/23\nmultiple designs can have similar curvature profiles. To this end, we introduce a dual deep-NN setup (see Figure 4a for a schematic). A forward NN first surrogates the phase-field framework and maps the design parameters to the resulting microstructural curvature profile. An inverse NN then inverts the above design-to-curvature map and outputs the appropriate design parameters (and corresponding phase-field energetics) required for a targeted curvature profile.\nWe start by creating a representative training dataset D = {{\u0398(i),\u03c7 (i)}, i = 1, . . . ,n} consisting of n = 18,000 pairs of design parameters \u0398 and the corresponding curvature profiles encoded as \u03c7 . Since the probability encodings can be sparse and skewed in distribution, we perform independent nonlinear scaling on the individual components of \u03c7 to enhance the sensitivity of the downstream ML approach. Supplementary Information Section 2 provides further details on the aforementioned data sampling and scaling strategy.\nLet F\u03c9 : R7\u2192 Rk denote a forward NN (f -NN) with a multi-layer perceptron architecture parameterized by the set of trainable weights and biases \u03c9 . f -NN bypasses the phase-field evolution and directly maps the design parameters \u0398 to the curvature encoding \u03c7 = F\u03c9 [\u0398]. Since each design has a unique curvature profile (in the sense of averaging across the stochastic effects in topology generation), the forward problem is well-posed. Therefore, we train the f -NN by minimizing the (mean squared error) loss between the true and predicted curvature encodings with\n7/23\nrespect to the f -NN-parameters \u03c9 , i.e.,\nF\u03c9 \u2190min\u03c9 1 n\nn\n\u2211 i=1 \u2225F\u03c9 [\u0398(i)]\u2212\u03c7 (i)\u22252. (5)\nWe now tackle the inverse challenge. Let G\u03c4 : Rk \u2192 R7 denote an inverse NN (i-NN) with a multi-layer perceptron architecture parameterized by the set of trainable weights and biases \u03c4 . The i-NN maps an input target curvature encoding \u03c7 to the design parameters \u0398 = G\u03c4 [\u03c7 ]. However, unlike the f -NN, a training strategy analogous to (5) fails due to the ill-posedness of the inverse problem. E.g., a high value of the naive loss \u2225G\u03c4 [\u03c7 ]\u2212\u0398\u22252 may indicate that the design parameters predicted by the i-NN and the ones from the dataset are different but does not hint anything about the possibility that these dissimilar designs may have similar curvature profiles. To counter this issue, we train the i-NN against the pre-trained f -NN as\nG\u03c4 \u2190min\u03c4 1 n\nn\n\u2211 i=1 \u2225F\u03c9 [G\u03c4 [\u03c7 (i)]]\u2212\u03c7 (i)\u22252. (6)\nFor the design predicted by the i-NN, i.e., G\u03c4 [\u03c7 (i)], the f -NN reconstructs the curvature encoding \u03c7 \u2217 =F\u03c9 [G\u03c4 [\u03c7 (i)]]; the loss of \u03c7 \u2217 relative to the target \u03c7 from the dataset is minimized with respect to the i-NN parameters \u03c4 .\nWe train both NNs using gradient-based optimization. During i-NN training, the f -NN not only surrogates the computationally expensive phase-field evolution for curvature reconstruction, but also provides a differentiable map between \u0398 and \u03c7 . This differentiability is critical to computing the gradient \u2202F\u03c9/\u2202\u0398 which is in turn required for computing the sensitivity of the loss function in (6) with respect to the i-NN parameters \u03c4 during training. Supplementary Information Section 3 provides additional implementation details as well as computational costs associated with both the NNs.\nTo evaluate the performance of the inverse design framework, we create an additional test dataset of 2,000 design parameters and curvature encoding pairs, previously not seen by either of the NNs during training. Figure 4b shows that both f -NN and i-NN achieve high accuracy (indicated by the low loss values) across both training and test datasets without the presence of any under-/overfitting. A gallery of 21 representative examples in Figure 5 shows exceptional agreement in the target curvature profiles versus the curvature profiles of the designs predicted by the i-NN, thereby providing qualitative evidence of the accuracy of the inverse design approach. Figure 6 shows three additional examples along with a comparison of the design parameters \u0398 (and the resulting topology) in the dataset and the ones predicted by the i-NN. While the target and reconstructed curvature profiles are in agreement with each other, the design parameters are significantly different. This verifies the ill-posedness of the inverse problem and the advantage of the i-NN training strategy in (6).\nGeneralization beyond the training space To demonstrate the generalization ability of our approach, we inverse design the topologies for tailored curvature profiles that are representative of three different (meta-)material/structural classes.\n(i) Benchmark 1: Trabecular bone. Recent works57, 58 have shown the important role of substrate curvature in growth of bone cells on additively manufactured implants. Motivated by this, we target the microstructural topology of bone to benchmark our inverse design framework. Specifically, we consider a trabecular bone sample from Tozzi et al.59 (see Figure 7a). The microstructural data is available as grayscale 3D-voxelated image obtained directly from micro-computed tomography. We extract the surface representation of the trabecular bone sample by using an appropriate image processing and smoothing algorithm, the details of which are provided in Supplementary Information Section 4.\n(ii) Benchmark 2: Spinodal decomposition. Diffusion-driven spinodal decomposition in a binary phase system can produce complex and diverse topologies (which are also used in spinodoid metamaterials26). Here, we briefly review the formulation of topologies emergent from spinodal decomposition and refer to refs.26, 28\n8/23\n9/23\n10/23\nfor details. The early stage of a spinodal decomposition process is mathematically described by a Gaussian Random Field (GRF), i.e., a linear superposition of Q\u226b 1 standing waves:\n\u03d5(x) = \u221a 2 Q Q \u2211 q=1 cos(\u03b2vq \u00b7 x+ \u03b3q), (7)\nwhere \u03d5 : \u2126\u2192R and \u03b2 > 0 denote a phase field and a constant wavenumber, respectively; the latter determines the microstructural lengthscale of the former. vq and \u03b3q denote, respectively, the wave vector and phase angle of qth standing wave and are randomly and uniformly sampled as\nvq \u223cU ({ v \u2208 S2 : (|v \u00b7 e\u03021|> cos\u03b81)\u2295 (|v \u00b7 e\u03022|> cos\u03b82)\u2295 (|v \u00b7 e\u03023|> cos\u03b83) }) , \u03b3p \u223cU ([0,2\u03c0)), (8)\nwhere {e\u03021, e\u03022, e\u03023} denote S2 is the set of all unit vectors. Parameters \u03b81,\u03b82,\u03b83 \u2208 [0,\u03c0/2) restrict the directional distribution of the wave vectors to respective angles from the Cartesian basis vectors. This parametric distribution is interpreted as anisotropic mobility along preferred directions during the spinodal decomposition process. The final topology is obtained by extracting the phase interface which is given by a level set as\n\u03d5 = \u221a 2erf\u22121(2\u03c1\u22121), (9)\nwhere \u03c1 \u2208 [0,1] is the volume fraction of one of the phases. For the purpose of this benchmark, we generate a spinodoid topology (see Figure 7b) with \u03b2 = 15\u03c0 , Q = 1000, \u03b81 = 60\u25e6, \u03b82 = 30\u25e6, \u03b83 = 10\u25e6, and \u03c1 = 0.3.\n(iii) Benchmark 3: Periodic nodal surfaces (PNS). These are smooth implicit surfaces composed of Fourier series components60, 61 and are widely studied across different fields in mathematics62\u201364, chemistry60, 65, 66, mechanics67, 68, and more. PNS are particularly popular as closed-form approximations of minimal surfaces (i.e., zero mean curvature) such as the famous Schwarz69, 70 and Schoen71, 72 surfaces. Since minimal surfaces present a curvature distribution (\u03ba2 = \u2212\u03ba1) trivial for a benchmark, here we consider a non-minimal PNS given by\nsin(x)sin(1.8y)+ sin(y)sin(1.8z)+ sin(z)sin(1.8x) = 0.5 (10)\nand visualized in Figure 7c.\nAcross all the three benchmarks, we scale the topologies to the same domain size as \u2126 and extract the curvature profile which is passed as a design target to the i-NN. For each benchmark, the i-NN successfully predicts a topology with a curvature profile that closely matches the target (see Figure 7 and Supplementary Information Section 5). Remarkably, the i-NN achieves this despite no prior information about trabecular bone, spinodal decomposition, or PNS topologies during the training stage and indicates excellent generalization well beyond the scope of the training dataset. The i-NN is also able to design for similar curvature profiles despite key geometrical differences such as periodicity (in the PNS benchmark) and anisotropy (in all three benchmarks) in the target, which highlights further the ill-posedness of the inverse design challenge and the benefit of the proposed approach. In addition, the generalization capability is particularly useful for bio-mimetic implants and scaffolds where large training datasets (of e.g., bone) are particularly scarce, and small amounts of patient-/site-specific data can be used for fine-tuning or transfer learning of the pre-trained i-NN for improved accuracy."
        },
        {
            "heading": "Curvature determines mechanics",
            "text": "For slender structures \u2013 both natural (e.g., skull, egg shells, sea shells) and man-made (e.g., aircraft fuselage, pressure vessels, domes), curved geometries are preferred as structural elements over flat ones due to their ability to redistribute applied loads into the stronger in-plane stretching-dominated behavior as opposed to the weaker out-of-plane bending-dominated behavior11. In the light of microstructures with tailorable curvature profiles, we explore this interplay between curvature and mechanics across our design space.\n11/23\nSpecifically, we consider five representative topologies with diverse curvature profiles (see Figure 8) obtained from the inverse design strategy. We model each topology as a shellular structure with the shell thickness equal to 1% of the domain length (recall \u2126 = [0,100]3) and made of a linearly elastic material with Poisson\u2019s ratio of 0.3 and a unit Young\u2019s modulus. Note that we restrict ourselves to curvature distributions that admit bicontinuous topologies only as it would be physically required for a self-standing shellular structure. We perform finite element analysis of the shellular structure undergoing quasi-static uniaxial tension. The choice of Young\u2019s modulus and applied load are arbitrary as they do not affect the following analysis.\nFor each case, we investigate the distribution of the total in-plane membrane strain energy Em and out-of-plane bending strain energy Eb (obtained by summing over the membrane and bending strain energies of all the shell elements, respectively). Figure 8a shows the spatial distribution of the normalized membrane strain energy, i.e., E\u0303m = Em/(Em +Eb), with E\u0303m = 1 and E\u0303m = 0 denoting pure stretching- and bending-dominated deformations respectively. In Figures 8b and 8c, the topologies with curvature distribution closer to zero mean curvature (first and third row) show higher mean and median in the distribution of E\u0303m, relative to the others, indicating higher stretching-dominated deformation. Figures 8d further shows the distribution of element-wise E\u0303m with respect to the mean and Gaussian curvature. Notably, elements with or close to zero mean curvature predominantly store stretching-dominated energy, which largely corroborates the beneficial mechanical properties of TPMS observed across several prior works73\u201375."
        },
        {
            "heading": "Discussion",
            "text": "The presented framework enables inverse design of smooth topologies with tailored curvature profiles. This is achieved by training a dual deep-NN setup to surrogate a phase field driven by a curvature-based energy functional and then invert the process. Our approach provides excellent generalization beyond both the design space as well as the space of the training data \u2013 as evidenced by successful reconstruction of curvature of topologies from different\n12/23\ndata sources, including microtomography of trabecular bone, spinodal surfaces, and implicit nodal surfaces. Notably, the ML framework achieves accurate reconstructions without any prior knowledge about these structures and their symmetries during the learning phase. Linking with mechanics, the analysis of strain energy distribution reveals a correlation between curvature profile and stretching vs. bending dominated deformations, which can be exploited for tailoring the topology for improved mechanical resilience. Overall, our framework unlocks curvature as a new design modality with applications in mechanical metamaterials and bio-scaffolds/implants. Future directions of interest may include incorporating anisotropic and higher-order curvature descriptors (such as Minkowski functionals76) for improved design fidelity and integrating topology curvature with nonlinear mechanical response in inverse design."
        },
        {
            "heading": "Methods",
            "text": "Details of the geometric interpretation of the design space (Section 1), data sampling and scaling strategy (Section 2), implementation details of f -NN and i-NN (Section 3), smoothing algorithm for the trabecular bone benchmark (Section 4), and additional benchmark results (Section 5) are presented in the Supplementary Information."
        },
        {
            "heading": "Code availability",
            "text": "The codes generated during the current study are available at <link will be provided at time of publication>."
        },
        {
            "heading": "Data availability",
            "text": "The datasets generated during the current study are available at <link will be provided at time of publication>."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Acknowledgement",
            "text": "Y. Guo gratefully acknowledges financial support from the China Scholarship Council (No. 202006260125)."
        },
        {
            "heading": "1 Geometric interpretation of the design space",
            "text": "The standard design parameters \u0398 in the curvature-based energy functional can be obtained in terms of the geometrically interpretable but equivalent parameters \u0398\u0303 as:\na20 = g(1+\u03b1\u2212\u03b1 cos2\u03b8 + cos2\u03b8) 2 a11 = g(1\u2212\u03b1)sin2\u03b8 a02 = g(1+\u03b1 +\u03b1 cos2\u03b8 \u2212 cos2\u03b8) 2 a10 =\u2212g [ (1+\u03b1)\u03bac1 +(1\u2212\u03b1)\u03bac1 cos2\u03b8 +(1\u2212\u03b1)\u03bac2 sin2\u03b8\n] a01 =\u2212g [ (1+\u03b1)\u03bac2 +(\u03b1\u22121)\u03bac2 cos2\u03b8 +(1\u2212\u03b1)\u03bac1 sin2\u03b8\n] a00 = g [ (1+\u03b1)(\u03bac21 +\u03ba c2 2 )+(1\u2212\u03b1)(\u03bac21 \u2212\u03bac22 )cos2\u03b8 +2\u03bac1\u03bac2(1\u2212\u03b1)sin2\u03b8 \u22122c ] 2\n(11)"
        },
        {
            "heading": "2 Data sampling and scaling strategy",
            "text": "To generate the training dataset, we randomly sample the design parameters \u0398. However, some combinations of the design parameters may lead to energetics that do not result in phase separation, or the convergence of the phase-field approximation might not be achieved, rendering not all possible \u0398 physically valid37. Through trialand-error with 1000 attempts, we identify that the domain a20 \u2208 [0,1], a11 \u2208 [\u22122,2], a02 \u2208 [0,1], a10 \u2208 [\u2212200,200], a01 \u2208 [\u2212200,200], a00 \u2208 [\u22125000,5000] and m0 \u2208 [\u22120.8,\u22120.15] provides feasible energetics with high probability and sufficient diversity. We perform uniform random sampling of \u0398 in this domain and discarding those which result in infeasible energetics, following which the topology and curvature profile (equivalently, curvature encodings \u03c7 ) are computed using the open-source implementation of ref.37 Supplementary Figure 1 illustrates the distribution of the components of \u0398 in the dataset.\nFor efficient ML model training, we independently scale each design parameter in \u0398 \u2208 R7 using their corresponding minimum and maximum values in the training dataset as\n\u0398sj = \u0398 j\u2212mini\u2208D \u0398\n(i) j\nmaxi\u2208D \u0398 (i) j \u2212mini\u2208D \u0398 (i) j\n, \u2200 j = 1 . . .7. (12)\nThe curvature encodings in \u03c7 \u2208 [0,1]k, however, can be highly sparse and exhibit a distribution that is heavily skewed near the values equal to zero and one(see Supplementary Figure 2a). Therefore, we perform an independent nonlinear scaling for each component given by\n\u03c7sj = h(\u03c7 j) with h(\u03c7 j) = ln(\u03c7 j\u2212a)\nb + c, \u2200 j = 1, . . . ,k, (13)\n19/23\nSupplementary Figure 1. Distribution of components of \u0398 in the dataset before scaling.\nwhere the constants a,b,c are uniquely determined such that h(0) = 0, h ( Median ({\nmax i\u2208D\n\u03c7(i)j : j = 1, . . . ,k })) = 0.5, h(1) = 1. (14)\nThe scaling ensures that the lower and upper bound of the data remain at zero or one, while the median of the maximum value of each curvature encoding over the whole dataset is mapped to a value of 0.5. After scaling, the small values near zero get raised and the distribution becomes significantly less skewed (see Supplementary Figure 2b). The scaled design parameters and curvature encodings, i.e., \u0398s and \u03c7 s are then used for training of the ML models."
        },
        {
            "heading": "3 Machine learning protocols and computing times",
            "text": "Supplementary Table 1 summarizes the protocols (such as learning rate, optimizer, batch size etc.) for training of the f -NN and i-NN. The f -NN and i-NN consist of several hidden layers of different dimensions with each followed by an activation function (see Supplementary Table 1 and Supplementary Figure 3). Here, we use the rectified linear unit77 (ReLU) as the activation function (ReLU(\u00b7) = max(0, \u00b7)). Since each component of both the normalized design parameters \u0398s and normalized curvature encoding \u03c7 s is bounded in [0,1], we use a scaled version of ReLU677, i.e., ReLU6(\u00b7)/6 = min(max(0, \u00b7),6)/6 as the last activation layer (before output) for both i-NN and f -NN. This serves as an inductive bias by identically satisfying the output bounds of both the NNs and therefore, improves the training efficiency.\nSupplementary Table 2 presents the computing times as well as software and hardware used for different tasks. Notably, the fast prediction time of the surrogate f -NN compared to the phase-field model is key to making the i-NN training possible. Despite the one-time cost of data generation and training, both f -NN and i-NN \u2013 once trained \u2013 provide instant exploration of both the design-to-curvature and curvature-to-design maps."
        },
        {
            "heading": "4 Processing 3D-voxelated image data of trabecular bone",
            "text": "Benchmark 1 (see main article) tests the generalization capability of the inverse design framework on trabecular bone. However, the raw data of trabecular bone from micro-computed tomography is in the form of voxelization-based 3D\n20/23\nSupplementary Figure 2. Distribution of maximal value of each component of curvature encodings in the dataset: (a) before and (b) after scaling.\nSupplementary Figure 3. Architectures of the (a) f -NN and (b) i-NN models. The dimension of each input, output, or hidden layer is denoted by the number above it.\n21/23\nf -NN i-NN Hidden layer dimensions 50, 150, 300, 600, 1200, 2500, 5000, 10000, 20000 5000, 1000, 200, 40\nActivation functions ReLU6/6 for output layer; ReLU otherwise ReLU6/6 for output layer; ReLU otherwise Input data scaling min-max (see (12)) custom nonlinear scaling (see (13))\nOptimizer Adam78 Adam78\nLearning rate 10\u22124 10\u22124\nBatch size 128 128 Number of epochs 220 600\nDropout none none\nSupplementary Table 1. Training protocols for the f -NN and i-NN models.\nTask Software Hardware Runtime Generating one topology using the phase-field model PyTorch CPU+GPU 2 minutes per sample\nTraining f -NN PyTorch CPU+GPU 1.5 hours Training i-NN PyTorch CPU+GPU 3 hours\nDesign parameters prediction using i-NN PyTorch CPU+GPU <1 second\nSupplementary Table 2. Task-wise breakdown of compute runtime, software, and hardware used. We note that the runtimes reported are rough estimates only and may vary across different computing hardware. Here, we used two 3.0 GHz 24-core Intel Xeon Gold 6248R processors with combined 256GB DDR4 memory and a Nvidia RTX A5000 GPU with 24GB memory.\nimage, which is too rough for estimating the surface curvature profile. To obtain a smooth surface, we first apply a min-max scaling on the grayscale 3D image, followed by a 3D transposed convolution and a 3D convolution operation. The latter are implemented via PyTorch functions with the following parameters:\n\u2022 Transposed convolution: ConvTranspose3d() with kernel size=(4,4,4), stride=(2,2,2), and padding=(1,1,1);\n\u2022 Convolution: Conv3d() with kernel size=(3,3,3), stride=(2,2,2), and padding=(1,1,1).\nAll the kernel weights (in both convolution layers) are set equal to one, which \u2013 in addition to small kernel size, stride, and padding \u2013 effectively applies localized smoothing of the solid-void interface. The resulting smoothed data is then passed through a hyperbolic tangent transformation, followed by the application of a zero level set to compute the trabecular bone surfaces."
        },
        {
            "heading": "5 Additional benchmark results",
            "text": "In addition to Figure 7 of the main article, here we present another set of inverse design benchmarks in Supplementary Figure 4 \u2013 including trabecular bone, spinodoid structure, and PNS surface. All the parameters and data processing protocols remain the same as those discussed in the main article, with the exception of only the parameters explicitly mentioned in Supplementary Figure 4. The observations regarding the performance and generalization of the i-NN here are consistent with the observations in the main article.\n22/23\nSupplementary Figure 4. Additional inverse design benchmarks including (a) trabecular bone, (b) spinodoid structure, and (c) PNS surface.\n23/23"
        }
    ],
    "title": "Inverse designing surface curvatures by deep learning",
    "year": 2023
}