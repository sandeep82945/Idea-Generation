{
    "abstractText": "Terahertz time-domain spectroscopy (THz-TDS) employs sub-picosecond pulses to probe dielectric properties of materials giving as a result a 3-dimensional hyperspectral data cube. The spatial resolution of THz images is primarily limited by two sources: a non-zero THz beam waist and the acquisition step size. Acquisition with a small step size allows for the visualisation of smaller details in images at the expense of acquisition time, but the frequency-dependent point-spread function remains the biggest bottleneck for THz imaging. This work presents a superresolution approach to restore THz time-domain images acquired with medium-to-big step sizes. The results show the optimized and robust performance for different frequency bands (from 0.5 to 3.5 THz) obtaining higher resolution and additionally removing effects of blur at lower frequencies and noise at higher frequencies.",
    "authors": [
        {
            "affiliations": [],
            "name": "Marina Ljubenovi\u0107"
        },
        {
            "affiliations": [],
            "name": "Alessia Artesani"
        },
        {
            "affiliations": [],
            "name": "Stefano Bonetti"
        },
        {
            "affiliations": [],
            "name": "Arianna Traviglia"
        }
    ],
    "id": "SP:4043003f9e5519e9f1044bdabf4ad96b23bf72f3",
    "references": [
        {
            "authors": [
                "K. Ahi"
            ],
            "title": "Mathematical Modeling of THz Point Spread Function and Simulation of THz Imaging Systems",
            "venue": "IEEE Transactions on Terahertz Science and Technology, vol. 7, no. 6, pp. 747\u2013754, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "T. Wong",
                "M. Kahl",
                "P. Haring Bol\u0131\u0301var",
                "A. Kolb"
            ],
            "title": "Computational Image Enhancement for Frequency Modulated Continuous Wave (FMCW) THz Image",
            "venue": "Journal of infrared, millimeter and terahertz waves, vol. 40, p. 775\u2013800, 07 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Y. Li",
                "L. Li",
                "A. Hellicar",
                "Y.J. Guo"
            ],
            "title": "Super-resolution reconstruction of terahertz images",
            "venue": "Terahertz for Military and Security Applications VI, J. O. Jensen, H.-L. Cui, D. L. Woolard, and R. J. Hwu, Eds., vol. 6949, International Society for Optics and Photonics. SPIE, 2008, pp. 144 \u2013 152. [Online]. Available: https://doi.org/10.1117/12.777814",
            "year": 2008
        },
        {
            "authors": [
                "D.C. Popescu",
                "A.D. Hellicar"
            ],
            "title": "Point Spread Function Estimation for a Terahertz Imaging System",
            "venue": "EURASIP Journal on Advances in Signal Processing, vol. 2010, no. 1, p. 575817, 2010. [Online]. Available: https://doi.org/10.1155/2010/575817",
            "year": 2010
        },
        {
            "authors": [
                "L.-M. Xu",
                "W. Fan",
                "J. Liu"
            ],
            "title": "High-Resolution Reconstruction for Terahertz Imaging",
            "venue": "Applied Optics, vol. 53, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "L. Xu",
                "J.S.J. Ren",
                "C. Liu",
                "J. Jia"
            ],
            "title": "Deep Convolutional Neural Network for Image Deconvolution",
            "venue": "Advances in Neural Information Processing Systems 27. Curran Associates, Inc., 2014, pp. 1790\u20131798.",
            "year": 2014
        },
        {
            "authors": [
                "M. Ljubenovi\u0107",
                "S. Bazrafkan",
                "J.D. Beenhouwer",
                "J. Sijbers"
            ],
            "title": "CNNbased Deblurring of Terahertz Images",
            "venue": "Proceedings of the 15th International Joint Conference on Computer Vision, Imaging and Computer Graphics Theory and Applications (VISAPP), vol. 4, 2020, pp. 323\u2013330.",
            "year": 2020
        },
        {
            "authors": [
                "Y. Li",
                "W. Hu",
                "X. Zhang",
                "Z. Xu",
                "J. Ni",
                "L.P. Ligthart"
            ],
            "title": "Adaptive terahertz image super-resolution with adjustable convolutional neural network",
            "venue": "Optics Express, vol. 28, no. 15, pp. 22 200\u201322 217, Jul 2020.",
            "year": 2020
        },
        {
            "authors": [
                "Y. Wang",
                "F. Qi",
                "J. Wang"
            ],
            "title": "Terahertz image super-resolution based on a complex convolutional neural network",
            "venue": "Opt. Lett., vol. 46, no. 13, pp. 3123\u20133126, Jul 2021. [Online]. Available: https://opg.optica.org/ol/abstract.cfm?URI=ol-46-13-3123",
            "year": 2021
        },
        {
            "authors": [
                "T. Lei",
                "B. Tobin",
                "Z. Liu",
                "S.-Y. Yang",
                "D.-W. Sun"
            ],
            "title": "A terahertz time-domain super-resolution imaging method using a local-pixel graph neural network for biological products",
            "venue": "Analytica Chimica Acta, vol. 1181, p. 338898, 2021. [Online]. Available: https://www.sciencedirect.com/science/article/pii/S0003267021007248",
            "year": 2021
        },
        {
            "authors": [
                "Z. Hou",
                "X. Cha",
                "H. An",
                "A. Zhang",
                "D. Lai"
            ],
            "title": "Super-resolution reconstruction of terahertz images based on residual generative adversarial network with enhanced attention",
            "venue": "Entropy, vol. 25, no. 3, 2023. [Online]. Available: https://www.mdpi.com/1099-4300/25/3/440",
            "year": 2023
        },
        {
            "authors": [
                "W. Liao",
                "B. Goossens",
                "J. Aelterman",
                "H. Luong",
                "A. Pizurica",
                "N. Wouters",
                "W. Saeys",
                "W. Philips"
            ],
            "title": "Hyperspectral Image Deblurring with PCA and Total Variation",
            "venue": "2013 5th Workshop on hyperspectral image and signal processing : evolution in remote sensing (WHISPERS). IEEE, 2013, p. 4.",
            "year": 2013
        },
        {
            "authors": [
                "R. Dian",
                "S. Li",
                "L. Fang",
                "J.M. Bioucas-Dias"
            ],
            "title": "Hyperspectral Image Super-Resolution via Local Low-Rank and Sparse Representations",
            "venue": "IGARSS 2018 - 2018 IEEE International Geoscience and Remote Sensing Symposium, pp. 4003\u20134006, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "M. Ljubenovi\u0107",
                "A. Traviglia"
            ],
            "title": "Improved detection of buried archaeological sites by fast hyperspectral image deblurring and denoising",
            "venue": "Optics for Arts, Architecture, and Archaeology VIII, H. Liang and R. Groves, Eds., vol. 11784, International Society for Optics and Photonics. SPIE, 2021, pp. 128 \u2013 137. [Online]. Available: https://doi.org/10.1117/12.2593713",
            "year": 2021
        },
        {
            "authors": [
                "M. Sim\u00f5es",
                "J. Bioucas-Dias",
                "L.B. Almeida",
                "J. Chanussot"
            ],
            "title": "A Convex Formulation for Hyperspectral Image Superresolution via Subspace- Based Regularization",
            "venue": "IEEE Transactions on Geoscience and Remote Sensing, vol. 53, no. 6, pp. 3373\u20133388, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "C. Lanaras",
                "J. Bioucas-Dias",
                "E. Baltsavias",
                "K. Schindler"
            ],
            "title": "Super- Resolution of Multispectral Multiresolution Images from a Single Sensor",
            "venue": "2017 IEEE Conference on Computer Vision and Pattern Recognition Workshops (CVPRW), 2017, pp. 1505\u20131513.",
            "year": 2017
        },
        {
            "authors": [
                "M. Ljubenovi\u0107",
                "L. Zhuang",
                "J. De Beenhouwer",
                "J. Sijbers"
            ],
            "title": "Joint deblurring and denoising of thz time-domain images",
            "venue": "IEEE Access, vol. 9, pp. 162\u2013176, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Ljubenovi\u0107",
                "A. Artesani",
                "S. Bonetti",
                "A. Traviglia"
            ],
            "title": "Beam-shape effects and noise removal from thz time-domain images in reflection geometry in the 0.25\u20136 thz range",
            "venue": "IEEE Transactions on Terahertz Science and Technology, vol. 12, no. 6, pp. 574\u2013586, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "M.V. Afonso",
                "J.M. Bioucas-Dias",
                "M.A.T. Figueiredo"
            ],
            "title": "Fast image recovery using variable splitting and constrained optimization",
            "venue": "IEEE Transactions on Image Processing, vol. 19, no. 9, pp. 2345\u20132356, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "C. Dong",
                "C.C. Loy",
                "K. He",
                "X. Tang"
            ],
            "title": "Image Super-Resolution Using Deep Convolutional Networks",
            "venue": "CoRR, vol. abs/1501.00092, 2015. [Online]. Available: http://arxiv.org/abs/1501.00092",
            "year": 2015
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014THz-TDS, THz imaging, Super-resolution, Deblurring, Denoising\nI. INTRODUCTION\nTHz time-domain spectroscopy (THz-TDS) employs subpicosecond pulses to probe material properties of dielectric materials giving as a result a 3-dimensional hyperspectral (HS) data cube. This HS cube might contain information on both surface and inner structures of the analysed sample. However, the ultra-broadband THz source (extending over more than 6 octaves), the frequency-dependent imaging process, and the point-like measurement procedure have tremendous effects on the spatial resolution of THz images. The spatial resolution of THz images is limited by two main sources: the point-spread function (PSF) of the imaging system and the acquisition step size. A THz beam has a frequencydependent divergence and it generates blurring degradation effects in HS images, i.e., each frequency band is blurred\nThis project has received funding from the European Union\u2019s Horizon 2020 research and innovation programme under grant agreement No. 101026453. This work was presented at the Sixth International Workshop on Mobile Terahertz Systems (IWMTS).\nwith a different PSF, accompanied by the system-induced noise. The analysis of a surface is obtained in the reflection or transmission mode by raster-scanning the sample with a predefined scanning step size. An example of the amplitude signal of a raster-scanned sample taken with two different step sizes is shown in Fig. 1. THz images acquired with smaller step sizes (e.g., 0.1 mm) contain more details compared to ones acquired with a medium step size (e.g., 0.2 mm), but the acquisition time increases significantly. For instance, it takes 3 minutes to scan 5 \u00d7 5 mm area for a 0.2 mm step size compared to 32 minutes for a 0.1 mm step size.\nDifferent model-based and machine learning-based methods have been proposed for THz image resolution enhancement, mostly focused on removing the blurring effects introduced by the system PSF. Initial model-based methods tried to use simulated [1], [2] or measured [3], [4] PSF of the THz imaging system in combination with well-known single image deblurring approaches such as Richardson-Lucy [2], [5] and Wiener filtering [4]. Other methods exploited state-of-the-art deblurring approaches based on total variation (TV) and/or sparsity [2]. All these methods suffer from several limitations: i) they are focused on single images and not easily applied to HS images; ii) they often amplify noise present at highfrequency bands; and iii) they provide images of the same size as input images, thus performing only deblurring (i.e.,979-8-3503-21159/23/$31.00 \u00a9 2023 IEEE ar X\niv :2\n31 2.\n13 82\n0v 1\n[ ph\nys ic\ns. op\ntic s]\n2 1\nremoving of PSF effects) and not a super-resolution procedure (i.e., decreasing of pixel size). Machine learning-based image deblurring and super-resolution approaches applied to RGB images provide state-of-the-art results [6]. Recently, several papers proposed the implementation of such approaches to THz images in order to exploit the powerful mapping ability of the convolution neural network (CNN) and the efficient training GPU implementation [7]\u2013 [9]. Other methods utilize different types of NNs such as a local-pixel graph neural network [10] and a residual generative adversarial network [11]. The majority of these methods are trained on synthetic images or images that belong to a single class such as biological images [10], thus providing limited results when tested on real data. Obtaining a high enough number of real data for building training datasets is timeconsuming and for many applications impractical. Moreover, most CNN-based methods are tailored to a single-frequency THz image and do not take into consideration the continuous change of PSF with frequency present in THz HS images. Methods that use computer vision techniques for performing HS image deblurring and super-resolution were mostly developed for remote sensing applications relaying to dimensionality reduction approaches [12]\u2013[14]. Super-resolution methods for HS images are usually based on data fusion: a lowresolution image (or bands) is fused with a high-resolution image (e.g., a panchromatic image) or higher resolution bands to obtain a high-resolution HS or multispectral image [15], [16]. Although these methods give promising results, they require additional input data, such as a high-resolution image of the same sample, that are not available when working with THz images. Additionally, they are tailored to blur degradation introduced by a hyperspectral remote sensing camera that is often assumed to be uniform over bands.\nRecently, a deblurring and denoising method that jointly reduces the blur and noise effects, without increasing the resolution of the THz HS images was developed for images acquired in the transmission mode [17]. A similar approach was tested on THz images in the 0.25\u20136 THz range, acquired in the reflection mode [18]. Here, the methodology is improved by including a super-resolution approach to restore THz HS images acquired with bigger step sizes, additionally corrupted by blur and noise. By restoring low-resolution THz images digitally, the acquisition time is significantly reduced. The proposed approach is inspired by state-of-the-art remote sensing methods based on dimensionality reduction [16] with the implementation of an important step to accommodate frequencydependent PSFs. It relies on the assumption that spectral bands of THz time-domain images are correlated and can thus be represented in a lower-dimensional subspace, where most of the useful information is contained. The subspace is learned from the input data and thus, the method does not require additional parameters. Moreover, the super-resolution problem is formulated as a minimisation of a convex objective function with an edge-preserving regularizer. This minimisation is computed by an efficient numerical solver based on the alternating direction method of multipliers (ADMM) algorithm. In this\nway, the resolution of the digital image is increased, intended as pixel density, and at the same time, the noise and the blur effects that corrupt the broadband images (from 0.25 to 3.5 THz) are reduced. The super-resolution process is accomplished in accordance with the frequency band of the image and the additional pixels are created with an iterative method that considers the PSF of the system. Here, only superresolution that doubles the number of pixels in both directions is considered (e.g., an image with 100\u00d7100 pixels is increased to an image with 200 \u00d7 200 pixels) as in this case, newly created pixels are formed by information coming from four closest neighboring pixels."
        },
        {
            "heading": "II. LOW-RANK REPRESENTATION OF HYPERSPECTRAL DATA",
            "text": "If B and nL denote the number of bands and the number of low-resolution pixels, respectively, then vectorised observed image can be represented as y = (y1, y2, ..., yB) \u2208 RBnL , where yi, for i = 1, ..., B, stands for the pixel intensities of each individual band collected into a vector. Given the upsampling factor d, the number of low-resolution pixel is calculated as nL = nd2 with n representing the (desired) number of high-resolution pixels. Thus, the underlying highresolution vectorised image is x = (x1, x2, ..., xB) \u2208 RBn. In the matrix form, the output image can be reformatted to X = [xT1 ; xT2 ; ...; xTB ] \u2208 RB\u00d7n, leading to x = vec(X\nT ). The observation model with the assumption of Gaussian noise, n, is represented as\ny = MHx + n, (1)\nwhere M \u2208 RBnL\u00d7Bn and H \u2208 RBn\u00d7Bn represent the sampling matrix (i.e., sampling of x to obtain y) and a 2D cyclic convolution associated with the PSF of the corresponding band at the highest spatial resolution, respectively. The blur matrix H = bkdiag(H1, ...,HB) is a block-circulant-circulant-block (BCCB) matrix depicting a different blur for each frequency band. The model in (1) has fewer observations than unknowns and thus, is ill-posed. Considering the high correlation between bands, we assume that the columns of X (i.e., spectral vectors) live in a lowerdimensional subspace Sp, with p \u226a B and thus can be represented as\nX = EZ, (2)\nwhere E = [e1, ..., ep] \u2208 RB\u00d7p stands for basis of Sp and Z \u2208 Rp\u00d7n holds the representation coefficients of X in Sp. By assuming that E is semi-unitary, vectorisation of X leads to x = (E \u2297 I)z, with I as an identity matrix. With the dimensionality reduction, the observation model becomes\ny = MH(E \u2297 I)z + n. (3)\nIf pn < BnL, the problem is no longer ill-posed. However, due to the assumption of the cyclic convolution, it is still illconditioned and thus, sensitive to the presence of (even lowlevel) noise in the observed image."
        },
        {
            "heading": "A. THz Beam Profile Estimation",
            "text": "Each frequency band of THz time-domain images is blurred with a different PSF. The minimum beam radius (beam waist) of a THz beam is wider at lower frequencies resulting in blurrier bands. On the contrary, at higher frequencies, the beam waist is smaller and thus bands are sharper. However, due to lower amplitudes at higher frequencies, these bands are noisier. In this work, the intensity profile of a THz beam is assumed to have Gaussian distribution with the beam intensity calculated as\nI(r, z) = 2Ip\n\u03c0w2(z) exp\n( \u22122r2\nw2(z)\n) , (4)\nwhere Ip is the beam power, w(z) is the beam radius in the direction z, and r is the distance from the beam axis. The radius of the beam varies along the propagating direction as\nw(z) = w0\n\u221a 1 + ( z\n\u03c0w20/\u03bb\n)2 , (5)\nwhere w0 = 4\u03c0\u03bb fL D represents the half of the beam waist and \u03bb the beam wavelength (the beam waist 2w0 depends on the wavelength \u03bb correlated to band frequencies). fL and D represent the focal length and diameter of the focusing THz lens. PSF of each band corresponds to an intersection of the THz beam calculated by using (4) and (5) with an orthogonal plane."
        },
        {
            "heading": "III. FREQUENCY-OPTIMIZED SUPER-RESOLUTION",
            "text": "To obtain a high-resolution image, we solve the optimization problem\nz\u0302 \u2208 argmin z ||MH(E \u2297 I)z \u2212 y||2 + \u03b3\u03a6w,c(z), (6)\nwhere \u03a6w,c(z) = \u2211p\ni=1 \u2211n j=1(ciwj(Fhzi) 2 j + ciwj(Fvzi)2j )\nis a regularization term with weights w and c, and the regularization parameter \u03b3. Dh = I \u2297 Fh and Dv = I \u2297 Fv represent approximate horizontal and vertical derivatives of z. The optimization problem is tackled by applying the instance of the ADMM algorithm, SALSA, [19] by transforming the unconstrained problem from (6) to a constrained one, as follows:\nmin z,v1,v2,v3\n||MHv1 \u2212 y||2 + \u03b3\u03a6w,c(v2, v3)\nsubject to v1 = (E \u2297 I)z; v2 = Dhz; v3 = Dvz. (7)\nThe Augmented Lagrangian of the above problem using the vectors of Lagrange multipliers d1, d2, and d3 is\nL(z, v1, v2, v3,d1,d2,d3) = ||MHv1 \u2212 y||2 + \u00b51 2 ||(E \u2297 I)z \u2212 v1 \u2212 d1||2 + \u03b3\u03a6w,c(v2, v3)\n+ \u00b52 2 ||Dhz \u2212 v2 \u2212 d2||2 + \u00b53 2 ||Dvz \u2212 v3 \u2212 d3||2,\n(8)\nwith the penalty parameters \u00b5i \u2265 0 for i = 1, 2, 3. The ADMM addresses the problem by alternatingly minimizing (8) over z, v1, v2, and v3 and by updating the vector of Lagrange multipliers d1, d2, and d3 by keeping the other variables fixed.\nThe proposed method named Frequency-Optimized SuperResolution (FO-SupRes) is presented in Algorithm 1.\nAlgorithm 1 FO-SupRes 1: Input: Observed image y, regularization parameter \u03b3, THz\nsystem frequencies (Freq), weights w and c 2: Initialization: Set k = 0; Initialize v(0)1 , v (0) 2 , v (0) 3 , d (0) 1 , d (0) 2 ,\nand d(0)3 3: while stopping criterion is not satisfied do 4: k \u2190 k + 1 5: Calculate PSFs for each band using (4) and (5) in the focus\nof the beam (minimum waist) 6: Minimize z(k) by keeping other variables fixed 7: Minimize v(k)1 by keeping other variables fixed 8: Minimize v(k)2 by keeping other variables fixed 9: Minimize v(k)3 by keeping other variables fixed\n10: Update d(k)1 , d (k) 2 , and d (k) 3 11: end while"
        },
        {
            "heading": "IV. EXPERIMENTAL RESULTS",
            "text": "In all the experiments, the following settings are used for the ADMM algorithm: the number of iterations is set to 100, \u00b5i = 0.2 and d (0) i = 0, for i = {1, 2, 3}, and the image estimate is initialised with the estimate from the previous iteration. The number of subspaces is set to 10, the sampling factor is set to d = 2, and the parameter \u03b3 is hand-tuned for the best visual results. Results obtained with the proposed super-resolution algorithm, named FrequencyOptimized Super-Resolution (FO-SupRes), are compared with the results of the conventional bicubic interpolation (Bicubic) and a state-of-the-art CNN-based super-resolution algorithm (SRCNN) [20]. Without access to a training dataset, it was not possible to fairly test NN-based super-resolution methods for single-band THz images. Experiments are performed in the reflection mode using two samples: a hole on a metallic plate and 1 cent coin. Fig. 2 illustrates the results of the proposed super-resolution algorithm with two different step sizes (0.2 and 0.1 mm) obtained on the simple sample, a hole on a metallic plate.\nFig. 3 shows estimated bands corresponding to four frequencies (i.e., 1, 1.5, 2.5, and 3 THz) acquired by two different step sizes (i.e., 0.2 and 0.1 mm). Medium frequencies of the THz range (e.g., from 1 to 3 THz) are not corrupted by severe noise and blur and thus, the influence of the step size choice is mostly visible in the bands selected from that range.\nResults show that the performance of the proposed approach is stable over bands, i.e., blur and noise are successfully removed and the resolution increased. Additionally, images digitally restored to achieve 0.1 mm resolution, i.e., 1 pixel = 0.1 mm (second raw), are visually comparable with the raw images acquired with the same resolution (third row).\nFigure 4 shows the results obtained on 1 cent coin acquired with 0.2 mm step with the proposed approach, FO-SupRes, compared to the results obtained by conventional bicubic interpolation and state-of-the-art neural network-based approach (SRCNN). Here, only one band corresponding to a low frequency (0.5 THz) and a band corresponding to a medium-high frequency are presented for the sake of clarity. The proposed method is optimized over all frequency bands leading to a reduction in both blur and noise and an increase in resolution. Contrary to that, bicubic interpolation and SRCNN fail to remove blur from bands corresponding to lower frequencies and show significant artefacts on bands corresponding to higher frequencies. These artefacts are most likely caused by the presence of (even a small) amount of noise as both methods are tailored to noiseless images: bicubic interpolation mistakes noise with a valid data point during calculation and the SRCNN method is trained only on noiseless images. The influence of the proposed approach on the sharpness of a feature is presented in Fig. 5 visually through cross-sections (i.e., a cross-section of a raw band is compared to a crosssection of a restored band) and in terms of feature size and a coin diameter estimation. Results show that to achieve an estimation that is closer to real values, super-resolved images should be used as a pre-processing step."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "This paper has demonstrated the results of a super-resolution approach tailored to THz time-domain images that made it possible to jointly restore all the bands of an HS cube by exploiting the low-rank property of HS data and an edgepreserving regularizer. To the best of our knowledge, this is the first time that a super-resolution approach based on\nthe low-rank property of HS images is proposed to restore THz time-domain images. As a result of such an approach, images acquired with the medium step size (e.g., 0.2 mm) and shorter acquisition time were digitally restored and achieved a resolution similar to that of images acquired by a smaller step size (e.g., 0.1 mm). The results show the optimized and robust performance for different frequency bands (from 0.5 to 3.5 THz) obtaining higher resolution and additionally removing effects of blur at lower frequencies and noise at higher frequencies, without introducing new artefacts. The proposed\napproach may have a tremendous impact on applications for which a high resolution is crucial, but the acquisition time is limited (e.g., in-line inspection to identify corrosion, cracks, and other defects)."
        }
    ],
    "title": "Super-resolution of THz time-domain images based on low-rank representation",
    "year": 2023
}