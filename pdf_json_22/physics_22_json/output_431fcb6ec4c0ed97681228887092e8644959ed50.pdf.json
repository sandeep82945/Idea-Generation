{
    "abstractText": "We show how to define a quantized many-body charge polarization P\u20d7 for \u00f02\u00fe 1\u00deD topological phases of matter, even in the presence of nonzero Chern number and magnetic field. For invertible topological states, P\u20d7 is a Z2 \u00d7 Z2, Z3, Z2, or Z1 topological invariant in the presence of (M 1\u20444 2, 3, 4, or 6)-fold rotational symmetry, lattice (magnetic) translational symmetry, and charge conservation. P\u20d7manifests in the",
    "authors": [
        {
            "affiliations": [],
            "name": "Yuxuan Zhang"
        },
        {
            "affiliations": [],
            "name": "Naren Manjunath"
        },
        {
            "affiliations": [],
            "name": "Gautam Nambiar"
        },
        {
            "affiliations": [],
            "name": "Maissam Barkeshli"
        }
    ],
    "id": "SP:33446a02a93ee16c5003e13b7ec943bcb03c7be7",
    "references": [
        {
            "authors": [
                "M.Z. Hasan",
                "C.L. Kane"
            ],
            "title": "Colloquium: Topological Insulators",
            "venue": "Rev. Mod. Phys. 82, 3045 ",
            "year": 2010
        },
        {
            "authors": [
                "X.-L. Qi",
                "S.-C. Zhang"
            ],
            "title": "Topological Insulators and Superconductors",
            "venue": "Rev. Mod. Phys. 83, 1057 ",
            "year": 2011
        },
        {
            "authors": [
                "B.A. Bernevig"
            ],
            "title": "Topological Insulators and Topological Superconductors",
            "venue": "Topological Insulators and Topological Superconductors",
            "year": 2013
        },
        {
            "authors": [
                "A. Kitaev"
            ],
            "title": "Periodic Table for Topological Insulators and Superconductors",
            "venue": "AIP Conf. Proc. 1134, 22 ",
            "year": 2009
        },
        {
            "authors": [
                "S. Ryu",
                "A.P. Schnyder",
                "A. Furusaki",
                "A.W.W. Ludwig"
            ],
            "title": "Topological Insulators and Superconductors: Tenfold Way and Dimensional Hierarchy",
            "venue": "New J. Phys. 12, 065010 ",
            "year": 2010
        },
        {
            "authors": [
                "C.-K. Chiu",
                "J.C.Y. Teo",
                "A.P. Schnyder",
                "S. Ryu"
            ],
            "title": "Classification of Topological Quantum Matter with Symmetries",
            "venue": "Rev. Mod. Phys. 88, 035005 ",
            "year": 2016
        },
        {
            "authors": [
                "X. Chen",
                "Z.-C. Gu",
                "Z.-X. Liu",
                "X.-G. Wen"
            ],
            "title": "Symmetry Protected Topological Orders and the Group Cohomology of Their Symmetry Group",
            "venue": "Phys. Rev. B 87, 155114 ",
            "year": 2013
        },
        {
            "authors": [
                "Z.-C. Gu",
                "X.-G. Wen"
            ],
            "title": "Symmetry-Protected Topological Orders for Interacting Fermions: Fermionic Topological Nonlinear \u03c3 Models and a Special Group Supercohomology Theory",
            "venue": "Phys. Rev. B 90, 115141 ",
            "year": 2014
        },
        {
            "authors": [
                "A. Kapustin",
                "R. Thorngren",
                "A. Turzillo",
                "Z. Wang"
            ],
            "title": "Fermionic Symmetry Protected Topological Phases and Cobordisms",
            "venue": "J. High Energy Phys. 12 ",
            "year": 2015
        },
        {
            "authors": [
                "T. Senthil"
            ],
            "title": "Symmetry-Protected Topological Phases of Quantum Matter",
            "venue": "Annu. Rev. Condens. Matter Phys. 6, 299 ",
            "year": 2015
        },
        {
            "authors": [
                "Q.-R. Wang",
                "Z.-C. Gu"
            ],
            "title": "Construction and Classification of Symmetry-Protected Topological Phases in Interacting Fermion Systems",
            "venue": "Phys. Rev. X 10, 031055 ",
            "year": 2020
        },
        {
            "authors": [
                "M. Barkeshli",
                "P. Bonderson",
                "M. Cheng",
                "Z. Wang"
            ],
            "title": "Symmetry Fractionalization",
            "venue": "Defects, and Gauging of Topological Phases, Phys. Rev. B 100, 115147 ",
            "year": 2019
        },
        {
            "authors": [
                "M. Barkeshli",
                "Y.-A. Chen",
                "P.-S. Hsin",
                "N. Manjunath"
            ],
            "title": "Classification of \u00f02\u00fe 1\u00deD Invertible Fermionic Topological Phases with Symmetry",
            "venue": "Phys. Rev. B 105, 235143 ",
            "year": 2022
        },
        {
            "authors": [
                "D. Bulmash",
                "M. Barkeshli"
            ],
            "title": "Fermionic Symmetry Fractionalization in (2\u00fe 1) Dimensions",
            "venue": "Phys. Rev. B 105, 125114 ",
            "year": 2022
        },
        {
            "authors": [
                "N. Manjunath",
                "M. Barkeshli"
            ],
            "title": "Crystalline Gauge Fields and Quantized Discrete Geometric Response for Abelian Topological Phases with Lattice Symmetry",
            "venue": "Phys. Rev. Res. 3, 013040 ",
            "year": 2021
        },
        {
            "authors": [
                "C. Fang",
                "M.J. Gilbert",
                "B.A. Bernevig"
            ],
            "title": "Bulk Topological Invariants in Noninteracting Point Group Symmetric Insulators",
            "venue": "Phys. Rev. B 86, 115112 ",
            "year": 2012
        },
        {
            "authors": [
                "X.-Y. Song",
                "Y.-C. He",
                "A. Vishwanath",
                "C. Wang"
            ],
            "title": "Electric Polarization as a Nonquantized Topological Response and Boundary Luttinger Theorem",
            "venue": "Phys. Rev. Res. 3, 023011 ",
            "year": 2021
        },
        {
            "authors": [
                "R. Resta",
                "D. Vanderbilt"
            ],
            "title": "Theory of Polarization: A Modern Approach",
            "venue": "Physics of Ferroelectrics ",
            "year": 2007
        },
        {
            "authors": [
                "R. Resta"
            ],
            "title": "Macroscopic Polarization in Crystalline Dielectrics: The Geometric Phase Approach",
            "venue": "Rev. Mod. Phys. 66, 899 ",
            "year": 1994
        },
        {
            "authors": [
                "H. Watanabe",
                "M. Oshikawa"
            ],
            "title": "Inequivalent Berry Phases for the Bulk Polarization",
            "venue": "Phys. Rev. X 8, 021065 ",
            "year": 2018
        },
        {
            "authors": [
                "S. Coh",
                "D. Vanderbilt"
            ],
            "title": "Electric Polarization in a Chern Insulator",
            "venue": "Phys. Rev. Lett. 102, 107603 ",
            "year": 2009
        },
        {
            "authors": [
                "R. Resta"
            ],
            "title": "Quantum-Mechanical Position Operator in Extended Systems",
            "venue": "Phys. Rev. Lett. 80, 1800 ",
            "year": 1998
        },
        {
            "authors": [
                "X.G. Wen",
                "A. Zee"
            ],
            "title": "Shift and Spin Vector: New Topological Quantum Numbers for the Hall Fluids",
            "venue": "Phys. Rev. Lett. 69, 953 ",
            "year": 1992
        },
        {
            "authors": [
                "F.D.M. Haldane"
            ],
            "title": "Geometrical Description of the Fractional Quantum Hall Effect",
            "venue": "Phys. Rev. Lett. 107, 116801 ",
            "year": 2011
        },
        {
            "authors": [
                "A.G. Abanov",
                "A. Gromov"
            ],
            "title": "Electromagnetic and Gravitational Responses of Two-Dimensional Noninteracting Electrons in a Background Magnetic Field",
            "venue": "Phys. Rev. B 90, 014435 ",
            "year": 2014
        },
        {
            "authors": [
                "B. Bradlyn",
                "N. Read"
            ],
            "title": "Low-Energy Effective Theory in the Bulk for Transport in a Topological Phase",
            "venue": "Phys. Rev. B 91, 125303 ",
            "year": 2015
        },
        {
            "authors": [
                "A. Gromov",
                "G.Y. Cho",
                "Y. You",
                "A.G. Abanov",
                "E. Fradkin"
            ],
            "title": "Framing Anomaly in the Effective Theory of the Fractional Quantum Hall Effect",
            "venue": "Phys. Rev. Lett. 114, 016805 ",
            "year": 2015
        },
        {
            "authors": [
                "R.R. Biswas",
                "D.T. Son"
            ],
            "title": "Fractional Charge and Inter- Landau\u2013Level States at Points of Singular Curvature",
            "venue": "Proc. Natl. Acad. Sci. U.S.A. 113, 8636 ",
            "year": 2016
        },
        {
            "authors": [
                "D.R. Hofstadter"
            ],
            "title": "Energy Levels and Wave Functions of Bloch Electrons in Rational and Irrational Magnetic Fields",
            "venue": "Phys. Rev. B 14, 2239 ",
            "year": 1976
        },
        {
            "authors": [
                "Y. Zhang",
                "N. Manjunath",
                "G. Nambiar",
                "M. Barkeshli"
            ],
            "title": "Fractional Disclination Charge and Discrete Shift in the Hofstadter Butterfly",
            "venue": "Phys. Rev. Lett. 129, 275301 ",
            "year": 2022
        },
        {
            "authors": [
                "D. Osadchy",
                "J.E. Avron"
            ],
            "title": "Hofstadter Butterfly as Quantum Phase Diagram",
            "venue": "J. Math. Phys. 42, 5665 ",
            "year": 2001
        },
        {
            "authors": [
                "D.J. Thouless",
                "M. Kohmoto",
                "M.P. Nightingale"
            ],
            "title": "and M",
            "venue": "den Nijs, Quantized Hall Conductance in a Two-Dimensional Periodic Potential, Phys. Rev. Lett. 49, 405 ",
            "year": 1982
        },
        {
            "authors": [
                "S. Liu",
                "A. Vishwanath",
                "E. Khalaf"
            ],
            "title": "Shift Insulators: Rotation-Protected Two-Dimensional Topological Crystalline Insulators",
            "venue": "Phys. Rev. X 9, 031003 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Li",
                "P. Zhu",
                "W.A. Benalcazar",
                "T.L. Hughes"
            ],
            "title": "Fractional Disclination Charge in Two-Dimensional Cn-Symmetric Topological Crystalline Insulators",
            "venue": "Phys. Rev. B 101, 115115 ",
            "year": 2020
        },
        {
            "authors": [
                "B. Han",
                "H. Wang",
                "P. Ye"
            ],
            "title": "Generalized Wen-Zee Terms",
            "venue": "Phys. Rev. B 99, 205120 ",
            "year": 2019
        },
        {
            "authors": [
                "P. Jadaun",
                "D. Xiao",
                "Q. Niu",
                "S.K. Banerjee"
            ],
            "title": "Topological Classification of Crystalline Insulators with Space Group Symmetry",
            "venue": "Phys. Rev. B 88, 085110 ",
            "year": 2013
        },
        {
            "authors": [
                "X.-Y. Song",
                "C. Wang",
                "A. Vishwanath",
                "Y.-C. He"
            ],
            "title": "Unifying Description of Competing Orders in Two- Dimensional Quantum Magnets",
            "venue": "Nat. Commun. 10, 4254 ",
            "year": 2019
        },
        {
            "authors": [
                "X.-Y. Song",
                "Y.-C. He",
                "A. Vishwanath",
                "C. Wang"
            ],
            "title": "Electric Polarization as a Nonquantized Topological Response and Boundary Luttinger Theorem",
            "venue": "Phys. Rev. Res. 3, 023011 ",
            "year": 2021
        },
        {
            "authors": [
                "W.A. Benalcazar",
                "T. Li",
                "T.L. Hughes"
            ],
            "title": "Quantization of Fractional Corner Charge in Cn-Symmetric Higher-Order Topological Crystalline Insulators",
            "venue": "Phys. Rev. B 99, 245151 ",
            "year": 2019
        },
        {
            "authors": [
                "J. Cano",
                "B. Bradlyn"
            ],
            "title": "Band Representations and Topological Quantum Chemistry",
            "venue": "Annu. Rev. Condens. Matter Phys. 12, 225 ",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Quantized Charge Polarization as a Many-Body Invariant in \u00f02 + 1\u00deD Crystalline Topological States and Hofstadter Butterflies\nYuxuan Zhang ,1,2 Naren Manjunath ,1,2 Gautam Nambiar ,1 and Maissam Barkeshli1,2 1Department of Physics and Joint Quantum Institute, University of Maryland, College Park, Maryland 20742, USA 2Condensed Matter Theory Center, University of Maryland, College Park, Maryland 20742, USA\n(Received 2 December 2022; revised 21 April 2023; accepted 15 May 2023; published 14 July 2023)\nWe show how to define a quantized many-body charge polarization P\u20d7 for \u00f02\u00fe 1\u00deD topological phases of matter, even in the presence of nonzero Chern number and magnetic field. For invertible topological states, P\u20d7 is a Z2 \u00d7 Z2, Z3, Z2, or Z1 topological invariant in the presence of (M \u00bc 2, 3, 4, or 6)-fold rotational symmetry, lattice (magnetic) translational symmetry, and charge conservation. P\u20d7manifests in the\nbulk of the system as (i) a fractional quantized contribution of P\u20d7 \u00b7 b\u20d7 mod 1 to the charge bound to lattice\ndisclinations and dislocations with Burgers vector b\u20d7, (ii) a linear momentum for magnetic flux, and (iii) an\noscillatory system size dependent contribution to the effective 1D polarization on a cylinder. We study P\u20d7 in lattice models of spinless free fermions in a magnetic field. We derive predictions from topological field theory, which we match to numerical calculations for the effects (i)\u2013(iii), demonstrating that these can be used to extract P\u20d7 from microscopic models in an intrinsically many-body way. We show how, given a high\nsymmetry point o, there is a topological invariant, the discrete shift So, such that P\u20d7 specifies the dependence of So on o. We derive colored Hofstadter butterflies, corresponding to the quantized value of\nP\u20d7, which further refine the colored butterflies from the Chern number and discrete shift.\nDOI: 10.1103/PhysRevX.13.031005 Subject Areas: Condensed Matter Physics, Quantum Physics, Strongly Correlated Materials\nI. INTRODUCTION\nIn the presence of symmetry, gapped quantum phases of matter can acquire symmetry-protected topological invariants. The paradigmatic example is the quantized Hall conductance, which is specified by the Chern number, and is defined only for systems with a U(1) charge conservation symmetry. Since the discovery of topological insulators and superconductors [1\u20133], there has been spectacular progress in our understanding of symmetry-protected topological invariants both for single-particle free fermion models [4\u20136] and for interacting many-body systems [7\u201316]. Despite these advances, a complete understanding of topological invariants arising from crystalline symmetries is still lacking. Recently, Refs. [17,18] applied ideas from topological quantum field theory (TQFT) and the algebraic theory of\nsymmetry defects [13], which can be used to characterize gapped quantum many-body systems, to develop a systematic classification of topological invariants for systems with U(1) charge conservation, discrete (magnetic) translational symmetry, and rotational symmetry in two spatial dimensions. In particular, Refs. [17,18] showed how TQFT predicts the existence of a quantized many-body polarization in the presence of twofold, threefold, fourfold, or sixfold rotational symmetry. For invertible topological phases, which do not host anyon excitations, the polarization acquires a Z2 \u00d7 Z2, Z3, Z2, or Z1 classification, respectively. Remarkably, the TQFT prediction of a quantized charge polarization applies also in the presence of a nonzero Chern number and a nontrivial magnetic field. This appears to be in tension with several statements made previously in the literature about whether the polarization is well defined in the presence of a nonzero Chern number [19,20]. The TQFT not only predicts the presence of the invariant, but also its bulk physical manifestation. This is in terms of a fractional quantized contribution of the charge bound to lattice defects and a dual response, the momentum of the ground state in the presence of additionally inserted magnetic flux. Published by the American Physical Society under the terms of the Creative Commons Attribution 4.0 International license. Further distribution of this work must maintain attribution to the author(s) and the published article\u2019s title, journal citation, and DOI.\nPHYSICAL REVIEW X 13, 031005 (2023)\n2160-3308=23=13(3)=031005(42) 031005-1 Published by the American Physical Society\nIn contrast, the modern theory of polarization in insulators is based on the Berry-Zak phase of single-particle wave functions in momentum space [21\u201324]. This Berry phase theory of polarization assumes the phase of the singleparticle states is globally well defined throughout the Brillouin zone, which applies only in the case of zero Chern number. For the case of nonzero Chern number, while there has been work showing how one may define a notion of polarization in the single-particle context by fixing an origin in the Brillouin zone [24], its quantization from crystalline symmetries, the effects of nonzero magnetic field, and its implication for bulk response properties have not been studied. In many-body systems with interactions, the singleparticle Berry phase formulation breaks down. It can be replaced with a Berry phase theory based on twisted boundary conditions or with an expectation of Resta\u2019s exponentiated polarization operator [25]. However, these apply only to the effective 1D polarization, meaning the system is viewed as an effective one-dimensional system; such a 1D polarization is no longer an intensive quantity in a higher-dimensional system. In this paper we show how one can indeed define a quantized charge polarization in an intrinsically many-body fashion and in the presence of both nonzero Chern number and nonzero magnetic field. This is not an effective 1D\npolarization obtained by viewing the system as a 1D system\u2014rather, this is an intrinsic bulk 2D polarization, which has nontrivial bulk responses mentioned above. More specifically, we show that upon fixing a choice\nof high symmetry point (HSP) o in the unit cell, one can\ndefine two invariants,So and P\u20d7o.So is a discrete analog of the Wen-Zee shift [26\u201331], which is an invariant associated to U(1) charge conservation and SO(2) plane rotational symmetry. We refer to So as the \u201cdiscrete shift\u201d because it is a ZM invariant, while the Wen-Zee shift is a Z invariant.\nP\u20d7o denotes the quantized charge polarization. We show, through extensive numerical studies, how\nthese invariants can be extracted from bulk response properties of microscopic models in multiple different ways. We show how the predictions of the TQFT, including the bulk response properties and the dependence of So and P\u20d7o on o, can be precisely matched to calculations on microscopic models. As an application, we show how one can extract the\nquantized charge polarization for the Hofstadter model [32] of spinless free fermions in a nonzero magnetic field on a lattice. This provides yet another way to color Hofstadter\u2019s butterfly (see Fig. 1), extending the recent coloring in Ref. [33] based on the discrete shift, and the earlier coloring with the Chern (TKNN) number [34,35].\n031005-2\nWe note that the dependence of the polarization on a choice of origin o is a well-known property of all definitions of the polarization in electronic systems; it is usually dealt with by considering instead changes in the polarization as an external parameter is tuned, or by using the overall charge neutrality of the system (for example, by taking into account the background positive ions), which removes the origin dependence [21]. While at first glance it seems unusual that an invariant of a phase of matter could have a dependence on a choice of origin, we explain it further in subsequent sections."
        },
        {
            "heading": "A. Relation to prior work",
            "text": "Our work is closely related to several works over the past decade that also study polarization and its physical consequences but all in the context of Chern number C \u00bc 0. Responses associated to the discrete shift have also been explored in microscopic models in recent works [33,36,37] and in the context of topological field theory [17,18,38], although the origin dependence of the discrete shift has not been discussed in prior work. References [19,39] discuss a quantized charge polarization in free fermion crystalline insulators with different point group symmetries, assuming zero Chern number. Reference [20] showed how, ignoring rotational symmetry, polarization is a \u201cnonquantized\u201d topological response and can be defined for zero Chern number systems in an intrinsically many-body fashion in terms of the momentum of the ground state in the presence of magnetic flux. Reference [40] earlier studied the momentum of magnetic flux and mentioned its quantization by rotational symmetries. We note that the definition of the magnetic translation operator in a magnetic field, which is used to compute the momentum, has a number of ambiguities that were not fully considered in these previous works. References [19,20] both asserted that the polarization is not well defined in the presence of nonzero Chern number, which disagrees with our results in the case where we have both translational and rotational symmetry. Reference [37] defines the polarization for systems with C \u00bc 0 and zero magnetic field via Wannier representation theory, and characterizes it in terms of a fractional charge bound to lattice defects with nontrivial Burgers vector. Reference [41] also finds that lattice dislocations can have fractionally quantized charges in a rotationally symmetric system; here it appears that C \u00bc 0 is being implicitly assumed. We emphasize that our definition of fractional charge of the lattice defects differs from the definition presented in Refs. [37,41]."
        },
        {
            "heading": "B. Organization of paper",
            "text": "The rest of the paper is organized as follows. In Sec. II we summarize our main results. In Sec. III we review some basic properties of lattice defects. In Secs. IV and V we\npresent detailed results for So and P\u20d7o, respectively, on the square lattice, highlighting the various subtleties that arise in matching the field theory to numerics. Section VI does the same for M \u00bc 2, 3, 6. In Sec. VII we discuss the origin dependence of So; P\u20d7o from a field theory perspective. We then conclude and discuss future directions."
        },
        {
            "heading": "II. OVERVIEW OF MAIN RESULTS",
            "text": "We consider a gapped phase of matter with the symmetry group\nG \u00bc U\u00f01\u00de \u00d7\u03d5 \u00bdZ2 \u22ca ZM ; \u00f01\u00de where Z2 denotes magnetic lattice translations and ZM for M \u00bc 2, 3, 4, 6 denotes point group rotations [42]. The symbol \u00d7\u03d5 implies that the magnetic translation operators, generated by T\u0303x; T\u0303y, obey the algebra T\u0303\u22121y T\u0303\u22121x T\u0303yT\u0303x \u00bc ei\u03d5N\u0302 , where N\u0302 is the total fermion number. The tilde indicates that the definition of the operator involves a U(1) gauge transformation. The charge conservation and translation symmetries allow us to define a charge per unit cell \u03bd. Each unit cell can be divided into M subcells with equal flux \u03d5sub. The total flux per unit cell is then \u03d5 \u00bc M\u03d5sub. Note that for our purposes, depending on the microscopic model we may need to specify the flux within even smaller subregions of the unit cell. Therefore we assume that the 2D system is embedded in a continuum, and that the magnetic field B is specified at each continuum point. This allows us to specify \u03d5;\u03d5sub exactly as real numbers, even though the symmetry only requires us to define \u03d5 mod 2\u03c0. We comment further on this in Sec. IV. Let C be the Chern number of the system. We then define the integer:\n\u03ba \u2261 \u03bd \u2212 C \u03d5 2\u03c0 : \u00f02\u00de\n\u03ba is a Z topological invariant for the system if \u03d5 is known exactly (and not just modulo 2\u03c0). Fixing C and \u03d5, if the charge per unit cell increases by an integer l, then \u03ba \u2192 \u03ba \u00fe l. For further intuition about \u03ba and a heuristic derivation of Eq. (2), see Appendix A 1 d. For a given high symmetry point o of the lattice unit cell, we will see that one can define a set of topological invariants fSo; P\u20d7og. The transformation of fSo; P\u20d7og under a change of o is fully determined if o is preserved by aZM rotation symmetry group. Therefore, it is sufficient to specify fSo; P\u20d7og for a single such o. A subtle point is that the definition of the invariants requires a choice of operators that represent the symmetry group elements. In this work, we take C\u0303M;o to be a \u201cmagnetic\u201d rotation operator about o (a spatial rotation combined with a gauge transformation), such that\n031005-3\n\u00f0C\u0303M;o\u00deM \u00bc 1. If we change this choice by C\u0303M;o \u2192 C\u0303M;oei\u00f02\u03c0=M\u00de\u03c7N\u0302 for some real number \u03c7, then the invariant So also transforms, So \u2192 So \u00fe \u03c7C. Nevertheless, we will see that there are canonical choices for C\u0303M;o that can be made. We caution that the vector P\u20d7o we refer to throughout the text is different from the standard charge polarization vector P\u20d7o, which for zero Chern number satisfies j \u00bc \u2202tP\u20d7o, where j is the induced current. We show in Appendix B that\n\u00f0Po;x;Po;y\u00de \u00bc \u00f0Po;y;\u2212Po;x\u00de \u00bc P\u20d7o \u00d7 z\u0302: \u00f03\u00de\nHowever, since P\u20d7o appears most naturally in our theory, we work in terms of P\u20d7o throughout and refer to it as the polarization, recognizing this as a slight abuse of terminology."
        },
        {
            "heading": "A. Warm-up: C4 symmetric lattice",
            "text": "We first illustrate our main results for the square lattice. A representative unit cell with high symmetry points \u03b1 (unit cell center), \u03b2 (unit cell vertices), \u03b3i (edge centers) is shown in Fig. 2. The points \u03b31, \u03b32 are not translation equivalent but are related by rotations about \u03b1. \u03b1; \u03b2; \u03b3 refer to maximal Wyckoff position (MWPs), which are collections of points related by lattice symmetries; the precise definition of a MWP is given in Appendix A. \u03b1 and \u03b2 have an order 4 site symmetry group generated by the magnetic rotation operators C\u03034;\u03b1; C\u03034;\u03b2 (which also include a gauge transformation), with C\u030344;\u03b1 \u00bc C\u030344;\u03b2 \u00bc 1. The point \u03b3 has an order 2 site symmetry group generated by the operator C\u03032;\u03b3, with C\u030322;\u03b3 \u00bc 1. We can pick any of these points as our origin o. First we define the invariants So; P\u20d7o for each possible HSP o and list their properties; thereafter, we explain how to use them to characterize the topological phase of the given system. Suppose o \u00bc \u03b1 or \u03b2. Then, So is defined mod 4 and can take one of four possible values for a fixed Chern number C. Next, suppose o \u00bc \u03b3, which is a C2 symmetric\npoint. Then S\u03b3 is only defined mod 2. In all cases, we have the constraint [33]\nSo mod 1 \u00bc C 2 mod 1: \u00f04\u00de\nWe next turn to P\u20d7o. For o \u00bc \u03b1, \u03b2,\nP\u20d7o \u2208 \u00f00; 0\u00de;\n1 2 ; 1 2\n; \u00f05\u00de\nup to integer vectors. We write\nP\u20d7o \u00bc Po 2 \u00f01; 1\u00de \u00f06\u00de\nin this case; Po is an integer defined mod 2. For o \u00bc \u03b3, there are four possible choices:\nP\u20d7\u03b3 \u2208 \u00f00; 0\u00de;\n1 2 ; 0 ; 0; 1 2 ; 1 2 ; 1 2\n; \u00f07\u00de\nup to integer vectors. So; P\u20d7o for a C4 symmetric point, together with \u03ba, determines So0 ; P\u20d7o0 for all other o0. For example,\nfS\u03b2;P\u03b2; \u03bag \u00bc fS\u03b1 \u00fe 2P\u03b1 \u2212 \u03ba;P\u03b1 \u00fe \u03ba; \u03bag: \u00f08\u00de\nIf we only know S\u03b3; P\u20d7\u03b3; \u03ba, we can determine P\u20d7\u03b1 and P\u20d7\u03b2 fully, but can only determine S\u03b1 and S\u03b2 mod 2 and not mod 4. The relevant formulas are given in Table I. Thus, to fully specify So; P\u20d7o for each high symmetry point in the unit cell, we need to determine them for some o with the largest possible site symmetry group. In Fig. 1, we show colored Hofstadter butterflies for two different origins\u03b1,\u03b2 extracted for the square latticeHofstadter model of spinless fermions. We find that fS\u03b2;S\u03b1;P\u03b2;P\u03b1g follow the empirical equations Eqs. (41), (42), (52), and (53), respectively. In this figure, \u03b2 corresponds to a site and \u03b1 to a plaquette center, where there is no site. To distinguish two phases of matter based on So; P\u20d7o (assuming C, \u03ba and all other invariants are equal), we first fix a common origin o (which must be a C4 symmetric point) and find So; P\u20d7o for the two systems. If their values are not equal, the two systems cannot be adiabatically connected to each other in a symmetry-preserving manner. It is important to note that comparing the crystalline topological invariants of two phases is only meaningful after fixing a common origin."
        },
        {
            "heading": "B. Basic properties and classification for fSo;P\u20d7og",
            "text": "We now generalize the above discussion to the case with M \u00bc 2, 3, 4, 6 [43]. In Table II we define the 2 \u00d7 2matrices\n031005-4\nU\u00f02\u03c0=M\u00de, corresponding to elementary 2\u03c0=M rotations around an origin o withM-fold rotational symmetry. These describe the action of the rotation operator C\u0303M;o on space. As above, we fix \u00f0C\u0303M;o\u00deM \u00bc \u00fe1. Then for any given o which is fixed under an order-M rotation, fSo; P\u20d7og have a ZM \u00d7 KM classification, where KM \u00bc fZ2 \u00d7 Z2;Z3;Z2;Z1g for M \u00bc 2, 3, 4, 6. A derivation is given in Appendix A. More specifically, So is an integer or half-integer defined modulo M, and it satisfies Eq. (4). P\u20d7o is a two-component vector with the following quantization condition and equivalence relation:\n\u00bd1 \u2212 U\u00f02\u03c0=M\u00de P\u20d7o \u2208 Z2; P\u20d7o \u223c P\u20d7o \u00fe \u039b\u20d7; \u039b\u20d7 \u2208 Z2: \u00f09\u00de\nFor fourfold and sixfold point groups, it is possible for the HSP o to only be invariant under a smaller M0-fold rotation. For example, we can haveM0 \u00bc 2whenM \u00bc 4, or M0 \u00bc 2, 3 when M \u00bc 6. In these cases, the possible values of fSo; P\u20d7og have a ZM0 \u00d7 KM0 classification. The relations defining them are as above, with M replaced by M0. It will be convenient to parametrize P\u20d7o in the following way:\nHere M0 is the maximal integer such that o is a fixed point under rotations of order M0. Po can take any integer value according to the KM0 classification. For example, when M0 \u00bc 2, there are four inequivalent choices for P\u20d7o: P\u20d7o\u2208f\u00f00;0\u00de;\u00f01=2;0\u00de;\u00f00;1=2\u00de;\u00f01=2;1=2\u00deg. When M0 \u00bc 3, there are three inequivalent choices: P\u20d7o \u2208 f\u00f00; 0\u00de; \u00f01=3; 2=3\u00de; \u00f02=3; 1=3\u00deg. This is derived in Appendix A 3 a. Next we discuss the origin dependence of So; P\u20d7o. If we shift o \u2192 o0 \u00bc o\u00fe \u00f0vx; vy\u00de, then we can determine fSo0 ; P\u20d7o0 g from fSo; P\u20d7og and \u03ba, as specified in Table I. Note that \u00f0vx; vy\u00de can be fractions of a lattice unit. For fSo0 ; P\u20d7o0 g to be fully specified in terms of fSo; P\u20d7og, the minimal rotation angle which preserves o0 must be a multiple of the minimal rotation angle which preserves o. In other words, the site symmetry group of o0 is isomorphic to a subgroup of the site symmetry group of o. For example, if o and o0 have site symmetry groups Z4 and Z2, respectively, then fSo0 ; P\u20d7o0 g can be determined using the M \u00bc 2 entry of Table I. Thus, in order to obtain a complete specification for each high symmetry point, we need to know fSo; P\u20d7og for at least one o which is invariant under an M-fold rotation. Otherwise we will not be able to fully recover fSo0 ; P\u20d7o0 g for each o0. Note, in particular, that the dependence of P\u20d7o on o is completely determined by \u03ba, and the dependence of So on o is completely determined by P\u20d7o and \u03ba. Nevertheless, differences\n\u0394S \u00bc So\u00f0\u03bb1\u00de \u2212So\u00f0\u03bb2\u00de; \u0394P\u20d7 \u00bc P\u20d7o\u00f0\u03bb1\u00de \u2212 P\u20d7o\u00f0\u03bb2\u00de \u00f011\u00de\nare independent of o. Here \u03bb is some tuning parameter in the Hamiltonian, H\u00bd\u03bb , which keeps the invariant \u03ba fixed and preserves the crystalline symmetry. This can be done, for example, by fixing f\u03bd;\u03d5subg. The reason we need to fix \u03ba is discussed in Sec. VII A. Note that if we have a solid-state system of electrons with some background positive charge due to ions, then the total polarization of the system will be P\u20d7tot \u00bc P\u20d7o \u00fe P\u20d7ion;o. If we assume that the ions have a charge of \u03ba per unit cell, then the origin dependence cancels and P\u20d7tot becomes origin independent. In realistic systems, the excess charge per unit cell \u03bd \u2212 \u03ba will be neutralized by a metallic gate, which we would ignore to compute the total polarization. As another example, if we take M \u00bc 3, we have three maximal Wyckoff positions invariant under threefold rotation symmetry: \u03b1, \u03b2, and \u03b3, with \u03b2 \u00bc \u03b1\u00fe \u00f01=3; 1=3\u00de and \u03b3 \u00bc \u03b1\u00fe \u00f0\u22121=3; 2=3\u00de (see Fig. 2). Then,\nfS\u03b2;P\u03b2; \u03bag \u00bc fS\u03b1 \u2212P\u03b1 \u2212 \u03ba;P\u03b1 \u2212 \u03ba; \u03bag; fS\u03b3;P\u03b3; \u03bag \u00bc fS\u03b1 \u00feP\u03b1 \u2212 \u03ba;P\u03b1 \u00fe \u03ba; \u03bag: \u00f012\u00de\nM 2 3 4 6\nU\u00f02\u03c0=M\u00de \u22121 0 0 \u22121\n\u22121 \u22121 1 0\n0 \u22121 1 0\n0 \u22121 1 1\n031005-5"
        },
        {
            "heading": "C. Extracting fSo;P\u20d7og from microscopic models",
            "text": "For a given microscopic model, we can extract fSo; P\u20d7og in several distinct ways, as summarized in Table III. To set up the calculations, we first need to fix a rotation operator C\u0303M0;o , where the high symmetry point o is invariant under 2\u03c0=M0 rotations and M0 \u2264 M. In our examples we always choose this operator so that \u00f0C\u0303M0;o \u00deM0 \u00bc \u00fe1. We also define translation operators T\u0303x, T\u0303y corresponding to the elementary lattice vectors x, y, which obey the magnetic translation algebra. Our numerical procedure is guided by a topological response theory derived using TQFT ideas [14,17,18]. This gives a Lagrangian density in terms of background gauge fields:\nL \u00bc C 4\u03c0 A \u2227 dA\u00feSo 2\u03c0 A \u2227 d\u03c9\u00fe P\u20d7o 2\u03c0 \u00b7 A \u2227 T\u20d7 \u00fe \u03ba 2\u03c0 A \u2227 AXY\n\u00fe els 4\u03c0 \u03c9 \u2227 d\u03c9\u00fe P\u20d7s 2\u03c0 \u00b7 \u03c9 \u2227 T\u20d7 \u00fe \u03bds 2\u03c0\n\u03c9 \u2227 AXY \u00fe : \u00f013\u00de\nHere, A is a background U(1) gauge field, and is defined so that R dA represents the full magnetic field (and not just its\ndeviation from some background value), \u03c9 is a background ZM \u201crotation\u201d gauge field, which is treated as a real field with quantized holonomies. AXY and T\u20d7 are the area element and torsion 2-form, respectively, which are constructed using translation gauge fields. The notation is described more fully in Appendix F. Importantly, the coefficients of these terms are all quantized in specific patterns and defined modulo certain equivalence relations, which can be systematically derived for bosonic systems using group cohomology [17]. We are only concerned with the first four terms, which have the coefficients C;So; P\u20d7o; \u03ba. In this paper, we carry out a derivation of the quantization conditions on P\u20d7o in the case of fermionic systems using a general theory of invertible fermionic phases developed in Ref. [14] (see Appendix F of this paper). We show that the quantization conditions on P\u20d7o in invertible fermionic systems (i.e., without fractionalized excitations) are the same as for invertible bosonic\nsystems, in contrast to the Chern number and discrete shift [33]."
        },
        {
            "heading": "1. fSo;P\u20d7og from fractional charge of lattice disclinations and dislocations",
            "text": "Given the magnetic rotation operator C\u0303M0;o about a high symmetry point o and translation operators T\u0303x, T\u0303y , and the Hamiltonian for the clean system with the full crystalline symmetry Hclean, one can define a Hamiltonian in the presence of a lattice disclination or dislocation Hdefect. This is done through a cut-and-glue procedure described in Appendix C. Hdefect is uniquely defined up to local operators at the core of the defect. In our numerics we take Hclean to be a free fermion Hofstadter model, usually with nearest-neighbor hopping terms, but our methods conceptually apply more generally, as we discuss in Secs. IV and VI. In Appendix H, we demonstrate that the dislocation charge calculation generalizes naturally to Hamiltonians with next-nearest-neighbor hopping. A lattice disclination has a nonzero disclination angle \u03a9\n(Frank angle \u2212\u03a9), and b\u20d7o is the Burgers vector. Here, the subscript o means that the Burgers vector is measured by the holonomy of a loop encircling the defect, which starts at the point o. Note that o and o need not be equal in general. As we explain in Sec. III, for a disclination with \u03a9 \u2260 0, the value of b\u20d7o as defined above depends on o. However, for a lattice dislocation, which has \u03a9 \u00bc 0, the value of b\u20d7o is independent of o. We can compute the fractional charge in the ground state, QW mod 1, in a large region W surrounding a lattice disclination or dislocation. We require that the boundaries of the regionW align with the boundaries of the unit cell \u0398. The linear size of W must be much larger than the correlation length. We first define the charge in a regionW:\nQW \u00bc X i\u2208W wt\u00f0i\u00deQi; \u00f014\u00de\nwhere the weight wt\u00f0i\u00de \u00bc 1 if i is in the interior ofW, while if i lies on the boundary \u2202W, 2\u03c0wt\u00f0i\u00de is the angle subtended by \u2202W in the interior of W at i. Qi is the charge on site i in the ground state of Hdefect. An example is shown in Fig. 6.\n031005-6\nUsing Eq. (13) along with Eq. (2), we then find\nQW \u00bc C \u03a6W 2\u03c0 \u00fe So \u03a9 2\u03c0 \u00fe P\u20d7o \u00b7 b\u20d7o \u00fe \u03banW;o mod 1 \u00f015\u00de\n\u00bc C \u03b4\u03a6W;o 2\u03c0 \u00fe So \u03a9 2\u03c0 \u00fe P\u20d7o \u00b7 b\u20d7o \u00fe \u03bdnW;o mod 1: \u00f016\u00de\n\u03a6W is the total flux through the region W. nW;o is the number of unit cells in W, and may be fractional. \u03a6W has two contributions, \u03a6W \u00bc \u03d5nW;o \u00fe \u03b4\u03a6W;o. Here, \u03d5nW;o is the reference background flux within W. \u03b4\u03a6W;o is the excess magnetic flux in the region W relative to this reference. The precise microscopic definitions of \u03b4\u03a6W;o and nW;o are quite subtle and nontrivial and explained in detail in Secs. IV\u2013VI. Importantly, \u03b4\u03a6W;o and nW;o in general depend on the position of o relative to the chosen unit cell \u0398. Nevertheless, the final results for So and P\u20d7o are independent of \u0398. This is explained using the trimming method developed in Appendix D. Naively it may seem that the coefficients in Eq. (15) should also depend on o . One reason for our notation is that Eq. (15) comes from a TQFT which is only sensitive to o. But even in microscopic calculations, we find that neither So nor P\u20d7o actually depends on o . This is easily seen for P\u20d7o, which can be defined using pure dislocations, for which\u03a9 \u00bc 0 and o does not appear. To show thatSo is independent of o , we give a theoretical argument when C \u00bc 0, in Appendix B 3. We also have extensive numerical evidence for this when C \u2260 0. The above discussion implies that we can consider any\ndefect Hamiltonian, and extract So and P\u20d7o (which only depend on o) by suitably defining \u03b4\u03a6W;o and nW;o along with the appropriate Burgers vector. To simplify the disclination charge calculation of So we often choose o \u00bc o , but this is not a requirement of the theory."
        },
        {
            "heading": "2. So from angular momentum",
            "text": "Alternatively, we can examine the action of rotations and translations on the ground state in order to extract an angular momentum or linear momentum. These dual responses are a valuable consistency check on the value of So obtained from the above charge response. Importantly, to compare the values of discrete shift from the disclination charge and angular momentum calculations, we need to set o \u00bc o in both cases. Let j\u03a8\u00f0m\u00dei be the ground state of the clean translationally invariant system on a torus in the presence of m flux quanta, m being an integer. Then,\nC\u0303M0;oj\u03a8i \u00bc e2\u03c0ilo=M0 j\u03a8i; \u00f017\u00de\nwhere recall that M0 is the largest integer such that o is invariant under 2\u03c0=M0 rotations centered at o. We find that the angular momentum lo obeys the formula\nlo\u00f0m\u00de \u00bc Som\u00fe C m2\n2 \u00fe K\u00f0C;L\u00de mod M0; \u00f018\u00de\nwhere K\u00f0C;L\u00de is a constant independent of m, depending on the system size L and the Chern number C. The numerical data of lo are shown in Fig. 18. For j\u03a8i to be an eigenstate of C\u0303M0;o, appropriate global holonomies of the background gauge field and certain commensurate system sizes must be chosen, as discussed in Ref. [33]. We note that one can also recover So by locally inserting flux and performing partial rotations [33]."
        },
        {
            "heading": "3. P\u20d7o from linear momentum",
            "text": "The topological field theory, Eq. (13), predicts that the polarization P\u20d7o also specifies the linear momentum of U(1) flux [17]. We have found empirically that P\u20d7o can be extracted by studying expectation values of an approximate translation operator, as we briefly summarize below. See Sec. V for additional details. Suppose we wish to measure Po;y on the square lattice. We consider a state on a clean torus with m \u00bc \u00f0\u03d5=2\u03c0\u00deLxLy total flux quanta, where Lx, Ly are the number of unit cells in the x and y directions. While the infinite plane possesses an infinite magnetic translation symmetry along the two directions, on the torus with magnetic flux it is not possible to fully preserve translation symmetry along y unless m=Ly \u00bc \u00f0\u03d5=2\u03c0\u00deLx is an integer. For general m, on the torus we can insert the flux using a Landau-like gauge that is almost translation symmetric along y, except for a small strip which forms a cycle along y. We then define an approximate translation operator:\nT\u0303y \u2254 T\u0302ye i P j \u03bbjc \u2020 j cj : \u00f019\u00de\nThe expectation value of T\u0303y defines the linear momentum p\u03bb;y in the y direction:\nh\u03a8\u00f0m\u00dejT\u0303yj\u03a8\u00f0m\u00dei \u00bc e\u2212\u03b3\u00fei2\u03c0p\u03bb;y : \u00f020\u00de In our numerics we define \u03bb using Eq. (59). In particular, we find empirically that there exist special choices of \u03bb for which p\u03bb;y determines the quantized polarization Po;y throughout the Hofstadter butterfly, as follows. We find that for the Hofstadter model, for appropriately chosen \u03bb, the amplitude e\u2212\u03b3\u00f0m\u00de in general oscillates as a function of m and it vanishes for certain special values of m. Whenever the amplitude is nonzero, the linear momentum is found to obey the following relation:\np\u03bb;y\u00f0m\u00de \u00bc \u2212Po;ym\u00fe Ky mod 1; \u00f021\u00de\n031005-7\nwhere Ky is piecewise constant in m (it can jump at the values of m where the amplitude vanishes). The numerical data of p\u03bb;y are shown in Fig. 18. The origin o is determined as follows. We first define a point o\u0304, referred to as the \u201cgauge origin\u201d for the vector potential, which has the property that the holonomy of the vector potential is trivial along the x and y cycles of the torus that meet at o\u0304 [see Eq. (56)]. Then the origin o used to obtain P\u20d7o is expressed in terms of o\u0304; see Eq. (61). In defining T\u0303y we in principle have the freedom to combine it with an arbitrary global U(1) rotation:\nT\u0303y \u2192 T\u0303yei\u03c7N\u0302 ; \u00f022\u00de\nwhich corresponds to a shift \u03bbj \u2192 \u03bbj \u00fe \u03c7 for each j. Once o is fixed, then \u03c7 is fixed to be an integer multiple of \u03d5 by fixing the flux through a dislocation created using T\u0303y , as explained in Sec. Vand Appendix C. Thus we only need to consider the case where\n\u03c7 \u00bc \u03d5vx \u00bc 2\u03c0m LxLy vx; \u00f023\u00de\nfor some integer vx. Under such a shift in T\u0303y ,\np\u03bb;y \u2192 p\u03bb;y \u00femvx\u03bd\n\u00bc p\u03bb;y \u00femvx Cm LxLy \u00fe \u03ba : \u00f024\u00de\nIf we consider only the term linear in m, this implies that\nPo;y \u2192 Po;y \u2212 \u03bavx \u00bc Po;y mod 1: \u00f025\u00de\nNote that one could consider the case where vx is fractional but quantized, and this would effectively correspond to a shift of the HSP o by \u00f0vx; 0\u00de to a different HSP, as we explain in Sec. V. Analogous equations hold for Po;x, if we instead start with a Landau-like gauge along x. Furthermore, our procedure straightforwardly generalizes to rotational symmetries of order M \u00bc 2, 3, 4, 6; we discuss this in Sec. VI D. We have also measured P\u20d7o by studying the expectation values of a partial translation operator T\u0303yjD, which is T\u0303y restricted to some suitably chosen region D. This method also allows us to extract a quantized P\u20d7o consistent with dislocation charge, for a suitable choice of o\u0304 and of the region D, when M is even. We discuss this further in Secs. V and VI D."
        },
        {
            "heading": "4. P\u20d7o from dimensional reduction and 1D polarization",
            "text": "One can also define a 1D polarization along the i\u0302 direction by treating the system as an effectively 1D system\nalong i\u0302. Let us first consider i\u0302 \u00bc x\u0302. Then we can calculate the 1D polarization using Resta\u2019s formula [25]:\nPO;x \u00bc 1 2\u03c0 argh\u03a8jei\u00f02\u03c0=Lx\u00de\nP j jxn\u0302j j\u03a8i: \u00f026\u00de\nThe above expression depends on a choice of origin Ox for jx, which we make explicit, i.e., jx \u2208 f\u2212Ox; 1 \u2212Ox; 2 \u2212Ox;\u2026; Lx \u2212 1 \u2212Oxg. Empirically, we find that\n\u2212PO;x \u00bc Ck\u03d5 2\u03c0 Ly \u00fe LyPo;y \u00fe K0 mod 1; \u00f027\u00de\nwhere k \u2254 \u00f0Lx=2\u00de \u2212 o\u0304x \u00feOx. Knowing the value of k is not crucial in extractingPo;y. This result agrees with a field theory prediction which we derive in Sec. V D. Similar to the linear momentum calculation, we extract a\nvalue of P\u20d7o that is consistent with other approaches only when o, O satisfy a certain relation; see Eq. (75). This calculation is independent of the specific details of the gauge, as long as \u03a6y is linear in \u03d5. The full discussion is contained in Sec. V D."
        },
        {
            "heading": "III. BASIC PROPERTIES OF LATTICE DEFECTS",
            "text": "Before discussing the numerical calculations in detail, we review some useful background material on lattice defects and their properties. A more extensive background review is found in Appendix A. The quantum mechanical details of constructing a defect Hamiltonian Hdefect through a cut-and-glue procedure are described in detail for dislocation defects in Appendix C. We illustrate the procedure for constructing a dislocation defect in Fig. 3. First we make a cut on an infinite clean lattice and define the left (L) and right (R) sides of the cut. We replace all bonds that cross the cut so that a point Li, originally connected to some point Ri, is now connected to Ri\u00feb\u20d7 . Here b\u20d7\nis an integer vector related to the dislocation Burgers vector, which we define below. We illustrate the construction of a disclination defect in Fig. 4. We draw two rays l1, l2 which meet at the point o , such that l2 is obtained from l1 by rotating about o through the angle\u03a9 > 0. Now we delete all points within the wedge enclosed by l1 and l2, except those that lie exactly on l1. We then reconnect the bonds so that a link i1j (where i1 lies on l1) is replaced by a link i1j0, where j0 is obtained from j upon rotating by \u03a9 about o . The disclination angle \u03a9 can be directly measured from the defect lattice alone. It is the angle by which a unit vector is rotated upon being parallel transported around the defect. \u201cPure\u201d dislocation defects are those with zero disclination angle. They are characterized by a dislocation Burgers vector b\u20d7, which is defined as follows. Starting from a point o, consider a sequence of lattice translations which encircles the defect (and no other defects) in\n031005-8\ncounterclockwise fashion, and ends at o. For a dislocation, the sum of these translations will not equal zero, but instead some integer vector, which we define as b\u20d7. The above dislocation construction gives two dislocations at the two ends of the cut, with b\u20d7 \u00bc b\u20d7 . For a pure dislocation, the shape of the loop and the choice of o do not affect the value of b\u20d7. The Burgers vector of a disclination with \u03a9 \u2260 0 can be measured similarly; note that o and o need not be related. Importantly, the Burgers vector when \u03a9 \u2260 0 sensitively\ndepends on the choice of o, assuming o is fixed. If we shift o \u2192 o\u00fe v\u20d7, then\nb\u20d7o\u00fev\u20d7 \u00bc b\u20d7o \u00fe \u00bd1 \u2212 U\u00f0\u03a9\u00de v\u20d7: \u00f028\u00de\nThis is derived in Appendix A. As an illustration, Fig. 5 shows the same \u03a9 \u00bc \u00f02\u03c0=3\u00de disclination but with different Burgers vectors depending on the choice of o. Since choosing v\u20d7 \u00bc \u039b\u20d7 to be an integer vector should give us an equivalent characterization of the defect, we have the equivalence:\nb\u20d7o \u2243 b\u20d7o \u00fe \u00bd1 \u2212U\u00f0\u03a9\u00de \u039b\u20d7: \u00f029\u00de\nThus, if v\u20d7 is fractional, b\u20d7o\u00fev\u20d7 will not be equivalent to b\u20d7o. If \u03a9 \u00bc \u00f02\u03c0k=M0\u00de where k, M0 are coprime, the distinct classes of Burgers vectors form a group KM0 as defined in Sec. II. Note that our construction ensures the following relation:\nb\u20d7o \u2243 \u00f00; 0\u00de; \u00f030\u00de\n031005-9\nwhich can be verified by constructing the various classes of disclinations forM \u00bc 2, 3, 4, 6. Setting o \u00bc o thus ensures that the defect has trivial Burgers vector. This is a convenient choice to make in the following sections. Note that we sometimes also use the notation b\u20d7o \u2208 \u00bd\u00f00; 0\u00de to indicate that b\u20d7o is in the same equivalence class of (0, 0)."
        },
        {
            "heading": "IV. CALCULATION OF So ON THE SQUARE LATTICE",
            "text": "This section and the next are devoted to numerically checking the predictions of the field theory for the square lattice. This section reviews and generalizes the main results from Ref. [33]. Analogous calculations for M \u00bc 2, 3, 6 are discussed in Sec. VI. We fix our origin at a HSP o which has fourfold rotational symmetry. There are two choices, \u03b1 and \u03b2, as shown in Fig. 2. \u03b1 denotes the center of the unit cell, while \u03b2 denotes a corner. For calculations on the simplest square lattice, we pick the unit cell shown in Fig. 6(c), where \u03b1 corresponds to a plaquette center and \u03b2 corresponds to a site. Note that the formulas for o \u00bc \u03b3 are contained in the discussion for C2 symmetric systems given in Sec. VI. For either choice of o, we have two topological invariants, So and P\u20d7o \u00bc 12Po\u00f01; 1\u00de. So is defined mod 4 and satisfies So \u00bc \u00f0C=2\u00de mod 1. Po is an integer defined mod 2. We extract So in two physically different ways, through the disclination charge and the angular momentum of flux. The exact choice of unit cell does not affect the final result; we show this in Appendix D."
        },
        {
            "heading": "A. Symmetry operators",
            "text": "First we define the magnetic rotation operator C\u03034;o which is used to create a disclination centered at o \u00bc \u03b1, \u03b2:\nC\u03034;o \u2261 C\u03024;o ei P j \u03bbjc \u2020 j cj : \u00f031\u00de\nWe require that a system with a pure disclination at o\nconstructed using C\u03034;o has flux \u03d5 in each regular unit cell. This condition forces C\u030344;\u03b2 \u00bc \u00fe1 [33]. When o \u00bc \u03b2, all unit cells are regular, and then this condition in fact completely fixes \u03bbj; this is an example where there is a unique canonical choice for the rotation operator C\u03034;o (once the Hamiltonian is fixed). For consistency in the definitions of our operators, we demand that C\u030344;\u03b1 \u00bc \u00fe1 as well. We also define translation operators T\u0303x and T\u0303y which obey the magnetic translation algebra:\nT\u0303\u22121y T\u0303\u22121x T\u0303yT\u0303x \u00bc ei\u03d5 P j c\u2020j cj : \u00f032\u00de\nThe gauge transformations used to define the translation operators are discussed in Sec. V.\nB. Construction of clean Hamiltonian Hclean In our numerical work we consider the Hofstadter model, which has a spinless free fermion Hamiltonian of the form\nHclean \u00bc \u2212 X hiji tijc \u2020 i cj \u00fe H:c:; \u00f033\u00de\nwhere the nearest-neighbor hopping terms tij \u00bc teiAclean;ij depend on a background vector potential Aclean, which assigns flux \u03d5 per unit cell. The parameters in Hclean are discussed in detail in Appendix A. Although we mainly consider nearest-neighbor hopping in our numerics, our theoretical predictions as well as our numerical scheme apply much more generally. For\n031005-10\nexample, we can consider arbitrary next-neighbor hoppings. To illustrate this, in Appendix H we give evidence showing that invariants extracted numerically in the square lattice Hofstadter model remain well defined upon adding next-neighbor hopping terms. Below we also argue that our procedure works if Hclean has N-body interaction terms for N > 2. An important point is that we require the magnetic field B to be defined everywhere within the unit cell. This means that the total magnetic flux within any subregion of the unit cell is specified as a real number. This requirement goes beyond what is directly specified by the crystalline symmetry (which only demands flux \u03d5 mod 2\u03c0 per unit cell). But it is a physically natural requirement, since the most general lattice models with the given symmetry have some small amount of further neighbor hopping, between different points within a single unit cell. In fact, specifying a nearest-neighbor Hamiltonian with just \u03d5 mod 2\u03c0 is ill defined in a sense, because it does not specify how to consistently perturb the model with further neighbor hopping terms. Such a specification requires a choice of \u03d5 as a real number, not just modulo 2\u03c0."
        },
        {
            "heading": "C. So from disclination charge",
            "text": "1. Construction of defect Hamiltonian Hdefect Start with a clean lattice Hamiltonian Hclean which depends on a background U(1) vector potential Aclean through the variables eiAij;clean . Suppose we create a lattice disclination (a detailed construction can be found in Ref. [33]), and arrive at a defect Hamiltonian Hdefect\u00bdeiAij;defect through a cut-and-glue procedure. Here Adefect is the vector potential on the defect lattice. Note that irregular unit cells may exist at the center of each defect. For example, there could be a triangular unit cell at the center of an \u03a9 \u00bc \u00f0\u03c0=2\u00de disclination [see Fig. 6(b)], or a triangular unit cell at the center of a square lattice dislocation (see Fig. 7). Irregular unit cells can have different shapes depending on the value of M. Away from the defect, the flux in any region is fully determined by Aclean, and we can ensure that the system has flux \u03d5 per unit cell. However, the flux in the immediate vicinity of the defect depends on Aclean as well as on the definition of the symmetry operator which creates the defect. In particular, if we require a specific value of flux in the unit cells immediately adjacent to the defect, there will be a constraint on the definition of the symmetry operators we use."
        },
        {
            "heading": "2. Charge prediction from field theory",
            "text": "Having fixed Hdefect, we compute the charge QW in a region W containing the defect. We always require that the boundary of W coincides with the boundary of a unit cell. This ensures that the only irregular unit cells in W are near the center of the defect. QW is defined by the formula\nQW \u00bc X i\u2208W wt\u00f0i\u00deQi: \u00f034\u00de\nThe weights wt\u00f0i\u00de are defined in Sec. II; this definition ensures that QW \u00feQW0 \u00bc QW\u2294W0 when two regionsW,W0 overlap only on their boundaries, as required by the response theory. Note that the value of QW depends on the definition of the unit cell. This method of measuring QW applies to any local gapped Hamiltonian, even if it has interaction terms. As long as the system has a correlation length much smaller than the linear size of W, the ambiguity in Hdefect near the defect core will not affect the value of QW for sufficiently large W. The next issue is how to assign this charge to the different terms in the response theory, which predicts that for large enough W,\nQW \u00bc C \u03b4\u03a6W;o 2\u03c0 \u00feSo \u03a9 2\u03c0 \u00fe P\u20d7o \u00b7 b\u20d7o \u00fe \u03bdnW;o mod 1: \u00f035\u00de\nHere\u03a9 and b\u20d7o are the disclination angle and Burgers vector of the defect, respectively. We fix b\u20d7o \u00bc \u00f00; 0\u00de throughout this section, so the term with P\u20d7o does not contribute (this is equivalent to saying that o \u00bc o ). The parts of this equation which require special care are \u03b4\u03a6W;o and nW;o [44]. We discuss how to define these below.\n3. Definition of \u03b4\u03a6W;o and nW;o \u03b4\u03a6W;o is, intuitively, the excess flux in the region W. To define the excess flux, we must compute the flux inW, and compare it to some background reference flux. There are two possibilities. If o \u00bc \u03b2, then all unit cells in W are\n031005-11\nregular [see Fig. 6(a)], and nW;\u03b2 \u00bc 0 mod 1. Here \u03b4\u03a6W;o\u00bc0 if all unit cells have flux \u03d5. On the other hand, if o \u00bc \u03b1, then there is an irregular unit cell at the disclination core [see Fig. 6(b)]. In general, we can arrange to have at most one irregular unit cell in the core of the defect, with some flux \u03d5irreg which is determined by our choice of rotation operators. Its area is denoted nirreg;o, which can be fractional. Note that\nnW;o \u00bc nirreg;o mod 1: \u00f036\u00de\nThen, if we choose our symmetry operators so that the flux through each regular unit cell in Hdefect is \u03d5, we have\n\u03b4\u03a6W;o \u00bc \u03d5irreg \u2212 nirreg;o\u03d5: \u00f037\u00de\nThus the value of \u03b4\u03a6W;o depends on the value we assign to nirreg;o.\n4. Computation of nirreg;o If o \u00bc \u03b2, there are no irregular unit cells, as discussed above, so we simply define nirreg;\u03b2 \u00bc 0 mod 1. If o \u00bc \u03b1, we find nirreg;\u03b1 \u00bc 34 mod 1. A heuristic argument is that the cut-and-glue procedure for a \u03c0=2 disclination removes 1=4 of a unit cell at the disclination center; i.e., the irregular unit cell at the disclination core consists of three subcells. Each subcell contributes 1=4 of a full unit cell; therefore, nirreg;\u03b1 \u00bc 34 mod 1. (A consistency check on this result is to demand that the value of So corresponding to some physical point o be the same whether we choose the unit cell to satisfy o \u00bc \u03b1 or o \u00bc \u03b2. If nirreg;\u03b2 \u00bc 0 mod 1, we find it necessary to have nirreg;\u03b1 \u00bc 34 mod 1.) We note that the previous step involves another subtlety. Even if we know nirreg;o, there can be a further ambiguity in \u03b4\u03a6W;o. If nirreg;o is an integer, then Eq. (37) is perfectly well defined modulo 2\u03c0. However, if nirreg;o \u00bc a=b is a fraction with a, b coprime, \u03b4\u03a6W;o is not invariant under the transformation \u03d5 \u2192 \u03d5\u00fe 2\u03c0. To keep \u03b4\u03a6W;o invariant, we need to pick a lift of \u03d5 from \u00bd0; 2\u03c0\u00de to \u00bd0; 2\u03c0b\u00de. But this is why we insist on specifying the actual magnetic field everywhere in the unit cell. This fixes \u03d5 as a real number, not just mod 2\u03c0, and so fractions of \u03d5 can be defined unambiguously."
        },
        {
            "heading": "5. Computing So",
            "text": "For a \u03c0=2 disclination with b\u20d7o \u00bc \u00f00; 0\u00de, Eq. (35) predicts that\nSo 4 \u00bc QW \u2212 \u03bdnW;o \u2212 C \u03b4\u03a6W;o 2\u03c0 mod 1: \u00f038\u00de\nThis determines So=4 mod 1 in terms of well-defined quantities. Note that our procedure to define nirreg;o and\n\u03b4\u03a6W is independent of the details of the Hamiltonian, in particular if there are further neighbor hopping terms and interaction terms. Therefore we expect that So can be robustly extracted for any Hclean with a symmetric, gapped ground state."
        },
        {
            "heading": "D. Angular momentum of flux",
            "text": "We can also compute So from the angular momentum eigenvalues of C\u03034;o after inserting additional flux, if we set o \u00bc o . On the torus, there are two positions on the torus that are left invariant under a C\u03024;o rotation, o and o \u00fe \u00f0L=2; L=2\u00de. If L is odd, then the two positions are not the same point in the unit cell. This is deemed unnatural since we only want a single origin. Thus, we consider an even length system on a torus, insert m total flux quanta uniformly, and define\nC\u03034;oj\u03a8\u00f0m\u00dei\u2261 ei\u00f0\u03c0=2\u00delo j\u03a8\u00f0m\u00dei: \u00f039\u00de The field theory predicts that there will be a contribution to lo which equals Sm. Indeed, we numerically find that\nlo\u00f0m\u00de \u00bc Cm2\n2 \u00femSo \u00fe K\u00f0C;L\u00de mod 4: \u00f040\u00de\nThe numerical data are shown in Fig. 18. Additional technical details in these calculations, in particular a discussion of partial rotations, can be found in Ref. [33]."
        },
        {
            "heading": "E. Application to Hofstadter model",
            "text": "Reference [33] obtained So for the Hofstadter model, taking o \u00bc \u03b2 to be at a site. Here we also study the case where o \u00bc \u03b1 is at a plaquette center. The values of So obtained using both disclination charge and angular momentum are consistent. In the limit of small \u03d5 and \u03bd, our procedure also agrees with known results for continuum Landau levels, i.e.,So \u00bc C22 mod 4 for either o \u00bc \u03b2 or o \u00bc \u03b1. The Hofstadter butterflies for So are plotted in Fig. 1. We find that they obey the following empirical formulas (recall that \u03b2 is chosen to be a site). For C > 0,\nS\u03b2\u00f0\u03d5\u00de \u00bc C2\n2 \u2212 \u00f0C\u00fe 1\u00de C\u03d5 2\u03c0 \u00fe 2 X p=q<\u03d5=2\u03c0\nodd q\nC\u00fe q 2q mod 4;\n\u00f041\u00de\nwhere the third term of Eq. (41) we sum over all p=q in the Farey sequence of order C that satisfy \u00f0p=q\u00de < \u00f0\u03d5=2\u03c0\u00de and q odd. The value of S\u03b2 for C < 0 can be obtained from the transformation S\u03b2\u00f0\u03bc;\u03d5\u00de \u00bc 1 \u2212S\u03b2\u00f0\u2212\u03bc;\u03d5\u00de which flips the sign of C. S\u03b2 \u00bc 1 for the fully filled state with \u03bd \u00bc 1, C \u00bc 0.\n031005-12\nSimilarly, we can set o \u00bc \u03b1, which is the plaquette center. For C > 0,\nS\u03b1\u00f0\u03d5\u00de \u00bc C2\n2 \u00fe C C\u03d5 2\u03c0 \u00fe 2 X p=q<\u03d5=2\u03c0\nodd q\nC\u00fe q 2q mod 4: \u00f042\u00de\nThe value of S\u03b1 for C < 0 lobes can be obtained from the transformation S\u03b1\u00f0\u03bc;\u03d5\u00de \u00bc 2C \u2212S\u03b1\u00f0\u2212\u03bc;\u03d5\u00de, which flips the sign of C. S\u03b1 \u00bc 0 when C \u00bc 0. One can verify that S\u03b2 has period 2\u03c0 in \u03d5, but S\u03b1 has period 8\u03c0 in \u03d5. The physical reason is that the defect lattice with o \u00bc \u03b1 has a triangular plaquette at the disclination core. Under \u03d5 \u2192 \u03d5\u00fe 2\u03c0, the background flux through this triangular plaquette transforms as 3\u03d5=4 \u2192 3\u03d5=4\u00fe \u00f03\u03c0=4\u00de. Therefore Hdefect is invariant under \u03d5 \u2192 \u03d5\u00fe 8\u03c0 up to gauge transformations."
        },
        {
            "heading": "V. CALCULATION OF P\u20d7o ON THE SQUARE LATTICE",
            "text": "We next discuss three different ways to calculate P\u20d7o for o \u00bc \u03b1, \u03b2 directly on the square lattice, using dislocation charge, linear momentum, and a 1D polarization response. (The case o \u00bc \u03b3 is handled in Sec. VI.) In fact, we show that P\u20d7\u03b1; P\u20d7\u03b2 can also be computed if we knowS\u03b1,S\u03b2 alone: see the results in Table I, in particular Eq. (8). These results are derived in Sec. VII and Appendix G. So in principle we can also measure the polarization indirectly from the disclination charge and angular momentum responses. All the calculations yield the same numerical values of P\u20d7\u03b1\u00f0\u03b2\u00de, and are consistent with field theory predictions. In this section we will not require the rotation operator\nC\u03034;o , but still use the translation operators satisfying Eq. (32). Note that in Secs. V and VI and the related Appendixes C and E we use A to denote the entire vector potential on a lattice without dislocation or disclination defects, so A has the same meaning as Aclean from the previous section. The vector potential in a system with lattice defects is denoted as Adefect."
        },
        {
            "heading": "A. P\u20d7o from dislocation charge",
            "text": "First we consider the charge bound to a single dislocation (for an explicit construction of such a dislocation defect, see Appendix C). We follow the procedure outlined in Sec. IV C; similar arguments can be applied in this case. For a defect with zero disclination angle and dislocation Burgers vector b\u20d7 \u00bc \u00f00; 1\u00de or \u00f0 1; 0\u00de, there is a triangular plaquette at the dislocation, and all other plaquettes within a large radius are ensured to be regular through our construction. Suppose the triangular plaquette has flux \u03d5irreg. If the translation operator used to construct the dislocation is\nT\u0303y \u00bc T\u0302yei P j \u03bbjn\u0302j ;\nwe find that when b\u20d7 \u00bc \u00f00; 1\u00de,\n\u03d5irreg \u00bc Aj0;j0\u00fey\u0302 \u2212 \u03bbj0 ; \u00f043\u00de\nwhere j0 is a specific point in the irregular unit cell at the dislocation (see Appendix C 2 for a proof). Thus, the value of \u03d5irreg is set by the combined choice of A, \u03bb, and j0. In particular, we show in Appendix C 2 that for vx \u2208 Z, the following transformations all take \u03d5irreg \u2192 \u03d5irreg \u00fe \u03d5vx: (1) taking j0 \u2192 j0 \u00fe \u00f0vx; 0\u00de keeping A, \u03bb fixed; (2) taking \u03bbj \u2192 \u03bbj \u2212 \u03d5vx for each j, keeping A and j0 fixed. (Here we can even take vx \u2208 R.) In this section it turns out that fixing a precise value of \u03d5irreg is not essential, but the above discussion is also useful in Sec. V C. The field theory predicts that the total charge in a region W surrounding the dislocation is\nQW \u00bc C \u03b4\u03a6W;o 2\u03c0 \u00fePo 2 \u00fe \u00f0k\u00fe nirreg;o\u00de\u03bd mod 1; \u00f044\u00de\nwhere we write nW;o \u00bc k\u00fe nirreg;o for some integer k. Here nirreg;o is the effective number of unit cells we assign to the irregular unit cell at the dislocation. We use the subscript o in nirreg;o because the value assigned to it will turn out to be different for different high symmetry points o. Recall from the general discussion in Sec. IV C that if all regular unit cells have flux \u03d5,\n\u03b4\u03a6W;o \u00bc \u03d5irreg \u2212 \u03d5nirreg;o;\nwhere \u03d5nirreg;o is the background flux assigned to the dislocation plaquette. Next we determine nirreg;o. First we consider o \u00bc \u03b2 (see Fig. 7). The choice of nirreg;\u03b2 should satisfy a few sanity checks. First, it should lead to an integer-valued P\u03b2. Numerically, only nirreg;\u03b2 \u00bc 0 or 1=2 give integer values of P\u03b2; this can also be seen directly from Eq. (44) by looking at the limit of zero Chern number and \u03bd \u2208 Z. Second, the system with the same Hamiltonian but with all orbitals filled has zero Chern number. It can be adiabatically connected to one in which the points in the \u03b1, \u03b2, \u03b3 maximal Wyckoff positions have integer charge N\u03b1, N\u03b2, N\u03b3 , respectively. In this situation, the polarization can also be defined using the dipole moment within each subcell, and it is possible to show, independent of any dislocation charge calculation, that\nP\u03b1 \u00bc N\u03b2 \u00fe N\u03b3 mod 2; \u00f045\u00de\nP\u03b2 \u00bc N\u03b1 \u00fe N\u03b3 mod 2: \u00f046\u00de\nSee Appendix B for the details. Now we show that Eq. (44) only agrees with this result if we set nirreg;\u03b2 \u00bc 12.\n031005-13\nTo derive this explicitly, consider Fig. 7. We choose W so that \u2202W overlaps with \u03b2 sites. Using our weighting procedure, we get\nQW \u00bc 7N\u03b1 \u00fe 7.5N\u03b2 \u00fe 15.5N\u03b3; \u00f047\u00de\nwhile from the field theory, if we set o \u00bc \u03b2,\nQW \u00bc \u03ba\u00f07\u00fe nirreg;\u03b2\u00de \u00fe P\u03b2 2 mod 1; \u00f048\u00de\nwhere \u03ba \u00bc N\u03b1 \u00fe N\u03b2 \u00fe 2N\u03b3 . Using Eq. (46) in the above equations, and simplifying, we obtain nirreg;\u03b2\u00bc1=2mod 1. The above calculation was done in a limit with Chern number zero. We now assume that nirreg;\u03b2 \u00bc 1=2 even when C \u2260 0. This is reasonable because in the actual model under study, changing the Chern number should not change nirreg;\u03b2. After this step, we get the following prediction:\nQW \u00bc P\u03b2 2 \u00fe k\u00fe 1 2 \u03bd\u00fe C \u03b4\u03a6W;\u03b2 2\u03c0 mod 1; \u00f049\u00de\nwhereW encloses only one dislocation, with one triangular plaquette. Note that\n\u03b4\u03a6W;\u03b2 \u00bc \u03d5irreg \u2212 \u03d5\n2\nis completely well defined mod 2\u03c0 since \u03d5 is specified as a real number (see Sec. IV C 4). This allows us to find P\u03b2 mod 2 unambiguously. Now let us discussP\u03b1. Again consider Fig. 7. Let us use the exact same W (i.e., the same unit cell choice), so\nQW \u00bc 7N\u03b1 \u00fe 7.5N\u03b2 \u00fe 15.5N\u03b3: \u00f050\u00de\nHowever, if we choose o \u00bc \u03b1, the field theory now predicts that\nQW \u00bc \u03ba\u00f07\u00fe nirreg;\u03b1\u00de \u00fe P\u03b1 2 mod 1: \u00f051\u00de\nIn the Chern number 0 limit, demanding consistency with Eq. (45) implies that nirreg;\u03b1 \u00bc 0 mod 1. We have thus found that nirreg;o depends on whether o lies at the corner or the center of a unit cell. The values of nirreg;o are tabulated in Table IV. When we consider other values of M in Sec. VI, we again find that nirreg;o must be fixed for each o by requiring consistency with analytical results in the limit of full filling."
        },
        {
            "heading": "B. Application to Hofstadter model",
            "text": "We apply Eq. (49) to the usual square lattice Hofstadter model, choosing \u03b1 at a plaquette center and \u03b2 at a site as\nbefore. The Hofstadter butterfly for P\u03b2 is plotted in Fig. 1. P\u03b2 follows the empirical formula:\nP\u03b2\u00f0\u03d5\u00de \u00bc C\u03ba mod 2: \u00f052\u00de\nNote that P\u03b2 has period 4\u03c0 in \u03d5 and not 2\u03c0, because its definition involves the quantity \u03d5=2. [Also, if \u03d5 \u2192 \u03d5\u00fe 2\u03c0 for fixed \u03bd, Eq. (52) changes by C mod 2 so a shift of 4\u03c0 is needed to leave it invariant.] We use Eq. (52), along with an eigenvalue database [34], to generate the Hofstadter butterfly forP\u03b2 in Fig. 1. We have only plotted it for 0 < \u03d5 \u2264 2\u03c0. The values for 2\u03c0 < \u03d5 \u2264 4\u03c0 can be obtained either using Eq. (52) or by reflecting the butterfly about \u03d5 \u00bc 2\u03c0. Similarly, with \u03b1 at a plaquette center, and nirreg;\u03b1 \u00bc 0, we find that\nP\u03b1 \u00bc \u00f0C\u00fe 1\u00de\u03ba mod 2: \u00f053\u00de\nP\u03b1 has period 2\u03c0 in \u03d5, and is also plotted in Fig. 1. Shifting \u03d5 \u2192 \u03d5\u00fe 2\u03c0 for fixed \u03bd changes Eq. (53) by C\u00f0C\u00fe 1\u00de mod 2, but as C\u00f0C\u00fe 1\u00de is even, this change is trivial.\n031005-14\nFinally, note that there is a general relation between P\u03b1 and P\u03b2 which goes beyond just the Hofstadter model:\nP\u03b1 \u2212P\u03b2 \u00bc \u03ba mod 2: \u00f054\u00de\nEquation (54) can be proven from field theory; we do this in Sec. VII."
        },
        {
            "heading": "C. P\u20d7o from linear momentum",
            "text": "On a closed manifold, the field theory term \u00f0P\u20d7o=2\u03c0\u00de \u00b7 A \u2227 T\u20d7 can be rewritten as \u00f0P\u20d7o=2\u03c0\u00de \u00b7 R\u20d7 \u2227 F, plus some additional terms, where F is the total magnetic flux, and R\u20d7 \u00bc \u00f0X; Y\u00de is the translation gauge field mentioned below Eq. (13). Consider the linear momentum in, say, the y direction associated to a state with total flux 2\u03c0m \u00bc \u03d5LxLy. The linear momentum of the inserted flux, which is the charge under the translation gauge field, is predicted to receive a contribution,\n\u03b4L \u03b4Y0 \u00bc Po;y 2\u03c0\nZ F \u00bc Po;ym \u00bc 1\n2 Pom mod 1; \u00f055\u00de\nfrom this term. The mod 1 normalization is due to the convention chosen to define Y. We now verify this prediction from numerical calculations on the Hofstadter model for o \u00bc \u03b1, \u03b2 by studying the system on a torus. On a torus with magnetic flux 2\u03c0m \u00bc \u03d5LxLy, a translation by y cannot be an exact symmetry of the Hamiltonian in general, even after applying a gauge transformation. This is because, for a fixed x, the holonomy H Axdx along a noncontractible cycle of the torus changes by 2\u03c0m=Ly under T\u0303y. If \u00f0m=Ly\u00de \u2208 Z, T\u0303y is an exact symmetry because the change in H Axdx can be undone by a large gauge transformation. For other values of m, T\u0303y needs to be accompanied by an operator F 2\u03c0m=Ly which adiabatically inserts flux 2\u03c0m=Ly through the cycle running along x, to make it an exact symmetry. In our work we do not use the exact translation operator because it is difficult to numerically implement F 2\u03c0m=Ly . If the value of jmj mod Ly is of order 1, the inserted flux from F 2\u03c0m=Ly is O\u00f01=Ly\u00de, which vanishes in the thermodynamic limit; therefore, T\u0303y \u2243 T\u0303yF 2\u03c0m=Ly is a good approximation [20]. For general values of m, we find that the expectation value of T\u0303y oscillates between 0 and 1 in amplitude as a function ofm (indicating the closeness of the approximation). Apart from the flux in each unit cell, the vector potential has another gauge-invariant quantity called the gauge origin o\u0304, which we define below. The operator T\u0303y also requires us to fix a gauge transformation f\u03bbjg. The main result of this section is that for a fixed system size and a fixed choice of o, we find only one choice of o\u0304 and \u03bb for which P\u20d7o is\nquantized throughout the Hofstadter model. And remarkably, this value of P\u20d7o agrees with results from the dislocation charge calculation. We find that we can similarly measure P\u20d7o using the expectation value of a partial translation operator T\u0303yjD (again not an exact symmetry), which is T\u0303y restricted to an appropriate region D. Further details of the linear momentum calculations are found in Appendix E."
        },
        {
            "heading": "1. Definition of vector potential",
            "text": "We assume, as in the charge calculation, that the holonomies of the vector potential A can be specified along any loop in the continuum in which the lattice is embedded. We define a gauge-invariant point, the gauge origin o\u0304 \u00bc \u00f0o\u0304x; o\u0304y\u00de, such that the holonomy of A is zero on the x and y cycles of the torus that intersect o\u0304. Note that o\u0304 need not correspond to a lattice site in general. Vector potentials with different values of o\u0304 are not gauge equivalent, and are distinguished in the treatment below. To measure Po;y in our numerics, we insert a total of m flux quanta on the torus using a Landau-like gauge along y. One form of this gauge, shown in Fig. 8, is\nAj;j\u00fex\u0302 \u00bc\u2212 2\u03c0\u00f0y\u2212 o\u0304y\u00dem\nLy \u03b4jx;Lx\u22121;\nAj;j\u00fey\u0302 \u00bc 2\u03c0\u00f0x\u2212 o\u0304x\u00dem\nLxLy ;\nj\u00bc \u00f0jx; jy\u00de; jx \u2208 f0;\u2026;Lx\u22121g; jy \u2208 f0;\u2026;Ly\u2212 1g: \u00f056\u00de\n031005-15\nHere, m\u2261 \u00f0\u03d5=2\u03c0\u00deLxLy is the total number of flux quanta through the torus. o can be determined from o\u0304, as we explain in the subsequent section. To measure Po;x, we define a similar gauge, but instead along x."
        },
        {
            "heading": "2. Approximate translation operator",
            "text": "Next we define the operator\nT\u0303y \u2254 T\u0302ye i P j \u03bbjc \u2020 j cj : \u00f057\u00de\n\u03bbj is a function of m. If T\u0303y were an exact symmetry, there would be a set f\u03bbjg satisfying\nAi\u00fey\u0302;j\u00fey\u0302 \u00bc Aij \u2212 \u03bbi \u00fe \u03bbj \u00f058\u00de\neverywhere on the torus. But as mentioned above, it is not possible to have exact symmetry whenm=Ly \u2209 Z. Thus we can at best ensure that this relation holds everywhere except for a small strip that we require to be centered at a fixed x. Then the freedom in choosing \u03bb is completely fixed up to (i) an overall shift \u03bbj \u2192 \u03bbj \u00fe \u03c7 for each j, (ii) the geometry of the strip, including the position of its center and its thickness, and (iii) the choice of \u03bb for points that lie within the strip (if any). We discuss these further below. In our numerics we use the gauge\nT\u0303y \u00bc 8>>< >>: T\u0302ye i P j \u2212\u00f0\u03c0m=Ly\u00dec\u2020j cj jx < o\u0304x T\u0302ye i P j \u00f0\u03c0m=Ly\u00dec\u2020j cj jx > o\u0304x\nT\u0302y jx \u00bc o\u0304x: \u00f059\u00de\nHere jx is the x coordinate of the site j. For this T\u0303y , Eq. (58) is violated only on the horizontal links that touch the line jx \u00bc o\u0304x. To measurePo;y, we need to express o in terms of gaugeinvariant properties of A or \u03bb. If we fix A, \u03bb as above, we can define o as follows. First, we find the flux \u03d5irreg in a dislocation plaquette created using T\u0303y . Recall from Sec. VA that \u03d5irreg depends on A and \u03bb as well as the position of the dislocation, which is fixed by a point j0; and if we shift j0 by an integer vector, \u03d5irreg can change by multiples of \u03d5. For the above choices of A and \u03bb, we thus define o so as to satisfy the following relation, with j0;x \u2208 Z:\n\u03d5irreg \u00bc \u03d5nirreg;o mod \u03d5; \u00f060\u00de\nwhere nirreg;o was computed in Sec. VA. In the language of that section, our choice of o ensures that the excess flux \u03b4\u03a6W;o in the dislocation plaquette constructed using T\u0303y is zero (mod \u03d5). Note that for an arbitrary choice of \u03d5irreg,\nthere may be no solution corresponding to any high symmetry point o. But in Appendix C we prove that for our choice of A, \u03bb, Eq. (60) can be solved and implies\nox \u00bc o\u0304x \u00fe Lx 2 \u00fe 1 2 mod 1: \u00f061\u00de\nHaving fixed \u03bbj, we define the linear momentum p\u03bb;y as the expectation value of T\u0303y in the ground state j\u03a8i with m total flux quanta:\nh\u03a8jT\u0303y j\u03a8i \u2254 e\u2212\u03b3\u00fei2\u03c0p\u03bb;y : \u00f062\u00de\ne\u2212\u03b3 is the amplitude of the expectation value. Empirically, we find that\np\u03bb;y \u00bc \u2212Po;ym\u00fe Ky mod 1: \u00f063\u00de\nThe term linear inm is predicted by the response theory;Ky is piecewise constant in m in our numerics, and can change only when the amplitude vanishes. The numerical details are shown in Fig. 18. Using the above choice of \u03bb in the Hofstadter model, we find that the amplitude e\u2212\u03b3 oscillates with m whenever C \u2260 0, and for a discrete set of m values it vanishes [45]. For other values of m, the magnitude is nonvanishing and the linear momentum is well defined. As a result, for a fixed Lx, we can obtain the expected value of Po;y throughout the Hofstadter butterfly except for a finite set of \u03d5 values where Po;y is not determined. But for these \u03d5 values, we can pick some other Lx and then extract Po;y. The values of Po;y are quantized and agree with results from the dislocation charge measurement. Now we discuss alternative choices of \u03bb. First there is the freedom in shifting \u03bbj \u2192 \u03bbj \u00fe \u03c7 for each j. As stated in Sec. VA, taking \u03c7 \u00bc \u03d5vx \u00bc \u00f02\u03c0mvx=LxLy\u00de changes the flux \u03d5irreg assigned to an irregular unit cell at a dislocation by \u2212\u03d5vx (where vx \u2208 R). If we continue to define o using Eq. (60), then when vx is an arbitrary real number there is no solution for o. But if vx is quantized to 0 or \u00f01=2\u00de mod 1, we see that o must change (in fact, we show in Appendix C that ox \u2192 ox \u2212 vx). Hence, only discrete sets of global U(1) transformations are allowed, and the effect of such transformations is simply to change the value of o. There is additional freedom in choosing the strip that violates translation symmetry. The location of the center of the strip can in principle be shifted by \u03b4 \u2208 R if we define \u03bbj as in Eq. (E2) (see Appendix E). In the Hofstadter model, we find empirically that in order to get any quantized result forPo;y throughout the butterfly, \u03b4must be fixed so that the center of the strip coincides with o\u0304x, as in Eq. (59), i.e., \u03b4 \u00bc 0. Remarkably, the quantized P\u20d7o extracted from the above linear momentum calculation agrees fully with the result from dislocation charge calculations.\n031005-16\nWhen C \u00bc 0 in this model, taking \u03b4 \u2260 0 is equivalent to taking \u03bbj \u2192 \u03bbj \u00fe \u03c7 for some \u03c7 [46]. In this case any choice of \u03b4 will give a quantized result Po0;y, but for a high symmetry point o0 that depends on \u03b4. In Appendix E we discuss an alternative way to understand the choice of \u03b4 using gauge-invariant quantities. Empirically, we find that the thickness of the strip does not matter, as long as \u03bbj varies linearly in jx within the strip (otherwise we do not obtain quantized results throughout the butterfly forPo;y). We can pick the parameters fLy; o\u0304yg arbitrarily, and this does not affect the result forPo;y. In the limit of zero strip thickness, Eq. (59) is the only choice of \u03bb that we have found that gives quantized results throughout the butterfly."
        },
        {
            "heading": "3. Partial translations",
            "text": "We can also use a partial translation operator T\u0303yjD \u2254 T\u0302yjDei P j\u2208D \u03bbjc \u2020 j cj to extract the same linear momentum. To\nget quantized results for P\u20d7o, we empirically find that D needs to be mirror symmetric about some cycle l along\nwhich the holonomy ei P j\u2208l Aj;j\u00fey\u0302 is real valued.\nHere we define the linear momentum of a state with m flux quanta as\nh\u03a8jT\u0303yjDj\u03a8i \u2254 e\u2212\u03b3D\u00fei2\u03c0p\u03bb;y : \u00f064\u00de\nNumerically, we obtain Po through the equation\np\u03bb;y \u00bc \u2212Po;ym\u00fe Ky mod 2: \u00f065\u00de\nHere Ky is some constant which only depends on the Chern number and the system size. We find that there are only two choices of the parameters fD; o\u0304; \u03bbg which give a quantized Po;y throughout the butterfly. In one case, (1) D is centered at the cycle with x \u00bc o\u0304x (trivial holonomy), (2) o\u0304 is arbitrary, and (3) T\u0303yjD \u2254 T\u0302yjD, i.e., \u03bbj \u2261 0 for j \u2208 D. However, empirically these choices give Po;y \u00bc 0 everywhere in the butterfly, which does not agree with the results obtained from other methods. In the second case, we choose (1)D centered at the cycle with x \u00bc o\u0304x \u2212 \u00f0Lx=2\u00de [holonomy \u00f0\u22121\u00dem], for each m, (2) o\u0304 \u00bc o\u00fe \u00f0Lx=2\u00de \u00fe \u00f012 ; 12\u00de, and (3) T\u0303yjD is defined as\nT\u0303y jD \u2254 8< : T\u0302yjDe i P j \u2212\u00f0\u03c0m=Ly\u00dec\u2020j cj jx \u2264 o\u0304x\nT\u0302yjDei P j \u00f0\u03c0m=Ly\u00dec\u2020j cj jx > o\u0304x:\n\u00f066\u00de\nThis choice of \u03bb; o\u0304; D is the only one we have found that gives a quantized but nontrivial result for Po;y throughout the butterfly. Furthermore, remarkably this agrees with the other methods used in this section (dislocation charge,\nlinear momentum from full translations, and the 1D polarization discussed below). We motivate this choice further in Appendix E."
        },
        {
            "heading": "D. P\u20d7o from 1D polarization",
            "text": "It is natural to ask what the invariant P\u20d7o as defined above has to do with other traditional many-body definitions of the polarization. In this section we provide one concrete answer: we consider a torus and compute the 1D polarization along x as defined by Resta [22], treating Ly as a parameter. We show that in addition to the usual term proportional to C, there is a term LyPo;y which fixes the dependence of the 1D polarization on the dimensionally reduced coordinate. Consider the 1D polarization in the x direction, denoted Px. It is defined by the following action:\nL1D \u00bc \u2212Px Z dxdtEx; \u00f067\u00de\nwhere Ex \u00bc \u2202tAx \u2212 \u2202xAt is the x component of the electric field. In this section we assume that A denotes the entire vector potential and not just its deviation from some background. The sign in Eq. (67) is chosen so that the 1D current j satisfies j \u00bc \u00f0\u03b4L1D=\u03b4At\u00de \u00bc \u2202tPx. We now use the \u00f02\u00fe 1\u00deD field theory to make a prediction for Px if the original 2D system is dimensionally reduced to an effective 1D system in the x direction. We set the rotation gauge field \u03c9 to zero for this calculation. First consider the term with C:\nC 4\u03c0\nZ dxdydtA \u2227 dA\n\u00bc C 4\u03c0\nZ Cdxdydt\u00f0AtB \u2212 AxEy \u00fe AyEx\u00de: \u00f068\u00de\nHere Ex; Ey; B are the full electric and magnetic fields, respectively. Note that the Chern-Simons term is usually written in terms of the deviation of the vector potential from some background, but we have instead used the full vector potential. This rewriting is motivated by the topological field theory, derived in Appendix F, and will be justified by the empirical results we show below. If Ay \u2260 0 and Ex is independent of y, then we can rewrite this term as\nC 2\u03c0\nZ dxdt I Ay\u00f0x\u00dedy Ex \u00fe ; \u00f069\u00de\nThis step involves an integration by parts, which contributes a factor of 2. Since the system on the torus is not exactly translationally symmetric, the holonomy \u03a6y\u00f0x\u00de \u00bcH Ay\u00f0x\u00dedy has an x dependence. In order to extract a spatially averaged polarization, which is what we calculate\n031005-17\nmicroscopically using Resta\u2019s formula below, we assume Ex is a constant. Then the above term becomes\nC 2\u03c0\n\u03a6y;av Z dxdtEx \u00fe : \u00f070\u00de\nHere,\u03a6y;av \u2254 \u00f01=Lx\u00de R dxdyAy is the average of the global holonomies in the y direction. Thus the Chern number contributes to the 1D polarization. The value of \u03a6y;av depends on the range of integration for x. If we assume Ox \u2264 x \u2264 Lx \u00feOx for someOx and\u03a6y\u00f0x\u00de is continuous in this range, we can show that\n\u03a6y;av \u00bc \u03d5Ly Lx 2 \u2212 o\u0304x \u00feOx mod 2\u03c0: \u00f071\u00de\nNow note that there is also a contribution from the field theory term Y \u2227 dA:\nPo;y 2\u03c0\nZ dxdydtY \u2227 dA\n\u00bc Po;y 2\u03c0\nZ dxdydt\u00f0YtB \u2212 YxEy \u00fe YyEx\u00de\n\u00bc Po;y 2\u03c0\nI dyYy Z dxdtEx \u00fe\n\u00bc Po;yLy Z dxdtEx \u00fe : \u00f072\u00de\nNote that due to a normalization convention, H dyYy \u00bc 2\u03c0Ly. The remaining terms in the field theory do not contribute. Thus we naively expect that the 1D polarization should be equal to\n\u2212PO;x \u00bc C\u03d5 2\u03c0 Ly Lx 2 \u2212 o\u0304x \u00feOx \u00fe LyPo;y \u00fe K0 mod 1;\n\u00f073\u00de\nwhere we assume K is a constant that is independent of Lx and Ly. We use the subscript O in PO;x to specify the dependence of this quantity on Ox. As we now discuss, to match Eq. (73) to a numerical calculation, we demand that Ox be the origin of coordinates in that calculation. Numerically we compute the quantity PO;x using Resta\u2019s formula:\nPO;x \u00bc 1 2\u03c0 argh\u03a8jei\u00f02\u03c0=Lx\u00de\nP j jxc \u2020 j cj j\u03a8i; \u00f074\u00de\nwhere jx is defined with respect to the origin O\u2261 \u00f0Ox;Oy\u00de, i.e., jx\u2208f\u2212Ox;1\u2212Ox;2\u2212Ox;\u2026;Lx\u22121\u2212Oxg. HereO refers to the point on the torus where the coordinate is chosen to be (0, 0).\nEmpirically, we find that PO;x exactly obeys Eq. (73). Let us take a square lattice with Lx \u00bc 20, Ly \u00bc 12, 13, and Ox \u00bc 0; 12 as an example. The constant in \u03d5 contribution LyPo;y \u00fe K0 for the two different Ly is plotted in Fig. 9. Empirically we find that the difference of the two gives the desired answer Po;y when\nox \u00bc Ox \u00fe Lx 2 \u00fe 1 2 mod 1: \u00f075\u00de\nThe presence of the \u00f0Lx=2\u00de \u00fe 12 term may seem mysterious, but we show why it should be present in the C \u00bc 0 case below. Consider PO;x for a square lattice with one orbital per site and at full filling \u03bd \u00bc 1. We analytically calculate PO;xj\u03bd\u00bc1 using Resta\u2019s formula:\nPO;xj\u03bd\u00bc1 \u00bc X r jx Lx mod 1\n\u00bc Lx\u00f0Lx \u2212 1 \u2212 2Ox\u00de 2 Ly Lx mod 1\n\u00bc Ly Lx 2 \u2212 1 2 \u2212Ox mod 1: \u00f076\u00de\nThe coefficient of Ly equals \u2212Po;y. In this special case Po;y just equals ox mod 1 (zero at a site, and 1=2 at a plaquette center). By equating these two expressions for Po;y, we get Eq. (75). We expect that when C \u2260 0, Eq. (75)\n031005-18\nwill continue to hold, and we have verified this expectation numerically. The relationship between O and o is reminiscent of the linear momentum calculation in which one has to shift the gauge origin o\u0304 by \u00f0Lx=2; Ly=2\u00de \u00fe \u00f012 ; 12\u00de relative to o in order to obtain P\u20d7o. We have numerically checked that Eq. (73) gives consistent answers for different gauge choices and for different system sizes."
        },
        {
            "heading": "VI. CALCULATIONS FOR GENERAL M",
            "text": "We now generalize our charge response, linear momentum, and 1D polarization calculations. We discuss M \u00bc 2, 3, 4, 6 together, and assume that o can be at any HSP within the unit cell. We keep the choice of unit cell \u0398 arbitrary. We focus on the details that differ from those outlined previously when M \u00bc 4. Recall that M0 is the order of the rotation symmetry which preserves o, while M is the largest possible value of M0 considering all possible HSPs o. For the computations below we need theM0-fold rotation operator C\u0303M0;o defined so that \u00f0C\u0303M0;o \u00deM0 \u00bc 1."
        },
        {
            "heading": "A. So from pure disclination charge",
            "text": "We can use the operator C\u0303M0;o to create a pure disclination at the high symmetry point o and calculate its charge response. As previously discussed, the origin o used to measure the Burgers vector of the disclination need not be equal to o . And by pure disclination, we mean that b\u20d7o \u2243 \u00f00; 0\u00de. In this case the field theory predicts that\nQW \u00bc C \u03b4\u03a6W;o 2\u03c0 \u00fe\u03a9WSo 2\u03c0 \u00fe \u03bd\u00f0k\u00fe nirreg;o;\u03a9\u00de mod 1; \u00f077\u00de\nwhere k is an integer. Note that the field theory is only sensitive to o and not o ; it cares only about the measured value of the Burgers vector and not about how the defect was created microscopically. The computation of \u03b4\u03a6W;o and thenSo is done according to the procedure discussed in Sec. IV C. As we discussed there, a crucial detail is the area of the irregular unit cell at the center of the disclination, which we here call nirreg;o;\u03a9. We include a subscript \u03a9 because, in general, this number also depends on the disclination angle \u03a9. nirreg;o;\u03a9 is defined as\nnirreg;o;\u03a9 \u2261 8>< >: \u00f01 \u2212 \u03a9 2\u03c0\u00de if o is at the center of the unit cell\n0 otherwise:\n\u00f078\u00de\nThis can be intuitively understood as follows. If the origin is at the center of the unit cell, the disclination construction process would remove a fraction \u03a9=2\u03c0 of the central unit\ncell (i.e., M\u03a9=2\u03c0 subcells). If o is not at the center of the unit cell, then it must be at the boundary of the unit cell. In this case, there is no irregular unit cell; thus nirreg;o;\u03a9 \u00bc 0. Note that when M \u00bc 2, 3, 4, we can always choose o to be on the boundary of the unit cell, so that there are no irregular unit cells. On the other hand, this definition of nirreg;o;\u03a9 is needed especially for 2\u03c0=6 disclinations when M \u00bc 6, because the only C6 symmetric points are at the unit cell centers, so in any 2\u03c0=6 disclination there will necessarily be an irregular unit cell.\n1. Comments on definition of nirreg;o In the discussion above we emphasize that nirreg;o;\u03a9 depends on the relative position between o and the unit cell\u0398, and not the absolute position of either. We can pick a different unit cell \u0398 which changes QW and nW;o simultaneously, leaving So invariant. We discuss this in detail in Appendix D. An important general point is that our definitions of nirreg;o;\u03a9 (and a similar quantity nirreg;o;b\u20d7 defined in the next section) are only sensitive to the value of M and not to the actual fine structure of the microscopic lattice. Conceptually, we can imagine tiling the plane with unit cells (square for M \u00bc 4, hexagonal for M \u00bc 3, 6, and so on), and the only constraint is that the centers and corners of these unit cells need to be at appropriate high symmetry points of the microscopic lattice. In particular, the tiling does not have to match the structure of hopping or interaction terms in the microscopic Hamiltonian. Then, we note that the number of unit cells in any region W is a property of the tiling alone. Similarly, we can apply a cutand-glue procedure on the infinite plane tiling to get a tiling for a surface with a dislocation or disclination defect. Then the quantities nirreg;o;\u03a9 and nirreg;o;b\u20d7 are properties of this defect tiling alone. As such, these are independent of microscopic details of the Hamiltonian such as the distribution of sites and the hoppings between them. The fact that our prescription depends on the tiling rather than on microscopic details such as hopping and interaction terms makes it readily generalizable beyond the nearestneighbor Hofstadter models that we have mainly studied in this work."
        },
        {
            "heading": "B. P\u20d7o from dislocation charge",
            "text": "We next calculate P\u20d7o from the charge response of a dislocation (assume \u03a9 \u00bc 0). If a defect has a nontrivial Burgers vector b\u20d7, it will generally also have an irregular unit cell. This irregular unit cell is triangular if M \u00bc 2, 4 and quadrilateral if M \u00bc 3, 6. In this case, we find that the area which should be assigned to the irregular unit cell depends on b\u20d7, so we use the notation nirreg;o;b\u20d7. The results are shown in Table IV. They are derived by matching the dislocation charge result with known values\n031005-19\nof P\u20d7o in the C \u00bc 0 limit (see Appendix B) from the same real space picture discussed in the previous section, when M \u00bc 4. The origin dependence of nirreg;o;b\u20d7 can also be understood from field theory. In Sec. VII we argue that the following general formula holds:\nnirreg;o\u00fev\u20d7;b\u20d7 \u00bc nirreg;o;b\u20d7 \u2212 vxby \u00fe vybx; \u00f079\u00de\nwhere \u00f0bx; by\u00de is the dislocation Burgers vector, and \u00f0vx; vy\u00de is a fractionally quantized vector that shifts o to another HSP. Additionally, if b\u20d7 \u00bc \u00f00; 0\u00de, then nirreg;o;b\u20d7 \u00bc 0; and if b\u20d7 \u2192 \u2212b\u20d7, then nirreg;o;b\u20d7 \u2192 \u2212nirreg;o;b\u20d7 mod 1. This condition means that a dislocation-antidislocation pair has a total unit cell number which is an integer. With this information, we can write down the charge response for a dislocation:\nQW \u00bc C \u03b4\u03a6W;o 2\u03c0 \u00fe P\u20d7o \u00b7 b\u20d7\u00fe \u03bd\u00f0k\u00fe nirreg;o;b\u20d7\u00de mod 1: \u00f080\u00de\nThis is the main equation that we use for calculations involving P\u20d7o for M \u00bc 2, 3, 4, 6. As an example,\nwe numerically calculate P\u20d7o in a Hofstadter model on the honeycomb lattice with different choices of o, whose site symmetry groups are Z2, Z3, and Z6. The raw data for P\u20d7o are shown in Fig. 10. Again, we note that the exact choice of unit cell does not affect our calculation of P\u20d7o and So. We show this in Appendix D. Note that in order to find P\u20d7o, it is enough to compute dislocation charge with b\u20d7 \u00bc \u00f01; 0\u00de; \u00f00; 1\u00de; this is why Table IV explicitly contains these values of b\u20d7. Nevertheless, our procedure to compute dislocation charge applies for general choices of b\u20d7. The main observation is that nirreg;o;b\u20d7 only depends on the equivalence class of b\u20d7 under the equivalence\nb\u20d7 \u2243 b\u20d7\u00fe \u00bd1 \u2212 U\u00f02\u03c0=M0\u00de \u039b\u20d7; \u00f081\u00de\nwhere \u039b\u20d7 is an integer vector and 2\u03c0=M0 is the minimal rotation that preserves o. For example, nirreg;o;b\u20d7 is invariant if b\u20d7 is rotated by the angle 2\u03c0=M0. Since any b\u20d7 is in the same equivalence class as either (1, 0) or (0, 1), Table IV is sufficient for computations with general b\u20d7.\n031005-20\nCombining Eqs. (77) and (80), the complete charge response of disclination and dislocation defects with arbitrary o, \u03a9W , and b\u20d7o is\nQW \u00bcC \u03b4\u03a6W;o 2\u03c0 \u00fe\u03a9WSo 2\u03c0 \u00fe P\u20d7o \u00b7 b\u20d7\u00fe \u03bd\u00f0k\u00fenirreg;o;\u03a9;b\u20d7\u00de; \u00f082\u00de\nwhere the effective irregular unit cell number now depends on both \u03a9 and b\u20d7. For all the examples that we study, we observe the relation\nnirreg;o;\u03a9;b\u20d7 \u00bc nirreg;o;\u03a9;\u00f00;0\u00de \u00fe nirreg;o;0;b\u20d7 mod 1: \u00f083\u00de\nHere nirreg;o;\u03a9;\u00f00;0\u00de; nirreg;o;0;b\u20d7 are the quantities we previously referred to as nirreg;o;\u03a9; nirreg;o;b\u20d7, respectively. This relation matches our expectation from the field theory, in which we can imagine separating a defect with parameters \u00f0b\u20d7;\u03a9\u00de into two defects with parameters \u00bd\u00f00; 0\u00de;\u03a9 ; \u00f0b\u20d7; 0\u00de without changing the effective number of unit cells mod 1."
        },
        {
            "heading": "C. So from angular momentum",
            "text": "We denote as lo the angular momentum with o as the rotation center. The many-body ground state on a clean torus with m total flux quanta is j\u03a8i. lo is defined by\nC\u0303M;oj\u03a8i \u00bc eilo\u00f02\u03c0=M\u00dej\u03a8i: \u00f084\u00de\nExactly as for M \u00bc 4, we find that\nlo \u00bc Cm2\n2 \u00fe Som\u00fe K\u00f0C;L\u00de mod M: \u00f085\u00de\nThe above equation works for any M \u00bc 2, 3, 4, 6. In this work we have also numerically calculated l\u03b1 in the honeycomb lattice, choosing o \u00bc \u03b1. We extract the same S\u03b1 from the disclination charge response (see Fig. 10). This verifies the prediction that So can be measured using an angular momentum dual response. One can also perform a partial rotation to extract So. The details (specialized to M \u00bc 4) are in Ref. [33]."
        },
        {
            "heading": "D. P\u20d7o from linear momentum",
            "text": "The procedure to calculate a linear momentum \u00f0p\u03bb;x; p\u03bb;y\u00de and, hence, P\u20d7o on the square lattice generalizes straightforwardly to the case where M \u00bc 2, 3, 6. For M even we can define T\u0303y precisely as for M \u00bc 4. But for M \u00bc 3, we find that a slight modification is required in the definition of \u03bb:\nT\u0303y \u00bc 8>>< >>: T\u0302ye i P j \u2212\u00f0\u03c0m=Ly\u00dec\u2020j cj jx < o\u0304x T\u0302ye i P j \u00f0\u03c0m=Ly\u00dec\u2020j cj jx > o\u0304x\nT\u0302ye i P j \u00f0o\u0304x\u2212jx\u00de\u00f0\u03c0m=Ly\u00dec\u2020j cj o\u0304x \u2212 1 < jx < o\u0304x \u00fe 1:\n\u00f086\u00de\nThis can be seen as a generalization of Eq. (59) which smooths out the gauge transformation around the gauge origin o\u0304. The relevant equations for M \u00bc 3 are identical to the ones for M \u00bc 2, 4:\nh\u03a8jT\u0303y j\u03a8i \u2254 e\u2212\u03b3\u00fei2\u03c0p\u03bb;y ; \u00f087\u00de\np\u03bb;y \u00bc \u2212Po;ym\u00fe Ky mod 1: \u00f088\u00de\nWe have numerically checked that on the honeycomb lattice we extract the same P\u20d7o as with the other methods (see Fig. 10), assuming Eq. (61). Since Po;y is quantized mod 3, the minus sign is crucial in this case, unlike in the case M \u00bc 2, 4, 6. On the other hand, the partial translation calculation does not generalize to the case where o is a C3 symmetric HSP. This is because we appear to need the region D for partial translations to be mirror symmetric along the cycle with holonomy ei\u03c0m. But this is not possible for C3 symmetric points. It is not clear whether a mirror symmetric region D is essential for our calculation to work, or whether an alternative method might work in this case; we leave this question for future study."
        },
        {
            "heading": "E. P\u20d7o from 1D polarization",
            "text": "Finally, we can dimensionally reduce our 2D space along y, and compute a 1D polarization Px in the x direction. For M \u00bc 4 we obtain an empirical formula, Eq. (73), which matches the field theory prediction. We rewrite it here:\n\u2212PO;x \u00bc C\u03d5 2\u03c0 Ly Lx 2 \u2212 o\u0304x \u00feOx \u00fe LyPo;y \u00fe K0 mod 1;\n\u00f089\u00de\nwhere o\u0304 is the gauge origin, and O is the origin in Resta\u2019s formula, Eq. (26). This equation turns out to also work for M \u00bc 2, 3, 6. As an example, in the honeycomb lattice, the position of the sites are\ni \u00bc ix \u2212\n1 3 \u2212Ox; iy \u2212 1 3 \u2212Oy ;\nj \u00bc jx \u00fe\n1 3 \u2212Ox; jy \u00fe 1 3 \u2212Oy : \u00f090\u00de\ni and j are at the \u03b21 and \u03b22 MWPs of the C6 unit cell, respectively (see Fig. 2 for the unit cell convention), and\n031005-21\nix; jx \u2208 f0; 1;\u2026; Lx \u2212 1g, iy; jy \u2208 f0; 1;\u2026; Ly \u2212 1g. Similar to the linear momentum calculation, in order to get a result for P\u20d7o which is consistent with the known C \u00bc 0 result, we need to choose Ox \u00bc ox \u00fe Lx2 \u00fe 12 mod 1."
        },
        {
            "heading": "VII. ORIGIN DEPENDENCE OF So;P\u20d7o",
            "text": "In this section we sketch how to derive the formulas in Table I that express So\u00fev\u20d7; P\u20d7o\u00fev\u20d7 in terms of So; P\u20d7o, and \u03ba. v\u20d7 is a quantized vector (perhaps fractional) such that o; o\u00fe v\u20d7 are both symmetric under M-fold rotations. These relationships were commented on previously in Secs. IV\u2013VI. We leave the technical computations to Appendix G. Background details and definitions regarding the response theory which we use in this section are found in Appendix F. Let A be the full vector potential for the system (meaning that dA \u00bc F measures the total magnetic field). The full Lagrangian which involves A is\nL \u00bc C 4\u03c0 A \u2227 dA\u00fe LA;o; \u00f091\u00de\nLA;o \u2254 1 2\u03c0 A \u2227 \u00f0Sod\u03c9\u00fe P\u20d7o \u00b7 T\u20d7 \u00fe \u03baAXY\u00de: \u00f092\u00de\nHere dA is the total U(1) flux. The total U(1) charge and flux in any region should physically be invariant under a shift of origin, and therefore the contribution from the term with C to any response property remains invariant upon shifting the origin. Hence we only consider the transformation of the remaining terms as given by LA;o. Crucially, in LA;o the coefficient of the term with \u00f01=2\u03c0\u00deA \u2227 AXY is \u03ba instead of \u03bd, because the difference, given by \u00f0C\u03d5=4\u03c02\u00deA \u2227 AXY, is now contained in the term \u00f0C=4\u03c0\u00deA \u2227 dA. To understand the transformation of LA;o, it will be most convenient to use the discrete simplicial formulation of the response theory, as developed in Ref. [17]; in that case, the above wedge product should be interpreted as a cup product, but we stick to wedge product notation below. First note that a space group operation which performs a rotation about o and then a translation takes the form g \u00bc \u00f0r; h\u00de, where r \u2208 Z2; h \u2208 ZM. The same group element with respect to the shifted origin o0 \u00bc o\u00fe v\u20d7 takes the form\ng0 \u00bc \u00f0v\u20d7; 0\u00de\u00f0r; h\u00de\u00f0\u2212v\u20d7; 0\u00de:\nSince the crystalline gauge fields encode some configuration of group elements on a manifold, a shift of origin by a fractional lattice vector v\u20d7 can be viewed as a \u201cfractional\u201d gauge transformation of the crystalline gauge fields. In particular, because this is not a true gauge transformation,\nthe crystalline gauge fluxes also get redefined, leading to a transformation of the response coefficients. In the simplicial formulation, if the gauge field is flat, the crystalline gauge fluxes are defined by the terms d\u03c9; AXY; \u00bd1 \u2212U\u00f02\u03c0=M\u00de \u22121dR\u20d7. (Note that in the discrete case we can equivalently write T\u20d7 as dR\u20d7; we do this for the rest of the section [47].) Under a shift of origin, these fluxes transform into new quantities d\u03c90; \u00bd1 \u2212 U\u00f02\u03c0=M\u00de \u22121dR\u20d70; A0XY . In Appendix G we show that\nd\u03c90 \u00bc d\u03c9; \u00f093\u00de\ndR\u20d70 \u00bc dR\u20d7\u00fe \u03c4\u20d7Md\u03c9; \u00f094\u00de\nA0XY \u00bc AXY \u00fe \u03c1Md\u03c9\u00fe \u03bc\u20d7M \u00b7 dR\u20d7; \u00f095\u00de\nwhere \u03c4\u20d7M; \u03c1M; \u03bc\u20d7M depend on v\u20d7. This transforms the Lagrangian as follows:\nLA;o0 \u00bc 1 2\u03c0 A \u2227 \u00f0So0d\u03c90 \u00fe P\u20d7o0 \u00b7 dR\u20d70 \u00fe \u03ba0A0XY\u00de: \u00f096\u00de\nAssuming a fixed choice of unit cell, the total charge measured in any given region W should be the same for either choice of origin. Thus,\nZ W \u00f0Sod\u03c9\u00fe P\u20d7o \u00b7 dR\u20d7\u00fe \u03baAXY\u00de\n\u00bc Z W \u00f0So0d\u03c90 \u00fePo0 \u00b7 dR\u20d70 \u00fe \u03ba0A0XY\u00de: \u00f097\u00de\nWe now use Eqs. (93)\u2013(95), and compare coefficients. This gives us\n\u03ba \u00bc \u03ba0; \u00f098\u00de\nP\u20d7o \u00bc P\u20d7o0\u2212v\u20d7 \u00bc P\u20d7o0 \u00fe \u03ba0\u03bc\u20d7M; \u00f099\u00de\nSo \u00bc So0\u2212v\u20d7 \u00bc So0 \u00fe P\u20d7o0 \u00b7 \u03c4\u20d7M \u00fe \u03ba0\u03c1M: \u00f0100\u00de\nThese equations finally give the results in Table I: the calculation reduces to showing Eqs. (93)\u2013(95), and finding \u03c1M; \u03bc\u20d7M; \u03c4\u20d7M in terms of v\u20d7. We perform these calculations in Appendix G; to obtain values for \u03c1M\u00bc2;4 which are consistent with results for Chern number 0, we need to make an assumption on the functional form of AXY , which we explain there. The results are contained in Eq. (G13) (\u03c4\u20d7M), Eq. (G27) (\u03c1M), and in Sec. G 0 3 (\u03bc\u20d7M). Note that Eq. (G13) implies\ndR\u20d70 \u00bc dR\u20d7\u00feM\u00bd1 \u2212U\u00f02\u03c0=M\u00de d\u03c9: \u00f0101\u00de\n031005-22\nThis is in fact equivalent to Eq. (28), which reads\nb\u20d7o\u00fev\u20d7 \u00bc b\u20d7o \u00fe \u00bd1 \u2212 U\u00f0\u03a9\u00de v\u20d7: \u00f0102\u00de\nThe equivalence can be shown as follows. First let us identify dR\u20d70 \u00bc 2\u03c0b\u20d7o\u00fev\u20d7, dR\u20d7 \u00bc 2\u03c0b\u20d7o, d\u03c9 \u00bc \u03a9 \u00bc \u00f02\u03c0k=M\u00de. Then Eq. (101) becomes\nb\u20d7o\u00fev\u20d7 \u00bc b\u20d7o \u00fe k\u00bd1 \u2212U\u00f02\u03c0=M\u00de v\u20d7: \u00f0103\u00de\nTo prove the equivalence, we need to show that the two expressions for b\u20d7o\u00fev\u20d7 are in the same equivalence class:\n\u00bd1\u2212U\u00f02\u03c0k=M\u00de v\u20d7\u00bck\u00bd1\u2212U\u00f02\u03c0=M\u00de v\u20d7\u00fe\u00bd1\u2212U\u00f02\u03c0=M\u00de \u039b\u20d7; \u00f0104\u00de\nfor some \u039b\u20d7 \u2208 Z2. But this follows from the fact that \u00bd1 \u2212 U\u00f02\u03c0=M\u00de v\u20d7 is always an integer vector. As a check on Table I, we can see that the values of So\nand P\u20d7o for zero Chern number given in Appendix B follow the equations in the table. To check Table I when C \u2260 0, we consider an example with C6 rotational symmetry in Appendix G 4. In this derivation we make the crucial assumption that F is invariant under a shift of origin. Note that F \u00bc d\u03b4A\u00fe \u00f0\u03d5=2\u03c0\u00deAXY , where \u03b4A is the deviation of the U(1) gauge field from its background value. F can indeed be made invariant under the transformation of Eq. (95), if we take\n\u03b4A \u2192 \u03b4A \u2212 \u03d5\n2\u03c0 \u00f0\u03c1M\u03c9\u00fe \u03bc\u20d7M \u00b7 R\u20d7\u00de: \u00f0105\u00de\nNote that d\u03b4A only changes around a defect, where d\u03c9 and dR\u20d7 can be nonzero. The transformations of d\u03b4A; AXY indicate that our conventions for \u201cbackground flux\u201d and \u201cexcess flux\u201d in each plaquette (measured by \u03d5AXY and d\u03b4A, respectively) change by equal and opposite amounts. But the total flux in each plaquette is invariant."
        },
        {
            "heading": "A. Transformation of P\u20d7o",
            "text": "Although \u03c1M; \u03c4\u20d7M depend sensitively on M, our calcu-\nlations show that\n\u03bc\u20d7M \u00bc \u00f0vy;\u2212vx\u00de;\nirrespective of the choice of M. This implies that\nP\u20d7o\u00fev\u20d7 \u00bc P\u20d7o \u00fe \u03ba\u00f0\u2212vy; vx\u00de; \u00f0106\u00de\nfor M \u2208 2, 3, 4, 6.\nThe fact that P\u20d7o transforms proportionally to \u03ba has an important consequence. If we consider two Hamiltonians (1) and (2), which can, for example, be the end points of some path in parameter space, we may naively imagine differences of the form P\u20d7\u00f02\u00deo \u2212 P\u20d7 \u00f01\u00de o to be completely independent of o. But for P\u20d7o as defined in this work, this is true only if \u03ba2 \u00bc \u03ba1. Indeed, Eq. (106) implies that\nP\u20d7\u00f02\u00deo\u00fev\u20d7 \u2212 P\u20d7 \u00f01\u00de o\u00fev\u20d7 \u00bc P\u20d7\u00f02\u00deo \u2212 P\u20d7\u00f01\u00deo \u00fe \u00f0\u03ba2 \u2212 \u03ba1\u00de\u00f0\u2212vy;vx\u00de: \u00f0107\u00de\nThus, in order to measure an origin-independent quantity through differences of P\u20d7o, we must ensure that the initial and final values of \u03ba are equal.\nB. Formula for n irreg;o+ v\u20d7;\u20d7b\nAn interesting corollary of these results is that they allow us to determine the correct assignments of nirreg;o;b\u20d7 for a\nfixed b\u20d7, as we vary o. On an infinite plane lattice with only dislocations, we can set \u03c9 \u00bc 0, and so Eq. (95) becomes\nA0XY \u00bc AXY \u00fe \u03bc\u20d7M \u00b7 dR\u20d7: \u00f0108\u00de\nWith \u03bc\u20d7M as above, we integrate over a region W surrounding the dislocation, and reduce mod 1 to obtain\nnirreg;o\u00fev\u20d7;b\u20d7 \u00bc nirreg;o;b\u20d7 \u2212 vxby \u00fe vybx mod 1: \u00f0109\u00de\nOnce nirreg;o;b\u20d7 is known for a single origin o, the values of nirreg;o\u00fev\u20d7;b\u20d7 can be determined using Eq. (109), as we have listed in Table IV. This nontrivial transformation rule is confirmed by our numerical results and the analytical results at C \u00bc 0."
        },
        {
            "heading": "VIII. DISCUSSION",
            "text": "In this paper we describe several complementary manybody approaches to measure the quantized charge polarization P\u20d7o and the discrete shift So in gapped topological phases, including those with a nonzero Chern number and magnetic field. We extract P\u20d7o by studying the fractional charge bound to dislocations, the linear momentum bound to flux, and from an effective 1D polarization response. We obtain explicit numerical results for the spinless Hofstadter model with CM rotational symmetry, for M \u00bc 2, 3, 4, 6, by matching our microscopic calculations to field theory predictions. We also obtain a theoretical understanding of the origin dependence of P\u20d7o and the discrete shift So. Together with the Chern number C and \u03ba\u2261 \u03bd \u2212 C\u03d5=2\u03c0,\n031005-23\nthe quadruple fC;So; P\u20d7o; \u03bag completely specifies the quantized charge response in systems with charge conservation, magnetic translation, and point group rotation symmetry. An important issue we wish to emphasize is how to\nunderstand So; P\u20d7o as invariants describing a topological phase. In the case of an origin-independent invariant such as C or \u03ba, knowing that the invariant differs between two systems is enough to distinguish them as topological phases. However, in order to distinguish two systems based on their respective values of So or P\u20d7o, it is essential to first fix a common origin o for both systems, and then compare the various numbers. This is because two systems are in the same phase only if they can be adiabatically connected to each other without closing the gap or breaking the symmetry, and while keeping their common origin o fixed. Without fixing this common origin, we cannot meaningfully define the notion of adiabatic equivalence between two systems. In this paper we have focused on the quantization of P\u20d7o due to nontrivial point group symmetry, M> 1. In the case where we do not have point group symmetry, our methods allow us to define an intrinsically two-dimensional manybody polarization P\u20d7o for any real-space origin o, even when C \u2260 0. It is an interesting question to understand the relationship between our definition of polarization for C \u2260 0 and the one based on free fermion band theory proposed by Coh and Vanderbilt [24]. Since So and P\u20d7o are topological invariants that depend on crystalline symmetry, their values cease to be quantized if we break the crystalline symmetry by adding disorder. In particular, if we introduce on-site or bond disorder which breaks the rotational symmetry, So is no longer quantized. If the disorder breaks either the translational or the rotational symmetry, P\u20d7o is no longer quantized. Nevertheless, the disorder averages of So; P\u20d7o remain quantized to their respective clean values, although their standard deviations increase with an increase in disorder strength. This was shown numerically for So in Ref. [33] and is expected to hold for P\u20d7o as well. Next we comment on some unresolved issues in this work. In both the linear momentum and 1D polarization calculations, we need to pick a distinguished point and relate it to o. For the linear momentum calculation, o\u0304 is the gauge origin, and in the 1D polarization calculation, O determines the coordinates for each site in Resta\u2019s formula, Eq. (26). In both calculations, we extract P\u20d7o correctly only if o satisfies a certain relation with o\u0304 or O. In the linear momentum calculation, we also find that if\nT\u0303y \u00bc T\u0302yei P j \u03bbjc \u2020 j cj , for a fixed o\u0304 there is only one choice of \u03bb that gives a quantized Po;y throughout the Hofstadter butterfly. These observations are completely empirical; we leave a full explanation for future work.\nFor our linear momentum calculations we use an approximate translation operator and thus have to work with its expectation values rather than exact eigenvalues. It would be useful to compute the linear momentum exactly by incorporating a flux insertion operator that makes the translation symmetry exact. Additionally, under a shift of origin, the field theory does\nnot fix a unique transformation rule for So; P\u20d7o when M \u00bc 2, 4; instead it gives a few different possibilities as we explain in detail in Appendix G. To fix the transformation consistent with numerics and physical expectations, we need to make some additional choices in the field theory that are allowed but do not have an obvious physical interpretation. We close by pointing out some related open questions. Previously, Ref. [24] proposed a way to define the charge polarization as a single-particle Berry phase in momentum space when C \u2260 0, by picking a suitable origin for the Brillouin zone. It would be useful to understand whether this choice can be related to the ones we make in defining P\u20d7o using the dislocation charge and the linear momentum. We have not commented on how the invariants So; P\u20d7o manifest at corners and edges of the system. The relation between disclination charge and fractional corner charge when C \u00bc 0 has been discussed in several places; see, e.g., Ref. [49]. References [20,24] specifically discussed an edge charge interpretation of the polarization, Ref. [24] did so in the context of Chern insulators, and Ref. [20] did so from the perspective of a boundary Luttinger theorem when C \u00bc 0. It would be interesting to understand the corner and edge charges in the context of our results, which apply for general C and in the presence of a magnetic field. Another interesting direction is to study the charge polarization in fractional Chern insulators. In fact, Refs. [17,18] use field theory to predict that this can indeed be defined systematically and that its quantized fractional values are sensitive to M as well as to the anyon content of the theory. In such topologically ordered phases, the charge polarization can encode a novel, nontrivial form of symmetry fractionalization which was called the \u201cdiscrete torsion vector\u201d in Refs. [17,18]."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "G. N. thanks D. Bulmash and V. Galitski for discussions during the initial stages of this project. This work is supported by the Laboratory for Physical Sciences through the Condensed Matter Theory Center, and by NSF CAREER (DMR-1753240) (M. B., N. M.), ARO W911NF-20-1-0232 (G. N.), QLCI grant OMA-2120757."
        },
        {
            "heading": "APPENDIX A: REVIEW",
            "text": "This appendix has three parts. First, we introduce some standard definitions of quantities on a clean lattice. Next, we introduce dislocation and disclination defects,\n031005-24\nand define the disclination angle and dislocation Burgers vector. After that, we discuss the basic properties of So and P\u20d7o from the perspective of disclination and dislocation charge, respectively."
        },
        {
            "heading": "1. Definitions and background",
            "text": "a. Maximal Wyckoff positions\nThe definitions in this section are taken from Ref. [50]. Fix an origin o. Suppose we are given a set of points in the infinite plane which form a lattice with spatial symmetry group Gspace. On this lattice (assumed to be without any defects), we define a Hamiltonian Hclean with translation operators T\u0302x; T\u0302y corresponding to translations by the elementary lattice vectors, and additional point group symmetry operators, defined with respect to o. The full symmetry group G of Hclean can contain operations in Gspace as well as internal symmetry operations. For any point p in the plane, the site symmetry groupGp is the subgroup of operations in Gspace that leaves p invariant. Two points p, p0 are said to have site symmetry groups that are conjugate to each other ifGp0 \u00bc gGpg\u22121 for some g \u2208 Gspace. The Wyckoff position containing p is the set of all points whose site symmetry groups are conjugate to Gp. For example, every point p0 obtained from p by a lattice translation or rotation is in the same Wyckoff position as p. Furthermore, every point with a trivial site symmetry group belongs to a single Wyckoff position. p is in a maximalWyckoff position (MWP) if Gp is not a proper subgroup of Gp0 for any other site p0. In Fig. 2, we show the MWPs for the wallpaper groups p2; p3; p4; p6. Note that when Gspace \u00bc p4, the high symmetry point \u03b3i has site symmetry group G\u03b3 \u2245 Z2 but is still in a MWP, even though there are other points with site symmetry group Z4. This is because there is no point with site symmetry group Z4 that contains G\u03b3 . We always choose o to belong to a MWP. It is important to distinguish a MWP, which is a collection of points, from a single high symmetry point of a unit cell. Our notation for HSPs is \u03b2i, \u03b3i, where \u03b2, \u03b3 denotes the MWP and i runs over the corresponding HSPs which are inequivalent under lattice translations.\nb. Unit cells and subcells\nA unit cell \u0398 for the given lattice corresponds to a division of lattice points into elementary repeating units. Starting with a clean lattice on the infinite plane, pick a HSP \u03b1 for which the site symmetry group contains the full point group. (This choice may not be unique.) Then define \u03b1 and its lattice translates as the centers of each unit cell. This is the convention used in Fig. 2. Now consider any other point q. If q is equidistant from n > 1 unit cell centers, q is assigned to be on the common boundary of n unit cells centered around \u03b1. If q is closest to one particular\n\u03b1 point, we say that q lies in the interior of the unit cell. By convention, the corners of the unit cell are labeled as \u03b2 (or \u03b2i, if there are multiple HSPs in the same MWP); any other points on the unit cell boundary are denoted \u03b3; \u03b4;\u2026 as required. Note that this definition does not fully determine the shape of the unit cell; we only require the subcells to rotate into each other, and there is still a lot of freedom in drawing the exact boundaries. Now let us specialize to the case where Hclean has an M-fold rotational symmetry. We can subdivide an M-fold rotationally symmetric unit cell into M subcells. Figure 2 illustrates such a division. We only require that subcells rotate into each other under rotations about \u03b1. We have no constraint on the shape of the subcells: in Fig. 11 we show two equally valid shapes. Therefore, although the vertices of each subcell are fixed by our definition of the unit cell; the boundaries are otherwise arbitrary.\nc. Parameters in Hclean In our numerics, we consider Hofstadter models, i.e.,\nfree fermion Hamiltonians of the form\nHclean \u00bc \u2212 X ij tijc \u2020 i cj \u00fe H:c:; \u00f0A1\u00de\nwhere i, j are site indices and the hopping terms tij \u00bc te\u2212iAclean;ij depend on a background vector potential Aclean. We mainly take tij \u00bc 1 if i, j are nearest neighbors, and tij \u00bc 0 otherwise. However, in Appendix H we also consider the Hofstadter model with next-neighbor hopping terms, as an illustration. For any loop l, the enclosed flux equals\narg\u00f0Qhiji\u2208l tij\u00de \u00bc Phiji\u2208l Aclean;ij mod 2\u03c0, where the sum is taken counterclockwise. We assume that Hclean has the symmetry Gf \u00bc U\u00f01\u00def \u00d7\u03d5 Gspace, where U\u00f01\u00def denotes the group U(1) whose order 2 element is the fermion parity operation. This means that the total flux in each unit cell equals \u03d5 mod 2\u03c0. If Hclean is defined on a torus with side lengths L1, L2 instead of the infinite plane, the Z2 translation symmetry is broken down to ZL1 \u00d7 ZL2 if there is no flux; if there is\n031005-25\nflux, the symmetry is still broken down to a subgroup but the details are more complicated. As we explain in the main text, we demand that the magnetic field is specified everywhere within a unit cell. This requirement goes beyond the specification of Hclean and of the symmetry data. We also note (see in particular Appendix H) that our numerical methods are expected to generalize to arbitrary gapped systems with next-neighbor hopping and interaction terms.\nd. Definition of \u03bd and \u03ba\nA lattice system with U(1) charge conservation symmetry has a filling per unit cell given by Ne\u03b7u:c:=Norb. where Ne is the number of electrons, Norb is the number of orbitals, and \u03b7u:c: is the number of orbitals per unit cell. On a clean torus, this reduces to \u03bd \u2254 \u00f0Ne=Nu:c:\u00de, where Nu:c: is the total number of unit cells. If the system has a unique, gapped ground state and has Chern number C, \u03bd and C are related by Eq. (2), which also defines the integer \u03ba. Equation (2) can be derived, for example, using the following argument [18,51]. The quantity e2\u03c0i\u03bd is by definition the Aharonov-Bohm phase corresponding to the adiabatic transport of a 2\u03c0 flux around a unit cell, which has flux \u03d5. Now the braiding phase of a flux \u03d51 around another flux \u03d52 can alternatively be expressed in terms of the Hall conductance \u03c3H; it equals ei\u03d51\u03d52\u03c3H \u00bc ei\u03d51\u03d52\u00f0C=2\u03c0\u00de. Taking a 2\u03c0 flux around a unit cell corresponds to setting \u03d51 \u00bc 2\u03c0;\u03d52 \u00bc \u03d5. Thus the same Aharonov-Bohm phase can be expressed in two ways:\nei2\u03c0\u03bd \u00bc ei\u03d5C \u00f0A2\u00de\n\u21d2 \u03bd \u00bc C \u03d5 2\u03c0 mod 1 \u00f0A3\u00de\n\u21d2 \u03bd \u00bc C \u03d5 2\u03c0 \u00fe \u03ba; \u00f0A4\u00de\nwhere \u03ba \u2208 Z. If C \u00bc 0, \u03bd \u00bc \u03ba. In the limit of small flux per unit cell, 0 \u2264 C\u03d5=2\u03c0 \u2264 1, \u03ba has a simple interpretation. When \u03ba \u00bc 0, a state with Chern number C corresponds to a system of C filled Landau levels. Therefore, \u03ba is simply the deviation of the total filling from the Landau level limit. In a system with \u03d5 \u00bc 2\u03c0p=q, where p, q are coprime, the filling on a torus takes the form \u03bd \u00bc r=q for some integer r. Then Eq. (2) can be written as a Diophantine equation r \u00bc q\u03ba \u00fe pC for the integers C, \u03ba. In the Hofstadter model it can further be shown that jCj \u2264 q=2. This Diophantine equation is often used in the study of the Hofstadter model. Finally, suppose we place the system on a closed manifold with lattice defects. This could, for example, be the surface of a cube, which has eight corners, each being a disclination with disclination angle \u03c0=2. In this case, the actual filling per unit cell differs from \u03bd. In fact,\nthe difference is proportional to the discrete shift, as discussed in Ref. [33]."
        },
        {
            "heading": "2. Origin dependence of b\u20d7o",
            "text": "Here we prove Eq. (28) in the main text. We define a Z2\ntranslation gauge field R\u20d7 and a ZM rotation gauge field \u03c9 (see Appendix F for a detailed definition). The holonomy of \u00f0R\u20d7;\u03c9\u00de around a defect equals some space group element which we denote as \u00f0b\u20d7o;\u03a9\u00de, with b\u20d7o \u2208 Z2;M\u03a9=2\u03c0 \u2208 ZM. b\u20d7o and \u03a9 encode the dislocation Burgers vector and the disclination angle of each defect. We assume that the starting point of the loop is an integer vector away from o. Now suppose we choose a different starting point for the loop o0 \u00bc o\u00fe v\u20d7, where v\u20d7 may be fractional. We wish to relate b\u20d7o0 to b\u20d7o. The group element which describes the same defect but with respect to the new origin o0 is obtained from \u00f0bo;\u03a9\u00de by conjugating with the translation \u00f0v\u20d7; 0\u00de:\n\u00f0v\u20d7; 0\u00de\u00f0b\u20d7o;\u03a9\u00de\u00f0\u2212v\u20d7; 0\u00de \u00bc \u00bdb\u20d7o \u00fe v\u20d7 \u2212U\u00f0\u03a9\u00dev\u20d7;\u03a9 : \u00f0A5\u00de\nHere U\u00f0\u03a9\u00de is the rotation matrix with angle \u03a9. The above result follows from the multiplication law for the space group. This group element must give the holonomy of R\u20d7;\u03c9 with respect to a loop starting at o0. Thus we find that\nb\u20d7o0 \u00bc b\u20d7o \u00fe v\u20d7 \u2212U\u00f0\u03a9\u00dev\u20d7; \u00f0A6\u00de\nas claimed."
        },
        {
            "heading": "3. Properties of So;P\u20d7o",
            "text": "The results below were first obtained in Refs. [17,33], and are compiled here for completeness. Suppose the rotation point group of the system is ZM, and consider an origin o whose site symmetry group is ZM0 . The topological response theory which defines So; P\u20d7o is reviewed in Appendix F. Although the quantization conditions are derived using group cohomology arguments that are mathematically involved, the following intuition is enough to understand them. If a lattice defect has disclination angle \u03a9 and Burgers vector b\u20d7o, the total charge at the defect is a sum of various independent contributions from the field theory, Eq. (13). In particular, the term \u00f0So=2\u03c0\u00deA \u2227 d\u03c9 assigns this defect a fractional charge So\u00f0\u03a9=2\u03c0\u00de, while the term \u00f0P\u20d7o=2\u03c0\u00de \u00b7 A \u2227 T\u20d7 assigns the defect a fractional charge P\u20d7o \u00b7 b\u20d7o. First, we argue that So is either an integer or a halfinteger, and it is defined modulo M0. Note that the term \u00f0So=2\u03c0\u00deA \u2227 d\u03c9 assigns U(1) charge So=M to a defect with disclination angle 2\u03c0=M and zero Burgers vector. On a closed spatial manifold of genus g, the total charge assigned by this term equals \u00f0So=2\u03c0\u00de R d\u03c9 \u00bc 2So\u00f01 \u2212 g\u00de. This must\n031005-26\nbe an integer, for each g, irrespective of the other terms in the response theory. Therefore, 2So must be an integer. Now, the charge at any defect can be changed by an integer through local operators which add a fermion at the defect. Therefore, the topological terms \u00f0So=2\u03c0\u00deA \u2227 d\u03c9 and \u00f0So \u00feM0=2\u03c0\u00deA \u2227 d\u03c9, which assign charge So=M0 and \u00f0So=M0\u00de \u00fe 1 to an elementary 2\u03c0=M0 disclination, are topologically equivalent (in fact, we can show that their difference does not contribute to the partition function on a closed manifold). This leads to the relation So \u2243So \u00feM0. The arguments given in Ref. [33] further show that if the generator of rotations at o satisfies C\u0303M 0\nM0;o \u00bc \u00fe1, there is a relation\nSo \u00bc C 2 mod 1: \u00f0A7\u00de\nThus, S is an integer or a half-integer according as C is even or odd. In particular, once we fix o and the Chern number, So can only take one of M0 distinct values. Next, we explain the quantization of P\u20d7o, which turns out to be very sensitive to M0. Consider a lattice defect with parameters \u00f0b\u20d7o;\u03a9\u00de. The response theory predicts that the fractional charge at such a defect receives a contribution\nP\u20d7o \u00b7 b\u20d7o mod 1\nfrom the term with P\u20d7o. Let us shift the origin by a lattice vector \u039b\u20d7. This takes b\u20d7o \u2192 b\u20d7o \u00fe \u039b\u20d7 \u2212U\u00f0\u03a9\u00de\u039b\u20d7. The charge at the defect with respect to the new origin is\nP\u20d7o \u00b7 \u00bdb\u20d7o \u00fe \u039b\u20d7 \u2212 U\u00f0\u03a9\u00de\u039b\u20d7 mod 1:\nFor the theory to be consistent under a shift of origin, the above quantities must agree mod 1; i.e.,\nP\u20d7o \u00b7 \u00bd\u039b\u20d7 \u2212 U\u00f0\u03a9\u00de\u039b\u20d7 \u00bc 0 mod 1: \u00f0A8\u00de\nWe can now take the minimal allowed disclination angle \u03a9 \u00bc \u00f02\u03c0=M0\u00de, and obtain the desired quantization:\nP\u20d7o \u00b7 \u039b\u20d7 \u2212U\n2\u03c0 M0 \u039b\u20d7 \u00bc 0 mod 1: \u00f0A9\u00de\nThe distinct choices of P\u20d7o compatible with this condition form a group which we denote KM0 . Using the rotation matrices given in Table II, we show below that P\u20d7o is a nontrivial topological invariant only when M0 \u00bc 2, 3, 4. The general parametrization for P\u20d7o is given in Eq. (10).\na. Deriving the quantization of P\u20d7o The matrix representation of U\u00f02\u03c0=M0\u00de for different M0 (chosen to be consistent with the coordinate axis definitions in Fig. 2) is given in Table II. When M0 \u00bc 2, Eq. (A9) gives\n2Po;x\u039bx \u00fe 2Po;y\u039by \u00bc 0 mod 1; \u00f0A10\u00de\nfor any \u039bx, \u039by. Therefore, we setPo;x \u00bc \u00f0Po;x=2\u00de;Po;y \u00bc \u00f0Po;y=2\u00de, where Po;x;Po;y are integers. When M0 \u00bc 3, Eq. (A9) gives after simplification:\nPo;x \u00bc Po;y \u00bc \u22122Po;x mod 1; \u00f0A11\u00de\nimplying that we can set P\u20d7o \u00bc \u00f0Po=3\u00de\u00f01; 2\u00de for some integer Po, with Po \u2243Po \u00fe 3. When M0 \u00bc 4, Eq. (A9) gives after simplification:\nPo;x \u00bc Po;y \u00bc \u2212Po;y mod 1; \u00f0A12\u00de\nimplying that we can set P\u20d7 \u00bc \u00f0Po=2\u00de\u00f01; 1\u00de for some integer Po, with Po \u2243Po \u00fe 2. When M0 \u00bc 6, Eq. (A9) gives after simplification:\nPo;x \u00bc Po;y \u00bc 0 mod 1; \u00f0A13\u00de\nimplying that P\u20d7o must be an integer vector and is therefore trivial.\nAPPENDIX B: CALCULATION OF P\u20d7o AND So WHEN C= 0\n1. P\u20d7o\nHere we show how to calculate P\u20d7o in the limit of zero Chern number, where the system can be adiabatically connected to an insulator in which the charge density is a sum of \u03b4 functions at themaximalWyckoff positions i \u00bc \u03b1, \u03b2, \u03b3, \u03b4. The charge at these points is always an integer, of the formNi. In this limit, the polarization P\u20d7o is related to the dipole moment P\u20d7o \u2254 P j\u2208\u0398 Qjr\u20d7j mod Z\n2, where\u0398 is the unit cell, and r\u20d7j is a representative position vector for the point j.\nNext we relate P\u20d7o to the desired quantity P\u20d7o: we show that\n\u00f0Po;x;Po;y\u00de \u00bc \u00f0Po;y;\u2212Po;x\u00de mod Z2: \u00f0B1\u00de This is true irrespective of any rotational symmetries. The argument is as follows (it is adapted from statements in Ref. [20], although our result differs from theirs by a sign). We consider a clean lattice in which the vector potential satisfies At \u00bc 0, and the translation gauge fields have components satisfying the \u201cnatural\u201d choice:\nXx \u00bc Yy \u00bc 1; Xy \u00bc Yx \u00bc 0\n031005-27\n[implying that R r\u20d7f r\u20d7i \u00f0Xx; Yy\u00de \u00bc r\u20d7f \u2212 r\u20d7i]. We set \u03c9 \u00bc 0 for convenience and assume that\nL \u00bc C 4\u03c0 A \u2227 dA\u00fe P\u20d7o 2\u03c0 \u00b7 A \u2227 dR\u20d7\u00fe \u03bdA \u2227 AXY; neglecting all other terms. With the above assumptions, L can be expanded as follows:\nL\u00bc C 4\u03c0 \u00f0\u2212Ax\u2202tAy\u00feAy\u2202tAx\u00de\u2212 Po;x 2\u03c0 \u2202tAy\u00fe Po;y 2\u03c0 \u2202tAx: \u00f0B2\u00de\nTherefore the expression for the current j is\nj \u00bc \u03b4L \u03b4Ax ; \u03b4L \u03b4Ay\n\u00bc 1 2\u03c0 \u2202t\u00f0\u2212Po;y;Po;x\u00de \u00fe C 2\u03c0 \u00f0\u2212Ex; Ey\u00de; \u00f0B3\u00de\nwhere Ex, Ey are the electric field components. But when C \u00bc 0, we can also write (after picking a suitable normalization)\nj \u00bc 1 2\u03c0 \u2202tP\u20d7o: \u00f0B4\u00de\nComparing the equations for j then gives Eq. (3). The above argument holds on the infinite plane or the torus, with and without rotational symmetry. Below we consider M \u00bc 2, 3, 4 separately; for M \u00bc 6, P\u20d7o \u2243 \u00f00; 0\u00de. We first determine P\u20d7o as a dipole moment, and then find the corresponding P\u20d7o. M \u00bc 2: Using Fig. 2 as reference, we find that, modulo 1,\nP\u20d7\u03b1 \u00bc 1\n2 \u00f0N\u03b2 \u00fe N\u03b3; N\u03b2 \u00fe N\u03b4\u00de;\nP\u20d7\u03b2 \u00bc 1\n2 \u00f0N\u03b1 \u00fe N\u03b4; N\u03b1 \u00fe N\u03b3\u00de;\nP\u20d7\u03b3 \u00bc 1\n2 \u00f0N\u03b1 \u00fe N\u03b4; N\u03b2 \u00fe N\u03b4\u00de;\nP\u20d7\u03b4 \u00bc 1\n2 \u00f0N\u03b2 \u00fe N\u03b3; N\u03b1 \u00fe N\u03b3\u00de: \u00f0B5\u00de\nThis implies that, modulo 1,\nP\u20d7\u03b1 \u00bc 1\n2 \u00f0N\u03b2 \u00fe N\u03b4; N\u03b2 \u00fe N\u03b3\u00de;\nP\u20d7\u03b2 \u00bc 1\n2 \u00f0N\u03b1 \u00fe N\u03b3; N\u03b1 \u00fe N\u03b4\u00de;\nP\u20d7\u03b3 \u00bc 1\n2 \u00f0N\u03b2 \u00fe N\u03b4; N\u03b1 \u00fe N\u03b4\u00de;\nP\u20d7\u03b4 \u00bc 1\n2 \u00f0N\u03b1 \u00fe N\u03b3; N\u03b2 \u00fe N\u03b3\u00de: \u00f0B6\u00de\nM \u00bc 3: Figure 2 shows that, modulo 1,\nP\u20d7\u03b1 \u00bc 1\n3 \u00f0N\u03b2 \u00fe 2N\u03b3; N\u03b2 \u00fe 2N\u03b3\u00de;\nP\u20d7\u03b2 \u00bc 1\n3 \u00f0N\u03b3 \u00fe 2N\u03b1; N\u03b3 \u00fe 2N\u03b1\u00de;\nP\u20d7\u03b3 \u00bc 1\n3 \u00f0N\u03b1 \u00fe 2N\u03b2; N\u03b1 \u00fe 2N\u03b2\u00de: \u00f0B7\u00de\nThis implies that, modulo 1,\nP\u20d7\u03b1 \u00bc 1\n3 \u00f0N\u03b2 \u00fe 2N\u03b3; 2N\u03b2 \u00fe N\u03b3\u00de;\nP\u20d7\u03b2 \u00bc 1\n3 \u00f0N\u03b3 \u00fe 2N\u03b1; 2N\u03b3 \u00fe N\u03b1\u00de;\nP\u20d7\u03b3 \u00bc 1\n3 \u00f0N\u03b1 \u00fe 2N\u03b2; 2N\u03b1 \u00fe N\u03b2\u00de: \u00f0B8\u00de\nSince by convention P\u20d7o \u00bc Po3 \u00f01; 2\u00de mod 1, the value of Po can be read off from the x component of the above equations. M \u00bc 4: Figure 2 shows that, modulo 1,\nP\u20d7\u03b1 \u00bc N\u03b2 \u00fe N\u03b3\n2 \u00f01; 1\u00de;\nP\u20d7\u03b2 \u00bc N\u03b1 \u00fe N\u03b3\n2 \u00f01; 1\u00de: \u00f0B9\u00de\nIn this case, P\u20d7o\u00bc P\u20d7o mod 1, andP\u03b1\u00f0\u03b2\u00de \u00bcN\u03b2\u00f0\u03b1\u00de \u00feN\u03b3 mod 2. The polarization at the points \u03b31, \u03b32 with C2 symmetry can be obtained from the above M \u00bc 2 results by taking \u03b32 \u00bc \u03b3, \u03b31 \u00bc \u03b4, and N\u03b3 \u00bc N\u03b4.\n2. So The calculation of So in a system withM-fold rotational symmetry proceeds by constructing a disclination with disclination angle 2\u03c0=M at o and measuring the fractional charge QW in a region W around the disclination. When C \u00bc 0 we can consider the fully filled limit in which the charge at any point in the MWPs i \u00bc \u03b1, \u03b2, \u03b3, \u03b4 is equal to Ni. Then, by working out the different cases, we find that\nSo \u00bc No mod M; \u00f0B10\u00de\nfor o \u00bc \u03b1, \u03b2, \u03b3, \u03b4.\n3. Argument that So is independent of o\nHere we use a square lattice calculation with C \u00bc 0 as an example to argue that So does not depend on the origin o used to construct the disclination, but only on the point o used to measure the dislocation Burgers vector. Say we want to prove that S\u03b2 is independent of the origin. We consider o \u00bc \u03b2 and o \u00bc \u03b1 separately and construct two\n031005-28\ndifferent \u03a9 \u00bc \u00f0\u03c0=2\u00de disclinations using C\u03034;o (see Fig. 12). We fix o \u00bc \u03b2 in both cases and extract S\u03b2 from the charge response. We have numerically checked thatS\u03b2 in for these two choices of o are the same (see Fig. 1). Now we analytically show thatSo is independent of o when C \u00bc 0. We pick the regionW shown in Fig. 12. We first consider Fig. 12(a) where o \u00bc \u03b2. In the C \u00bc 0 limit, the charge response is\nQW \u00bc S\u03b2 4 \u00fe 12\u03bd mod 1: \u00f0B11\u00de\nA direct counting of Wannier orbitals gives\nQW \u00bc 12N\u03b1 \u00fe 12\u00fe 1\n4\nN\u03b2 \u00fe 24N\u03b3: \u00f0B12\u00de\nSince \u03bd \u00bc N\u03b1 \u00fe N\u03b2 \u00fe 2N\u03b3 , we obtain S\u03b2 \u00bc 14N\u03b2. Now we switch to o \u00bc \u03b1 [see Fig. 12(b)]. The Burgers vector is nontrivial and there is an irregular unit cell in the defect core contributing nirreg;b\u20d7;o \u00bc 12 \u03bd. Taking C \u00bc 0, the impure disclination charge is\nQW \u00bc S\u03b2 4 \u00feP\u03b2 2 \u00fe 6\u00fe 1 2 \u03bd mod 1: \u00f0B13\u00de\nA direct counting of Wannier orbitals gives\nQW \u00bc 7N\u03b1 \u00fe 6\u00fe 3\n4\nN\u03b2 \u00fe 12\u00fe 3\n2\nN\u03b3: \u00f0B14\u00de\nWe now use the C \u00bc 0 result P\u03b2 \u00bc N\u03b1 \u00fe N\u03b3 which was obtained above. Combined with the above equations,\nwe again obtainS\u03b2 \u00bc 14N\u03b2. This completes our verification that S\u03b2 is independent of o . We can apply similar arguments to verify that So is independent of o for each o and each M \u00bc 2, 3, 4, 6."
        },
        {
            "heading": "APPENDIX C: MICROSCOPIC CONSTRUCTION",
            "text": ""
        },
        {
            "heading": "OF A DISLOCATION HAMILTONIAN",
            "text": "In this appendix, we demonstrate a systematic method to construct a dislocation Hamiltonian Hdefect in terms of the Hamiltonian Hclean on a clean rotationally symmetric lattice with M \u00bc 2, 3, 4, 6. The procedure is similar in spirit to the construction of disclination defects given in Ref. [33]. Since the dislocation is a defect of the translation symmetry, the construction necessarily involves the mag-\nnetic translation operator T\u0303 \u2261 ei P j \u03bbjc \u2020 j cj T\u0302, which is a translation followed by a gauge transformation which ensures that T\u0303 is a symmetry of Hclean. For concreteness, we write a general form of the Landau gauge on the square and honeycomb lattices below [this is analogous to the previously defined gauge on the torus, Eq. (56)]. For the square lattice,\nAj;j\u00fey\u0302 \u00bc \u00f0jx \u2212 o\u0304x\u00de\u03d5; j \u00bc \u00f0jx; jy\u00de; jx \u2208 Z; jy \u2208 Z: \u00f0C1\u00de\nThis vector potential is defined on an infinite plane. In this appendix, we use A\u2261 Aclean to denote the entire vector potential on the clean lattice. o\u0304 \u00bc \u00f0o\u0304x; o\u0304y\u00de is called the gauge origin. On the honeycomb lattice, consider Fig. 13. Assume that the boundaries of the unit cell align with the hoppings. Then define\n031005-29\nAi;i\u00fe\u00f0\u22121=3;2=3\u00de \u00bc Aj;j\u00fe\u00f01=3;1=3\u00de \u00bc \u00f0x \u2212 o\u0304x\u00de \u03d5\n2 ;\ni \u00bc ix \u2212\n1 3 ; iy \u2212 1 3 ; ix \u2208 Z; iy \u2208 Z;\nj \u00bc jx \u00fe\n1 3 ; jy \u00fe 1 3 ; jx \u2208 Z; jy \u2208 Z: \u00f0C2\u00de\ni and j are site indices at MWP \u03b2 and MWP \u03b3 of the C3 unit cell, respectively (refer to Fig. 2 for the unit cell convention). Using the aforementioned gauge choices, we now explain how to construct the dislocation Hamiltonian Hdefect for each M, starting with Hclean. In our numerics we use this procedure to construct dislocations with b\u20d7 \u00bc \u00f0 1; 0\u00de; \u00f00; 1\u00de; all other dislocation Burgers vectors lie in the same equivalence class as one of these choices of b\u20d7.\n1. C2, C4 dislocation\nLet us consider a dislocation on the simplest square lattice as an example. The construction below generalizes naturally to C2 lattice dislocations since both of them have quadrilateral unit cells. Given an origin o and the desired dislocation Burgers vector b\u20d7, the procedure for constructing Hdefect is summarized in three steps: (1) draw a cut parallel to b\u20d7, (2) define conjugate hopping terms, (3) perform local moves. The first step is to draw a linear cut in the direction of b\u20d7 [b\u20d7 \u00bc \u00f00; 1\u00de in Fig. 14]. This cut starts and ends on two plaquette centers. The cut intersects a set of links in the lattice corresponding to hopping\nterms in Hclean. We only consider two-fermion hopping terms below. Consider a particular term which intersects the cut, and is of the form c\u2020LjcRje \u2212iALjRj in Hclean. Lj and Rj are sites on the left and right of the cut, respectively. We conjugate only the operator cRj with the translation operator T\u0303y:\ne\u2212iALjRj c\u2020LjcRj \u2192 e \u2212iALjRj c\u2020Lj\u00f0T\u0303ycRj T\u0303\u2020y\u00de\n\u00bc e\u2212iALjRj \u00d7 e\u2212i\u03bbRj c\u2020LjcRj\u00fe1 : \u00f0C3\u00de\nStarting with Hclean, we delete the original hoppings e\u2212iALjRj c\u2020LjcRj and add the new hoppings e\u2212i\u00f0ALjRj\u00fe\u03bbRj \u00dec\u2020LjcRj\u00fe1 to obtain Hdefect. In the example shown in Fig. 14, this procedure creates a dislocation with b\u20d7 \u00bc \u00f00; 1\u00de on the \u2212y side of the cut and an antidislocation with b\u20d7 \u00bc \u00f00;\u22121\u00de on \u00fey side of the cut. We want to consistently ensure that the irregular unit cells in this construction are all triangular, and not pentagonal or in some other irregular shape. Therefore, in the third step, we make one local change of the hopping terms such that both the dislocation and antidislocation have a triangular plaquette [see Fig. 14(c)]. This fully determines Hdefect."
        },
        {
            "heading": "2. Properties of \u03d5irreg on square lattice",
            "text": "Here we derive several statements that were made in Sec. V regarding the flux \u03d5irreg in a dislocation plaquette on a square lattice.\n031005-30\na. Proof of Eq. (43)\nConsider Fig. 14. We refer to the point j in this figure as j0 in the main text. For a b\u20d7 \u00bc \u00f00; 1\u00de Burgers vector, the flux in the irregular dislocation plaquette can be written in terms of the vector potential Adefect on the defect lattice as follows:\n\u03d5irreg \u00bc Adefect;ij \u00fe Adefect;jk \u00fe Adefect;ki: \u00f0C4\u00de\nFrom Eq. (C3), we see that the new hopping created in the defect lattice tc\u2020i cke\n\u2212iAdefect;ik can be calculated in terms of the vector potential on the clean lattice; i.e.,\nAdefect;ik \u00bc Aij \u00fe \u03bbj:\nMoreover, Adefect;ij \u00bc Aij and Adefect;jk \u00bc Ajk. Therefore,\n\u03d5irreg \u00bc Ajk \u2212 \u03bbj: \u00f0C5\u00de\nIn the main text we explicitly write j \u00bc j0, k \u00bc j0 \u00fe y\u0302.\nb. Change in \u03d5irreg Next we prove the claims in Sec. VA about how \u03d5irreg changes when either \u03bb or j0 is changed. (1) Suppose we change j0 \u2192 j0 \u00fe \u00f0vx; 0\u00de, vx \u2208 Z,\nkeeping A, \u03bb fixed. Then the change in \u03d5irreg is\n\u0394\u03d5irreg \u00bc Aj0\u00fe\u00f0vx;0\u00de;j0\u00fe\u00f0vx;0\u00de\u00fey\u0302 \u2212 \u03bbj0\u00fe\u00f0vx;0\u00de \u2212 \u00f0Aj0;j0\u00fey\u0302 \u2212 \u03bbj0\u00de: \u00f0C6\u00de\nNow we use Eq. (58). On the infinite plane, Eq. (58) holds exactly, while on the torus, where it is not exact everywhere, we ensure that the dislocation is constructed within a region where this equality does hold. Then we get\n\u03bbj0 \u2212 \u03bbj0\u00fe\u00f0vx;0\u00de \u00bc Aj0;j0\u00fe\u00f0vx;0\u00de \u2212 Aj0\u00fey\u0302;j0\u00fe\u00f0vx;0\u00de\u00fey\u0302: \u00f0C7\u00de\nTherefore,\n\u0394\u03d5irreg \u00bc Aj0\u00fe\u00f0vx;0\u00de;j0\u00fe\u00f0vx;0\u00de\u00fey\u0302 \u2212 Aj0;j0\u00fey\u0302 \u00fe Aj0;j0\u00fe\u00f0vx;0\u00de \u2212 Aj0\u00fey\u0302;j0\u00fe\u00f0vx;0\u00de\u00fey\u0302 \u00f0C8\u00de\n\u00bc \u00fe\u03d5vx: \u00f0C9\u00de\nThe last equality is because the sum over Ameasures the flux in a rectangle of side lengths vx and 1 in the x and y directions, respectively.\n(2) Suppose we change \u03bbj \u2192 \u03bbj \u00fe \u03c7 for each j, and \u03c7 \u00bc \u03d5vx. j0 and A are fixed. Then from Eq. (C5), \u0394\u03d5irreg \u00bc \u2212\u03d5vx.\nc. Proof of Eq. (61)\nWith \u03bbj as defined in Eq. (59), we calculate \u03d5irreg given that the dislocation is created at x \u00bc j0;x on the torus:\n\u03d5irreg \u00bc 8>< >: \u00f0j0;x \u2212 o\u0304x\u00de\u03d5\u00fe \u03d52 Lx j0;x < o\u0304x \u00f0j0;x \u2212 o\u0304x\u00de\u03d5 \u2212 \u03d52 Lx j0;x > o\u0304x 0 j0;x \u00bc o\u0304x:\n\u00f0C10\u00de\nSince the sites have integer x and y coordinates, we use Eq. (60), along with the following relation, which can be read off from Table IV:\nnirreg;o \u00bc \u2212 ox \u00fe\n1\n2\nmod 1: \u00f0C11\u00de\nThis relation is defined mod 1 because an integer change of nirreg;o does not change o mod Z2. From these two conditions we find that ox \u00bc o\u0304x \u2212 12 \u2212 \u00f0Lx=2\u00de mod 1 whenever j0;x \u2260 o\u0304x. This is the same as our numerical observation using Eq. (61).\n3. C3, C6 dislocation\nWe can use a similar method to construct a C3 or C6 dislocation in the honeycomb lattice. Figure 15 shows the full procedure for constructing a b\u20d7 \u00bc \u00f00; 1\u00de dislocation and antidislocation pair.\n031005-31\nWith some fixed gauge origin o\u0304\u2261 \u00f0o\u0304x; o\u0304y\u00de, we construct Hdefect from Hclean following the same three steps as above. For consistency we choose the irregular unit cell to be quadrilateral (rather than, say, an octagon). As above, using \u03b4\u03a6W;o \u00bc 0, we demand that T\u0303y should create a dislocation with \u03d5irreg \u00bc \u03d5nirreg. Using \u03bbj defined in Eq. (86), we again recover the relation between ox and o\u0304x to be ox \u00bc o\u0304x \u2212 \u00f0Lx=2\u00de \u2212 12 mod 1."
        },
        {
            "heading": "APPENDIX D: INDEPENDENCE OF fSo;P\u20d7og UNDER SHIFT OF UNIT CELL",
            "text": "In this appendix, we describe the trimming method which serves as a tool to prove that P\u20d7o and So do not depend on the choice of unit cell \u0398. It is worth noting that the linear momentum calculation and the 1D polarization calculation are completely independent of \u0398. Only the charge response calculation depends on \u0398. We provide two examples to illustrate the method, for So and P\u20d7o, respectively.\n1. So Consider a pure disclination on the square lattice with the C4 symmetric origin o at a site, as shown in Fig. 16(a). We consider the two choices of unit cell \u03981, \u03982 shown in Figs. 16(c) and 16(d). We also define two regions W1, W2 whose boundaries are aligned with those of \u03981, \u03982, respectively. Following Eq. (77), the charge response for W1 can be written as\nQW1 \u00bc So 4 \u00fe k1 \u00fe 3 4 \u03bd\u00fe C\u03b4\u03a6W1 2\u03c0 mod 1; \u00f0D1\u00de\nwhere k1 is the integer part of nW1 . Since o is at the center of the unit cell, we have no;irreg;\u03a9 \u00bc 1 \u2212 \u00f0\u03a9=2\u03c0\u00de \u00bc 34 as defined in Eq. (78). The charge response for W2 can be written as\nQW2 \u00bc So 4 \u00fe k2\u03bd\u00fe C\u03b4\u03a6W2 2\u03c0 mod 1: \u00f0D2\u00de\nThe extra flux \u03b4\u03a6W is only inserted near the defect, and W1 and W2 only differ at their boundary. Therefore, \u03b4\u03a6W1 \u00bc \u03b4\u03a6W2. In order to prove that So extracted in the two equations above is the same, we need to show that QW1 \u2212QW2 \u00bc \u00f0k3 \u00fe 34\u00de\u03bd. Since we can arbitrarily add a full unit cell on the boundary ofW1 orW2, k3 can vary freely without changing So, but the fractional part in parentheses needs to be 34. In order to compare QW1 and QW2, we trim W1 into W2. This only requires cutting out subcells on the boundary, which is assumed to be far away from the defect. Thus, on the boundary we expect the charge in each unit cell to be \u03bd, and the charge in each subcell to be 1\n4 \u03bd. With this\ninformation, we can explicitly calculate QW1 \u2212QW2. For example, in Figs. 16(a) and 16(b), QW1 \u2212QW2 \u00bc \u00f06\u00fe 3 4 \u00de\u03bd, which satisfies the aforementioned condition. The above process is repeated for disclinations with M \u00bc 2, 3, 4, 6 lattice with arbitrary o and \u03a9. In all cases, the value of QW1 \u2212QW2 obtained from the trimming method is consistent with a fixed value for So. This allows us to check that the extracted So does not depend on \u0398.\n2. P\u20d7o\nWe use a similar procedure to prove that P\u20d7o does not depend on the choice of \u0398. Consider the honeycomb lattice dislocation shown in Fig. 15(d) with Burgers vector b\u20d7 \u00bc \u00f00;\u22121\u00de. Let us consider o to be at a plaquette center. Two choices of \u0398 are shown in Figs. 17(c) and 17(d). The charge response with unit cell as in Fig. 17(c) can be written as\nQW1 \u00bc P\u20d7o \u00b7 b\u20d7\u00fe k1 \u00fe\n2\n3\n\u03bd\u00fe C\u03b4\u03a6W1\n2\u03c0 mod 1: \u00f0D3\u00de\nAgain, k1 is the integer part of the number of unit cells enclosed by W1. Since the position of the origin relative to the center of the unit cell is \u00f02\n3 ;\u2212 1 3 \u00de, the fractional value of\nnirreg can be read off from Table IV. Similarly, the charge response with \u03982 as in Fig. 17(d) can be written as\nQW2 \u00bc P\u20d7o \u00b7 b\u20d7\u00fe k2\u03bd\u00fe C\u03b4\u03a6W2 2\u03c0 mod 1: \u00f0D4\u00de\nSimilar to the previous example, \u03b4\u03a6W1 \u00bc \u03b4\u03a6W2, and we need to show that QW1 \u2212QW2 \u00bc \u00f0k3 \u00fe 23\u00de\u03bd.\n031005-32\nIn the example shown in Figs. 17(a) and 17(b), each subcell contributes 1\n3 \u03bd. We have QW1 \u2212QW2 \u00bc 143 \u03bd \u00bc\n\u00f04\u00fe 2 3 \u00de\u03bd, giving the expected answer.\nThis procedure can be extended toM \u00bc 2, 3, 4, 6 lattices with arbitrary o and b\u20d7. With this we can verify that P\u20d7o does not depend on \u0398."
        },
        {
            "heading": "APPENDIX E: FURTHER DETAILS IN LINEAR MOMENTUM CALCULATION",
            "text": "In this appendix, we first state some numerical observations on how the quantization of the linear momentum changes upon starting with the operator T\u0303y as in Eq. (59) but then changing the location of the strip that violates translation symmetry. Then we discuss some technical details regarding the partial translation method. The numerical results of linear momentum can be seen in Fig. 18. We note that in the main text, the origin o for the charge polarization is defined in terms of the gauge origin o\u0304. This is, however, not the only way to define o. For a given A, \u03bb, where \u03bb is associated to the operator T\u0303y, there is a point o\u0303 which satisfies\n\u03bbo\u0303 \u2212 Ao\u0303;o\u0303\u00fey\u0302 \u00bc 0: \u00f0E1\u00de\no\u0303 does not change under gauge transformations, which take Aij \u2192 Aij \u00fe fj \u2212 fi and \u03bbj \u2192 \u03bbj \u2212 fj \u00fe fj\u00fey\u0302. This transformation of \u03bbj is obtained by solving Eq. (58) after gauge transforming A. Therefore o\u0303 is a gauge-invariant point, and we can in principle define o in terms of o\u0303 by constraining the flux at a dislocation defect. This involves arguments\nsimilar to the ones in Appendix C. However, we do not use o\u0303 in the present work."
        },
        {
            "heading": "1. Freedom in changing location of strip",
            "text": "Consider the choice of \u03bb in Eq. (59). Apart from global U(1) transformations, we can consider other choices of \u03bbj which serve equally well as approximate symmetries. For example, we can consider\nT\u0303 0y \u00bc 8>>< >>: T\u0302ye i P j \u2212\u00f0\u03c0m=Ly\u00dec\u2020j cj jx < o\u0304x \u00fe \u03b4 T\u0302ye i P j \u00f0\u03c0m=Ly\u00dec\u2020j cj jx > o\u0304x \u00fe \u03b4\nT\u0302y jx \u00bc o\u0304x \u00fe \u03b4; \u00f0E2\u00de\nfor some real number \u03b4 \u2260 0. The vector potential is again almost symmetric with respect to T\u0303 0y ; the strip where T\u0303 0y is locally not the symmetry of the Hamiltonian is, however, shifted from o\u0304 by the amount \u03b4 in the x direction. However, the expectation value of T\u0303 0y does not yield the desired invariant Po;y. We have numerically checked that for any \u03b4 \u2260 0, the resulting values of Po;y are not even quantized throughout each gapped phase of the Hofstadter model when C \u2260 0. And when C \u00bc 0, choosing \u03b4 \u2260 0 continues\n031005-33\nto give a quantized result, but certain choices of \u03b4 will give Po\u00fe\u00f01=2;0\u00de;y instead of Po;y. These observations can be understood as follows.\nSuppose we calculate Po;y using T\u0303y for a given choice of strip, and then change the strip position by \u03b4x\u0302 as in Eq. (E2). In general, if \u03b4 \u2260 0, \u03bbj changes by kj\u03c0m=Ly for each j that was crossed by the strip as it was shifted. kj \u00bc 1 if j lies exactly on the initial or the final position of the strip, and kj \u00bc 2 if j lies in between the initial and final positions of the strip. Let S be the set of points crossed by the strip. Then,\nT\u0303y \u2192 T\u0303ye i P j\u2208S \u00f0kj\u03c0m=Ly\u00den\u0302j : \u00f0E3\u00de\nWhen C \u00bc 0, we verify numerically that the state j\u03a8i is an almost exact eigenstate of n\u0302j, with expectation value \u03ba (the statement being exact for the Hofstadter model). Thus we obtain:\nT\u0303y \u2192 T\u0303ye i\u03c0m\u03ba\nP j\u2208S \u00f0kj=Ly\u00de: \u00f0E4\u00de\nSince the number of points j corresponding to a fixed kj is always a multiple of Ly, the extra factor is of the form \u00f0\u22121\u00dek0m, where k0 \u00bc 0 or 1, and is fixed by the actual values of kj and \u03ba. If k0 \u00bc 0, Po;y is invariant. But if k0 \u00bc 1, Po;y \u2192 Po;y \u00fe 1=2. Note that this reasoning breaks down when C \u2260 0:\nj\u03a8\u00f0m\u00dei is not an eigenstate of Pj\u2208S n\u0302j, and Po;y hence can be expected to depend sensitively on the strip position. As mentioned in the main text, empirically we have found that the strip needs to be aligned with the gauge origin o\u0304 in order to obtain consistent results for Po;y."
        },
        {
            "heading": "2. Partial translation",
            "text": "In the partial translation calculation we define the operator T\u0303yjD and find that we need to pick a particular choice of D, so that D is a cylinder defined mirror symmetrically about the cycle x \u00bc o\u0304x \u2212 \u00f0Lx=2\u00de [with holonomy \u00f0\u22121\u00dem]. This set of choices recovers P\u20d7o that is consistent with the dislocation charge calculation. There is another natural choice of parameters: we can chooseD to be defined around x \u00bc o\u0304x, and choose T\u0303yjD \u00bc T\u0302yjD. We numerically find that this choice gives P\u20d7o \u00bc 0 everywhere in the butterfly. We do not have a complete explanation for why the first set of choices is required. However, we find a resemblance between this result and the calculation of angular momentum through partial rotations discussed previously in Ref. [33]. In that calculation we need to choose a disk D centered around a special point o2, which is one of the two vertices invariant under the chosen rotation operator at a vertex v, C\u03024;v. The holonomy of A around either cycle\nwhich crosses o2 is ei\u03c0m in a system with m flux quanta. But if we choose a disk centered around the other fixed point o1, with respect to which A has trivial holonomy, the resulting value of the discrete shift varies irregularly within the same Hofstadter lobe and is not meaningful. Thus if we consider partial spatial symmetries, the calculation of both So and P\u20d7o involves the part of the system with ei\u03c0m holonomy rather than the part of the system with trivial holonomy. We can provide some more heuristic numerical evidence explaining this choice. We consider a system at fixedC and plot the phase of a randomly chosen low-energy singleparticle eigenstate for different choices of m (see Fig. 19). We empirically find that the phase variation in the y direction nearly vanishes around the cycle x \u00bc o\u0304x. Note that our choice of D excludes the region around x \u00bc o\u0304x. The phase of h\u03a8jT\u0303yjDj\u03a8i is nearly unaffected by this choice of D. However, choosing D to exclude the region around x \u00bc o\u0304x \u2212 \u00f0Lx=2\u00de will significantly change h\u03a8jT\u0303yjDj\u03a8i. The above discussion suggests that the region around x \u00bc o\u0304x \u2212 \u00f0Lx=2\u00de is in a sense more important than the region around x \u00bc o\u0304x in order to extract P\u20d7o."
        },
        {
            "heading": "APPENDIX F: DERIVATION OF TOPOLOGICAL RESPONSE THEORY",
            "text": "Here we discuss the construction of the topological response theory for invertible fermionic phases with the symmetry group Gf \u00bc U\u00f01\u00def \u00d7\u03d5 \u00bdZ2 \u22ca ZM . This construction was first developed for bosonic topological phases in Ref. [17], and a partial extension to invertible fermionic phases focusing on So was discussed in Ref. [33]. In this appendix, after reviewing the definition of crystalline gauge fields, we present two computations that are new: a derivation of the complete response theory using results from Ref. [14], and a derivation of the quantization of P\u20d7o from field theory.\n031005-34"
        },
        {
            "heading": "1. Review of crystalline gauge fields",
            "text": "Consider a 3-manifold M3. We define real-valued differential 1-form gauge fields \u03b4A;X;Y;\u03c9\u2208\u03a91\u00f0M3;R\u00de. \u03b4A denotes the part of the vector potential in excess of the uniform background, and we identify \u03b4A \u223c \u03b4A\u00fe 2\u03c0. (Note that the quantity A is taken to mean the entire vector potential.) R\u20d7 \u00bc \u00f0X; Y\u00de represents the Z2 translation component. \u03c9 is a ZM rotation gauge field. The full gauge field is denoted as B \u00bc \u00f0\u03b4A; R\u20d7;\u03c9\u00de. It is non-Abelian and composes according to the group law of Gf.\nThe flux of B has three components \u00f0F; T\u20d7; d\u03c9\u00de. F \u2254 d\u03b4A\u00fe \u03d5AXY is the density of magnetic flux. It consists of a background contribution \u03d5AXY proportional to the area element AXY , and an excess contribution which is measured by d\u03b4A. We can equivalently write F \u00bc dA, where A is the full vector potential. AXY depends on \u00f0X; Y\u00de, and its precise form also depends on the value ofM, but when \u03c9 \u00bc 0, AXY \u00bc X \u222a Y. T\u20d7 is the torsion; the quantity \u00f01=2\u03c0\u00de RD2 T\u20d7 measures the total dislocation Burgers vector within a 2D region D2. When we use orthogonal coordinates, for example when M \u00bc 4, we can write T\u20d7 \u2254 dR\u20d7\u00fe i\u03c3y\u03c9 \u2227 R\u20d7, where i\u03c3y \u00bc\n0 1\n\u22121 0 . The general definition of T\u20d7 depends on how we fix our coordinate basis. We note, however, that in the original simplicial formulation of the response theory, we can simply define T\u20d7 \u00bc dR\u20d7 for any value of M, because the second term can be removed by a suitable gauge transformation [17]. d\u03c9 is the disclination density; the quantity\n\u00f01=2\u03c0\u00de RD2 d\u03c9 measures the total disclination angle within D2. In order to correctly encode the curvature and torsion of M3, we set R\u20d7;\u03c9 equal to the SO(2) components of the coframe fields and the spin connection on M3. There is a very important issue that was not commented upon in Refs. [17,33]. Since the dislocation Burgers vector can in general be origin dependent, the translation gauge fields must themselves be origin dependent. This means that quantities in the action constructed out of the crystalline gauge fields may all in principle carry an origin dependence. We return to this point in Appendix G. We impose the condition that B is a Gf gauge field through quantization conditions on the total flux of B through closed and open 2D submanifolds ofM3. If D2 \u2282 M3 is a closed 2D submanifold, then the gauge field on D2 must be flat; i.e.,\nT\u20d7\u00f0x\u20d7\u00de \u00bc 2\u03c0 1 \u2212 U\n2\u03c0\nM X j \u20d7lj\u03b4\u00f02\u00de\u00f0x\u20d7 \u2212 x\u20d7j\u00de; \u00f0F1\u00de\n\u03b4A\u00f0x\u20d7\u00de \u00bc 2\u03c0 X j mj\u03b4\u00f02\u00de\u00f0x\u20d7 \u2212 x\u20d7j\u00de; \u00f0F2\u00de\n\u03c9\u00f0x\u20d7\u00de \u00bc 2\u03c0 X j nj\u03b4\u00f02\u00de\u00f0x\u20d7 \u2212 x\u20d7j\u00de; \u00f0F3\u00de\nwithin D2, where \u20d7lj \u2208 Z2 and mj; nj \u2208 Z. This physically corresponds to saying that the only sources of flux inD2 are points at the positions x\u20d7j, which each carry an integer number of flux quanta. Note that the factor \u00bd1 \u2212U\u00f02\u03c0=M\u00de appears in the condition for T\u20d7, because a Burgers vector of the form \u00bd1 \u2212U\u00f02\u03c0=M\u00de r\u20d7, r\u20d7 \u2208 Z2, is in the trivial class (see Appendix A) and therefore corresponds to a trivial quantum of flux. On open manifolds, we can have nonflat gauge field configurations, which can assign fractions of a flux quantum. The following conditions ensure that the net flux of the crystalline gauge fields in a region, although fractional, always corresponds to an element of Gspace:\nT\u20d7\u00f0x\u20d7\u00de \u00bc 2\u03c0 X j \u20d7lj\u03b4\u00f02\u00de\u00f0x\u20d7 \u2212 x\u20d7j\u00de; \u00f0F4\u00de\n\u03c9\u00f0x\u20d7\u00de \u00bc 2\u03c0 M X j nj\u03b4\u00f02\u00de\u00f0x\u20d7 \u2212 x\u20d7j\u00de: \u00f0F5\u00de\nEven when we allow nonflat gauge field configurations on an open manifold, the integral through any closed 2D submanifold D2 must still be appropriately quantized:\n1\n2\u03c0 Z D2 T\u20d7 \u00bc X j \u20d7lj \u00bc 1 \u2212U 2\u03c0 M \u20d7 ltot;\n1\n2\u03c0 Z D2 dA \u00bc 1 M X j mj \u00bc mtot;\n1\n2\u03c0 Z D2 d\u03c9 \u00bc ntot; \u00f0F6\u00de\nwhere mtot; ntot \u2208 Z and \u20d7ltot \u2208 Z2. Physically, ntot is the Euler characteristic of D2."
        },
        {
            "heading": "2. Response theory",
            "text": "a. General derivation\nThe general construction of a response theory for invertible fermionic topological phases with symmetry group Gf\u00bcU\u00f01\u00def\u00d7\u03d5 \u00bdZ2\u22caZM was outlined in Ref. [33]. In that work, specific quantization conditions on the discrete shift were derived by ignoring translations. Here we recall the main steps in the derivation, but also consider translations, with a view to obtaining the quantization of P\u20d7o. First, note that the quantity \u00bd\u03c92 \u2208 H2\u00f0Gb;Z2\u00de specifies Gf as a group extension of Gb by Z f 2. To express \u03c92 in terms of the gauge fields, we define\n031005-35\nB\u00f02\u00de2 \u2254 1 2 \u00f02F \u00fe kd\u03c9\u00de \u00bc \u03c0B \u03c92; \u00f0F7\u00de\nwhere B refers to the pullback via B [meaning B \u03c92\u00f0x\u00de \u00bc \u03c92\u00bdB\u00f0x\u00de for x \u2208 M3] [52]. As mentioned in Ref. [33], if the chosen 2\u03c0 rotation operator acts as the identity, we should set k \u00bc 1 in the above definition; if it acts as the fermion parity \u00f0\u22121\u00deF, we should set k \u00bc 0. Accordingly, here we use k \u00bc 1. Note that the choice of k in the definition of\u03c92 and hence B\u00f01\u00de2 specifies the angular momentummod 1 of the fermion. In general, \u03c92 specifies the fractional Gb quantum numbers of the fermion [14].\nNext, we define the quantity B\u00f01\u00de2 \u00bc \u03c0B n2, where n2 \u2208 Z2\u00f0Gb;Z2\u00de is a general 2-cocycle, which is also one piece of the data in the classification of Ref. [14]. In our case, n2 specifies the fermion parity change in the ground state after introducing a Gb flux quantum. It turns out that the most general possible parametrization of B\u00f01\u00de2 is as follows:\nB\u00f01\u00de2 \u2254 1 2 f2kFF\u00fek\u03c9d\u03c9\u00fe\u00bd1\u2212U\u00f02\u03c0=M\u00de \u22121k\u20d7T \u00b7 T\u20d7\u00fekAAXYg;\n\u00f0F8\u00de\nwhere kF; k\u03c9; kA \u2208 Z and k\u20d7T \u2208 Z2. For M \u00bc 3, 6, we require k\u20d7T \u00bc \u00f00; 0\u00de. This parametrization of n2 can be found, for example, in Appendix D of Ref. [17]. We also use the fact that n2 \u2243 n2 \u00fe \u03c92 (this is proven in Ref. [14] and is an equivalence due to relabeling fermion parity defects in the invertible phase). We use this equivalence to set kF \u00bc 0. The three remaining terms have the following interpretation: (1) k\u03c9 is the fermion parity change upon inserting a set of disclinations with \u03a9 \u00bc 2\u03c0; (2) k\u20d7T \u00b7 \u039b\u20d7 specifies the fermion parity change in a region upon introducing dislocations with total Burgers vector \u00bd1 \u2212U\u00f02\u03c0=M\u00de \u039b\u20d7; (3) kA specifies the fermion parity per unit cell. Then, the main result (obtained using the general theory developed in Ref. [14]) is that the Lagrangian density L which gives the topological response theory for an invertible fermionic phase with symmetry Gf and chiral central charge c\u2212 must satisfy\ndL \u00bc 2 \u03c0 1 2 B\u00f01\u00de2 \u2227 \u00f0B\u00f01\u00de2 \u00fe B\u00f02\u00de2 \u00de \u00fe c\u22128 B \u00f02\u00de 2 \u2227 B\u00f02\u00de2 mod 2\u03c0:\n\u00f0F9\u00de\nIts meaning is the following. The 2-cocycles n2, \u03c92 (alternatively, the quantities B\u00f01\u00de2 ; B \u00f02\u00de 2 ) together specify the Gb quantum numbers of the fermions and the fermion parity defects in the system. But in order to ensure that the Gb quantum numbers of all symmetry defects are well\ndefined in \u00f02\u00fe 1\u00deD, we need an extra condition given by Eq. (F9). Note that if the rhs of this equation corresponds to a nontrivial class in the group H4\u00bdGb;U\u00f01\u00de , there is no solution for L, and the system can only live on the boundary of a \u00f03\u00fe 1\u00deD symmetry-protected topological (SPT) phase whose effective action is defined by the quantity dL. For free fermion phases, we can set C \u00bc c\u2212; in general, C \u00bc c\u2212 mod 8. The response theory finally obtained from this condition, by substituting B\u00f01\u00de2 ; B \u00f02\u00de 2 and integrating, takes the form\nL \u00bc C 4\u03c0 A \u2227 dA\u00feSo 2\u03c0 A \u2227 d\u03c9\u00fe P\u20d7o 2\u03c0 \u00b7 A \u2227 T\u20d7 \u00fe \u03ba 2\u03c0 A \u2227 AXY\n\u00fe els 4\u03c0 \u03c9 \u2227 d\u03c9\u00fe P\u20d7s 2\u03c0 \u00b7\u03c9 \u2227 T\u20d7 \u00fe \u03bds 2\u03c0\n\u03c9 \u2227 AXY \u00fe ; \u00f0F10\u00de\nwhere the dots refer to additional terms that can be nonzero even if \u03b4A;\u03c9 are both zero. We note that because dL only involves F, L is written entirely in terms of A, even though one might expect that it should be written in terms of \u03b4A. The coefficients in this equation can all be expressed in terms of k\u03c9, kT , kA, as we now show for P\u20d7o.\nb. Quantization of P\u20d7o using response theory\nThe quantization of So and its dependence on c\u2212 was discussed in Ref. [33]. Below we only discuss the quantization of P\u20d7o. In the next section we discuss the origin dependence of So and P\u20d7o. Note that the derivative of the term with P\u20d7o in Eq. (F10) can be written as \u00f0P\u20d7o=2\u03c0\u00de \u00b7 dA \u2227 T\u20d7 \u00bc \u00f0P\u20d7o=2\u03c0\u00de \u00b7 F \u2227 T\u20d7 \u00fe . When kF \u00bc 0, such a term can only come from the B\u00f01\u00de2 \u2227 B\u00f02\u00de2 term in Eq. (F9). Indeed, by comparing the two equations we must have\nP\u20d7o 2\u03c0 F \u2227 T\u20d7 \u00bc 1 \u03c0 F \u2227 1 2 \u00bd1 \u2212 U\u00f02\u03c0=M\u00de \u22121k\u20d7T \u00b7 T\u20d7 mod 2\u03c0:\n\u00f0F11\u00de\nThe above equation implies that\nP\u20d7o \u00bc \u00bd1 \u2212U\u00f02\u03c0=M\u00de \u22121\u00f0k\u20d7T \u00fe 2k\u20d7T;SPT\u00de mod Z2: \u00f0F12\u00de\nThe term with k\u20d7T;SPT \u2208 Z2 arises as a constant of integration. It does not contribute to dL, and can physically be thought of as the polarization in a bosonic SPT phase which is stacked onto the original fermionic phase. We now use the conditions k\u20d7T ; k\u20d7T;SPT \u2208 Z2, along with the fact that integer choices of P\u20d7o do not contribute to the partition function. With this we obtain the quantization result claimed in the main text. In particular, the classification\n031005-36\nof P\u20d7o for invertible bosonic and fermionic systems is the same, in contrast to the results for the Hall conductance and So. There is no dependence of P\u20d7o on c\u2212 because in Eq. (F9) the terms proportional to c\u2212 only depend on F and d\u03c9, and not on T\u20d7. The nontrivial values of P\u20d7o are entirely due to k\u20d7T when M \u00bc 2, 4, and entirely due to k\u20d7T;SPT when M \u00bc 3. Finally, we note that the first four terms in Eq. (F10) can be rewritten in a perhaps more familiar form, using the relations \u03bd \u00bc \u03ba \u00fe \u00f0C\u03d5=2\u03c0\u00de and F \u00bc d\u03b4A\u00fe \u03d5AXY :\nL \u00bc C 4\u03c0 \u03b4A \u2227 d\u03b4A\u00fe So 2\u03c0 \u03c9 \u2227 d\u03b4A\u00fe P\u20d7o 2\u03c0 \u00b7 R\u20d7 \u2227 d\u03b4A \u00fe \u03bd 2\u03c0 d\u03b4A \u2227 AXY \u00fe : \u00f0F13\u00de\nThe advantage of this representation is that it makes the physical invariant \u03bd explicit, and is also closer in spirit to the Chern-Simons response theory of the continuum quantum Hall effect, which only includes \u03b4A. However, it is a weaker form of the field theory, because it leaves out several terms that were explicit in Eq. (F10). For the derivations in the main text, we write the field theory in terms of A and not \u03b4A. Remarkably, our empirical findings are easier to explain using Eq. (F10) than with the above Lagrangian."
        },
        {
            "heading": "APPENDIX G: COMPUTATIONS FOR SEC. VII",
            "text": "Here we use the simplicial formulation of the topological response theory [17] to derive the quantities \u03c1M; \u03bc\u20d7M; \u03c4\u20d7M defined in Eqs. (93)\u2013(95)."
        },
        {
            "heading": "1. Fractional gauge transformations",
            "text": "The definition of each group element gi \u00bc \u00f0ri; hi\u00de \u2208 Gspace implicitly depends on the choice of origin o. For example, h \u00bc \u00f00; 1 mod M\u00de is the element in Gspace corresponding to a rotation by angle 2\u03c0=M (about o). Now suppose o0 \u00bc o\u00fe v\u20d7, as before. The group element g0i which implements the same transformation but with respect to the new origin o0 can be expressed as follows:\ng0i \u00bc \u00f0v\u20d7; 0\u00deg\u00f0\u2212v\u20d7; 0\u00de; \u00f0G1\u00de\nwhich corresponds to translating from o0 to o, applying g, and translating back. Now we use the group multiplication law in Gspace,\n\u00f0r1; h1\u00de\u00f0r2; h2\u00de \u00bc \u00bdr1 \u00fe U\u00f02\u03c0h1=M\u00der2; h1 \u00fe h2 ; \u00f0G2\u00de\nto find that\ng0i \u00bc \u00bdri \u2212U\u00f02\u03c0hi=M\u00dev\u20d7\u00fe v\u20d7; hi : \u00f0G3\u00de"
        },
        {
            "heading": "2. Change in So",
            "text": "First we study the transformation of d\u03c9. A cocycle representative for d\u03c9 can be explicitly written on a 2-simplex with the group elements g1;g2; \u00f0g1g2\u00de\u22121:\nd\u03c9\u00f0g1;g2\u00de \u00bc \u00bdh1 M \u00fe \u00bdh2 M \u2212 \u00bdh1 \u00fe h2 M\nM ; \u00f0G4\u00de\nwhere \u00bda M \u2254 a mod M. Since d\u03c9 does not depend on the translation group variables, it is unaffected by the transformation in Eq. (G3). Therefore, we have\nd\u03c90 \u00bc d\u03c9: \u00f0G5\u00de\nNext we study the quantity dR\u20d7. An explicit cocycle representative is\ndR\u20d7\u00f0g1;g2\u00de \u00bc r1 \u00fe r2 \u2212 \u00bdr1 \u00fe U\u00f02\u03c0h1=M\u00der2 \u00bc \u00bd1 \u2212 U\u00f02\u03c0h1=M\u00de r2: \u00f0G6\u00de\nThis implies that\ndR\u20d70\u00f0g1;g2\u00de \u2254 dR\u20d7\u00f0g01;g02\u00de \u00bc \u00bd1 \u2212U\u00f02\u03c0h1=M\u00de fr2 \u00fe \u00bd1 \u2212 U\u00f02\u03c0h2=M\u00de v\u20d7g \u00f0G7\u00de\n\u00bc dR\u20d7\u00fe \u00bd1 \u2212U\u00f02\u03c0h1=M\u00de \u00bd1 \u2212 U\u00f02\u03c0h2=M\u00de v\u20d7: \u00f0G8\u00de\nThe second term only depends on h1, h2, just like d\u03c9. In fact, it is coboundary equivalent to a multiple of d\u03c9. This can be seen by computing a cohomology invariant we denote I\u03a9, which for a general cocycle f2 \u2208 Z2\u00f0Gspace;Z\u00de is defined as\nI\u03a9\u00bdf2 \u2254 XM\u22121 j\u00bc0 f2\u00f0hj;h\u00de mod M; \u00f0G9\u00de\nwhere we recall h \u00bc \u00f00; 1\u00de. We can show that I\u03a9\u00f0d\u03c9\u00de \u00bc 1 using Eq. (G4), and also that I\u03a9\u00f0dR\u20d7\u00de \u00bc I\u03a9\u00f0AXY\u00de \u00bc 0. Thus, I\u03a9 is an invariant corresponding to the ZM subgroup of H2\u00f0Gspace;Z\u00de. Up to coboundaries, we have by assumption,\ndR\u20d70 \u00bc dR\u20d7\u00fe \u03c4\u20d7Md\u03c9; \u00f0G10\u00de\ntherefore, for any integer vector u\u20d7,\nI\u03a9\u00f0u\u20d7 \u00b7 dR\u20d70\u00de \u00bc I\u03a9\u00f0u\u20d7 \u00b7 dR\u20d7\u00de \u00fe I\u03a9\u00f0u\u20d7 \u00b7 \u03c4\u20d7Md\u03c9\u00de \u00bc I\u03a9\u00f0u\u20d7 \u00b7 dR\u20d7\u00de \u00fe u\u20d7 \u00b7 \u03c4\u20d7M mod M: \u00f0G11\u00de\n031005-37\nBut we can compute\nI\u03a9\u00f0u\u20d7 \u00b7 dR\u20d70\u00de\n\u00bc I\u03a9\u00f0u\u20d7 \u00b7 dR\u20d7\u00de \u00fe u\u20d7 \u00b7 XM\u22121 j\u00bc0 \u00bd1\u2212U\u00f02\u03c0j=M\u00de \u00bd1\u2212U\u00f02\u03c0=M\u00de v\u20d7\n\u00bc I\u03a9\u00f0dR\u20d7\u00de \u00fe u\u20d7 \u00b7M\u00bd1\u2212U\u00f02\u03c0=M\u00de v\u20d7 mod M: \u00f0G12\u00de\nBy comparing Eqs. (G11) and (G12), and using the fact that u\u20d7 can be arbitrary, we see that\n\u03c4\u20d7M \u00bc M\u00bd1 \u2212 U\u00f02\u03c0=M\u00de v\u20d7: \u00f0G13\u00de\nThe components of \u03c4\u20d7M are ambiguous up to multiples of M, since I\u03a9 is a ZM invariant. This only means that So0 is determined up to multiples of M, as we already know. Finally, we study the transformation of the area element AXY . We know that AXY should be quadratic in the translation gauge fields if it corresponds to an area element. Consider the ansatz,\nAXY\u00f0g1;g2\u00de \u00bc rT1QMU\u00f02\u03c0h1=M\u00der2; \u00f0G14\u00de\nwhere QM is a 2 \u00d7 2 matrix. The 2-cocycle condition for AXY is\nAXY\u00f0g1;g2\u00de \u00fe AXY\u00f0g1g2;g3\u00de \u00bc AXY\u00f0g2;g3\u00de \u00fe AXY\u00f0g1;g2g3\u00de: \u00f0G15\u00de\nUpon substituting in the ansatz for AXY, we find that\nrT1 \u00bdU\u00f02\u03c0=M\u00deTQMU\u00f02\u03c0=M\u00de \u2212QM r2 \u00bc 0: \u00f0G16\u00de\nThis implies that\nU\u00f02\u03c0=M\u00deTQMU\u00f02\u03c0=M\u00de \u00bc QM: \u00f0G17\u00de\nThus the particular form we chose for AXY ensures that QM is a constant matrix with no dependence on group variables. We also demand that\nAXY\u00f0x; y\u00de \u2212 AXY\u00f0y;x\u00de \u00bc 1;\nwhich is a normalization condition. Solving these two conditions, we get the following possibilities for QM:\nQ2 \u00bc Qxx 1\n0 Qyy\n; Qxx; Qyy \u2208 Z; \u00f0G18\u00de\nQ4 \u00bc 1\n2\n2Q0 1\n\u22121 2Q0\n; Q0 \u2208 Z; \u00f0G19\u00de\nQ3;6 \u00bc \u22121 1\n0 \u22121\n: \u00f0G20\u00de\nNote that for M \u00bc 2, 4, QM is not uniquely fixed by Eq. (G17). This is important in what follows. Upon shifting the origin, we obtain\nA0XY \u00bc fr1 \u2212 \u00bdU\u00f0h1\u00de\u2212 1 v\u20d7gTQMU\u00f0h1\u00defr1 \u2212 \u00bdU\u00f0h2\u00de\u2212 1 v\u20d7g: \u00f0G21\u00de\nWe now write\nA0XY \u00bc AXY \u00fe \u03c1Md\u03c9\u00fe \u03bc\u20d7M \u00b7 dR\u20d7;\nfor some \u03c1M; \u03bc\u20d7M, up to coboundaries. Evaluating the invariant I\u03a9, we find that\nI\u03a9\u00f0A0XY\u00de \u00bc \u03c1M \u00bc \u2212Mf\u00bdU\u00f02\u03c0=M\u00de \u2212 1 v\u20d7gTQMU\u00f02\u03c0=M\u00dev\u20d7: \u00f0G22\u00de\nAfter expanding out this expression for each M using Table II, we find that\n\u03c12 \u00bc 4\u00f0vxvy \u00fe v2xQxx \u00fe v2yQyy\u00de mod 2; \u00f0G23\u00de\n\u03c13 \u00bc \u22123\u00f0v2x \u00fe v2y \u00fe vxvy\u00de mod 3; \u00f0G24\u00de\n\u03c14 \u00bc \u22122\u00f0v2x \u00fe v2y\u00de\u00f01\u00fe 2Q0\u00de mod 4; \u00f0G25\u00de\n\u03c16 \u00bc 0 mod 6: \u00f0G26\u00de\nNote that the transformation rule depends on the choice of Qxx;Qyy for M \u00bc 2 and on Q0 for M \u00bc 4. We find that numerical results are matched only if we set Qxx\u00bcQyy\u00bc1 and Q0 \u00bc 0. Upon doing so, we obtain\n\u03c12 \u00bc 4\u00f0vxvy \u00fe v2x \u00fe v2y\u00de mod 2; \u03c13 \u00bc \u22123\u00f0v2x \u00fe v2y \u00fe vxvy\u00de mod 3; \u03c14 \u00bc \u22122\u00f0v2x \u00fe v2y\u00de mod 4; \u03c16 \u00bc 0 mod 6: \u00f0G27\u00de\nKnowing \u03c4\u20d7M; \u03c1M allows us to conclude that\nSo0 \u00bc So \u00feMP\u20d7o \u00b7 \u00bd1 \u2212 U\u00f02\u03c0=M\u00de v\u20d7\u00fe \u03c1M; \u00f0G28\u00de\nwhich gives the complete expression for the transformation of So. Thus the field theory does not uniquely fix the\n031005-38\ntransformation rules forM \u00bc 2, 4; we needed to make some additional choices guided by numerics."
        },
        {
            "heading": "3. Change in P\u20d7o",
            "text": "Finally, we find \u03bc\u20d7M, which fixes the transformation of P\u20d7o. The calculation is given below. We discuss the different values of M separately. We assume\nA0XY \u00bc AXY \u00fe \u03c1Md\u03c9\u00fe \u03bc\u20d7M \u00b7 dR\u20d7: \u00f0G29\u00de\nM \u00bc 2: The invariants which characterize the cohomology class of \u03bc\u20d72 \u00b7 dR\u20d7 are IX, IY , which are defined as\nIX\u00bdf2 \u2254 f2\u00f0xh;xh\u00de \u00fe f2\u00f0h;h\u00de mod 2; \u00f0G30\u00de\nIY \u00bdf2 \u2254 f2\u00f0yh; yh\u00de \u00fe f2\u00f0h;h\u00de mod 2: \u00f0G31\u00de\nHere x \u00bc \u00bd\u00f01; 0\u00de; 0 , y \u00bc \u00bd\u00f00; 1\u00de; 0 , h \u00bc \u00bd\u00f00; 0\u00de; 1 . We can check that IX\u00f0d\u03c9\u00de \u00bc IY\u00f0d\u03c9\u00de \u00bc 0 mod 2. We can also show that\nIX\u00bd\u03bc\u20d72 \u00b7 dR\u20d7 \u00bc 2\u03bc2;x mod 2; \u00f0G32\u00de\nIY \u00bd\u03bc\u20d72 \u00b7 dR\u20d7 \u00bc 2\u03bc2;y mod 2: \u00f0G33\u00de\nTherefore,\nIX\u00f0Y\u00de\u00f0A0XY \u2212 AXY\u00de \u00bc 2\u03bc2;x\u00f0y\u00de: \u00f0G34\u00de\nBut when M \u00bc 2, \u00bd1 \u2212U\u00f0h1\u00de v\u20d7 \u00bc 2h1v\u20d7 for any v\u20d7 (where h1 is just an integer mod 2). Using this in Eq. (G21), we obtain\nA0XY\u00f0g1;g2\u00de \u00bc \u00f0r1 \u00fe 2v\u20d7\u00deTQ2\u00f0r2 \u00fe 2h2v\u20d7\u00de:\nThen, by direct calculation we get\nIX\u00bdA0XY \u2212 AXY \u00bc \u00f01\u00fe 2vx; 2vy\u00deQ2\u00f01\u00fe 2vx; 2vy\u00deT \u2212 \u00f02vx; 2vy\u00deQ2\u00f02vx; 2vy\u00deT \u2212Qxx\n\u00f0G35\u00de\n\u00bc 2vy mod 2; \u00f0G36\u00de\nIY \u00bdA0XY \u2212 AXY \u00bc \u00f02vx; 1\u00fe 2vy\u00deQ2\u00f02vx; 1\u00fe 2vy\u00deT \u2212 \u00f02vx; 2vy\u00deQ2\u00f02vx; 2vy\u00deT \u2212Qyy\n\u00f0G37\u00de\n\u00bc 2vx mod 2: \u00f0G38\u00de\nThis means that 2\u03bc\u20d72 \u00bc 2\u00f0vy; vx\u00de mod Z2. Putting this back into the transformation rule for P\u20d7o, we get the following result (mod 1):\n2Po0;x\u22542Po;x\u00fe\u03baIX\u00bdA0XY \u2212AXY \u00bc2Po;x\u00fe2\u03bavy; \u00f0G39\u00de\n2Po0;y\u22542Po;y\u00fe\u03baIY \u00bdA0XY\u2212AXY \u00bc2Po;y\u00fe2\u03bavx: \u00f0G40\u00de\nNote that this result is independent of the choice for Qxx;Qyy made above, as these quantities cancel out of the final expression. M \u00bc 4: We can directly see the result by setting P\u20d7o \u00bc \u00f0Po=2\u00de\u00f01; 1\u00de and vx \u00bc vy \u00bc \u00f0v0=2\u00de mod 1 in the above calculation for M \u00bc 2. The result is\nPo0 \u00bc Po \u00fe \u03bav0 mod 2: \u00f0G41\u00de The results for M \u00bc 2, 4 are in fact all equivalent to Eq. (106). M \u00bc 3: We wish to prove Eq. (106). If we parametrize v\u20d7 \u00bc v0 3 \u00f01; 1\u00de and P\u20d7o \u00bc \u00f0Po=3\u00de\u00f01; 2\u00de, this requires us to show that\nPo0 \u00bc Po \u00fe 2\u03bav0 mod 3: \u00f0G42\u00de\nThe invariant giving the cohomology class of \u03bc\u20d73 \u00b7 dR\u20d7 is IX, defined as\nIX\u00bdf2 \u2254 f2\u00f0xh;xh\u00de \u00fe f2\u00bd\u00f0xh\u00de2;xh \u2212 f2\u00f0h;h\u00de \u2212 f2\u00f0h2;h\u00de mod 3: \u00f0G43\u00de\nBy direct calculation, we can show that\nIX\u00bd\u03bc\u20d73 \u00b7 dR\u20d7 \u00bc 3\u03bc3;x \u00bc Po mod 3: \u00f0G44\u00de\nAgain we use A0XY\u00f0g1;g2\u00de\u00bcfr1\u2212 \u00bd1\u2212U\u00f0h1\u00dev\u20d7 gT \u00d7 Q3U\u00f0h1\u00defr2\u2212 \u00bd1\u2212U\u00f0h2\u00dev\u20d7 g. We use the same procedure discussed for M \u00bc 2. After some (tedious) algebra, we indeed obtain Eq. (G42), or equivalently Eq. (106)."
        },
        {
            "heading": "4. Example: Verifying the transformation rules for So",
            "text": "In this section, we use the honeycomb lattice as an example to verify that the field theory formulas obtained above agree with numerical results. Consider the honeycomb lattice with a disclination whose disclination angle is \u03a9 \u00bc \u00f0\u03c0=3\u00de, as shown in Fig. 5(a). We define the unit cell \u0398 so that the plaquette center is the center of the unit cell (i.e., the point \u03b1). Let us consider three choices of o, shown in Figs. 5(d), which lead to different values of b\u20d7o and nirreg, as summarized in Table IV. (1) Setting o \u00bc \u03b1, we get a pure disclination with b\u20d7o\u2208 \u00bd\u00f00;0\u00de and nirreg;o;\u03a9\u00bc 23 [Fig. 5(b)]. (2) Setting o \u00bc \u03b21,\n031005-39\nwe get an impure disclination with b\u20d7o \u2208 \u00bd\u00f00;\u22121\u00de and nirreg;o;b\u20d7 \u00bc 13 [Fig. 5(c)]. (3) Setting o \u00bc \u03b22, we obtain a different impure disclination with b\u20d7o \u2208 \u00bd\u00f0\u22121; 0\u00de and nirreg;o;b\u20d7 \u00bc 13 [Fig. 5(d)]. Without loss of generality we can assume the flux through the quadrilateral plaquette to be 2 3 \u03d5. Since W is defined to align with the boundary of the unit cell,W is the same for all three choices above. This means thatQW is also the same, but is described by three different equations:\nQW \u00bc S\u03b1 3 \u00fe \u00f0k\u00fe 2=3\u00de\u03bd; QW \u00bc S\u03b21 3 \u00fe \u00f0k\u00fe 1=3\u00de\u03bd\u00fe P\u20d7\u03b21 \u00b7 \u00f00;\u22121\u00de \u00fe C\u03d5 6\u03c0 ; QW \u00bc S\u03b22 3 \u00fe \u00f0k\u00fe 1=3\u00de\u03bd\u00fe P\u20d7\u03b22 \u00b7 \u00f0\u22121; 0\u00de \u00fe C\u03d5 6\u03c0 ; \u00f0G45\u00de\nwhere k is the integer part of nW . We then equate the three expressions and cancel out the \u03d5 dependence to derive a relation betweenS\u03b1 and S\u03b2. Equating the first two gives us"
        },
        {
            "heading": "S\u03b1 \u00fe 2\u03ba \u00bc S\u03b21 \u00fe \u03ba \u00feP\u03b2\u00f01=3;1=3\u00de\u00f01; 2\u00de \u00b7 \u00f00;\u22121\u00de mod 3;",
            "text": "S\u03b1 \u00bc S\u03b21 \u00feP\u03b2\u00f01=3;1=3\u00de \u2212 \u03ba mod 3; \u00f0G46\u00de\nwhere we use \u03ba \u2261 \u03bd \u2212 \u00f0C\u03d5=2\u03c0\u00de. On the other hand, setting o \u00bc \u03b21, o\u00fe \u00f0\u2212 13 ;\u2212 13\u00de \u00bc \u03b1, the field theory [Eq. (G28)] predicts\nS\u03b1 \u00bc S\u03b21 \u00fe 3P\u20d7\u03b2\u00f01=3;1=3\u00de \u00b7 \u00f01; 0\u00de \u2212 \u03ba mod 3; S\u03b1 \u00bc S\u03b21 \u00feP\u03b2\u00f01=3;1=3\u00de \u2212 \u03ba mod 3; \u00f0G47\u00de\nwhich is exactly the same equation. Equation (G46) can also be confirmed numerically (the numerical raw data are given in Fig. 10). This verifies the field theory prediction Eq. (G28). We remark that we can use the same honeycomb lattice Hamiltonian Hclean to construct defects with different disclination angles. We can then apply similar procedures to verify the M \u00bc 2, 3, 6 transformation rules for So\u00fev\u20d7 and P\u20d7o\u00fev\u20d7."
        },
        {
            "heading": "APPENDIX H: GENERALIZATION TO MODELS WITH NEXT-NEAREST-NEIGHBOR HOPPING",
            "text": "In the main text, we argue that our method of extracting So and P\u20d7o works for an arbitrarily complicated unit cell\nwith further neighbor hopping and interaction terms, as long as it isCM symmetric. In order to apply our dislocation or disclination charge calculation to measure So; P\u20d7o in these generalized Hamiltonians, we need to construct a defect Hamiltonian Hdefect, measure the charge QW in a region W, and then specify the quantities nirreg;o; \u03b4\u03a6W;o. We argue that our numerical procedure allows us to specify these quantities as long as Hclean is local and has a gapped, symmetry-preserving ground state, irrespective of its other properties. We now provide numerical evidence that our procedure\ngives the expected quantized P\u20d7o when we add nextneighbor hopping (numerically it is much harder to verify this for interaction terms, and we do not pursue this here). Consider a Hofstadter model with the unit cell shown in Fig. 20. The Hamiltonian with this unit cell has nextneighbor hopping. We set the nearest-neighbor hopping amplitude equal to t \u00bc 1, and tune the next-neighbor (diagonal) hopping amplitude t0 between 0 and 1. There is a flux \u03d5 through each unit cell. Since we require the unit cell to be C4 symmetric, we also require that there is a flux \u03d5=2 through each triangle in the unit cell, as shown in Fig. 20. We extract the Z2 invariantP\u03b1 from a dislocation charge computation. The respective butterflies as a function of t0 are shown in Fig. 21. We see that the invariant is indeed quantized and well defined mod 2 throughout the main Hofstadter lobes. In the t0 \u00bc 0 limit, the butterfly reduces to the one for P\u03b1 in Fig. 1.\n031005-40\n[1] M. Z. Hasan and C. L. Kane, Colloquium: Topological Insulators, Rev. Mod. Phys. 82, 3045 (2010). [2] X.-L. Qi and S.-C. Zhang, Topological Insulators and Superconductors, Rev. Mod. Phys. 83, 1057 (2011). [3] B. A. Bernevig, Topological Insulators and Topological Superconductors, in Topological Insulators and Topological Superconductors(Princeton University Press, Princeton, NJ, 2013). [4] A. Kitaev, Periodic Table for Topological Insulators and Superconductors, AIP Conf. Proc. 1134, 22 (2009). [5] S. Ryu, A. P. Schnyder, A. Furusaki, and A.W.W. Ludwig, Topological Insulators and Superconductors: Tenfold Way and Dimensional Hierarchy, New J. Phys. 12, 065010 (2010). [6] C.-K. Chiu, J. C. Y. Teo, A. P. Schnyder, and S. Ryu, Classification of Topological Quantum Matter with Symmetries, Rev. Mod. Phys. 88, 035005 (2016). [7] X. Chen, Z.-C. Gu, Z.-X. Liu, and X.-G. Wen, Symmetry Protected Topological Orders and the Group Cohomology of Their Symmetry Group, Phys. Rev. B 87, 155114 (2013). [8] A. Kapustin, Symmetry Protected Topological Phases, Anomalies, and Cobordisms: Beyond Group Cohomology, arXiv:1403.1467. [9] Z.-C. Gu and X.-G. Wen, Symmetry-Protected Topological Orders for Interacting Fermions: Fermionic Topological Nonlinear \u03c3 Models and a Special Group Supercohomology Theory, Phys. Rev. B 90, 115141 (2014).\n[10] A. Kapustin, R. Thorngren, A. Turzillo, and Z. Wang, Fermionic Symmetry Protected Topological Phases and Cobordisms, J. High Energy Phys. 12 (2015) 052. [11] T. Senthil, Symmetry-Protected Topological Phases of Quantum Matter, Annu. Rev. Condens. Matter Phys. 6, 299 (2015). [12] Q.-R. Wang and Z.-C. Gu, Construction and Classification of Symmetry-Protected Topological Phases in Interacting Fermion Systems, Phys. Rev. X 10, 031055 (2020). [13] M. Barkeshli, P. Bonderson, M. Cheng, and Z. Wang, Symmetry Fractionalization, Defects, and Gauging of Topological Phases, Phys. Rev. B 100, 115147 (2019). [14] M. Barkeshli, Y.-A. Chen, P.-S. Hsin, and N. Manjunath, Classification of \u00f02\u00fe 1\u00deD Invertible Fermionic Topological Phases with Symmetry, Phys. Rev. B 105, 235143 (2022). [15] D. Bulmash and M. Barkeshli, Fermionic Symmetry Fractionalization in (2\u00fe 1) Dimensions, Phys. Rev. B 105, 125114 (2022). [16] D. Aasen, P. Bonderson, and C. Knapp, Characterization and Classification of Fermionic Symmetry Enriched Topological Phases, arXiv:2109.10911. [17] N. Manjunath and M. Barkeshli, Crystalline Gauge Fields and Quantized Discrete Geometric Response for Abelian Topological Phases with Lattice Symmetry, Phys. Rev. Res. 3, 013040 (2021). [18] N. Manjunath and M. Barkeshli, Classification of Fractional Quantum Hall States with Spatial Symmetries, arXiv: 2012.11603.\n031005-41\n[19] C. Fang, M. J. Gilbert, and B. A. Bernevig, Bulk Topological Invariants in Noninteracting Point Group Symmetric Insulators, Phys. Rev. B 86, 115112 (2012). [20] X.-Y. Song, Y.-C. He, A. Vishwanath, and C. Wang, Electric Polarization as a Nonquantized Topological Response and Boundary Luttinger Theorem, Phys. Rev. Res. 3, 023011 (2021). [21] R. Resta and D. Vanderbilt, Theory of Polarization: A Modern Approach, in Physics of Ferroelectrics (Springer, New York, 2007), pp. 31\u201368. [22] R. Resta, Macroscopic Polarization in Crystalline Dielectrics: The Geometric Phase Approach, Rev. Mod. Phys. 66, 899 (1994). [23] H. Watanabe and M. Oshikawa, Inequivalent Berry Phases for the Bulk Polarization, Phys. Rev. X 8, 021065 (2018). [24] S. Coh and D. Vanderbilt, Electric Polarization in a Chern Insulator, Phys. Rev. Lett. 102, 107603 (2009). [25] R. Resta, Quantum-Mechanical Position Operator in Extended Systems, Phys. Rev. Lett. 80, 1800 (1998). [26] X. G. Wen and A. Zee, Shift and Spin Vector: New Topological Quantum Numbers for the Hall Fluids, Phys. Rev. Lett. 69, 953 (1992). [27] F. D.M. Haldane, Geometrical Description of the Fractional Quantum Hall Effect, Phys. Rev. Lett. 107, 116801 (2011). [28] A. G. Abanov and A. Gromov, Electromagnetic and Gravitational Responses of Two-Dimensional Noninteracting Electrons in a Background Magnetic Field, Phys. Rev. B 90, 014435 (2014). [29] B. Bradlyn and N. Read, Low-Energy Effective Theory in the Bulk for Transport in a Topological Phase, Phys. Rev. B 91, 125303 (2015). [30] A. Gromov, G. Y. Cho, Y. You, A. G. Abanov, and E. Fradkin, Framing Anomaly in the Effective Theory of the Fractional Quantum Hall Effect, Phys. Rev. Lett. 114, 016805 (2015). [31] R. R. Biswas and D. T. Son, Fractional Charge and InterLandau\u2013Level States at Points of Singular Curvature, Proc. Natl. Acad. Sci. U.S.A. 113, 8636 (2016). [32] D. R. Hofstadter, Energy Levels and Wave Functions of Bloch Electrons in Rational and Irrational Magnetic Fields, Phys. Rev. B 14, 2239 (1976). [33] Y. Zhang, N. Manjunath, G. Nambiar, and M. Barkeshli, Fractional Disclination Charge and Discrete Shift in the Hofstadter Butterfly, Phys. Rev. Lett. 129, 275301 (2022). [34] D. Osadchy and J. E. Avron, Hofstadter Butterfly as Quantum Phase Diagram, J. Math. Phys. 42, 5665 (2001). [35] D. J. Thouless, M. Kohmoto, M. P. Nightingale, and M. den Nijs, Quantized Hall Conductance in a Two-Dimensional Periodic Potential, Phys. Rev. Lett. 49, 405 (1982). [36] S. Liu, A. Vishwanath, and E. Khalaf, Shift Insulators: Rotation-Protected Two-Dimensional Topological Crystalline Insulators, Phys. Rev. X 9, 031003 (2019). [37] T. Li, P. Zhu, W. A. Benalcazar, and T. L. Hughes, Fractional Disclination Charge in Two-Dimensional Cn-Symmetric Topological Crystalline Insulators, Phys. Rev. B 101, 115115 (2020).\n[38] B. Han, H. Wang, and P. Ye, Generalized Wen-Zee Terms, Phys. Rev. B 99, 205120 (2019). [39] P. Jadaun, D. Xiao, Q. Niu, and S. K. Banerjee, Topological Classification of Crystalline Insulators with Space Group Symmetry, Phys. Rev. B 88, 085110 (2013). [40] X.-Y. Song, C. Wang, A. Vishwanath, and Y.-C. He, Unifying Description of Competing Orders in TwoDimensional Quantum Magnets, Nat. Commun. 10, 4254 (2019). [41] G. van Miert and C. Ortix, Dislocation Charges Reveal Two-Dimensional Topological Crystalline Invariants, Phys. Rev. B 97, 201111(R) (2018). [42] More specifically, G is the fermionic symmetry group, which acts nontrivially on fermionic operators. It is sometimes written as U\u00f01\u00def \u00d7\u03d5 \u00bdZ2 \u22ca ZM . The symbol U\u00f01\u00def means that the order 2 element of this group is identified with the fermion parity operation. [43] For the caseM \u00bc 1, there are no quantized discrete shift and polarization invariants [17]. [44] This is referred to as nu:c:;W in Ref. [33]. [45] For example, when Ly is even, these are given by\nm \u00bc \u00f0Ly=2\u00de \u00fe kLy, where k \u2208 Z. This verifies our earlier comment that T\u0303y is a worse approximate symmetry when jmj mod Ly is large. [46] A quick argument is that in this limit j\u03a8\u00f0m\u00dei is an almost exact eigenstate of n\u0302j with eigenvalue \u03ba, for each j. Thus\nT\u0303y \u00bc T\u0302yei\u03ba P j \u03bbj . Therefore any change in \u03bbj (e.g., by redefining \u03b4) is equivalent to shifting \u03bbj \u2192 \u03bbj \u00fe \u03c7 for each j with some suitable \u03c7. [47] These fluxes correspond to a set of 2-cocycle representatives which generate the groupH2\u00f0Gspace;Z\u00de whenGspace \u00bc Z2 \u22ca ZM [17]. We have H2\u00f0Gspace;Z\u00de \u2245 ZM \u00d7 Z \u00d7 KM. The 2-cocycles corresponding to d\u03c9;AXY; \u00bd1\u2212U\u00f02\u03c0=M\u00de \u22121dR\u20d7 generate these three factors, respectively. [48] X.-Y. Song, Y.-C. He, A. Vishwanath, and C. Wang, Electric Polarization as a Nonquantized Topological Response and Boundary Luttinger Theorem, Phys. Rev. Res. 3, 023011 (2021). [49] W. A. Benalcazar, T. Li, and T. L. Hughes, Quantization of Fractional Corner Charge in Cn-Symmetric Higher-Order Topological Crystalline Insulators, Phys. Rev. B 99, 245151 (2019). [50] J. Cano and B. Bradlyn, Band Representations and Topological Quantum Chemistry, Annu. Rev. Condens. Matter Phys. 12, 225 (2021). [51] Y.-M. Lu, Y. Ran, and M. Oshikawa, Filling Enforced Constraint on the Quantized Hall Conductivity on a Periodic Lattice, arXiv:1705.09298. [52] In Ref. [33] we set \u03d5 \u00bc 0 and write B\u00f02\u00de2 \u2254 12 \u00f0dAb \u00fe kd\u03c9\u00de. Ab is a gauge field for the \u201cbosonic\u201d U\u00f01\u00def=Zf2 symmetry. But here A always refers to the original U(1) gauge field, which equals Ab=2. Thus, dAb \u00bc 2dA. To account for \u03d5 \u2260 0, it is sufficient to replace 2dA with 2F.\n031005-42"
        }
    ],
    "title": "Quantized Charge Polarization as a Many-Body Invariant in \u00f02 + 1\u00deD Crystalline Topological States and Hofstadter Butterflies",
    "year": 2023
}