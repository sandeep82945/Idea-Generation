{
    "abstractText": "We use nonlinear robust guidance and control to assess the possibility of an autonomous spacecraft fast approaching and orbiting an asteroid without knowledge of its properties. The spacecraft uses onboard batch-sequential filtering to navigate while making a rapid approach with the aim of orbital insertion. We show through conservative assumptions that the proposed autonomous GN&C architecture is viable within current technology. Greater importance is in showing that an autonomous spacecraft can have a much bolder operational profile around an asteroid, with no need to inherit the conservative and cautious approach of current missions, which rely on ground intervention for firstly constraining uncertainties to a very low level before close-proximity. The results suggest that such paradigm shift can significantly impact costs, and exploration time, which can be very useful for exploring highly populated regions.",
    "authors": [
        {
            "affiliations": [],
            "name": "Rodolfo Batista Negri"
        },
        {
            "affiliations": [],
            "name": "Ant\u00f4nio F. B. de A. Prado"
        },
        {
            "affiliations": [],
            "name": "Ronan A. J. Chagas"
        },
        {
            "affiliations": [],
            "name": "Rodolpho V. de Moraes"
        }
    ],
    "id": "SP:17ce4fdadd2f19e037c0cd915f7fe6599fd9cb0e",
    "references": [
        {
            "authors": [
                "MM Al Asad",
                "LC Philpott",
                "CL Johnson",
                "OS Barnouin",
                "E Palmer",
                "JR Weirich",
                "MG Daly",
                "ME Perry",
                "R Gaskell",
                "EB Bierhaus"
            ],
            "title": "Validation of stereophotoclinometric shape models of asteroid (101955) bennu during the osiris-rex mission",
            "venue": "The Planetary Science Journal,",
            "year": 2021
        },
        {
            "authors": [
                "Eleonora Andreis",
                "Vittorio Franzese",
                "Francesco Topputo"
            ],
            "title": "Onboard orbit determination for deep-space cubesats",
            "venue": "Journal of guidance, control, and dynamics,",
            "year": 2022
        },
        {
            "authors": [
                "PG Antreasian",
                "M Moreau",
                "C Jackman",
                "K Williams",
                "B Page",
                "JM Leonard"
            ],
            "title": "Osiris-rex orbit determination covariance studies at bennu",
            "venue": "In AAS Guidance and Control Conference,",
            "year": 2016
        },
        {
            "authors": [
                "BA Archinal",
                "CH Acton",
                "MF A\u2019hearn",
                "A Conrad",
                "GJ Consolmagno",
                "T Duxbury",
                "D Hestroffer",
                "JL Hilton",
                "Randolph L Kirk",
                "SA Klioner"
            ],
            "title": "Report of the iau working group on cartographic coordinates and rotational elements",
            "venue": "Celestial Mechanics and Dynamical Astronomy,",
            "year": 2015
        },
        {
            "authors": [
                "DA Baker",
                "JW McMahon"
            ],
            "title": "Limb-based shape modeling and localization for autonomous navigation around small bodies",
            "venue": "Astrodynamic Specialist Conference, Lake Tahoe, AAS/AIAA,",
            "year": 2020
        },
        {
            "authors": [
                "Benjamin Bercovici",
                "Jay W McMahon"
            ],
            "title": "Robust autonomous small-body shape reconstruction and relative navigation using range images",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2019
        },
        {
            "authors": [
                "Shyam Bhaskaran"
            ],
            "title": "Autonomous navigation for deep space missions",
            "venue": "SpaceOps",
            "year": 2012
        },
        {
            "authors": [
                "Shyam Bhaskaran"
            ],
            "title": "Autonomous optical-only navigation for deep space missions",
            "venue": "ASCEND",
            "year": 2020
        },
        {
            "authors": [
                "Shyam Bhaskaran",
                "S Desai",
                "P Dumont",
                "B Kennedy",
                "G Null",
                "W Owen Jr.",
                "J Riedel",
                "S Synnott",
                "R Werner"
            ],
            "title": "Orbit determination performance evaluation of the deep space 1 autonomous navigation system",
            "year": 1998
        },
        {
            "authors": [
                "EB Bierhaus",
                "BC Clark",
                "JW Harris",
                "KS Payne",
                "RD Dubisher",
                "DW Wurts",
                "RA Hund",
                "RM Kuhns",
                "TM Linn",
                "JL Wood"
            ],
            "title": "The osiris-rex spacecraft and the touch-and-go sample acquisition mechanism (tagsam)",
            "venue": "Space Science Reviews,",
            "year": 2018
        },
        {
            "authors": [
                "Stephen B Broschart",
                "Nicholas Bradley",
                "Shyam Bhaskaran"
            ],
            "title": "Kinematic approximation of position accuracy achieved using optical observations of distant asteroids",
            "venue": "Journal of Spacecraft and Rockets,",
            "year": 2019
        },
        {
            "authors": [
                "Andrew F Cheng",
                "Andrew S Rivkin",
                "Patrick Michel",
                "Justin Atchison",
                "Olivier Barnouin",
                "Lance Benner",
                "Nancy L Chabot",
                "Carolyn Ernst",
                "Eugene G Fahnestock",
                "Michael Kueppers"
            ],
            "title": "Aida dart asteroid deflection test: Planetary defense and science objectives",
            "venue": "Planetary and Space Science,",
            "year": 2018
        },
        {
            "authors": [
                "Gianfranco Di Domenico",
                "Eleonora Andreis",
                "Andrea Carlo Morelli",
                "Gianmario Merisio",
                "Vittorio Franzese",
                "Carmine Giordano",
                "Alessandro Morselli",
                "Paolo Panicucci",
                "Fabio Ferrari",
                "Francesco Topputo"
            ],
            "title": "Toward self-driving interplanetary cubesats: the erc-funded project extrema",
            "venue": "In 72nd International Astronautical Congress (IAC 2021),",
            "year": 2021
        },
        {
            "authors": [
                "Ann B Dietrich",
                "Jay W McMahon"
            ],
            "title": "Robust orbit determination with flash lidar around small bodies",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2018
        },
        {
            "authors": [
                "Juliana D Feldhacker",
                "Megan Bruck Syal",
                "Brandon A Jones",
                "Alireza Doostan",
                "Jay McMahon",
                "Daniel J Scheeres"
            ],
            "title": "Shape dependence of the kinetic deflection of asteroids",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2017
        },
        {
            "authors": [
                "Roberto Furfaro"
            ],
            "title": "Hovering in asteroid dynamical environments using higher-order sliding control",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2015
        },
        {
            "authors": [
                "Roberto Furfaro",
                "Dario Cersosimo",
                "Daniel R Wibben"
            ],
            "title": "Asteroid precision landing via multiple sliding surfaces guidance techniques",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2013
        },
        {
            "authors": [
                "Haichao Gui",
                "Anton HJ de Ruiter"
            ],
            "title": "Control of asteroid-hovering spacecraft with disturbance rejection using position-only measurements",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2017
        },
        {
            "authors": [
                "Matt Hawkins",
                "Yanning Guo",
                "Bong Wie"
            ],
            "title": "Spacecraft guidance algorithms for asteroid intercept and rendezvous missions",
            "venue": "International Journal of Aeronautical and Space Sciences,",
            "year": 2012
        },
        {
            "authors": [
                "Dario Izzo"
            ],
            "title": "Revisiting lambert\u2019s problem",
            "venue": "Celestial Mechanics and Dynamical Astronomy,",
            "year": 2015
        },
        {
            "authors": [
                "Shota Kikuchi",
                "Yusuke Oki",
                "Yuichi Tsuda"
            ],
            "title": "Frozen orbits under radiation pressure and zonal gravity perturbations",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2021
        },
        {
            "authors": [
                "Jason M Leonard",
                "Jeroen L Geeraert",
                "Brian R Page",
                "Andrew S French",
                "Peter G Antreasian",
                "Coralie D Adam",
                "Daniel R Wibben",
                "Michael C Moreau",
                "Dante S Lauretta"
            ],
            "title": "Osiris-rex orbit determination performance during the navigation campaign",
            "venue": "AAS/AIAA Astrodynamics Specialist Conference,",
            "year": 2019
        },
        {
            "authors": [
                "J Andrew"
            ],
            "title": "Liounis. Limb based optical navigation for irregular bodies. In 1st Annual RPI Workshop on Image-Based Modeling and Navigation for Space",
            "year": 2018
        },
        {
            "authors": [
                "Takahide Mizuno",
                "T Kase",
                "T Shiina",
                "Makoto Mita",
                "Noriyuki Namiki",
                "Hiroki Senshu",
                "Ryuhei Yamada",
                "Hirotomo Noda",
                "Hiroo Kunimori",
                "Naru Hirata"
            ],
            "title": "Development of the laser altimeter (lidar) for hayabusa2",
            "venue": "Space Science Reviews,",
            "year": 2017
        },
        {
            "authors": [
                "Oliver Montenbruck",
                "Eberhard Gill",
                "Fh Lutze"
            ],
            "title": "Satellite orbits: models, methods, and applications",
            "venue": "Appl. Mech. Rev.,",
            "year": 2002
        },
        {
            "authors": [
                "Rodolfo Batista Negri",
                "Ant\u00f4nio FBA Prado"
            ],
            "title": "Autonomous and robust orbit-keeping for smallbody missions",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2022
        },
        {
            "authors": [
                "Rodolfo Batista Negri"
            ],
            "title": "Robust 3-d path following control for keplerian orbits",
            "venue": "arXiv preprint arXiv:2012.01954,",
            "year": 2020
        },
        {
            "authors": [
                "Issa Antoine Nesnas",
                "Benjamin J Hockman",
                "Saptarshi Bandyopadhyay",
                "Benjamin J Morrell",
                "Daniel P Lubey",
                "Jacopo Villa",
                "David S Bayard",
                "Alan Osmundson",
                "Benjamin Jarvis",
                "Michele Bersani"
            ],
            "title": "Autonomous exploration of small bodies toward greater autonomy for deep space missions",
            "venue": "Frontiers in Robotics and AI,",
            "year": 2021
        },
        {
            "authors": [
                "Paolo Panicucci"
            ],
            "title": "Autonomous vision-based navigation and shape reconstruction of an unknown asteroid during approach phase",
            "venue": "PhD thesis,",
            "year": 2021
        },
        {
            "authors": [
                "Giuseppe D Racca",
                "Paul W McNamara"
            ],
            "title": "The lisa pathfinder mission",
            "venue": "Space science reviews,",
            "year": 2010
        },
        {
            "authors": [
                "JE Riedel",
                "S Bhaskaran",
                "S Desai",
                "D Hand",
                "B Kennedy",
                "T McElrath",
                "M Ryne"
            ],
            "title": "Autonomous optical navigation(autonav) ds 1 technology validation report. Deep Space 1 technology validation reports(A",
            "venue": "Jet Propulsion Laboratory(JPL Publication",
            "year": 2000
        },
        {
            "authors": [
                "Joseph Riedel",
                "Daniel Eldred",
                "Brian Kennedy",
                "Daniel Kubitscheck",
                "Andrew Vaughan",
                "Robert Werner",
                "Shyam Bhaskaran",
                "Stephen Synnott"
            ],
            "title": "Autonav mark3: Engineering the next generation of autonomous onboard navigation and guidance",
            "venue": "In AIAA Guidance, Navigation, and Control Conference and Exhibit,",
            "year": 2006
        },
        {
            "authors": [
                "Daniel J Scheeres"
            ],
            "title": "Close proximity dynamics and control about asteroids",
            "venue": "In 2014 American Control Conference,",
            "year": 2014
        },
        {
            "authors": [
                "Daniel J Scheeres"
            ],
            "title": "Orbital motion in strongly perturbed environments: applications to asteroid, comet and planetary satellite orbiters",
            "year": 2016
        },
        {
            "authors": [
                "Daniel Jay Scheeres"
            ],
            "title": "Orbit mechanics about asteroids and comets",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2012
        },
        {
            "authors": [
                "DJ Scheeres",
                "JW McMahon"
            ],
            "title": "Autonomous architectures for small body exploration",
            "venue": "AAS/AIAA Astrodynamics Specialist Conference,",
            "year": 2019
        },
        {
            "authors": [
                "Bob Schutz",
                "Byron Tapley",
                "George H Born"
            ],
            "title": "Statistical orbit determination",
            "year": 2004
        },
        {
            "authors": [
                "Jean-Jacques E Slotine",
                "Weiping Li"
            ],
            "title": "Applied nonlinear control, volume 199",
            "venue": "Prentice hall Englewood Cliffs, NJ,",
            "year": 1991
        },
        {
            "authors": [
                "John Steven Snyder",
                "Dan M Goebel",
                "Vernon Chaplin",
                "Alejandro Lopez Ortega",
                "Ioannis G Mikellides",
                "Faraz Aghazadeh",
                "Ian Johnson",
                "Taylor Kerl",
                "Giovanni Lenguito"
            ],
            "title": "Electric propulsion for the psyche mission",
            "year": 2019
        },
        {
            "authors": [
                "Martin Tajmar",
                "A Genovese",
                "W Steiger"
            ],
            "title": "Indium field emission electric propulsion microthruster experimental characterization",
            "venue": "Journal of propulsion and power,",
            "year": 2004
        },
        {
            "authors": [
                "Shota Takahashi",
                "D. Scheeres"
            ],
            "title": "Autonomous proximity operations at small neas",
            "venue": "In Proceedings of the 33rd International Symposium on Space Technology and Science,",
            "year": 2022
        },
        {
            "authors": [
                "Shota Takahashi",
                "Daniel J Scheeres"
            ],
            "title": "Autonomous exploration of a small near-earth asteroid",
            "venue": "Journal of Guidance, Control, and Dynamics,",
            "year": 2021
        },
        {
            "authors": [
                "Yuto Takei",
                "Takanao Saiki",
                "Yukio Yamamoto",
                "Yuya Mimasu",
                "Hiroshi Takeuchi",
                "Hitoshi Ikeda",
                "Naoko Ogawa",
                "Fuyuto Terui",
                "Go Ono",
                "Kent Yoshikawa"
            ],
            "title": "Hayabusa2\u2019s station-keeping operation in the proximity of the asteroid",
            "venue": "ryugu. Astrodynamics,",
            "year": 2020
        },
        {
            "authors": [
                "Yuichi Tsuda",
                "Hiroshi Takeuchi",
                "Naoko Ogawa",
                "Go Ono",
                "Shota Kikuchi",
                "Yusuke Oki",
                "Masateru Ishiguro",
                "Daisuke Kuroda",
                "Seitaro Urakawa",
                "Shin-ichiro Okumura"
            ],
            "title": "Rendezvous to asteroid with highly uncertain ephemeris: Hayabusa2\u2019s ryugu-approach operation",
            "venue": "result. Astrodynamics,",
            "year": 2020
        },
        {
            "authors": [
                "Yuichi Tsuda",
                "Makoto Yoshikawa",
                "Masanao Abe",
                "Hiroyuki Minamino",
                "Satoru Nakazawa"
            ],
            "title": "System design of the hayabusa 2\u2014asteroid sample return mission to 1999 ju3",
            "venue": "Acta Astronautica,",
            "year": 2013
        },
        {
            "authors": [
                "Robert A Werner"
            ],
            "title": "Spherical harmonic coefficients for the potential of a constant-density polyhedron",
            "venue": "Computers & Geosciences,",
            "year": 1997
        },
        {
            "authors": [
                "Robert A Werner",
                "Daniel J Scheeres"
            ],
            "title": "Exterior gravitation of a polyhedron derived and compared with harmonic and mascon gravitation representations of asteroid 4769 castalia",
            "venue": "Celestial Mechanics and Dynamical Astronomy,",
            "year": 1996
        },
        {
            "authors": [
                "B Williams",
                "P Antreasian",
                "E Carranza",
                "C Jackman",
                "J Leonard",
                "D Nelson",
                "B Page",
                "D Stanbridge",
                "D Wibben",
                "K Williams"
            ],
            "title": "Osiris-rex flight dynamics and navigation design",
            "venue": "Space Science Reviews,",
            "year": 2018
        },
        {
            "authors": [
                "Yonglong Zhang",
                "Xiangyuan Zeng",
                "Fengdi Zhang"
            ],
            "title": "Spacecraft hovering flight in a binary asteroid system by using fuzzy logic control",
            "venue": "IEEE Transactions on Aerospace and Electronic Systems,",
            "year": 2019
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "There was a significant advance in the number of space missions proposed and planned to explore asteroids in the last decades. The growing interest is due to many reasons, such as studying the origins of life and water on Earth, understanding asteroids\u2019 properties better, or defending the Earth in the case of the threat of an impact. NASA recently launched the DART spacecraft, the first space experiment on asteroid deflection. The DART will be the first kinect impactor deflection assessment, considered the most technologically ready deflection strategy. That deflection option is highly dependent on the asteroid properties [16, 12]. In case of applying it for actual asteroid thread, it would be convenient to have a reconnaissance spacecraft before the kinetic deflection if we consider the myriad of properties (shape, composition, spin state, and others) of the asteroids. An exploratory spacecraft could arrive days or weeks before the kinetic impact, with the task of acquiring the maximum possible information about the asteroid environment and properties. In this reconnaissance mission profile, every day and hour gained are essential. In that case, current missions architectures in the frame of months [44, 49] are not an option.\n\u2217email: rodolfo.negri@unifesp.br. Personal website: rodolfobnegri.com\nar X\niv :2\n20 8.\n03 37\n8v 2\n[ as\ntr o-\nph .E\nP] 1\n3 A\nNot only deflection missions could benefit from a rapid exploration of an asteroid. For instance, a mission aiming to explore multiple asteroids in highly populated regions in near co-orbital regimes (e.g., Trojan asteroids) could benefit from making multiple rendezvous and gathering precious scientific data before departing for the next target. Current mission architectures rely on a ground-in-the-loop for the spacecraft operation. The data are downlinked in telemetry to the Earth, meticulously analyzed by the ground team, and sent back as telecommands to be executed by the spacecraft. These round-trips may experience a delay of up to 40 minutes for NEAs (near-Earth asteroids), which places a high operational limitation. A pre-deflection reconnaissance or a multiple targets mission could benefit from full autonomy for fast approaching and characterizing the asteroid. The former may gather valuable information in due time to increase the impact success. In the latter, a more significant number of targets can be timely explored with the acquisition of high-quality scientific data.\nFull autonomy in asteroid missions has gained particular attention in the last years. Scheres & McMahon [37] assess different mission architectures for enabling autonomous exploration of small bodies, showing that a spacecraft can orbit and deploy objects on the surface of a small body with minimal instrumentation. Panicucci [30] analyses the use of a SLAM (simultaneous localization and mapping) technique so that an autonomous spacecraft map the environment while also localizing itself and later applies a shape reconstruction algorithm for obtaining the asteroid\u2019s shape. Takahashi & Scheeres [43] shows that the autonomous exploration of a small NEA is possible within current technology limitations. Other works are more focused on proposing control and guidance laws that can support autonomous operation, with particular attention to robust control laws, due to the highly perturbed environment encountered around an asteroid [18, 17, 19, 50, 27]. Although these are essential advancements, no attempt has been made yet to take full advantage of an autonomous mission while considering the navigational difficulties encountered in a small body scenario. For instance, most works concerned with the control and guidance laws make minor considerations about the navigational capabilities around an asteroid. In other cases [43, 42], the autonomous mission profile is still highly attached to current approaches, with the spacecraft spending months characterizing the asteroid before insertion in a stable orbit.\nThis study applies robust control and guidance laws to assess the possibility of fast approaching and orbiting an asteroid without knowledge of its properties while considering the navigational difficulties in that environment. The spacecraft uses onboard batch-sequential filtering to estimate the asteroid properties while rapidly approaching it from tens of kilometers of distance. The end of the mission consists of the spacecraft orbiting the asteroid in tight and naturally unstable orbits, using a robust orbital station-keeping control [27]. In order to accomplish this mission profile, we assume that the spacecraft is equipped with a LIDAR, two optical cameras, and an IMU. Their uncertainties are conservatively considered and modeled."
        },
        {
            "heading": "2 Dynamical Environment",
            "text": "Three reference frames are the most used for operations close to asteroids: inertial, fixed in orbit, and fixed in the body. The simplest is the inertial frame, centered in the asteroid and usually according to the ICRF. The frame fixed in the body is commonly defined with its z axis pointing to the body\u2019s north pole, while the x axis is in the direction of the smallest moment of inertia. Given the right ascension and declination of the pole of the asteroid in the inertial frame, respectively RA and DEC, it is trivial to obtain a sequence of rotations that leads from the inertial system to the body-fixed:\nRBFI =  cos($) sin($) 0\u2212 sin($) cos($) 0 0 0 1  cos(90\u25e6 \u2212DEC) 0 sin(90\u25e6 \u2212DEC)0 1 0 \u2212 sin(90\u25e6 \u2212DEC) 0 cos(90\u25e6 \u2212DEC)   cos(90\u25e6 +RA) sin(90\u25e6 +RA) 0\u2212 sin(90\u25e6 +RA) cos(90\u25e6 +RA) 0\n0 0 1\n . (1)\nThe angle $ represents a phase difference in the alignment of both systems\u2019 x and y axes. If the asteroid rotates uniformly about its largest principal axis of inertia (i.e., not considering wobble of the pole [23]), the angle $ can be described as $ = $0 + $\u0307\u2206t, where the first term is usually defined with respect to the prime meridian at J2000 [4] (but we make no ephemerides consideration on $). The second is the spin angular velocity of the asteroid multiplied by the elapsed time.\nThe remaining frame of reference, orbit-fixed, is centered in the asteroid and defined with its z axis in the direction of the angular momentum of the asteroid\u2019s heliocentric orbit, while the x axis is in the direction of its heliocentric position. A transformation that takes from the orbit-fixed frame to the inertial one can be obtained using the osculating orbital elements of the asteroid\u2019s orbit, as:\nRIOF =  cos(\u2212\u2126a) sin(\u2212\u2126a) 0\u2212 sin(\u2212\u2126a) cos(\u2212\u2126a) 0 0 0 1 1 0 00 cos(\u2212ia) sin(\u2212ia) 0 \u2212 sin(\u2212ia) cos(\u2212ia)   cos(\u2212\u03c9a \u2212 \u03bda) sin(\u2212\u03c9a \u2212 \u03bda) 0\u2212 sin(\u2212\u03c9a \u2212 \u03bda) cos(\u2212\u03c9a \u2212 \u03bda) 0\n0 0 1\n , (2)\nwhere \u2126a, ia, \u03c9a and \u03bda represent respectively the osculating orbital elements: longitude of the ascending node, inclination, argument of periapsis, and true anomaly.\nFrom the definitions of Euler angles, it is possible to transform between any of the three frames of reference using the Equations 1 and 2. Therefore, it easily follows the transformation from the body-fixed to the inertial frame (RIBF = (R BF I ) T), inertial to orbit-fixed (ROFI = (R I OF )\nT ), orbit-fixed to body-fixed (RBFOF = R BF I R I OF ), and body-fixed to orbit-fixed (R OF BF = (R BF OF )\nT). Although the transformations between the three frames are needed to quickly obtain the forces acting in the equations of motion, or the asteroid\u2019s attitude in space, the equations of motion used in this study are modeled only in the orbit-fixed frame. If, as an approximation, the asteroid\u2019s orbit is assumed as an unperturbed two-body problem with the sun, and considering the orbital angular velocity of the asteroid, ~\u0307\u03bda [35, 43], the equations of motion are:\n~\u0307r = ~v, (3a)\n~\u0307v = \u2212\u03bd\u0308a(z\u0302 \u00d7 ~r)\u2212 \u03bd\u0307a(2z\u0302 \u00d7 ~v)\u2212 \u03bd\u0307a[z\u0302 \u00d7 (z\u0302 \u00d7 ~r)] + ~aOF , (3b)\nin which ~r and ~v stand for the position and velocity of the spacecraft in the orbit-fixed frame, and ~aOF the accelerations due to forces acting on the spacecraft. From the two-body problem, one easily finds that[43]:\n\u03bd\u0307a = (1 + ea cos \u03bda) 2\n\u221a \u00b5S\n[aa(1\u2212 e2a)]3 , (4a) \u03bd\u0308a = \u22122ea \u221a\n\u00b5S [aa(1\u2212 e2a)]3 sin \u03bda(1 + ea cos \u03bda)\u03bd\u0307a, (4b)\nfor aa representing the semi-major axis of the asteroid, ea its eccentricity, and \u00b5S the gravitational parameter of the sun.\nDue to the asteroid\u2019s low gravity, many different forces reasonably affect the spacecraft operating in its vicinity. The importance of considering or not the action of a particular force varies from case to case, and it should be thought according to the objective of the analysis, distance to the asteroid, mass, and other properties. In general, as exemplified in Antreasian et al. [3] for the OSIRIS-REx mission, the main forces when the spacecraft identifies the asteroid in its optical cameras, hundreds of kilometers away, is the solar radiation pressure (SRP), third-body gravitational effects from the sun, and the central term of the asteroid\u2019s gravity field. At a few asteroid\u2019s diameters of distance to the asteroid, the spacecraft starts to experience gravitational effects due to the non-uniformity of its volume and density, which end up surpassing or equalling the SRP and third body effects. The asteroid\u2019s albedo and its infra-red radiation pressure also have a considerable effect.\nWe consider all of these main forces, except albedo and infra-red radiation pressure (due to their complexity, dependent on the asteroid\u2019s shape and composition), with the addition of accelerations from the spacecraft thrusters performed by the control system. Therefore, the acceleration of the spacecraft in the chosen frame of reference is:\n~a = ~ag + ~aSRP + ~a3B + ~u, (5)\nThe subscripts g, SRP , and 3B represent the gravitational field of the asteroid, the SRP, and the thirdbody effects due to the sun. The vector ~u is the control command.\nFor solar radiation pressure, a cannonball model is assumed, given by:\n~aOFSRP = P0(1 + \u03c1)U 2ASC MSC ~r \u2212 ~d ||~r \u2212 ~d||3 , (6)\nwhere ~r is the position of the spacecraft in the considered frame of reference, ~d is the position of the sun relative to the asteroid, \u03c1 is the reflectivity of the surface, P0 = 4.56\u00d7 10\u22126 N/m2, U is the distance of 1 AU in meters, ASC the considered surface area and MSC the mass of the spacecraft. In the simulations the considered values are[43]: Asc = 16 m\n2, Msc = 1000 kg, and \u03c1 = 0.4. In the case of the sun\u2019s gravitational effects, we have:\n~aOF3B = \u2212\u00b5S\n( ~d\n||~d||3 + ~r \u2212 ~d ||~r \u2212 ~d||3\n) . (7)\nThe gravitational field of the asteroid will be simulated using a spherical harmonic expansion, which is obtained considering the gravitational potential:\nUsh = \u00b5\nr N\u2211 n=0 n\u2211 m=0 (r0 r )n Pnm(sin\u03d5) [Cnm cos (m%) + Snm sin (m%)] , (8)\nwhere \u03d5 and % are, respectively, the latitude and longitude of the spacecraft in the body-fixed frame and Pnm are the associated Legendre polynomials. Recursive formulae to calculate the potential are used, which also obtain the acceleration ~aBFg [26]. The spherical harmonics expansion is made up to the fifth order and degree.\nWe choose for this work the asteroid Bennu and Eros. The parameters of the asteroids used in the simulations are shown in Table 1. If the spacecraft enters the Brillouin\u2019s sphere at any simulation instant, a polyhedron model describes the gravity field while inside it. The acceleration ~ag is also obtained in the body-fixed frame according to the polyhedron gravity model of Reference [48], for a constant density \u03b4 = 1177.05 kg/m3 (Bennu), and \u03b4 = 2681.77 kg/m3 (Eros). The coefficients Cnm and Snm in Equation\n8 are calculated from the polyhedron representing the shape of the asteroid [47], in order to maintain consistency with the characteristics of the assumed shape. The asteroid shape is obtained from NASA\u2019s PDS Small Bodies Node website1 and reduced to 4,000 facets using the software Autodesk Meshmixer. We make sure that the body-fixed frame is located in the asteroid\u2019s center of mass and aligned with the principal axes of inertia for the assumed mass [15]."
        },
        {
            "heading": "3 Navigation",
            "text": "In this section we describe the navigational solutions applied for this proposed GN&C architecture. First, assume a non-linear system of differential equations, with an output ~Y , written as:\n~\u0307X = ~F ( ~X, t), (9a)\n~Y = ~G( ~X, t) + ~\u03b5, (9b)\n~X \u2208 Rn, ~Y \u2208 Rp, and ~\u03b5 \u2208 Rp representing uncertainties introduced to ~Y . The problem is then of estimating the state vector ~X for a set of measurements ~Y ."
        },
        {
            "heading": "3.1 Onboard Nominal Dynamics and Environment",
            "text": "It is considered as the state vector in Equation 9:\n~X = [ ~r ~v \u00b5 CSRP ]T , (10)\nin which CSRP includes all the constant terms in Equation 6. The choice in not including any information about the asteroid\u2019s shape (e.g., its mean radius as used in Reference [43]), spin state, \u2206~V s applied by the control system, or higher-order terms of the gravity field is deliberate. We assume that in a preliminary phase of the approach, the spacecraft (autonomously or not) has obtained an accurate estimate of the asteroid\u2019s attitude and spin state. This is a reasonable assumption if noted the achievements in the OSIRIS-REx campaign when the spacecraft was 162 km away from Bennu, with errors in the order of 0.2\u25e6 and lower for RA, DEC, and $\u0307 [23].\nIn the nominal dynamics is only considered the central term of the gravity-field, i.e. ~ag = \u2212 \u00b5r3~r in Equation 5. The choice of neglecting higher-order terms in the nominal gravity-field, and thus not estimating them in ~X, is to stress the GN&C proposal in the case of unmodelled dynamics. This stressing is particularly true in the case of Eros. The terms J2 and C22 of its gravity-field will have a huge impact on the dynamics of the spacecraft operating in their proximity, with almost two orders of magnitude larger than the SRP. Therefore, we expect that neglecting the higher-order terms in the nominal scenario and estimates will provide a conservative assessment of other neglected effects such as infra-red radiation pressure, albedo, and attitude-dependent SRP.\nThe OSIRIS-REx, when operating close to Bennu, relied on a shape model obtained through stereophotoclinometry (SPC) with a 3D error of 1 m [1]. This accuracy is equivalent to about 0.4% of Bennu\u2019s\n1https://sbn.psi.edu/pds/shape-models/\nmean radius. Although reliable and accurate, this shape reconstruction approach is time-consuming and computationally intensive. Less demanding approaches are still an area of active research, primarily to facilitate onboard shape reconstruction [6, 5]. Due to these limitations, and in order to not employ an arguably quite optimistic scenario for the shape model as was done in previous works [43], we assume that instead of continuously estimating the asteroid\u2019s shape, the spacecraft has a rough onboard shape with an assumed uncertainty level.\nFinally, the non-inclusion of \u2206~V s in the state vector is because of the high activity of the control system due to fast approaching the asteroid with high uncertainties. If the \u2206~V s are considered in ~X, it becomes unclear if the spacecraft can process a large ~X in between its measurements. We, therefore, opt for a conservative consideration in which the executed control commands are passed as parameters to the nominal equations. That approach assumes two distinct forms.\nIn the first form, in between measurement times, the nominal equations are integrated onboard following the last best estimation of ~X from the measurements. That integration is made in real-time in a time interval equal to the update time of the control commands \u2206tu, so the control commands are passed as a constant to the equations of motion. The control system will use that real-time integrated trajectory to make decisions.\nThe second way the control commands are processed is within the filter, where they are reduced and treated as a set of \u2206~V s in a time-dependent function:\n~u(t) = N\u2206V\u2211 j=1 \u2206~Vj\u03b4(t\u2212 tj), (11)\nwhere \u03b4(t \u2212 tj) is the Dirac delta function, and \u2206~Vj is a \u2206~V applied at time tj . The way the control commands ~u are reduced to Equation 11 is very simple. The control command history is stored between the measurement times to be later fed into a routine. That routine, before the filter initialization, analyzes the control history and reduces different commands within time intervals \u2206t\u2206V = 60 s to each \u2206~Vj :\n\u2206~Vj = \u2211\ntj\u2264t<tj+t\u2206V\n\u2206t\u2206V ~u(t). (12)"
        },
        {
            "heading": "3.2 Measurements",
            "text": "We assume that the spacecraft is equipped with a LIDAR, two optical navigation cameras and a set of accelerometers, for navigation with respect to the asteroid. We consider that no radiometric data is available for the spacecraft, as one of the significant advantages of an autonomous operation is alleviating the ground burden on operating the spacecraft and in removing trajectory constraints that would need to be placed for maintaining a regular telemetry. The LIDAR measurements are modelled following the relation for their accuracy error as:\n\u03c3LIDAR = { 5.5 m, if r \u2265 6 km 0.1 m, if otherwise , (13)\nWe note that this is a conservative approach. The Advanced Scientific Concepts, the company responsible for the OSIRIS-REx 3D flash LIDAR used in the GN&C, reports a range error of 5-10 cm for the model \u201cGSFL-16KS Space\u201d2, in a range below 6 km. Mizuno et al. [25] report for Hayabusa 2 an operational range from 30 m to 25 km, with 1 m to 5.5 m errors at each respective range bound. Although both LIDARs are very different (e.g., Hayabusa 2 LIDAR is not a 3D flash LIDAR), we think it is reasonable to mix both to avoid taking an over-conservative approach. As we will show soon, the\n2https://asc3d.com/gsfl_16Ks/\nrange measurements are assumed to be made only by the LIDAR, which is unrealistic. In practice, the optical navigation would complement the range data settling the significance of the LIDAR errors if there is already an onboard\u2019s shape of the asteroid. In fact, in some missions, as is the case of OSIRIS-REx, the LIDAR measurements are not even considered in the orbit determination, being more critical for fault detection [49].\nHayabusa 2 spacecraft has three optical navigation cameras, ONC-T, ONC-W1, and ONC-W2 [44]. For the optical navigation of our analysis scenario, we consider the ONC-T and ONC-W1. The ONC-T is a telescopic camera with a FOV of 6.27\u25e6 and pixel size of 1024\u00d71024, while the ONC-W1 has a wide FOV of 69.71\u25e6 and 1024\u00d71024 pixels.\nThe optical and LIDAR measurements are combined to form the measurement vector ~Y that are fed into the navigation filter to estimate ~X:\n~Y = [ r r\u0302 ]T (14)\nFor the range measurement r, its uncertainty is assumed as:\n\u03c32r \u223c \u03c32LIDAR + \u03c32RR2, (15)\nin which R is an assumed size of the body and \u03c3R is due to shape uncertainties. As already discussed, note that this is a conservative approach as limb-based techniques can be employed to complement and further constrain the range data if there is already a shape model of the asteroid with known uncertainty, decreasing the significance of \u03c3LIDAR [24].\nWe assume a procedure similar to Reference [37] for obtaining r\u0302. Assuming two angles \u03b81 and \u03b82 obtained by the spacecraft\u2019s IMU, we define:\nr\u0302 = cos \u03b81 cos \u03b82sin \u03b81 cos \u03b82 sin \u03b82  . (16) With this definition, we can model uncertainties in the optical measurements according to to[37]:\n\u03c32\u03b8 \u223c IFOV 2 + \u03c32\u2126, (17)\nin which IFOV = FOV/Np is the instantaneous field of view of the camera, with Np = 1024 being the number of pixels. The term \u03c3\u2126 represents the angular uncertainty of the asteroid, represented as:\ntan\u03c3\u2126 = \u03c3RR\nr , (18)\nwhere \u03c3R is the 3D error in percentage in the shape model with respect to a reference size R, in which we take the mean radius of the polyhedron model that we use as the real asteroid (R = 246.8 m for Bennu, and R = 8795.0 m for Eros). As already argued, \u03c3R is within 0.4% in the SPC shape reconstruction of Bennu. Scheeres & McMahon [37] argue that current research are on the way to constrain \u03c3R by 1%. In this study, we then mostly apply \u03c3R = 1%. However, We also assume different levels of \u03c3R to assess how the autonomous control could handle that large source of uncertainty in the navigation, serving as a subsidy for further studies in onboard shape reconstruction or an indicator of the possibility of the spacecraft operating with a shape obtained from previous astronomical observations.\nTakahashi & Scheeres [43] assume the use of accelerometers with a noise spectral density of 1\u00d7 10\u22125 m/s2/ \u221a Hz for measuring the applied \u2206~V maneuvers, an order of magnitude preciser than off-the-shelf inertial measurement units (IMU). They argue that state-of-the-art accelerometers have a noise spectral density below 1 \u00d7 10\u22128 m/s2/ \u221a Hz, which would make their assumption proper. However, we note that these ultra-precise state-of-the-art accelerometers have an operational bandwidth that is not adequate for a spacecraft\u2019s attitude and orbit control system. They are designed to operate at a maximum frequency\nof 0.1 Hz, as can be checked in the accelerometers\u2019 table presented in Takahashi & Scheeres and references therein [43].\nHere we take what we consider a more suitable approach by assuming the use of an off-the-shelf IMU, for which we choose the LN-200S 3, the same used in the Hayabusa 2 mission, that has a noise spectral density of 3.4\u00d710\u22124 m/s2/ \u221a Hz. We also assume that any small-thrust engine equipped on the spacecraft (hence producing a thrust level in the same order or below the chosen IMU\u2019s noise) have passed through a meticulous campaign to obtain their transfer function so that other measurements, such as pressure in the chamber, current, and others (depending on the engine), can be related to the thrust level.\nIn that way, we assume a conservative 1\u03c3 uncertainty of 1% in this indirectly measured thrust level. That uncertainty level is in the same order of the throttle curves obtained for the SPT-140 thrusters used in the Psyche mission [40], and much greater than the 0.15% noise of the micro-thrusters used in the LISA Pathfinder [41]. Therefore, both sources of thrust measurement, direct (IMU) and indirect, can be fused to obtain the imparted thrust level. The measured thrust is then modeled as:\numeas = \u03c3\u22122TFuTF + \u03c3 \u22122 IMUuIMU\n\u03c3\u22122TF + \u03c3 \u22122 IMU\n, (19)\nwhere \u03c3IMU = 3.4 \u00d7 10\u22124 m/s2 considering a 1 Hz measurement frequency, \u03c3TF = 1%uTF , uTF is the thrust level obtained through the thrusters\u2019 transfer function, and uIMU is the thrust level measured by the IMU."
        },
        {
            "heading": "3.3 Estimation",
            "text": "For the estimation process we employ the same filtering approach adopted in the JPL\u2019s AUTONAV [9, 32, 33, 7]. It is a batch-sequential least-squares filtering approach, in which the measurements are processed as a batch that sequentially advances in time as new measurements are made. The choice of that approach is because it presents better stability than a sequential one for the case of sparse measurements, as it uses a consistent reference trajectory [43]. In addition, the possibility of data editing to eliminate outliers gives an additional degree of robustness to the filter [7], even tough we make no consideration in that regards. Its limitation is a larger required processing time if compared to the sequential process. However, there is plenty of time for processing a reasonable batch of data in an asteroid mission due to its large time constants, which allows for sparse measurements. An indication of that fact are the measurement intervals in the order of hours in the asteroid missions. For instance, the OSIRIS-REx mission makes a new measurement every 2 hours [49]. Here we define that a new measurement is made in an interval of 1 hour.\nLet the error between the real and the reference trajectory be defined, considering a discretization for the times ti, i = 1, 2, ..., l, as ~\u0304xi = ~Xi\u2212 ~X\u2217i . Likewise: ~\u0304yi = ~Yi\u2212 ~Y \u2217i . Expanding the discretized Equations 9 to ti in Taylor series to obtain a linear approximation, we find [38]:\n\u02d9\u0304~xi = Ai(ti)~\u0304xi, (20a)\n~\u0304yi = Ci(ti)~\u0304xi + ~\u03b5i, (20b)\nin which:\nAi(ti) = \u2202 ~F\n\u2202 ~X \u2223\u2223\u2223\u2223\u2223 ~Xi= ~X\u2217i ,t=ti , (21a)\nCi(ti) = \u2202 ~G\n\u2202 ~X \u2223\u2223\u2223\u2223\u2223 ~Xi= ~X\u2217i ,t=ti . (21b)\n3https://www.northropgrumman.com/what-we-do/ln-200s-inertial-measurement-unit/\nWe want to estimate for an epoch tk, which we choose as the time of the last measurement, to obtain ~\u0304xk. So it is now possible to use the solution of a linear system:\n~\u0304xi = \u03a6(ti, tk)~\u0304xk, (22a)\n\u03a6\u0307(t, tk) = A(t)\u03a6(t, tk), (22b)\nwhere \u03a6(t, tk) is the state transition matrix, for \u03a6(t0, t0) = I. Now, we can transform the Equation 20 into:\n\u02d9\u0304~xi = Ai(ti)\u03a6(ti, tk)~\u0304xk, (23a)\n~\u0304yi = Ci(ti)\u03a6(ti, tk)~\u0304xk + ~\u03b5i. (23b)\nDefining ~\u03b5 = [ ~\u03b51 ~\u03b52 ... ~\u03b5l ] T and assuming a normal distribution with zero mean, E[~\u03b5] = 0, and known covariance, E[~\u03b5~\u03b5T ] = R, it is possible to demonstrate that the estimate with minimum covariance for ~\u0304xk is [38]:\n\u02c6\u0304~xk = (C TR\u22121C)\u22121CTR\u22121~\u0304y, (24)\nwhere C = [ C1(t1)\u03a6(t1, tk) C2(t2)\u03a6(t2, tk) ... Cl(tl)\u03a6(tl, tk) ]T and ~\u0304y = [ ~\u0304y1 ~\u0304y2 ... ~\u0304yl ]T . The states\u2019 covariance matrix is P = (CTR\u22121C)\u22121. The Equation 24 is iteratively solved following the algorithm in Reference [38], pg. 196, up to convergence of the root mean square (RMS) of the observation\nresiduals in order to obtain the epoch\u2019s estimative ~\u0302Xk. We note that the integration of Equations 22 is stopped in the times tj to properly take into account the \u2206~Vjs, Equation 11, in the components of ~X correspondent to ~v."
        },
        {
            "heading": "4 Guidance and Control",
            "text": "As already discussed, once an estimative ~\u0302Xk for the epoch is obtained, it is used to propagate the nominal equations of motion before the subsequent measurement and estimative update. The nominal equations of motion are propagated in real-time in intervals equal to the control update time \u2206tu, which we choose to be 1 second. We only use two different control approaches. The first is a Monte Carlo-Lambert guidance responsible for driving the spacecraft to orbital insertion from far away from the asteroid. The second one is an orbit-keeping control responsible for maintaining and transiting between Keplerian orbits about the asteroid. Both of them can be considered robust approaches because they explicitly deal with uncertainties, the first by taking a stochastic approach and the second by using sliding-mode control [39].\nFirst, considerer the Equations 3. Let us rewrite it as:\n~\u0307r = ~v, (25a)\n~\u0307v = ~f + ~u+ ~d, (25b)\nin which ~f = \u03bd\u0308a(z\u0302\u00d7~r)\u2212 \u03bd\u0307a(2z\u0302\u00d7~v)\u2212 \u03bd\u0307a[z\u0302\u00d7 (z\u0302\u00d7~r)] +~a3B +~ag +~aSRP +~a3B and ~d \u2208 R3 is disturbances acting in the system and known to be bounded by |di| < Di, for i = 1, 2, 3 representing each of its components."
        },
        {
            "heading": "4.1 Monte Carlo-Lambert Guidance",
            "text": "A common feature in an asteroid mission is the high uncertainty level of the spacecraft belief on the exact asteroid properties, environment, and relative state before being at few body\u2019s radii of distance. For that reason, the Hayabusa 2 mission employs stochastic guidance for the approach phase, using the\nsoftware JATOPS run on the ground [45], which minimizes the fuel consumption taking into account the uncertainties in the asteroid properties and relative navigation for a 2.5\u03c3 uncertainty.\nIn our case, for the autonomous operation, we choose to apply a Lambert guidance [20], which solves Lambert\u2019s problem after each measurement update using Izzo\u2019s algorithm [21]. Therefore, given the current state ~r(t0), the desired final position ~r(tf ), and the time-to-go tgo = tf \u2212 t0, the Lambert problem can be solved to find the necessary velocity change at the current and the final states, \u2206~V0 and \u2206~Vf , respectively. However, in order to manage the uncertainties, a Monte Carlo approach is applied considering the last estimate ~\u0302X with its respective 3\u03c3 uncertainty in ~r(t0) and \u00b5. We consider 500 samples.\nThe commanded velocity changes will be taken from the mean value in each component of the vectors \u2206~V0 and \u2206~Vf from the Monte Carlo process. After each estimate update, a \u2206~V0 will be performed, while the \u2206~Vf will be executed a single time, scheduled after the last update before the orbital insertion. The obtained \u2206~V can be accomplished by using the control command:\n~u = 1\n\u2206tu \u2206~V . (26)\nThe time to initiate the \u2206~Vf can be scheduled by considering a guaranteed maximum thrust level in each component, um, for the time texec = tf \u2212 \u2206Vmaxum , where \u2206Vmax is the component with maximum magnitude of \u2206~Vf ."
        },
        {
            "heading": "4.2 Robust Path-following for Orbital Maintenance",
            "text": "The second control law applied is a robust Keplerian path-following derived by Negri & Prado [28]. As shown in Negri & Prado [27], that control approach presents an excellent performance for operating in close proximity to small bodies, allowing the stabilization of otherwise unstable orbits even with a high level of uncertainties. Its robustness comes from the application of sliding-mode control theory. The sliding surface ~s is defined only in terms of the integrals of motion of the two-body problem that are related to the geometry of the orbit. Thus, the true anomaly is a free parameter, making the control a path-following approach, which is more convenient for an orbital maintenance control [27]. Once the equilibrium condition for the sliding surface is reached, ~s = 0, the controlled spacecraft asymptotically converges to the desired Keplerian geometry. The sliding surface is [28]:\n~s =  ~\u0303e \u00b7 (\u03bbRr\u0302 + \u03b8\u0302)h\u0303 h\u0302d \u00b7 (\u03bbN r\u0302 + \u03b8\u0302)  = 0, (27) where \u03bbR > 0 and \u03bbN > 0 determine the rate of convergence to the desired Keplerian geometry, as shown in Proposition 1 in Negri & Prado [28], ~\u0303e = ~e\u2212 ~ed represents the error between, respectively, the current and desired eccentricity vectors, h\u0302d is the desired specific angular momentum versor and h\u0303 = h \u2212 hd is the error in the magnitude of the specific angular momentum. The versors r\u0302 and \u03b8\u0302 are the versors of the radial-transverse-normal (RTN) coordinates, r\u0302 = ~r/||~r|| and \u03b8\u0302 = h\u0302 \u00d7 r\u0302, in which the normal component h\u0302 is the specific angular momentum versor.\nThe desired versor h\u0302d, defining the orbital plane, can be obtained as:\nh\u0302d =  sin id sin \u2126d\u2212 sin id cos \u2126d cos id  , (28)\nby choosing a desired inclination id and longitude of the ascending node \u2126d. The current and desired angular momentum are obtained as h = ||~r \u00d7 ~v|| and hd = \u221a \u00b5ad(1\u2212 e2d), respectively. Finally, the current and desired eccentricity vectors are respectively:\n~e = 1\n\u00b5 (~v \u00d7 ~h\u2212 \u00b5r\u0302) = e cos \u2126 cos\u03c9 \u2212 sin \u2126 sin\u03c9 cos isin \u2126 cos\u03c9 + cos \u2126 sin\u03c9 cos i sin\u03c9 sin i  , (29) for a desired \u2126d, \u03c9d and id.\nUsing the sliding surface in Equation 27, robustness to bounded disturbances and asymptotic convergence to the geometry of a Keplerian orbit can be obtained using the control:\n~u = \u2212[RTN ]\u22121F\u22121(G+Ksgn(~s))\u2212 ~f, (30)\nK \u2208 R3\u00d73 is a diagonal positive definite matrix, the function sgn(~s) \u2208 R3\u00d71 represents the sign function taken in each component of ~s, the matrices F and G are defined by:\nF = 1\nh\u00b5 \u2212h2 [2\u03bbRh\u2212 (~v \u00b7 r\u0302)r]h \u2212\u00b5r(~ed \u00b7 h\u0302)0 \u00b5rh 0 0 0 \u00b5r(h\u0302d \u00b7 h\u0302)  , (31a) G = h\nr2 ~\u0303e \u00b7 (\u03bbR\u03b8\u0302 \u2212 r\u0302)\u2212 10 h\u0302d \u00b7 (\u03bbN \u03b8\u0302 \u2212 r\u0302)  , (31b) and the matrix [RTN ] is a matrix that transforms from the Cartesian coordinates to RTN, defined as:\n[RTN ] = r\u0302T\u03b8\u0302T h\u0302T  (32) with the superscript T representing the tranpose.\nThe control in Equation 30 lies on the assumption that the magnitude of ~h and ~r are not zero. It also assumes that by defining an angle \u03b2 such that cos\u03b2 = h\u0302 \u00b7 h\u0302d, this angle is bounded by \u03b2 < 90\u25e6. If both assumptions hold, the matrix F is always invertible [28]. The diagonal gain matrix K can be chosen to guarantee convergence for unknown bounded disturbances, assuming ~d written in RTN bounded such that |dR| < DR, |dT | < DT , and |dN | < DN , as [28]:\nK1,1 \u2265 h\n\u00b5 DR + \u2223\u2223\u2223\u22232\u03bbRh\u2212 (~v \u00b7 r\u0302)r\u00b5 \u2223\u2223\u2223\u2223DT + r \u2223\u2223\u2223~ed \u00b7 h\u0302\u2223\u2223\u2223 h DN , (33a)\nK2,2 \u2265 rDT , (33b)\nK3,3 \u2265 r h\u0302d \u00b7 h\u0302 h DN , (33c)\nin which Kj,j , j = 1, 2, 3, are the diagonal elements of the matrix K."
        },
        {
            "heading": "4.3 Practical Considerations",
            "text": "The main drawback of the sliding mode control is its discontinuous control input, which in many practical applications leads to chattering. That can be easily dealt with by allowing the system to converge to a\nboundary around the sliding surface, at the expanse of a bit of performance, as extensively documented in the literature [39]. The most common approach is to substitute the sign function in Equation 30 with the saturation function:\nsat(x;x?) =  1, x > x? x x? , \u2212x ? \u2264 x \u2264 x?\n\u22121, x < \u2212x? . (34)\nIn the case of ~s, we have a vector, so we define ~x, ~x? \u2208 Rn, and the equivalent of Equation 34 for vectors is ~g = sat(~x; ~x?) : Rn \u2212\u2192 Rn, such that gi = sat(xi;x?i ), i = 1,2,...n, for i representing each component of the vector. In that way, the sign function in Equation 30 can be replaced by sat(~s;~s?).\nAs discussed by Negri & Prado [27], it would be desirable that the orbit-keeping law accommodate turned-off periods, to save fuel and allow scientific measurements with no thruster interference. Thus, we choose to apply a hysteresis function inspired in the Schmitt trigger as a form of mathematical switcher which turns on/off the orbital maintenance control. We define that hysteresis function as:\nhys(x) =  1, |x| > x+ 0, |x| < x\u2212\n1, x\u2212 \u2264 |x| \u2264 x+ and hys(xp)= 1 0, x\u2212 \u2264 |x| \u2264 x+ and hys(xp)= 0\n, (35)\nwhere hys(xp) indicates the previous value of the hysteresis function. For a vector ~x \u2208 Rn, we define ~g = hys(~x) : Rn \u2212\u2192 Rn, such that gi = hys(xi), i = 1,2,...n. Therefore, a practical form for the control law in Equation 30, considering idle-thrusters periods, can be:\n~uRTN = \u2212 [ [RTN ]\u22121F\u22121(G+Ksat(~s;~s?))\u2212 ~f ] ||hys (~\u03c7)||\u221e, (36)\nwhere hys (~\u03c7) represents the hysteresis function taken in each component of a vector of orbital elements ~\u03c7 = [ a e i \u03c9 \u2126 ]T . The operator ||\u00b7||\u221e is simply the L\u221e norm, i.e. ||~x||\u221e = maxi|xi|. This is just a ingenious mathematical way of saying that the control is turned off if all elements of hys (~\u03c7) are zero, and turned on if any component of hys (~\u03c7) is 1.\nAn additional practical consideration is the spacecraft thrusters\u2019 inability to execute the calculated control commands precisely. For that sake, we assume a 1\u03c3 dispersion of 3% around each component of the calculated control commands. We also consider that the spacecraft has an operational envelope with control commands bounded within the magnitudes of 0.02 m/s2 and 1\u00d710\u22125 m/s2 in each component. In the case a calculated control command component is below 1\u00d710\u22125 m/s2, no control is applied in that component. These chosen bounds are conservative assumptions, 0.02 m/s2 is the same as a 20 N thruster in a 1,000 kg spacecraft, equivalent to a single thruster of the twelve RCS (reaction control system) thrusters of Hayabusa 2 [46], or the six 22 N trajectory correction maneuver (TCM) thrusters of OSIRIS-REx [10]. The lower bound is equivalent to a 10 mN thruster for the same spacecraft mass, comparable to the four 10 mN thrusters equipped in Hayabusa 2. As we consider a conservative thrust bound of 0.02 m/s2 (e.g., one out of twelve Hayabusa 2\u2019s thrusters), it is unlike that the spacecraft\u2019s attitude will have any impact in delivering or not such a thrust level.\nThe only case when a dedicated action on the attitude\u2019s control system might be required is at the orbital insertion, when we consider that the thrust level is allowed to be larger than the 0.02 m/s2 bound for applying the \u2206~Vf described in Section 4.1. In that case, it is considered as the spacecraft would use its main engine, and we consider a maximum thrust level of 0.45 m/s2, which is equivalent to a 450 N engine in a 1,000 kg spacecraft. That thrust level could be delivered by three of the four 200 N main thrusters of OSIRIS-REx mission [10]. Although the orbital insertion would thus require a dedicated attitude action for targeting the main engine to \u2206~Vf , we consider it could be safely executed in the tens\nof minutes between a \u2206~Vf calculation and its scheduled execution time. Therefore, we can still decouple the trajectory dynamics and control from the attitude.\nWe also note that thrusters\u2019 choice is a matter of mission trade-off, and we make no other specific consideration beyond the described maximum and minimum thrust level bounds. In the case an ultraprecise orbit-keeping is needed, it is theoretically possible to employ colloidal micro-Newton thrusters, like the ones of LISA Pathfinder [31]. Although we will consider a continuous thrust signal in our simulations, this does not limit the use of chemical engines, as a PWPF modulator could translate the continuous thrust to discrete signs. Negri & Prado [27] shows that the orbital maintenance control applied here, which can be argued as the most doubtful to operate at the discrete manner of a chemical engine, can efficiently operate with discrete signs using a PWPF modulator.\nThe parameters used in orbital control law are shown in Table 2. Note that the gain matrix K guarantees stability to perturbations bounded by 0.01 m/s2 in any component, equivalent to the gravitational acceleration at 5.33 Ceres\u2019 radii from Ceres, the largest body in the asteroid belt. The upper bound in \u03c9 for the hysteresis is chosen because we choose circular orbits for the operation we will show later. The bound of 360\u25e6 means that the argument of periapsis is let to vary freely. In a real mission scenario, we note that the hysteresis parameters can be adjusted as the spacecraft increases its knowledge of the body and environment\u2019s properties. It can be integrated with a routine that computes stable orbits and adjusts the hysteresis parameters to accommodate non-worrisome oscillations in the orbital elements. We do not make these considerations here because it is pretty straightforward and to not deviate from the scope of this work, but it can be quickly done based on studies on the orbital mechanics about asteroids [35, 22]."
        },
        {
            "heading": "5 Analysis and Discussion",
            "text": "This section analyzes and discusses the results obtained by applying the proposed autonomous GN&C approach. In Section 5.1 we make some comments on the far-approach phase of an asteroid mission, which is beyond the scope of this work. Section 5.2 shows results considering the close-approach, which are further analysed in Section 5.3 in Monte Carlo simulations. Finally, Section 5.4 considers a different shape onboard to assess how the proposed autonomous GN&C behaves."
        },
        {
            "heading": "5.1 Some Comments on the Far-approach Phase",
            "text": "By \u201cfar-approach\u201d, we consider the period of the mission when the spacecraft changes from heliocentric to relative navigation about the small-body, which is the same as phase 1 of the Hayabusa 2 campaign [45]. That phase ends with the spacecraft at an arbitrary far distance from the small body, when a preliminary assessment of the environment is made, such as identifying small moons, coarse asteroid shape reconstruction, asteroid\u2019s attitude determination, constraining the parameter of mass, and others. Depending on the asteroid\u2019s size and mass, the relative distance in that mission period should vary from a few million or hundred-thousands kilometers up to thousands or hundreds of kilometers. From a guidance and control standpoint, this is the least critical phase of the mission. The dynamics should remain nearly constant throughout the operation, with the main forces being the sun\u2019s gravitational pull and the solar radiation pressure.\nIf the autonomy is restricted to the operation around the asteroid, that is when the transition from the ground to the autonomous operation takes place. In this case, the spacecraft would rely on the ground up to the moment when the asteroid is found as a point-source in its optical cameras. After that, a hybrid approach could take place as the autonomous spacecraft could fast approach the body up to thousands or hundreds of kilometers with the supervision of the ground for a safe delegation of navigational responsibility. On the other hand, an onboard algorithm to search for the asteroid - considering its ephemeris uncertainty - should be used if the spacecraft has been autonomously operating since its deep-space cruise phase.\nThe more or less constant dynamics in the far-approach phase make it easy to use simple guidance laws, such as an LQG or a ZEM/ZEV that considers the state\u2019s uncertainty, for approaching the body. As it will become apparent soon with our future assumptions, there is no need for an exact orbit determination at this point. The critical aspect is to get close enough to the asteroid for the preliminary environment\u2019s assessment. For current research describing algorithms that could be onboard in a spacecraft for making the asteroid\u2019s preliminary attitude, shape, and environment assessment, we refer the reader to other works [14, 6, 5, 29].\nBecause cruise-phase deep space autonomous navigation is still an area of active research [11, 8, 13, 2], and the arguably operational simplicity in terms of guidance and control for the far-approach phase, we abstain from making deep considerations on which profile the spacecraft adopts in that period and concentrate on the scope of this work - much more challenging - that is when the spacecraft is fully autonomously navigating relative to the asteroid without ground supervision, similar to what was made in previous studies [43]."
        },
        {
            "heading": "5.2 Close-approach Phase",
            "text": "A mission could have different profiles depending on the mission\u2019s goals and the availability of prior knowledge about the asteroid\u2019s environment and properties. We consider that after the preliminary environment assessment at the end of the far-approach phase, the spacecraft could opt between different profiles, depending on the general properties of the asteroid assessed at a distance. It is safe to assume that in the preliminary environment characterization, the spacecraft would be able to determine if the environment tends or not to be a solar radiation pressure-dominated one or if the body is elongated. We can then rely on consolidated results in the literature [36, 34, 35] to propose that in the first case, the spacecraft would adopt a sun-terminator orbit, while in the latter, the choice would be for a retrograde equatorial orbit in the asteroid\u2019s inertial frame. Of course, this is a simplification to aid in the argument of this work. However, in reality, other operational profiles could be onboard the spacecraft, accounting for other types of systems (e.g., binaries) and mission goals.\nWe first consider a Bennu exploration case. The spacecraft departs from tens of kilometers from the asteroid, in a position [ \u2212150 \u2212150 10 ]T km with initial velocity [ 0 0 0 ]T m/s. The spacecraft\u2019s initial nominal position and velocity uncertainties, with a 1\u03c3 dispersion in each component, are assumed to be 15 km and 1 m/s, respectively. No prior information about \u00b5 and CSRP is available, and they are arbitrarily set to 0.001. The spacecraft is left in free fall until it accumulates four measurements, considered the minimum batch size. After that, the autonomous GN&C starts its operation, with the first batch of measurements increasing in size until it reaches the designed batch size for twenty measurements. Once the designed batch size is reached, it sequentially advances in time as new measurements arrive.\nFollowing the first estimation, the Monte Carlo-Lambert guidance drives the spacecraft to orbital insertion by setting the final values in the position and velocity vectors corresponding to the ones of the desired orbit under the best estimate \u00b5\u0302 of the gravitational parameter. The guidance\u2019s time-to-go is calculated for tf = 48.5 hours after the simulation start. The chosen orbit is a 2 km circular sunterminator orbit. The orbit-keeping control maintains the spacecraft in this orbit up to 120.5 hours after the simulation starts when the orbit-keeping control changes the desired orbital elements to those of a\ntransfer ellipse. That transfer ellipse is calculated in the same manner explained in Negri & Prado [27] for a Hohmann-like transfer. The desired orbital elements are changed once again when arbitrarily close to the transfer ellipse periapsis for the ones of an 800 m circular sun-terminator orbit.\nFigure 1 shows the simulation results to that case, considering a 1\u03c3R = 0.01. Figures 1a and 1b, presenting the actual trajectory in blue and the nominal trajectory in red, show that the operation is successful. The spacecraft is successfully inserted in orbit and then transits for the second orbit with a Hohmann-like transfer. It can be checked in Figures 1c and 1d that the magnitude of the errors in position and velocity are within some meters and fractions of millimeters per second, respectively. The firing of the main engine increases the uncertainty in the spacecraft\u2019s state at t = 2 days, but this is rapidly settled down in the orbital operation. Figures 1c and 1d present the ratio in estimating the gravitational parameter and solar radiation pressure coefficient, respectively. The grey background is the 3\u03c3 standard deviation, while the red line represents the estimated value. The estimation of \u00b5 is maintained within about 2%, and CSRP about 10%, after a few measurements obtained in orbit.\nThe path-following nature of the orbital station-keeping is very convenient for having idle-thrusters periods, allowing to make scientific measurements without interference from the propulsive system, as discussed in Negri & Prado [27]. The spacecraft can experience hours of idle-thrusters as indicated by Figure 1g, in which the components of the control commands are shown. The \u2206V budget was 6.95 m/s, with most of it spent in the Monte Carlo-Lambert guidance, where the spacecraft still has a poor estimation performance, and in the orbital insertion main engine burn. This is to be compared with the \u22489-14 m/s obtained by Takahashi & Scheeres [42] or the 22 m/s in the OSIRIS-REx mission for close-proximity operations [49].\nSuppose we extrapolate the \u22480.03 m/s spent by the spacecraft in the 2-day transfer plus orbital maintenance in 800 m orbit (tighter than the tightest 1 km orbit of OSIRIS-REx [49]). In that case, the spacecraft could still orbit Bennu, and makes similar orbital transfers, for about 136 days before reaching the 9 m/s best scenarios of Takahashi & Scheeres [42]. The point here is not in advising the use of this paper\u2019s exactly architecture and mission profile. Instead, it shows that a fully autonomous operation opens new possibilities for asteroid exploration. It is a paradigm shift in the current conservative approach of severely constraining uncertainties before close proximity. Well-designed guidance and control laws can allow an autonomous spacecraft to have a bolder operation even with a high level of uncertainty in the navigation. On top of that, there is not a significant compromise in budget \u2206V as one could expect. Therefore, a fully autonomous mission in close-proximity might not need the 20 days preliminary survey phase like the OSIRIS-REx mission, and its 94 days approach phase could be potentially shortened [49].\nWe now consider a completely different target, the asteroid Eros. Unlike Bennu, Eros is an elongated and much more massive asteroid. Some similarities in the mission profile to the Bennu scenario are\nmaintained, but now the spacecraft departs from [ \u22121500 \u22121500 100 ]T km. The uncertainty in position is 150 km for each component and 1 m/s for the velocity. The spacecraft goes for orbital insertion at 48.5 hours in an equatorial retrograde orbit of 50 km, much smaller than the initial eccentric orbit of more than 300 km in the NEAR-Shoemaker mission 4. Once again, a Hohmann-like transfer is made with the orbit-keeping control for an orbit of 30 km (smaller than the 35 km orbit of NEAR-Shoemaker).\nFigure 2 shows the results for Eros\u2019s scenario. Again, the operation is successful, as Figures 2a and 2b shown. The position estimation error is around some hundred meters in the first orbit, see Figure 2c, which can be considered adequate when considering the scale of the problem. A severe downgrade in the estimation is observed in the second orbit to kilometers magnitude (t > 5 days). This is due to the neglecting of the second-order terms of the gravity field (J2 and C22) in the nominal dynamics that are more impactful at this proximity. In practice, neglecting them in the nominal dynamics can be considered over-conservative even for a non-elongated body as Bennu since the sum of all other neglected dynamics (albedo, infrared, attitude-dependent SRP, and others) will not reach the same level of J2 and C22 in\n4https://near.jhuapl.edu/NewMissionDesign/\nthat proximity [3]. Nevertheless, it serves to show the robustness of the chosen estimation algorithm. There is no point in showing the estimation of CSRP for Eros, as the SRP in that case is several orders of magnitude below higher-order terms of the gravity field. In the case of the gravitational parameter, even the over-conservative neglected dynamics cannot impact much in its estimation, maintaining an error below 10% (see Figure 2e.\nFigure 2f shows the control commands in the 7 days of operation in close-proximity to Eros. Excellent long periods of idle-thrusters are again seen in the orbital part of the mission. The budget \u2206V is 80.09 m/s, with most of it again spent by the Monte Carlo-Lambert guidance operating with large uncertainties about the spacecraft\u2019s state and environment. Nevertheless, when comparing the 62.18 m/s spent by the Monte Carlo-Lambert guidance to the 50.38 m/s spent by NEAR-Shoemaker in the one year after the rendezvous burn (TCM-17), i.e., from the TCM-18 to TCM-23, this is a reasonable amount 5. More interesting, however, is the 17.92 m/s \u2206V in orbital insertion and orbital maintenance. Compare this to the 31.57 m/s of the orbital insertion (OIM) and orbital operations (OCM-1 to OCM-25) of NEARShoemaker 6. The autonomous spacecraft could operate for more 8.6 days before reaching the 31.57 m/s mark of NEAR-Shoemaker, if we again extrapolate the cost of nearly 3.17 m/s of transfer and orbital maintenance (t > 5 days) of the second orbit. Although we cannot say that the \u2206V consumption is forgivable for a larger body as Eros as in the small body case of Bennu, this is an incredible performance if we consider the bolder operation and all the conservative assumptions for this assessment."
        },
        {
            "heading": "5.3 Monte Carlo Analysis",
            "text": "To assess the robustness of the integrated autonomous GN&C, we make a Monte Carlo analysis considering 500 samples. We make some changes in the setup of Section 5.2 to alleviate the burden in the processing time. The orbital insertion occurs now at t = 24.5 hours and the transition to the second orbit at t = 48.5 hours. The final time in the simulation is 3 days. For the Bennu exploration case, the first orbit is changed to a radius of 1.4 km, while the second orbit is set to 700 m.\nFigure 3 shows the results of the Monte Carlo simulation for Bennu. All the samples were successful in accomplishing the proposition. Because the approaching time is half the one in Section 5.2 and the orbit is tighter, the orbital injection error is much higher. Thus the autonomous spacecraft had initial trouble maintaining the orbit within reasonable bounds, which can be observed in the spikes of a few trajectories in Figure 3a. Nevertheless, after a few measurements in a more favorable dynamical environment for the estimation, the spacecraft rapidly settles down, allowing a smooth transition and maintenance in the tighter 700 m orbit.\nA histogram for the budget \u2206V is shown in Figure 3b. The consumption of \u2206V is within 8 to 12 m/s, with most of the consumption again in the Monte Carlo-Lambert guidance. The \u2206V histogram does not follow a Gaussian distribution probably due to the few cases in which the spacecraft had more trouble in recovering from the bad orbital insertion, in which the orbital control acts more like a guidance driving the spacecraft to orbit than in orbital stabilization. Nevertheless, it still shows the low consumption of \u2206V in that bolder operation, and also the robustness of the orbital control.\nRegarding the errors in estimating the spacecraft\u2019s state, they tend to remain in tens to hundreds of meters and from a few to tens of millimeters per second for the position and velocity, respectively, in the approach phase, as seen in Figure 3c and 3d for the mean of the samples. The large orbital insertion burn maneuver introduces much uncertainty in the estimation, as expected from the analysis in Section 5.2. The errors in position can spike to the order of kilometers and fractions of meters per second for the velocity, as shown by the 3\u03c3 curve of the statistics. Nevertheless, they rapidly decrease in the orbital operation, with the mean remaining a few meters and millimeters per second for the position and velocity, respectively. The mean in the samples for estimating the constant parameters tend to be the real value of\n5https://near.jhuapl.edu/NewMissionDesign/prpevent422.html 6https://near.jhuapl.edu/NewMissionDesign/prpevent422.html\neach of them, as can be checked in Figures 3d and 3e. The gravitational parameter \u00b5 tends to be biased when in the second orbit. This is due the effects of J2 and C22.\nIn the Eros case, Figure 4, the Monte Carlo analysis shows results in line with the discussed in Section 5.2. Again the spacecraft is successful in its operation for this autonomous GN&C. The spacecraft is satisfactorily inserted into orbit and makes the transfer nicely, as shown in Figure 4a. The histogram in Figure 4b shows that the budget \u2206V remains between 80 and 105 m/s, with a mean of 91.90 m/s and a standard deviation of 3.38 m/s. In the first orbit, the mean of the error in the estimation remains in the order of hundreds of meters and a few centimeters per second for the position and velocity, respectively, as seen in Figures 4c and 4d. A degradation in the estimation is again seen for the second orbit due to the effects of the second degree and order of the gravity field neglected in the nominal dynamics. However, we again stress that for such an elongated asteroid in this thigh orbit, it is an over-conservative assumption to assume neglected dynamics of that magnitude. It still serves to show the robustness of the approach. The statistics show the bias added to the estimation of \u00b5 for the orbital operation due to J2 and C22 in Figure 4e."
        },
        {
            "heading": "5.4 Different Precision in Onboard Asteroid\u2019s Shape",
            "text": "As discussed in Section 3.2, computationally light algorithms for shape reconstruction are being developed and investigated to be onboard in spacecraft as a substitution for the SPC technique used on the ground, which is computationally demanding and require human intervention. For example, Panicucci [30] was able to reconstruct Bennu\u2019s shape using a silhouette-based algorithm considering a single Bennu rotation. The shape obtained had a mean error of 0.83% and a maximum error of 4.49% [30, p. 79], which is in line with the assumption of \u03c3R = 0.01 made so far. In this case, Panicucci [30] assumes that the state and orientation of the spacecraft relative to the body are already solved. For the case the spacecraft\u2019s state needs to be determined altogether, Panicucci [30, p. 125] applied a SLAM (simultaneous localization and mapping) algorithm and obtained a shape with a mean error of 3.21% and maximum at 12.41%.\nWe run again a Monte Carlo simulation for the asteroid Bennu, considering a \u03c3R = 0.05 (i.e., 5%) to assess the feasibility of using a shape model with considerable error. When trying the same conditions applied in Section 5.3, the filter divergence was so frequent, and at the first measurements after the orbital insertion, that it is not even worth showing here. We then changed the operation to be more amenable by considering 48.5 hours to the Monte Carlo-Lambert guidance insert the spacecraft into orbit, a single orbit of 2 km radii (a bit larger than the first orbit of the OSIRIS-REx mission), and a simulation time of 4 days. The results are shown in Figure 5.\nWithin the 500 samples, the filter diverged in only one after significant errors in the estimation destabilized the control, inducing a frequent control activity, which in turn created a vicious cycle that ultimately led to filter divergence. This case can be checked in Figure 5a by the purple curve standing out from the rest. The budget \u2206V is mostly maintained within 8-12 m/s, with the only exception being an anomalous 16 m/s. The mean errors in position and velocity estimation remained in tens of meters and millimeters per second, respectively. The estimation of \u00b5 was bounded by a 30% error throughout the orbital operations, while the CSRP estimation was mostly kept within 50%.\nThese results show the importance of an accurate asteroid shape in the operation of the spacecraft about asteroids. Although a rough shape, such as within the 5% range here considered, can still allow most of the time a successful operation, it is not advisable. Even for an autonomous spacecraft, operating in close-proximity with a rough shape could only be indicated in marginal cases where promptly obtaining close-proximity data from the asteroid is mandatory."
        },
        {
            "heading": "6 Conclusions",
            "text": "In this work, we give one more step in the collective effort to propose the feasibility of an asteroid autonomous exploration, showing that robust guidance and control laws could allow for the autonomous spacecraft to have a much less conservative approach to the body. This is a paradigm shift from previous studies that still inherited the cautious and conservative approach of current missions that rely on ground intervention. We show that a rapid autonomous exploration of an asteroid is possible within current technology. The operation is based on conservative assumptions, and it can be potentially better with a more realistic simulation, better nominal dynamics, and more meticulous architecture and orbital design."
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors wish to express their appreciation for the support provided by grants # 406841/2016-0 and 301338/2016-7 from the National Council for Scientific and Technological Development (CNPq); grants # 2017/20794-2 and 2016/24561-0 from Sa\u0303o Paulo Research Foundation (FAPESP) and the financial support from the Coordination for the Improvement of Higher Education Personnel (CAPES)."
        }
    ],
    "title": "Autonomous Rapid Exploration in Close-Proximity of an Asteroid",
    "year": 2022
}