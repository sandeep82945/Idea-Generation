{
    "abstractText": "Massive vector field datasets are common in multi-spectral optical and radar sensors, among many other emerging areas of application. In this paper we develop a novel stochastic functional (data) analysis approach for detecting anomalies based on the covariance structure of nominal stochastic behavior across a domain. An optimal vector field Karhunen-Loeve expansion is applied to such random field data. A series of multilevel orthogonal functional subspaces is constructed from the geometry of the domain, adapted from the KL expansion. Detection is achieved by examining the projection of the random field on the multilevel basis. In addition, reliable hypothesis tests are formed that do not require prior assumptions on probability distributions of the data. The method is applied to the important problem of deforestation and degradation in the Amazon forest. This is a complex non-monotonic process, as forests can degrade and recover. Using multi-spectral satellite data from Sentinel-2, the multilevel filter is constructed and anomalies are treated as deviations from the initial state of the forest. Forest anomalies are quantified with robust hypothesis tests. Our approach shows the advantage of using multiple bands of data in a vectorized complex, leading to better anomaly detection beyond the capabilities of scalar-based methods.",
    "authors": [
        {
            "affiliations": [],
            "name": "JULIO E. CASTRILL\u00d3N-CAND\u00c1S"
        },
        {
            "affiliations": [],
            "name": "MARK KON"
        }
    ],
    "id": "SP:84bbd7f8ccc6fdc71842281af2558c81af1aa7ba",
    "references": [
        {
            "authors": [
                "E. Arias-Castro",
                "D. Donoho",
                "X. Huo"
            ],
            "title": "Near-optimal detection of geometric objects by fast multiscale methods",
            "venue": "IEEE Transactions on Information Theory, 51:2402",
            "year": 2005
        },
        {
            "authors": [
                "Ery Arias-Castro",
                "Rui M. Castro",
                "Ervin T\u00e1nczos",
                "Meng Wang"
            ],
            "title": "Distribution-free detection of structured anomalies: Permutation and rank-based scans",
            "venue": "Journal of the American Statistical Association,",
            "year": 2018
        },
        {
            "authors": [
                "A. Aue",
                "S. H\u00f6rmann",
                "L. Horv\u00e1th",
                "M. Hu\u015dkov\u00e1"
            ],
            "title": "and J",
            "venue": "G. Steinebach. Sequential testing for the stability of high-frequency portfolio betas,. Econometric Theory, 28:804",
            "year": 2012
        },
        {
            "authors": [
                "A. Aue",
                "L. Horv\u00e1th"
            ],
            "title": "Structural breaks in time series",
            "venue": "Journal of Time Series Analysis, 34:1",
            "year": 2013
        },
        {
            "authors": [
                "Matheus HC Barboza",
                "Ricardo de S Alencar",
                "Julio C Chaves",
                "Moacyr AHB Silva",
                "Romulo D Orrico",
                "Alexandre G Evsukoff"
            ],
            "title": "Identifying human mobility patterns in the rio de janeiro metropolitan area using call detail records",
            "venue": "Transportation Research Record,",
            "year": 2020
        },
        {
            "authors": [
                "J.E. Castrill\u00f3n-Cand\u00e1s",
                "K. Amaratunga"
            ],
            "title": "Fast estimation of continuous karhunen-loeve eigenfunctions using wavelets",
            "venue": "IEEE Transactions on Signal Processing, 50(1):78\u201386",
            "year": 2002
        },
        {
            "authors": [
                "J.E. Castrill\u00f3n-Cand\u00e1s",
                "Kevin Amaratunga"
            ],
            "title": "Spatially adapted multiwavelets and sparse representation of integral equations on general geometries",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2003
        },
        {
            "authors": [
                "J.E. Castrill\u00f3n-Cand\u00e1s",
                "M.G. Genton",
                "R. Yokota"
            ],
            "title": "Multi-level restricted maximum likelihood covariance estimation and Kriging for large non-gridded spatial datasets",
            "venue": "Spatial Statistics, 18, Part A:105 \u2013 124",
            "year": 2016
        },
        {
            "authors": [
                "Julio E. Castrill\u00f3n-Cand\u00e1s",
                "Mark Kon"
            ],
            "title": "Anomaly detection: A functional analysis perspective",
            "venue": "Journal of Multivariate Analysis,",
            "year": 2022
        },
        {
            "authors": [
                "Julio Enrique Castrill\u00f3n-Cand\u00e1s",
                "Dingning Liu",
                "Mark Kon"
            ],
            "title": "Stochastic functional analysis with applications to robust machine learning, 2021",
            "year": 2021
        },
        {
            "authors": [
                "F Stuart Chapin Iii",
                "Erika S Zavaleta",
                "Valerie T Eviner",
                "Rosamond L Naylor",
                "Peter M Vitousek",
                "Heather L Reynolds",
                "David U Hooper",
                "Sandra Lavorel",
                "Osvaldo E Sala",
                "Sarah E Hobbie"
            ],
            "title": "Consequences of changing biodiversity",
            "venue": "Nature, 405(6783):234\u2013242,",
            "year": 2000
        },
        {
            "authors": [
                "Yimin Chen",
                "Xiaoping Liu",
                "Xia Li",
                "Xingjian Liu",
                "Yao Yao",
                "Guohua Hu",
                "Xiaocong Xu",
                "Fengsong Pei"
            ],
            "title": "Delineating urban functional areas with building-level social media data: A dynamic time warping (dtw) distance based k-medoids method",
            "venue": "Landscape and Urban Planning,",
            "year": 2017
        },
        {
            "authors": [
                "Y.T.D. Cheung",
                "M.J. Spittal",
                "M.K. Williamson",
                "S.J. Tung",
                "J. Pirkis"
            ],
            "title": "Application of scan statistics to detect suicide clusters in australia",
            "venue": "PLoS ONE, 8:e54168",
            "year": 2013
        },
        {
            "authors": [
                "C.-S.J. Chu",
                "M. Stinchcombe",
                "H. White"
            ],
            "title": "Monitoring structural change",
            "venue": "Econometrica, 64:1045",
            "year": 1996
        },
        {
            "authors": [
                "S. Dasgupta",
                "Y. Freund"
            ],
            "title": "Random projection trees and low dimensional manifolds",
            "venue": "Proceedings of the Fortieth Annual ACM Symposium on Theory of Computing, STOC \u201908, pages 537\u2013546, New York, NY, USA",
            "year": 2008
        },
        {
            "authors": [
                "H. Dette",
                "J G\u00f6smann"
            ],
            "title": "A likelihood ratio approach to sequential change point detection for a general class of parameters",
            "venue": "Journal of the American Statistical Association, 115(531):1361\u2013 1377",
            "year": 2020
        },
        {
            "authors": [
                "S. D\u2019Heedene",
                "K. Amaratunga",
                "J. Castrill\u00f3n-Cand\u00e1s"
            ],
            "title": "Generalized hierarchical bases: a wavelet-ritz-galerkin framework for lagrangian fem",
            "venue": "Engineering Computations,",
            "year": 2005
        },
        {
            "authors": [
                "M. Drusch",
                "U. Del Bello",
                "S. Carlier",
                "O. Colin",
                "V. Fernandez",
                "F. Gascon",
                "B. Hoersch",
                "C. Isola",
                "P. Laberinti",
                "P. Martimort",
                "A. Meygret",
                "F. Spoto",
                "O. Sy",
                "F. Marchese",
                "P. Bargellini"
            ],
            "title": "Sentinel-2: Esa\u2019s optical high-resolution mission for gmes operational services",
            "venue": "Remote Sensing of Environment, 120:25\u201336",
            "year": 2012
        },
        {
            "authors": [
                "S. Fremdt"
            ],
            "title": "Page\u2019s sequential procedure for change-point detection in time series regression",
            "venue": "Statistics, 48:1",
            "year": 2014
        },
        {
            "authors": [
                "G. Walther"
            ],
            "title": "Optimal and fast detection of spatial clusters with scan statistics",
            "venue": "The Annals of Statistics,",
            "year": 2010
        },
        {
            "authors": [
                "M. Guerriero",
                "P. Willett",
                "J. Glaz"
            ],
            "title": "Distributed target detection in sensor networks using scan statistics",
            "venue": "IEEE Transactions on Signal Processing, 57:2629",
            "year": 2009
        },
        {
            "authors": [
                "Jingqiu Guo",
                "Yangzexi Liu",
                "Qingyan Yang",
                "Yibing Wang",
                "Shouen Fang"
            ],
            "title": "Gps-based citywide traffic congestion forecasting using cnn-rnn and c3d hybrid model",
            "venue": "Transportmetrica A: Transport Science,",
            "year": 2020
        },
        {
            "authors": [
                "H. Harbrecht",
                "M. Peters",
                "M. Siebenmorgen"
            ],
            "title": "Analysis of the domain mapping method for elliptic diffusion problems on random domains",
            "venue": "Numerische Mathematik, 134(4):823\u2013856",
            "year": 2016
        },
        {
            "authors": [
                "Samiul Hasan",
                "Christian M Schneider",
                "Satish V Ukkusuri",
                "Marta C Gonz\u00e1lez"
            ],
            "title": "Spatiotemporal patterns of urban human mobility",
            "venue": "Journal of Statistical Physics,",
            "year": 2013
        },
        {
            "authors": [
                "D.V. Hinkley"
            ],
            "title": "Inference about the change-point from cumulative sum tests",
            "venue": "Biometrika, 58:509",
            "year": 1971
        },
        {
            "authors": [
                "L. Horv\u00e1th",
                "M. Hu\u015dkov\u00e1",
                "P. Kokoszka",
                "J. Steinebach"
            ],
            "title": "Monitoring changes in linear models",
            "venue": "Journal of Statistical Planning and Inference, 126:225",
            "year": 2004
        },
        {
            "authors": [
                "A. Huete",
                "K. Didan",
                "T. Miura",
                "E.P. Rodriguez",
                "X. Gao",
                "L.G. Ferreira"
            ],
            "title": "Overview of the radiometric and biophysical performance of the modis vegetation indices",
            "venue": "Remote Sensing of Environment, 83",
            "year": 2002
        },
        {
            "authors": [
                "V. Jandhyala",
                "S. Fotopoulos",
                "I. MacNeill",
                "P. Liu"
            ],
            "title": "Inference for single and multiple changepoints in time series",
            "venue": "Journal of Time Series Analysis, 34:423",
            "year": 2013
        },
        {
            "authors": [
                "C. Kirch",
                "S. Weber"
            ],
            "title": "Modified sequential change point procedures based on estimating functions",
            "venue": "Electronic Journal of Statistics, 12:1579",
            "year": 2018
        },
        {
            "authors": [
                "T.L. Lai"
            ],
            "title": "Sequential changepoint detection in quality control and dynamical systems",
            "venue": "Journal of the Royal Statistical Society, Series B, 57:613",
            "year": 1995
        },
        {
            "authors": [
                "Anukool Lakhina",
                "Mark Crovella",
                "Christophe Diot"
            ],
            "title": "Diagnosing network-wide traffic anomalies",
            "venue": "SIGCOMM Comput. Commun. Rev.,",
            "year": 2004
        },
        {
            "authors": [
                "W.A. Light",
                "E.W. Cheney"
            ],
            "title": "Approximation theory in tensor product spaces., volume 1169 of Lecture notes in mathematics",
            "year": 1985
        },
        {
            "authors": [
                "M. Kulldorff"
            ],
            "title": "A spatial scan statistic",
            "venue": "Communications in Statistics: Theory and Methods,",
            "year": 1997
        },
        {
            "authors": [
                "G.V. Moustakides"
            ],
            "title": "Optimal stopping times for detecting changes in distributions",
            "venue": "The Annals of Statistics, 14:1379",
            "year": 1986
        },
        {
            "authors": [
                "D.B. Neil",
                "A.W. Moore"
            ],
            "title": "Rapid detection of significant spatial clusters",
            "venue": "Proceedings of the Tenth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, page 256",
            "year": 2004
        },
        {
            "authors": [
                "D.B. Neill"
            ],
            "title": "Fast subset scan for spatial pattern detection",
            "venue": "Journal of the Royal Statistical Society, 74:337",
            "year": 2012
        },
        {
            "authors": [
                "E.S. Page"
            ],
            "title": "Continuous inspection schemes",
            "venue": "Biometrika, 41:100",
            "year": 1954
        },
        {
            "authors": [
                "K. Pape",
                "D. Wied",
                "P. Galeano"
            ],
            "title": "Monitoring multivariate variance changes",
            "venue": "Journal of Empirical Finance, 39:54",
            "year": 2016
        },
        {
            "authors": [
                "Anand Paul",
                "Awais Ahmad",
                "M Mazhar Rathore",
                "Sohail Jabbar"
            ],
            "title": "Smartbuddy: defining human behaviors using big data analytics in social internet of things",
            "venue": "IEEE Wireless communications,",
            "year": 2016
        },
        {
            "authors": [
                "Zhenghong Peng",
                "Ru Wang",
                "Lingbo Liu",
                "Hao Wu"
            ],
            "title": "Exploring urban spatial features of covid-19 transmission in wuhan based on social media data",
            "venue": "ISPRS International Journal of Geo-Information,",
            "year": 2020
        },
        {
            "authors": [
                "Natasha Petrovska",
                "Aleksandar Stevanovic"
            ],
            "title": "Traffic congestion analysis visualisation tool",
            "venue": "IEEE 18th International Conference on Intelligent Transportation Systems,",
            "year": 2015
        },
        {
            "authors": [
                "M Reed",
                "B Simon"
            ],
            "title": "Methods of modern mathematical physics 1: Functional Analysis",
            "venue": "Academic Press, New York, New York",
            "year": 1972
        },
        {
            "authors": [
                "Orit Rotem-Mindali",
                "Yaron Michael",
                "David Helman",
                "Itamar M Lensky"
            ],
            "title": "The role of local land-use on the urban heat island effect of tel aviv as assessed from satellite remote sensing",
            "venue": "Applied Geography,",
            "year": 2015
        },
        {
            "authors": [
                "D.P. Roy",
                "M.A. Wulder",
                "T.R. Loveland",
                "Woodcock C.E",
                "R.G. Allen",
                "M.C. Anderson",
                "D. Helder",
                "J.R. Irons",
                "D.M. Johnson",
                "R. Kennedy",
                "T.A. Scambos",
                "C.B. Schaaf",
                "J.R. Schott",
                "Y. Sheng",
                "E.F. Vermote",
                "A.S. Belward",
                "R. Bindschadler",
                "W.B. Cohen",
                "F. Gao",
                "J.D. Hipple",
                "P. Hostert",
                "J. Huntington",
                "C.O. Justice",
                "A. Kilic",
                "V. Kovalskyy",
                "Z.P. Lee",
                "L. Lymburner",
                "J.G. Masek",
                "J. McCorkel",
                "Y. Shuai",
                "R. Trezza",
                "J. Vogelmann",
                "R.H. Wynne",
                "Z. Zhu"
            ],
            "title": "Landsat-8: Science and product vision for terrestrial global change research",
            "venue": "Remote Sensing of Environment,",
            "year": 2014
        },
        {
            "authors": [
                "Osvaldo E Sala",
                "FIII Stuart Chapin",
                "Juan J Armesto",
                "Eric Berlow",
                "Janine Bloomfield",
                "Rodolfo Dirzo",
                "Elisabeth Huber-Sanwald",
                "Laura F Huenneke",
                "Robert B Jackson",
                "Ann Kinzig"
            ],
            "title": "Global biodiversity scenarios for the year",
            "year": 2000
        },
        {
            "authors": [
                "C. Schwab",
                "R.A. Todor"
            ],
            "title": "Karhunen\u2013Lo\u00e8ve approximation of random fields by generalized fast multipole methods",
            "venue": "Journal of Computational Physics, 217(1):100 \u2013 122",
            "year": 2006
        },
        {
            "authors": [
                "X. Shao"
            ],
            "title": "Self-normalization for time series: A review of recent developments",
            "venue": "Journal of the American Statistical Association, 110:1797",
            "year": 2015
        },
        {
            "authors": [
                "X. Shao",
                "X. Zhang"
            ],
            "title": "Testing for change points in time series",
            "venue": "Journal of the American Statistical Association, 105:1228",
            "year": 2010
        },
        {
            "authors": [
                "Shih-Lung Shaw",
                "Daniel Sui"
            ],
            "title": "Introduction: Human dynamics in perspective",
            "year": 2018
        },
        {
            "authors": [
                "L David"
            ],
            "title": "Skole. Data on global land-cover change: acquisition, assessment and analysis. Changes in land use and land cover: a global perspective",
            "year": 1994
        },
        {
            "authors": [
                "J. Tausch",
                "J. White"
            ],
            "title": "Multiscale bases for the sparse representation of boundary integral operators on complex geometry",
            "venue": "SIAM Journal on Scientific Computing, 24(5):1610\u20131629",
            "year": 2003
        },
        {
            "authors": [
                "D. Wied",
                "P. Galeano"
            ],
            "title": "Monitoring correlation change in a sequence of random variables",
            "venue": "Journal of Statistical Planning and Inference, 143:186",
            "year": 2013
        },
        {
            "authors": [
                "Donald J Wuebbles",
                "David W Fahey",
                "Kathy A Hibbard"
            ],
            "title": "Climate science special report: fourth national climate assessment, volume",
            "year": 2017
        },
        {
            "authors": [
                "Jason Y Zhang",
                "Panna Felsen",
                "Angjoo Kanazawa",
                "Jitendra Malik"
            ],
            "title": "Predicting 3d human dynamics from video",
            "venue": "In Proceedings of the IEEE/CVF International Conference on Computer Vision,",
            "year": 2019
        },
        {
            "authors": [
                "T. Zhang",
                "L. Lavitas"
            ],
            "title": "Unsupervised self-normalized change-point testing for time series",
            "venue": "Journal of the American Statistical Association, 113:637",
            "year": 2018
        },
        {
            "authors": [
                "Zhe Zhu",
                "Curtis E. Woodcock"
            ],
            "title": "Object-based cloud and cloud shadow detection in landsat imagery",
            "venue": "Remote Sensing of Environment,",
            "year": 2012
        }
    ],
    "sections": [
        {
            "heading": "1. Introduction",
            "text": "The development of ever more massive datasets, concurrent with advances in artificial intelligence and machine learning, are transforming many aspects of society in extensive ways. Remote sensing and GIS data over various temporal and spatial resolutions provide foundational data for addressing issues within many of the facets of human dynamics [50]. Increasingly, Wi-Fi and GPS tracking via cell phones enable us to gather data at high spatio-temporal resolutions at low cost, providing realtime solutions for dynamic traffic management and accident prevention [42, 22]. Geotagged social media and direct locational information have provided ways of classifying functional characteristics of urban locations [12, 24]. Analysis of information from daily mobility patterns [5], IoT sensors [40], satellites [44] and drones [56], provide extensive data for systematic study of human dynamics in migration, disease outbreaks [41], and threat outbreaks. Many methods have been developed to detect and identify anomalies. In particular, for syndromic surveillance and signal processing the scan statistics approach has been widely used [2, 33, 13, 21, 36, 1, 20, 37]. In [31] the authors develop an approach to detect network anomalies based on residual spaces of a Principal Component Analysis. This approach is related to our method developed in this paper.\nIn this paper we develop a framework to detect anomalies in random vector fields based on stochastic functional analysis. This approach was recently introduced in [9] for scalar data and is here based on optimal vector field Karhuen-Loe\u0301ve (KL) tensor product expansions, and the construction of multilevel functional spaces for the detection of anomalies. In particular, it is well suited for vector field data over complex geometrical domains (or networks) arising from the measurement of different modalities from the same objects, including satellite data with multiple spectral bands. Using KL expansions, this approach allows detection within large classes of random vector fields. The nested multilevel spaces are natively adapted to tensor product expansions. Their\n\u2021 Department of Mathematics and Statistics, Boston University, Boston, MA E-mail address: jcandas@bu.edu, mkon@bu.edu.\n1\nar X\niv :2\n20 7.\n06 22\n9v 2\n[ st\nat .M\nL ]\n5 O\nct 2\n02 2\nconstruction is elaborate and has been used elsewhere in the context of solving Partial Differential Equations. This approach has the following features:\n\u2022 Detection of anomalous global and local signals described as scalar or vectorial random fields. \u2022 Construction of reliable hypothesis tests with controllable distributions that do not require\nassumptions on the distribution of the data (important). \u2022 Stochastic fusion of the anomalies in multimodal vector field data without any loss of\ninformation. This represents an optimal fusion of the scalar components of the vectorized data. \u2022 Resulting native integration of multiple modalities with no loss of discriminatory power. \u2022 Quantification of magnitudes of the anomalies defined on a suitable Bochner normed space. \u2022 Adaptability of vector field signal domains to be defined on complex topologies. This\nincludes geospatial, spatio-temporal, manifold and network topologies, among others. \u2022 Multilevel filters can process large quantities of data with near-optimal performance. \u2022 Augmentation of current statistical methods such as change point detection [4, 28, 38, 25,\n35, 30, 14, 26, 19, 3, 53, 29, 39, 16, 49, 48, 57]. \u2022 Applicability of the theory and code to existing Machine Learning problems, leading to\nsignificant increases to accuracy in their solutions. [10]. \u2022 A fully non-parametric probabilistic framework, in particular without any Gaussian as-\nsumptions.\nWe introduce a novel application of this framework in the context of a major environmental problem, deforestation in the Amazon rain forest. Proper detection of deforestation and forest degradation events can lead to quantification and potential mitigation of resulting effects on climate. Climate change is understood to be driven by unmitigated anthropogenic emissions of greenhouse gases into the atmosphere, primarily of carbon dioxide from combustion of fossil fuels and deforestation. Effects of climate change are being witnessed now, are believed to be irreversible on the timescale of human lifespan, and are projected to increase in the decades to come [55]. Additionally, deforestation has been identified as a factor of greater significance than climate change alone [51], and in fact as the single most important variable affecting ecological systems [11] and the most significant threat to biodiversity [46].\nSatellite remote sensing is often the only viable means for gathering deforestation information, but numerous problems hinder effective collection of information. Among the technical problems are persistent and unpredictable cloud cover in deforestation hot-spots, which complicates automated processing of very accessible optical satellite data.\nOur mathematical framework is well suited to detecting changes on land surfaces in optical modalities. An application of the multilevel anomaly filter to such data (e.g., collected by the Sentinel-2 satellite) recording Amazon forest degradation is illustrated in Figures 4 and 9. This example illustrates the complexity of detecting such degradation: the logging of the forest in Figure 4 on day 3484 does not change the actual level of land cover remaining as forest. Further, the forest does not stay in a degraded state, but is then allowed to recover. Note that both the initial degradation event (driven by selective logging) and the subsequent recovery can be detected by the filter. Also note that the anomaly introduced by imperfect cloud masking at day 3909 is easy to detect as fictitious due to its contrast with temporal behavior of forest degradation. In this example the filter operates on a time series of 71 Sentinel-2 images in an area covered by 150\u00d7 150 ten meter pixels. More specifically, starting from day 1 to day 3200, the covariance structure and multilevel anomaly filter were built from measurements based on the Enhanced Vegetation Index (EVI), from satellite data. The multilevel filter is then applied to each of the 71 Sentinel-2 images starting from day 3300, and an anomaly map is constructed from our KL approach. Figure 9 illustrates the tracking of the forest degradation anomaly, in this case at pixel (66,108). Our work\nhere augments this approach to vector field data, i.e. structured multiple features. The detection framework thus extends multiple satellite detection modalities (e.g., multi-spectral data) allowing augmented coordinated detection over scalar modalities, e.g., in EVI data (See Figure 11). The deforestation and degradation detection problem can thus be framed in a precisely stated and much more general mathematical framework, using high dimensional probabilistic constructions."
        },
        {
            "heading": "2. Vector field Karhunen Loe\u0300ve",
            "text": "The Karhunen-Loe\u0300ve expansion is an important methodology that represents random fields in terms of spatial-stochastic tensor expansions. It has been shown to be optimal in several ways, making it attractive for analysis of random fields. We are interested in data that can be modeled as random vector fields, for example satellite sensors with multiple spectral bands forming naturally vectorized data, among many such examples. In this section the mathematical background for the vector field KL expansion is introduced.\nLet U be a domain of Rd, d \u2208 N, and (\u2126,F ,P) be a complete probability space, with a set of outcomes \u2126, and F a \u03c3-algebra of events equipped with the probability measure P. Let L2(U ;Rq) be the space of all square integrable functions v : U \u2192 Rq equipped with the standard inner product (u,v) = \u222b U u\nTv dx, for all u,v \u2208 L2(U ;Rq), where v(x) = [v1(x), . . . , vq(x)]T and vi \u2208 L2(U) := L2(U ;R) for i = 1, . . . , q.\nTaking uncertainty into account, suppose that the data can be described as random vector field v : \u2126 \u2192 L2(U ;Rq), where v(x, \u03c9) = [v1(x, \u03c9), . . . , vd(x, \u03c9)]T, x \u2208 U , \u03c9 \u2208 \u2126, and vi(x, \u00b7) \u2208 L2(\u2126) for i = 1, . . . , q. Note that from context it will be clear when v(x) and v(x, \u03c9) is referenced. Let L2P(\u2126;L\n2(U ;Rq)) be the space of all strongly measurable functions v : \u2126 \u2192 L2(U ;Rq) equipped with the inner product[ (u,v)L2P(\u2126;L2(U))\n= \u222b\n\u2126(u,v) dP, for all u,v \u2208 L 2 P(\u2126;L 2(U ;Rd)). Definition 2.1.\n(a) Suppose v \u2208 L2P(\u2126;L2(U ;Rq)), and denote E [v] := [E [v1] , . . . ,E [vq]] as the mean of v(x, \u03c9), where E [vi] := \u222b \u2126 vi(x, \u03c9) dP, for i = 1, . . . , q. (b) For all v \u2208 L2P(\u2126;L2(U ;Rq)) let Cov(vi(x, \u03c9), vj(y, \u03c9)) := E[(vi(x, \u03c9)\u2212E [vi(x, \u03c9)]) (vj(y, \u03c9) \u2212E [vj(y, \u03c9)])] for i, j = 1, . . . , q, and denote the matrix-valued covariance function of v as Cov(v(x),v(y)) := Cov(v1(x, \u03c9), v1(y, \u03c9)) Cov(v1(x, \u03c9), v2(y, \u03c9)) . . . Cov(v1(x, \u03c9), vq(y, \u03c9)) Cov(v2(x, \u03c9), v1(y, \u03c9)) Cov(v2(x, \u03c9), v2(y, \u03c9)) . . . Cov(v1(x, \u03c9), vq(y, \u03c9)) ... ... . . . ...\nCov(vq(x, \u03c9), v1(y, \u03c9)) Cov(vq(x, \u03c9), v2(y, \u03c9)) . . . Cov(vq(x, \u03c9), vq(y, \u03c9))  . From the properties of Bochner integrals (see [32, 23]) we have that E [v(x, \u03c9)] \u2208 L2(U ;Rq) and that the covariance function Cov(vi(x, \u03c9), vj(y, \u03c9)) \u2208 L2(U \u00d7 U) for all i, j = 1, . . . q. Thus Cov(v(x, \u03c9),v(y, \u03c9)) \u2208 L2(U \u00d7 U ;Rq\u00d7q), where the space L2(U \u00d7 U ;Rq\u00d7q) is equipped with the inner product\n(A,B)L2(U\u00d7U ;Rq\u00d7q) := \u222b U \u222b U 1TA(x,y) \u2022B(x,y)1 dxdy\nfor all A,B \u2208 L2(U \u00d7U ;Rq\u00d7q), where 1 is a q dimensional vector with all entries equal to one and A \u2022B corresponds to the Hadamard product of A and B.\nAlthough Karhunen-Loe\u0300ve expansions are well understood for the scalar case, rigorous proofs and studies of optimality properties for the vector field case have been somewhat sparse. Despite the popularity of the KL expansion and its multiple references, a rigorous existence and optimality proof for the vector field case could not be found except for the detailed analysis in [47], in the context of tensor products. Suppose that H,S are separable Hilbert spaces with the inner products (\u00b7, \u00b7)H and (\u00b7, \u00b7)S respectively. Any element f \u2208 H \u2297 S can be written as a convergent series of the form f = \u2211 k\u2208N fk \u2297 sk with the associated correlation Cf := \u2211 k\u2208N fk \u2297 fk. From Theorem 2.3 in\n[47] there is a one-to-one correspondence between Cf and positive definite trace class operators in Cf in H. From the spectral expansion of Cf , Theorems 2.5 and 2.7 then show the existence of the KL expansion and the corresponding optimality properties. Remark. To apply these theorems we set H := L2(U ;Rq) and S := L2P(\u2126). However, we need to clearly show what is meant by the tensor product spaces L2(U ;Rq) \u2297 L2P(\u2126) and L2(U ;Rq) \u2297 L2(U ;Rq). The proofs for Propositions 2.2, 2.3 and 2.4 are based on the arguments given in Chapter II.4 from [43] and extended to the vector field case. The proofs are contained in the Appendix. Proposition 2.2. Let {vk}k\u2208N be a complete orthonormal basis of L2(U ;Rq). Then {vk(x)vl(y)T}k,l\u2208N is a complete orthonormal basis for L2(U \u00d7 U ;Rq\u00d7q). Proposition 2.3. L2(U ;Rq)\u2297 L2(U ;Rq) is isomorphic to L2(U \u00d7 U ;Rq\u00d7q). Proposition 2.4. L2(U ;Rq)\u2297 L2P(\u2126) is isomorphic to L2P(\u2126;L2(U ;Rq)).\nConsider the operator Cv(u)(x) := \u222b U Cov(v(x, \u03c9), v(y, \u03c9))u(y) dy\nfor all u \u2208 L2(U ;Rq). From Lemma 2 in [23] operator Cv : L2(U ;Rq) \u2192 L2(U ;Rq) is a nonnegative symmetric, trace class operator. From Theorem 1 in [23] there exists an orthonormal set of eigenfunctions {\u03c6k}k\u2208N, where \u03c6k \u2208 L2(U ;Rq), and eigenvalues \u03bb1 \u2265 \u03bb2 \u2265 \u00b7 \u00b7 \u00b7 \u2265 0 such that Cv\u03c6k = \u03bbk\u03c6k for all k \u2208 N. Furthermore, for any u \u2208 L2(U ;Rq) we have that Cv(u) =\u2211\nk\u2208N \u03bbk(u,\u03c6k)L2(U ;Rq)\u03c6k. Since Cv is a trace class operator (e.g. \u2211 k\u2208N \u03bbk <\u221e), from the argument given in Theorem 2.3\nin [47] the series \u2211\nk\u2208N \u03bb 1 2 k\u03c6k \u2297 sk converges to an element f \u2208 L\n2(U ;Rq)\u2297 L2(\u2126), where {sk}k\u2208N is a complete orthonormal basis for L2P(\u2126), and Cf = \u2211 k\u2208N \u03bbk\u03c6k \u2297 \u03c6k. Now let\nCv := \u2211 k\u2208N \u03bbk\u03c6k\u03c6 T k .\nFrom Proposition 2.3 and the identity (Cvu,w)H = (Cf ,u\u2297w)H\u2297H , for all u,w \u2208 H := L2(U ;Rq) we have (Cvu,w)H = (Cv,uwT)L2(U\u00d7U ;Rq\u00d7q). Since {vkvTl }k,l\u2208N is a complete orthonormal basis for L2(U \u00d7U ;Rq\u00d7q) we conclude that Cov(\u00b7, \u00b7) = Cv almost everywhere. From Proposition 2.4 and Theorem 2.5 [47] the KL expansion for the vector field data is obtained: Theorem 2.5. Suppose v \u2208 L2P(\u2126;L2(U ;Rq)) then\nv(x, \u03c9) = E [v(x, \u03c9)] + \u2211 k\u2208N \u03bb 1 2 k\u03c6k(x)Yk(\u03c9),\nwhere Yk(\u03c9) = 1\u221a \u03bbk \u222b U (v(x, \u03c9)\u2212E [v(x, \u03c9)])\nT\u03c6k(x) dx, E [YkYl] = \u03b4kl and E [Yk] = 0 for all k, l \u2208 N. The KL expansion has the useful property of being optimal in the set of all product expansions. Suppose that HM \u2282 L2(U) is a finite dimensional subspace of L2(U) such that dimHM = M and PHM\u2297L2P(\u2126)\n: L2(U ;Rq) \u2297 L2P(\u2126) \u2192 HM \u2297 L2P(\u2126) is an orthogonal projection operator. Suppose v \u2208 L2(U ;Rq)\u2297 L2P(\u2126), with E [v] = 0, then from Theorem 2.7 in [47]\ninf HM \u2282 L2(U ;Rq)\ndimHM = M\n\u2016v \u2212 PHM\u2297L2P(\u2126)v\u2016L2P(\u2126)\u2297L2(U) =  \u2211 k\u2265M+1 \u03bbk  12\nwhere the infimum is achieved only when HM = span{\u03c61, . . . ,\u03c6M}. Remark. In practice the KL expansion of a random field is intractable for even a modest number of terms. Estimating the joint distribution of Y1, . . . , YM requires massive amounts of data due to the high dimensionality. Only under certain conditions, such as for Gaussian processes, can the random variables Y1, . . . , YM be explicitly known (and shown to be independent). However, for the\nanomaly filter built in this paper, the joint distribution of Y1, . . . , YM is not required. Furthermore, for the hypothesis test derived in section 3 only the eigenpairs (\u03bbk, \u03c6k) for k = 1, . . . ,M are needed. This makes for a significantly easier problem whose quantities can be estimated in practice from realizations of the random field v(x, \u03c9) \u2208 L2P(\u2126;L2(U ;Rq)) using the method of snapshots [6]."
        },
        {
            "heading": "3. Anomaly detection and multilevel orthogonal eigenspaces",
            "text": "The KL expansion provides a mechanism to represent a vector valued random field v(x, \u03c9) in terms of optimal approximations based on the firstM terms: vM (x, \u03c9)\u2212E [v] = \u2211M k=1 \u03bb 1 2 k \u03c6k(x)Yk(\u03c9). In the rest of the discussion, without loss of generality, it is assumed that E [v] = 0. Suppose that u(x, \u03c9) is an observable random field and assume that the model is given by u(x, \u03c9) = vM (x, \u03c9) + w(x, \u03c9). Given knowledge of the eigenstructure of vM (x, \u03c9) and the observations u(x, \u03c9), the goal is detection of the anomalous process w(x, \u03c9) and its quantification with respect to a suitable norm. Detection is achieved by the construction of multilevel spaces that are adapted to local and global components of {\u03c61, . . . , \u03c6M}. Assumption 3.1. We let V0 := span{\u03c61, \u03c62, . . . , \u03c6M} and V0 \u2282 V1 \u00b7 \u00b7 \u00b7 \u2282 L2(U ;Rq) be a sequence of nested subspaces in L2(U ;Rq) such that \u22c3 k\u2208N0 Vk = L\n2(U ;Rq). Furthermore, for all k \u2208 N, we let Wk \u2282 L2(U ;Rq) be a subspace such that Vk+1 = Vk \u2295Wk, where \u2295 is the direct sum, so that V0 \u2295\nk\u2208N0 Wk = L 2(U ;Rq).\nAlthough the definition of these spaces is relatively simple, the construction is elaborate with heavy notation and based on differential operator-adapted multilevel methods from scientific computing and computational applied mathematics, for solution of Partial Differential Equations [17, 7]. The details of construction of these multilevel spaces for random fields on complex geometries can be found our recent publication [9] for the scalar case. Here we extend this optimal decomposition to multidimensional vector fields.\nWe will assume that U can be decomposed into simplicies, which can be thought as generalizations of triangulations to arbitrary dimensions. This allows complex geometric shapes to be simply approximated. First we give some definitions. Definition 3.2. A k-simplex is defined to be a convex hull of vertices z0, z1, . . . , zk \u2208 Rk that are affinely independent. Definition 3.3.\ni) We denote xi to be the barycenters of simplices \u03c4i \u2208 T and define S := {x1, . . . ,xN}. ii) The face of a k-simplex is the convex hull of any m + 1 subset of the points that define a\nk-simplex. Definition 3.4. Suppose that T is a collection of simplicies in Rd. Then T is a k-simplicial complex if the following properties are satisfied:\ni) Every face of a simplex in T is also in T . ii) The non-empty intersection of any two simplicies \u03c41, \u03c42 \u2208 T is a face of both \u03c41 and \u03c42. iii) The highest dimension of any simplex in T is k \u2264 d.\nThe following assumption allows us to construct complex geometrical shapes from the k-simplicies and define a space of functions Vn+1 on them that approximates the vector field v(x, \u03c9). In Figure 1 an example of triangulation of a surface constructed from 2-simplicies (triangles) is shown. Assumption 3.5.\ni) U = \u222a\u03c4i\u2208S\u03c4i, where S is a subset of T and contains N simplicies of order k. ii) For any simplex \u03c4i \u2208 S and j = 1, . . . , q let \u03c7ji := c j i [0, . . . , 0, 1 j \u03c4i , 0, . . . , 0], where \u03c7 j i \u2208 L2(U ;\nRq) and 1j\u03c4i corresponds to the indicator function at the jth entry in the vector \u03c7 j i on the simplex \u03c4i. iii) The coefficients cji for i = 1, . . . , N and j = 1, . . . , q are chosen such that collection of\nfunctions \u03c7ji , E := {{\u03c7 j i}Ni=1} q j=1, forms an orthonormal set in L 2(U ;Rq).\niv) Let Vn+1 = P(E) := span{\u03c7li}. We assume that Karhunen-Loe\u0300ve eigenfunctions \u03c6i \u2208 P(E) for all i = 1, . . . ,M where N > M .\nFrom the set of of indicator functions in E , a multilevel basis representation can be constructed that is adapted to the geometry of the domain U and the eigenfunctions {\u03c61, \u03c62, . . . , \u03c6M}. This will allow detection of signals in the vector field in a local and global sense. The algorithm to construct a multilevel basis for the scalar case is described in detail in [9]. The extension of this basis to the vector field case can be essentially obtained by replacing the L2(U) inner product with that in L2(U ;Rq).\nFor the sake of completeness the algorithm building the binary tree is described here in detail. We will then show how the multilevel basis is constructed for vector field data. A binary tree is constructed to locate efficiently the simplicies in S at different levels of resolution. Furthermore the binary tree will serve as a base to construct and locate the multilevel basis functions of the spaces Wk for k = 0, . . . , n\u22121. The domain U is initially assumed to be embedded in a square cell of unit length. For N this can be easily done with a rescaling. We follow that procedure described in [15] for the construction of a kd-tree type decomposition. Other options include Random Projection (RP) trees, which can be found in [15].\nSuppose that all the barycenters x \u2208 S are embedded in the cell the root cell B0root(or B00) \u2282 Rd, which corresponds to the top of the binary tree. Without loss of generality it can be assumed that B0root = [0, 1]\nd and S \u2282 B0root. Now, the root cell is subdivided according to the rule in Algorithm 2 in Figure 2, thus forming two new cells B1left and B 1 right at level 1. In general for any cell B l k at level l and index k the collection of barycenters S\u0303 = {xj |xj \u2208 Blk} is subdivided as follows by using the following rule [15] (Algorithm 2 in Figure 2):\n(a) Suppose vi is the unit vector in the axis coordinate direction for i = 1, . . . , q. (b) For each coordinate direction i = 1, . . . , q project every barycenter xi \u2208 S\u0303 onto the unit vector vi\n(c) Compute the sample variance of these projection coefficients for each coordinate unit vector vi. (d) Choose the unit coordinate vector vi in the direction 1 \u2264 j \u2264 d with the maximal sample variance for the above projection coefficients. (e) Compute the median of the projections along v and split the cell in two parts (Bl\u22121left and\nBl\u22121right) at this coordinate position.\nBy applying Algorithm 1 we obtain a tree structure T , which contains all the cells Blk at each level of resolution l = 0, . . . , n for every level l and associated index k. Furthermore, let B be the collection of all the non-empty cells B in the tree T and Bl := {Bjm \u2208 B | j = l}. From the tree structure T and the set E the multilevel basis adapted to the vector field KL expansion can be constructed.\nWe first show how to construct the multilevel basis functions at the finest level n (or leaf). Suppose that Bnk \u2208 Bn, and after reordering of the numbering of the barycenters suppose that {x1, . . . ,xs} are the barycenters contained in Bnk . For each simplex \u03c4i with corresponding barycenter xi there exist \u03c7 1 i , . . . , \u03c7 q i as orthonormal functions. Thus we form the orthonormal set E q n := {\u03c711, \u03c712, . . . , \u03c71q , \u03c721, \u03c722, . . . , \u03c72q , . . . , \u03c7 sn,k 1 , \u03c7 sn,k 2 , . . . \u03c7 sn,k q }. The objective is to form a linear combination of the elements in Eqn; we will construct a multilevel grid with the desired properties. To\nthis end let\n\u03c6n,kj := sn,k\u2211 i=1 q\u2211 h=1 cn,ki,h,j\u03c7 h i , j \u2208 {1, . . . , an,k}\n\u03c8n,kj := sn,k\u2211 i=1 q\u2211 h=1 dn,ki,h,j\u03c7 h i , j \u2208 {an,k + 1, . . . , sn,kq},\nwhere the coefficients cn,ki,h,j , d n,k i,h,j , an,k \u2208 R are still unknown. The goal is to construct \u03c8 n\u22121,k j such that it is orthogonal to the subspace V0 under the L 2(U ;Rq) inner product, i.e. for i = 1, . . . ,M and j = an,k + 1, . . . , sn,kq,\n(1)\n\u222b U \u03c6i(x) T\u03c8n,kj (x) dx = 0.\nFrom the eigenfunctions \u03c61, . . . , \u03c6M of the KL expansion and Enk we can form the matrix\nMn,k :=  (\u03c61(x), \u03c7 1 1(x)) . . . (\u03c61(x), \u03c7 sn,k 1 (x)) . . . (\u03c61(x), \u03c7 1 q(x)) . . . (\u03c61(x), \u03c7 sn,k q (x)) (\u03c62(x), \u03c7 1 1(x)) . . . (\u03c62(x), \u03c7 sn,k 1 (x)) . . . (\u03c62(x), \u03c7 1 q(x)) . . . (\u03c62(x), \u03c7 sn,k q (x)) ... ... ... ... ... ... ...\n(\u03c6M (x), \u03c7 1 1(x)) . . . (\u03c6M (x), \u03c7 sn,k 1 (x)) . . . (\u03c6M (x), \u03c7 1 q(x)) . . . (\u03c6M (x), \u03c7 sn,k q (x))  , where (\u00b7, \u00b7) is the standard L2(U ;Rq) inner product. From the matrix Mn,k the coefficients cn,ki,h,j , d n,k i,h,j , an,k \u2208 R can be computed. To this end apply the Singular Value Decomposition (SVD) to Mn,k\n(2) Mn,k = UDVT,\nwhere U \u2208 RM\u00d7M , D \u2208 RM\u00d7sn,k , V \u2208 Rsn,k\u00d7sn,k , and let an,k be the rank of the matrix Mn,k, i.e. the number of non-zero singular values of the matrix D. Our choices of coefficients cn,ki,h,j and d n,k i,h,j\nare now set to:\n(3)\n cn,k1,1,1 . . . c n,k 1,q,an,k dn,k1,1,an,k+1 . . . d n,k 1,1,sn,kq cn,k2,1,1 . . . c n,k 2,1,an,k dn,k2,1,an,k+1 . . . d n,k 2,1,sn,kq ... ... ... ... ... ...\ncn,ks,q,1 . . . c n,k s,q,an,k d n,k s,q,an,k+1 . . . dn,ks,q,sn,kq  := V. Lemma 3.6. Under this choice (equation (3)), \u03c8n,kan,k+1, . . . ,\u03c8 n,k sq satisfy equation (1).\nProof. Following the argument in [52, 8], let\nNn,k :=  (\u03c61,\u03c6 n,k 1 ) . . . (\u03c61,\u03c6 n,k an,k ) ... . . . ...\n(\u03c6M ,\u03c6 n,k 1 ) . . . (\u03c6M ,\u03c6 n,k an,k )\n\u2223\u2223\u2223\u2223\u2223\u2223\u2223\u2223 (\u03c61,\u03c8 n,k an,k+1 ) . . . (\u03c61,\u03c8 n,k sn,kq ) ... . . . ...\n(\u03c6M ,\u03c8 n,k an,k+1 ) . . . (\u03c6M ,\u03c8 n,k sn,kq )  . Thus from the choice of coefficients cn,ki,h,j and d n,k i,h,j we have that N n,k = Mn,kV. From equation (2) we conclude that Nn,k = Mn,kV = UD. Since Mn,k is of rank an,k we have D = [\u03a3 |0], where \u03a3 \u2208 RM\u00d7an,k is a diagonal matrix with the non-zero singular values of Mn,k and 0 \u2208 RM\u00d7(sn,kq\u2212an,k) is the zero matrix. Thus UD = [U\u03a3 |0] and Nn,k = [U\u03a3 |0]. It follows that columns an,k+1, . . . , s of V form an orthonormal basis of the nullspace of Mn,k and therefore \u03c8n,kan,k+1, . . . ,\u03c8 n,k s satisfy equation (1).\nLemma 3.7. Let Dnk := {\u03c8 n,k an,k+1 , . . . ,\u03c8n,ks } and Cnk := {\u03c6 n,k 1 , . . . ,\u03c6 n,k an,k }. Then Dnk \u222aCnk form an orthonormal set.\nProof. This follows from the fact that V is a unitary matrix and from the choice of coefficients from equation (3).\nFor every cell Bnk \u2208 Bn in the tree T at level n, the SVD orthogonalization process is repeated. Let Dn be the collection of orthonormal basis functions such that Dn = \u222aBnk\u2208BD n k , and the multilevel space be defined as Wn := spanDnk\u2208Dn {Dnk}.\nAlthough Cnk forms an orthonormal set, these functions are not in general orthogonal to V0. However, it is clear that \u222aBnk\u2208BnC n k form an orthonormal set. The next step is to work up the tree. For any two sibling cells denoted as Bnleft and B n right and corresponding basis functions C n left and Cnright at level n, let En\u22121k := C n left \u222a Cnright for some index k and let Bn\u22121k be the corresponding cell at level Bn\u22121. The orthogonalization process is repeated for the functions in En\u22121k . Rewrite the elements in En\u22121k as {\u03c7 n\u22121 1 , . . . , \u03c7 n\u22121 sn\u22121,k } and form the set of equations\n\u03c6n\u22121,kj := sn\u22121,k\u2211 i=1 cn\u22121,ki,j \u03c7 n\u22121 i , j \u2208 {1, . . . , an\u22121,k};\n\u03c8n\u22121,kj := sn\u22121,k\u2211 i=1 dn\u22121,ki,j \u03c7 n\u22121 i , j \u2208 {an\u22121,k + 1, . . . , sn\u22121,k}.\nWe can form the matrix\nMn\u22121,k :=  (\u03c61(x), \u03c7 n\u22121 1 (x)) . . . (\u03c61(x), \u03c7 n\u22121 sn\u22121,k (x)) (\u03c62(x), \u03c7 n\u22121 1 (x)) . . . (\u03c62(x), \u03c7 n\u22121 sn\u22121,k (x)) ... ... ...\n(\u03c6M (x), \u03c7 n\u22121 1 (x)) . . . (\u03c6M (x), \u03c7 n\u22121 sn\u22121,k (x))\n\nand apply the SVD Mn\u22121,k = UDVT. Suppose that an,k is the rank of the matrix M n\u22121,k. Then under the choice cn\u22121,k1,1 . . . c n\u22121,k 1,an,k dn\u22121,k1,an\u22121,k+1 . . . d n\u22121,k 1,sn\u22121,k cn\u22121,k2,1 . . . c n\u22121,k 2,an,k dn\u22121,k2,an\u22121,k+1 . . . d n\u22121,k 2,sn\u22121,k ... ... ... ... ... ...\ncn\u22121,ksn\u22121,k,1 . . . c n\u22121,k sn\u22121,k,an,k d n\u22121,k sn\u22121,k,an\u22121,k+1 . . . dn\u22121,ksn\u22121,k,sn\u22121,k  := V, for i = 1, . . . ,M and j = an\u22121,k + 1, . . . , sn\u22121,k we have that \u222b U \u03c6i(x) T\u03c8n\u22121,kj (x) dx = 0.\nFor every cellBn\u22121k \u2208 B n in the tree T at level n\u22121 the SVD orthogonalization process is repeated. Let Dn\u22121 be the collection of orthonormal basis functions such that Dn\u22121 = \u222aBn\u22121k \u2208BD n\u22121 k and the multilevel space be defined as Wn\u22121 := spanDn\u22121k \u2208Dn\u22121 {Dn\u22121k }.\nFor any two sibling cells denoted as Bn\u22121left and B n\u22121 right and corresponding basis functions C n\u22121 left and Cn\u22121right at level n, let En\u22122k := C n\u22121 left\u222aCn\u22121right for some index k and let Bn\u22122k be the corresponding cell at level Bn\u22122. It is clear that En\u22122k is an orthonormal set. The orthogonalization process is repeated for all the levels of the tree until the level 0 is reached. It is not hard to show that this process will terminate in at most O(nN) steps. Thus we have proved Theorem 3.8. Decompose Vn+1 as Vn+1 \u2192 V0 \u2295W0 \u2295 . . .Wn and\n(i) The complexity cost of the multi-level basis is bounded by O(nN). (ii) The multi-level basis vectors of V0 \u2295W0 \u2295 . . .Wn form an orthonormal set.\nThese multilevel basis functions can now be used to detect the anomaly w(x, \u03c9) at the various levels of resolution.\n3.1. Multilevel Detection. Lemma 3.9. Suppose that v \u2208 L2P(\u2126;L2(U ;Rq)) with KL expansion v = \u2211 p\u2208N \u03bb 1 2 p \u03c6p(x) Yp(\u03c9). Then for all l \u2208 N0, Blp \u2208 Bl and for the associated orthogonal projection coefficients d l,k p (\u03c9) =\u222b\nU v T\u03c8l,kp dx we have that E [ dl,kp ] = 0 and E [ (dl,kp )2 ] \u2264 \u2211 i\u2265M+1 \u03bbi.\nProof. The proof is a simple extension of the argument given in [9].\nAs M increases, not only is the approximation error of the KL expansion reduced and dominated by the sum of eigenvalues, but the variance of the coefficients dl,kp for the corresponding cell Blk is also controlled by the same quantity. We shall use this property to construct a reliable hypothesis test for detection of anomalous signals in any of the cells Blk \u2208 Bl for l = 0, . . . , n. Theorem 3.10 (Detection: Hypothesis Test). Suppose that u(x, \u03c9) = v(x, \u03c9) + w(x, \u03c9) and\nH0 : u(x, \u03c9) = v(x, \u03c9) HA : u(x, \u03c9) 6= v(x, \u03c9).\nLet 1 \u2265 \u03b1 \u2265 0 be the significance level. Then if the null hypothesis H0 is true it follows that\nP(|dl,kp (\u03c9)| \u2265 \u03b1\u2212 1 2 \u2211 i\u2265M+1 \u03bbi) \u2264 \u03b1.\nProof. The result follows from Lemma 3.9 and the Chebyshev inequality.\nRemark. (Important) With this hypothesis test the coefficients dl,kp can be used as detectors of anomalous signals in the cell Blk. Here are the key features of this detector:\n\u2022 Decay of the eigenvalues with M controlling the sharpness of the bound. \u2022 For validity of the hypothesis test only a good estimate of the covariance function is needed.\n\u2022 No assumptions on independence nor underlying distribution (e.g. Normal, Poisson, etc.) of the data. An alternative approach for detecting signals is to measure the size of the anomaly with respect to a suitable norm. Theorem 3.11. Suppose that u(x, \u03c9) = vM (x, \u03c9) + w(x, \u03c9) for some w(x, \u03c9) \u2208 L2P(\u2126;L\n2(U ;Rq)), where w(x, \u00b7) \u2208 V\u22a50 \u2229Vn+1 almost surely. Then n\u2211 l=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl (dl,kp ) 2 = \u2016w(x, \u03c9)\u20162L2(U ;Rq) (a.s.) and\nn\u2211 l=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl E [ (dl,kp ) 2 ] = \u2016w\u20162L2P(\u2126;L2(U ;Rq)).\nProof. The result follows from the orthogonality of the multilevel basis of W0 \u2295 . . .Wn.\nThus under the model u(x, \u03c9) = vM (x, \u03c9) + w(x, \u03c9) the size of the anomaly for w(x, \u03c9) can be calculated from the projection coefficients of the basis functions in V\u22a50 \u2229Vn+1 = W0 \u2295 . . .Wn.\nIn many cases the nominal behavior of the signal cannot be captured assuming a finite dimensional random field vM (x, \u03c9). Suppose that u(x, \u03c9) = v(x, \u03c9) + w(x, \u03c9), but w(x, \u00b7) \u2208V\u22a50 \u2229Vn+1 almost surely. In this case the tail of the KL expansion of v(x, \u03c9) intersects with the anomaly. However, the size of the anomaly can still be bounded. Theorem 3.12. Let tM := \u2211 j\u2265M+1 \u03bbj, sM := \u2211 j\u2265M+1 \u221a \u03bbj, and suppose that u(x, \u03c9) = v(x, \u03c9)+ w(x, \u03c9) for some w(x, \u03c9) \u2208 L2P(\u2126;L2(U ;Rq)), where w(x, \u00b7) \u2208 V\u22a50 \u2229Vn+1 almost surely. Then\n\u2016w\u20162L2P(\u2126;L2(U ;Rq))(1\u2212 2sM ) + tM \u2264 n\u2211 l=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl E [ (dl,kp ) 2 ]\n\u2264 \u2016w\u20162L2P(\u2126;L2(U ;Rq))(1 + 2sM ) + tM .\nProof. The result is a simple extension of the proof of Theorem 3 in [9]."
        },
        {
            "heading": "4. Application: Deforestation and forest degradation",
            "text": "This mathematical framework is well suited for detecting changes in terrestrial land surfaces based on both optical and radar data. The mathematical framework is applied to data collected from the Sentinel-2 and Landsat satellites for the detection of forest degradation in the Amazon. Detection here is a complex task, as can be seen from Figure 4. In particular, detection of changes in the state of a forest are significantly hindered by the presence of misleading anomaly artefacts such as cloud cover. We first demonstrate the application of this multilevel anomaly filter to Landsat satellite optical sensor data [45, 54]. The Enhanced Vegetation Index (EVI) [27] is a benchmark quantity calculated from satellite measurements, with an important goal of detecting forest degradation. In this test example we extract a slice sized at 25\u00d7 18 pixels. Remark. A cloud masking detection algorithm is applied [58]. These algorithms are not perfect, and in many instances clouds fail to be detected or removed (see Figure 4). The approach developed above provides a much more viable mechanism for automatically detecting and accounting for these cloud artefacts.\nEach pixel corresponds to a 30m \u00d7 30m patch of land. With a starting date of June 2016, 95 terrain slices (frame numbers 1 to 95) are collected. A covariance function is constructed from the first 65 time slices (through to day 1288). The KL expansion eigenspaces are computed and the multilevel filter is constructed with M = 40. The probabilities under the null hypothesis test H0 : u(x, \u03c9) = v(x, \u03c9) for coefficients d l,k p (\u03c9) are given by P(|dl,kp (\u03c9)| \u2265 \u03b1\u2212 1 2 \u2211 i\u2265M+1 \u03bbi) \u2264 \u03b1,\nwhere \u03b1 is the significance level. It is assumed that \u03bbM dominates the infinite sum \u2211\u221e\nk=M+1 \u03bbk. This assumption is made due to limitations on availability of data as well as the rapid decay of the eigenvalues. The multilevel filter is applied to each frame number starting from 66 (day 1304).\nThe projection coefficients dkl are computed for levels l = 0, . . . , 3 for each available day e.g.\nW day0 ,W day 1 , . . . ,W day 3 . The contribution to the total size of the anomaly \u2016w(x)\u2016L2(U ;Rq) for any fixed realization on day, within each cell Blk, is computed as E l,k p := \u221a\u2211 \u03c8l,kp \u2208Dlk (dl,kp )2. Note that for\nany fixed day if w(x, \u00b7) \u2208 V\u22a50 \u2229Vn+1 then a.s. \u2016w(x, \u03c9)\u20162L2(U ;Rq) = \u2211n l=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl (dl,kp )2.\nIn Figure 5, corresponding to day 1304, there is an image of the forest featuring a small patch of bare ground on the upper right corner. Until day 1304 the vegetation of the terrain has not changed, so that we expect small anomaly measurements. The cells Bl,kp and levels of resolution l = 0, . . . , 3 are overlaid on the RGB image with different semi-transparent colors. The structure of the forest can be seen. The spatial intensities of the stochastic anomalies for levels l = 0, . . . , 3 are\n0 are given\nfor day 1304 and level l. To indicate that the data is scalar we use the unbolded characters. The bottom figure corresponds to the probability for each coefficient dl,kp with respect to level of resolutions l = 0, 1, . . . , 3. The cell supports for each level of resolution are traced by the points of different colors. Notice that the cell size is smaller for higher levels and larger for lower levels. The grey circle in the middle of\nthe cell lk reflects the size of anomaly given by E l,k p := (\u2211 \u03c8l,kp \u2208Dlk (dl,kp )2 ) 1 2 for each cell Blk \u2208 Bl; we can see these are small. For anomalies greater that 1, the size of the anomaly is printed in yellow text. This is also reflected in the probability per level (based on hypothesis tests) of each coefficient dl,kp . Note that the magnitudes of the anomalies per cell are small. Furthermore, there are no null hypothesis tests with probability below the significance level \u03b1 = 10\u22122 (dashed line).\nsmall. This is also reflected in the tests of the null hypothesis H0 for the test statistic coefficients dl,kp , where the p-values are larger than the significance level \u03b1 = 10\u22122.\nIn Figure 6 (a) we observe that for day 1336 many anomalies are detected for the cells Bl,kp . This can be seen from the jump in intensities of the measured anomaly magnitudes El,kp and corresponding sizes of the grey disks. Furthermore, the p values of the test of the null hypothesis H0 are below the significance level of \u03b1 = 10\n\u22122. This is consistent with the visual changes that are observed on RGB image, where it is seen that parts of the forest are removed and more bare ground is observed. In Figure 6 (b), day 1352, it is observed that additional trees have been removed. This is reflected in the larger anomaly measurements seen in the cells Bl,kp and the corresponding hypothesis tests.\n4.1. Anomaly sequence on Sentinel 2 scalar data. We now focus on the multilevel filter output from a series of Sentinel 2 optical sensor data [18], and on the change in the anomaly as time evolves (Figure 4). This example illustrates the complexity of degradation as the detected logging of the forest on day 3484 does not notably change the land cover, which remains forest. Further, the forest\ndoes not stay in a degraded state and is allowed to recover. Note that the anomaly introduced by imperfect cloud masking on day 3909 significantly complicates the task of detecting changes in the forest. As for the case of Landsat data, we compute the EVI from the optical spectral data From 71 Sentinel 2 data frames starting from day 1 to day 3200 the covariance structure is analyzed and the multilevel anomaly filter is implemented. Each pixel of the 150 \u00d7 150 area corresponds to a land patch of 10m \u00d7 10m. We further extract 75 \u00d7 75 landcover, construct the multilevel filter with M = 51 and apply the multilevel filter to each of the EVI test frames starting from day 3300 (corresponding to frame number 1). Given the assumption that w(x, \u00b7) \u2208 V\u22a50 \u2229 Vn+1 an anomaly map is reconstructed as w(x, \u03c9) = \u2211n l=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl dl,kp \u03c8 l,k p (x). Further it\ncan be shown that if the null hypothesis holds then for each pixel the anomaly map satisfies P(| \u222b U\u0303 w(x, \u03c9) dx| \u2265 \u03b1 \u2212 1 2 \u2211 i\u2265M+1 \u03bbi \u222b U\u0303 \u03c6 2 i (x) dx) \u2264 \u03b1 for any region U\u0303 \u2282 U around the pixel.\nFrom Figure 4 note that many of the trees are removed but regrow back with time. The last image corresponds to a cloudy day on which the cloud removal algorithm has trouble detecting clouds and only a subset are removed (black pixels). As seen above, for deforestation tracking algorithms distinguishing forest changes from cloud cover is a challenge.\nIn Figure 7 the multilevel anomaly map for day 3344, 3484 and 3704 are shown for levels of resolution l = 0, . . . , 3. In Figure 8 the corresponding p-values for are displayed for each coefficient dl,kp for the same sequence of days. We observe that for day 3344 the anomalies are small and concentrated on the top of the image outside of the forest. This is reflected in the hypothesis tests, where almost all the p-values are above the significance level of \u03b1 = 0.05. On day 3484 deforestation appears and as expected, with the anomaly metrics El,kp significantly increasing and the p-values for many of the coefficients becoming significant. On day 3704 regrowth from adjacent trees covers\nthe bare ground. The anomalies reduce and the p-values are less significant. However, notice that it still more significant than for day 3344. This is due to new vegetation that is partly captured with the EVI index. As will be seen, with the application of the multilevel vector field method on the multilevel spectral data, this will be substantially more pronounced.\nIn Figure 9 (a) the anomaly for pixel coordinate (108,66) is tracked in time. A robust LOESS [34] is applied to the anomaly sequence. On day 3499 we note the large jump in the anomaly for that pixel coordinate, due to the removal of trees. As time evolves the anomaly metric grows, reflecting the clearing of trees. However, the vegetation from nearby trees grows into the area (day 3774), and eventually the anomaly level returns to zero. This is expected as leaves in the forest age. On the cloudy day (3909), the anomaly is ignored from the LOESS regression as it is recognized as an outlier, with similar behavior at other pixel locations with cloud cover. Remark. (Important) From the direct EVI measurements in Figure 9 (b) at pixel (108,66), it is not possible to distinguish cloud cover from vegetation at the anomaly circled in red. Current methods that directly use the EVI measurements will be blind to this type of problem. In particular, the cloud masking algorithm developed in [58] was unable to properly classify the cloud cover, potentially leading to erroneous pictures of the forest state. Using the anomaly filter, cloud cover can be more easily identified \u2013 development of a cloud identification algorithm is being explored in detail. Remark. (Important) One feature of this approach is its augmentation of current statistical methods to better characterize the signal in time. For example, applying the robust LOESS we can more\neasily identify clouds. Similar advantages have been observed in the anomalous sequences for change points, where it becomes clearer how and where the stochastic properties of the signal differ in time. This means that we can apply current change point detection algorithms to these anomalous signals. This will be further investigated in a later publication.\n4.2. Anomaly sequences on multimodal vector field data (q = 6). Results are shown below for application of the multilevel filter to vector field data. From the Sentinel 2 dataset used in the previous experiment, the same landcover of 75 \u00d7 75 pixels is extracted. However, here we do not compute the EVI index from individual optical bands but instead use all of the optical bands 1 - 6 (blue, green, red, near-infrared, shortwave infrared 1 and shortwave infrared 2) as a vector field defined on the land cover. The covariance functional matrix across all bands is estimated and the eigenspace is constructed for M = 51 eigenfunctions. The anomaly sequence is computed from the\nvectorial field multilevel filter w(x, \u03c9) = \u2211n\nl=0 \u2211 \u03c8l,kp \u2208Dlk \u2211 Dlk\u2208Dl dl,kp \u03c8 l,k p (x) for each available day.\nIt is advantageous to study forest degradation by incorporating all correlations of the anomalies across spatial and band data. In Figure 10 sizes of anomalies for days 3344, 3484 and 3704 are shown. Due to scaling of the data, anomalies are divided by 1000 and colored yellow if they are larger than 3. For day 3344 sizes of anomalies El,kp are shown for each cell B l,k p . Anomalies are relatively small, as only the grasslands present the largest changes in vegetation. On day 3484 part of the tree cover is removed, and sizes of the anomalies increase significantly. This is consistent with the scalar EVI anomaly map shown in Figure 7. On day 3704 the forest has essentially recovered, but in contrast to the scalar EVI, data sizes of anomalies increase further. This is due to the nearinfrared (band 4) spectral data that reflect new chlorophyll from forest regrowth. This is consistent with Figure 11 where the anomaly signaled by the near-infrared band increases significantly at day 3704.\nIn Figure 11 the anomaly time sequences for all 6 bands are shown for pixel (96,70). From the RGB bands (1-3) observe the relation of the clearing of trees by day 3484 to increases in the anomaly levels for all 3 bands. In addition, particularly in band 4 (near infrared), by day 3600 the anomaly becomes more notable. Near infrared as a modality detects new leaves (chlorophyll). This is observable with the growth of vegetation after the clearing of some of the trees around day 3484. By the last day the anomaly level in near infrared slowly decreases, consistent with aging of the leaves.\n0\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n0.5\n1\n1.5\n2\n2.5\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n0.5\n1\n1.5\n2\n2.5\n3\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n(a) (b)(96,70) (96,70)\nRemark. Note that we did not present explicit hypothesis tests for this example, which would have required a larger order for filter M , to capture a smaller eigenvalues. The data are insufficient to produce the required eigenspaces. However, sizes of projection coefficients can still be used to quantify the anomalies."
        },
        {
            "heading": "5. Conclusions",
            "text": "In this paper we have developed a multilevel basis that is adapted to the truncated KarhunenLoe\u0300ve expansion of a nominal random vector field. We show a full rigorous proof of the existence and optimality of the KL expansion for random vector fields. Numerical construction of the multilevel basis for the vector field is achieved with an efficient algorithm originating in the numerical solution\n0\n200\n400\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n200\n400\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n100\n200\n3200 3300 3400 3500 3600 3700 3800 3900 4000\n0 100 200 3200 3300 3400 3500 3600 3700 3800 3900 4000\n0\n100\n200\n3200 3300 3400 3500 3600 3700 3800 3900 4000\nof PDEs. Detection is achieved by examining relative contributions to the multilevel spaces. Anomalies are quantified using a suitable norm and reliable hypothesis tests with weak assumptions. We apply our approach to the problem of deforestation and degradation in the Amazon forest. This approach does not replace, but rather augments current statistical approaches. For example, the multilevel filter amplitudes can signal anomalous behavior that can be tracked through identifiable transitions using change point detection methods. Furthermore, these anomalous behaviors can be identified at multiple change points, further elucidating temporal behaviors. We are currently further investigating these latter aspects.\nAnother problem of very general interest in this area is the reliable identification of cloud cover. We have demonstrated a more effective approach to this problem by examining variable temporal behavior anomalies. We are currently developing a fuller algorithm to achieve this."
        },
        {
            "heading": "Appendix",
            "text": ""
        },
        {
            "heading": "Proof of Proposition 2.2",
            "text": "Proof. First we show that {vk(x)vl(y)T}k,l\u2208N are orthonormal. Note\n(vi(x)vj(y) T,vk(x)vl(y) T)L2(U ;Rq\u00d7q) = \u222b U \u222b U 1T(vi(x)vj(y) T \u2022 vk(x)vl(y)T)1 dxdy\n= \u222b U \u222b U 1T  vi1(x)v k 1 (x) vi2(x)v k 2 (x)\n... viq(x)v k q (x) [vj1(y)vl1(y) . . . vjq(y)vlq(y)]1 dxdy =\n\u222b U vi(x) Tvk(x) dx \u222b U vj(y) Tvl(y) dy = \u03b4[i\u2212 k]\u03b4[j \u2212 l].\n(4)\nLet F \u2208 L2(U \u00d7 U ;Rq\u00d7q) and suppose that\u222b U \u222b U 1T(F(x,y) \u2022 vk(x)vl(y))1 dxdy = 0 for all k, l \u2208 N. Then\u222b U \u222b U 1T(F(x,y) \u2022 vk(x)vl(y))1 dxdy = \u222b U \u222b U \u2211 i,j Fi,j(x,y)v k i (x)v l j(y) dxdy\n= \u222b U q\u2211 j=1 vlj(y) (\u222b U q\u2211 i=1 Fi,j(x,y)v k i (x) dx ) dy = 0 (5)\nSince {vl}l\u2208N is a complete orthonormal basis of L2(U ;Rq), it follows\n(6)\n\u222b U q\u2211 i=1 Fi,j(x,y)v k i (x) dx = 0\nalmost everywhere for all k \u2208 N. Now, for each k \u2208 N let Dk be the set of measure zero on which (6) does not hold. Letting D := \u222ak\u2208NDk, if y /\u2208 D then\u222b\nU q\u2211 i=1 Fi,j(x,y)v k i (x) dx = 0\nfor all k \u2208 N. Since {vk}k\u2208N is a complete orthonormal basis for L2(U ;Rq) it follows F(x,y) = 0 almost everywhere with respect to the measure dxdy."
        },
        {
            "heading": "Proof of Proposition 2.3",
            "text": "Proof. From Proposition 1 we have that {vkvTl }k,l\u2208N is a complete orthonormal basis for L2(U \u00d7 U ;Rq\u00d7q). Conversely, from Proposition 2 in [43] we have that {vk \u2297 vl}k,l\u2208N is a complete orthonormal basis for L2(U ;Rq) \u2297 L2(U ;Rq). Now define the map M : L2(U ;Rq) \u2297 L2(U ;Rq) \u2192 L2(U \u00d7 U ;Rq\u00d7q) such that M(vk \u2297 vl) = vkvTl for all k, l \u2208 N. Let f \u2208 L2(U ;Rq)\u2297 L2(U ;Rq), so that we can write f = \u2211 k,l \u03b1k,lvk \u2297 vl. Define the map M\u2032 : L2(U ;Rq)\u2297 L2(U ;Rq)\u2192 L2(U \u00d7 U ;Rq\u00d7q) as\nM\u2032f = \u2211 k,l \u03b1k,lM(vk \u2297 vl) = \u2211 k,l \u03b1k,lvkv T l .\nWe have that (M\u2032f,M\u2032f)L2(U\u00d7U ;Rq\u00d7q) = \u2211 k,l \u2211 k\u2032,l\u2032 \u03b1k,l\u03b1k\u2032,l\u2032(vkv T l ,vk\u2032v T l\u2032 )L2(U\u00d7U ;Rq\u00d7q) = \u2211 k,l \u03b12k,l.(7)\nConversely, we have (f, f)L2(U ;Rq)\u2297L2(U ;Rq) = \u2211 k,l \u2211 k\u2032,l\u2032 \u03b1k,l\u03b1k\u2032,l\u2032(vk \u2297 vl,vk\u2032 \u2297 vl\u2032)L2(U ;Rq)\u2297L2(U ;Rq) = \u2211 k,l \u03b12k,l."
        },
        {
            "heading": "Proof of Proposition 2.4",
            "text": "Proof. This result follows from a similar argument as that for the proofs of Proposition 2.2 and 2.3."
        },
        {
            "heading": "Acknowledgments",
            "text": "We appreciate the help from Pontus Olofsson, Hanfeng Gu and Xiaojing Tang in providing the Landsat and Sentinel-2 datasets. Furthermore, their expertise in remote sensing was useful in placing context to this work and in interpreting the results. We also appreciate the feedback from Sucharita Gopal. This material is based upon work supported by the National Science Foundation (and Department of Energy) under Grant No. 1736392."
        }
    ],
    "title": "STOCHASTIC FUNCTIONAL ANALYSIS AND MULTILEVEL VECTOR FIELD ANOMALY DETECTION",
    "year": 2022
}